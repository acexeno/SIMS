var jM=Object.defineProperty;var $M=(e,t,r)=>t in e?jM(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Pg=(e,t,r)=>($M(e,typeof t!="symbol"?t+"":t,r),r);function UM(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();function Es(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var yC={exports:{}},Kh={},bC={exports:{}},Et={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gf=Symbol.for("react.element"),zM=Symbol.for("react.portal"),HM=Symbol.for("react.fragment"),WM=Symbol.for("react.strict_mode"),GM=Symbol.for("react.profiler"),VM=Symbol.for("react.provider"),KM=Symbol.for("react.context"),XM=Symbol.for("react.forward_ref"),qM=Symbol.for("react.suspense"),YM=Symbol.for("react.memo"),JM=Symbol.for("react.lazy"),_N=Symbol.iterator;function QM(e){return e===null||typeof e!="object"?null:(e=_N&&e[_N]||e["@@iterator"],typeof e=="function"?e:null)}var wC={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},NC=Object.assign,SC={};function tu(e,t,r){this.props=e,this.context=t,this.refs=SC,this.updater=r||wC}tu.prototype.isReactComponent={};tu.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};tu.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function kC(){}kC.prototype=tu.prototype;function s1(e,t,r){this.props=e,this.context=t,this.refs=SC,this.updater=r||wC}var o1=s1.prototype=new kC;o1.constructor=s1;NC(o1,tu.prototype);o1.isPureReactComponent=!0;var EN=Array.isArray,_C=Object.prototype.hasOwnProperty,l1={current:null},EC={key:!0,ref:!0,__self:!0,__source:!0};function CC(e,t,r){var n,a={},i=null,s=null;if(t!=null)for(n in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(i=""+t.key),t)_C.call(t,n)&&!EC.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:gf,type:e,key:i,ref:s,props:a,_owner:l1.current}}function ZM(e,t){return{$$typeof:gf,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function c1(e){return typeof e=="object"&&e!==null&&e.$$typeof===gf}function eI(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var CN=/\/+/g;function Og(e,t){return typeof e=="object"&&e!==null&&e.key!=null?eI(""+e.key):t.toString(36)}function q0(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(i){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case gf:case zM:s=!0}}if(s)return s=e,a=a(s),e=n===""?"."+Og(s,0):n,EN(a)?(r="",e!=null&&(r=e.replace(CN,"$&/")+"/"),q0(a,t,r,"",function(u){return u})):a!=null&&(c1(a)&&(a=ZM(a,r+(!a.key||s&&s.key===a.key?"":(""+a.key).replace(CN,"$&/")+"/")+e)),t.push(a)),1;if(s=0,n=n===""?".":n+":",EN(e))for(var o=0;o<e.length;o++){i=e[o];var c=n+Og(i,o);s+=q0(i,t,r,c,a)}else if(c=QM(e),typeof c=="function")for(e=c.call(e),o=0;!(i=e.next()).done;)i=i.value,c=n+Og(i,o++),s+=q0(i,t,r,c,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function e0(e,t,r){if(e==null)return e;var n=[],a=0;return q0(e,n,"","",function(i){return t.call(r,i,a++)}),n}function tI(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var qn={current:null},Y0={transition:null},rI={ReactCurrentDispatcher:qn,ReactCurrentBatchConfig:Y0,ReactCurrentOwner:l1};function AC(){throw Error("act(...) is not supported in production builds of React.")}Et.Children={map:e0,forEach:function(e,t,r){e0(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return e0(e,function(){t++}),t},toArray:function(e){return e0(e,function(t){return t})||[]},only:function(e){if(!c1(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Et.Component=tu;Et.Fragment=HM;Et.Profiler=GM;Et.PureComponent=s1;Et.StrictMode=WM;Et.Suspense=qM;Et.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rI;Et.act=AC;Et.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=NC({},e.props),a=e.key,i=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,s=l1.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)_C.call(t,c)&&!EC.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:gf,type:e.type,key:a,ref:i,props:n,_owner:s}};Et.createContext=function(e){return e={$$typeof:KM,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:VM,_context:e},e.Consumer=e};Et.createElement=CC;Et.createFactory=function(e){var t=CC.bind(null,e);return t.type=e,t};Et.createRef=function(){return{current:null}};Et.forwardRef=function(e){return{$$typeof:XM,render:e}};Et.isValidElement=c1;Et.lazy=function(e){return{$$typeof:JM,_payload:{_status:-1,_result:e},_init:tI}};Et.memo=function(e,t){return{$$typeof:YM,type:e,compare:t===void 0?null:t}};Et.startTransition=function(e){var t=Y0.transition;Y0.transition={};try{e()}finally{Y0.transition=t}};Et.unstable_act=AC;Et.useCallback=function(e,t){return qn.current.useCallback(e,t)};Et.useContext=function(e){return qn.current.useContext(e)};Et.useDebugValue=function(){};Et.useDeferredValue=function(e){return qn.current.useDeferredValue(e)};Et.useEffect=function(e,t){return qn.current.useEffect(e,t)};Et.useId=function(){return qn.current.useId()};Et.useImperativeHandle=function(e,t,r){return qn.current.useImperativeHandle(e,t,r)};Et.useInsertionEffect=function(e,t){return qn.current.useInsertionEffect(e,t)};Et.useLayoutEffect=function(e,t){return qn.current.useLayoutEffect(e,t)};Et.useMemo=function(e,t){return qn.current.useMemo(e,t)};Et.useReducer=function(e,t,r){return qn.current.useReducer(e,t,r)};Et.useRef=function(e){return qn.current.useRef(e)};Et.useState=function(e){return qn.current.useState(e)};Et.useSyncExternalStore=function(e,t,r){return qn.current.useSyncExternalStore(e,t,r)};Et.useTransition=function(){return qn.current.useTransition()};Et.version="18.3.1";bC.exports=Et;var N=bC.exports;const ft=Es(N),nI=UM({__proto__:null,default:ft},[N]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aI=N,iI=Symbol.for("react.element"),sI=Symbol.for("react.fragment"),oI=Object.prototype.hasOwnProperty,lI=aI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,cI={key:!0,ref:!0,__self:!0,__source:!0};function TC(e,t,r){var n,a={},i=null,s=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)oI.call(t,n)&&!cI.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:iI,type:e,key:i,ref:s,props:a,_owner:lI.current}}Kh.Fragment=sI;Kh.jsx=TC;Kh.jsxs=TC;yC.exports=Kh;var u1=yC.exports;const lt=u1.Fragment,l=u1.jsx,m=u1.jsxs;var Yx={},PC={exports:{}},La={},OC={exports:{}},DC={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ee,V){var ae=ee.length;ee.push(V);e:for(;0<ae;){var oe=ae-1>>>1,I=ee[oe];if(0<a(I,V))ee[oe]=V,ee[ae]=I,ae=oe;else break e}}function r(ee){return ee.length===0?null:ee[0]}function n(ee){if(ee.length===0)return null;var V=ee[0],ae=ee.pop();if(ae!==V){ee[0]=ae;e:for(var oe=0,I=ee.length,W=I>>>1;oe<W;){var U=2*(oe+1)-1,G=ee[U],ne=U+1,K=ee[ne];if(0>a(G,ae))ne<I&&0>a(K,G)?(ee[oe]=K,ee[ne]=ae,oe=ne):(ee[oe]=G,ee[U]=ae,oe=U);else if(ne<I&&0>a(K,ae))ee[oe]=K,ee[ne]=ae,oe=ne;else break e}}return V}function a(ee,V){var ae=ee.sortIndex-V.sortIndex;return ae!==0?ae:ee.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var c=[],u=[],d=1,f=null,h=3,p=!1,x=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(ee){for(var V=r(u);V!==null;){if(V.callback===null)n(u);else if(V.startTime<=ee)n(u),V.sortIndex=V.expirationTime,t(c,V);else break;V=r(u)}}function S(ee){if(g=!1,b(ee),!x)if(r(c)!==null)x=!0,Y(k);else{var V=r(u);V!==null&&q(S,V.startTime-ee)}}function k(ee,V){x=!1,g&&(g=!1,v(P),P=-1),p=!0;var ae=h;try{for(b(V),f=r(c);f!==null&&(!(f.expirationTime>V)||ee&&!R());){var oe=f.callback;if(typeof oe=="function"){f.callback=null,h=f.priorityLevel;var I=oe(f.expirationTime<=V);V=e.unstable_now(),typeof I=="function"?f.callback=I:f===r(c)&&n(c),b(V)}else n(c);f=r(c)}if(f!==null)var W=!0;else{var U=r(u);U!==null&&q(S,U.startTime-V),W=!1}return W}finally{f=null,h=ae,p=!1}}var _=!1,E=null,P=-1,A=5,T=-1;function R(){return!(e.unstable_now()-T<A)}function D(){if(E!==null){var ee=e.unstable_now();T=ee;var V=!0;try{V=E(!0,ee)}finally{V?L():(_=!1,E=null)}}else _=!1}var L;if(typeof w=="function")L=function(){w(D)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,X=z.port2;z.port1.onmessage=D,L=function(){X.postMessage(null)}}else L=function(){y(D,0)};function Y(ee){E=ee,_||(_=!0,L())}function q(ee,V){P=y(function(){ee(e.unstable_now())},V)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ee){ee.callback=null},e.unstable_continueExecution=function(){x||p||(x=!0,Y(k))},e.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<ee?Math.floor(1e3/ee):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(ee){switch(h){case 1:case 2:case 3:var V=3;break;default:V=h}var ae=h;h=V;try{return ee()}finally{h=ae}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ee,V){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var ae=h;h=ee;try{return V()}finally{h=ae}},e.unstable_scheduleCallback=function(ee,V,ae){var oe=e.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?oe+ae:oe):ae=oe,ee){case 1:var I=-1;break;case 2:I=250;break;case 5:I=1073741823;break;case 4:I=1e4;break;default:I=5e3}return I=ae+I,ee={id:d++,callback:V,priorityLevel:ee,startTime:ae,expirationTime:I,sortIndex:-1},ae>oe?(ee.sortIndex=ae,t(u,ee),r(c)===null&&ee===r(u)&&(g?(v(P),P=-1):g=!0,q(S,ae-oe))):(ee.sortIndex=I,t(c,ee),x||p||(x=!0,Y(k))),ee},e.unstable_shouldYield=R,e.unstable_wrapCallback=function(ee){var V=h;return function(){var ae=h;h=V;try{return ee.apply(this,arguments)}finally{h=ae}}}})(DC);OC.exports=DC;var uI=OC.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dI=N,Da=uI;function ke(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var RC=new Set,_d={};function Rl(e,t){Oc(e,t),Oc(e+"Capture",t)}function Oc(e,t){for(_d[e]=t,e=0;e<t.length;e++)RC.add(t[e])}var xs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Jx=Object.prototype.hasOwnProperty,fI=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,AN={},TN={};function mI(e){return Jx.call(TN,e)?!0:Jx.call(AN,e)?!1:fI.test(e)?TN[e]=!0:(AN[e]=!0,!1)}function hI(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function pI(e,t,r,n){if(t===null||typeof t>"u"||hI(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Yn(e,t,r,n,a,i,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var hn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){hn[e]=new Yn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];hn[t]=new Yn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){hn[e]=new Yn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){hn[e]=new Yn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){hn[e]=new Yn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){hn[e]=new Yn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){hn[e]=new Yn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){hn[e]=new Yn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){hn[e]=new Yn(e,5,!1,e.toLowerCase(),null,!1,!1)});var d1=/[\-:]([a-z])/g;function f1(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(d1,f1);hn[t]=new Yn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(d1,f1);hn[t]=new Yn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(d1,f1);hn[t]=new Yn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){hn[e]=new Yn(e,1,!1,e.toLowerCase(),null,!1,!1)});hn.xlinkHref=new Yn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){hn[e]=new Yn(e,1,!1,e.toLowerCase(),null,!0,!0)});function m1(e,t,r,n){var a=hn.hasOwnProperty(t)?hn[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(pI(t,r,a,n)&&(r=null),n||a===null?mI(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Cs=dI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,t0=Symbol.for("react.element"),tc=Symbol.for("react.portal"),rc=Symbol.for("react.fragment"),h1=Symbol.for("react.strict_mode"),Qx=Symbol.for("react.profiler"),MC=Symbol.for("react.provider"),IC=Symbol.for("react.context"),p1=Symbol.for("react.forward_ref"),Zx=Symbol.for("react.suspense"),ev=Symbol.for("react.suspense_list"),g1=Symbol.for("react.memo"),js=Symbol.for("react.lazy"),FC=Symbol.for("react.offscreen"),PN=Symbol.iterator;function Eu(e){return e===null||typeof e!="object"?null:(e=PN&&e[PN]||e["@@iterator"],typeof e=="function"?e:null)}var pr=Object.assign,Dg;function qu(e){if(Dg===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Dg=t&&t[1]||""}return`
`+Dg+e}var Rg=!1;function Mg(e,t){if(!e||Rg)return"";Rg=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),i=n.stack.split(`
`),s=a.length-1,o=i.length-1;1<=s&&0<=o&&a[s]!==i[o];)o--;for(;1<=s&&0<=o;s--,o--)if(a[s]!==i[o]){if(s!==1||o!==1)do if(s--,o--,0>o||a[s]!==i[o]){var c=`
`+a[s].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=s&&0<=o);break}}}finally{Rg=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?qu(e):""}function gI(e){switch(e.tag){case 5:return qu(e.type);case 16:return qu("Lazy");case 13:return qu("Suspense");case 19:return qu("SuspenseList");case 0:case 2:case 15:return e=Mg(e.type,!1),e;case 11:return e=Mg(e.type.render,!1),e;case 1:return e=Mg(e.type,!0),e;default:return""}}function tv(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case rc:return"Fragment";case tc:return"Portal";case Qx:return"Profiler";case h1:return"StrictMode";case Zx:return"Suspense";case ev:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case IC:return(e.displayName||"Context")+".Consumer";case MC:return(e._context.displayName||"Context")+".Provider";case p1:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case g1:return t=e.displayName||null,t!==null?t:tv(e.type)||"Memo";case js:t=e._payload,e=e._init;try{return tv(e(t))}catch{}}return null}function xI(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return tv(t);case 8:return t===h1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function uo(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function LC(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function vI(e){var t=LC(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(s){n=""+s,i.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function r0(e){e._valueTracker||(e._valueTracker=vI(e))}function BC(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=LC(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function xm(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function rv(e,t){var r=t.checked;return pr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function ON(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=uo(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function jC(e,t){t=t.checked,t!=null&&m1(e,"checked",t,!1)}function nv(e,t){jC(e,t);var r=uo(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?av(e,t.type,r):t.hasOwnProperty("defaultValue")&&av(e,t.type,uo(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function DN(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function av(e,t,r){(t!=="number"||xm(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Yu=Array.isArray;function vc(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+uo(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function iv(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ke(91));return pr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function RN(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ke(92));if(Yu(r)){if(1<r.length)throw Error(ke(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:uo(r)}}function $C(e,t){var r=uo(t.value),n=uo(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function MN(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function UC(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function sv(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?UC(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var n0,zC=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(n0=n0||document.createElement("div"),n0.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=n0.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ed(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var ad={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},yI=["Webkit","ms","Moz","O"];Object.keys(ad).forEach(function(e){yI.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ad[t]=ad[e]})});function HC(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||ad.hasOwnProperty(e)&&ad[e]?(""+t).trim():t+"px"}function WC(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=HC(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var bI=pr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ov(e,t){if(t){if(bI[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ke(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ke(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ke(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ke(62))}}function lv(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var cv=null;function x1(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var uv=null,yc=null,bc=null;function IN(e){if(e=yf(e)){if(typeof uv!="function")throw Error(ke(280));var t=e.stateNode;t&&(t=Qh(t),uv(e.stateNode,e.type,t))}}function GC(e){yc?bc?bc.push(e):bc=[e]:yc=e}function VC(){if(yc){var e=yc,t=bc;if(bc=yc=null,IN(e),t)for(e=0;e<t.length;e++)IN(t[e])}}function KC(e,t){return e(t)}function XC(){}var Ig=!1;function qC(e,t,r){if(Ig)return e(t,r);Ig=!0;try{return KC(e,t,r)}finally{Ig=!1,(yc!==null||bc!==null)&&(XC(),VC())}}function Cd(e,t){var r=e.stateNode;if(r===null)return null;var n=Qh(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ke(231,t,typeof r));return r}var dv=!1;if(xs)try{var Cu={};Object.defineProperty(Cu,"passive",{get:function(){dv=!0}}),window.addEventListener("test",Cu,Cu),window.removeEventListener("test",Cu,Cu)}catch{dv=!1}function wI(e,t,r,n,a,i,s,o,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var id=!1,vm=null,ym=!1,fv=null,NI={onError:function(e){id=!0,vm=e}};function SI(e,t,r,n,a,i,s,o,c){id=!1,vm=null,wI.apply(NI,arguments)}function kI(e,t,r,n,a,i,s,o,c){if(SI.apply(this,arguments),id){if(id){var u=vm;id=!1,vm=null}else throw Error(ke(198));ym||(ym=!0,fv=u)}}function Ml(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function YC(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function FN(e){if(Ml(e)!==e)throw Error(ke(188))}function _I(e){var t=e.alternate;if(!t){if(t=Ml(e),t===null)throw Error(ke(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return FN(a),e;if(i===n)return FN(a),t;i=i.sibling}throw Error(ke(188))}if(r.return!==n.return)r=a,n=i;else{for(var s=!1,o=a.child;o;){if(o===r){s=!0,r=a,n=i;break}if(o===n){s=!0,n=a,r=i;break}o=o.sibling}if(!s){for(o=i.child;o;){if(o===r){s=!0,r=i,n=a;break}if(o===n){s=!0,n=i,r=a;break}o=o.sibling}if(!s)throw Error(ke(189))}}if(r.alternate!==n)throw Error(ke(190))}if(r.tag!==3)throw Error(ke(188));return r.stateNode.current===r?e:t}function JC(e){return e=_I(e),e!==null?QC(e):null}function QC(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=QC(e);if(t!==null)return t;e=e.sibling}return null}var ZC=Da.unstable_scheduleCallback,LN=Da.unstable_cancelCallback,EI=Da.unstable_shouldYield,CI=Da.unstable_requestPaint,Ar=Da.unstable_now,AI=Da.unstable_getCurrentPriorityLevel,v1=Da.unstable_ImmediatePriority,eA=Da.unstable_UserBlockingPriority,bm=Da.unstable_NormalPriority,TI=Da.unstable_LowPriority,tA=Da.unstable_IdlePriority,Xh=null,Ui=null;function PI(e){if(Ui&&typeof Ui.onCommitFiberRoot=="function")try{Ui.onCommitFiberRoot(Xh,e,void 0,(e.current.flags&128)===128)}catch{}}var Si=Math.clz32?Math.clz32:RI,OI=Math.log,DI=Math.LN2;function RI(e){return e>>>=0,e===0?32:31-(OI(e)/DI|0)|0}var a0=64,i0=4194304;function Ju(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function wm(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,s=r&268435455;if(s!==0){var o=s&~a;o!==0?n=Ju(o):(i&=s,i!==0&&(n=Ju(i)))}else s=r&~a,s!==0?n=Ju(s):i!==0&&(n=Ju(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Si(t),a=1<<r,n|=e[r],t&=~a;return n}function MI(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function II(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-Si(i),o=1<<s,c=a[s];c===-1?(!(o&r)||o&n)&&(a[s]=MI(o,t)):c<=t&&(e.expiredLanes|=o),i&=~o}}function mv(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function rA(){var e=a0;return a0<<=1,!(a0&4194240)&&(a0=64),e}function Fg(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function xf(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Si(t),e[t]=r}function FI(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Si(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function y1(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Si(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var zt=0;function nA(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var aA,b1,iA,sA,oA,hv=!1,s0=[],Zs=null,eo=null,to=null,Ad=new Map,Td=new Map,Hs=[],LI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function BN(e,t){switch(e){case"focusin":case"focusout":Zs=null;break;case"dragenter":case"dragleave":eo=null;break;case"mouseover":case"mouseout":to=null;break;case"pointerover":case"pointerout":Ad.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Td.delete(t.pointerId)}}function Au(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=yf(t),t!==null&&b1(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function BI(e,t,r,n,a){switch(t){case"focusin":return Zs=Au(Zs,e,t,r,n,a),!0;case"dragenter":return eo=Au(eo,e,t,r,n,a),!0;case"mouseover":return to=Au(to,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return Ad.set(i,Au(Ad.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,Td.set(i,Au(Td.get(i)||null,e,t,r,n,a)),!0}return!1}function lA(e){var t=Wo(e.target);if(t!==null){var r=Ml(t);if(r!==null){if(t=r.tag,t===13){if(t=YC(r),t!==null){e.blockedOn=t,oA(e.priority,function(){iA(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function J0(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=pv(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);cv=n,r.target.dispatchEvent(n),cv=null}else return t=yf(r),t!==null&&b1(t),e.blockedOn=r,!1;t.shift()}return!0}function jN(e,t,r){J0(e)&&r.delete(t)}function jI(){hv=!1,Zs!==null&&J0(Zs)&&(Zs=null),eo!==null&&J0(eo)&&(eo=null),to!==null&&J0(to)&&(to=null),Ad.forEach(jN),Td.forEach(jN)}function Tu(e,t){e.blockedOn===t&&(e.blockedOn=null,hv||(hv=!0,Da.unstable_scheduleCallback(Da.unstable_NormalPriority,jI)))}function Pd(e){function t(a){return Tu(a,e)}if(0<s0.length){Tu(s0[0],e);for(var r=1;r<s0.length;r++){var n=s0[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Zs!==null&&Tu(Zs,e),eo!==null&&Tu(eo,e),to!==null&&Tu(to,e),Ad.forEach(t),Td.forEach(t),r=0;r<Hs.length;r++)n=Hs[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Hs.length&&(r=Hs[0],r.blockedOn===null);)lA(r),r.blockedOn===null&&Hs.shift()}var wc=Cs.ReactCurrentBatchConfig,Nm=!0;function $I(e,t,r,n){var a=zt,i=wc.transition;wc.transition=null;try{zt=1,w1(e,t,r,n)}finally{zt=a,wc.transition=i}}function UI(e,t,r,n){var a=zt,i=wc.transition;wc.transition=null;try{zt=4,w1(e,t,r,n)}finally{zt=a,wc.transition=i}}function w1(e,t,r,n){if(Nm){var a=pv(e,t,r,n);if(a===null)Vg(e,t,n,Sm,r),BN(e,n);else if(BI(a,e,t,r,n))n.stopPropagation();else if(BN(e,n),t&4&&-1<LI.indexOf(e)){for(;a!==null;){var i=yf(a);if(i!==null&&aA(i),i=pv(e,t,r,n),i===null&&Vg(e,t,n,Sm,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else Vg(e,t,n,null,r)}}var Sm=null;function pv(e,t,r,n){if(Sm=null,e=x1(n),e=Wo(e),e!==null)if(t=Ml(e),t===null)e=null;else if(r=t.tag,r===13){if(e=YC(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Sm=e,null}function cA(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(AI()){case v1:return 1;case eA:return 4;case bm:case TI:return 16;case tA:return 536870912;default:return 16}default:return 16}}var Vs=null,N1=null,Q0=null;function uA(){if(Q0)return Q0;var e,t=N1,r=t.length,n,a="value"in Vs?Vs.value:Vs.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var s=r-e;for(n=1;n<=s&&t[r-n]===a[i-n];n++);return Q0=a.slice(e,1<n?1-n:void 0)}function Z0(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function o0(){return!0}function $N(){return!1}function Ba(e){function t(r,n,a,i,s){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?o0:$N,this.isPropagationStopped=$N,this}return pr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=o0)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=o0)},persist:function(){},isPersistent:o0}),t}var ru={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},S1=Ba(ru),vf=pr({},ru,{view:0,detail:0}),zI=Ba(vf),Lg,Bg,Pu,qh=pr({},vf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:k1,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Pu&&(Pu&&e.type==="mousemove"?(Lg=e.screenX-Pu.screenX,Bg=e.screenY-Pu.screenY):Bg=Lg=0,Pu=e),Lg)},movementY:function(e){return"movementY"in e?e.movementY:Bg}}),UN=Ba(qh),HI=pr({},qh,{dataTransfer:0}),WI=Ba(HI),GI=pr({},vf,{relatedTarget:0}),jg=Ba(GI),VI=pr({},ru,{animationName:0,elapsedTime:0,pseudoElement:0}),KI=Ba(VI),XI=pr({},ru,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),qI=Ba(XI),YI=pr({},ru,{data:0}),zN=Ba(YI),JI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},QI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ZI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function eF(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=ZI[e])?!!t[e]:!1}function k1(){return eF}var tF=pr({},vf,{key:function(e){if(e.key){var t=JI[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Z0(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?QI[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:k1,charCode:function(e){return e.type==="keypress"?Z0(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Z0(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),rF=Ba(tF),nF=pr({},qh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),HN=Ba(nF),aF=pr({},vf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:k1}),iF=Ba(aF),sF=pr({},ru,{propertyName:0,elapsedTime:0,pseudoElement:0}),oF=Ba(sF),lF=pr({},qh,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),cF=Ba(lF),uF=[9,13,27,32],_1=xs&&"CompositionEvent"in window,sd=null;xs&&"documentMode"in document&&(sd=document.documentMode);var dF=xs&&"TextEvent"in window&&!sd,dA=xs&&(!_1||sd&&8<sd&&11>=sd),WN=String.fromCharCode(32),GN=!1;function fA(e,t){switch(e){case"keyup":return uF.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function mA(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var nc=!1;function fF(e,t){switch(e){case"compositionend":return mA(t);case"keypress":return t.which!==32?null:(GN=!0,WN);case"textInput":return e=t.data,e===WN&&GN?null:e;default:return null}}function mF(e,t){if(nc)return e==="compositionend"||!_1&&fA(e,t)?(e=uA(),Q0=N1=Vs=null,nc=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return dA&&t.locale!=="ko"?null:t.data;default:return null}}var hF={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function VN(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!hF[e.type]:t==="textarea"}function hA(e,t,r,n){GC(n),t=km(t,"onChange"),0<t.length&&(r=new S1("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var od=null,Od=null;function pF(e){_A(e,0)}function Yh(e){var t=sc(e);if(BC(t))return e}function gF(e,t){if(e==="change")return t}var pA=!1;if(xs){var $g;if(xs){var Ug="oninput"in document;if(!Ug){var KN=document.createElement("div");KN.setAttribute("oninput","return;"),Ug=typeof KN.oninput=="function"}$g=Ug}else $g=!1;pA=$g&&(!document.documentMode||9<document.documentMode)}function XN(){od&&(od.detachEvent("onpropertychange",gA),Od=od=null)}function gA(e){if(e.propertyName==="value"&&Yh(Od)){var t=[];hA(t,Od,e,x1(e)),qC(pF,t)}}function xF(e,t,r){e==="focusin"?(XN(),od=t,Od=r,od.attachEvent("onpropertychange",gA)):e==="focusout"&&XN()}function vF(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Yh(Od)}function yF(e,t){if(e==="click")return Yh(t)}function bF(e,t){if(e==="input"||e==="change")return Yh(t)}function wF(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ti=typeof Object.is=="function"?Object.is:wF;function Dd(e,t){if(Ti(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!Jx.call(t,a)||!Ti(e[a],t[a]))return!1}return!0}function qN(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function YN(e,t){var r=qN(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=qN(r)}}function xA(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?xA(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function vA(){for(var e=window,t=xm();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=xm(e.document)}return t}function E1(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function NF(e){var t=vA(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&xA(r.ownerDocument.documentElement,r)){if(n!==null&&E1(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=YN(r,i);var s=YN(r,n);a&&s&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var SF=xs&&"documentMode"in document&&11>=document.documentMode,ac=null,gv=null,ld=null,xv=!1;function JN(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;xv||ac==null||ac!==xm(n)||(n=ac,"selectionStart"in n&&E1(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),ld&&Dd(ld,n)||(ld=n,n=km(gv,"onSelect"),0<n.length&&(t=new S1("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=ac)))}function l0(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var ic={animationend:l0("Animation","AnimationEnd"),animationiteration:l0("Animation","AnimationIteration"),animationstart:l0("Animation","AnimationStart"),transitionend:l0("Transition","TransitionEnd")},zg={},yA={};xs&&(yA=document.createElement("div").style,"AnimationEvent"in window||(delete ic.animationend.animation,delete ic.animationiteration.animation,delete ic.animationstart.animation),"TransitionEvent"in window||delete ic.transitionend.transition);function Jh(e){if(zg[e])return zg[e];if(!ic[e])return e;var t=ic[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in yA)return zg[e]=t[r];return e}var bA=Jh("animationend"),wA=Jh("animationiteration"),NA=Jh("animationstart"),SA=Jh("transitionend"),kA=new Map,QN="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ko(e,t){kA.set(e,t),Rl(t,[e])}for(var Hg=0;Hg<QN.length;Hg++){var Wg=QN[Hg],kF=Wg.toLowerCase(),_F=Wg[0].toUpperCase()+Wg.slice(1);ko(kF,"on"+_F)}ko(bA,"onAnimationEnd");ko(wA,"onAnimationIteration");ko(NA,"onAnimationStart");ko("dblclick","onDoubleClick");ko("focusin","onFocus");ko("focusout","onBlur");ko(SA,"onTransitionEnd");Oc("onMouseEnter",["mouseout","mouseover"]);Oc("onMouseLeave",["mouseout","mouseover"]);Oc("onPointerEnter",["pointerout","pointerover"]);Oc("onPointerLeave",["pointerout","pointerover"]);Rl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Rl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Rl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Rl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Rl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Rl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Qu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),EF=new Set("cancel close invalid load scroll toggle".split(" ").concat(Qu));function ZN(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,kI(n,t,void 0,e),e.currentTarget=null}function _A(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var s=n.length-1;0<=s;s--){var o=n[s],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==i&&a.isPropagationStopped())break e;ZN(a,o,u),i=c}else for(s=0;s<n.length;s++){if(o=n[s],c=o.instance,u=o.currentTarget,o=o.listener,c!==i&&a.isPropagationStopped())break e;ZN(a,o,u),i=c}}}if(ym)throw e=fv,ym=!1,fv=null,e}function Jt(e,t){var r=t[Nv];r===void 0&&(r=t[Nv]=new Set);var n=e+"__bubble";r.has(n)||(EA(t,e,2,!1),r.add(n))}function Gg(e,t,r){var n=0;t&&(n|=4),EA(r,e,n,t)}var c0="_reactListening"+Math.random().toString(36).slice(2);function Rd(e){if(!e[c0]){e[c0]=!0,RC.forEach(function(r){r!=="selectionchange"&&(EF.has(r)||Gg(r,!1,e),Gg(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[c0]||(t[c0]=!0,Gg("selectionchange",!1,t))}}function EA(e,t,r,n){switch(cA(t)){case 1:var a=$I;break;case 4:a=UI;break;default:a=w1}r=a.bind(null,t,r,e),a=void 0,!dv||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Vg(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(s===4)for(s=n.return;s!==null;){var c=s.tag;if((c===3||c===4)&&(c=s.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;s=s.return}for(;o!==null;){if(s=Wo(o),s===null)return;if(c=s.tag,c===5||c===6){n=i=s;continue e}o=o.parentNode}}n=n.return}qC(function(){var u=i,d=x1(r),f=[];e:{var h=kA.get(e);if(h!==void 0){var p=S1,x=e;switch(e){case"keypress":if(Z0(r)===0)break e;case"keydown":case"keyup":p=rF;break;case"focusin":x="focus",p=jg;break;case"focusout":x="blur",p=jg;break;case"beforeblur":case"afterblur":p=jg;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=UN;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=WI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=iF;break;case bA:case wA:case NA:p=KI;break;case SA:p=oF;break;case"scroll":p=zI;break;case"wheel":p=cF;break;case"copy":case"cut":case"paste":p=qI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=HN}var g=(t&4)!==0,y=!g&&e==="scroll",v=g?h!==null?h+"Capture":null:h;g=[];for(var w=u,b;w!==null;){b=w;var S=b.stateNode;if(b.tag===5&&S!==null&&(b=S,v!==null&&(S=Cd(w,v),S!=null&&g.push(Md(w,S,b)))),y)break;w=w.return}0<g.length&&(h=new p(h,x,null,r,d),f.push({event:h,listeners:g}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",h&&r!==cv&&(x=r.relatedTarget||r.fromElement)&&(Wo(x)||x[vs]))break e;if((p||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,p?(x=r.relatedTarget||r.toElement,p=u,x=x?Wo(x):null,x!==null&&(y=Ml(x),x!==y||x.tag!==5&&x.tag!==6)&&(x=null)):(p=null,x=u),p!==x)){if(g=UN,S="onMouseLeave",v="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(g=HN,S="onPointerLeave",v="onPointerEnter",w="pointer"),y=p==null?h:sc(p),b=x==null?h:sc(x),h=new g(S,w+"leave",p,r,d),h.target=y,h.relatedTarget=b,S=null,Wo(d)===u&&(g=new g(v,w+"enter",x,r,d),g.target=b,g.relatedTarget=y,S=g),y=S,p&&x)t:{for(g=p,v=x,w=0,b=g;b;b=Gl(b))w++;for(b=0,S=v;S;S=Gl(S))b++;for(;0<w-b;)g=Gl(g),w--;for(;0<b-w;)v=Gl(v),b--;for(;w--;){if(g===v||v!==null&&g===v.alternate)break t;g=Gl(g),v=Gl(v)}g=null}else g=null;p!==null&&eS(f,h,p,g,!1),x!==null&&y!==null&&eS(f,y,x,g,!0)}}e:{if(h=u?sc(u):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var k=gF;else if(VN(h))if(pA)k=bF;else{k=vF;var _=xF}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(k=yF);if(k&&(k=k(e,u))){hA(f,k,r,d);break e}_&&_(e,h,u),e==="focusout"&&(_=h._wrapperState)&&_.controlled&&h.type==="number"&&av(h,"number",h.value)}switch(_=u?sc(u):window,e){case"focusin":(VN(_)||_.contentEditable==="true")&&(ac=_,gv=u,ld=null);break;case"focusout":ld=gv=ac=null;break;case"mousedown":xv=!0;break;case"contextmenu":case"mouseup":case"dragend":xv=!1,JN(f,r,d);break;case"selectionchange":if(SF)break;case"keydown":case"keyup":JN(f,r,d)}var E;if(_1)e:{switch(e){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else nc?fA(e,r)&&(P="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(P="onCompositionStart");P&&(dA&&r.locale!=="ko"&&(nc||P!=="onCompositionStart"?P==="onCompositionEnd"&&nc&&(E=uA()):(Vs=d,N1="value"in Vs?Vs.value:Vs.textContent,nc=!0)),_=km(u,P),0<_.length&&(P=new zN(P,e,null,r,d),f.push({event:P,listeners:_}),E?P.data=E:(E=mA(r),E!==null&&(P.data=E)))),(E=dF?fF(e,r):mF(e,r))&&(u=km(u,"onBeforeInput"),0<u.length&&(d=new zN("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=E))}_A(f,t)})}function Md(e,t,r){return{instance:e,listener:t,currentTarget:r}}function km(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Cd(e,r),i!=null&&n.unshift(Md(e,i,a)),i=Cd(e,t),i!=null&&n.push(Md(e,i,a))),e=e.return}return n}function Gl(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function eS(e,t,r,n,a){for(var i=t._reactName,s=[];r!==null&&r!==n;){var o=r,c=o.alternate,u=o.stateNode;if(c!==null&&c===n)break;o.tag===5&&u!==null&&(o=u,a?(c=Cd(r,i),c!=null&&s.unshift(Md(r,c,o))):a||(c=Cd(r,i),c!=null&&s.push(Md(r,c,o)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var CF=/\r\n?/g,AF=/\u0000|\uFFFD/g;function tS(e){return(typeof e=="string"?e:""+e).replace(CF,`
`).replace(AF,"")}function u0(e,t,r){if(t=tS(t),tS(e)!==t&&r)throw Error(ke(425))}function _m(){}var vv=null,yv=null;function bv(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var wv=typeof setTimeout=="function"?setTimeout:void 0,TF=typeof clearTimeout=="function"?clearTimeout:void 0,rS=typeof Promise=="function"?Promise:void 0,PF=typeof queueMicrotask=="function"?queueMicrotask:typeof rS<"u"?function(e){return rS.resolve(null).then(e).catch(OF)}:wv;function OF(e){setTimeout(function(){throw e})}function Kg(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),Pd(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Pd(t)}function ro(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function nS(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var nu=Math.random().toString(36).slice(2),Bi="__reactFiber$"+nu,Id="__reactProps$"+nu,vs="__reactContainer$"+nu,Nv="__reactEvents$"+nu,DF="__reactListeners$"+nu,RF="__reactHandles$"+nu;function Wo(e){var t=e[Bi];if(t)return t;for(var r=e.parentNode;r;){if(t=r[vs]||r[Bi]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=nS(e);e!==null;){if(r=e[Bi])return r;e=nS(e)}return t}e=r,r=e.parentNode}return null}function yf(e){return e=e[Bi]||e[vs],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function sc(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ke(33))}function Qh(e){return e[Id]||null}var Sv=[],oc=-1;function _o(e){return{current:e}}function er(e){0>oc||(e.current=Sv[oc],Sv[oc]=null,oc--)}function qt(e,t){oc++,Sv[oc]=e.current,e.current=t}var fo={},Rn=_o(fo),ia=_o(!1),ul=fo;function Dc(e,t){var r=e.type.contextTypes;if(!r)return fo;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function sa(e){return e=e.childContextTypes,e!=null}function Em(){er(ia),er(Rn)}function aS(e,t,r){if(Rn.current!==fo)throw Error(ke(168));qt(Rn,t),qt(ia,r)}function CA(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(ke(108,xI(e)||"Unknown",a));return pr({},r,n)}function Cm(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||fo,ul=Rn.current,qt(Rn,e),qt(ia,ia.current),!0}function iS(e,t,r){var n=e.stateNode;if(!n)throw Error(ke(169));r?(e=CA(e,t,ul),n.__reactInternalMemoizedMergedChildContext=e,er(ia),er(Rn),qt(Rn,e)):er(ia),qt(ia,r)}var ns=null,Zh=!1,Xg=!1;function AA(e){ns===null?ns=[e]:ns.push(e)}function MF(e){Zh=!0,AA(e)}function Eo(){if(!Xg&&ns!==null){Xg=!0;var e=0,t=zt;try{var r=ns;for(zt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ns=null,Zh=!1}catch(a){throw ns!==null&&(ns=ns.slice(e+1)),ZC(v1,Eo),a}finally{zt=t,Xg=!1}}return null}var lc=[],cc=0,Am=null,Tm=0,Ja=[],Qa=0,dl=null,ss=1,os="";function Bo(e,t){lc[cc++]=Tm,lc[cc++]=Am,Am=e,Tm=t}function TA(e,t,r){Ja[Qa++]=ss,Ja[Qa++]=os,Ja[Qa++]=dl,dl=e;var n=ss;e=os;var a=32-Si(n)-1;n&=~(1<<a),r+=1;var i=32-Si(t)+a;if(30<i){var s=a-a%5;i=(n&(1<<s)-1).toString(32),n>>=s,a-=s,ss=1<<32-Si(t)+a|r<<a|n,os=i+e}else ss=1<<i|r<<a|n,os=e}function C1(e){e.return!==null&&(Bo(e,1),TA(e,1,0))}function A1(e){for(;e===Am;)Am=lc[--cc],lc[cc]=null,Tm=lc[--cc],lc[cc]=null;for(;e===dl;)dl=Ja[--Qa],Ja[Qa]=null,os=Ja[--Qa],Ja[Qa]=null,ss=Ja[--Qa],Ja[Qa]=null}var Aa=null,_a=null,ir=!1,yi=null;function PA(e,t){var r=ei(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function sS(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Aa=e,_a=ro(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Aa=e,_a=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=dl!==null?{id:ss,overflow:os}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=ei(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Aa=e,_a=null,!0):!1;default:return!1}}function kv(e){return(e.mode&1)!==0&&(e.flags&128)===0}function _v(e){if(ir){var t=_a;if(t){var r=t;if(!sS(e,t)){if(kv(e))throw Error(ke(418));t=ro(r.nextSibling);var n=Aa;t&&sS(e,t)?PA(n,r):(e.flags=e.flags&-4097|2,ir=!1,Aa=e)}}else{if(kv(e))throw Error(ke(418));e.flags=e.flags&-4097|2,ir=!1,Aa=e}}}function oS(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Aa=e}function d0(e){if(e!==Aa)return!1;if(!ir)return oS(e),ir=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!bv(e.type,e.memoizedProps)),t&&(t=_a)){if(kv(e))throw OA(),Error(ke(418));for(;t;)PA(e,t),t=ro(t.nextSibling)}if(oS(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ke(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){_a=ro(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}_a=null}}else _a=Aa?ro(e.stateNode.nextSibling):null;return!0}function OA(){for(var e=_a;e;)e=ro(e.nextSibling)}function Rc(){_a=Aa=null,ir=!1}function T1(e){yi===null?yi=[e]:yi.push(e)}var IF=Cs.ReactCurrentBatchConfig;function Ou(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ke(309));var n=r.stateNode}if(!n)throw Error(ke(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(s){var o=a.refs;s===null?delete o[i]:o[i]=s},t._stringRef=i,t)}if(typeof e!="string")throw Error(ke(284));if(!r._owner)throw Error(ke(290,e))}return e}function f0(e,t){throw e=Object.prototype.toString.call(t),Error(ke(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function lS(e){var t=e._init;return t(e._payload)}function DA(e){function t(v,w){if(e){var b=v.deletions;b===null?(v.deletions=[w],v.flags|=16):b.push(w)}}function r(v,w){if(!e)return null;for(;w!==null;)t(v,w),w=w.sibling;return null}function n(v,w){for(v=new Map;w!==null;)w.key!==null?v.set(w.key,w):v.set(w.index,w),w=w.sibling;return v}function a(v,w){return v=so(v,w),v.index=0,v.sibling=null,v}function i(v,w,b){return v.index=b,e?(b=v.alternate,b!==null?(b=b.index,b<w?(v.flags|=2,w):b):(v.flags|=2,w)):(v.flags|=1048576,w)}function s(v){return e&&v.alternate===null&&(v.flags|=2),v}function o(v,w,b,S){return w===null||w.tag!==6?(w=tx(b,v.mode,S),w.return=v,w):(w=a(w,b),w.return=v,w)}function c(v,w,b,S){var k=b.type;return k===rc?d(v,w,b.props.children,S,b.key):w!==null&&(w.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===js&&lS(k)===w.type)?(S=a(w,b.props),S.ref=Ou(v,w,b),S.return=v,S):(S=sm(b.type,b.key,b.props,null,v.mode,S),S.ref=Ou(v,w,b),S.return=v,S)}function u(v,w,b,S){return w===null||w.tag!==4||w.stateNode.containerInfo!==b.containerInfo||w.stateNode.implementation!==b.implementation?(w=rx(b,v.mode,S),w.return=v,w):(w=a(w,b.children||[]),w.return=v,w)}function d(v,w,b,S,k){return w===null||w.tag!==7?(w=el(b,v.mode,S,k),w.return=v,w):(w=a(w,b),w.return=v,w)}function f(v,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return w=tx(""+w,v.mode,b),w.return=v,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case t0:return b=sm(w.type,w.key,w.props,null,v.mode,b),b.ref=Ou(v,null,w),b.return=v,b;case tc:return w=rx(w,v.mode,b),w.return=v,w;case js:var S=w._init;return f(v,S(w._payload),b)}if(Yu(w)||Eu(w))return w=el(w,v.mode,b,null),w.return=v,w;f0(v,w)}return null}function h(v,w,b,S){var k=w!==null?w.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return k!==null?null:o(v,w,""+b,S);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case t0:return b.key===k?c(v,w,b,S):null;case tc:return b.key===k?u(v,w,b,S):null;case js:return k=b._init,h(v,w,k(b._payload),S)}if(Yu(b)||Eu(b))return k!==null?null:d(v,w,b,S,null);f0(v,b)}return null}function p(v,w,b,S,k){if(typeof S=="string"&&S!==""||typeof S=="number")return v=v.get(b)||null,o(w,v,""+S,k);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case t0:return v=v.get(S.key===null?b:S.key)||null,c(w,v,S,k);case tc:return v=v.get(S.key===null?b:S.key)||null,u(w,v,S,k);case js:var _=S._init;return p(v,w,b,_(S._payload),k)}if(Yu(S)||Eu(S))return v=v.get(b)||null,d(w,v,S,k,null);f0(w,S)}return null}function x(v,w,b,S){for(var k=null,_=null,E=w,P=w=0,A=null;E!==null&&P<b.length;P++){E.index>P?(A=E,E=null):A=E.sibling;var T=h(v,E,b[P],S);if(T===null){E===null&&(E=A);break}e&&E&&T.alternate===null&&t(v,E),w=i(T,w,P),_===null?k=T:_.sibling=T,_=T,E=A}if(P===b.length)return r(v,E),ir&&Bo(v,P),k;if(E===null){for(;P<b.length;P++)E=f(v,b[P],S),E!==null&&(w=i(E,w,P),_===null?k=E:_.sibling=E,_=E);return ir&&Bo(v,P),k}for(E=n(v,E);P<b.length;P++)A=p(E,v,P,b[P],S),A!==null&&(e&&A.alternate!==null&&E.delete(A.key===null?P:A.key),w=i(A,w,P),_===null?k=A:_.sibling=A,_=A);return e&&E.forEach(function(R){return t(v,R)}),ir&&Bo(v,P),k}function g(v,w,b,S){var k=Eu(b);if(typeof k!="function")throw Error(ke(150));if(b=k.call(b),b==null)throw Error(ke(151));for(var _=k=null,E=w,P=w=0,A=null,T=b.next();E!==null&&!T.done;P++,T=b.next()){E.index>P?(A=E,E=null):A=E.sibling;var R=h(v,E,T.value,S);if(R===null){E===null&&(E=A);break}e&&E&&R.alternate===null&&t(v,E),w=i(R,w,P),_===null?k=R:_.sibling=R,_=R,E=A}if(T.done)return r(v,E),ir&&Bo(v,P),k;if(E===null){for(;!T.done;P++,T=b.next())T=f(v,T.value,S),T!==null&&(w=i(T,w,P),_===null?k=T:_.sibling=T,_=T);return ir&&Bo(v,P),k}for(E=n(v,E);!T.done;P++,T=b.next())T=p(E,v,P,T.value,S),T!==null&&(e&&T.alternate!==null&&E.delete(T.key===null?P:T.key),w=i(T,w,P),_===null?k=T:_.sibling=T,_=T);return e&&E.forEach(function(D){return t(v,D)}),ir&&Bo(v,P),k}function y(v,w,b,S){if(typeof b=="object"&&b!==null&&b.type===rc&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case t0:e:{for(var k=b.key,_=w;_!==null;){if(_.key===k){if(k=b.type,k===rc){if(_.tag===7){r(v,_.sibling),w=a(_,b.props.children),w.return=v,v=w;break e}}else if(_.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===js&&lS(k)===_.type){r(v,_.sibling),w=a(_,b.props),w.ref=Ou(v,_,b),w.return=v,v=w;break e}r(v,_);break}else t(v,_);_=_.sibling}b.type===rc?(w=el(b.props.children,v.mode,S,b.key),w.return=v,v=w):(S=sm(b.type,b.key,b.props,null,v.mode,S),S.ref=Ou(v,w,b),S.return=v,v=S)}return s(v);case tc:e:{for(_=b.key;w!==null;){if(w.key===_)if(w.tag===4&&w.stateNode.containerInfo===b.containerInfo&&w.stateNode.implementation===b.implementation){r(v,w.sibling),w=a(w,b.children||[]),w.return=v,v=w;break e}else{r(v,w);break}else t(v,w);w=w.sibling}w=rx(b,v.mode,S),w.return=v,v=w}return s(v);case js:return _=b._init,y(v,w,_(b._payload),S)}if(Yu(b))return x(v,w,b,S);if(Eu(b))return g(v,w,b,S);f0(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,w!==null&&w.tag===6?(r(v,w.sibling),w=a(w,b),w.return=v,v=w):(r(v,w),w=tx(b,v.mode,S),w.return=v,v=w),s(v)):r(v,w)}return y}var Mc=DA(!0),RA=DA(!1),Pm=_o(null),Om=null,uc=null,P1=null;function O1(){P1=uc=Om=null}function D1(e){var t=Pm.current;er(Pm),e._currentValue=t}function Ev(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Nc(e,t){Om=e,P1=uc=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ra=!0),e.firstContext=null)}function oi(e){var t=e._currentValue;if(P1!==e)if(e={context:e,memoizedValue:t,next:null},uc===null){if(Om===null)throw Error(ke(308));uc=e,Om.dependencies={lanes:0,firstContext:e}}else uc=uc.next=e;return t}var Go=null;function R1(e){Go===null?Go=[e]:Go.push(e)}function MA(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,R1(t)):(r.next=a.next,a.next=r),t.interleaved=r,ys(e,n)}function ys(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var $s=!1;function M1(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function IA(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function fs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function no(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Dt&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,ys(e,r)}return a=n.interleaved,a===null?(t.next=t,R1(n)):(t.next=a.next,a.next=t),n.interleaved=t,ys(e,r)}function em(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,y1(e,r)}}function cS(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=s:i=i.next=s,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Dm(e,t,r,n){var a=e.updateQueue;$s=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var c=o,u=c.next;c.next=null,s===null?i=u:s.next=u,s=c;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==s&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=c))}if(i!==null){var f=a.baseState;s=0,d=u=c=null,o=i;do{var h=o.lane,p=o.eventTime;if((n&h)===h){d!==null&&(d=d.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var x=e,g=o;switch(h=t,p=r,g.tag){case 1:if(x=g.payload,typeof x=="function"){f=x.call(p,f,h);break e}f=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=g.payload,h=typeof x=="function"?x.call(p,f,h):x,h==null)break e;f=pr({},f,h);break e;case 2:$s=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=a.effects,h===null?a.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=p,c=f):d=d.next=p,s|=h;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;h=o,o=h.next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}while(1);if(d===null&&(c=f),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=d,t=a.shared.interleaved,t!==null){a=t;do s|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);ml|=s,e.lanes=s,e.memoizedState=f}}function uS(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(ke(191,a));a.call(n)}}}var bf={},zi=_o(bf),Fd=_o(bf),Ld=_o(bf);function Vo(e){if(e===bf)throw Error(ke(174));return e}function I1(e,t){switch(qt(Ld,t),qt(Fd,e),qt(zi,bf),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:sv(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=sv(t,e)}er(zi),qt(zi,t)}function Ic(){er(zi),er(Fd),er(Ld)}function FA(e){Vo(Ld.current);var t=Vo(zi.current),r=sv(t,e.type);t!==r&&(qt(Fd,e),qt(zi,r))}function F1(e){Fd.current===e&&(er(zi),er(Fd))}var fr=_o(0);function Rm(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var qg=[];function L1(){for(var e=0;e<qg.length;e++)qg[e]._workInProgressVersionPrimary=null;qg.length=0}var tm=Cs.ReactCurrentDispatcher,Yg=Cs.ReactCurrentBatchConfig,fl=0,hr=null,Br=null,Jr=null,Mm=!1,cd=!1,Bd=0,FF=0;function vn(){throw Error(ke(321))}function B1(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ti(e[r],t[r]))return!1;return!0}function j1(e,t,r,n,a,i){if(fl=i,hr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,tm.current=e===null||e.memoizedState===null?$F:UF,e=r(n,a),cd){i=0;do{if(cd=!1,Bd=0,25<=i)throw Error(ke(301));i+=1,Jr=Br=null,t.updateQueue=null,tm.current=zF,e=r(n,a)}while(cd)}if(tm.current=Im,t=Br!==null&&Br.next!==null,fl=0,Jr=Br=hr=null,Mm=!1,t)throw Error(ke(300));return e}function $1(){var e=Bd!==0;return Bd=0,e}function Li(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jr===null?hr.memoizedState=Jr=e:Jr=Jr.next=e,Jr}function li(){if(Br===null){var e=hr.alternate;e=e!==null?e.memoizedState:null}else e=Br.next;var t=Jr===null?hr.memoizedState:Jr.next;if(t!==null)Jr=t,Br=e;else{if(e===null)throw Error(ke(310));Br=e,e={memoizedState:Br.memoizedState,baseState:Br.baseState,baseQueue:Br.baseQueue,queue:Br.queue,next:null},Jr===null?hr.memoizedState=Jr=e:Jr=Jr.next=e}return Jr}function jd(e,t){return typeof t=="function"?t(e):t}function Jg(e){var t=li(),r=t.queue;if(r===null)throw Error(ke(311));r.lastRenderedReducer=e;var n=Br,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var s=a.next;a.next=i.next,i.next=s}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var o=s=null,c=null,u=i;do{var d=u.lane;if((fl&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(o=c=f,s=n):c=c.next=f,hr.lanes|=d,ml|=d}u=u.next}while(u!==null&&u!==i);c===null?s=n:c.next=o,Ti(n,t.memoizedState)||(ra=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,hr.lanes|=i,ml|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Qg(e){var t=li(),r=t.queue;if(r===null)throw Error(ke(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var s=a=a.next;do i=e(i,s.action),s=s.next;while(s!==a);Ti(i,t.memoizedState)||(ra=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function LA(){}function BA(e,t){var r=hr,n=li(),a=t(),i=!Ti(n.memoizedState,a);if(i&&(n.memoizedState=a,ra=!0),n=n.queue,U1(UA.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||Jr!==null&&Jr.memoizedState.tag&1){if(r.flags|=2048,$d(9,$A.bind(null,r,n,a,t),void 0,null),nn===null)throw Error(ke(349));fl&30||jA(r,t,a)}return a}function jA(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=hr.updateQueue,t===null?(t={lastEffect:null,stores:null},hr.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function $A(e,t,r,n){t.value=r,t.getSnapshot=n,zA(t)&&HA(e)}function UA(e,t,r){return r(function(){zA(t)&&HA(e)})}function zA(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ti(e,r)}catch{return!0}}function HA(e){var t=ys(e,1);t!==null&&ki(t,e,1,-1)}function dS(e){var t=Li();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:jd,lastRenderedState:e},t.queue=e,e=e.dispatch=jF.bind(null,hr,e),[t.memoizedState,e]}function $d(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=hr.updateQueue,t===null?(t={lastEffect:null,stores:null},hr.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function WA(){return li().memoizedState}function rm(e,t,r,n){var a=Li();hr.flags|=e,a.memoizedState=$d(1|t,r,void 0,n===void 0?null:n)}function ep(e,t,r,n){var a=li();n=n===void 0?null:n;var i=void 0;if(Br!==null){var s=Br.memoizedState;if(i=s.destroy,n!==null&&B1(n,s.deps)){a.memoizedState=$d(t,r,i,n);return}}hr.flags|=e,a.memoizedState=$d(1|t,r,i,n)}function fS(e,t){return rm(8390656,8,e,t)}function U1(e,t){return ep(2048,8,e,t)}function GA(e,t){return ep(4,2,e,t)}function VA(e,t){return ep(4,4,e,t)}function KA(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function XA(e,t,r){return r=r!=null?r.concat([e]):null,ep(4,4,KA.bind(null,t,e),r)}function z1(){}function qA(e,t){var r=li();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&B1(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function YA(e,t){var r=li();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&B1(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function JA(e,t,r){return fl&21?(Ti(r,t)||(r=rA(),hr.lanes|=r,ml|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ra=!0),e.memoizedState=r)}function LF(e,t){var r=zt;zt=r!==0&&4>r?r:4,e(!0);var n=Yg.transition;Yg.transition={};try{e(!1),t()}finally{zt=r,Yg.transition=n}}function QA(){return li().memoizedState}function BF(e,t,r){var n=io(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},ZA(e))eT(t,r);else if(r=MA(e,t,r,n),r!==null){var a=Wn();ki(r,e,n,a),tT(r,t,n)}}function jF(e,t,r){var n=io(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(ZA(e))eT(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var s=t.lastRenderedState,o=i(s,r);if(a.hasEagerState=!0,a.eagerState=o,Ti(o,s)){var c=t.interleaved;c===null?(a.next=a,R1(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch{}finally{}r=MA(e,t,a,n),r!==null&&(a=Wn(),ki(r,e,n,a),tT(r,t,n))}}function ZA(e){var t=e.alternate;return e===hr||t!==null&&t===hr}function eT(e,t){cd=Mm=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function tT(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,y1(e,r)}}var Im={readContext:oi,useCallback:vn,useContext:vn,useEffect:vn,useImperativeHandle:vn,useInsertionEffect:vn,useLayoutEffect:vn,useMemo:vn,useReducer:vn,useRef:vn,useState:vn,useDebugValue:vn,useDeferredValue:vn,useTransition:vn,useMutableSource:vn,useSyncExternalStore:vn,useId:vn,unstable_isNewReconciler:!1},$F={readContext:oi,useCallback:function(e,t){return Li().memoizedState=[e,t===void 0?null:t],e},useContext:oi,useEffect:fS,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,rm(4194308,4,KA.bind(null,t,e),r)},useLayoutEffect:function(e,t){return rm(4194308,4,e,t)},useInsertionEffect:function(e,t){return rm(4,2,e,t)},useMemo:function(e,t){var r=Li();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Li();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=BF.bind(null,hr,e),[n.memoizedState,e]},useRef:function(e){var t=Li();return e={current:e},t.memoizedState=e},useState:dS,useDebugValue:z1,useDeferredValue:function(e){return Li().memoizedState=e},useTransition:function(){var e=dS(!1),t=e[0];return e=LF.bind(null,e[1]),Li().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=hr,a=Li();if(ir){if(r===void 0)throw Error(ke(407));r=r()}else{if(r=t(),nn===null)throw Error(ke(349));fl&30||jA(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,fS(UA.bind(null,n,i,e),[e]),n.flags|=2048,$d(9,$A.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=Li(),t=nn.identifierPrefix;if(ir){var r=os,n=ss;r=(n&~(1<<32-Si(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Bd++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=FF++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},UF={readContext:oi,useCallback:qA,useContext:oi,useEffect:U1,useImperativeHandle:XA,useInsertionEffect:GA,useLayoutEffect:VA,useMemo:YA,useReducer:Jg,useRef:WA,useState:function(){return Jg(jd)},useDebugValue:z1,useDeferredValue:function(e){var t=li();return JA(t,Br.memoizedState,e)},useTransition:function(){var e=Jg(jd)[0],t=li().memoizedState;return[e,t]},useMutableSource:LA,useSyncExternalStore:BA,useId:QA,unstable_isNewReconciler:!1},zF={readContext:oi,useCallback:qA,useContext:oi,useEffect:U1,useImperativeHandle:XA,useInsertionEffect:GA,useLayoutEffect:VA,useMemo:YA,useReducer:Qg,useRef:WA,useState:function(){return Qg(jd)},useDebugValue:z1,useDeferredValue:function(e){var t=li();return Br===null?t.memoizedState=e:JA(t,Br.memoizedState,e)},useTransition:function(){var e=Qg(jd)[0],t=li().memoizedState;return[e,t]},useMutableSource:LA,useSyncExternalStore:BA,useId:QA,unstable_isNewReconciler:!1};function xi(e,t){if(e&&e.defaultProps){t=pr({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Cv(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:pr({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var tp={isMounted:function(e){return(e=e._reactInternals)?Ml(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Wn(),a=io(e),i=fs(n,a);i.payload=t,r!=null&&(i.callback=r),t=no(e,i,a),t!==null&&(ki(t,e,a,n),em(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Wn(),a=io(e),i=fs(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=no(e,i,a),t!==null&&(ki(t,e,a,n),em(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Wn(),n=io(e),a=fs(r,n);a.tag=2,t!=null&&(a.callback=t),t=no(e,a,n),t!==null&&(ki(t,e,n,r),em(t,e,n))}};function mS(e,t,r,n,a,i,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,s):t.prototype&&t.prototype.isPureReactComponent?!Dd(r,n)||!Dd(a,i):!0}function rT(e,t,r){var n=!1,a=fo,i=t.contextType;return typeof i=="object"&&i!==null?i=oi(i):(a=sa(t)?ul:Rn.current,n=t.contextTypes,i=(n=n!=null)?Dc(e,a):fo),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=tp,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function hS(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&tp.enqueueReplaceState(t,t.state,null)}function Av(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},M1(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=oi(i):(i=sa(t)?ul:Rn.current,a.context=Dc(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Cv(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&tp.enqueueReplaceState(a,a.state,null),Dm(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Fc(e,t){try{var r="",n=t;do r+=gI(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function Zg(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Tv(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var HF=typeof WeakMap=="function"?WeakMap:Map;function nT(e,t,r){r=fs(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Lm||(Lm=!0,jv=n),Tv(e,t)},r}function aT(e,t,r){r=fs(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){Tv(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Tv(e,t),typeof n!="function"&&(ao===null?ao=new Set([this]):ao.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function pS(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new HF;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=n8.bind(null,e,t,r),t.then(e,e))}function gS(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function xS(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=fs(-1,1),t.tag=2,no(r,t,1))),r.lanes|=1),e)}var WF=Cs.ReactCurrentOwner,ra=!1;function Ln(e,t,r,n){t.child=e===null?RA(t,null,r,n):Mc(t,e.child,r,n)}function vS(e,t,r,n,a){r=r.render;var i=t.ref;return Nc(t,a),n=j1(e,t,r,n,i,a),r=$1(),e!==null&&!ra?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,bs(e,t,a)):(ir&&r&&C1(t),t.flags|=1,Ln(e,t,n,a),t.child)}function yS(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!Y1(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,iT(e,t,i,n,a)):(e=sm(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var s=i.memoizedProps;if(r=r.compare,r=r!==null?r:Dd,r(s,n)&&e.ref===t.ref)return bs(e,t,a)}return t.flags|=1,e=so(i,n),e.ref=t.ref,e.return=t,t.child=e}function iT(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(Dd(i,n)&&e.ref===t.ref)if(ra=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(ra=!0);else return t.lanes=e.lanes,bs(e,t,a)}return Pv(e,t,r,n,a)}function sT(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},qt(fc,ma),ma|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,qt(fc,ma),ma|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,qt(fc,ma),ma|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,qt(fc,ma),ma|=n;return Ln(e,t,a,r),t.child}function oT(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Pv(e,t,r,n,a){var i=sa(r)?ul:Rn.current;return i=Dc(t,i),Nc(t,a),r=j1(e,t,r,n,i,a),n=$1(),e!==null&&!ra?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,bs(e,t,a)):(ir&&n&&C1(t),t.flags|=1,Ln(e,t,r,a),t.child)}function bS(e,t,r,n,a){if(sa(r)){var i=!0;Cm(t)}else i=!1;if(Nc(t,a),t.stateNode===null)nm(e,t),rT(t,r,n),Av(t,r,n,a),n=!0;else if(e===null){var s=t.stateNode,o=t.memoizedProps;s.props=o;var c=s.context,u=r.contextType;typeof u=="object"&&u!==null?u=oi(u):(u=sa(r)?ul:Rn.current,u=Dc(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof s.getSnapshotBeforeUpdate=="function";f||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==n||c!==u)&&hS(t,s,n,u),$s=!1;var h=t.memoizedState;s.state=h,Dm(t,n,s,a),c=t.memoizedState,o!==n||h!==c||ia.current||$s?(typeof d=="function"&&(Cv(t,r,d,n),c=t.memoizedState),(o=$s||mS(t,r,o,n,h,c,u))?(f||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),s.props=n,s.state=c,s.context=u,n=o):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,IA(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:xi(t.type,o),s.props=u,f=t.pendingProps,h=s.context,c=r.contextType,typeof c=="object"&&c!==null?c=oi(c):(c=sa(r)?ul:Rn.current,c=Dc(t,c));var p=r.getDerivedStateFromProps;(d=typeof p=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==f||h!==c)&&hS(t,s,n,c),$s=!1,h=t.memoizedState,s.state=h,Dm(t,n,s,a);var x=t.memoizedState;o!==f||h!==x||ia.current||$s?(typeof p=="function"&&(Cv(t,r,p,n),x=t.memoizedState),(u=$s||mS(t,r,u,n,h,x,c)||!1)?(d||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,x,c),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,x,c)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=x),s.props=n,s.state=x,s.context=c,n=u):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Ov(e,t,r,n,i,a)}function Ov(e,t,r,n,a,i){oT(e,t);var s=(t.flags&128)!==0;if(!n&&!s)return a&&iS(t,r,!1),bs(e,t,i);n=t.stateNode,WF.current=t;var o=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&s?(t.child=Mc(t,e.child,null,i),t.child=Mc(t,null,o,i)):Ln(e,t,o,i),t.memoizedState=n.state,a&&iS(t,r,!0),t.child}function lT(e){var t=e.stateNode;t.pendingContext?aS(e,t.pendingContext,t.pendingContext!==t.context):t.context&&aS(e,t.context,!1),I1(e,t.containerInfo)}function wS(e,t,r,n,a){return Rc(),T1(a),t.flags|=256,Ln(e,t,r,n),t.child}var Dv={dehydrated:null,treeContext:null,retryLane:0};function Rv(e){return{baseLanes:e,cachePool:null,transitions:null}}function cT(e,t,r){var n=t.pendingProps,a=fr.current,i=!1,s=(t.flags&128)!==0,o;if((o=s)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),qt(fr,a&1),e===null)return _v(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=n.children,e=n.fallback,i?(n=t.mode,i=t.child,s={mode:"hidden",children:s},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=s):i=ap(s,n,0,null),e=el(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Rv(r),t.memoizedState=Dv,e):H1(t,s));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return GF(e,t,s,n,o,a,r);if(i){i=n.fallback,s=t.mode,a=e.child,o=a.sibling;var c={mode:"hidden",children:n.children};return!(s&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=so(a,c),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?i=so(o,i):(i=el(i,s,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,s=e.child.memoizedState,s=s===null?Rv(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},i.memoizedState=s,i.childLanes=e.childLanes&~r,t.memoizedState=Dv,n}return i=e.child,e=i.sibling,n=so(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function H1(e,t){return t=ap({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function m0(e,t,r,n){return n!==null&&T1(n),Mc(t,e.child,null,r),e=H1(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function GF(e,t,r,n,a,i,s){if(r)return t.flags&256?(t.flags&=-257,n=Zg(Error(ke(422))),m0(e,t,s,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=ap({mode:"visible",children:n.children},a,0,null),i=el(i,a,s,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&Mc(t,e.child,null,s),t.child.memoizedState=Rv(s),t.memoizedState=Dv,i);if(!(t.mode&1))return m0(e,t,s,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(ke(419)),n=Zg(i,n,void 0),m0(e,t,s,n)}if(o=(s&e.childLanes)!==0,ra||o){if(n=nn,n!==null){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|s)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,ys(e,a),ki(n,e,a,-1))}return q1(),n=Zg(Error(ke(421))),m0(e,t,s,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=a8.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,_a=ro(a.nextSibling),Aa=t,ir=!0,yi=null,e!==null&&(Ja[Qa++]=ss,Ja[Qa++]=os,Ja[Qa++]=dl,ss=e.id,os=e.overflow,dl=t),t=H1(t,n.children),t.flags|=4096,t)}function NS(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Ev(e.return,t,r)}function ex(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function uT(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(Ln(e,t,n.children,r),n=fr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&NS(e,r,t);else if(e.tag===19)NS(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(qt(fr,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&Rm(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),ex(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Rm(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}ex(t,!0,r,null,i);break;case"together":ex(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function nm(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function bs(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ml|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ke(153));if(t.child!==null){for(e=t.child,r=so(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=so(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function VF(e,t,r){switch(t.tag){case 3:lT(t),Rc();break;case 5:FA(t);break;case 1:sa(t.type)&&Cm(t);break;case 4:I1(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;qt(Pm,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(qt(fr,fr.current&1),t.flags|=128,null):r&t.child.childLanes?cT(e,t,r):(qt(fr,fr.current&1),e=bs(e,t,r),e!==null?e.sibling:null);qt(fr,fr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return uT(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),qt(fr,fr.current),n)break;return null;case 22:case 23:return t.lanes=0,sT(e,t,r)}return bs(e,t,r)}var dT,Mv,fT,mT;dT=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Mv=function(){};fT=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Vo(zi.current);var i=null;switch(r){case"input":a=rv(e,a),n=rv(e,n),i=[];break;case"select":a=pr({},a,{value:void 0}),n=pr({},n,{value:void 0}),i=[];break;case"textarea":a=iv(e,a),n=iv(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=_m)}ov(r,n);var s;r=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var o=a[u];for(s in o)o.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(_d.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var c=n[u];if(o=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&c!==o&&(c!=null||o!=null))if(u==="style")if(o){for(s in o)!o.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in c)c.hasOwnProperty(s)&&o[s]!==c[s]&&(r||(r={}),r[s]=c[s])}else r||(i||(i=[]),i.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(_d.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Jt("scroll",e),i||o===c||(i=[])):(i=i||[]).push(u,c))}r&&(i=i||[]).push("style",r);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};mT=function(e,t,r,n){r!==n&&(t.flags|=4)};function Du(e,t){if(!ir)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function yn(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function KF(e,t,r){var n=t.pendingProps;switch(A1(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return yn(t),null;case 1:return sa(t.type)&&Em(),yn(t),null;case 3:return n=t.stateNode,Ic(),er(ia),er(Rn),L1(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(d0(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,yi!==null&&(zv(yi),yi=null))),Mv(e,t),yn(t),null;case 5:F1(t);var a=Vo(Ld.current);if(r=t.type,e!==null&&t.stateNode!=null)fT(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ke(166));return yn(t),null}if(e=Vo(zi.current),d0(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[Bi]=t,n[Id]=i,e=(t.mode&1)!==0,r){case"dialog":Jt("cancel",n),Jt("close",n);break;case"iframe":case"object":case"embed":Jt("load",n);break;case"video":case"audio":for(a=0;a<Qu.length;a++)Jt(Qu[a],n);break;case"source":Jt("error",n);break;case"img":case"image":case"link":Jt("error",n),Jt("load",n);break;case"details":Jt("toggle",n);break;case"input":ON(n,i),Jt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Jt("invalid",n);break;case"textarea":RN(n,i),Jt("invalid",n)}ov(r,i),a=null;for(var s in i)if(i.hasOwnProperty(s)){var o=i[s];s==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&u0(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&u0(n.textContent,o,e),a=["children",""+o]):_d.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&Jt("scroll",n)}switch(r){case"input":r0(n),DN(n,i,!0);break;case"textarea":r0(n),MN(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=_m)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{s=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=UC(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),r==="select"&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[Bi]=t,e[Id]=n,dT(e,t,!1,!1),t.stateNode=e;e:{switch(s=lv(r,n),r){case"dialog":Jt("cancel",e),Jt("close",e),a=n;break;case"iframe":case"object":case"embed":Jt("load",e),a=n;break;case"video":case"audio":for(a=0;a<Qu.length;a++)Jt(Qu[a],e);a=n;break;case"source":Jt("error",e),a=n;break;case"img":case"image":case"link":Jt("error",e),Jt("load",e),a=n;break;case"details":Jt("toggle",e),a=n;break;case"input":ON(e,n),a=rv(e,n),Jt("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=pr({},n,{value:void 0}),Jt("invalid",e);break;case"textarea":RN(e,n),a=iv(e,n),Jt("invalid",e);break;default:a=n}ov(r,a),o=a;for(i in o)if(o.hasOwnProperty(i)){var c=o[i];i==="style"?WC(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&zC(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Ed(e,c):typeof c=="number"&&Ed(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(_d.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Jt("scroll",e):c!=null&&m1(e,i,c,s))}switch(r){case"input":r0(e),DN(e,n,!1);break;case"textarea":r0(e),MN(e);break;case"option":n.value!=null&&e.setAttribute("value",""+uo(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?vc(e,!!n.multiple,i,!1):n.defaultValue!=null&&vc(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=_m)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return yn(t),null;case 6:if(e&&t.stateNode!=null)mT(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ke(166));if(r=Vo(Ld.current),Vo(zi.current),d0(t)){if(n=t.stateNode,r=t.memoizedProps,n[Bi]=t,(i=n.nodeValue!==r)&&(e=Aa,e!==null))switch(e.tag){case 3:u0(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&u0(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Bi]=t,t.stateNode=n}return yn(t),null;case 13:if(er(fr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ir&&_a!==null&&t.mode&1&&!(t.flags&128))OA(),Rc(),t.flags|=98560,i=!1;else if(i=d0(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(ke(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ke(317));i[Bi]=t}else Rc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;yn(t),i=!1}else yi!==null&&(zv(yi),yi=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||fr.current&1?zr===0&&(zr=3):q1())),t.updateQueue!==null&&(t.flags|=4),yn(t),null);case 4:return Ic(),Mv(e,t),e===null&&Rd(t.stateNode.containerInfo),yn(t),null;case 10:return D1(t.type._context),yn(t),null;case 17:return sa(t.type)&&Em(),yn(t),null;case 19:if(er(fr),i=t.memoizedState,i===null)return yn(t),null;if(n=(t.flags&128)!==0,s=i.rendering,s===null)if(n)Du(i,!1);else{if(zr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=Rm(e),s!==null){for(t.flags|=128,Du(i,!1),n=s.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,s=i.alternate,s===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,i.type=s.type,e=s.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return qt(fr,fr.current&1|2),t.child}e=e.sibling}i.tail!==null&&Ar()>Lc&&(t.flags|=128,n=!0,Du(i,!1),t.lanes=4194304)}else{if(!n)if(e=Rm(s),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Du(i,!0),i.tail===null&&i.tailMode==="hidden"&&!s.alternate&&!ir)return yn(t),null}else 2*Ar()-i.renderingStartTime>Lc&&r!==1073741824&&(t.flags|=128,n=!0,Du(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(r=i.last,r!==null?r.sibling=s:t.child=s,i.last=s)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Ar(),t.sibling=null,r=fr.current,qt(fr,n?r&1|2:r&1),t):(yn(t),null);case 22:case 23:return X1(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?ma&1073741824&&(yn(t),t.subtreeFlags&6&&(t.flags|=8192)):yn(t),null;case 24:return null;case 25:return null}throw Error(ke(156,t.tag))}function XF(e,t){switch(A1(t),t.tag){case 1:return sa(t.type)&&Em(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ic(),er(ia),er(Rn),L1(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return F1(t),null;case 13:if(er(fr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ke(340));Rc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return er(fr),null;case 4:return Ic(),null;case 10:return D1(t.type._context),null;case 22:case 23:return X1(),null;case 24:return null;default:return null}}var h0=!1,kn=!1,qF=typeof WeakSet=="function"?WeakSet:Set,He=null;function dc(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){vr(e,t,n)}else r.current=null}function Iv(e,t,r){try{r()}catch(n){vr(e,t,n)}}var SS=!1;function YF(e,t){if(vv=Nm,e=vA(),E1(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var s=0,o=-1,c=-1,u=0,d=0,f=e,h=null;t:for(;;){for(var p;f!==r||a!==0&&f.nodeType!==3||(o=s+a),f!==i||n!==0&&f.nodeType!==3||(c=s+n),f.nodeType===3&&(s+=f.nodeValue.length),(p=f.firstChild)!==null;)h=f,f=p;for(;;){if(f===e)break t;if(h===r&&++u===a&&(o=s),h===i&&++d===n&&(c=s),(p=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=p}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(yv={focusedElem:e,selectionRange:r},Nm=!1,He=t;He!==null;)if(t=He,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,He=e;else for(;He!==null;){t=He;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var g=x.memoizedProps,y=x.memoizedState,v=t.stateNode,w=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:xi(t.type,g),y);v.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ke(163))}}catch(S){vr(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,He=e;break}He=t.return}return x=SS,SS=!1,x}function ud(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&Iv(t,r,i)}a=a.next}while(a!==n)}}function rp(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Fv(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function hT(e){var t=e.alternate;t!==null&&(e.alternate=null,hT(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Bi],delete t[Id],delete t[Nv],delete t[DF],delete t[RF])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function pT(e){return e.tag===5||e.tag===3||e.tag===4}function kS(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||pT(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Lv(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=_m));else if(n!==4&&(e=e.child,e!==null))for(Lv(e,t,r),e=e.sibling;e!==null;)Lv(e,t,r),e=e.sibling}function Bv(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Bv(e,t,r),e=e.sibling;e!==null;)Bv(e,t,r),e=e.sibling}var cn=null,vi=!1;function Ls(e,t,r){for(r=r.child;r!==null;)gT(e,t,r),r=r.sibling}function gT(e,t,r){if(Ui&&typeof Ui.onCommitFiberUnmount=="function")try{Ui.onCommitFiberUnmount(Xh,r)}catch{}switch(r.tag){case 5:kn||dc(r,t);case 6:var n=cn,a=vi;cn=null,Ls(e,t,r),cn=n,vi=a,cn!==null&&(vi?(e=cn,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):cn.removeChild(r.stateNode));break;case 18:cn!==null&&(vi?(e=cn,r=r.stateNode,e.nodeType===8?Kg(e.parentNode,r):e.nodeType===1&&Kg(e,r),Pd(e)):Kg(cn,r.stateNode));break;case 4:n=cn,a=vi,cn=r.stateNode.containerInfo,vi=!0,Ls(e,t,r),cn=n,vi=a;break;case 0:case 11:case 14:case 15:if(!kn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,s=i.destroy;i=i.tag,s!==void 0&&(i&2||i&4)&&Iv(r,t,s),a=a.next}while(a!==n)}Ls(e,t,r);break;case 1:if(!kn&&(dc(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){vr(r,t,o)}Ls(e,t,r);break;case 21:Ls(e,t,r);break;case 22:r.mode&1?(kn=(n=kn)||r.memoizedState!==null,Ls(e,t,r),kn=n):Ls(e,t,r);break;default:Ls(e,t,r)}}function _S(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new qF),t.forEach(function(n){var a=i8.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function pi(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,s=t,o=s;e:for(;o!==null;){switch(o.tag){case 5:cn=o.stateNode,vi=!1;break e;case 3:cn=o.stateNode.containerInfo,vi=!0;break e;case 4:cn=o.stateNode.containerInfo,vi=!0;break e}o=o.return}if(cn===null)throw Error(ke(160));gT(i,s,a),cn=null,vi=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(u){vr(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)xT(t,e),t=t.sibling}function xT(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(pi(t,e),Di(e),n&4){try{ud(3,e,e.return),rp(3,e)}catch(g){vr(e,e.return,g)}try{ud(5,e,e.return)}catch(g){vr(e,e.return,g)}}break;case 1:pi(t,e),Di(e),n&512&&r!==null&&dc(r,r.return);break;case 5:if(pi(t,e),Di(e),n&512&&r!==null&&dc(r,r.return),e.flags&32){var a=e.stateNode;try{Ed(a,"")}catch(g){vr(e,e.return,g)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,s=r!==null?r.memoizedProps:i,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&jC(a,i),lv(o,s);var u=lv(o,i);for(s=0;s<c.length;s+=2){var d=c[s],f=c[s+1];d==="style"?WC(a,f):d==="dangerouslySetInnerHTML"?zC(a,f):d==="children"?Ed(a,f):m1(a,d,f,u)}switch(o){case"input":nv(a,i);break;case"textarea":$C(a,i);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?vc(a,!!i.multiple,p,!1):h!==!!i.multiple&&(i.defaultValue!=null?vc(a,!!i.multiple,i.defaultValue,!0):vc(a,!!i.multiple,i.multiple?[]:"",!1))}a[Id]=i}catch(g){vr(e,e.return,g)}}break;case 6:if(pi(t,e),Di(e),n&4){if(e.stateNode===null)throw Error(ke(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(g){vr(e,e.return,g)}}break;case 3:if(pi(t,e),Di(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Pd(t.containerInfo)}catch(g){vr(e,e.return,g)}break;case 4:pi(t,e),Di(e);break;case 13:pi(t,e),Di(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(V1=Ar())),n&4&&_S(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(kn=(u=kn)||d,pi(t,e),kn=u):pi(t,e),Di(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(He=e,d=e.child;d!==null;){for(f=He=d;He!==null;){switch(h=He,p=h.child,h.tag){case 0:case 11:case 14:case 15:ud(4,h,h.return);break;case 1:dc(h,h.return);var x=h.stateNode;if(typeof x.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(g){vr(n,r,g)}}break;case 5:dc(h,h.return);break;case 22:if(h.memoizedState!==null){CS(f);continue}}p!==null?(p.return=h,He=p):CS(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{a=f.stateNode,u?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=f.stateNode,c=f.memoizedProps.style,s=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=HC("display",s))}catch(g){vr(e,e.return,g)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(g){vr(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:pi(t,e),Di(e),n&4&&_S(e);break;case 21:break;default:pi(t,e),Di(e)}}function Di(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(pT(r)){var n=r;break e}r=r.return}throw Error(ke(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Ed(a,""),n.flags&=-33);var i=kS(e);Bv(e,i,a);break;case 3:case 4:var s=n.stateNode.containerInfo,o=kS(e);Lv(e,o,s);break;default:throw Error(ke(161))}}catch(c){vr(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function JF(e,t,r){He=e,vT(e)}function vT(e,t,r){for(var n=(e.mode&1)!==0;He!==null;){var a=He,i=a.child;if(a.tag===22&&n){var s=a.memoizedState!==null||h0;if(!s){var o=a.alternate,c=o!==null&&o.memoizedState!==null||kn;o=h0;var u=kn;if(h0=s,(kn=c)&&!u)for(He=a;He!==null;)s=He,c=s.child,s.tag===22&&s.memoizedState!==null?AS(a):c!==null?(c.return=s,He=c):AS(a);for(;i!==null;)He=i,vT(i),i=i.sibling;He=a,h0=o,kn=u}ES(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,He=i):ES(e)}}function ES(e){for(;He!==null;){var t=He;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:kn||rp(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!kn)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:xi(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&uS(t,i,n);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}uS(t,s,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Pd(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ke(163))}kn||t.flags&512&&Fv(t)}catch(h){vr(t,t.return,h)}}if(t===e){He=null;break}if(r=t.sibling,r!==null){r.return=t.return,He=r;break}He=t.return}}function CS(e){for(;He!==null;){var t=He;if(t===e){He=null;break}var r=t.sibling;if(r!==null){r.return=t.return,He=r;break}He=t.return}}function AS(e){for(;He!==null;){var t=He;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{rp(4,t)}catch(c){vr(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(c){vr(t,a,c)}}var i=t.return;try{Fv(t)}catch(c){vr(t,i,c)}break;case 5:var s=t.return;try{Fv(t)}catch(c){vr(t,s,c)}}}catch(c){vr(t,t.return,c)}if(t===e){He=null;break}var o=t.sibling;if(o!==null){o.return=t.return,He=o;break}He=t.return}}var QF=Math.ceil,Fm=Cs.ReactCurrentDispatcher,W1=Cs.ReactCurrentOwner,ii=Cs.ReactCurrentBatchConfig,Dt=0,nn=null,Mr=null,mn=0,ma=0,fc=_o(0),zr=0,Ud=null,ml=0,np=0,G1=0,dd=null,ea=null,V1=0,Lc=1/0,rs=null,Lm=!1,jv=null,ao=null,p0=!1,Ks=null,Bm=0,fd=0,$v=null,am=-1,im=0;function Wn(){return Dt&6?Ar():am!==-1?am:am=Ar()}function io(e){return e.mode&1?Dt&2&&mn!==0?mn&-mn:IF.transition!==null?(im===0&&(im=rA()),im):(e=zt,e!==0||(e=window.event,e=e===void 0?16:cA(e.type)),e):1}function ki(e,t,r,n){if(50<fd)throw fd=0,$v=null,Error(ke(185));xf(e,r,n),(!(Dt&2)||e!==nn)&&(e===nn&&(!(Dt&2)&&(np|=r),zr===4&&Ws(e,mn)),oa(e,n),r===1&&Dt===0&&!(t.mode&1)&&(Lc=Ar()+500,Zh&&Eo()))}function oa(e,t){var r=e.callbackNode;II(e,t);var n=wm(e,e===nn?mn:0);if(n===0)r!==null&&LN(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&LN(r),t===1)e.tag===0?MF(TS.bind(null,e)):AA(TS.bind(null,e)),PF(function(){!(Dt&6)&&Eo()}),r=null;else{switch(nA(n)){case 1:r=v1;break;case 4:r=eA;break;case 16:r=bm;break;case 536870912:r=tA;break;default:r=bm}r=ET(r,yT.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function yT(e,t){if(am=-1,im=0,Dt&6)throw Error(ke(327));var r=e.callbackNode;if(Sc()&&e.callbackNode!==r)return null;var n=wm(e,e===nn?mn:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=jm(e,n);else{t=n;var a=Dt;Dt|=2;var i=wT();(nn!==e||mn!==t)&&(rs=null,Lc=Ar()+500,Zo(e,t));do try{t8();break}catch(o){bT(e,o)}while(1);O1(),Fm.current=i,Dt=a,Mr!==null?t=0:(nn=null,mn=0,t=zr)}if(t!==0){if(t===2&&(a=mv(e),a!==0&&(n=a,t=Uv(e,a))),t===1)throw r=Ud,Zo(e,0),Ws(e,n),oa(e,Ar()),r;if(t===6)Ws(e,n);else{if(a=e.current.alternate,!(n&30)&&!ZF(a)&&(t=jm(e,n),t===2&&(i=mv(e),i!==0&&(n=i,t=Uv(e,i))),t===1))throw r=Ud,Zo(e,0),Ws(e,n),oa(e,Ar()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(ke(345));case 2:jo(e,ea,rs);break;case 3:if(Ws(e,n),(n&130023424)===n&&(t=V1+500-Ar(),10<t)){if(wm(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){Wn(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=wv(jo.bind(null,e,ea,rs),t);break}jo(e,ea,rs);break;case 4:if(Ws(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var s=31-Si(n);i=1<<s,s=t[s],s>a&&(a=s),n&=~i}if(n=a,n=Ar()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*QF(n/1960))-n,10<n){e.timeoutHandle=wv(jo.bind(null,e,ea,rs),n);break}jo(e,ea,rs);break;case 5:jo(e,ea,rs);break;default:throw Error(ke(329))}}}return oa(e,Ar()),e.callbackNode===r?yT.bind(null,e):null}function Uv(e,t){var r=dd;return e.current.memoizedState.isDehydrated&&(Zo(e,t).flags|=256),e=jm(e,t),e!==2&&(t=ea,ea=r,t!==null&&zv(t)),e}function zv(e){ea===null?ea=e:ea.push.apply(ea,e)}function ZF(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!Ti(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ws(e,t){for(t&=~G1,t&=~np,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Si(t),n=1<<r;e[r]=-1,t&=~n}}function TS(e){if(Dt&6)throw Error(ke(327));Sc();var t=wm(e,0);if(!(t&1))return oa(e,Ar()),null;var r=jm(e,t);if(e.tag!==0&&r===2){var n=mv(e);n!==0&&(t=n,r=Uv(e,n))}if(r===1)throw r=Ud,Zo(e,0),Ws(e,t),oa(e,Ar()),r;if(r===6)throw Error(ke(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,jo(e,ea,rs),oa(e,Ar()),null}function K1(e,t){var r=Dt;Dt|=1;try{return e(t)}finally{Dt=r,Dt===0&&(Lc=Ar()+500,Zh&&Eo())}}function hl(e){Ks!==null&&Ks.tag===0&&!(Dt&6)&&Sc();var t=Dt;Dt|=1;var r=ii.transition,n=zt;try{if(ii.transition=null,zt=1,e)return e()}finally{zt=n,ii.transition=r,Dt=t,!(Dt&6)&&Eo()}}function X1(){ma=fc.current,er(fc)}function Zo(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,TF(r)),Mr!==null)for(r=Mr.return;r!==null;){var n=r;switch(A1(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Em();break;case 3:Ic(),er(ia),er(Rn),L1();break;case 5:F1(n);break;case 4:Ic();break;case 13:er(fr);break;case 19:er(fr);break;case 10:D1(n.type._context);break;case 22:case 23:X1()}r=r.return}if(nn=e,Mr=e=so(e.current,null),mn=ma=t,zr=0,Ud=null,G1=np=ml=0,ea=dd=null,Go!==null){for(t=0;t<Go.length;t++)if(r=Go[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var s=i.next;i.next=a,n.next=s}r.pending=n}Go=null}return e}function bT(e,t){do{var r=Mr;try{if(O1(),tm.current=Im,Mm){for(var n=hr.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Mm=!1}if(fl=0,Jr=Br=hr=null,cd=!1,Bd=0,W1.current=null,r===null||r.return===null){zr=1,Ud=t,Mr=null;break}e:{var i=e,s=r.return,o=r,c=t;if(t=mn,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=o,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=gS(s);if(p!==null){p.flags&=-257,xS(p,s,o,i,t),p.mode&1&&pS(i,u,t),t=p,c=u;var x=t.updateQueue;if(x===null){var g=new Set;g.add(c),t.updateQueue=g}else x.add(c);break e}else{if(!(t&1)){pS(i,u,t),q1();break e}c=Error(ke(426))}}else if(ir&&o.mode&1){var y=gS(s);if(y!==null){!(y.flags&65536)&&(y.flags|=256),xS(y,s,o,i,t),T1(Fc(c,o));break e}}i=c=Fc(c,o),zr!==4&&(zr=2),dd===null?dd=[i]:dd.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var v=nT(i,c,t);cS(i,v);break e;case 1:o=c;var w=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(ao===null||!ao.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t;var S=aT(i,o,t);cS(i,S);break e}}i=i.return}while(i!==null)}ST(r)}catch(k){t=k,Mr===r&&r!==null&&(Mr=r=r.return);continue}break}while(1)}function wT(){var e=Fm.current;return Fm.current=Im,e===null?Im:e}function q1(){(zr===0||zr===3||zr===2)&&(zr=4),nn===null||!(ml&268435455)&&!(np&268435455)||Ws(nn,mn)}function jm(e,t){var r=Dt;Dt|=2;var n=wT();(nn!==e||mn!==t)&&(rs=null,Zo(e,t));do try{e8();break}catch(a){bT(e,a)}while(1);if(O1(),Dt=r,Fm.current=n,Mr!==null)throw Error(ke(261));return nn=null,mn=0,zr}function e8(){for(;Mr!==null;)NT(Mr)}function t8(){for(;Mr!==null&&!EI();)NT(Mr)}function NT(e){var t=_T(e.alternate,e,ma);e.memoizedProps=e.pendingProps,t===null?ST(e):Mr=t,W1.current=null}function ST(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=XF(r,t),r!==null){r.flags&=32767,Mr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{zr=6,Mr=null;return}}else if(r=KF(r,t,ma),r!==null){Mr=r;return}if(t=t.sibling,t!==null){Mr=t;return}Mr=t=e}while(t!==null);zr===0&&(zr=5)}function jo(e,t,r){var n=zt,a=ii.transition;try{ii.transition=null,zt=1,r8(e,t,r,n)}finally{ii.transition=a,zt=n}return null}function r8(e,t,r,n){do Sc();while(Ks!==null);if(Dt&6)throw Error(ke(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ke(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(FI(e,i),e===nn&&(Mr=nn=null,mn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||p0||(p0=!0,ET(bm,function(){return Sc(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=ii.transition,ii.transition=null;var s=zt;zt=1;var o=Dt;Dt|=4,W1.current=null,YF(e,r),xT(r,e),NF(yv),Nm=!!vv,yv=vv=null,e.current=r,JF(r),CI(),Dt=o,zt=s,ii.transition=i}else e.current=r;if(p0&&(p0=!1,Ks=e,Bm=a),i=e.pendingLanes,i===0&&(ao=null),PI(r.stateNode),oa(e,Ar()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Lm)throw Lm=!1,e=jv,jv=null,e;return Bm&1&&e.tag!==0&&Sc(),i=e.pendingLanes,i&1?e===$v?fd++:(fd=0,$v=e):fd=0,Eo(),null}function Sc(){if(Ks!==null){var e=nA(Bm),t=ii.transition,r=zt;try{if(ii.transition=null,zt=16>e?16:e,Ks===null)var n=!1;else{if(e=Ks,Ks=null,Bm=0,Dt&6)throw Error(ke(331));var a=Dt;for(Dt|=4,He=e.current;He!==null;){var i=He,s=i.child;if(He.flags&16){var o=i.deletions;if(o!==null){for(var c=0;c<o.length;c++){var u=o[c];for(He=u;He!==null;){var d=He;switch(d.tag){case 0:case 11:case 15:ud(8,d,i)}var f=d.child;if(f!==null)f.return=d,He=f;else for(;He!==null;){d=He;var h=d.sibling,p=d.return;if(hT(d),d===u){He=null;break}if(h!==null){h.return=p,He=h;break}He=p}}}var x=i.alternate;if(x!==null){var g=x.child;if(g!==null){x.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}He=i}}if(i.subtreeFlags&2064&&s!==null)s.return=i,He=s;else e:for(;He!==null;){if(i=He,i.flags&2048)switch(i.tag){case 0:case 11:case 15:ud(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,He=v;break e}He=i.return}}var w=e.current;for(He=w;He!==null;){s=He;var b=s.child;if(s.subtreeFlags&2064&&b!==null)b.return=s,He=b;else e:for(s=w;He!==null;){if(o=He,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:rp(9,o)}}catch(k){vr(o,o.return,k)}if(o===s){He=null;break e}var S=o.sibling;if(S!==null){S.return=o.return,He=S;break e}He=o.return}}if(Dt=a,Eo(),Ui&&typeof Ui.onPostCommitFiberRoot=="function")try{Ui.onPostCommitFiberRoot(Xh,e)}catch{}n=!0}return n}finally{zt=r,ii.transition=t}}return!1}function PS(e,t,r){t=Fc(r,t),t=nT(e,t,1),e=no(e,t,1),t=Wn(),e!==null&&(xf(e,1,t),oa(e,t))}function vr(e,t,r){if(e.tag===3)PS(e,e,r);else for(;t!==null;){if(t.tag===3){PS(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(ao===null||!ao.has(n))){e=Fc(r,e),e=aT(t,e,1),t=no(t,e,1),e=Wn(),t!==null&&(xf(t,1,e),oa(t,e));break}}t=t.return}}function n8(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Wn(),e.pingedLanes|=e.suspendedLanes&r,nn===e&&(mn&r)===r&&(zr===4||zr===3&&(mn&130023424)===mn&&500>Ar()-V1?Zo(e,0):G1|=r),oa(e,t)}function kT(e,t){t===0&&(e.mode&1?(t=i0,i0<<=1,!(i0&130023424)&&(i0=4194304)):t=1);var r=Wn();e=ys(e,t),e!==null&&(xf(e,t,r),oa(e,r))}function a8(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),kT(e,r)}function i8(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ke(314))}n!==null&&n.delete(t),kT(e,r)}var _T;_T=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||ia.current)ra=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return ra=!1,VF(e,t,r);ra=!!(e.flags&131072)}else ra=!1,ir&&t.flags&1048576&&TA(t,Tm,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;nm(e,t),e=t.pendingProps;var a=Dc(t,Rn.current);Nc(t,r),a=j1(null,t,n,e,a,r);var i=$1();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,sa(n)?(i=!0,Cm(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,M1(t),a.updater=tp,t.stateNode=a,a._reactInternals=t,Av(t,n,e,r),t=Ov(null,t,n,!0,i,r)):(t.tag=0,ir&&i&&C1(t),Ln(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(nm(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=o8(n),e=xi(n,e),a){case 0:t=Pv(null,t,n,e,r);break e;case 1:t=bS(null,t,n,e,r);break e;case 11:t=vS(null,t,n,e,r);break e;case 14:t=yS(null,t,n,xi(n.type,e),r);break e}throw Error(ke(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:xi(n,a),Pv(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:xi(n,a),bS(e,t,n,a,r);case 3:e:{if(lT(t),e===null)throw Error(ke(387));n=t.pendingProps,i=t.memoizedState,a=i.element,IA(e,t),Dm(t,n,null,r);var s=t.memoizedState;if(n=s.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=Fc(Error(ke(423)),t),t=wS(e,t,n,r,a);break e}else if(n!==a){a=Fc(Error(ke(424)),t),t=wS(e,t,n,r,a);break e}else for(_a=ro(t.stateNode.containerInfo.firstChild),Aa=t,ir=!0,yi=null,r=RA(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Rc(),n===a){t=bs(e,t,r);break e}Ln(e,t,n,r)}t=t.child}return t;case 5:return FA(t),e===null&&_v(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,s=a.children,bv(n,a)?s=null:i!==null&&bv(n,i)&&(t.flags|=32),oT(e,t),Ln(e,t,s,r),t.child;case 6:return e===null&&_v(t),null;case 13:return cT(e,t,r);case 4:return I1(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Mc(t,null,n,r):Ln(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:xi(n,a),vS(e,t,n,a,r);case 7:return Ln(e,t,t.pendingProps,r),t.child;case 8:return Ln(e,t,t.pendingProps.children,r),t.child;case 12:return Ln(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,s=a.value,qt(Pm,n._currentValue),n._currentValue=s,i!==null)if(Ti(i.value,s)){if(i.children===a.children&&!ia.current){t=bs(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){s=i.child;for(var c=o.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=fs(-1,r&-r),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),Ev(i.return,r,t),o.lanes|=r;break}c=c.next}}else if(i.tag===10)s=i.type===t.type?null:i.child;else if(i.tag===18){if(s=i.return,s===null)throw Error(ke(341));s.lanes|=r,o=s.alternate,o!==null&&(o.lanes|=r),Ev(s,r,t),s=i.sibling}else s=i.child;if(s!==null)s.return=i;else for(s=i;s!==null;){if(s===t){s=null;break}if(i=s.sibling,i!==null){i.return=s.return,s=i;break}s=s.return}i=s}Ln(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,Nc(t,r),a=oi(a),n=n(a),t.flags|=1,Ln(e,t,n,r),t.child;case 14:return n=t.type,a=xi(n,t.pendingProps),a=xi(n.type,a),yS(e,t,n,a,r);case 15:return iT(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:xi(n,a),nm(e,t),t.tag=1,sa(n)?(e=!0,Cm(t)):e=!1,Nc(t,r),rT(t,n,a),Av(t,n,a,r),Ov(null,t,n,!0,e,r);case 19:return uT(e,t,r);case 22:return sT(e,t,r)}throw Error(ke(156,t.tag))};function ET(e,t){return ZC(e,t)}function s8(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ei(e,t,r,n){return new s8(e,t,r,n)}function Y1(e){return e=e.prototype,!(!e||!e.isReactComponent)}function o8(e){if(typeof e=="function")return Y1(e)?1:0;if(e!=null){if(e=e.$$typeof,e===p1)return 11;if(e===g1)return 14}return 2}function so(e,t){var r=e.alternate;return r===null?(r=ei(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function sm(e,t,r,n,a,i){var s=2;if(n=e,typeof e=="function")Y1(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case rc:return el(r.children,a,i,t);case h1:s=8,a|=8;break;case Qx:return e=ei(12,r,t,a|2),e.elementType=Qx,e.lanes=i,e;case Zx:return e=ei(13,r,t,a),e.elementType=Zx,e.lanes=i,e;case ev:return e=ei(19,r,t,a),e.elementType=ev,e.lanes=i,e;case FC:return ap(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case MC:s=10;break e;case IC:s=9;break e;case p1:s=11;break e;case g1:s=14;break e;case js:s=16,n=null;break e}throw Error(ke(130,e==null?e:typeof e,""))}return t=ei(s,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function el(e,t,r,n){return e=ei(7,e,n,t),e.lanes=r,e}function ap(e,t,r,n){return e=ei(22,e,n,t),e.elementType=FC,e.lanes=r,e.stateNode={isHidden:!1},e}function tx(e,t,r){return e=ei(6,e,null,t),e.lanes=r,e}function rx(e,t,r){return t=ei(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function l8(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Fg(0),this.expirationTimes=Fg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fg(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function J1(e,t,r,n,a,i,s,o,c){return e=new l8(e,t,r,o,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=ei(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},M1(i),e}function c8(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:tc,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function CT(e){if(!e)return fo;e=e._reactInternals;e:{if(Ml(e)!==e||e.tag!==1)throw Error(ke(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(sa(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ke(171))}if(e.tag===1){var r=e.type;if(sa(r))return CA(e,r,t)}return t}function AT(e,t,r,n,a,i,s,o,c){return e=J1(r,n,!0,e,a,i,s,o,c),e.context=CT(null),r=e.current,n=Wn(),a=io(r),i=fs(n,a),i.callback=t??null,no(r,i,a),e.current.lanes=a,xf(e,a,n),oa(e,n),e}function ip(e,t,r,n){var a=t.current,i=Wn(),s=io(a);return r=CT(r),t.context===null?t.context=r:t.pendingContext=r,t=fs(i,s),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=no(a,t,s),e!==null&&(ki(e,a,s,i),em(e,a,s)),s}function $m(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function OS(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Q1(e,t){OS(e,t),(e=e.alternate)&&OS(e,t)}function u8(){return null}var TT=typeof reportError=="function"?reportError:function(e){console.error(e)};function Z1(e){this._internalRoot=e}sp.prototype.render=Z1.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ke(409));ip(e,t,null,null)};sp.prototype.unmount=Z1.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;hl(function(){ip(null,e,null,null)}),t[vs]=null}};function sp(e){this._internalRoot=e}sp.prototype.unstable_scheduleHydration=function(e){if(e){var t=sA();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Hs.length&&t!==0&&t<Hs[r].priority;r++);Hs.splice(r,0,e),r===0&&lA(e)}};function eb(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function op(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function DS(){}function d8(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var u=$m(s);i.call(u)}}var s=AT(t,n,e,0,null,!1,!1,"",DS);return e._reactRootContainer=s,e[vs]=s.current,Rd(e.nodeType===8?e.parentNode:e),hl(),s}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var u=$m(c);o.call(u)}}var c=J1(e,0,!1,null,null,!1,!1,"",DS);return e._reactRootContainer=c,e[vs]=c.current,Rd(e.nodeType===8?e.parentNode:e),hl(function(){ip(t,c,r,n)}),c}function lp(e,t,r,n,a){var i=r._reactRootContainer;if(i){var s=i;if(typeof a=="function"){var o=a;a=function(){var c=$m(s);o.call(c)}}ip(t,s,e,a)}else s=d8(r,t,e,a,n);return $m(s)}aA=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Ju(t.pendingLanes);r!==0&&(y1(t,r|1),oa(t,Ar()),!(Dt&6)&&(Lc=Ar()+500,Eo()))}break;case 13:hl(function(){var n=ys(e,1);if(n!==null){var a=Wn();ki(n,e,1,a)}}),Q1(e,1)}};b1=function(e){if(e.tag===13){var t=ys(e,134217728);if(t!==null){var r=Wn();ki(t,e,134217728,r)}Q1(e,134217728)}};iA=function(e){if(e.tag===13){var t=io(e),r=ys(e,t);if(r!==null){var n=Wn();ki(r,e,t,n)}Q1(e,t)}};sA=function(){return zt};oA=function(e,t){var r=zt;try{return zt=e,t()}finally{zt=r}};uv=function(e,t,r){switch(t){case"input":if(nv(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=Qh(n);if(!a)throw Error(ke(90));BC(n),nv(n,a)}}}break;case"textarea":$C(e,r);break;case"select":t=r.value,t!=null&&vc(e,!!r.multiple,t,!1)}};KC=K1;XC=hl;var f8={usingClientEntryPoint:!1,Events:[yf,sc,Qh,GC,VC,K1]},Ru={findFiberByHostInstance:Wo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},m8={bundleType:Ru.bundleType,version:Ru.version,rendererPackageName:Ru.rendererPackageName,rendererConfig:Ru.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Cs.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=JC(e),e===null?null:e.stateNode},findFiberByHostInstance:Ru.findFiberByHostInstance||u8,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var g0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!g0.isDisabled&&g0.supportsFiber)try{Xh=g0.inject(m8),Ui=g0}catch{}}La.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=f8;La.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!eb(t))throw Error(ke(200));return c8(e,t,null,r)};La.createRoot=function(e,t){if(!eb(e))throw Error(ke(299));var r=!1,n="",a=TT;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=J1(e,1,!1,null,null,r,!1,n,a),e[vs]=t.current,Rd(e.nodeType===8?e.parentNode:e),new Z1(t)};La.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ke(188)):(e=Object.keys(e).join(","),Error(ke(268,e)));return e=JC(t),e=e===null?null:e.stateNode,e};La.flushSync=function(e){return hl(e)};La.hydrate=function(e,t,r){if(!op(t))throw Error(ke(200));return lp(null,e,t,!0,r)};La.hydrateRoot=function(e,t,r){if(!eb(e))throw Error(ke(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",s=TT;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=AT(t,null,e,1,r??null,a,!1,i,s),e[vs]=t.current,Rd(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new sp(t)};La.render=function(e,t,r){if(!op(t))throw Error(ke(200));return lp(null,e,t,!1,r)};La.unmountComponentAtNode=function(e){if(!op(e))throw Error(ke(40));return e._reactRootContainer?(hl(function(){lp(null,null,e,!1,function(){e._reactRootContainer=null,e[vs]=null})}),!0):!1};La.unstable_batchedUpdates=K1;La.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!op(r))throw Error(ke(200));if(e==null||e._reactInternals===void 0)throw Error(ke(38));return lp(e,t,r,!1,n)};La.version="18.3.1-next-f1338f8080-20240426";function PT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(PT)}catch(e){console.error(e)}}PT(),PC.exports=La;var tb=PC.exports,RS=tb;Yx.createRoot=RS.createRoot,Yx.hydrateRoot=RS.hydrateRoot;const ve=(()=>"/api")(),h8=()=>window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1",ha=(e,t={})=>{if(h8()){const r=`${ve}/${e}.php`;if(Object.keys(t).length===0)return r;const n=new URLSearchParams(t).toString();return`${r}?${n}`}else{const r=`/index.php?endpoint=${e}`;if(Object.keys(t).length===0)return r;const n=new URLSearchParams(t).toString();return`${r}&${n}`}};let x0=null,Hv=0,Mu=0;const p8=3,MS=2e3,OT=e=>{try{const t=e.split(".")[1];if(!t)return 0;let r=t.replace(/-/g,"+").replace(/_/g,"/");for(;r.length%4;)r+="=";const n=JSON.parse(atob(r));return Number(n.exp||0)}catch{return 0}},g8=e=>{const t=OT(e);return t?Date.now()>=t*1e3-2*60*1e3:!1},x8=e=>{const t=OT(e);return t?Date.now()>=t*1e3:!0};async function v8(){const e=localStorage.getItem("refresh_token");if(!e)return console.log("No refresh token available"),null;if(x8(e))return console.log("Refresh token is expired"),localStorage.removeItem("token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),typeof window<"u"&&window.dispatchEvent&&window.dispatchEvent(new CustomEvent("auth:login-required")),null;try{console.log("Attempting token refresh...");const t=await fetch(`${ve}/index.php?endpoint=refresh`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({refresh_token:e})}),r=await t.json().catch(()=>({}));return t.ok&&r&&r.success&&r.token?(console.log("Token refresh successful"),localStorage.setItem("token",r.token),r.refresh_token&&localStorage.setItem("refresh_token",r.refresh_token),r.token):(console.log("Token refresh failed:",r.error||"Unknown error"),localStorage.removeItem("token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),typeof window<"u"&&window.dispatchEvent&&window.dispatchEvent(new CustomEvent("auth:login-required")),null)}catch(t){console.error("Token refresh error:",t),localStorage.removeItem("token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),typeof window<"u"&&window.dispatchEvent&&window.dispatchEvent(new CustomEvent("auth:login-required"))}return null}const nr=async(e=!1)=>{const t=localStorage.getItem("token");if(!e&&t&&!g8(t))return t;if(!t&&!localStorage.getItem("refresh_token"))return null;if(Mu>=p8)return localStorage.removeItem("token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),Mu=0,null;const r=Date.now();r-Hv<MS&&Mu>0&&await new Promise(a=>setTimeout(a,MS-(r-Hv))),x0||(Mu++,x0=v8().finally(()=>{setTimeout(()=>{x0=null},100)}));const n=await x0;return n?(Mu=0,n):null},qe=async(e,t={},r=!0)=>{const n=!!t.suppressUnauthorizedEvent;if("suppressUnauthorizedEvent"in t){const{suppressUnauthorizedEvent:u,...d}=t;t=d}let a=await nr(!1);if(!a)return console.warn("No valid token available for request to:",e),new Response(JSON.stringify({error:"No valid token available"}),{status:401,statusText:"Unauthorized",headers:{"Content-Type":"application/json"}});const i=u=>({...t,headers:{...t.headers||{},...u?{Authorization:`Bearer ${u}`,"X-Auth-Token":u,Accept:"application/json"}:{}}}),s=(u,d)=>{try{if(!d||typeof u=="string"&&u.includes("endpoint=refresh"))return u;if(typeof u=="string"&&(u.startsWith("/api")||u.includes("/api/")||u.startsWith("/backend/api")||u.includes("/backend/api/"))){const f=u.includes("?")?"&":"?";return`${u.replace(/[?&]token=[^&]*/g,"").replace(/\?$/,"")}${f}token=${encodeURIComponent(d)}`}}catch{}return u},o=s(e,a);let c=await fetch(o,i(a));if(c.status===401&&r){console.log("Received 401, attempting token refresh for:",e),Hv=Date.now();const u=await nr(!0);if(u&&u!==a){console.log("Got new token, retrying request");const d=s(e,u),f=await fetch(d,i(u));f.ok?(console.log("Retry successful with new token"),c=f):(console.log("Retry failed even with new token, status:",f.status),c=f)}else console.log("Token refresh failed or no new token available")}if(c.status===401&&(console.warn("Still unauthorized after refresh attempt for URL:",e),!n))try{typeof window<"u"&&window.dispatchEvent&&window.dispatchEvent(new CustomEvent("auth:unauthorized"))}catch{}return c},y8=async(e=5e3)=>{const t=Date.now();for(;Date.now()-t<e;){const r=await nr();if(r)return r;await new Promise(n=>setTimeout(n,100))}return null};var b8={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const w8=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),N8=(e,t)=>{const r=N.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:s,children:o,...c},u)=>N.createElement("svg",{ref:u,...b8,width:a,height:a,stroke:n,strokeWidth:s?Number(i)*24/Number(a):i,className:`lucide lucide-${w8(e)}`,...c},[...t.map(([d,f])=>N.createElement(d,f)),...(Array.isArray(o)?o:[o])||[]]));return r.displayName=`${e}`,r};var Me=N8;const mo=Me("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),$r=Me("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),wf=Me("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),Hi=Me("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),Um=Me("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),zd=Me("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),Ea=Me("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),S8=Me("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),Hd=Me("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),yt=Me("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),md=Me("CheckSquare",[["polyline",{points:"9 11 12 14 22 4",key:"19ybtz"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]),rb=Me("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),cp=Me("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),nb=Me("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),ab=Me("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),DT=Me("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),ho=Me("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),k8=Me("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]),IS=Me("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),ua=Me("Cpu",[["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"9",y:"9",width:"6",height:"6",key:"o3kz5p"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]),oo=Me("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),RT=Me("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),lo=Me("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),ls=Me("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),_8=Me("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),nx=Me("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z",key:"nb9nel"}]]),au=Me("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]),E8=Me("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),Wv=Me("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),C8=Me("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),mc=Me("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),qa=Me("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),ib=Me("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),A8=Me("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),T8=Me("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),P8=Me("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),O8=Me("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),ti=Me("MemoryStick",[["path",{d:"M6 19v-3",key:"1nvgqn"}],["path",{d:"M10 19v-3",key:"iu8nkm"}],["path",{d:"M14 19v-3",key:"kcehxu"}],["path",{d:"M18 19v-3",key:"1vh91z"}],["path",{d:"M8 11V9",key:"63erz4"}],["path",{d:"M16 11V9",key:"fru6f3"}],["path",{d:"M12 11V9",key:"ha00sb"}],["path",{d:"M2 15h20",key:"16ne18"}],["path",{d:"M2 7a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v1.1a2 2 0 0 0 0 3.837V17a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-5.1a2 2 0 0 0 0-3.837Z",key:"lhddv3"}]]),D8=Me("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),Gv=Me("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),Ca=Me("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),Ki=Me("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),R8=Me("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),Ye=Me("Package",[["path",{d:"M16.5 9.4 7.55 4.24",key:"10qotr"}],["path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z",key:"yt0hxn"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]),_i=Me("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),M8=Me("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),I8=Me("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),FS=Me("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]),Vn=Me("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),v0=Me("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),F8=Me("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]),om=Me("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),Wi=Me("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),Il=Me("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),up=Me("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]),sb=Me("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),hc=Me("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),na=Me("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]),Vv=Me("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),ob=Me("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),L8=Me("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),MT=Me("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),ta=Me("Thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]),B8=Me("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]),j8=Me("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]),an=Me("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Bc=Me("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),$8=Me("Truck",[["path",{d:"M10 17h4V5H2v12h3",key:"1jq12e"}],["path",{d:"M20 17h2v-3.34a4 4 0 0 0-1.17-2.83L19 9h-5",key:"1xb3ft"}],["path",{d:"M14 17h1",key:"nufu4t"}],["circle",{cx:"7.5",cy:"17.5",r:"2.5",key:"a7aife"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]),LS=Me("User2",[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 1 0-16 0",key:"199sx2"}]]),BS=Me("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),U8=Me("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),Ko=Me("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),iu=Me("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),jS=Me("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]),Cn=Me("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Gn=Me("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Ta=Me("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),IT=N.createContext(),dp=()=>{const e=N.useContext(IT);if(!e)throw new Error("useNotifications must be used within a NotificationProvider");return e},z8=({children:e,user:t})=>{const[r,n]=N.useState([]),[a,i]=N.useState(0),[s,o]=N.useState(!1),c=N.useRef(null),u=w=>{if(!w||!w.roles)return!1;let b=[];return Array.isArray(w.roles)?b=w.roles:typeof w.roles=="string"?b=w.roles.split(",").map(k=>k.trim()):b=[w.roles],b.some(k=>["Admin","Super Admin","Employee"].includes(k))};N.useEffect(()=>{if(t&&t.id&&u(t)){d(),f();const w=setInterval(()=>{d()},3e4),b=setInterval(()=>{f()},6e4);return()=>{w&&clearInterval(w),b&&clearInterval(b)}}else n([]),i(0),c.current&&(clearInterval(c.current),c.current=null)},[t]),N.useEffect(()=>{const w=()=>{n([]),i(0),c.current&&(clearInterval(c.current),c.current=null)};return window.addEventListener("auth:login-required",w),window.addEventListener("auth:unauthorized",w),()=>{window.removeEventListener("auth:login-required",w),window.removeEventListener("auth:unauthorized",w)}},[]);const d=async()=>{if(!(!t||!t.id||!u(t))){o(!0);try{if(!await nr(!1)){n([]),i(0),c.current&&(clearInterval(c.current),c.current=null),o(!1);return}const b=await qe(`${ve}/index.php?endpoint=notifications`,{method:"GET",suppressUnauthorizedEvent:!0});if(b.status===401){n([]),i(0),c.current&&(clearInterval(c.current),c.current=null),o(!1);return}if(b.ok){const S=await b.json();if(S.success){const k=S.data.map(_=>({..._,timestamp:new Date(_.timestamp)}));n(k)}}else console.warn("NotificationContext: Unexpected response status:",b.status)}catch(w){console.error("Error loading notifications:",w)}finally{o(!1)}}},f=async()=>{if(!(!t||!t.id||!u(t)))try{if(!await nr(!1)){n([]),i(0);return}const b=await qe(`${ve}/index.php?endpoint=notifications&count=1`,{method:"GET",suppressUnauthorizedEvent:!0});if(b.status===401){console.log("NotificationContext: 401 error, stopping polling"),c.current&&(clearInterval(c.current),c.current=null);return}if(b.ok){const S=await b.json();S.success&&i(S.count)}else console.warn("NotificationContext: Unexpected response status:",b.status)}catch(w){console.error("Error loading unread count:",w)}},v={notifications:r,unreadCount:a,loading:s,markAsRead:async w=>{if(!(!t||!t.id||!u(t)))try{if(!await nr(!1))return;const S=await qe(`${ve}/index.php?endpoint=notifications`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({notification_id:w}),suppressUnauthorizedEvent:!0});if(S.status===401)return;S.ok&&(await S.json()).success&&(n(_=>_.map(E=>E.id===w?{...E,read:!0}:E)),i(_=>Math.max(0,_-1)))}catch(b){console.error("Error marking notification as read:",b)}},markAllAsRead:async()=>{if(!(!t||!t.id||!u(t)))try{if(!await nr(!1))return;const b=await qe(`${ve}/index.php?endpoint=notifications&action=mark-all-read`,{method:"PUT",suppressUnauthorizedEvent:!0});if(b.status===401)return;b.ok&&(await b.json()).success&&(n(k=>k.map(_=>({..._,read:!0}))),i(0))}catch(w){console.error("Error marking all notifications as read:",w)}},deleteNotification:async w=>{if(!(!t||!t.id||!u(t)))try{if(!await nr(!1))return;const S=await qe(`${ve}/index.php?endpoint=notifications`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({notification_id:w}),suppressUnauthorizedEvent:!0});if(S.status===401)return;if(S.ok&&(await S.json()).success){const _=r.find(E=>E.id===w);n(E=>E.filter(P=>P.id!==w)),_&&!_.read&&i(E=>Math.max(0,E-1)),f()}}catch(b){console.error("Error deleting notification:",b)}},addNotification:w=>{const b={id:Date.now(),timestamp:new Date,read:!1,...w};n(S=>[b,...S]),i(S=>S+1)},loadNotifications:d,loadUnreadCount:f,deleteAllNotifications:async()=>{if(!(!t||!t.id||!u(t)))try{if(!await nr(!1))return;const b=await qe(`${ve}/index.php?endpoint=notifications&all=1`,{method:"DELETE",headers:{"Content-Type":"application/json"},suppressUnauthorizedEvent:!0});if(b.status===401)return;b.ok&&(n([]),i(0))}catch(w){console.error("Error deleting all notifications:",w)}}};return l(IT.Provider,{value:v,children:e})},H8=({currentPage:e,onPageChange:t,user:r,onLogout:n,onSuperAdminTabChange:a,activeSuperAdminTab:i,notificationsCount:s,isCollapsed:o,onToggleCollapse:c})=>{var y,v,w,b,S,k,_,E,P;const u=A=>{try{A&&A.preventDefault&&A.preventDefault()}catch{}if(typeof n=="function")n();else{try{localStorage.removeItem("token")}catch{}try{sessionStorage&&sessionStorage.clear&&sessionStorage.clear()}catch{}try{window.location.reload()}catch{}}},d=()=>{if(!(r!=null&&r.roles))return"User";const A=Array.isArray(r.roles)?r.roles:typeof r.roles=="string"?r.roles.split(",").map(R=>R.trim()).filter(R=>R.length>0):[];return[...new Set(A)].join(", ")},f=()=>{if(!(r!=null&&r.roles))return"bg-gray-500";const A=Array.isArray(r.roles)?r.roles:typeof r.roles=="string"?r.roles.split(",").map(T=>T.trim()).filter(T=>T.length>0):[];return A.includes("Super Admin")||A.includes("Admin")||A.includes("Employee"),"bg-green-500"};console.log(" ADMINSIDEBAR LOADED - This should NOT show for Super Admin users!"),console.log("AdminSidebar - User object:",r),console.log("AdminSidebar - User roles:",r==null?void 0:r.roles),console.log("AdminSidebar - Is Super Admin:",(y=r==null?void 0:r.roles)==null?void 0:y.includes("Super Admin")),console.log("AdminSidebar - Is Admin:",(v=r==null?void 0:r.roles)==null?void 0:v.includes("Admin")),console.log("AdminSidebar - Admin condition result:",((w=r==null?void 0:r.roles)==null?void 0:w.includes("Admin"))&&!((b=r==null?void 0:r.roles)!=null&&b.includes("Super Admin"))),(S=r==null?void 0:r.roles)!=null&&S.includes("Super Admin")&&((k=r==null?void 0:r.roles)!=null&&k.includes("Admin"))&&console.warn("Super Admin user has both Super Admin and Admin roles - this indicates an old token. Please log out and log back in.");const h=[{id:"dashboard",name:"Dashboard",icon:l(zd,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"notifications",name:"Notifications",icon:l(Ea,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"system-reports",name:"Sales Reports",icon:l(ls,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"inventory",name:"Inventory",icon:l(Ye,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"orders-management",name:"Orders",icon:l(ls,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"pc-assembly",name:"PC Assembly",icon:l(ua,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"prebuilt-management",name:"Prebuilt",icon:l(Ki,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})}],p=[{id:"dashboard",name:"Dashboard",icon:l(zd,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"notifications",name:"Notifications",icon:l(Ea,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"system-reports",name:"Sales Reports",icon:l(ls,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"inventory",name:"Inventory",icon:l(Ye,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"orders-management",name:"Orders",icon:l(ls,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"pc-assembly",name:"PC Assembly",icon:l(ua,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"prebuilt-management",name:"Prebuilt",icon:l(Ki,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"admin-chat-support",name:"Chat Support",icon:l(Ca,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})}],x=p.map(A=>{var R;let T=!1;return(R=r==null?void 0:r.roles)!=null&&R.includes("Employee")&&(A.id==="inventory"?T=Number(r==null?void 0:r.can_access_inventory)!==1:A.id==="orders-management"?T=Number(r==null?void 0:r.can_access_orders)!==1:A.id==="admin-chat-support"&&(T=Number(r==null?void 0:r.can_access_chat_support)!==1)),{...A,isDisabled:T}}),g=(A,T)=>{if(T){let R="";A==="inventory"?R="Your access to Inventory Management has been disabled by a Super Admin.":A==="orders-management"?R="Your access to Orders Management has been disabled by a Super Admin.":A==="admin-chat-support"&&(R="Your access to Chat Support has been disabled by a Super Admin."),alert(R);return}t(A==="dashboard"?"admin-dashboard":A)};return l(lt,{children:m("div",{className:`
        sticky top-0 z-40
        bg-white shadow-lg flex flex-col h-screen flex-shrink-0 relative
        ${o?"w-[88px] xl:w-[104px]":"w-[288px] xl:w-[320px]"}
        transition-[width] duration-300 ease-in-out
      `,children:[l("div",{className:`absolute ${o?"top-1/2 -translate-y-1/2":"top-4"} right-2 lg:right-3 z-50 transition-all`,children:l("button",{onClick:c,className:"bg-white p-2 rounded-md shadow-lg border",title:o?"Expand sidebar":"Collapse sidebar","aria-label":o?"Expand sidebar":"Collapse sidebar",children:o?l(ab,{className:"h-5 w-5"}):l(nb,{className:"h-5 w-5"})})}),l("div",{className:"p-4 lg:p-6 border-b border-gray-200",children:m("div",{className:"flex items-center space-x-3",children:[l("div",{className:"w-8 h-8 lg:w-10 lg:h-10 bg-green-600 rounded-lg flex items-center justify-center",children:l("svg",{className:"w-5 h-5 lg:w-6 lg:h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})})}),!o&&m("div",{children:[l("h1",{className:"text-lg lg:text-xl font-bold text-gray-900",children:"SIMS"}),l("p",{className:"text-xs lg:text-sm text-gray-500",children:"PC Building Platform"})]})]})}),r&&l("div",{className:"p-3 lg:p-4 border-b border-gray-200",children:m("div",{className:"flex items-center space-x-3",children:[l("div",{className:"w-8 h-8 lg:w-10 lg:h-10 bg-gray-300 rounded-full flex items-center justify-center",children:r!=null&&r.profile_image?l("img",{src:r.profile_image,alt:"Profile",className:"w-8 h-8 lg:w-10 lg:h-10 rounded-full object-cover"}):l("svg",{className:"w-4 h-4 lg:w-6 lg:h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),!o&&m("div",{className:"flex-1 min-w-0",children:[m("p",{className:"text-xs lg:text-sm font-medium text-gray-900 truncate",children:[r==null?void 0:r.first_name," ",r==null?void 0:r.last_name]}),m("p",{className:"text-xs text-gray-500 truncate",children:["@",r==null?void 0:r.username]}),l("div",{className:"flex items-center mt-1",children:l("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium text-white ${f()}`,children:d()})})]})]})}),m("nav",{className:"flex-1 p-3 lg:p-4 space-y-1 lg:space-y-2 overflow-y-auto max-h-[calc(100vh-200px)]",children:[((_=r==null?void 0:r.roles)==null?void 0:_.includes("Super Admin"))&&m(lt,{children:[!o&&l("div",{className:"pt-2 lg:pt-4 border-t border-gray-200",children:l("h3",{className:"px-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Super Admin"})}),h.map(A=>m("button",{onClick:()=>{a(A.id)},className:`w-full flex items-center px-3 lg:px-5 py-2 text-xs lg:text-sm font-medium rounded-md transition-colors ${o?"justify-center":"truncate"} ${e==="super-admin-dashboard"&&i===A.id||e===A.id?"bg-green-100 text-green-700":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,title:A.name,"aria-label":A.name,children:[A.icon,!o&&A.name,!o&&A.id==="notifications"&&typeof s<"u"&&s>0&&l("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-green-600 rounded-full",children:s})]},A.id))]}),(()=>{var R,D;const A=(R=r==null?void 0:r.roles)==null?void 0:R.includes("Admin"),T=(D=r==null?void 0:r.roles)==null?void 0:D.includes("Super Admin");return console.log("AdminSidebar - isAdmin:",A,"isSuperAdmin:",T,"shouldShowAdminNav:",A&&!T),A&&!T})()&&m(lt,{children:[!o&&l("div",{className:"pt-2 lg:pt-4 border-t border-gray-200",children:l("h3",{className:"px-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Admin"})}),p.map(A=>m("button",{onClick:()=>g(A.id,!1),className:`w-full flex items-center px-3 lg:px-5 py-2 text-xs lg:text-sm font-medium rounded-md transition-colors ${o?"justify-center":"truncate"} ${A.id==="dashboard"&&e==="admin-dashboard"||e===A.id?"bg-green-100 text-green-700":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,title:A.name,"aria-label":A.name,children:[A.icon,!o&&l("span",{className:"flex-1 text-left",children:A.name}),!o&&A.id==="notifications"&&typeof s<"u"&&s>0&&l("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-green-600 rounded-full",children:s})]},A.id))]}),((E=r==null?void 0:r.roles)==null?void 0:E.includes("Employee"))&&!((P=r==null?void 0:r.roles)!=null&&P.includes("Admin"))&&m(lt,{children:[!o&&l("div",{className:"pt-2 lg:pt-4 border-t border-gray-200",children:l("h3",{className:"px-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Employee"})}),x.map(A=>m("button",{onClick:()=>g(A.id,A.isDisabled),disabled:A.isDisabled,className:`w-full flex items-center px-3 lg:px-5 py-2 text-xs lg:text-sm font-medium rounded-md transition-colors ${o?"justify-center":"truncate"} ${A.id==="dashboard"&&e==="admin-dashboard"||e===A.id?"bg-green-100 text-green-700":A.isDisabled?"text-gray-400 cursor-not-allowed opacity-60 bg-gray-50 border border-gray-200":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,title:A.isDisabled?"Access disabled by Super Admin":A.name,"aria-label":A.name,children:[A.icon,!o&&l("span",{className:"flex-1 text-left",children:A.name}),!o&&A.isDisabled&&l(ib,{className:"ml-2 h-4 w-4 text-gray-400"}),!o&&A.id==="notifications"&&typeof s<"u"&&s>0&&l("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-green-600 rounded-full",children:s})]},A.id))]})]}),l("div",{className:"p-3 lg:p-4 border-t border-gray-200",children:m("button",{type:"button",onClick:u,onKeyDown:A=>{(A.key==="Enter"||A.key===" ")&&u(A)},className:`w-full flex items-center ${o?"justify-center":"justify-center gap-2"} px-4 py-2 text-white bg-red-600 hover:bg-red-700 rounded-xl shadow-lg font-semibold transition-colors duration-200`,children:[l("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),!o&&"Logout"]})})]})})},W8=({currentPage:e,onPageChange:t,user:r,onLogout:n,onSuperAdminTabChange:a,activeSuperAdminTab:i,notificationsCount:s,isCollapsed:o,onToggleCollapse:c})=>{var p,x;const u=g=>{try{g&&g.preventDefault&&g.preventDefault()}catch{}if(typeof n=="function")n();else{try{localStorage.removeItem("token")}catch{}try{sessionStorage&&sessionStorage.clear&&sessionStorage.clear()}catch{}try{window.location.reload()}catch{}}},d=()=>{if(!(r!=null&&r.roles))return"User";const g=Array.isArray(r.roles)?r.roles:typeof r.roles=="string"?r.roles.split(",").map(v=>v.trim()).filter(v=>v.length>0):[];return[...new Set(g)].join(", ")},f=()=>{if(!(r!=null&&r.roles))return"bg-gray-500";const g=Array.isArray(r.roles)?r.roles:typeof r.roles=="string"?r.roles.split(",").map(y=>y.trim()).filter(y=>y.length>0):[];return g.includes("Super Admin")||g.includes("Admin")||g.includes("Employee"),"bg-green-500"};console.log(" SUPERADMINSIDEBAR LOADED - This should show for Super Admin users only!"),console.log("SuperAdminSidebar - User object:",r),console.log("SuperAdminSidebar - User roles:",r==null?void 0:r.roles),console.log("SuperAdminSidebar - Is Super Admin:",(p=r==null?void 0:r.roles)==null?void 0:p.includes("Super Admin"));const h=[{id:"dashboard",name:"Dashboard",icon:l(zd,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"notifications",name:"Notifications",icon:l(Ea,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"system-reports",name:"Sales Reports",icon:l(ls,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"inventory",name:"Inventory",icon:l(Ye,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"orders-management",name:"Orders",icon:l(ls,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"pc-assembly",name:"PC Assembly",icon:l(ua,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"prebuilt-management",name:"Prebuilt",icon:l(Ki,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"user-management",name:"User",icon:l(iu,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})}];return l(lt,{children:m("div",{className:`
        sticky top-0 z-40
        bg-white shadow-lg flex flex-col h-screen flex-shrink-0 relative
        ${o?"w-[88px] xl:w-[104px]":"w-[288px] xl:w-[320px]"}
        transition-[width] duration-300 ease-in-out
      `,children:[l("div",{className:`absolute ${o?"top-1/2 -translate-y-1/2":"top-4"} right-2 lg:right-3 z-50 transition-all`,children:l("button",{onClick:c,className:"bg-white p-2 rounded-md shadow-lg border",title:o?"Expand sidebar":"Collapse sidebar","aria-label":o?"Expand sidebar":"Collapse sidebar",children:o?l(ab,{className:"h-5 w-5"}):l(nb,{className:"h-5 w-5"})})}),l("div",{className:"p-4 lg:p-6 border-b border-gray-200",children:m("div",{className:"flex items-center space-x-3",children:[l("div",{className:"w-8 h-8 lg:w-10 lg:h-10 bg-green-600 rounded-lg flex items-center justify-center",children:l("svg",{className:"w-5 h-5 lg:w-6 lg:h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})})}),!o&&m("div",{children:[l("h1",{className:"text-lg lg:text-xl font-bold text-gray-900",children:"SIMS"}),l("p",{className:"text-xs lg:text-sm text-gray-500",children:"PC Building Platform"})]})]})}),r&&l("div",{className:"p-3 lg:p-4 border-b border-gray-200",children:m("div",{className:"flex items-center space-x-3",children:[l("div",{className:"w-8 h-8 lg:w-10 lg:h-10 bg-gray-300 rounded-full flex items-center justify-center",children:r!=null&&r.profile_image?l("img",{src:r.profile_image,alt:"Profile",className:"w-8 h-8 lg:w-10 lg:h-10 rounded-full object-cover"}):l("svg",{className:"w-4 h-4 lg:w-6 lg:h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),!o&&m("div",{className:"flex-1 min-w-0",children:[m("p",{className:"text-xs lg:text-sm font-medium text-gray-900 truncate",children:[r==null?void 0:r.first_name," ",r==null?void 0:r.last_name]}),m("p",{className:"text-xs text-gray-500 truncate",children:["@",r==null?void 0:r.username]}),l("div",{className:"flex items-center mt-1",children:l("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium text-white ${f()}`,children:d()})})]})]})}),l("nav",{className:"flex-1 p-3 lg:p-4 space-y-1 lg:space-y-2 overflow-y-auto max-h-[calc(100vh-200px)]",children:((x=r==null?void 0:r.roles)==null?void 0:x.includes("Super Admin"))&&m(lt,{children:[!o&&l("div",{className:"pt-2 lg:pt-4 border-t border-gray-200",children:l("h3",{className:"px-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Super Admin"})}),h.map(g=>m("button",{onClick:()=>{a(g.id)},className:`w-full flex items-center px-3 lg:px-5 py-2 text-xs lg:text-sm font-medium rounded-md transition-colors ${o?"justify-center":"truncate"} ${e==="super-admin-dashboard"&&i===g.id||e===g.id?"bg-green-100 text-green-700":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,title:g.name,"aria-label":g.name,children:[g.icon,!o&&g.name,!o&&g.id==="notifications"&&typeof s<"u"&&s>0&&l("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-green-600 rounded-full",children:s})]},g.id))]})}),l("div",{className:"p-3 lg:p-4 border-t border-gray-200",children:m("button",{type:"button",onClick:u,onKeyDown:g=>{(g.key==="Enter"||g.key===" ")&&u(g)},className:`w-full flex items-center ${o?"justify-center":"justify-center gap-2"} px-4 py-2 text-white bg-red-600 hover:bg-red-700 rounded-xl shadow-lg font-semibold transition-colors duration-200`,children:[l("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),!o&&"Logout"]})})]})})},G8=({currentPage:e,onPageChange:t,user:r,onLogout:n,isCollapsed:a,onToggleCollapse:i})=>{const s=h=>{try{h&&h.preventDefault&&h.preventDefault()}catch{}if(!(typeof window<"u")||window.confirm("Are you sure you want to logout?"))if(typeof n=="function")n();else{try{localStorage.removeItem("token")}catch{}try{sessionStorage&&sessionStorage.clear&&sessionStorage.clear()}catch{}try{window.location.reload()}catch{}}},o=()=>{if(!(r!=null&&r.roles))return"User";const h=Array.isArray(r.roles)?r.roles:typeof r.roles=="string"?r.roles.split(",").map(x=>x.trim()).filter(x=>x.length>0):[];return[...new Set(h)].join(", ")},c=()=>{if(!(r!=null&&r.roles))return"bg-gray-500";const h=Array.isArray(r.roles)?r.roles:typeof r.roles=="string"?r.roles.split(",").map(p=>p.trim()).filter(p=>p.length>0):[];return h.includes("Super Admin")||h.includes("Admin")||h.includes("Employee"),"bg-green-500"},d=[{id:"employee-dashboard",name:"Dashboard",icon:l(zd,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"notifications",name:"Notifications",icon:l(Ea,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"system-reports",name:"Sales Reports",icon:l(ls,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"inventory",name:"Inventory",icon:l(Ye,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"orders-management",name:"Orders",icon:l(ls,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"pc-assembly",name:"PC Assembly",icon:l(ua,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"prebuilt-management",name:"Prebuilt",icon:l(Ki,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"admin-chat-support",name:"Chat Support",icon:l(Ca,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})}].map(h=>{let p=!1;return h.id==="inventory"?p=Number(r==null?void 0:r.can_access_inventory)!==1:h.id==="orders-management"?p=Number(r==null?void 0:r.can_access_orders)!==1:h.id==="admin-chat-support"&&(p=Number(r==null?void 0:r.can_access_chat_support)!==1),{...h,isDisabled:p}}),f=(h,p)=>{if(p){let x="";h==="inventory"?x="Your access to Inventory Management has been disabled by a Super Admin.":h==="orders-management"?x="Your access to Orders Management has been disabled by a Super Admin.":h==="admin-chat-support"&&(x="Your access to Chat Support has been disabled by a Super Admin."),alert(x);return}t(h)};return l(lt,{children:m("div",{className:`
        sticky top-0 z-40
        bg-white shadow-lg flex flex-col h-screen flex-shrink-0 relative
        ${a?"w-[88px] xl:w-[104px]":"w-[288px] xl:w-[320px]"}
        transition-[width] duration-300 ease-in-out
      `,children:[l("div",{className:`absolute ${a?"top-1/2 -translate-y-1/2":"top-4"} right-2 lg:right-3 z-50 transition-all`,children:l("button",{onClick:i,className:"bg-white p-2 rounded-md shadow-lg border",title:a?"Expand sidebar":"Collapse sidebar","aria-label":a?"Expand sidebar":"Collapse sidebar",children:a?l(ab,{className:"h-5 w-5"}):l(nb,{className:"h-5 w-5"})})}),l("div",{className:"p-4 lg:p-6 border-b border-gray-200",children:m("div",{className:"flex items-center space-x-3",children:[l("div",{className:"w-8 h-8 lg:w-10 lg:h-10 bg-green-600 rounded-lg flex items-center justify-center",children:l("svg",{className:"w-5 h-5 lg:w-6 lg:h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})})}),!a&&m("div",{children:[l("h1",{className:"text-lg lg:text-xl font-bold text-gray-900",children:"SIMS"}),l("p",{className:"text-xs lg:text-sm text-gray-500",children:"PC Building Platform"})]})]})}),r&&l("div",{className:"p-3 lg:p-4 border-b border-gray-200",children:m("div",{className:"flex items-center space-x-3",children:[l("div",{className:"w-8 h-8 lg:w-10 lg:h-10 bg-gray-300 rounded-full flex items-center justify-center",children:r!=null&&r.profile_image?l("img",{src:r.profile_image,alt:"Profile",className:"w-8 h-8 lg:w-10 lg:h-10 rounded-full object-cover"}):l("svg",{className:"w-4 h-4 lg:w-6 lg:h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),!a&&m("div",{className:"flex-1 min-w-0",children:[m("p",{className:"text-xs lg:text-sm font-medium text-gray-900 truncate",children:[r==null?void 0:r.first_name," ",r==null?void 0:r.last_name]}),m("p",{className:"text-xs text-gray-500 truncate",children:["@",r==null?void 0:r.username]}),l("div",{className:"flex items-center mt-1",children:l("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium text-white ${c()}`,children:o()})})]})]})}),m("nav",{className:"flex-1 p-3 lg:p-4 space-y-1 lg:space-y-2 overflow-y-auto max-h-[calc(100vh-200px)]",children:[!a&&l("div",{className:"pt-2 lg:pt-4 border-t border-gray-200",children:l("h3",{className:"px-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Employee"})}),d.map(h=>m("button",{onClick:()=>f(h.id,h.isDisabled),disabled:h.isDisabled,className:`w-full flex items-center px-3 lg:px-5 py-2 text-xs lg:text-sm font-medium rounded-md transition-colors ${a?"justify-center":"truncate"} ${h.isDisabled?"text-gray-400 cursor-not-allowed opacity-60 bg-gray-50 border border-gray-200":e===h.id?"bg-green-100 text-green-700":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,title:h.isDisabled?"Access disabled by Super Admin":h.name,"aria-label":h.name,children:[h.icon,!a&&l("span",{className:"flex-1 text-left",children:h.name}),!a&&h.isDisabled&&l(ib,{className:"ml-2 h-4 w-4 text-gray-400"})]},h.id))]}),l("div",{className:"p-3 lg:p-4 border-t border-gray-200",children:m("button",{type:"button",onClick:s,onKeyDown:h=>{(h.key==="Enter"||h.key===" ")&&s(h)},className:`w-full flex items-center ${a?"justify-center":"justify-center gap-2"} px-4 py-2 text-white bg-red-600 hover:bg-red-700 rounded-xl shadow-lg font-semibold transition-colors duration-200`,children:[l("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),!a&&"Logout"]})})]})})},V8=({currentPage:e,onPageChange:t,user:r,onLogout:n,onSuperAdminTabChange:a,activeSuperAdminTab:i})=>{const[s,o]=N.useState(!1),[c,u]=N.useState(!1);let d=0;try{const{unreadCount:v}=dp();d=v||0}catch{d=0}const f=v=>{try{v&&v.preventDefault&&v.preventDefault()}catch{}if(!(typeof window<"u")||window.confirm("Are you sure you want to logout?"))if(typeof n=="function")n();else{try{localStorage.removeItem("token")}catch{}try{sessionStorage&&sessionStorage.clear&&sessionStorage.clear()}catch{}try{window.location.reload()}catch{}}},h=()=>{if(!(r!=null&&r.roles))return"User";const v=Array.isArray(r.roles)?r.roles:typeof r.roles=="string"?r.roles.split(",").map(b=>b.trim()).filter(b=>b.length>0):[];return[...new Set(v)].join(", ")},p=()=>{if(!(r!=null&&r.roles))return"bg-gray-500";const v=Array.isArray(r.roles)?r.roles:typeof r.roles=="string"?r.roles.split(",").map(w=>w.trim()).filter(w=>w.length>0):[];return v.includes("Super Admin")?"bg-red-500":v.includes("Admin")?"bg-purple-500":v.includes("Employee")?"bg-blue-500":"bg-green-500"},x=Array.isArray(r==null?void 0:r.roles)?r.roles:typeof(r==null?void 0:r.roles)=="string"?r.roles.split(",").map(v=>v.trim()):[],g=[{id:"home",name:"HOME",icon:l(C8,{className:"w-4 h-4"})},{id:"prebuilt-pcs",name:"PREBUILT PCS",icon:l(Ye,{className:"w-4 h-4"})},{id:"pc-assembly",name:"BUILD A PC",icon:l(ua,{className:"w-4 h-4"})}],y=r?[...x.includes("Client")&&!x.includes("Admin")&&!x.includes("Employee")&&!x.includes("Super Admin")?[{id:"my-builds",name:"My Builds",icon:l(Ye,{className:"w-4 h-4"})},{id:"my-orders",name:"My Orders",icon:l(ls,{className:"w-4 h-4"})},{id:"pc-assembly",name:"PC Assembly",icon:l(ua,{className:"w-4 h-4"})},{id:"notifications",name:"Notifications",icon:l(Ea,{className:"w-4 h-4"}),badge:d}]:[]]:[];return l("nav",{className:"bg-white shadow-lg sticky top-0 z-50",children:m("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[m("div",{className:"flex justify-between items-center h-16",children:[m("button",{onClick:()=>{var v,w,b;(v=r==null?void 0:r.roles)!=null&&v.includes("Super Admin")?t("super-admin-dashboard"):(w=r==null?void 0:r.roles)!=null&&w.includes("Admin")?t("admin-dashboard"):(b=r==null?void 0:r.roles)!=null&&b.includes("Employee")?t("employee-dashboard"):t("home")},className:"flex items-center space-x-3 hover:opacity-80 transition-opacity",children:[l("div",{className:"w-8 h-8 bg-green-600 rounded-lg flex items-center justify-center",children:l("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})})}),l("div",{children:l("h1",{className:"text-lg font-bold text-gray-900",children:"SIMS"})})]}),l("div",{className:"hidden md:flex items-center space-x-8",children:g.map(v=>m("button",{onClick:()=>t(v.id),className:`flex items-center space-x-1 px-3 py-2 text-sm font-medium rounded-md transition-colors ${e===v.id?"text-green-600 bg-green-50":"text-gray-700 hover:text-green-600 hover:bg-gray-50"}`,children:[v.icon,l("span",{children:v.name})]},v.id))}),m("div",{className:"flex items-center space-x-4",children:[r&&m("button",{onClick:()=>t("notifications"),className:"relative p-2 text-gray-700 hover:text-green-600 transition-colors",children:[l(Ea,{className:"w-5 h-5"}),d>0&&l("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 rounded-full text-xs font-bold bg-red-500 text-white",children:d})]}),r?m("div",{className:"relative",children:[m("button",{onClick:()=>u(!c),className:"flex items-center space-x-2 p-2 text-gray-700 hover:text-green-600 transition-colors rounded-md hover:bg-gray-50",children:[l("div",{className:"w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center",children:r!=null&&r.profile_image?l("img",{src:r.profile_image,alt:"Profile",className:"w-8 h-8 rounded-full object-cover"}):l(Ko,{className:"w-4 h-4 text-gray-600"})}),m("span",{className:"hidden sm:block text-sm font-medium",children:[r==null?void 0:r.first_name," ",r==null?void 0:r.last_name]}),l(cp,{className:"w-4 h-4"})]}),c&&m("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-md shadow-lg py-1 z-50",children:[m("div",{className:"px-4 py-2 border-b border-gray-200",children:[m("p",{className:"text-sm font-medium text-gray-900",children:[r==null?void 0:r.first_name," ",r==null?void 0:r.last_name]}),m("p",{className:"text-xs text-gray-500",children:["@",r==null?void 0:r.username]}),l("div",{className:"flex items-center mt-1",children:l("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium text-white ${p()}`,children:h()})})]}),y.map(v=>m("button",{onClick:()=>{t(v.id),u(!1)},className:"w-full flex items-center justify-between px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[m("div",{className:"flex items-center space-x-2",children:[v.icon,l("span",{children:v.name})]}),v.badge&&v.badge>0&&l("span",{className:"inline-flex items-center justify-center px-2 py-0.5 rounded-full text-xs font-bold bg-red-500 text-white",children:v.badge})]},v.id)),m("button",{type:"button",onClick:v=>{v.preventDefault(),f(),u(!1)},className:"w-full flex items-center space-x-2 px-4 py-2 text-sm text-red-600 hover:bg-red-50 rounded-md transition-colors duration-200 group",children:[l(T8,{className:"w-4 h-4 group-hover:scale-110 transition-transform"}),l("span",{children:"Logout"})]})]})]}):m("div",{className:"flex items-center space-x-2",children:[l("button",{onClick:()=>t("login"),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-green-600 transition-colors",children:"Login"}),l("button",{onClick:()=>t("register"),className:"px-4 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-md transition-colors",children:"Register"})]}),l("button",{onClick:()=>o(!s),className:"md:hidden p-2 text-gray-700 hover:text-green-600 transition-colors",children:s?l(Gn,{className:"w-6 h-6"}):l(D8,{className:"w-6 h-6"})})]})]}),s&&l("div",{className:"md:hidden border-t border-gray-200 py-4",children:m("div",{className:"space-y-2",children:[g.map(v=>m("button",{onClick:()=>{t(v.id),o(!1)},className:`w-full flex items-center space-x-2 px-3 py-2 text-sm font-medium rounded-md transition-colors ${e===v.id?"text-green-600 bg-green-50":"text-gray-700 hover:text-green-600 hover:bg-gray-50"}`,children:[v.icon,l("span",{children:v.name})]},v.id)),r&&y.map(v=>m("button",{onClick:()=>{t(v.id),o(!1)},className:"w-full flex items-center justify-between px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:[m("div",{className:"flex items-center space-x-2",children:[v.icon,l("span",{children:v.name})]}),v.badge&&v.badge>0&&l("span",{className:"inline-flex items-center justify-center px-2 py-0.5 rounded-full text-xs font-bold bg-red-500 text-white",children:v.badge})]},v.id))]})})]})})};function gt(e,t={}){const n=(()=>{if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const s=e.replace(/[^0-9.\-]/g,""),o=Number(s);if(Number.isFinite(o))return o}return 0})();return new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:t.minimumFractionDigits??2,maximumFractionDigits:t.maximumFractionDigits??2}).format(n).replace("PHP","").replace("","")}const Iu=import.meta&&{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}&&"/"||"/",bt=e=>{if(!e)return e;const t=e.startsWith("/")?e.slice(1):e;return!Iu||Iu==="./"?t:`${Iu.endsWith("/")?Iu.slice(0,-1):Iu}/${t}`},K8=(e,t)=>{if(!e||t<=0)return 0;let r=5381;for(let n=0;n<e.length;n++)r=(r<<5)+r^e.charCodeAt(n);return Math.abs(r)%t},$S={"R3 3200G (TRAY) WITH HEATSINK FAN":"/images/components/cpu/R3 3200G (TRAY) WITH HEATSINK FAN.png","R5 5600G (TRAY) WITH HEATSINK FAN":"/images/components/cpu/r5_5600G_tray.png","R5 5600GT (TRAY) WITH HEATSINK FAN":"/images/components/cpu/R5 5600GT (TRAY) WITH HEATSINK FAN.png","R5 5600X (box) WITH WRAITH STEALTH COOLER":"/images/components/cpu/R5 5600X (TRAY) WITH HEATSINK FAN.png","R5 5600X (box) WITH WRAITH STEALTH":"/images/components/cpu/R5 5600X (TRAY) WITH HEATSINK FAN.png","R5 5600X (TRAY) NO COOLER":"/images/components/cpu/r5_5600x_tray.png","R5 5600X (TRAY) WITH HEATSINK FAN":"/images/components/cpu/R5 5600X (TRAY) WITH HEATSINK FAN.png","R5 7600X (TRAY) WITH HEATSINK FAN":"/images/components/cpu/R5 7600X (TRAY) WITH HEATSINK FAN.png","R7 4750G (TRAY) WITH HEATSINK FAN":"/images/components/cpu/R7 4750G (TRAY) WITH HEATSINK FAN.png","R7 5700G (TRAY) WITH HEATSINK FAN":"/images/components/cpu/R7 5700G (TRAY) WITH HEATSINK FAN.png","R7 5700X (TRAY) WITH HEATSINK FAN":"/images/components/cpu/R7 5700X (TRAY) WITH HEATSINK FAN.png","R7 5800X (TRAY) WITH HEATSINK FAN":"/images/components/cpu/R7 5800X (TRAY) WITH HEATSINK FAN.png","i7-11700 (plastic blister) + ISF":"/images/components/cpu/i7-11700 (plastic blister).png","R7 5700X3D 8 CORE 16 THREADS 3.0/4.1 GHZ AM4 W/OUT COOLER":"/images/components/cpu/R7 5700X3D (TRAY).png","R7 5700X (TRAY) NO COOLER":"/images/components/cpu/R7 5700X (TRAY) WITH HEATSINK FAN.png","GALAX RTX 3060 1-CLICK OC BLK 12GB":"/images/components/gpu/GALAX RTX 3060 1-CLICK OC BLK 12GB.png","GALAX RTX 4060 1-CLICK OC BLACK 8GB":"/images/components/gpu/GALAX RTX 4060 1-CLICK OC BLACK 8GB.png","GIGABYTE RTX 4060 AERO OC 8GB WHITE":"/images/components/gpu/GIGABYTE RTX 4060 AERO OC 8GB WHITE.png","GIGABYTE RTX 4060TI AERO OC 16GB WHITE":"/images/components/gpu/GIGABYTE RTX 4060TI AERO OC 16GB WHITE.png","GIGABYTE RTX 4060TI AERO OC 8GB WHITE":"/images/components/gpu/GIGABYTE RTX 4060TI AERO OC 8GB WHITE.png","GIGABYTE RTX 4070 SUPER EAGLE OC 12GB":"/images/components/gpu/GIGABYTE RTX 4070 SUPER EAGLE OC 12GB.png","GIGABYTE RX 6600 8GB EAGLE":"/images/components/gpu/GIGABYTE RX 6600 8GB EAGLE.png","GIGABYTE RX 7600XT GAMING OC 16GB":"/images/components/gpu/GIGABYTE RX 7600XT GAMING OC 16GB.png","PNY VERTO RTX 4060 8GB DUAL FAN OC":"/images/components/gpu/PNY VERTO RTX 4060 8GB DUAL FAN OC.png","RAMSTA RX550 4GB GDDR5":"/images/components/gpu/RAMSTA RX550 4GB GDDR5.png","RAMSTA RX580 8GB GDDR5":"/images/components/gpu/RAMSTA RX580 8GB GDDR5.png","SAPPHIRE PULSE AMD RADEON RX 7800 XT 16GB":"/images/components/gpu/SAPPHIRE PULSE AMD RADEON RX 7800 XT 16GB.png","ASROCK RX 6600 CHALLENGER 8GB WHITE":"/images/components/gpu/ASROCK RX 6600 CHALLENGER 8GB WHITE.png","COLORFUL GEFORCE RTX 3070 BATTLE AX 8GB":"/images/components/gpu/COLORFUL GEFORCE RTX 3070 BATTLE AX 8GB.png","COLORFUL IGAME ULTRA RTX 4060 8GB (WHITE":"/images/components/gpu/COLORFUL IGAME ULTRA RTX 4060 8GB (WHITE.png","GALAX GTX 1650EX PLUS 4GB DDR6":"/images/components/gpu/GALAX GTX 1650EX PLUS 4GB DDR6.png","GALAX RTX 3050 1-CLICK OC BLK 6GB":"/images/components/gpu/GALAX RTX 3050 1-CLICK OC BLK 6GB.png","RX 6600 CHALLENGER 8GB WHITE":"/images/components/gpu/ASROCK RX 6600 CHALLENGER 8GB WHITE.png","RX 7600XT GAMING OC 16GB":"/images/components/gpu/GIGABYTE RX 7600XT GAMING OC 16GB.png","KINGSTON FURY BEAST DDR4 8GB":"/images/components/ram/KINGSTON FURY BEAST DDR4 8GB.png","KINGSTON FURY BEAST DDR4 16GB (single stick)":"/images/components/ram/KINGSTON FURY BEAST DDR4 16GB (single stick).png","KINGSPEC DDR4 8GB RGB":"/images/components/ram/KINGSPEC DDR4 8GB RGB.png","NEO FORZA FAYE DDR4":"/images/components/ram/NEO FORZA FAYE DDR4.png","NEO FORZA FAYE DDR4 16GB (2X8GB) NON RGB":"/images/components/ram/NEO FORZA FAYE DDR4 16GB (2X8GB) NON RGB.png","SKIHOTAR DDR4 4GB (2666MHz)":"/images/components/ram/SKIHOTAR DDR4 4GB (2666MHz).png","SKIHOTAR DDR4 8GB (3200MHz)":"/images/components/ram/SKIHOTAR DDR4 8GB (3200MHz).png","TEAM ELITE PLUS GOLD DDR4 8GB":"/images/components/ram/TEAM ELITE PLUS GOLD DDR4 8GB.png","TFORCE DDR4 DARKZA 16GB (2x8gb) 3600MHz":"/images/components/ram/TFORCE DDR4 DARKZA 16GB (2x8gb) 3600MHz.png","TFORCE Delta RGB DDR4 16GB kit (2x8gb) 3600MHz BLACK":"/images/components/ram/TFORCE Delta RGB DDR4 16GB kit (2x8gb) 3600MHz BLACK.png","TFORCE Delta RGB DDR4 16GB kit (2x8gb) 3600MHz WHITE":"/images/components/ram/TFORCE Delta RGB DDR4 16GB kit (2x8gb) 3600MHz WHITE.png","TFORCE Delta RGB DDR4 16GB kit (2x8gb) BLACK":"/images/components/ram/TFORCE Delta RGB DDR4 16GB kit (2x8gb) BLACK.png","TFORCE Delta RGB DDR4 16GB kit (2x8gb) WHITE":"/images/components/ram/TFORCE Delta RGB DDR4 16GB kit (2x8gb) WHITE.png","TFORCE Delta RGB DDR4 32GB kit (2x16gb) BLACK":"/images/components/ram/TFORCE Delta RGB DDR4 32GB kit (2x16gb) BLACK.png","TFORCE Delta RGB DDR4 32GB kit (2x16gb) WHITE":"/images/components/ram/TFORCE Delta RGB DDR4 32GB kit (2x16gb) WHITE.png","FURY BEAST DDR4 8gb":"/images/components/ram/KINGSTON FURY BEAST DDR4 8GB.png","FURY BEAST DDR4 16gb (single stick)":"/images/components/ram/KINGSTON FURY BEAST DDR4 16GB (single stick).png","FAYE DDR4 16GB (2X8GB) 3200 NON RGB w/ HS":"/images/components/ram/NEO FORZA FAYE DDR4 16GB (2X8GB) NON RGB.png","DDR4 8GB":"/images/components/ram/SKIHOTAR DDR4 8GB (3200MHz).png","PLUS GOLD DDR4  8GB":"/images/components/ram/TEAM ELITE PLUS GOLD DDR4 8GB.png","Delta RGB DDR4 16gb-kit (2x8gb) black":"/images/components/ram/TFORCE Delta RGB DDR4 16GB kit (2x8gb) BLACK.png","Delta RGB DDR4 16gb-kit (2x8gb) white":"/images/components/ram/TFORCE Delta RGB DDR4 16GB kit (2x8gb) WHITE.png","Delta RGB DDR4 32gb-kit (2x16gb) black":"/images/components/ram/TFORCE Delta RGB DDR4 32GB kit (2x16gb) BLACK.png","Delta RGB DDR4 32gb-kit (2x16gb) white":"/images/components/ram/TFORCE Delta RGB DDR4 32GB kit (2x16gb) WHITE.png","DDR4 DARKZA 16GB (2x8gb)":"/images/components/ram/TFORCE DDR4 DARKZA 16GB (2x8gb) 3600MHz.png","Delta RGB DDR4 16gb kit (2x8gb) black":"/images/components/ram/TFORCE Delta RGB DDR4 16GB kit (2x8gb) BLACK.png","Delta RGB DDR4 16gb kit (2x8gb) white":"/images/components/ram/TFORCE Delta RGB DDR4 16GB kit (2x8gb) WHITE.png","Delta RGB DDR4 32gb kit (2x16gb) black":"/images/components/ram/TFORCE Delta RGB DDR4 32GB kit (2x16gb) BLACK.png","Delta RGB DDR4 32gb kit (2x16gb) white":"/images/components/ram/TFORCE Delta RGB DDR4 32GB kit (2x16gb) WHITE.png","Delta RGB DDR4 (SINGLE STICK) 32gb white":"/images/components/ram/TFORCE Delta RGB DDR4 32GB kit (2x16gb) WHITE.png","ASRock B550M STEEL LEGEND":"/images/components/motherboard/ASRock B550M STEEL LEGEND.png","ASRock B550M-ITX-AC":"/images/components/motherboard/ASRock B550M-ITX-AC.png","ASRock H510M-HVS":"/images/components/motherboard/ASRock H510M-HVS.png","ASRock H610M-HVS":"/images/components/motherboard/ASRock H610M-HVS.png","ASUS PRIME A520M K":"/images/components/motherboard/ASUS PRIME A520M K.png","ASUS PRIME H510M-E":"/images/components/motherboard/ASUS PRIME H510M-E.png","BIOSTAR A520MHP":"/images/components/motherboard/BIOSTAR A520MHP.png","BIOSTAR B450MHP DDR43200 AM4":"/images/components/motherboard/BIOSTAR B450MHP DDR43200 AM4.png","GIGABYTE AORUS B550M ELITE":"/images/components/motherboard/GIGABYTE AORUS B550M ELITE.png","GIGABYTE B550M DS3H AC":"/images/components/motherboard/GIGABYTE B550M DS3H AC.png","GIGABYTE B550M DS3H":"/images/components/motherboard/GIGABYTE B550M DS3H.png","GIGABYTE B550M-K":"/images/components/motherboard/GIGABYTE B550M-K.png","GIGABYTE B660M DS3H":"/images/components/motherboard/GIGABYTE B660M DS3H.png","GIGABYTE H510M-K-V2":"/images/components/motherboard/GIGABYTE H510M-K-V2.png","GIGABYTE H610M H":"/images/components/motherboard/GIGABYTE H610M H.png","MMA A320":"/images/components/motherboard/MMA A320.png","MSI B550M PRO-VDH":"/images/components/motherboard/MSI B550M PRO-VDH.png","MSI MAG B550M":"/images/components/motherboard/MSI MAG B550M.png","WHALEKOM B450MV1":"/images/components/motherboard/WHALEKOM B450MV1.png","H510M HVS":"/images/components/motherboard/ASRock H510M-HVS.png","B550M STEEL LEGEND":"/images/components/motherboard/ASRock B550M STEEL LEGEND.png","A520M K":"/images/components/motherboard/ASUS PRIME A520M K.png","B450MHP DDR4/3200 AM4":"/images/components/motherboard/BIOSTAR B450MHP DDR43200 AM4.png",B450MV1:"/images/components/motherboard/WHALEKOM B450MV1.png",A520MHP:"/images/components/motherboard/BIOSTAR A520MHP.png","Crucial BX500 SSD":"/images/components/storage/Crucial BX500 SSD.png","Crucial P3 1TB-2TB":"/images/components/storage/Crucial P3 1TB-2TB.png","Kingston A400 SSD":"/images/components/storage/Kingston A400 SSD.png","Kingston NV2 500GB-1TB":"/images/components/storage/Kingston NV2 500GB-1TB.png","Samsung 970 EVO Plus 500GB":"/images/components/storage/Samsung 970 EVO Plus 500GB.png","Samsung 980 1TB NVMe":"/images/components/storage/Samsung 980 1TB NVMe.png","Seagate Barracuda 1TB-2TB HDD":"/images/components/storage/Seagate Barracuda 1TB-2TB HDD.png","WD Blue 1TB-2TB HDD":"/images/components/storage/WD Blue 1TB-2TB HDD.png","WD Blue SN570 1TB":"/images/components/storage/WD Blue SN570 1TB.png","WD Blue SN580 500GB":"/images/components/storage/WD Blue SN580 500GB.png","970 EVO PLUS 1tb":"/images/components/storage/Samsung 970 EVO Plus 500GB.png","NV3 PCIe 4.0 1TB":"/images/components/storage/Kingston NV2 500GB-1TB.png","Cooler Master MWE Bronze 550W":"/images/components/psu/Cooler Master MWE Bronze 550W.png","Corsair CV550":"/images/components/psu/Corsair CV550.png","Corsair CX550F":"/images/components/psu/Corsair CX550F.png","DeepCool DN series":"/images/components/psu/DeepCool DN series.png","EVGA 500 W1":"/images/components/psu/EVGA 500 W1.png","EVGA 600 BR":"/images/components/psu/EVGA 600 BR.png","FSP HV PRO 550W":"/images/components/psu/FSP HV PRO 550W.png","Seasonic Core GM-500":"/images/components/psu/Seasonic Core GM-500.png","Seasonic Focus GX-650":"/images/components/psu/Seasonic Focus GX-650.png","Thermaltake Smart 500W":"/images/components/psu/Thermaltake Smart 500W.png","CX550 80+ BRONZE 550watts":"/images/components/psu/Corsair CV550.png","CX650 80+ BRONZE 650watts":"/images/components/psu/Corsair CX550F.png","CV750 80+ BRONZE 750watts":"/images/components/psu/Corsair CV550.png","RM750E 80+ GOLD FULLY MODULAR 750watts":"/images/components/psu/Seasonic Focus GX-650.png","RM850E 80+ GOLD FULLY MODULAR 850watts":"/images/components/psu/Seasonic Focus GX-650.png","DE-600 v2 600watts":"/images/components/psu/DeepCool DN series.png","BTS-550 BRONZE 550WATTS":"/images/components/psu/EVGA 500 W1.png","BTS-650 BRONZE 650WATTS":"/images/components/psu/EVGA 600 BR.png","BTS-750 BRONZE 750WATTS":"/images/components/psu/EVGA 600 BR.png","(GC-PS014W/RGPS-650SFX) 80+ GOLD FULL MOD (white) 650watts":"/images/components/psu/Seasonic Focus GX-650.png","RGPS-700W 80+ BRONZE FULL MODULAR":"/images/components/psu/Seasonic Focus GX-650.png","P550SS SILVER WHITE (ICE)":"/images/components/psu/EVGA 600 BR.png","P550SS SILVER":"/images/components/psu/EVGA 600 BR.png","GS550 ULTRA BLACK ATX POWERSUPPLY 550W 80+ BRONZE RGB":"/images/components/psu/Cooler Master MWE Bronze 550W.png","GS650 ULTRA BLACK ATX POWERSUPPLY 650W 80+ BRONZE RGB":"/images/components/psu/Cooler Master MWE Bronze 550W.png","CX750 80+ BRONZE 750watts":"/images/components/psu/Corsair CV550.png","ACER V920":"/images/components/case/ACER V920.png","ACER V950":"/images/components/case/ACER V950.png","COOLMAN HARLEY":"/images/components/case/COOLMAN HARLEY.png","COOLMAN REYNA":"/images/components/case/COOLMAN REYNA.png","COOLMAN RUBY":"/images/components/case/COOLMAN RUBY.png","DARKFLASH DK351":"/images/components/case/DARKFLASH DK351.png","DARKFLASH DLM21 MESH":"/images/components/case/DARKFLASH DLM21 MESH.png","GAMDIAS TALOS E3 MESH":"/images/components/case/GAMDIAS TALOS E3 MESH.png","INPLAY WIND 01":"/images/components/case/INPLAY WIND 01.png","KEYTECH CYBORG CASE":"/images/components/case/KEYTECH CYBORG CASE.png","KEYTECH ROBIN SE (BLACK-WHITE)":"/images/components/case/KEYTECH ROBIN SE (BLACK-WHITE).png","KEYTECH T1000 (BLACK-WHITE)":"/images/components/case/KEYTECH T1000 (BLACK-WHITE).png","MMA AK99":"/images/components/case/MMA AK99.png","MMA SR89":"/images/components/case/MMA SR89.png","NZXT H5 FLOW":"/images/components/case/NZXT H5 FLOW.png","YGT B708":"/images/components/case/YGT B708.png","YGT B709":"/images/components/case/YGT B709.png","YGT N195":"/images/components/case/YGT N195.png","VISOR - WHITE (TEMPERED GLASS)":"/images/components/case/KEYTECH ROBIN SE (BLACK-WHITE).png","DEEPCOOL AG400 (AIR COOLERS)":"/images/components/cooler/DEEPCOOL AG400 (AIR COOLERS).png","DEEPCOOL AK400":"/images/components/cooler/DEEPCOOL AK400.png","DEEPCOOL AK500":"/images/components/cooler/DEEPCOOL AK500.png","DEEPCOOL LIQUID COOLER AIO - ARGB LE520":"/images/components/cooler/DEEPCOOL LIQUID COOLER AIO - ARGB LE520.png","DEEPCOOL LIQUID COOLER AIO - LS520 SE DIGITAL)":"/images/components/cooler/DEEPCOOL LIQUID COOLER AIO - LS520 SE DIGITAL).png","DEEPCOOL LIQUID COOLER AIO - LT520":"/images/components/cooler/DEEPCOOL LIQUID COOLER AIO - LT520.png","DEEPCOOL MYSTIQUE 240":"/images/components/cooler/DEEPCOOL MYSTIQUE 240.png","DEEPCOOL MYSTIQUE 360":"/images/components/cooler/DEEPCOOL MYSTIQUE 360.png","JONSBO CR 1200 EVO (AIR COOLERS)":"/images/components/cooler/JONSBO CR 1200 EVO (AIR COOLERS).png","JONSBO CR 1400 EVO (AIR COOLERS)":"/images/components/cooler/JONSBO CR 1400 EVO (AIR COOLERS).png","JUNGLE LEOPARD ASTROBEAT":"/images/components/cooler/JUNGLE LEOPARD ASTROBEAT.png","JUNGLE LEOPARD ASTROSHEL":"/images/components/cooler/JUNGLE LEOPARD ASTROSHEL.png","OVATION HURRICANE 240":"/images/components/cooler/OVATION HURRICANE 240.png","THERMALRIGHT LIQUID COOLER FROZEN WARFRAME 240 ARGB":"/images/components/cooler/THERMALRIGHT LIQUID COOLER FROZEN WARFRAME 240 ARGB.png","YGT LIQUID COOLER AIO - DF-120":"/images/components/cooler/YGT LIQUID COOLER AIO - DF-120.png"},Vl={cpu:["/images/components/cpu/R3 3200G (TRAY) WITH HEATSINK FAN.png","/images/components/cpu/r5_5600G_tray.png","/images/components/cpu/R5 5600X (TRAY) WITH HEATSINK FAN.png","/images/components/cpu/R7 5700X (TRAY) WITH HEATSINK FAN.png","/images/components/cpu/R7 5800X (TRAY) WITH HEATSINK FAN.png"],gpu:["/images/components/gpu/GALAX RTX 3060 1-CLICK OC BLK 12GB.png","/images/components/gpu/GIGABYTE RTX 4060 AERO OC 8GB WHITE.png","/images/components/gpu/GIGABYTE RX 6600 8GB EAGLE.png","/images/components/gpu/SAPPHIRE PULSE AMD RADEON RX 7800 XT 16GB.png"],ram:["/images/components/ram/KINGSTON FURY BEAST DDR4 8GB.png","/images/components/ram/TFORCE Delta RGB DDR4 16GB kit (2x8gb) BLACK.png","/images/components/ram/TFORCE Delta RGB DDR4 16GB kit (2x8gb) WHITE.png","/images/components/ram/TFORCE Delta RGB DDR4 32GB kit (2x16gb) BLACK.png"],motherboard:["/images/components/motherboard/ASRock B550M STEEL LEGEND.png","/images/components/motherboard/GIGABYTE B550M DS3H.png","/images/components/motherboard/MSI B550M PRO-VDH.png","/images/components/motherboard/GIGABYTE B660M DS3H.png"],storage:["/images/components/storage/Samsung 970 EVO Plus 500GB.png","/images/components/storage/WD Blue SN570 1TB.png","/images/components/storage/Crucial P3 1TB-2TB.png","/images/components/storage/Kingston NV2 500GB-1TB.png"],psu:["/images/components/psu/Corsair CX550F.png","/images/components/psu/EVGA 600 BR.png","/images/components/psu/Seasonic Focus GX-650.png","/images/components/psu/Thermaltake Smart 500W.png"],case:["/images/components/case/INPLAY WIND 01.png","/images/components/case/NZXT H5 FLOW.png","/images/components/case/COOLMAN HARLEY.png","/images/components/case/DARKFLASH DK351.png"],cooler:["/images/components/cooler/DEEPCOOL AK400.png","/images/components/cooler/DEEPCOOL AK500.png","/images/components/cooler/DEEPCOOL LIQUID COOLER AIO - ARGB LE520.png","/images/components/cooler/DEEPCOOL MYSTIQUE 240.png"],default:["/images/components/cpu/R3 3200G (TRAY) WITH HEATSINK FAN.png","/images/components/gpu/GALAX RTX 3060 1-CLICK OC BLK 12GB.png"]};function X8(e){const t=e.toLowerCase();return t.includes("ryzen")||t.includes("core i")||t.includes("intel")||t.includes("amd")||t.includes("cpu")||t.includes("r3")||t.includes("r5")||t.includes("r7")||t.includes("r9")||t.includes("athlon")||t.includes("i3")||t.includes("i5")||t.includes("i7")?"cpu":t.includes("rtx")||t.includes("gtx")||t.includes("rx")||t.includes("graphics")||t.includes("gpu")||t.includes("radeon")||t.includes("geforce")?"gpu":t.includes("ddr")||t.includes("memory")||t.includes("ram")||t.includes("fury")||t.includes("vengeance")||t.includes("trident")||t.includes("tforce")||t.includes("kingston")||t.includes("team")||t.includes("skihotar")||t.includes("neo forza")||t.includes("kingspec")?"ram":t.includes("motherboard")||t.includes("mobo")||t.includes("b550")||t.includes("b660")||t.includes("h510")||t.includes("x570")||t.includes("asrock")||t.includes("asus")||t.includes("msi")||t.includes("gigabyte")||t.includes("biostar")||t.includes("mma")||t.includes("whalekom")?"motherboard":t.includes("ssd")||t.includes("hdd")||t.includes("nvme")||t.includes("samsung")||t.includes("wd")||t.includes("seagate")||t.includes("crucial")||t.includes("kingston")?"storage":t.includes("psu")||t.includes("power")||t.includes("watt")||t.includes("corsair")||t.includes("evga")||t.includes("seasonic")||t.includes("cooler master")||t.includes("deepcool")||t.includes("fsp")||t.includes("thermaltake")?"psu":t.includes("case")||t.includes("chassis")||t.includes("nzxt")||t.includes("coolman")||t.includes("darkflash")||t.includes("gamdias")||t.includes("inplay")||t.includes("keytech")||t.includes("acer")||t.includes("mma")||t.includes("ygt")?"case":t.includes("cooler")||t.includes("fan")||t.includes("deepcool")||t.includes("jonsbo")||t.includes("jungle leopard")||t.includes("ovation")||t.includes("thermalright")||t.includes("ygt")||t.includes("aio")||t.includes("liquid")?"cooler":"default"}function ri(e,t=null){const r=typeof e=="string"?e:e.name;if(!r)return bt(Vl.default[0]);if($S[r])return bt($S[r]);const n=r.toLowerCase();if(n.includes("5600g"))return bt("/images/components/cpu/r5_5600G_tray.png");if(n.includes("ryzen"))return n.includes("5600x")?bt("/images/components/cpu/R5 5600X (TRAY) WITH HEATSINK FAN.png"):n.includes("5600g")?bt("/images/components/cpu/r5_5600G_tray.png"):n.includes("5700x")?bt("/images/components/cpu/R7 5700X (TRAY) WITH HEATSINK FAN.png"):n.includes("5800x")?bt("/images/components/cpu/R7 5800X (TRAY) WITH HEATSINK FAN.png"):n.includes("7600x")?bt("/images/components/cpu/R5 7600X (TRAY) WITH HEATSINK FAN.png"):bt(Vl.cpu[0]);if(n.includes("rtx"))return n.includes("3060")?bt("/images/components/gpu/GALAX RTX 3060 1-CLICK OC BLK 12GB.png"):n.includes("4060")?bt("/images/components/gpu/GIGABYTE RTX 4060 AERO OC 8GB WHITE.png"):n.includes("4070")?bt("/images/components/gpu/GIGABYTE RTX 4070 SUPER EAGLE OC 12GB.png"):bt(Vl.gpu[0]);if(n.includes("rx"))return n.includes("6600")?bt("/images/components/gpu/GIGABYTE RX 6600 8GB EAGLE.png"):n.includes("7800")?bt("/images/components/gpu/SAPPHIRE PULSE AMD RADEON RX 7800 XT 16GB.png"):bt(Vl.gpu[0]);if(n.includes("kingston")&&n.includes("fury"))return bt("/images/components/ram/KINGSTON FURY BEAST DDR4 8GB.png");if(n.includes("tforce")||n.includes("t-force"))return bt("/images/components/ram/TFORCE Delta RGB DDR4 16GB kit (2x8gb) BLACK.png");if(n.includes("team"))return bt("/images/components/ram/TEAM ELITE PLUS GOLD DDR4 8GB.png");if(n.includes("asrock"))return bt("/images/components/motherboard/ASRock B550M STEEL LEGEND.png");if(n.includes("msi"))return bt("/images/components/motherboard/MSI B550M PRO-VDH.png");if(n.includes("asus"))return bt("/images/components/motherboard/ASUS PRIME A520M K.png");if(n.includes("gigabyte"))return bt("/images/components/motherboard/GIGABYTE B550M DS3H.png");if(n.includes("samsung"))return bt("/images/components/storage/Samsung 970 EVO Plus 500GB.png");if(n.includes("wd")||n.includes("western digital"))return bt("/images/components/storage/WD Blue SN570 1TB.png");if(n.includes("crucial"))return bt("/images/components/storage/Crucial P3 1TB-2TB.png");if(n.includes("seagate"))return bt("/images/components/storage/Seagate Barracuda 1TB-2TB HDD.png");if(n.includes("corsair"))return bt("/images/components/psu/Corsair CX550F.png");if(n.includes("evga"))return bt("/images/components/psu/EVGA 600 BR.png");if(n.includes("seasonic"))return bt("/images/components/psu/Seasonic Focus GX-650.png");if(n.includes("thermaltake"))return bt("/images/components/psu/Thermaltake Smart 500W.png");if(n.includes("nzxt"))return bt("/images/components/case/NZXT H5 FLOW.png");if(n.includes("coolman"))return bt("/images/components/case/COOLMAN HARLEY.png");if(n.includes("darkflash"))return bt("/images/components/case/DARKFLASH DK351.png");if(n.includes("inplay"))return bt("/images/components/case/INPLAY WIND 01.png");if(n.includes("deepcool"))return bt("/images/components/cooler/DEEPCOOL AK400.png");if(n.includes("jonsbo"))return bt("/images/components/cooler/JONSBO CR 1200 EVO (AIR COOLERS).png");if(n.includes("thermalright"))return bt("/images/components/cooler/THERMALRIGHT LIQUID COOLER FROZEN WARFRAME 240 ARGB.png");const a=t||X8(r),i=Vl[a]||Vl.default,s=K8(r,i.length);return bt(i[s])}const q8=({setCurrentPage:e})=>{const[t,r]=N.useState(0),[n,a]=N.useState(!1),[i,s]=N.useState([]),[o,c]=N.useState(!0),u={1:"CPU",2:"Motherboard",3:"GPU",4:"RAM",5:"Storage",6:"PSU",7:"Case",8:"Cooler",9:"Aio",11:"Case Gaming"};N.useEffect(()=>{(async()=>{try{const S=await(await fetch(ha("get_all_components"))).json();if(S.success&&Array.isArray(S.data)){const k=[1,2,3,4,5,6,7,8,9,11],P=S.data.filter(X=>k.includes(Number(X.category_id))).map(X=>({...X,category:u[Number(X.category_id)]||X.category_id})).map(X=>({...X,priceValue:parseFloat((X.price||"").toString().replace(/[^0-9.]/g,""))||0})).sort((X,Y)=>Y.priceValue-X.priceValue),A=X=>{try{return(ri(X,(X.category||"").toLowerCase())||"").toLowerCase()}catch{return""}},T=new Set,R=new Set,D=[];for(const X of P){const Y=X.id?String(X.id):null,q=`${(X.brand||"").toString().toLowerCase().trim()}::${(X.name||"").toString().toLowerCase().trim()}`,ee=A(X),V=`${q}::${ee}`;Y&&T.has(Y)||R.has(V)||(Y&&T.add(Y),R.add(V),D.push(X))}const L=10,z=D.slice(0,L);s(z)}else s([])}catch{s([])}finally{c(!1)}})()},[]);const d=w=>{r(w)},f=()=>{r(w=>(w+1)%i.length)},h=()=>{r(w=>(w-1+i.length)%i.length)};if(N.useEffect(()=>{t>=i.length&&i.length>0&&r(0)},[i.length,t]),N.useEffect(()=>{i.length!==0&&t>=i.length&&r(Math.max(i.length-1,0))},[i.length,t]),N.useEffect(()=>{if(!i||i.length===0||n)return;const w=setInterval(()=>{r(b=>(b+1)%i.length)},5e3);return()=>clearInterval(w)},[i.length,n]),N.useEffect(()=>{if(!i||i.length===0)return;const w=import.meta&&{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}&&"/"||"/",b=w.endsWith("/")?w.slice(0,-1):w,S=new Set;i.forEach(_=>{const E=ri(_,(_.category||"").toLowerCase())||`${b}/images/placeholder-component.svg`;E&&S.add(E)}),[(t+1)%i.length,(t-1+i.length)%i.length].forEach(_=>{const E=i[_];if(!E)return;const P=ri(E,(E.category||"").toLowerCase())||`${b}/images/placeholder-component.svg`;P&&S.add(P)}),S.forEach(_=>{const E=new Image;E.decoding="async",E.loading="eager",E.src=_})},[i,t]),o)return l("section",{className:"relative h-screen flex items-center justify-center bg-gradient-to-br from-gray-800 to-gray-900",children:l("div",{className:"text-white text-xl font-semibold",children:"Loading components..."})});if(!i||i.length===0)return l("section",{className:"relative h-screen flex items-center justify-center bg-gradient-to-br from-gray-800 to-gray-900",children:m("div",{className:"text-white text-xl font-semibold text-center",children:["No PC components with working images found for the slideshow.",l("br",{}),"Please check your database or try again later."]})});const p=i[Math.min(t,i.length-1)],x=import.meta&&{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}&&"/"||"/",g=x.endsWith("/")?x.slice(0,-1):x,y=ri(p,((p==null?void 0:p.category)||"").toLowerCase()),v=y&&y.trim()!==""?y:`${g}/images/placeholder-component.svg`;return m("section",{className:"relative h-screen overflow-hidden bg-gray-900",onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),children:[m("div",{className:"pointer-events-none absolute inset-0 overflow-hidden",children:[l("div",{className:"absolute -top-24 -left-24 w-96 h-96 rounded-full blur-3xl opacity-30",style:{background:"radial-gradient(closest-side, rgba(16,185,129,0.6), rgba(16,185,129,0) 70%)"}}),l("div",{className:"absolute -bottom-24 -right-24 w-[28rem] h-[28rem] rounded-full blur-3xl opacity-25",style:{background:"radial-gradient(closest-side, rgba(59,130,246,0.5), rgba(59,130,246,0) 70%)"}}),l("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[36rem] h-[36rem] rounded-full blur-[80px] opacity-15",style:{background:"radial-gradient(closest-side, rgba(147,51,234,0.5), rgba(147,51,234,0) 70%)"}})]}),l("div",{className:"relative h-full",children:(()=>{const w=p,b=(w==null?void 0:w.gradient)||"from-green-custom-800 to-gray-900",S=b.includes("from-")?b.replace("from-","").replace("to-","").split(" ").map((T,R)=>`rgba(${{"blue-700":"59,130,50","gray-900":"17,24,39","purple-700":"124,58,237","green-700":"59,130,50","green-custom-800":"59,130,50","green-custom-900":"39,98,34","red-700":"185,28,28","indigo-700":"67,56,202"}[T]||"59,130,50"},${R===0?.72:.92})`):["rgba(59,130,50,0.72)","rgba(17,24,39,0.92)"],k=(w==null?void 0:w.description)||(w!=null&&w.brand?`${w.brand} ${w.name}`:w==null?void 0:w.name),_=Array.isArray(w==null?void 0:w.specs)&&w.specs.length>0?w.specs:[],E=(w==null?void 0:w.originalPrice)||"",P=typeof(w==null?void 0:w.priceValue)=="number"?w.priceValue:parseFloat(((w==null?void 0:w.price)||"").toString().replace(/[^0-9.]/g,""))||0,A=E&&parseFloat(E.toString().replace(/[^0-9.]/g,""))||0;if(typeof window<"u"){window.__loggedImages||(window.__loggedImages={});const T=(w==null?void 0:w.id)||`${(w==null?void 0:w.brand)||""}-${(w==null?void 0:w.name)||""}`;T&&!window.__loggedImages[T]&&(window.__loggedImages[T]=!0)}return l("div",{className:"absolute inset-0 opacity-100 z-10",style:{backgroundImage:`linear-gradient(135deg, ${S.join(", ")}), url('${v}')`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundColor:"#0b1120"},children:l("div",{className:"h-full text-white flex items-center justify-center p-4",children:l("div",{className:"max-w-7xl mx-auto px-4 lg:px-8 w-full",children:m("div",{className:"grid grid-cols-1 lg:grid-cols-12 items-center gap-8 lg:gap-16",children:[l("div",{className:"lg:col-span-6 flex items-center justify-center",children:m("div",{className:"relative anim-slide-in-left",children:[l("div",{className:"bg-black bg-opacity-35 rounded-2xl p-4 lg:p-8 backdrop-blur-md shadow-[0_20px_60px_rgba(0,0,0,0.45)] ring-1 ring-white/10 anim-glow-pulse",children:l("img",{src:v,alt:w==null?void 0:w.name,className:"w-auto h-64 md:h-72 lg:h-80 xl:h-96 object-contain drop-shadow-[0_12px_40px_rgba(0,0,0,0.5)] select-none anim-float-y",loading:"eager",decoding:"async",onError:T=>{const R=`${g}/images/placeholder-component.svg`;T.currentTarget.src!==R&&(T.currentTarget.src=R)}})}),l("div",{className:"pointer-events-none absolute -top-6 -left-6 w-24 h-24 rounded-full opacity-40 blur-2xl",style:{background:"radial-gradient(closest-side, rgba(255,255,255,0.35), rgba(255,255,255,0) 70%)"}})]})}),l("div",{className:"lg:col-span-6 text-center lg:text-left anim-slide-in-right",children:m("div",{className:"flex flex-col h-full justify-between",children:[m("div",{children:[l("span",{className:"inline-block bg-white bg-opacity-90 text-gray-900 text-sm font-semibold px-3 py-1 rounded-full mb-4 shadow-md",children:w==null?void 0:w.category}),l("h1",{className:"text-3xl lg:text-5xl font-extrabold mb-3 lg:mb-4 leading-tight drop-shadow-[0_2px_4px_rgba(0,0,0,0.45)]",children:w==null?void 0:w.name}),l("p",{className:"text-base lg:text-lg mb-6 text-gray-200 leading-relaxed max-w-xl",children:k}),l("div",{className:"mb-6",children:m("div",{className:"flex items-baseline justify-center lg:justify-start",children:[l("span",{className:"text-3xl font-bold text-white",children:gt(P||0,{minimumFractionDigits:0,maximumFractionDigits:0})}),A>P&&m(lt,{children:[l("span",{className:"ml-2 text-lg text-gray-300 line-through",children:gt(A,{minimumFractionDigits:0,maximumFractionDigits:0})}),m("span",{className:"ml-2 text-sm bg-red-600 text-white px-2 py-0.5 rounded",children:[Math.round((1-P/A)*100),"% OFF"]})]})]})}),l("div",{className:"grid grid-cols-2 gap-3 mb-6",children:_.length>0&&_.slice(0,4).map((T,R)=>m("div",{className:"bg-white bg-opacity-10 p-3 rounded-lg",children:[l("div",{className:"text-xs text-gray-300",children:T.label}),l("div",{className:"font-medium text-white",children:T.value})]},R))})]}),l("div",{className:"mt-auto",children:m("div",{className:"flex flex-col sm:flex-row gap-4",children:[m("button",{onClick:()=>e("pc-assembly"),className:"flex-1 flex items-center justify-center px-6 py-3 border-2 border-transparent text-base font-medium rounded-lg text-white bg-gradient-to-r from-green-custom-600 to-green-custom-700 hover:from-green-custom-700 hover:to-green-custom-800 transition-all duration-200 shadow-lg hover:shadow-xl hover:scale-[1.02] transform",children:["Add to Build",l(Hi,{className:"ml-2 h-5 w-5 group-hover:translate-x-1 transition-transform"})]}),m("button",{onClick:()=>e("pc-assembly"),className:"flex-1 flex items-center justify-center px-6 py-3 border-2 border-white text-base font-medium rounded-lg text-white hover:bg-white hover:bg-opacity-10 transition-all duration-200 hover:shadow-lg",children:["View All ",w==null?void 0:w.category,"s"]})]})})]})})]})})})},(w==null?void 0:w.id)||`${((w==null?void 0:w.brand)||"").toString()}-${((w==null?void 0:w.name)||"").toString()}-active`)})()}),l("button",{onClick:h,className:"absolute left-4 top-1/2 -translate-y-1/2 bg-black bg-opacity-40 hover:bg-opacity-60 text-white p-3 rounded-full z-50 transition-all duration-200 focus:outline-none pointer-events-auto","aria-label":"Previous component",children:l("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),l("button",{onClick:f,className:"absolute right-4 top-1/2 -translate-y-1/2 bg-black bg-opacity-40 hover:bg-opacity-60 text-white p-3 rounded-full z-50 transition-all duration-200 focus:outline-none pointer-events-auto","aria-label":"Next component",children:l("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),l("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 flex space-x-2 z-10",children:i.map((w,b)=>l("button",{onClick:()=>d(b),className:`w-3 h-3 rounded-full transition-all duration-200 ${b===t?"bg-white w-8":"bg-white bg-opacity-40 hover:bg-opacity-70"}`,"aria-label":`Go to slide ${b+1}`},b))}),l("div",{className:"absolute bottom-0 left-0 w-full h-1 bg-white bg-opacity-10",children:l("div",{className:"h-full bg-white transition-all duration-5000 ease-linear",style:{width:`${(t+1)/i.length*100}%`,transitionDuration:"5000ms"}})})]})},US=({setCurrentPage:e,setSelectedComponents:t})=>{const[r,n]=N.useState(null),[a,i]=N.useState(!1),[s,o]=N.useState(0),[c,u]=N.useState(""),[d,f]=N.useState(""),[h,p]=N.useState(!1),[x,g]=N.useState([]),[y,v]=N.useState(!0);N.useEffect(()=>{(async()=>{try{const X=await(await fetch(`${ve}/prebuilts.php`)).json();Array.isArray(X)?g(X):g([])}catch(z){console.error("Error fetching prebuilts:",z),g([])}finally{v(!1)}})()},[]);const w={cpu:["cpu","processor","procie","procie only","processor only"],motherboard:["motherboard","mobo"],gpu:["gpu","graphics","graphics card","video","video card","vga"],ram:["ram","memory","ddr","ddr4","ddr5"],storage:["storage","ssd","nvme","hdd","hard drive","drive"],psu:["psu","power supply","psu - tr","tr psu"],case:["case","chassis","case gaming"],cooler:["cooler","coolers","aio","cooling","cpu cooler","water cooling","liquid cooler","fan","heatsink"]};async function b(L){if(!L||typeof L!="object")return{};const z=Object.values(L).map(ee=>typeof ee=="string"?parseInt(ee,10):ee).filter(ee=>Number.isFinite(ee)&&ee>0);if(z.length===0)return{};const X=`${ve}/get_components_by_ids.php?ids=${z.join(",")}`,q=await(await fetch(X)).json();if(q.success&&q.data){const ee={};return q.data.forEach(V=>{const ae=Object.keys(L).find(oe=>L[oe]==V.id);ae&&(ee[ae]=V)}),ee}return{}}async function S(L){const X={cpu:"CPU",motherboard:"Motherboard",gpu:"GPU",ram:"RAM",storage:"Storage",psu:"PSU",case:"Case",cooler:"Cooler"}[L];if(!X)return null;try{const Y=`${ve}/index.php?endpoint=components&category=${encodeURIComponent(X)}`,ee=await(await fetch(Y)).json();if(!ee.success||!Array.isArray(ee.data)||ee.data.length===0)return null;const V=ee.data.slice();return V.sort((ae,oe)=>(Number(ae.price)||0)-(Number(oe.price)||0)),V[0]||null}catch{return null}}const k=async L=>{try{let z={};L.component_ids?typeof L.component_ids=="string"?z=JSON.parse(L.component_ids):z=L.component_ids:L.componentIds&&(z=L.componentIds);const X=await b(z),Y={},q=Object.keys(X).reduce((I,W)=>(I[W.toLowerCase()]=X[W],I),{});Object.entries(w).forEach(([I,W])=>{for(const U of W)if(q[U]){Y[I]=q[U];break}}),Object.keys(X).forEach(I=>{w[I]&&(Y[I]=X[I])});const ee=Object.keys(z||{}).map(I=>I.toLowerCase());if((w.cooler||[]).some(I=>ee.includes(I))&&!Y.cooler){const I=await S("cooler");I&&(Y.cooler=I)}const oe=["cpu","motherboard","gpu","ram","storage","psu","case"].filter(I=>!Y[I]);oe.length>0&&(await Promise.all(oe.map(W=>S(W)))).forEach((W,U)=>{W&&(Y[oe[U]]=W)});try{localStorage.setItem("builditpc-selected-components",JSON.stringify(Y)),localStorage.setItem("builditpc-editing-build",JSON.stringify({name:(L.name||"Prebuilt")+" (Prebuilt)",description:L.description||""}))}catch{}t&&t(Y),e("pc-assembly")}catch(z){console.error("Error loading prebuilt components:",z),alert("Error loading prebuilt components. Please try again.")}},_=[{icon:l(Ta,{className:"w-8 h-8"}),title:"Lightning Fast",description:"Build your dream PC in minutes with our intuitive interface"},{icon:l(na,{className:"w-8 h-8"}),title:"100% Compatible",description:"Advanced compatibility checking ensures all parts work together"},{icon:l(iu,{className:"w-8 h-8"}),title:"Expert Support",description:"Get help from our PC building experts anytime"},{icon:l(Um,{className:"w-8 h-8"}),title:"Best Prices",description:"Competitive prices on all components and prebuilt systems"}],E=[{id:"general",name:"General Feedback",color:"bg-blue-50 text-blue-700 border-blue-200"},{id:"bug",name:"Bug Report",color:"bg-red-50 text-red-700 border-red-200"},{id:"feature",name:"Feature Request",color:"bg-green-50 text-green-700 border-green-200"},{id:"compatibility",name:"Compatibility Issue",color:"bg-purple-50 text-purple-700 border-purple-200"},{id:"pricing",name:"Pricing Feedback",color:"bg-yellow-50 text-yellow-700 border-yellow-200"},{id:"ui",name:"User Interface",color:"bg-indigo-50 text-indigo-700 border-indigo-200"}],P=[{id:1,question:"How does SIMS's compatibility checker work?",answer:"Our advanced compatibility checker uses a sophisticated algorithm that analyzes multiple aspects of your selected components in real-time. It checks CPU socket compatibility with motherboards (ensuring AM5 CPUs work with AM5 motherboards, LGA1700 with LGA1700, etc.), validates RAM type matching (DDR4 vs DDR5), calculates power supply wattage requirements based on component TDP ratings, and verifies case form factor compatibility. The system also considers physical dimensions, cooling requirements, and expansion slot availability. When you select components, the checker immediately updates the compatibility score and provides specific feedback on any issues, helping you make informed decisions before purchasing."},{id:2,question:"Can I save my PC build for later?",answer:"Currently, SIMS operates as a real-time building and compatibility checking platform. While we don't have a persistent save feature yet, you can easily recreate your build by selecting the same components from our comprehensive database. We're actively developing build saving, sharing, and export features that will allow you to save multiple builds, share them with friends, export parts lists to retailers, and even receive notifications when component prices change. These features will be available in upcoming updates, making it easier to plan and compare different build configurations over time."},{id:3,question:"Are the component prices on SIMS accurate?",answer:"The prices shown on SIMS are carefully researched market prices in Philippine Peso () based on current retail data from major Philippine retailers and online marketplaces. However, actual prices may vary due to factors like regional availability, seasonal fluctuations, import duties, and retailer-specific promotions. We recommend using our prices as a baseline for budgeting and comparison, then checking with local retailers like PCHub, DynaQuest, EasyPC, or online platforms like Lazada and Shopee for the most current pricing. Our price estimates are updated regularly to reflect market trends and new product releases."},{id:4,question:"How often is the component database updated?",answer:"Our component database is continuously updated through multiple channels. We add new CPU and GPU releases within 24-48 hours of their official announcement, update motherboard specifications as manufacturers release new models, and refresh pricing data weekly. Our team monitors major tech announcements, manufacturer websites, and retailer catalogs to ensure comprehensive coverage. We also update component specifications, compatibility rules, and performance benchmarks based on the latest reviews and testing data. This ensures you always have access to the most current information when making your build decisions, including the latest Intel 14th gen, AMD Ryzen 7000 series, and NVIDIA RTX 4000 series components."},{id:5,question:"What if the compatibility checker shows issues with my build?",answer:"When compatibility issues are detected, our system provides detailed analysis and actionable solutions. For CPU-motherboard mismatches, we'll suggest compatible alternatives or explain the socket requirements. RAM compatibility issues include recommendations for the correct DDR4/DDR5 modules and supported speeds. Power supply warnings show your estimated power draw and suggest appropriate wattage ratings. Case compatibility issues detail form factor requirements and suggest suitable alternatives. The system also provides performance impact assessments, helping you understand how different component choices affect your build's capabilities. You can use our 'Find Compatible' feature to automatically suggest alternatives that resolve the conflicts while maintaining your performance goals."},{id:6,question:"Can I use SIMS on mobile devices?",answer:"SIMS is fully responsive and optimized for all devices, including smartphones and tablets. The interface automatically adapts to your screen size, with touch-friendly buttons, swipe gestures for component browsing, and optimized layouts for smaller screens. While the desktop experience offers the most comprehensive view with side-by-side component comparison and detailed specifications, the mobile version provides full functionality for building and checking compatibility. You can browse components, check compatibility, view prebuilt recommendations, and access the FAQ section seamlessly on any device. The mobile interface prioritizes essential features while maintaining the same accuracy and reliability as the desktop version."},{id:7,question:"How accurate are the prebuilt PC recommendations?",answer:"Our prebuilt PC recommendations are meticulously curated by a team of PC building experts who analyze market trends, performance benchmarks, and user requirements. Each system is tested for compatibility, performance, and value-for-money across different use cases. Gaming builds are optimized for frame rates and graphics performance, streaming builds balance CPU and GPU requirements for content creation, and workstation builds prioritize multi-core performance and reliability. We regularly update these recommendations based on new component releases, price changes, and performance improvements. Each prebuilt includes detailed specifications, estimated performance metrics, and upgrade paths, helping you understand exactly what you're getting and how it can be improved over time."},{id:8,question:"Does SIMS provide assembly instructions?",answer:"While SIMS primarily focuses on component selection and compatibility checking, we provide comprehensive guidance throughout the PC building process. Our platform includes general assembly tips, component installation order recommendations, and common troubleshooting advice. For detailed step-by-step assembly instructions, we recommend consulting the manufacturer manuals that come with each component, as they contain specific installation procedures and safety guidelines. We also provide links to trusted assembly guides and video tutorials from reputable sources. For users who prefer professional assembly, we can recommend local PC building services and provide guidance on what to look for when choosing an assembler. Our goal is to make the entire PC building journey as smooth as possible, from planning to completion."},{id:9,question:"Can I compare different component options side by side?",answer:"Yes! SIMS offers comprehensive component comparison features. You can preview individual components to see detailed specifications, performance benchmarks, and user reviews. The compatibility checker helps you understand how different component combinations work together, showing the impact of each choice on your overall build performance and compatibility. You can compare multiple CPUs, GPUs, or other components side-by-side to see differences in specifications, power consumption, and performance metrics. The system also provides performance estimates for different combinations, helping you make informed decisions based on your specific needs and budget. Whether you're choosing between AMD and Intel processors, different GPU tiers, or various storage options, our comparison tools help you understand the trade-offs and make the best choice for your build."},{id:10,question:"Is SIMS free to use?",answer:"Yes, SIMS is completely free to use! All our core features are available at no cost, including the advanced compatibility checker, comprehensive component database, prebuilt PC recommendations, and all platform tools. We believe that PC building should be accessible to everyone, regardless of budget constraints. Our business model is supported through partnerships with retailers and manufacturers, allowing us to provide accurate pricing and product information while keeping the platform free for users. We're committed to maintaining this free access while continuously improving our features and expanding our component database. There are no hidden fees, premium tiers, or paid features - everything you need to build your perfect PC is available completely free of charge."}],A=L=>{n(r===L?null:L)},T=async L=>{L.preventDefault();try{const X=await(await fetch(`${ve}/submit_feedback.php`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rating:s,category:c,message:d})})).json().catch(()=>({}));X&&X.success?(p(!0),setTimeout(()=>{p(!1),o(0),u(""),f(""),i(!1)},2e3)):alert("Failed to submit feedback. Please try again later.")}catch(z){console.error("Feedback submit error:",z),alert("Failed to submit feedback. Please try again later.")}},R=()=>{o(0),u(""),f(""),p(!1)},D=L=>{switch(L){case"gaming":return l(Ta,{className:"w-5 h-5"});case"workstation":return l(Um,{className:"w-5 h-5"});case"cooling":return l(na,{className:"w-5 h-5"});default:return l(ua,{className:"w-5 h-5"})}};return m("div",{className:"min-h-screen bg-gray-50",children:[l(q8,{setCurrentPage:e}),l("section",{className:"py-12 lg:py-20 bg-white px-4 lg:px-8",children:m("div",{className:"max-w-7xl mx-auto",children:[m("div",{className:"text-center mb-12 lg:mb-16",children:[l("h2",{className:"text-3xl lg:text-4xl font-bold text-gray-900 mb-4",children:"Why Choose SIMS?"}),l("p",{className:"text-lg lg:text-xl text-gray-600 max-w-3xl mx-auto",children:"We make PC building simple, reliable, and enjoyable. Our platform ensures you get the perfect build every time."})]}),l("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 lg:gap-8",children:_.map((L,z)=>m("div",{className:"text-center p-4 lg:p-6 rounded-lg hover:bg-gray-50 transition-colors",children:[l("div",{className:"w-12 h-12 lg:w-16 lg:h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4 text-green-600",children:L.icon}),l("h3",{className:"text-lg lg:text-xl font-semibold text-gray-900 mb-2",children:L.title}),l("p",{className:"text-gray-600 text-sm lg:text-base",children:L.description})]},z))})]})}),l("section",{className:"py-12 lg:py-20 bg-gray-50 px-4 lg:px-8",children:m("div",{className:"max-w-7xl mx-auto",children:[m("div",{className:"text-center mb-12 lg:mb-16",children:[l("h2",{className:"text-3xl lg:text-4xl font-bold text-gray-900 mb-4",children:"Prebuilt PC Recommendations"}),l("p",{className:"text-lg lg:text-xl text-gray-600 max-w-3xl mx-auto",children:"Not sure where to start? Check out our expertly curated prebuilt configurations for different use cases and budgets."})]}),l("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:y?l("div",{className:"text-center py-12",children:l("p",{children:"Loading prebuilt PC recommendations..."})}):x.length===0?l("div",{className:"text-center py-12",children:l("p",{children:"No prebuilt PC recommendations found. Please check back later or try a different search."})}):x.map(L=>l("div",{onClick:()=>k(L),className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-lg transition-all duration-300 cursor-pointer transform hover:scale-105 hover:border-green-300",children:m("div",{className:"p-6",children:[m("div",{className:"mb-4",children:[l("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:L.name}),m("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[D(L.category),l("span",{className:"capitalize",children:L.category})]})]}),l("div",{className:"mb-4",children:l("div",{className:"flex items-center gap-2",children:l("span",{className:"text-3xl font-bold text-green-600",children:gt(L.price,{minimumFractionDigits:0,maximumFractionDigits:0})})})}),L.description&&l("div",{className:"mb-4",children:l("p",{className:"text-sm text-gray-600",children:L.description})}),(()=>{let z=null;if(L.performance)if(typeof L.performance=="string")try{z=JSON.parse(L.performance)}catch{z=null}else z=L.performance;return z?m("div",{className:"mb-4 space-y-2",children:[z.gaming&&m(lt,{children:[m("div",{className:"flex items-center justify-between text-sm",children:[l("span",{className:"text-gray-600",children:"Gaming"}),m("span",{className:"font-medium",children:[z.gaming,"%"]})]}),l("div",{className:"w-full bg-gray-200 rounded-full h-2",children:l("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-500",style:{width:`${z.gaming}%`}})})]}),z.streaming&&m(lt,{children:[m("div",{className:"flex items-center justify-between text-sm",children:[l("span",{className:"text-gray-600",children:"Streaming"}),m("span",{className:"font-medium",children:[z.streaming,"%"]})]}),l("div",{className:"w-full bg-gray-200 rounded-full h-2",children:l("div",{className:"bg-purple-600 h-2 rounded-full transition-all duration-500",style:{width:`${z.streaming}%`}})})]})]}):null})(),(()=>{let z=null;if(L.features)if(typeof L.features=="string")try{z=JSON.parse(L.features)}catch{z=null}else z=L.features;return z&&z.length>0?l("div",{className:"mb-6",children:l("div",{className:"flex flex-wrap gap-1",children:z.slice(0,3).map((X,Y)=>l("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs",children:X},Y))})}):null})(),l("div",{className:"mb-4 text-center",children:l("p",{className:"text-sm text-gray-500 italic",children:"Click to view in PC Assembly"})}),m("button",{onClick:z=>{z.stopPropagation(),k(L)},className:"w-full bg-green-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center justify-center gap-2",children:[l(Hi,{className:"w-4 h-4"}),"View Details"]})]})},L.id))})]})}),l("section",{className:"py-12 lg:py-20 bg-white px-4 lg:px-8",children:l("div",{className:"max-w-7xl mx-auto",children:m("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-16 items-center",children:[m("div",{children:[l("h2",{className:"text-3xl lg:text-4xl font-bold text-gray-900 mb-4 lg:mb-6",children:"Advanced Compatibility Checking"}),l("p",{className:"text-lg lg:text-xl text-gray-600 mb-6 lg:mb-8",children:"Our intelligent system checks compatibility between all components in real-time, ensuring your build will work perfectly together."}),m("div",{className:"space-y-3 lg:space-y-4",children:[m("div",{className:"flex items-center gap-3",children:[l(yt,{className:"w-5 h-5 lg:w-6 lg:h-6 text-green-600"}),l("span",{className:"text-base lg:text-lg text-gray-700",children:"CPU and motherboard socket compatibility"})]}),m("div",{className:"flex items-center gap-3",children:[l(yt,{className:"w-5 h-5 lg:w-6 lg:h-6 text-green-600"}),l("span",{className:"text-base lg:text-lg text-gray-700",children:"RAM type and speed validation"})]}),m("div",{className:"flex items-center gap-3",children:[l(yt,{className:"w-5 h-5 lg:w-6 lg:h-6 text-green-600"}),l("span",{className:"text-base lg:text-lg text-gray-700",children:"Power supply wattage requirements"})]}),m("div",{className:"flex items-center gap-3",children:[l(yt,{className:"w-5 h-5 lg:w-6 lg:h-6 text-green-600"}),l("span",{className:"text-base lg:text-lg text-gray-700",children:"Case and motherboard form factor matching"})]})]})]}),l("div",{className:"bg-gray-100 rounded-lg p-6 lg:p-8",children:m("div",{className:"space-y-4",children:[l("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:m("div",{className:"flex items-center justify-between",children:[l("span",{className:"font-medium",children:"Compatibility Score"}),l("span",{className:"text-green-600 font-bold",children:"100%"})]})}),l("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:m("div",{className:"flex items-center justify-between",children:[l("span",{className:"font-medium",children:"Total Price"}),l("span",{className:"text-green-600 font-bold",children:"45,999"})]})}),l("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:m("div",{className:"flex items-center justify-between",children:[l("span",{className:"font-medium",children:"Build Status"}),l("span",{className:"text-green-600 font-bold",children:"Ready"})]})})]})})]})})}),l("section",{className:"py-12 lg:py-20 bg-gray-50 px-4 lg:px-8",children:m("div",{className:"max-w-4xl mx-auto",children:[m("div",{className:"text-center mb-12 lg:mb-16",children:[m("div",{className:"flex items-center justify-center gap-3 mb-4",children:[l(Wv,{className:"w-8 h-8 text-green-600"}),l("h2",{className:"text-3xl lg:text-4xl font-bold text-gray-900",children:"Frequently Asked Questions"})]}),l("p",{className:"text-lg lg:text-xl text-gray-600 max-w-3xl mx-auto",children:"Got questions about SIMS? We've got answers. Find everything you need to know about our platform and PC building."})]}),l("div",{className:"space-y-4",children:P.map(L=>m("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[m("button",{onClick:()=>A(L.id),className:"w-full px-6 py-4 text-left flex items-center justify-between hover:bg-gray-50 transition-colors",children:[l("span",{className:"text-lg font-medium text-gray-900",children:L.question}),r===L.id?l(DT,{className:"w-5 h-5 text-gray-500"}):l(cp,{className:"w-5 h-5 text-gray-500"})]}),r===L.id&&l("div",{className:"px-6 pb-4",children:l("p",{className:"text-gray-600 leading-relaxed",children:L.answer})})]},L.id))})]})}),l("section",{className:"py-12 lg:py-20 bg-white px-4 lg:px-8",children:m("div",{className:"max-w-4xl mx-auto text-center",children:[m("div",{className:"mb-8",children:[l("h2",{className:"text-3xl lg:text-4xl font-bold text-gray-900 mb-4",children:"Help Us Improve"}),l("p",{className:"text-lg lg:text-xl text-gray-600 max-w-2xl mx-auto",children:"Your feedback helps us make SIMS better for everyone. Share your thoughts, report issues, or suggest new features."})]}),m("button",{onClick:()=>i(!0),className:"bg-green-600 text-white px-8 py-4 rounded-lg font-semibold text-lg hover:bg-green-700 transition-colors flex items-center gap-3 mx-auto",children:[l(Ca,{className:"w-6 h-6"}),"Give Feedback"]})]})}),l("section",{className:"py-12 lg:py-20 bg-green-600 text-white px-4 lg:px-8",children:m("div",{className:"max-w-7xl mx-auto text-center",children:[l("h2",{className:"text-3xl lg:text-4xl font-bold mb-4 lg:mb-6",children:"Ready to Build Your Dream PC?"}),l("p",{className:"text-lg lg:text-xl mb-6 lg:mb-8 max-w-2xl mx-auto",children:"Join thousands of users who have successfully built their perfect PC using our platform. Start your build today!"}),m("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[m("button",{onClick:()=>e("pc-assembly"),className:"bg-white text-green-600 px-6 lg:px-8 py-3 lg:py-4 rounded-lg font-semibold text-base lg:text-lg hover:bg-gray-100 transition-colors flex items-center gap-3",children:["Get Started Now",l(Hi,{className:"w-5 h-5"})]}),m("button",{onClick:()=>e("prebuilt-pcs"),className:"bg-transparent border border-white text-white px-6 lg:px-8 py-3 lg:py-4 rounded-lg font-semibold text-base lg:text-lg hover:bg-white hover:text-green-600 transition-colors flex items-center gap-3",children:["View Prebuilts",l(Hi,{className:"w-5 h-5"})]})]})]})}),l("button",{onClick:()=>e("chat-support"),"aria-label":"Open chat support",className:"fixed bottom-6 right-6 bg-green-600 text-white rounded-full shadow-lg hover:bg-green-700 transition-colors p-4 z-40 flex items-center justify-center",children:l(Ca,{className:"w-6 h-6"})}),a&&l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:m("div",{className:"p-6 lg:p-8",children:[m("div",{className:"flex items-center justify-between mb-6",children:[l("h3",{className:"text-2xl lg:text-3xl font-bold text-gray-900",children:"Share Your Feedback"}),l("button",{onClick:()=>{i(!1),R()},className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:l(Gn,{className:"w-6 h-6 text-gray-500"})})]}),h?m("div",{className:"text-center p-6 bg-green-50 rounded-lg border border-green-200",children:[m("div",{className:"flex items-center justify-center gap-3 mb-2",children:[l(yt,{className:"w-6 h-6 text-green-600"}),l("h4",{className:"text-lg font-semibold text-green-800",children:"Thank You!"})]}),l("p",{className:"text-green-700",children:"Your feedback has been submitted successfully. We appreciate your input and will use it to improve SIMS!"})]}):m("form",{onSubmit:T,className:"space-y-6",children:[m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"How would you rate your experience with SIMS?"}),l("div",{className:"flex justify-center gap-2",children:[1,2,3,4,5].map(L=>l("button",{type:"button",onClick:()=>o(L),className:`p-2 rounded-lg transition-colors ${s>=L?"text-yellow-400 bg-yellow-50":"text-gray-300 hover:text-yellow-400"}`,children:l(ob,{className:`w-8 h-8 ${s>=L?"fill-current":""}`})},L))})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"What type of feedback is this?"}),l("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-3",children:E.map(L=>l("button",{type:"button",onClick:()=>u(L.id),className:`p-3 rounded-lg border-2 transition-colors flex items-center gap-2 text-sm ${c===L.id?`border-current ${L.color}`:"border-gray-200 hover:border-gray-300 text-gray-700"}`,children:L.name},L.id))})]}),m("div",{children:[l("label",{htmlFor:"feedback-message",className:"block text-sm font-medium text-gray-700 mb-3",children:"Tell us more about your experience"}),l("textarea",{id:"feedback-message",value:d,onChange:L=>f(L.target.value),placeholder:"Share your thoughts, suggestions, or report any issues you encountered...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none",rows:"4",required:!0})]}),m("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[m("button",{type:"submit",disabled:!s||!c||!d.trim(),className:"bg-green-600 text-white px-6 lg:px-8 py-3 lg:py-4 rounded-lg font-semibold hover:bg-green-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center gap-3 justify-center",children:[l(Il,{className:"w-5 h-5"}),"Submit Feedback"]}),l("button",{type:"button",onClick:()=>{i(!1),R()},className:"border-2 border-gray-300 text-gray-700 px-6 lg:px-8 py-3 lg:py-4 rounded-lg font-semibold hover:bg-gray-50 transition-colors",children:"Cancel"})]})]})]})})}),m("footer",{className:"bg-gray-900 text-white",children:[l("div",{className:"max-w-7xl mx-auto px-4 lg:px-8 py-12 lg:py-16",children:m("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 lg:gap-12",children:[l("div",{className:"lg:col-span-1",children:m("div",{className:"mb-6",children:[l("h3",{className:"text-2xl lg:text-3xl font-bold text-green-400 mb-2",children:"SIMS"}),l("p",{className:"text-gray-300 text-sm lg:text-base leading-relaxed",children:"The ultimate platform for building your perfect PC. Check compatibility, compare prices, and create your dream build with confidence."})]})}),m("div",{children:[l("h4",{className:"text-lg font-semibold mb-4",children:"Quick Links"}),m("ul",{className:"space-y-2",children:[l("li",{children:l("button",{onClick:()=>e("pc-assembly"),className:"text-gray-300 hover:text-white transition-colors",children:"PC Assembly"})}),l("li",{children:l("button",{onClick:()=>e("prebuilt-pcs"),className:"text-gray-300 hover:text-white transition-colors",children:"Prebuilt PCs"})}),l("li",{children:l("button",{onClick:()=>e("about"),className:"text-gray-300 hover:text-white transition-colors",children:"About Us"})}),l("li",{children:l("button",{onClick:()=>e("contact"),className:"text-gray-300 hover:text-white transition-colors",children:"Contact"})})]})]}),m("div",{children:[l("h4",{className:"text-lg font-semibold mb-4",children:"Support"}),m("ul",{className:"space-y-2",children:[l("li",{children:l("button",{onClick:()=>e("faq"),className:"text-gray-300 hover:text-white transition-colors",children:"FAQ"})}),l("li",{children:l("button",{onClick:()=>e("compatibility-guide"),className:"text-gray-300 hover:text-white transition-colors",children:"Compatibility Guide"})}),l("li",{children:l("button",{onClick:()=>e("troubleshooting"),className:"text-gray-300 hover:text-white transition-colors",children:"Troubleshooting"})})]})]}),m("div",{children:[l("h4",{className:"text-lg font-semibold mb-4",children:"Contact Info"}),m("div",{className:"space-y-2 text-gray-300",children:[l("p",{children:"Email: support@builditpc.com"}),l("p",{children:"Phone: +63 912 345 6789"}),l("p",{children:"Address: Ground flr JSP Bldg. 9109 National rd. Cay Pombo, Santa Maria, Philippines"})]})]})]})}),l("div",{className:"border-t border-gray-800",children:l("div",{className:"max-w-7xl mx-auto px-4 lg:px-8 py-6",children:m("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[l("p",{className:"text-gray-400 text-sm",children:" 2025 SIMS. All rights reserved."}),l("div",{className:"mt-4 md:mt-0"})]})})})]})]})},hd={cpu_sockets:{"AMD AM4":["AMD AM4"],"AMD AM5":["AMD AM5"],"AMD sTRX4":["AMD sTRX4"],"AMD TR4":["AMD TR4"],"AMD sWRX8":["AMD sWRX8"],"Intel LGA1200":["Intel LGA1200"],"Intel LGA1700":["Intel LGA1700"],"Intel LGA1851":["Intel LGA1851"],"Intel LGA1151":["Intel LGA1151"],"Intel LGA2066":["Intel LGA2066"],"Intel LGA2011-3":["Intel LGA2011-3"],"Intel LGA3647":["Intel LGA3647"],"Intel LGA4189":["Intel LGA4189"]},ram_types:{DDR4:["DDR4"],DDR5:["DDR5"],DDR3:["DDR3"]},ram_speeds:{DDR4:{min:2133,max:4800,recommended:[2400,2666,3e3,3200,3600,4e3]},DDR5:{min:4800,max:6400,recommended:[4800,5200,5600,6e3,6400]}},cpu_ram_compatibility:{"Intel LGA1200":["DDR4"],"Intel LGA1700":["DDR4","DDR5"],"Intel LGA1851":["DDR5"],"Intel LGA1151":["DDR4"],"AMD AM4":["DDR4"],"AMD AM5":["DDR5"]},form_factors:{ATX:["ATX","Micro-ATX","Mini-ITX"],"Micro-ATX":["Micro-ATX","Mini-ITX"],"Mini-ITX":["Mini-ITX"],"E-ATX":["E-ATX","ATX","Micro-ATX","Mini-ITX"]},power_requirements:{cpu:{low:65,mid:95,high:125,extreme:165},gpu:{low:75,mid:150,high:250,extreme:350}},gpu_length_support:{small:300,medium:350,large:400,extreme:450},cooler_height_support:{small:160,medium:180,large:200,extreme:220}},Ze=(e,t)=>{var n,a;if(!e)return null;const r=e.specs||{};switch(t){case"socket":return e.socket||r.socket||Y8(e.name);case"brand":return e.brand||r.brand||J8(e.name);case"ram_type":return e.ram_type||r.ram_type||e.type||r.type;case"form_factor":return e.form_factor||r.form_factor;case"wattage":return e.wattage||r.wattage||Q8(e.name);case"tdp":return e.tdp||r.tdp||Z8(e.name);case"length":return e.length||r.length||((n=e.dimensions)==null?void 0:n.length);case"height":return e.height||r.height||((a=e.dimensions)==null?void 0:a.height);case"capacity":return e.capacity||r.capacity;case"speed":return e.speed||r.speed;default:return e[t]||r[t]}},Y8=e=>{if(!e)return null;const t=e.toLowerCase(),r=t.replace(/[\s\-_]/g,"");if(r.includes("am4")||r.includes("amd4"))return"AMD AM4";if(r.includes("am5")||r.includes("amd5"))return"AMD AM5";if(r.includes("lga1200"))return"Intel LGA1200";if(r.includes("lga1700"))return"Intel LGA1700";if(r.includes("lga1151"))return"Intel LGA1151";if(r.includes("lga2066"))return"Intel LGA2066";const n=t.match(/\br[3579]\s*-?\s*(\d{4})([a-z0-9]*)?/i);if(n&&n[1]){const a=parseInt(n[1],10);if(!isNaN(a)){if(a>=7e3)return"AMD AM5";if(a>=1e3)return"AMD AM4"}}return t.includes("i7-11700")||t.includes("i7-11700k")||t.includes("i7-11700f")||t.includes("i5-11600")||t.includes("i5-11500")||t.includes("i5-11400")||t.includes("i3-11100")||t.includes("i3-10100")||t.includes("i9-11900")||t.includes("i9-10900")||t.includes("i5-10400")||t.includes("i5-10600")||t.includes("i3-10100")||t.includes("i3-10300")?"Intel LGA1200":t.includes("i7-12700")||t.includes("i7-13700")||t.includes("i5-12600")||t.includes("i5-13600")||t.includes("i3-12100")||t.includes("i3-13100")||t.includes("i9-12900")||t.includes("i9-13900")?"Intel LGA1700":t.includes("i7-14700")||t.includes("i5-14600")||t.includes("i3-14100")||t.includes("i9-14900")?"Intel LGA1851":t.includes("i7-8700")||t.includes("i7-9700")||t.includes("i5-8400")||t.includes("i5-9400")||t.includes("i3-8100")||t.includes("i3-9100")?"Intel LGA1151":t.includes("ryzen 3 3200g")||t.includes("ryzen 5 5600g")||t.includes("ryzen 5 5600gt")||t.includes("ryzen 7 5800")||t.includes("ryzen 9 5900")?"AMD AM4":t.includes("ryzen 7 7700")||t.includes("ryzen 9 7900")||t.includes("ryzen 5 7600")||t.includes("ryzen 7 7800")||t.includes("ryzen 9 7950")?"AMD AM5":t.includes("ryzen 5 5600")||t.includes("ryzen 7 5700")||t.includes("ryzen 9 5950")||t.includes("athlon 200ge")||t.includes("athlon 300ge")||t.includes("athlon 3000g")||t.includes("a8 7680")?"AMD AM4":null},J8=e=>{if(!e)return null;const t=e.toLowerCase();return t.includes("amd")||t.includes("ryzen")?"AMD":t.includes("intel")||t.includes("core")?"Intel":t.includes("nvidia")||t.includes("rtx")||t.includes("gtx")?"NVIDIA":t.includes("radeon")||t.includes("rx")?"AMD":null},Q8=e=>{if(!e)return null;const t=e.match(/(\d+)\s*w/i);return t?parseInt(t[1]):null},Z8=e=>{if(!e)return null;const t=e.match(/(\d+)\s*w\s*tdp/i);return t?parseInt(t[1]):null},Kv=e=>{if(!e)return null;let t=e.toString().trim().toUpperCase();return t=t.replace(/^SOCKET\s+/,""),t=t.replace(/[\s\-_]/g,""),t=t.replace(/^AMD4$/,"AM4").replace(/^AMD5$/,"AM5").replace(/^AMD/,"AM"),t.includes("AM4")?"AMD AM4":t.includes("AM5")?"AMD AM5":t.includes("LGA1200")?"Intel LGA1200":t.includes("LGA1700")?"Intel LGA1700":t.includes("LGA1851")?"Intel LGA1851":t.includes("LGA1151")?"Intel LGA1151":t.includes("LGA2066")?"Intel LGA2066":t.includes("LGA2011")?"Intel LGA2011-3":t.includes("LGA3647")?"Intel LGA3647":t.includes("LGA4189")?"Intel LGA4189":t},zS=e=>{if(!e)return null;let t=e.toString().trim().toLowerCase();return t=t.replace(/_/g,"-"),t=t.replace(/\s+/g,"-"),t==="atx"?"ATX":t==="e-atx"||t==="eatx"?"E-ATX":t==="micro-atx"||t==="matx"||t==="u-atx"||t==="uatx"||t==="m-atx"||t==="microatx"?"Micro-ATX":t==="mini-itx"||t==="mitx"||t==="miniitx"?"Mini-ITX":t.includes("micro")&&t.includes("atx")?"Micro-ATX":t.includes("mini")&&t.includes("itx")?"Mini-ITX":t.includes("atx")?"ATX":e},Kl=(e,t,r)=>{switch(r){case"cpu_motherboard":return lb(e,t);case"ram_motherboard":return cb(e,t);case"case_motherboard":return ub(e,t);case"psu_power":return zm(e,t);case"gpu_case":return Hm(e,t);case"cooler_case":return db(e,t);default:return{compatible:!0,reason:"No specific compatibility check defined"}}},lb=(e,t)=>{const r=Ze(e,"socket"),n=Ze(t,"socket");if(r&&n){const s=Kv(r),o=Kv(n);if(s&&o){const u=s===o;return{compatible:u,reason:u?"Socket compatible":`Socket mismatch: ${s} vs ${o}`,details:{cpuSocket:s,moboSocket:o}}}const c=r.toString().trim().toLowerCase()===n.toString().trim().toLowerCase();return{compatible:c,reason:c?"Socket compatible":`Socket mismatch: ${r} vs ${n}`,details:{cpuSocket:r,moboSocket:n}}}const a=Ze(e,"brand"),i=Ze(t,"brand");if(a&&i){const s=a==="AMD"&&i==="AMD"||a==="Intel"&&i==="Intel";return{compatible:s,reason:s?`Brand compatible: ${a} CPU with ${i} motherboard`:`Brand mismatch: ${a} CPU with ${i} motherboard`,details:{cpuBrand:a,moboBrand:i,cpuSocket:r,moboSocket:n}}}return{compatible:!0,reason:"Compatibility cannot be determined - assuming compatible",details:{cpuSocket:r,moboSocket:n,cpuBrand:a,moboBrand:i}}},cb=(e,t)=>{const r=Ze(e,"ram_type"),n=Ze(t,"ram_type"),a=Ze(e,"speed"),i=Ze(t,"max_ram_speed"),s=Ze(e,"capacity"),o=Ze(t,"max_ram_capacity"),c=Ze(e,"modules")||1,u=Ze(t,"ram_slots"),d=[],f={ramType:r,moboRamType:n,ramSpeed:a,moboMaxSpeed:i,ramCapacity:s,moboMaxCapacity:o,ramSticks:c,moboRamSlots:u};if(r&&n&&r!==n&&d.push(`RAM type mismatch: ${r} vs ${n}`),a&&i){const h=parseInt(a),p=parseInt(i);h>p?d.push(`RAM speed (${a}MHz) exceeds motherboard maximum (${i}MHz)`):h<2133&&d.push(`RAM speed (${a}MHz) is below minimum supported (2133MHz)`)}if(s&&o){const h=Math.floor(parseInt(o)/(u||4));parseInt(s)>h&&d.push(`RAM module size (${s}GB) exceeds maximum supported (${h}GB per module)`)}if(c&&u&&c>u&&d.push(`Number of RAM modules (${c}) exceeds motherboard slots (${u})`),s&&c&&o){const h=parseInt(s)*c;h>parseInt(o)&&d.push(`Total RAM (${h}GB) exceeds motherboard maximum (${o}GB)`)}return c===1&&u>=2&&d.push("Warning: Single RAM stick detected - consider dual-channel setup for better performance"),c>1&&c%2!==0&&d.push("Warning: Odd number of RAM sticks may not enable dual-channel mode"),d.length>0?{compatible:d.filter(p=>!p.startsWith("Warning:")).length===0,reason:d.join("; "),details:f,warnings:d.filter(p=>p.startsWith("Warning:")).length}:{compatible:!0,reason:"RAM is compatible with motherboard",details:f}},ub=(e,t)=>{const r=Ze(e,"form_factor"),n=Ze(t,"form_factor");if(r&&n){const s=zS(r),o=zS(n);if(s&&o&&hd.form_factors[s]){const c=hd.form_factors[s].includes(o);return{compatible:c,reason:c?"Form factor compatible":`Form factor mismatch: ${o} motherboard cannot fit in ${s} case`,details:{caseFormFactor:s,moboFormFactor:o}}}return{compatible:!0,reason:"Form factor unknown or unrecognized - assuming compatible",details:{caseFormFactor:s||r,moboFormFactor:o||n}}}const a=Ze(e,"brand"),i=Ze(t,"brand");return a&&i?{compatible:!0,reason:`Case brand compatible: ${a} case with ${i} motherboard`,details:{caseBrand:a,moboBrand:i,caseFormFactor:r,moboFormFactor:n}}:{compatible:!0,reason:"Case compatibility cannot be determined - assuming compatible",details:{caseFormFactor:r,moboFormFactor:n,caseBrand:a,moboBrand:i}}},zm=(e,t)=>{const r=Ze(e,"wattage"),n=Ze(e,"efficiency")||"80+ Gold";if(!r)return{compatible:!0,reason:"PSU wattage unknown - assuming compatible (verify PSU specs)"};const a={};let i=0;if(t.cpu){const f=Ze(t.cpu,"tdp")||95,h=Ze(t.cpu,"unlocked_multiplier")===!0,p=Math.ceil(f*(h?1.4:1.2));a.cpu=p,i+=p}if(t.gpu){const f=Ze(t.gpu,"tdp")||150,h=f>200,p=Math.ceil(f*(h?1.5:1.3));a.gpu=p,i+=p}if(t.motherboard){const f=Ze(t.motherboard,"chipset")||"",p=["X570","Z690","X670","Z790"].some(x=>f.includes(x))?80:50;a.motherboard=p,i+=p}if(t.ram){const f=Ze(t.ram,"modules")||1,h=Ze(t.ram,"speed")||3200,p=Ze(t.ram,"voltage")||1.35,x=Math.ceil(f*(h/2133)*1.5*p);a.ram=x,i+=x}if(t.storage){const h=(Ze(t.storage,"type")||"SSD").toLowerCase()==="hdd"?10:5;a.storage=h,i+=h}if(t.cooler){const h=(Ze(t.cooler,"type")||"air").toLowerCase()==="aio"?15:5;a.cooling=h,i+=h}const o=(Ze(t.case,"fans")||2)*2;a.fans=o,i+=o,a.peripherals=20,i+=20,i=Math.ceil(i*1.15);const c=r>=i,u={"80+":.8,"80+ Bronze":.82,"80+ Silver":.85,"80+ Gold":.87,"80+ Platinum":.89,"80+ Titanium":.92}[n]||.85,d=Math.ceil(i/u);return{compatible:c,reason:c?`Sufficient power (${r}W PSU for ${i}W system load)`:`Insufficient power: ${r}W PSU for ${i}W system load (${d}W recommended)`,details:{psuWattage:r,totalPowerNeeded:i,recommendedWattage:d,efficiency:n,powerBreakdown:a}}},Hm=(e,t,r)=>{const n=Ze(e,"length"),a=Ze(e,"width")||120,i=Ze(e,"slot_thickness")||2,s=Ze(t,"max_gpu_length"),o=Ze(t,"max_gpu_width")||140,c=Ze(t,"expansion_slots")||7,u=[],d={gpuLength:n,gpuWidth:a,gpuSlotThickness:i,caseMaxLength:s,caseMaxWidth:o,caseMaxSlots:c};if(n&&s&&parseInt(n)>parseInt(s)&&u.push(`GPU length (${n}mm) exceeds case maximum (${s}mm)`),parseInt(a)>parseInt(o)&&u.push(`GPU width (${a}mm) exceeds case maximum (${o}mm)`),parseInt(i)>2){const h=Math.ceil(parseInt(i)/2)*2;h>parseInt(c)&&u.push(`GPU requires ${h} slots but case only has ${c}`)}return r&&(Ze(r,"pcie_slots")||1)<1&&u.push("Motherboard has no available PCIe slots"),Ze(t,"vertical_gpu_mount")===!1&&i>2&&u.push("Case does not support vertical GPU mounting for thick cards"),u.length>0?{compatible:!1,reason:u.join("; "),details:d}:{compatible:!0,reason:"GPU is compatible with case",details:d}},Fu=(e,t,r)=>{if(!e||e.length===0)return{compatible:[],incompatible:[]};const n=[],a=[];return e.forEach(i=>{const s=eL(i,t,r);s.compatible?n.push({...i,compatibility:s}):a.push({...i,compatibility:s})}),{compatible:n,incompatible:a}},eL=(e,t,r)=>{const n=[];let a=!0;switch(r){case"motherboard":if(t.cpu){const s=lb(t.cpu,e);s.compatible||(n.push(s.reason),a=!1)}break;case"ram":if(t.motherboard){const s=cb(e,t.motherboard);s.compatible||(n.push(s.reason),a=!1)}if(t.cpu){const s=iL(t.cpu,e);s.compatible||(n.push(s.reason),a=!1)}break;case"case":if(t.motherboard){const s=ub(e,t.motherboard);s.compatible||(n.push(s.reason),a=!1)}break;case"psu":const i=zm(e,t);i.compatible||(n.push(i.reason),a=!1);break;case"gpu":if(t.case){const s=t.motherboard?Hm(e,t.case,t.motherboard):Hm(e,t.case);if(s.compatible||(n.push(s.reason),a=!1),t.psu){const o=zm(t.psu,{...t,gpu:e});o.compatible||(n.push(o.reason),a=!1)}}break;case"cooler":if(t.case){const s=db(e,t.case);s.compatible||(n.push(s.reason),a=!1)}break}return{compatible:a,issues:n,reason:n.length>0?n.join("; "):"Compatible with current selections"}},Xo=e=>{const t=[];let r=0,n=0;if(e.cpu&&e.motherboard){r++;const s=lb(e.cpu,e.motherboard);t.push({type:"cpu_motherboard",...s}),s.compatible&&n++}if(e.ram&&e.motherboard){r++;const s=cb(e.ram,e.motherboard);t.push({type:"ram_motherboard",...s}),s.compatible&&n++}if(e.case&&e.motherboard){r++;const s=ub(e.case,e.motherboard);t.push({type:"case_motherboard",...s}),s.compatible&&n++}if(e.psu){r++;const s=zm(e.psu,e);t.push({type:"psu_power",...s}),s.compatible&&n++}if(e.gpu&&e.case){r++;const s=Hm(e.gpu,e.case);t.push({type:"gpu_case",...s}),s.compatible&&n++}if(e.cooler&&e.case){r++;const s=db(e.cooler,e.case);t.push({type:"cooler_case",...s}),s.compatible&&n++}return{score:Object.values(e).some(s=>s!=null&&typeof s=="object"&&Object.keys(s).length>0&&s.id&&s.name)?r>0?Math.round(n/r*100):100:0,totalChecks:r,passedChecks:n,checks:t}},tL=(e,t)=>{var n;const r={compatibilityRate:.8,potentialIssues:[],recommendations:[]};if(e.cpu){const a=((n=e.cpu.name)==null?void 0:n.toLowerCase())||"",i=Ze(e.cpu,"socket"),s=Ze(e.cpu,"brand");switch(t){case"motherboard":i?(r.compatibilityRate=.9,r.recommendations.push(`Look for ${i} motherboards`)):s?(r.compatibilityRate=.7,r.recommendations.push(`Look for ${s} motherboards`)):(r.compatibilityRate=.5,r.potentialIssues.push("Socket information not available"));break;case"ram":a.includes("ryzen")?(r.compatibilityRate=.95,r.recommendations.push("DDR4 RAM recommended for Ryzen"),r.recommendations.push("Most DDR4 RAM modules will work")):a.includes("i7-11700")||a.includes("i5-11600")?(r.compatibilityRate=.95,r.recommendations.push("DDR4 RAM recommended for Intel 11th gen"),r.recommendations.push("Most DDR4 RAM modules will work")):(r.compatibilityRate=.9,r.recommendations.push("Most DDR4 RAM modules are compatible"));break;case"gpu":r.compatibilityRate=.95;break;case"psu":a.includes("i7")||a.includes("i9")?(r.compatibilityRate=.8,r.recommendations.push("Consider 650W+ PSU for high-end CPU")):(r.compatibilityRate=.9,r.recommendations.push("500W+ PSU should be sufficient"));break;case"case":r.compatibilityRate=.9;break;case"cooler":i&&(r.compatibilityRate=.85,r.recommendations.push(`Look for ${i} compatible coolers`));break}}if(e.motherboard&&t==="ram"){const a=Ze(e.motherboard,"ram_type");a?(r.compatibilityRate=.95,r.recommendations.push(`Look for ${a} RAM`),r.recommendations.push("Most RAM brands are compatible")):(r.compatibilityRate=.9,r.recommendations.push("Most DDR4 RAM modules will work"),r.recommendations.push("Check motherboard manual for specific requirements"))}return e.case&&t==="gpu"&&(r.compatibilityRate=.9,r.recommendations.push("Check GPU length compatibility"),r.recommendations.push("Most GPUs fit in standard cases")),e.case&&t==="cooler"&&(r.compatibilityRate=.9,r.recommendations.push("Check cooler height compatibility"),r.recommendations.push("Most coolers fit in standard cases")),t==="case"&&(e.motherboard?(r.compatibilityRate=.95,r.recommendations.push("Most cases are compatible with your motherboard"),r.recommendations.push("Look for ATX, Micro-ATX, or Mini-ITX cases"),r.recommendations.push("Gaming cases offer good airflow and compatibility")):(r.compatibilityRate=.9,r.recommendations.push("Most cases work with standard motherboards"),r.recommendations.push("ATX cases offer the best compatibility"))),r},rL=(e,t)=>{const r=[];if(t==="cpu"&&(r.push({name:"AMD Ryzen 5 5600G",reason:"Excellent compatibility with most motherboards and RAM",price:"7,840",compatibility:"High",benefits:["AM4 socket","Integrated graphics","Good value"]}),r.push({name:"Intel Core i5-11600",reason:"Good balance of performance and compatibility",price:"12,500",compatibility:"High",benefits:["LGA1200 socket","Strong performance","Wide motherboard support"]})),t==="motherboard"&&e.cpu){const n=Ze(e.cpu,"socket");n==="Intel LGA1200"?r.push({name:"MSI B560M PRO-VDH",reason:"Perfect match for Intel 11th gen CPUs",price:"4,500",compatibility:"Excellent",benefits:["LGA1200 socket","DDR4 support","Good features"]}):n==="AMD AM4"&&r.push({name:"MSI B550M PRO-VDH",reason:"Great for AMD Ryzen processors",price:"4,200",compatibility:"Excellent",benefits:["AM4 socket","DDR4 support","PCIe 4.0"]})}if(t==="ram"&&(r.push({name:"Kingston Fury Beast 8GB DDR4 3200MHz",reason:"Excellent compatibility with most motherboards",price:"1,800",compatibility:"High",benefits:["DDR4 3200MHz","Widely compatible","Good performance"]}),r.push({name:"Corsair Vengeance LPX 8GB DDR4 3200MHz",reason:"High compatibility and reliable performance",price:"2,100",compatibility:"High",benefits:["DDR4 3200MHz","Low profile","Stable performance"]}),r.push({name:"G.Skill Ripjaws V 8GB DDR4 3200MHz",reason:"Great value with good compatibility",price:"1,950",compatibility:"High",benefits:["DDR4 3200MHz","Good value","Reliable"]}),e.motherboard)){const n=Ze(e.motherboard,"brand");n&&r.push({name:`${n} Compatible RAM`,reason:`Specifically tested with ${n} motherboards`,price:"2,000",compatibility:"Excellent",benefits:["Brand tested","Guaranteed compatibility","Optimized performance"]})}if(t==="case"&&(r.push({name:"NZXT H510 Flow",reason:"Excellent airflow and compatibility with most motherboards",price:"4,500",compatibility:"High",benefits:["ATX compatible","Great airflow","Modern design"]}),r.push({name:"Phanteks P300A",reason:"High compatibility and excellent cooling performance",price:"3,800",compatibility:"High",benefits:["ATX/Micro-ATX","Mesh front panel","Good value"]}),r.push({name:"Fractal Design Focus G",reason:"Great compatibility and build quality",price:"4,200",compatibility:"High",benefits:["ATX compatible","Quiet operation","Easy to build in"]}),e.motherboard)){const n=Ze(e.motherboard,"form_factor");n&&r.push({name:`${n} Optimized Case`,reason:`Specifically designed for ${n} motherboards`,price:"4,000",compatibility:"Excellent",benefits:["Form factor optimized","Perfect fit","Efficient space usage"]})}return r},nL=e=>{var a;const t={compatibilityLevel:"high",recommendations:[],troubleshooting:[],fallbackOptions:[]},r=e.cpu,n=e.motherboard;if(r&&n){const i=((a=r.name)==null?void 0:a.toLowerCase())||"";Ze(r,"socket");const s=Ze(n,"ram_type");i.includes("ryzen")?(t.recommendations.push("AMD Ryzen CPUs work well with DDR4 RAM"),t.recommendations.push("Look for DDR4 3200MHz or 3600MHz for best performance"),t.fallbackOptions.push("Any DDR4 RAM module should work")):(i.includes("i7-11700")||i.includes("i5-11600"))&&(t.recommendations.push("Intel 11th gen CPUs are compatible with DDR4"),t.recommendations.push("DDR4 3200MHz is recommended for optimal performance"),t.fallbackOptions.push("Most DDR4 RAM modules are compatible")),s?(t.recommendations.push(`Your motherboard supports ${s}`),t.recommendations.push(`Look for ${s} RAM modules`)):(t.recommendations.push("Your motherboard likely supports DDR4"),t.recommendations.push("Most DDR4 RAM modules will work")),t.troubleshooting.push("If no RAM shows as compatible, try showing all components"),t.troubleshooting.push("Most DDR4 RAM is compatible with modern motherboards"),t.troubleshooting.push("Check motherboard manual for specific RAM requirements"),t.troubleshooting.push("Consider RAM speed compatibility (3200MHz is usually safe)"),t.fallbackOptions.push("Kingston Fury Beast DDR4 3200MHz"),t.fallbackOptions.push("Corsair Vengeance LPX DDR4 3200MHz"),t.fallbackOptions.push("G.Skill Ripjaws V DDR4 3200MHz"),t.fallbackOptions.push("Any major brand DDR4 RAM should work")}else r&&(t.recommendations.push("Select a motherboard first for specific RAM recommendations"),t.recommendations.push("Most modern CPUs work with DDR4 RAM"),t.fallbackOptions.push("DDR4 3200MHz RAM is generally safe"));return t},aL=e=>{const t={compatibilityLevel:"high",recommendations:[],troubleshooting:[],fallbackOptions:[]},r=e.motherboard,n=e.gpu,a=e.cooler;if(r){const i=Ze(r,"form_factor"),s=Ze(r,"brand");i?(t.recommendations.push(`Your motherboard is ${i} format`),t.recommendations.push(`Look for cases that support ${i} motherboards`),i==="ATX"?(t.recommendations.push("ATX cases offer the best compatibility and airflow"),t.fallbackOptions.push("Any ATX case will work")):i==="Micro-ATX"?(t.recommendations.push("Micro-ATX cases are compact and efficient"),t.fallbackOptions.push("ATX and Micro-ATX cases will work")):i==="Mini-ITX"&&(t.recommendations.push("Mini-ITX cases are very compact"),t.fallbackOptions.push("Most cases support Mini-ITX"))):(t.recommendations.push("Your motherboard likely supports standard case formats"),t.recommendations.push("ATX cases offer the best compatibility")),s&&t.recommendations.push(`Your ${s} motherboard works with most cases`)}return n&&(t.recommendations.push("Consider GPU length when selecting a case"),t.recommendations.push("Most modern cases support long graphics cards"),t.fallbackOptions.push("Look for cases with 300mm+ GPU clearance")),a&&(t.recommendations.push("Consider cooler height when selecting a case"),t.recommendations.push("Most cases support standard air coolers"),t.fallbackOptions.push("Look for cases with 160mm+ cooler clearance")),t.troubleshooting.push("If no cases show as compatible, try showing all components"),t.troubleshooting.push("Most ATX cases work with most motherboards"),t.troubleshooting.push("Check case specifications for motherboard support"),t.troubleshooting.push("Consider airflow and cable management features"),t.fallbackOptions.push("NZXT H510 Flow - Excellent ATX compatibility"),t.fallbackOptions.push("Phanteks P300A - Great Micro-ATX support"),t.fallbackOptions.push("Fractal Design Focus G - Universal compatibility"),t.fallbackOptions.push("Any major brand ATX case should work"),t},iL=(e,t)=>{var c;const r=Ze(e,"socket"),n=Ze(t,"ram_type"),a=Ze(t,"speed"),i=[],s={cpuSocket:r,ramType:n,ramSpeed:a};if(r&&n){const u=Kv(r),d=String(n).toUpperCase().includes("DDR5")?"DDR5":String(n).toUpperCase().includes("DDR3")?"DDR3":"DDR4",f=hd.cpu_ram_compatibility[u];f&&!f.includes(d)&&i.push(`CPU socket ${u} does not support ${d} RAM`)}if(a&&r){const u=parseInt(a),d=String(n||"").toUpperCase().includes("DDR5")?"DDR5":String(n||"").toUpperCase().includes("DDR3")?"DDR3":"DDR4";if(hd.ram_speeds[d]){const f=hd.ram_speeds[d];u<f.min?i.push(`RAM speed (${a}MHz) is below minimum for ${d} (${f.min}MHz)`):u>f.max&&i.push(`RAM speed (${a}MHz) exceeds maximum for ${d} (${f.max}MHz)`)}}const o=((c=e.name)==null?void 0:c.toLowerCase())||"";return o.includes("ryzen")&&a&&parseInt(a)<3e3&&i.push("Warning: Ryzen CPUs benefit from faster RAM (3000MHz+)"),(o.includes("i7-11700")||o.includes("i5-11600"))&&a&&parseInt(a)<2666&&i.push("Warning: Intel 11th gen CPUs work better with faster RAM (2666MHz+)"),i.length>0?{compatible:i.filter(d=>!d.startsWith("Warning:")).length===0,reason:i.join("; "),details:s,warnings:i.filter(d=>d.startsWith("Warning:")).length}:{compatible:!0,reason:"RAM is compatible with CPU",details:s}},db=(e,t)=>{const r=Ze(e,"cooler"),n=Ze(t,"case");if(!r||!n)return{compatible:!0};if(r.type&&r.type.toLowerCase().includes("liquid")){const a=r.name.match(/(\d+)mm/);if(a){const i=parseInt(a[1]),s=`${i}mm`;if(n.radiatorSupport){if(!n.radiatorSupport.split(",").map(c=>c.trim()).includes(s))return{compatible:!1,reason:`Case does not support ${i}mm radiator`}}else return{compatible:!0}}}if(r.type&&(r.type.toLowerCase().includes("air")||!r.type.toLowerCase().includes("liquid"))){const a=r.name.match(/(\d+)mm/);if(a&&n.maxCoolerHeight){const i=parseInt(a[1]),s=parseInt(n.maxCoolerHeight);if(i>s)return{compatible:!1,reason:`Cooler height (${i}mm) exceeds case maximum (${s}mm)`}}}return{compatible:!0}},ax=import.meta&&{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}&&"/"||"/",sL=ax.endsWith("/")?ax.slice(0,-1):ax,oL=({selectedComponents:e,onComponentSelect:t,onComponentRemove:r,activeCategory:n,recommendations:a=[],loadingRecommendations:i=!1,compatibilityIssues:s=[],prefetchedComponents:o=[],branch:c=null})=>{const[u,d]=N.useState(""),[f,h]=N.useState("name"),[p,x]=N.useState([]),[g,y]=N.useState(!0),[v,w]=N.useState(null),[b,S]=N.useState(!0);N.useState({});const[k,_]=N.useState({compatible:[],incompatible:[]}),[E,P]=N.useState(!1),A=N.useRef(!0),T=N.useRef(n),R=N.useRef(0),D=N.useRef(null),L=N.useRef(!1),z=N.useRef({}),X=N.useRef(!1),Y=[{id:"cpu",name:"CPU",icon:ua,required:!0,description:"Brain of your PC"},{id:"motherboard",name:"Motherboard",icon:up,required:!0,description:"Connects everything"},{id:"gpu",name:"Graphics Card",icon:Ki,required:!0,description:"Handles graphics"},{id:"ram",name:"RAM",icon:ti,required:!0,description:"System memory"},{id:"storage",name:"Storage",icon:au,required:!0,description:"Data storage"},{id:"psu",name:"Power Supply",icon:Ta,required:!0,description:"Powers everything"},{id:"case",name:"Case",icon:Ye,required:!0,description:"Houses components"},{id:"cooler",name:"Cooler",icon:ta,required:!1,description:"Keeps it cool"}],q={cpu:"CPU",motherboard:"Motherboard",gpu:"GPU",ram:"RAM",storage:"Storage",psu:"PSU",case:"Case",cooler:"Cooler"};N.useEffect(()=>{if(Array.isArray(o)&&o.length>0){x(o);try{z.current[n]=o}catch{}const xe=Fu(o,e,n);_(xe),y(!1)}},[o,n,e]);const ee=N.useRef(null),V=N.useRef(null),ae=N.useRef(null),oe=N.useRef(!1),I=N.useRef(!0);N.useEffect(()=>()=>{I.current=!1;try{ee.current&&ee.current.abort()}catch{}try{ae.current&&clearTimeout(ae.current)}catch{}try{D.current&&clearTimeout(D.current)}catch{}},[]);const W=N.useCallback(async()=>{const xe=T.current!==n;if(!xe&&V.current===n&&g)return;if(xe&&ee.current)try{ee.current.abort()}catch{}const Ie=new AbortController;if(ee.current=Ie,w(null),T.current=n,A.current||xe||!L.current?y(!0):P(!0),ae.current)try{clearTimeout(ae.current)}catch{}oe.current=!1;try{const ut=++R.current;V.current=n;const Ht=q[n],kr=ha("components",{category:Ht,...c&&{branch:c}});ae.current=setTimeout(()=>{oe.current=!0;try{Ie.abort()}catch{}},1e4);const _r=await fetch(kr,{signal:Ie.signal});if(ae.current)try{clearTimeout(ae.current)}catch{}const re=await _r.json().catch(async Ne=>{const je=await _r.text().catch(()=>"");throw new Error(`Invalid JSON from server. Status=${_r.status} ${_r.statusText}. BodyPreview=${(je||"").slice(0,200)}`)});if(!I.current||ut!==R.current)return;if(re.success){const Ne=[],je=new Set,at=new Set;Array.isArray(re.data)&&re.data.forEach(Xe=>{const Xr=Xe.id,J=`${(Xe.name||"").toLowerCase().trim()}-${(Xe.brand||"").toLowerCase().trim()}`;Xr&&!je.has(Xr)?(je.add(Xr),Ne.push(Xe)):!Xr&&!at.has(J)&&(at.add(J),Ne.push(Xe))}),x(Ne);try{z.current[n]=Ne}catch{}const _e=Fu(Ne,e,n);_(_e),A.current=!1}else w(re.error||"Failed to fetch components"),await U(n,Ht,Ie.signal)}catch(ut){if(ut&&ut.name==="AbortError"){if(oe.current){w("Request timed out. Please check your server (Apache/MySQL) and try again.");const Ht=q[n];await U(n,Ht)}else if(z.current[n]){x(z.current[n]);const Ht=Fu(z.current[n],e,n);_(Ht)}return}if(!I.current)return;w(`Failed to connect to server${ut!=null&&ut.message?`: ${ut.message}`:""}`)}finally{if(!I.current)return;if(ae.current)try{clearTimeout(ae.current)}catch{}y(!1),P(!1),V.current=null}},[n,c]),U=N.useCallback(async(xe,Ie,ut)=>{if(!X.current){X.current=!0;try{const kr=await(await fetch(ha("get_all_components"),{signal:ut})).json();if(kr&&kr.success&&Array.isArray(kr.data)){const _r=kr.data.filter(re=>(re.category||re.Category||"").toString().toLowerCase()===Ie.toString().toLowerCase());if(_r.length>0){const re=[],Ne=new Set,je=new Set;_r.forEach(_e=>{const Xe=_e.id,Xr=`${(_e.name||"").toLowerCase().trim()}-${(_e.brand||"").toLowerCase().trim()}`;Xe&&!Ne.has(Xe)?(Ne.add(Xe),re.push(_e)):!Xe&&!je.has(Xr)&&(je.add(Xr),re.push(_e))}),z.current[xe]=re,x(re);const at=Fu(re,e,xe);_(at),w(null)}}}catch{}}},[e]);N.useEffect(()=>{try{D.current&&clearTimeout(D.current)}catch{}return D.current=setTimeout(()=>{W()},150),()=>{try{D.current&&clearTimeout(D.current)}catch{}}},[W]),N.useEffect(()=>{if(p.length>0){const xe=Fu(p,e,n);_(xe)}},[e,n,p]),N.useEffect(()=>{L.current=p&&p.length>0},[p]);const G=xe=>[...xe].sort((Ie,ut)=>{switch(f){case"price":return(Ie.price||0)-(ut.price||0);case"name":return(Ie.name||"").localeCompare(ut.name||"");case"brand":return(Ie.brand||"").localeCompare(ut.brand||"");default:return 0}}),ne=xe=>u?xe.filter(Ie=>{var ut,Ht,kr;return((ut=Ie.name)==null?void 0:ut.toLowerCase().includes(u.toLowerCase()))||((Ht=Ie.brand)==null?void 0:Ht.toLowerCase().includes(u.toLowerCase()))||((kr=Ie.model)==null?void 0:kr.toLowerCase().includes(u.toLowerCase()))}):xe,K=Y.find(xe=>xe.id===n),le=()=>{var xe;if((K==null?void 0:K.id)==="motherboard"&&e.cpu){const Ie=((xe=e.cpu.name)==null?void 0:xe.toLowerCase())||"",ut=[];return Ie.includes("i7-11700")?ut.push({type:"socket",message:"Your Intel i7-11700 uses LGA1200 socket",recommendation:"Look for motherboards with LGA1200 socket support"}):Ie.includes("ryzen")&&ut.push({type:"socket",message:"Your AMD Ryzen CPU uses AM4 socket",recommendation:"Look for motherboards with AM4 socket support"}),ut}return[]},Q=()=>{if(!e.cpu)return null;const xe={motherboard:{compatible:0,total:0,rate:0,issues:[],recommendations:[]},ram:{compatible:0,total:0,rate:0,issues:[],recommendations:[]},gpu:{compatible:0,total:0,rate:0,issues:[],recommendations:[]},storage:{compatible:0,total:0,rate:0,issues:[],recommendations:[]},psu:{compatible:0,total:0,rate:0,issues:[],recommendations:[]},case:{compatible:0,total:0,rate:0,issues:[],recommendations:[]},cooler:{compatible:0,total:0,rate:0,issues:[],recommendations:[]}};return Object.keys(xe).forEach(Ie=>{if(Ie!==n){const ut=tL(e,Ie),Ht=15;xe[Ie]={compatible:Math.round(Ht*ut.compatibilityRate),total:Ht,rate:ut.compatibilityRate,issues:ut.potentialIssues,recommendations:ut.recommendations}}}),xe},ce=()=>rL(e,n),be=le(),j=Q(),$e=ce(),Ee=n==="ram"?nL(e):null,Ae=n==="case"?aL(e):null,we=(()=>n!=="cooler"?null:{message:"CPU cooling is completely optional for your build!",recommendations:["Most CPUs come with stock coolers that work fine for basic use","Stock coolers are included in the CPU box at no extra cost","You only need aftermarket cooling for gaming, overclocking, or better performance","Air coolers are simpler and more reliable than liquid cooling"],troubleshooting:["If no coolers are found, you can safely skip this step","Stock coolers handle most gaming and productivity tasks","Aftermarket cooling is a luxury, not a requirement"],fallbackOptions:["Use the included stock cooler (free and functional)","Skip cooling selection and proceed with build","Add cooling later if you need better performance"]})(),[de,Ge]=N.useState(!0),[et,Qe]=N.useState(!0),[te,De]=N.useState(!0),[ze,ct]=N.useState(!0),[Ke,mt]=N.useState(!0),ht=xe=>xe.compatibility?xe.compatibility.compatible?l(yt,{className:"w-5 h-5 text-green-500"}):l(Cn,{className:"w-5 h-5 text-red-500"}):null,Re=xe=>xe.compatibility?xe.compatibility.compatible?m("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[l(yt,{className:"w-3 h-3 mr-1"}),"Compatible"]}):m("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[l(Cn,{className:"w-3 h-3 mr-1"}),"Incompatible"]}):null,tt=(xe,Ie=!0)=>{var _r;const ut=((_r=e[n])==null?void 0:_r.id)===xe.id,Ht=ht(xe),kr=Re(xe);return m("div",{className:`relative bg-white rounded-lg border-2 p-3 sm:p-4 transition-all duration-200 hover:shadow-lg ${ut?"border-green-500 bg-green-50":Ie?"border-gray-200 hover:border-green-300":"border-red-200 bg-red-50 opacity-75"} ${!Ie&&!b?"hidden":""}`,children:[kr&&l("div",{className:"absolute top-2 right-2",children:kr}),l("div",{className:"flex justify-center mb-3 sm:mb-4",children:l("img",{src:ri(xe,n),alt:xe.name,className:"w-20 h-20 sm:w-24 sm:h-24 object-contain",onError:re=>{re.currentTarget.onerror=null,re.currentTarget.src=`${sL}/images/placeholder-component.svg`}})}),m("div",{className:"text-center mb-3 sm:mb-4",children:[l("h3",{className:"font-semibold text-gray-900 text-xs sm:text-sm mb-1 line-clamp-2",children:xe.name}),xe.brand&&m("p",{className:"text-gray-600 text-xs mb-1 sm:mb-2",children:[xe.brand,xe.model?`  ${xe.model}`:""]}),xe.price!==void 0&&xe.price!==null&&m("p",{className:"text-green-600 font-bold text-base sm:text-lg",children:["",xe.price.toLocaleString()]})]}),xe.compatibility&&m("div",{className:"mb-3 sm:mb-4 p-2 sm:p-3 bg-gray-50 rounded-lg",children:[m("div",{className:"flex items-center gap-2 mb-1",children:[Ht,l("span",{className:"text-xs font-medium text-gray-700",children:"Compatibility"})]}),xe.compatibility.reason&&l("p",{className:"text-xs text-gray-600",children:xe.compatibility.reason}),xe.compatibility.issues&&xe.compatibility.issues.length>0&&l("ul",{className:"mt-2 text-xs text-red-600 space-y-1 list-disc pl-4",children:xe.compatibility.issues.slice(0,3).map((re,Ne)=>l("li",{children:re},Ne))})]}),l("div",{className:"flex gap-1.5 sm:gap-2",children:ut?m("button",{onClick:()=>r(n),className:"flex-1 bg-red-500 text-white py-2 px-3 rounded-lg text-sm font-medium hover:bg-red-600 transition-colors flex items-center justify-center",children:[l(an,{className:"w-4 h-4 mr-1"}),"Remove"]}):m("button",{onClick:()=>t(n,xe),disabled:!Ie,className:`flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-colors flex items-center justify-center ${Ie?"bg-green-500 text-white hover:bg-green-600":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:[l(Vn,{className:"w-4 h-4 mr-1"}),Ie?"Select":"Incompatible"]})})]},xe.id)};if(g&&p.length===0)return l("div",{className:"flex items-center justify-center h-64",children:m("div",{className:"text-center",children:[l("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500 mx-auto mb-4"}),l("p",{className:"text-gray-600",children:"Loading components..."})]})});if(!g&&p.length===0)return l("div",{className:"flex items-center justify-center h-64",children:m("div",{className:"text-center text-gray-600",children:[l($r,{className:"w-12 h-12 mx-auto mb-4 text-yellow-500"}),l("p",{className:"text-lg font-medium mb-1",children:"No components found for this category"}),l("p",{className:"text-sm mb-3",children:"Try again or pick a different category."}),l("button",{onClick:W,className:"mt-1 bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition-colors",children:"Try Again"})]})});if(v)return l("div",{className:"flex items-center justify-center h-64",children:m("div",{className:"text-center text-red-600",children:[l($r,{className:"w-12 h-12 mx-auto mb-4"}),l("p",{className:"text-lg font-medium mb-2",children:"Error Loading Components"}),l("p",{className:"text-sm",children:v}),l("button",{onClick:W,className:"mt-4 bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition-colors",children:"Try Again"})]})});const kt=G(ne(k.compatible)),Lt=G(ne(k.incompatible));return m("div",{className:"space-y-6",children:[m("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[l("div",{className:"flex items-center gap-3",children:K&&m(lt,{children:[l(K.icon,{className:"w-6 h-6 sm:w-8 sm:h-8 text-green-600"}),m("div",{children:[l("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:K.name}),l("p",{className:"text-xs sm:text-sm text-gray-600",children:K.description}),n==="cooler"&&l("div",{className:"mt-1",children:m("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-cyan-100 text-cyan-800 border border-cyan-200",children:[l(ta,{className:"w-3 h-3 mr-1"}),"Optional Component"]})})]})]})}),l("div",{className:"flex items-center gap-4",children:m("button",{onClick:()=>S(!b),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-xs sm:text-sm font-medium transition-colors ${b?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[b?l(j8,{className:"w-4 h-4"}):l(B8,{className:"w-4 h-4"}),m("span",{className:"hidden sm:inline",children:[b?"Hide":"Show"," Incompatible"]}),l("span",{className:"sm:hidden",children:b?"Hide":"Show"})]})})]}),m("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:[m("div",{className:"flex-1 relative",children:[l(Wi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 sm:w-5 sm:h-5 text-gray-400"}),l("input",{type:"text",placeholder:`Search ${(K==null?void 0:K.name)||"components"}...`,value:u,onChange:xe=>d(xe.target.value),className:"w-full pl-9 sm:pl-10 pr-4 py-2.5 sm:py-3 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),m("select",{value:f,onChange:xe=>h(xe.target.value),className:"px-3 sm:px-4 py-2.5 sm:py-3 text-sm sm:text-base border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[l("option",{value:"name",children:"Sort by Name"}),l("option",{value:"price",children:"Sort by Price"}),l("option",{value:"brand",children:"Sort by Brand"})]})]}),m("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-5 mb-4",children:[m("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[m("div",{className:"flex items-center gap-3",children:[l("div",{className:"p-2 bg-blue-100 rounded-lg",children:l(na,{className:"w-5 h-5 text-blue-600"})}),m("div",{children:[l("h3",{className:"font-semibold text-blue-900",children:"Compatibility View"}),l("p",{className:"text-sm text-blue-600",children:"Component compatibility analysis"})]})]}),m("div",{className:"flex flex-col sm:items-end gap-1",children:[m("div",{className:"flex items-center gap-4 text-sm",children:[m("div",{className:"flex items-center gap-2",children:[l("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),m("span",{className:"font-medium text-green-700",children:[k.compatible.length," compatible"]})]}),m("div",{className:"flex items-center gap-2",children:[l("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),m("span",{className:"font-medium text-red-700",children:[k.incompatible.length," incompatible"]})]})]}),l("p",{className:"text-xs text-blue-600 text-right",children:"Showing all components by default"})]})]}),l("div",{className:"mt-3 pt-3 border-t border-blue-200",children:l("p",{className:"text-sm text-blue-700",children:"Use the toggle below to hide incompatible items if you want a narrower selection list."})})]}),j&&m("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[m("div",{className:"flex items-center justify-between mb-3",children:[m("div",{className:"flex items-center gap-2",children:[l(lo,{className:"w-5 h-5 text-green-600"}),l("span",{className:"font-medium text-green-900",children:"Compatibility Preview"})]}),m("button",{onClick:()=>Ge(!de),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium bg-green-50 text-green-700 rounded-full border border-green-200 hover:bg-green-100 hover:border-green-300 transition-all duration-200 shadow-sm",children:[l(qa,{className:"w-4 h-4"}),de?"Hide Tips":"Show Tips"]})]}),de&&m(lt,{children:[l("p",{className:"text-sm text-green-700 mb-3",children:"Based on your current selections, here's what you can expect in upcoming categories:"}),l("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:Object.entries(j).map(([xe,Ie])=>m("div",{className:"text-center p-2 bg-white rounded border",children:[l("div",{className:"text-xs font-medium text-gray-600 capitalize mb-1",children:xe}),m("div",{className:"text-sm font-bold text-green-600",children:[Ie.compatible,"/",Ie.total]}),l("div",{className:"text-xs text-gray-500",children:"compatible"}),m("div",{className:"text-xs text-blue-600 font-medium mt-1",children:[Math.round(Ie.rate*100),"% rate"]})]},xe))}),m("div",{className:"mt-4 p-3 bg-white rounded border",children:[l("div",{className:"text-sm font-medium text-gray-900 mb-2",children:"Key Recommendations:"}),l("div",{className:"space-y-1",children:Object.entries(j).map(([xe,Ie])=>Ie.recommendations.map((ut,Ht)=>m("div",{className:"text-xs text-gray-700 flex items-start gap-2",children:[m("span",{className:"text-blue-600 font-medium capitalize",children:[xe,":"]}),l("span",{children:ut})]},`${xe}-${Ht}`)))})]})]})]}),$e.length>0&&m("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[m("div",{className:"flex items-center justify-between mb-3",children:[m("div",{className:"flex items-center gap-2",children:[l(qa,{className:"w-5 h-5 text-purple-600"}),l("span",{className:"font-medium text-purple-900",children:"Smart Recommendations"})]}),m("button",{onClick:()=>Qe(!et),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium bg-purple-50 text-purple-700 rounded-full border border-purple-200 hover:bg-purple-100 hover:border-purple-300 transition-all duration-200 shadow-sm",children:[l(qa,{className:"w-4 h-4"}),et?"Hide Tips":"Show Tips"]})]}),et&&m(lt,{children:[l("p",{className:"text-sm text-purple-700 mb-3",children:"Consider these alternatives for better compatibility in future steps:"}),l("div",{className:"space-y-2",children:$e.map((xe,Ie)=>m("div",{className:"flex items-center justify-between p-3 bg-white rounded border",children:[m("div",{children:[l("div",{className:"font-medium text-gray-900",children:xe.name}),l("div",{className:"text-sm text-gray-600",children:xe.reason})]}),m("div",{className:"text-right",children:[l("div",{className:"font-bold text-green-600",children:xe.price}),m("div",{className:"text-xs text-purple-600 font-medium",children:[xe.compatibility," compatibility"]})]})]},Ie))})]})]}),Ee&&m("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[m("div",{className:"flex items-center justify-between mb-3",children:[m("div",{className:"flex items-center gap-2",children:[l(ti,{className:"w-5 h-5 text-blue-600"}),l("span",{className:"font-medium text-blue-900",children:"RAM Compatibility Guide"})]}),m("button",{onClick:()=>ct(!ze),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium bg-blue-50 text-blue-700 rounded-full border border-blue-200 hover:bg-blue-100 hover:border-blue-300 transition-all duration-200 shadow-sm",children:[l(qa,{className:"w-4 h-4"}),ze?"Hide Tips":"Show Tips"]})]}),ze&&m(lt,{children:[Ee.recommendations.length>0&&m("div",{className:"mb-4",children:[l("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"Recommendations:"}),l("ul",{className:"space-y-1",children:Ee.recommendations.map((xe,Ie)=>m("li",{className:"text-sm text-blue-700 flex items-start gap-2",children:[l("span",{className:"text-blue-500 mt-1",children:""}),l("span",{children:xe})]},Ie))})]}),Ee.troubleshooting.length>0&&m("div",{className:"mb-4",children:[l("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"Troubleshooting:"}),l("ul",{className:"space-y-1",children:Ee.troubleshooting.map((xe,Ie)=>m("li",{className:"text-sm text-blue-700 flex items-start gap-2",children:[l("span",{className:"text-blue-500 mt-1",children:""}),l("span",{children:xe})]},Ie))})]}),Ee.fallbackOptions.length>0&&m("div",{children:[l("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"Safe Fallback Options:"}),l("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:Ee.fallbackOptions.map((xe,Ie)=>l("div",{className:"text-sm text-blue-700 bg-white p-2 rounded border",children:xe},Ie))})]})]})]}),Ae&&m("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4",children:[m("div",{className:"flex items-center justify-between mb-3",children:[m("div",{className:"flex items-center gap-2",children:[l(Ye,{className:"w-5 h-5 text-indigo-600"}),l("span",{className:"font-medium text-indigo-900",children:"Case Compatibility Guide"})]}),m("button",{onClick:()=>De(!te),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium bg-indigo-50 text-indigo-700 rounded-full border border-indigo-200 hover:bg-indigo-100 hover:border-indigo-300 transition-all duration-200 shadow-sm",children:[l(qa,{className:"w-4 h-4"}),te?"Hide Tips":"Show Tips"]})]}),te&&m(lt,{children:[Ae.recommendations.length>0&&m("div",{className:"mb-4",children:[l("h4",{className:"text-sm font-medium text-indigo-900 mb-2",children:"Recommendations:"}),l("ul",{className:"space-y-1",children:Ae.recommendations.map((xe,Ie)=>m("li",{className:"text-sm text-indigo-700 flex items-start gap-2",children:[l("span",{className:"text-indigo-500 mt-1",children:""}),l("span",{children:xe})]},Ie))})]}),Ae.troubleshooting.length>0&&m("div",{className:"mb-4",children:[l("h4",{className:"text-sm font-medium text-indigo-900 mb-2",children:"Troubleshooting:"}),l("ul",{className:"space-y-1",children:Ae.troubleshooting.map((xe,Ie)=>m("li",{className:"text-sm text-indigo-700 flex items-start gap-2",children:[l("span",{className:"text-indigo-500 mt-1",children:""}),l("span",{children:xe})]},Ie))})]}),Ae.fallbackOptions.length>0&&m("div",{children:[l("h4",{className:"text-sm font-medium text-indigo-900 mb-2",children:"Safe Fallback Options:"}),l("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:Ae.fallbackOptions.map((xe,Ie)=>l("div",{className:"text-sm text-indigo-700 bg-white p-2 rounded border",children:xe},Ie))})]})]})]}),we&&n==="cooler"&&m("div",{className:"bg-cyan-50 border border-cyan-200 rounded-lg p-4",children:[m("div",{className:"flex items-center justify-between mb-3",children:[m("div",{className:"flex items-center gap-2",children:[l(ta,{className:"w-5 h-5 text-cyan-600"}),l("span",{className:"font-medium text-cyan-900",children:"Cooling Compatibility Guide"})]}),m("button",{onClick:()=>mt(!Ke),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium bg-cyan-50 text-cyan-700 rounded-full border border-cyan-200 hover:bg-cyan-100 hover:border-cyan-300 transition-all duration-200 shadow-sm",children:[l(qa,{className:"w-4 h-4"}),Ke?"Hide Tips":"Show Tips"]})]}),Ke&&m(lt,{children:[l("div",{className:"mb-4 p-3 bg-white rounded border",children:l("p",{className:"text-sm text-cyan-700 font-medium",children:we.message})}),we.recommendations.length>0&&m("div",{className:"mb-4",children:[l("h4",{className:"text-sm font-medium text-cyan-900 mb-2",children:"Recommendations:"}),l("ul",{className:"space-y-1",children:we.recommendations.map((xe,Ie)=>m("li",{className:"text-sm text-cyan-700 flex items-start gap-2",children:[l("span",{className:"text-cyan-500 mt-1",children:""}),l("span",{children:xe})]},Ie))})]}),we.troubleshooting.length>0&&m("div",{className:"mb-4",children:[l("h4",{className:"text-sm font-medium text-cyan-900 mb-2",children:"Troubleshooting:"}),l("ul",{className:"space-y-1",children:we.troubleshooting.map((xe,Ie)=>m("li",{className:"text-sm text-cyan-700 flex items-start gap-2",children:[l("span",{className:"text-cyan-500 mt-1",children:""}),l("span",{children:xe})]},Ie))})]}),we.fallbackOptions.length>0&&m("div",{children:[l("h4",{className:"text-sm font-medium text-cyan-900 mb-2",children:"Safe Fallback Options:"}),l("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:we.fallbackOptions.map((xe,Ie)=>l("div",{className:"text-sm text-cyan-700 bg-white p-2 rounded border",children:xe},Ie))})]})]})]}),m("div",{className:"space-y-6",children:[kt.length>0&&m("div",{children:[m("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[l(yt,{className:"w-5 h-5 text-green-500"}),"Compatible Components (",kt.length,")"]}),l("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-3 sm:gap-4",children:kt.map(xe=>tt(xe,!0))})]}),b&&Lt.length>0&&m("div",{children:[m("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[l(Cn,{className:"w-5 h-5 text-red-500"}),"Incompatible Components (",Lt.length,")"]}),l("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-3 sm:gap-4",children:Lt.map(xe=>tt(xe,!1))})]}),kt.length===0&&(!b||Lt.length===0)&&m("div",{className:"text-center py-12",children:[l(Ye,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:n==="cooler"?"No Cooling Components Found":"No Components Found"}),!u&&m("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 max-w-md mx-auto",children:[m("div",{className:"flex items-center gap-2 mb-2",children:[l($r,{className:"w-5 h-5 text-yellow-600"}),l("span",{className:"font-medium text-yellow-800",children:"Compatibility Issue"})]}),l("p",{className:"text-sm text-yellow-700 mb-3",children:n==="cooler"?"No cooling components found, but this is completely optional!":"No compatible components found for your current selections. This might be due to:"}),l("ul",{className:"text-sm text-yellow-700 space-y-1 mb-4",children:n==="cooler"?m(lt,{children:[l("li",{children:" Cooling is completely optional for your build"}),l("li",{children:" Most CPUs come with stock coolers included"}),l("li",{children:" You can proceed without selecting a cooler"})]}):m(lt,{children:[l("li",{children:" Socket compatibility issues"}),l("li",{children:" Missing component specifications"}),l("li",{children:" Limited component database"})]})}),be.length>0&&m("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[m("div",{className:"flex items-center gap-2 mb-2",children:[l(qa,{className:"w-4 h-4 text-blue-600"}),l("span",{className:"font-medium text-blue-800 text-sm",children:"Smart Suggestions"})]}),be.map((xe,Ie)=>m("div",{className:"text-sm text-blue-700",children:[l("p",{className:"font-medium",children:xe.message}),l("p",{className:"text-blue-600",children:xe.recommendation})]},Ie))]}),n==="ram"&&m("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:[m("div",{className:"flex items-center gap-2 mb-2",children:[l(ti,{className:"w-4 h-4 text-green-600"}),l("span",{className:"font-medium text-green-800 text-sm",children:"RAM Compatibility Help"})]}),m("div",{className:"text-sm text-green-700 space-y-2",children:[m("p",{children:[l("strong",{children:"Good news:"})," Most DDR4 RAM modules are compatible with modern motherboards!"]}),m("p",{children:[l("strong",{children:"Try this:"}),' Click "Show All Components" to see all available RAM options.']}),m("p",{children:[l("strong",{children:"Safe choices:"})," Kingston, Corsair, G.Skill DDR4 3200MHz RAM usually works with most systems."]}),m("p",{children:[l("strong",{children:"If still stuck:"})," Check your motherboard manual for specific RAM requirements."]})]})]}),n==="case"&&m("div",{className:"mb-4 p-3 bg-indigo-50 border border-indigo-200 rounded-lg",children:[m("div",{className:"flex items-center gap-2 mb-2",children:[l(Ye,{className:"w-4 h-4 text-indigo-600"}),l("span",{className:"font-medium text-indigo-800 text-sm",children:"Case Compatibility Help"})]}),m("div",{className:"text-sm text-indigo-700 space-y-2",children:[m("p",{children:[l("strong",{children:"Good news:"})," Most cases are compatible with most motherboards!"]}),m("p",{children:[l("strong",{children:"Try this:"}),' Click "Show All Components" to see all available case options.']}),m("p",{children:[l("strong",{children:"Safe choices:"})," ATX cases offer the best compatibility and airflow."]}),m("p",{children:[l("strong",{children:"If still stuck:"})," Most ATX, Micro-ATX, and Mini-ITX cases work together."]})]})]}),n==="cooler"&&m("div",{className:"mb-4 p-4 bg-gradient-to-r from-cyan-50 to-blue-50 border border-cyan-200 rounded-lg",children:[m("div",{className:"flex items-center gap-3 mb-4",children:[l("div",{className:"bg-cyan-100 p-2 rounded-full",children:l(ta,{className:"w-5 h-5 text-cyan-600"})}),m("div",{children:[l("h4",{className:"font-semibold text-cyan-800",children:"Cooling Options"}),l("p",{className:"text-sm text-cyan-700",children:"Choose your preferred cooling solution"})]})]}),m("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[m("div",{className:"bg-white p-4 rounded-lg border border-green-100",children:[l("h5",{className:"font-medium text-gray-900 mb-2",children:"Stock Cooler"}),l("p",{className:"text-xs text-gray-600 mb-3",children:"Included with your CPU"}),m("ul",{className:"text-xs text-gray-600 space-y-1.5 mb-4",children:[m("li",{className:"flex items-center gap-1.5",children:[l(yt,{className:"w-3.5 h-3.5 text-green-500"}),l("span",{children:"Great for everyday use"})]}),m("li",{className:"flex items-center gap-1.5",children:[l(yt,{className:"w-3.5 h-3.5 text-green-500"}),l("span",{children:"Quiet operation"})]})]}),l("button",{onClick:()=>t("cooler",{id:"stock-cooler",name:"Stock CPU Cooler",price:0}),className:"w-full px-3 py-1.5 text-xs font-medium text-white bg-green-500 hover:bg-green-600 rounded-md",children:"Use Stock Cooler"})]}),m("div",{className:"bg-white p-4 rounded-lg border border-blue-100",children:[l("h5",{className:"font-medium text-gray-900 mb-2",children:"Aftermarket Cooler"}),l("p",{className:"text-xs text-gray-600 mb-3",children:"Better performance & cooling"}),m("ul",{className:"text-xs text-gray-600 space-y-1.5 mb-4",children:[m("li",{className:"flex items-center gap-1.5",children:[l(Ta,{className:"w-3.5 h-3.5 text-blue-500"}),l("span",{children:"Ideal for gaming/overclocking"})]}),m("li",{className:"flex items-center gap-1.5",children:[l(Hi,{className:"w-3.5 h-3.5 text-blue-500"}),l("span",{children:"Browse options below"})]})]}),l("button",{onClick:()=>S(!0),className:"w-full px-3 py-1.5 text-xs font-medium text-white bg-blue-500 hover:bg-blue-600 rounded-md",children:"View All Coolers"})]})]}),l("p",{className:"text-xs text-cyan-700 text-center",children:"Not sure? The stock cooler is a great choice for most users!"})]}),m("div",{className:"flex flex-col gap-2",children:[l("button",{onClick:()=>S(!0),className:"w-full px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 transition-colors text-sm font-medium",children:"Show All Components (Including Incompatible)"}),l("button",{onClick:()=>window.location.reload(),className:"w-full px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors text-sm font-medium",children:"Start Over"})]})]})]}),kt.length===0&&(!b||Lt.length===0)&&m("div",{className:"text-center py-12",children:[l(Ye,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:n==="cooler"?"No Cooling Components Found":"No Components Found"}),!u&&m("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 max-w-md mx-auto",children:[m("div",{className:"flex items-center gap-2 mb-2",children:[l($r,{className:"w-5 h-5 text-yellow-600"}),l("span",{className:"font-medium text-yellow-800",children:"Compatibility Issue"})]}),l("p",{className:"text-sm text-yellow-700 mb-3",children:n==="cooler"?"No cooling components found, but this is completely optional!":"No compatible components found for your current selections. This might be due to:"}),l("ul",{className:"text-sm text-yellow-700 space-y-1 mb-4",children:n==="cooler"?m(lt,{children:[l("li",{children:" Cooling is completely optional for your build"}),l("li",{children:" Most CPUs come with stock coolers included"}),l("li",{children:" You can proceed without selecting a cooler"})]}):m(lt,{children:[l("li",{children:" Socket compatibility issues"}),l("li",{children:" Missing component specifications"}),l("li",{children:" Limited component database"})]})}),be.length>0&&m("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[m("div",{className:"flex items-center gap-2 mb-2",children:[l(qa,{className:"w-4 h-4 text-blue-600"}),l("span",{className:"font-medium text-blue-800 text-sm",children:"Smart Suggestions"})]}),be.map((xe,Ie)=>m("div",{className:"text-sm text-blue-700",children:[l("p",{className:"font-medium",children:xe.message}),l("p",{className:"text-blue-600",children:xe.recommendation})]},Ie))]}),n==="ram"&&m("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:[m("div",{className:"flex items-center gap-2 mb-2",children:[l(ti,{className:"w-4 h-4 text-green-600"}),l("span",{className:"font-medium text-green-800 text-sm",children:"RAM Compatibility Help"})]}),m("div",{className:"text-sm text-green-700 space-y-2",children:[m("p",{children:[l("strong",{children:"Good news:"})," Most DDR4 RAM modules are compatible with modern motherboards!"]}),m("p",{children:[l("strong",{children:"Try this:"}),' Click "Show All Components" to see all available RAM options.']}),m("p",{children:[l("strong",{children:"Safe choices:"})," Kingston, Corsair, G.Skill DDR4 3200MHz RAM usually works with most systems."]}),m("p",{children:[l("strong",{children:"If still stuck:"})," Check your motherboard manual for specific RAM requirements."]})]})]}),n==="case"&&m("div",{className:"mb-4 p-3 bg-indigo-50 border border-indigo-200 rounded-lg",children:[m("div",{className:"flex items-center gap-2 mb-2",children:[l(Ye,{className:"w-4 h-4 text-indigo-600"}),l("span",{className:"font-medium text-indigo-800 text-sm",children:"Case Compatibility Help"})]}),m("div",{className:"text-sm text-indigo-700 space-y-2",children:[m("p",{children:[l("strong",{children:"Good news:"})," Most cases are compatible with most motherboards!"]}),m("p",{children:[l("strong",{children:"Try this:"}),' Click "Show All Components" to see all available case options.']}),m("p",{children:[l("strong",{children:"Safe choices:"})," ATX cases offer the best compatibility and airflow."]}),m("p",{children:[l("strong",{children:"If still stuck:"})," Most ATX, Micro-ATX, and Mini-ITX cases work together."]})]})]}),n==="cooler"&&m("div",{className:"mb-4 p-4 bg-gradient-to-r from-cyan-50 to-blue-50 border border-cyan-200 rounded-lg",children:[m("div",{className:"flex items-center gap-3 mb-4",children:[l("div",{className:"bg-cyan-100 p-2 rounded-full",children:l(ta,{className:"w-5 h-5 text-cyan-600"})}),m("div",{children:[l("h4",{className:"font-semibold text-cyan-800",children:"Cooling Options"}),l("p",{className:"text-sm text-cyan-700",children:"Choose your preferred cooling solution"})]})]}),m("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[m("div",{className:"bg-white p-4 rounded-lg border border-green-100",children:[l("h5",{className:"font-medium text-gray-900 mb-2",children:"Stock Cooler"}),l("p",{className:"text-xs text-gray-600 mb-3",children:"Included with your CPU"}),m("ul",{className:"text-xs text-gray-600 space-y-1.5 mb-4",children:[m("li",{className:"flex items-center gap-1.5",children:[l(yt,{className:"w-3.5 h-3.5 text-green-500"}),l("span",{children:"Great for everyday use"})]}),m("li",{className:"flex items-center gap-1.5",children:[l(yt,{className:"w-3.5 h-3.5 text-green-500"}),l("span",{children:"Quiet operation"})]})]}),l("button",{onClick:()=>t("cooler",{id:"stock-cooler",name:"Stock CPU Cooler",price:0}),className:"w-full px-3 py-1.5 text-xs font-medium text-white bg-green-500 hover:bg-green-600 rounded-md",children:"Use Stock Cooler"})]}),m("div",{className:"bg-white p-4 rounded-lg border border-blue-100",children:[l("h5",{className:"font-medium text-gray-900 mb-2",children:"Aftermarket Cooler"}),l("p",{className:"text-xs text-gray-600 mb-3",children:"Better performance & cooling"}),m("ul",{className:"text-xs text-gray-600 space-y-1.5 mb-4",children:[m("li",{className:"flex items-center gap-1.5",children:[l(Ta,{className:"w-3.5 h-3.5 text-blue-500"}),l("span",{children:"Ideal for gaming/overclocking"})]}),m("li",{className:"flex items-center gap-1.5",children:[l(Hi,{className:"w-3.5 h-3.5 text-blue-500"}),l("span",{children:"Browse options below"})]})]}),l("button",{onClick:()=>S(!0),className:"w-full px-3 py-1.5 text-xs font-medium text-white bg-blue-500 hover:bg-blue-600 rounded-md",children:"View All Coolers"})]})]}),l("p",{className:"text-xs text-cyan-700 text-center",children:"Not sure? The stock cooler is a great choice for most users!"})]}),m("div",{className:"flex flex-col gap-2",children:[l("button",{onClick:()=>S(!0),className:"w-full px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 transition-colors text-sm font-medium",children:"Show All Components (Including Incompatible)"}),l("button",{onClick:()=>window.location.reload(),className:"w-full px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors text-sm font-medium",children:"Start Over"})]})]})]})]})]})},lL=({compatibilityStatus:e,compatibilityScore:t,compatibilityDetails:r={},selectionProgress:n=0})=>{const i=[{id:"cpu_motherboard",name:"CPU & Motherboard",description:"Socket compatibility check",status:e.cpu_motherboard,detail:r.cpu_motherboard,icon:l(ua,{className:"w-5 h-5"}),critical:!0},{id:"ram_motherboard",name:"RAM & Motherboard",description:"Memory type and speed compatibility",status:e.ram_motherboard,detail:r.ram_motherboard,icon:l(ti,{className:"w-5 h-5"}),critical:!0},{id:"ram_slots",name:"RAM Slots",description:"RAM modules vs motherboard slots",status:e.ram_slots,detail:r.ram_slots,icon:l(ti,{className:"w-5 h-5"}),critical:!0},{id:"ram_speed",name:"RAM Speed",description:"Memory speed vs motherboard support",status:e.ram_speed,detail:r.ram_speed,icon:l(ti,{className:"w-5 h-5"}),critical:!1},{id:"storage_interface",name:"Storage Interface",description:"Storage connection compatibility",status:e.storage_interface,detail:r.storage_interface,icon:l(au,{className:"w-5 h-5"}),critical:!0},{id:"psu_power",name:"Power Supply",description:"Adequate power for components",status:e.psu_power,detail:r.psu_power,icon:l(Ta,{className:"w-5 h-5"}),critical:!0},{id:"psu_form_factor",name:"PSU Form Factor",description:"PSU size vs case support",status:e.psu_form_factor,detail:r.psu_form_factor,icon:l(Ta,{className:"w-5 h-5"}),critical:!0},{id:"case_motherboard",name:"Case & Motherboard",description:"Form factor compatibility",status:e.case_motherboard,detail:r.case_motherboard,icon:l(Ye,{className:"w-5 h-5"}),critical:!0},{id:"gpu_length",name:"GPU & Case",description:"Graphics card length fit",status:e.gpu_length,detail:r.gpu_length,icon:l(Ki,{className:"w-5 h-5"}),critical:!0},{id:"cooler_height",name:"CPU Cooler & Case",description:"Cooler height clearance",status:e.cooler_height,detail:r.cooler_height,icon:l(ta,{className:"w-5 h-5"}),critical:!1},{id:"cooler_socket",name:"CPU Cooler Socket",description:"Cooler socket compatibility",status:e.cooler_socket,detail:r.cooler_socket,icon:l(ta,{className:"w-5 h-5"}),critical:!0},{id:"ram_cpu_speed",name:"RAM & CPU Speed",description:"Memory speed vs CPU support",status:e.ram_cpu_speed,detail:r.ram_cpu_speed,icon:l(ti,{className:"w-5 h-5"}),critical:!1}].filter(p=>p.status!==void 0),s=i.filter(p=>p.critical),o=i.filter(p=>!p.critical),c=p=>p===0?"text-gray-600":p>=90?"text-green-600":p>=70?"text-yellow-600":"text-red-600",u=p=>p===!0?l(yt,{className:"w-6 h-6 text-green-600"}):p===!1?l(Cn,{className:"w-6 h-6 text-red-600"}):l(mc,{className:"w-6 h-6 text-gray-400"}),d=p=>p===!0?"Compatible":p===!1?"Incompatible":"Not checked",f=p=>p===0?"bg-gray-400":p>=90?"bg-green-500":p>=70?"bg-yellow-500":"bg-red-500",h=s.filter(p=>p.status===!1).length;return m("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-6 mb-6",children:[m("div",{className:"mb-8",children:[m("div",{className:"flex items-center justify-between mb-6",children:[m("div",{className:"flex items-center gap-3",children:[l("div",{className:"p-2 bg-blue-100 rounded-lg",children:l(na,{className:"w-6 h-6 text-blue-600"})}),m("div",{children:[l("h3",{className:"text-2xl font-bold text-gray-900",children:"Compatibility Checker"}),l("p",{className:"text-sm text-gray-600",children:"Real-time compatibility validation for your PC build"})]})]}),h>0&&m("div",{className:"flex items-center gap-2 px-4 py-2 bg-red-50 border border-red-200 rounded-lg",children:[l(Cn,{className:"w-5 h-5 text-red-600"}),m("span",{className:"text-red-800 font-semibold",children:[h," Critical Issue",h>1?"s":""]})]})]}),m("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[m("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[m("div",{children:[m("div",{className:"flex items-center justify-between mb-2",children:[l("span",{className:"text-sm font-medium text-gray-700",children:"Component Selection"}),m("span",{className:"text-sm font-bold text-gray-900",children:[n,"%"]})]}),l("div",{className:"w-full bg-gray-200 rounded-full h-3",children:l("div",{className:`h-3 rounded-full transition-all duration-700 ${f(n)}`,style:{width:`${n}%`}})})]}),m("div",{children:[m("div",{className:"flex items-center justify-between mb-2",children:[l("span",{className:"text-sm font-medium text-gray-700",children:"Compatibility Score"}),m("span",{className:`text-sm font-bold ${c(t)}`,children:[t,"%"]})]}),l("div",{className:"w-full bg-gray-200 rounded-full h-3",children:l("div",{className:`h-3 rounded-full transition-all duration-700 ${f(t)}`,style:{width:`${t}%`}})})]})]}),l("div",{className:`p-3 rounded-lg border-l-4 ${n===0?"bg-blue-50 border-blue-400":t===100?"bg-green-50 border-green-400":h>0?"bg-red-50 border-red-400":"bg-yellow-50 border-yellow-400"}`,children:l("p",{className:`text-sm font-medium ${n===0?"text-blue-800":t===100?"text-green-800":h>0?"text-red-800":"text-yellow-800"}`,children:n===0?"Start building by selecting components from the categories above":n<100?`${7-Math.round(n/14.28)} more components needed to complete your build`:t===100?"Excellent! Your build is fully compatible and ready for assembly":t>0?`${t}% compatibility - ${h>0?"Fix critical issues below":"Minor optimizations available"}`:"Compatibility issues detected - review the checks below"})})]})]}),s.length>0&&m("div",{className:"mb-8",children:[m("div",{className:"flex items-center justify-between mb-6",children:[m("div",{className:"flex items-center gap-3",children:[l("div",{className:"p-2 bg-red-100 rounded-lg",children:l(na,{className:"w-5 h-5 text-red-600"})}),m("div",{children:[l("h4",{className:"text-xl font-bold text-gray-900",children:"Critical Compatibility Checks"}),l("p",{className:"text-sm text-gray-600",children:"These checks must pass for your build to work properly"})]})]}),m("div",{className:"text-right",children:[m("div",{className:"text-2xl font-bold text-gray-900",children:[s.filter(p=>p.status===!0).length,"/",s.length]}),l("div",{className:"text-sm text-gray-600",children:"Passed"})]})]}),l("div",{className:"grid gap-4",children:s.map(p=>l("div",{className:`p-5 rounded-xl border-2 transition-all duration-300 hover:shadow-md ${p.status===!0?"bg-green-50 border-green-200":p.status===!1?"bg-red-50 border-red-200":"bg-gray-50 border-gray-200"}`,children:m("div",{className:"flex items-start gap-4",children:[l("div",{className:`p-3 rounded-xl ${p.status===!0?"bg-green-100":p.status===!1?"bg-red-100":"bg-gray-100"}`,children:p.icon}),m("div",{className:"flex-1",children:[m("div",{className:"flex items-center justify-between mb-3",children:[l("h5",{className:"text-lg font-semibold text-gray-900",children:p.name}),m("div",{className:"flex items-center gap-2",children:[u(p.status),l("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${p.status===!0?"bg-green-100 text-green-800":p.status===!1?"bg-red-100 text-red-800":"bg-gray-100 text-gray-600"}`,children:d(p.status)})]})]}),l("p",{className:"text-gray-600 mb-3",children:p.description}),(p.status===!1||p.status===!0&&p.detail)&&p.detail&&l("div",{className:`p-3 rounded-lg border ${p.status===!1?"bg-red-50 border-red-200 text-red-800":"bg-blue-50 border-blue-200 text-blue-800"}`,children:m("div",{className:"flex items-start gap-2",children:[l($r,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),m("div",{className:"text-sm",children:[l("div",{className:"font-medium mb-1",children:p.status===!1?"Issue:":"Note:"}),l("div",{children:p.detail})]})]})})]})]})},p.id))})]}),o.length>0&&m("div",{className:"mb-8",children:[m("div",{className:"flex items-center justify-between mb-6",children:[m("div",{className:"flex items-center gap-3",children:[l("div",{className:"p-2 bg-blue-100 rounded-lg",children:l(mc,{className:"w-5 h-5 text-blue-600"})}),m("div",{children:[l("h4",{className:"text-xl font-bold text-gray-900",children:"Additional Optimizations"}),l("p",{className:"text-sm text-gray-600",children:"These checks improve performance and efficiency"})]})]}),m("div",{className:"text-right",children:[m("div",{className:"text-2xl font-bold text-gray-900",children:[o.filter(p=>p.status===!0).length,"/",o.length]}),l("div",{className:"text-sm text-gray-600",children:"Optimized"})]})]}),l("div",{className:"grid gap-4",children:o.map(p=>l("div",{className:`p-5 rounded-xl border-2 transition-all duration-300 hover:shadow-md ${p.status===!0?"bg-green-50 border-green-200":p.status===!1?"bg-yellow-50 border-yellow-200":"bg-gray-50 border-gray-200"}`,children:m("div",{className:"flex items-start gap-4",children:[l("div",{className:`p-3 rounded-xl ${p.status===!0?"bg-green-100":p.status===!1?"bg-yellow-100":"bg-gray-100"}`,children:p.icon}),m("div",{className:"flex-1",children:[m("div",{className:"flex items-center justify-between mb-3",children:[l("h5",{className:"text-lg font-semibold text-gray-900",children:p.name}),m("div",{className:"flex items-center gap-2",children:[u(p.status),l("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${p.status===!0?"bg-green-100 text-green-800":p.status===!1?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-600"}`,children:d(p.status)})]})]}),l("p",{className:"text-gray-600 mb-3",children:p.description}),(p.status===!1||p.status===!0&&p.detail)&&p.detail&&l("div",{className:`p-3 rounded-lg border ${p.status===!1?"bg-yellow-50 border-yellow-200 text-yellow-800":"bg-blue-50 border-blue-200 text-blue-800"}`,children:m("div",{className:"flex items-start gap-2",children:[l($r,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),m("div",{className:"text-sm",children:[l("div",{className:"font-medium mb-1",children:p.status===!1?"Recommendation:":"Note:"}),l("div",{children:p.detail})]})]})})]})]})},p.id))})]}),l("div",{className:"mb-8",children:l("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-200 p-6",children:m("div",{className:"flex items-start gap-4",children:[l("div",{className:"p-3 bg-blue-100 rounded-lg",children:l(qa,{className:"w-6 h-6 text-blue-600"})}),m("div",{className:"flex-1",children:[l("h4",{className:"text-lg font-semibold text-blue-900 mb-3",children:"Build Tips & Best Practices"}),m("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[m("div",{children:[l("h5",{className:"font-medium text-blue-800 mb-2",children:"Essential Checks"}),m("ul",{className:"text-sm text-blue-700 space-y-1",children:[l("li",{children:" CPU socket matches motherboard (AM4, AM5, LGA1200, LGA1700)"}),l("li",{children:" RAM type compatibility (DDR4/DDR5) and speed support"}),l("li",{children:" PSU wattage with 20% buffer for efficiency"}),l("li",{children:" Case supports motherboard form factor"})]})]}),m("div",{children:[l("h5",{className:"font-medium text-blue-800 mb-2",children:"Performance Tips"}),m("ul",{className:"text-sm text-blue-700 space-y-1",children:[l("li",{children:" Check GPU length and CPU cooler height clearance"}),l("li",{children:" Consider aftermarket cooler for better performance"}),l("li",{children:" Match RAM speed to CPU and motherboard support"}),l("li",{children:" Ensure adequate case airflow and cooling"})]})]})]})]})]})})}),t===100&&l("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl border-2 border-green-200 p-6",children:m("div",{className:"flex items-center gap-4",children:[l("div",{className:"p-3 bg-green-100 rounded-full",children:l(yt,{className:"w-8 h-8 text-green-600"})}),m("div",{className:"flex-1",children:[l("h4",{className:"text-xl font-bold text-green-900 mb-2",children:"Perfect Build Ready!"}),l("p",{className:"text-green-800 mb-3",children:"All components are fully compatible and your PC is ready for assembly."}),m("div",{className:"flex items-center gap-4 text-sm text-green-700",children:[m("span",{className:"flex items-center gap-1",children:[l(yt,{className:"w-4 h-4"}),"All critical checks passed"]}),m("span",{className:"flex items-center gap-1",children:[l(yt,{className:"w-4 h-4"}),"Build ready for assembly"]})]})]})]})}),t>0&&t<100&&h===0&&l("div",{className:"bg-gradient-to-r from-yellow-50 to-amber-50 rounded-xl border-2 border-yellow-200 p-6",children:m("div",{className:"flex items-center gap-4",children:[l("div",{className:"p-3 bg-yellow-100 rounded-full",children:l($r,{className:"w-8 h-8 text-yellow-600"})}),m("div",{className:"flex-1",children:[l("h4",{className:"text-xl font-bold text-yellow-900 mb-2",children:"Good Build with Optimizations Available"}),l("p",{className:"text-yellow-800 mb-3",children:"Your build will work well, but consider the optimization recommendations above for better performance."}),m("div",{className:"flex items-center gap-4 text-sm text-yellow-700",children:[m("span",{className:"flex items-center gap-1",children:[l(yt,{className:"w-4 h-4"}),"All critical checks passed"]}),m("span",{className:"flex items-center gap-1",children:[l($r,{className:"w-4 h-4"}),"Minor optimizations available"]})]})]})]})}),h>0&&l("div",{className:"bg-gradient-to-r from-red-50 to-rose-50 rounded-xl border-2 border-red-200 p-6",children:m("div",{className:"flex items-center gap-4",children:[l("div",{className:"p-3 bg-red-100 rounded-full",children:l(Cn,{className:"w-8 h-8 text-red-600"})}),m("div",{className:"flex-1",children:[l("h4",{className:"text-xl font-bold text-red-900 mb-2",children:"Critical Issues Must Be Fixed"}),m("p",{className:"text-red-800 mb-3",children:[h," critical compatibility issue",h>1?"s":""," detected. Your build will not work properly until these issues are resolved."]}),m("div",{className:"flex items-center gap-4 text-sm text-red-700",children:[m("span",{className:"flex items-center gap-1",children:[l(Cn,{className:"w-4 h-4"}),h," critical issue",h>1?"s":""," found"]}),m("span",{className:"flex items-center gap-1",children:[l($r,{className:"w-4 h-4"}),"Build not ready for assembly"]})]})]})]})}),t===0&&Object.keys(e).length===0&&l("div",{className:"bg-gradient-to-r from-gray-50 to-slate-50 rounded-xl border-2 border-gray-200 p-6",children:m("div",{className:"flex items-center gap-4",children:[l("div",{className:"p-3 bg-gray-100 rounded-full",children:l(mc,{className:"w-8 h-8 text-gray-600"})}),m("div",{className:"flex-1",children:[l("h4",{className:"text-xl font-bold text-gray-900 mb-2",children:"Start Building Your PC"}),l("p",{className:"text-gray-800 mb-3",children:"Select components from the categories above to begin checking compatibility and building your perfect PC."}),m("div",{className:"flex items-center gap-4 text-sm text-gray-700",children:[m("span",{className:"flex items-center gap-1",children:[l(mc,{className:"w-4 h-4"}),"No components selected yet"]}),m("span",{className:"flex items-center gap-1",children:[l(Hi,{className:"w-4 h-4"}),"Choose components to start"]})]})]})]})})]})},cL=({isOpen:e,onClose:t,selectedComponents:r,currentCategory:n,allComponents:a=[],onComponentSelect:i})=>{const[s,o]=N.useState("compatible"),[c,u]=N.useState(!1),[d,f]=N.useState(""),[h,p]=N.useState("name"),[x,g]=N.useState({compatible:[],incompatible:[]}),y=[{id:"cpu",name:"CPU",icon:ua,description:"Brain of your PC"},{id:"motherboard",name:"Motherboard",icon:up,description:"Connects everything"},{id:"gpu",name:"Graphics Card",icon:Ki,description:"Handles graphics"},{id:"ram",name:"RAM",icon:ti,description:"System memory"},{id:"storage",name:"Storage",icon:au,description:"Data storage"},{id:"psu",name:"Power Supply",icon:Ta,description:"Powers everything"},{id:"case",name:"Case",icon:Ye,description:"Houses components"},{id:"cooler",name:"Cooler",icon:ta,description:"Keeps it cool"}];N.useEffect(()=>{if(a.length>0){const k=[],_=[];a.forEach(A=>{const T=v(A);T.compatible?k.push({...A,compatibility:T}):_.push({...A,compatibility:T})});const E=A=>d?A.filter(T=>{var R,D;return((R=T.name)==null?void 0:R.toLowerCase().includes(d.toLowerCase()))||((D=T.brand)==null?void 0:D.toLowerCase().includes(d.toLowerCase()))}):A,P=A=>[...A].sort((T,R)=>{switch(h){case"price":return(T.price||0)-(R.price||0);case"name":return(T.name||"").localeCompare(R.name||"");case"brand":return(T.brand||"").localeCompare(R.brand||"");default:return 0}});g({compatible:P(E(k)),incompatible:P(E(_))})}},[a,d,h,r,n]);const v=k=>{const _=[];let E=!0;switch(n){case"motherboard":if(r.cpu){const A=Kl(r.cpu,k,"cpu_motherboard");A.compatible||(_.push(A.reason),E=!1)}break;case"ram":if(r.motherboard){const A=Kl(k,r.motherboard,"ram_motherboard");A.compatible||(_.push(A.reason),E=!1)}break;case"case":if(r.motherboard){const A=Kl(k,r.motherboard,"case_motherboard");A.compatible||(_.push(A.reason),E=!1)}break;case"psu":const P=Kl(k,r,"psu_power");P.compatible||(_.push(P.reason),E=!1);break;case"gpu":if(r.case){const A=Kl(k,r.case,"gpu_case");A.compatible||(_.push(A.reason),E=!1)}break;case"cooler":if(r.case){const A=Kl(k,r.case,"cooler_case");A.compatible||(_.push(A.reason),E=!1)}break}return{compatible:E,issues:_,reason:_.length>0?_.join("; "):"Compatible with current selections"}},w=k=>{if(!k.compatibility)return null;const _=[];if(n==="cpu"||n==="motherboard"){const E=Ze(k,"socket");E&&_.push({label:"Socket",value:E})}if(n==="ram"||n==="motherboard"){const E=Ze(k,"ram_type");E&&_.push({label:"RAM Type",value:E})}if(n==="case"||n==="motherboard"){const E=Ze(k,"form_factor");E&&_.push({label:"Form Factor",value:E})}if(n==="psu"){const E=Ze(k,"wattage");E&&_.push({label:"Wattage",value:`${E}W`})}if(n==="gpu"){const E=Ze(k,"length");E&&_.push({label:"Length",value:`${E}mm`})}if(n==="cooler"){const E=Ze(k,"height");E&&_.push({label:"Height",value:`${E}mm`})}return _},b=(k,_)=>{var A,T,R;const E=w(k),P=((A=r[n])==null?void 0:A.id)===k.id;return m("div",{className:`bg-white rounded-lg border-2 p-4 transition-all duration-200 hover:shadow-lg ${P?"border-green-500 bg-green-50":_?"border-gray-200 hover:border-green-300":"border-red-200 bg-red-50"}`,children:[l("div",{className:"flex justify-center mb-4",children:l("img",{src:ri(k,n),alt:k.name,className:"w-20 h-20 object-contain",onError:D=>{D.target.src="/images/components/default.png"}})}),m("div",{className:"text-center mb-4",children:[l("h3",{className:"font-semibold text-gray-900 text-sm mb-1 line-clamp-2",children:k.name}),k.brand&&m("p",{className:"text-gray-600 text-xs mb-2",children:[k.brand,k.model?`  ${k.model}`:""]}),k.price!==void 0&&k.price!==null&&m("p",{className:"text-green-600 font-bold text-lg",children:["",k.price.toLocaleString()]})]}),E&&E.length>0&&l("div",{className:"mb-4 space-y-2",children:E.map((D,L)=>m("div",{className:"flex justify-between text-xs",children:[m("span",{className:"text-gray-600",children:[D.label,":"]}),l("span",{className:"font-medium text-gray-900",children:D.value})]},L))}),m("div",{className:"mb-4 p-3 rounded-lg bg-gray-50",children:[m("div",{className:"flex items-center justify-between mb-2",children:[l("span",{className:"text-xs font-medium text-gray-700",children:"Status:"}),_?l(yt,{className:"w-4 h-4 text-green-500"}):l(Cn,{className:"w-4 h-4 text-red-500"})]}),l("p",{className:"text-xs text-gray-600",children:((T=k.compatibility)==null?void 0:T.reason)||"Compatibility unknown"}),((R=k.compatibility)==null?void 0:R.issues)&&k.compatibility.issues.length>0&&m("div",{className:"mt-2",children:[l("p",{className:"text-xs font-medium text-red-600 mb-1",children:"Issues:"}),l("ul",{className:"text-xs text-red-600 space-y-1",children:k.compatibility.issues.map((D,L)=>m("li",{className:"flex items-start",children:[l(Cn,{className:"w-3 h-3 mr-1 mt-0.5 flex-shrink-0"}),D]},L))})]})]}),l("button",{onClick:()=>{_&&(i(n,k),t())},disabled:!_,className:`w-full py-2 px-3 rounded-lg text-sm font-medium transition-colors ${_?"bg-green-500 text-white hover:bg-green-600":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:_?"Select Component":"Incompatible"})]},k.id)};if(!e)return null;const S=y.find(k=>k.id===n);return l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:m("div",{className:"bg-white rounded-xl max-w-6xl w-full max-h-[90vh] overflow-hidden",children:[m("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[l("div",{className:"flex items-center gap-3",children:S&&m(lt,{children:[l(S.icon,{className:"w-8 h-8 text-green-600"}),m("div",{children:[m("h2",{className:"text-2xl font-bold text-gray-900",children:[S.name," Compatibility Comparison"]}),l("p",{className:"text-sm text-gray-600",children:"Compare compatible and incompatible components"})]})]})}),l("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:l(Gn,{className:"w-6 h-6 text-gray-500"})})]}),l("div",{className:"p-6 border-b border-gray-200",children:m("div",{className:"flex flex-col sm:flex-row gap-4",children:[m("div",{className:"flex-1 relative",children:[l(Wi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),l("input",{type:"text",placeholder:"Search components...",value:d,onChange:k=>f(k.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),m("select",{value:h,onChange:k=>p(k.target.value),className:"px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[l("option",{value:"name",children:"Sort by Name"}),l("option",{value:"price",children:"Sort by Price"}),l("option",{value:"brand",children:"Sort by Brand"})]}),m("div",{className:"flex items-center gap-2 ml-auto",children:[l("input",{id:"toggle-incompatible",type:"checkbox",checked:c,onChange:k=>u(k.target.checked)}),l("label",{htmlFor:"toggle-incompatible",className:"text-sm text-gray-700 select-none",children:"Show Incompatible"})]})]})}),m("div",{className:"flex-1 overflow-hidden",children:[m("div",{className:"flex border-b border-gray-200",children:[l("button",{onClick:()=>o("compatible"),className:`flex-1 py-4 px-6 text-sm font-medium transition-colors ${s==="compatible"?"text-green-600 border-b-2 border-green-500 bg-green-50":"text-gray-500 hover:text-gray-700"}`,children:m("div",{className:"flex items-center justify-center gap-2",children:[l(yt,{className:"w-5 h-5"}),"Compatible (",x.compatible.length,")"]})}),l("button",{onClick:()=>o("incompatible"),className:`flex-1 py-4 px-6 text-sm font-medium transition-colors ${s==="incompatible"?"text-red-600 border-b-2 border-red-500 bg-red-50":"text-gray-500 hover:text-gray-700"}`,children:m("div",{className:"flex items-center justify-center gap-2",children:[l(Cn,{className:"w-5 h-5"}),"Incompatible (",x.incompatible.length,")"]})})]}),l("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:s==="compatible"?x.compatible.length>0?l("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:x.compatible.map(k=>b(k,!0))}):m("div",{className:"text-center py-12",children:[l(yt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Compatible Components"}),l("p",{className:"text-gray-600",children:d?"Try adjusting your search terms.":"No compatible components found for your current selections."})]}):c?x.incompatible.length>0?l("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:x.incompatible.map(k=>b(k,!1))}):m("div",{className:"text-center py-12",children:[l(Cn,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Incompatible Components"}),l("p",{className:"text-gray-600",children:d?"Try adjusting your search terms.":"All components are compatible with your current selections."})]}):m("div",{className:"text-center py-12",children:[l(Cn,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Show Incompatible"}),l("p",{className:"text-gray-600",children:'Toggle "Show Incompatible" to view incompatible options'})]})})]}),l("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:m("div",{className:"flex items-center justify-between",children:[m("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[l(na,{className:"w-4 h-4"}),l("span",{children:"Compatibility is checked against your current component selections"})]}),l("button",{onClick:t,className:"px-6 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"Close"})]})})]})})};function FT(e,t){return function(){return e.apply(t,arguments)}}const{toString:uL}=Object.prototype,{getPrototypeOf:fb}=Object,{iterator:fp,toStringTag:LT}=Symbol,mp=(e=>t=>{const r=uL.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Pi=e=>(e=e.toLowerCase(),t=>mp(t)===e),hp=e=>t=>typeof t===e,{isArray:su}=Array,jc=hp("undefined");function Nf(e){return e!==null&&!jc(e)&&e.constructor!==null&&!jc(e.constructor)&&la(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const BT=Pi("ArrayBuffer");function dL(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&BT(e.buffer),t}const fL=hp("string"),la=hp("function"),jT=hp("number"),Sf=e=>e!==null&&typeof e=="object",mL=e=>e===!0||e===!1,lm=e=>{if(mp(e)!=="object")return!1;const t=fb(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(LT in e)&&!(fp in e)},hL=e=>{if(!Sf(e)||Nf(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},pL=Pi("Date"),gL=Pi("File"),xL=Pi("Blob"),vL=Pi("FileList"),yL=e=>Sf(e)&&la(e.pipe),bL=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||la(e.append)&&((t=mp(e))==="formdata"||t==="object"&&la(e.toString)&&e.toString()==="[object FormData]"))},wL=Pi("URLSearchParams"),[NL,SL,kL,_L]=["ReadableStream","Request","Response","Headers"].map(Pi),EL=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function kf(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),su(e))for(n=0,a=e.length;n<a;n++)t.call(null,e[n],n,e);else{if(Nf(e))return;const i=r?Object.getOwnPropertyNames(e):Object.keys(e),s=i.length;let o;for(n=0;n<s;n++)o=i[n],t.call(null,e[o],o,e)}}function $T(e,t){if(Nf(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,a;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const qo=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),UT=e=>!jc(e)&&e!==qo;function Xv(){const{caseless:e,skipUndefined:t}=UT(this)&&this||{},r={},n=(a,i)=>{const s=e&&$T(r,i)||i;lm(r[s])&&lm(a)?r[s]=Xv(r[s],a):lm(a)?r[s]=Xv({},a):su(a)?r[s]=a.slice():(!t||!jc(a))&&(r[s]=a)};for(let a=0,i=arguments.length;a<i;a++)arguments[a]&&kf(arguments[a],n);return r}const CL=(e,t,r,{allOwnKeys:n}={})=>(kf(t,(a,i)=>{r&&la(a)?e[i]=FT(a,r):e[i]=a},{allOwnKeys:n}),e),AL=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),TL=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},PL=(e,t,r,n)=>{let a,i,s;const o={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),i=a.length;i-- >0;)s=a[i],(!n||n(s,e,t))&&!o[s]&&(t[s]=e[s],o[s]=!0);e=r!==!1&&fb(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},OL=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},DL=e=>{if(!e)return null;if(su(e))return e;let t=e.length;if(!jT(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},RL=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&fb(Uint8Array)),ML=(e,t)=>{const n=(e&&e[fp]).call(e);let a;for(;(a=n.next())&&!a.done;){const i=a.value;t.call(e,i[0],i[1])}},IL=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},FL=Pi("HTMLFormElement"),LL=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),HS=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),BL=Pi("RegExp"),zT=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};kf(r,(a,i)=>{let s;(s=t(a,i,e))!==!1&&(n[i]=s||a)}),Object.defineProperties(e,n)},jL=e=>{zT(e,(t,r)=>{if(la(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(la(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},$L=(e,t)=>{const r={},n=a=>{a.forEach(i=>{r[i]=!0})};return su(e)?n(e):n(String(e).split(t)),r},UL=()=>{},zL=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function HL(e){return!!(e&&la(e.append)&&e[LT]==="FormData"&&e[fp])}const WL=e=>{const t=new Array(10),r=(n,a)=>{if(Sf(n)){if(t.indexOf(n)>=0)return;if(Nf(n))return n;if(!("toJSON"in n)){t[a]=n;const i=su(n)?[]:{};return kf(n,(s,o)=>{const c=r(s,a+1);!jc(c)&&(i[o]=c)}),t[a]=void 0,i}}return n};return r(e,0)},GL=Pi("AsyncFunction"),VL=e=>e&&(Sf(e)||la(e))&&la(e.then)&&la(e.catch),HT=((e,t)=>e?setImmediate:t?((r,n)=>(qo.addEventListener("message",({source:a,data:i})=>{a===qo&&i===r&&n.length&&n.shift()()},!1),a=>{n.push(a),qo.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",la(qo.postMessage)),KL=typeof queueMicrotask<"u"?queueMicrotask.bind(qo):typeof process<"u"&&process.nextTick||HT,XL=e=>e!=null&&la(e[fp]),pe={isArray:su,isArrayBuffer:BT,isBuffer:Nf,isFormData:bL,isArrayBufferView:dL,isString:fL,isNumber:jT,isBoolean:mL,isObject:Sf,isPlainObject:lm,isEmptyObject:hL,isReadableStream:NL,isRequest:SL,isResponse:kL,isHeaders:_L,isUndefined:jc,isDate:pL,isFile:gL,isBlob:xL,isRegExp:BL,isFunction:la,isStream:yL,isURLSearchParams:wL,isTypedArray:RL,isFileList:vL,forEach:kf,merge:Xv,extend:CL,trim:EL,stripBOM:AL,inherits:TL,toFlatObject:PL,kindOf:mp,kindOfTest:Pi,endsWith:OL,toArray:DL,forEachEntry:ML,matchAll:IL,isHTMLForm:FL,hasOwnProperty:HS,hasOwnProp:HS,reduceDescriptors:zT,freezeMethods:jL,toObjectSet:$L,toCamelCase:LL,noop:UL,toFiniteNumber:zL,findKey:$T,global:qo,isContextDefined:UT,isSpecCompliantForm:HL,toJSONObject:WL,isAsyncFn:GL,isThenable:VL,setImmediate:HT,asap:KL,isIterable:XL};function pt(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}pe.inherits(pt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:pe.toJSONObject(this.config),code:this.code,status:this.status}}});const WT=pt.prototype,GT={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{GT[e]={value:e}});Object.defineProperties(pt,GT);Object.defineProperty(WT,"isAxiosError",{value:!0});pt.from=(e,t,r,n,a,i)=>{const s=Object.create(WT);pe.toFlatObject(e,s,function(d){return d!==Error.prototype},u=>u!=="isAxiosError");const o=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return pt.call(s,o,c,r,n,a),e&&s.cause==null&&Object.defineProperty(s,"cause",{value:e,configurable:!0}),s.name=e&&e.name||"Error",i&&Object.assign(s,i),s};const qL=null;function qv(e){return pe.isPlainObject(e)||pe.isArray(e)}function VT(e){return pe.endsWith(e,"[]")?e.slice(0,-2):e}function WS(e,t,r){return e?e.concat(t).map(function(a,i){return a=VT(a),!r&&i?"["+a+"]":a}).join(r?".":""):t}function YL(e){return pe.isArray(e)&&!e.some(qv)}const JL=pe.toFlatObject(pe,{},null,function(t){return/^is[A-Z]/.test(t)});function pp(e,t,r){if(!pe.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=pe.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,y){return!pe.isUndefined(y[g])});const n=r.metaTokens,a=r.visitor||d,i=r.dots,s=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&pe.isSpecCompliantForm(t);if(!pe.isFunction(a))throw new TypeError("visitor must be a function");function u(x){if(x===null)return"";if(pe.isDate(x))return x.toISOString();if(pe.isBoolean(x))return x.toString();if(!c&&pe.isBlob(x))throw new pt("Blob is not supported. Use a Buffer instead.");return pe.isArrayBuffer(x)||pe.isTypedArray(x)?c&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function d(x,g,y){let v=x;if(x&&!y&&typeof x=="object"){if(pe.endsWith(g,"{}"))g=n?g:g.slice(0,-2),x=JSON.stringify(x);else if(pe.isArray(x)&&YL(x)||(pe.isFileList(x)||pe.endsWith(g,"[]"))&&(v=pe.toArray(x)))return g=VT(g),v.forEach(function(b,S){!(pe.isUndefined(b)||b===null)&&t.append(s===!0?WS([g],S,i):s===null?g:g+"[]",u(b))}),!1}return qv(x)?!0:(t.append(WS(y,g,i),u(x)),!1)}const f=[],h=Object.assign(JL,{defaultVisitor:d,convertValue:u,isVisitable:qv});function p(x,g){if(!pe.isUndefined(x)){if(f.indexOf(x)!==-1)throw Error("Circular reference detected in "+g.join("."));f.push(x),pe.forEach(x,function(v,w){(!(pe.isUndefined(v)||v===null)&&a.call(t,v,pe.isString(w)?w.trim():w,g,h))===!0&&p(v,g?g.concat(w):[w])}),f.pop()}}if(!pe.isObject(e))throw new TypeError("data must be an object");return p(e),t}function GS(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function mb(e,t){this._pairs=[],e&&pp(e,this,t)}const KT=mb.prototype;KT.append=function(t,r){this._pairs.push([t,r])};KT.toString=function(t){const r=t?function(n){return t.call(this,n,GS)}:GS;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function QL(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function XT(e,t,r){if(!t)return e;const n=r&&r.encode||QL;pe.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let i;if(a?i=a(t,r):i=pe.isURLSearchParams(t)?t.toString():new mb(t,r).toString(n),i){const s=e.indexOf("#");s!==-1&&(e=e.slice(0,s)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class ZL{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){pe.forEach(this.handlers,function(n){n!==null&&t(n)})}}const VS=ZL,qT={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},eB=typeof URLSearchParams<"u"?URLSearchParams:mb,tB=typeof FormData<"u"?FormData:null,rB=typeof Blob<"u"?Blob:null,nB={isBrowser:!0,classes:{URLSearchParams:eB,FormData:tB,Blob:rB},protocols:["http","https","file","blob","url","data"]},hb=typeof window<"u"&&typeof document<"u",Yv=typeof navigator=="object"&&navigator||void 0,aB=hb&&(!Yv||["ReactNative","NativeScript","NS"].indexOf(Yv.product)<0),iB=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),sB=hb&&window.location.href||"http://localhost",oB=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:hb,hasStandardBrowserEnv:aB,hasStandardBrowserWebWorkerEnv:iB,navigator:Yv,origin:sB},Symbol.toStringTag,{value:"Module"})),An={...oB,...nB};function lB(e,t){return pp(e,new An.classes.URLSearchParams,{visitor:function(r,n,a,i){return An.isNode&&pe.isBuffer(r)?(this.append(n,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function cB(e){return pe.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function uB(e){const t={},r=Object.keys(e);let n;const a=r.length;let i;for(n=0;n<a;n++)i=r[n],t[i]=e[i];return t}function YT(e){function t(r,n,a,i){let s=r[i++];if(s==="__proto__")return!0;const o=Number.isFinite(+s),c=i>=r.length;return s=!s&&pe.isArray(a)?a.length:s,c?(pe.hasOwnProp(a,s)?a[s]=[a[s],n]:a[s]=n,!o):((!a[s]||!pe.isObject(a[s]))&&(a[s]=[]),t(r,n,a[s],i)&&pe.isArray(a[s])&&(a[s]=uB(a[s])),!o)}if(pe.isFormData(e)&&pe.isFunction(e.entries)){const r={};return pe.forEachEntry(e,(n,a)=>{t(cB(n),a,r,0)}),r}return null}function dB(e,t,r){if(pe.isString(e))try{return(t||JSON.parse)(e),pe.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const pb={transitional:qT,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,i=pe.isObject(t);if(i&&pe.isHTMLForm(t)&&(t=new FormData(t)),pe.isFormData(t))return a?JSON.stringify(YT(t)):t;if(pe.isArrayBuffer(t)||pe.isBuffer(t)||pe.isStream(t)||pe.isFile(t)||pe.isBlob(t)||pe.isReadableStream(t))return t;if(pe.isArrayBufferView(t))return t.buffer;if(pe.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return lB(t,this.formSerializer).toString();if((o=pe.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return pp(o?{"files[]":t}:t,c&&new c,this.formSerializer)}}return i||a?(r.setContentType("application/json",!1),dB(t)):t}],transformResponse:[function(t){const r=this.transitional||pb.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(pe.isResponse(t)||pe.isReadableStream(t))return t;if(t&&pe.isString(t)&&(n&&!this.responseType||a)){const s=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t,this.parseReviver)}catch(o){if(s)throw o.name==="SyntaxError"?pt.from(o,pt.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:An.classes.FormData,Blob:An.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};pe.forEach(["delete","get","head","post","put","patch"],e=>{pb.headers[e]={}});const gb=pb,fB=pe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),mB=e=>{const t={};let r,n,a;return e&&e.split(`
`).forEach(function(s){a=s.indexOf(":"),r=s.substring(0,a).trim().toLowerCase(),n=s.substring(a+1).trim(),!(!r||t[r]&&fB[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},KS=Symbol("internals");function Lu(e){return e&&String(e).trim().toLowerCase()}function cm(e){return e===!1||e==null?e:pe.isArray(e)?e.map(cm):String(e)}function hB(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const pB=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function ix(e,t,r,n,a){if(pe.isFunction(n))return n.call(this,t,r);if(a&&(t=r),!!pe.isString(t)){if(pe.isString(n))return t.indexOf(n)!==-1;if(pe.isRegExp(n))return n.test(t)}}function gB(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function xB(e,t){const r=pe.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(a,i,s){return this[n].call(this,t,a,i,s)},configurable:!0})})}class gp{constructor(t){t&&this.set(t)}set(t,r,n){const a=this;function i(o,c,u){const d=Lu(c);if(!d)throw new Error("header name must be a non-empty string");const f=pe.findKey(a,d);(!f||a[f]===void 0||u===!0||u===void 0&&a[f]!==!1)&&(a[f||c]=cm(o))}const s=(o,c)=>pe.forEach(o,(u,d)=>i(u,d,c));if(pe.isPlainObject(t)||t instanceof this.constructor)s(t,r);else if(pe.isString(t)&&(t=t.trim())&&!pB(t))s(mB(t),r);else if(pe.isObject(t)&&pe.isIterable(t)){let o={},c,u;for(const d of t){if(!pe.isArray(d))throw TypeError("Object iterator must return a key-value pair");o[u=d[0]]=(c=o[u])?pe.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}s(o,r)}else t!=null&&i(r,t,n);return this}get(t,r){if(t=Lu(t),t){const n=pe.findKey(this,t);if(n){const a=this[n];if(!r)return a;if(r===!0)return hB(a);if(pe.isFunction(r))return r.call(this,a,n);if(pe.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Lu(t),t){const n=pe.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||ix(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let a=!1;function i(s){if(s=Lu(s),s){const o=pe.findKey(n,s);o&&(!r||ix(n,n[o],o,r))&&(delete n[o],a=!0)}}return pe.isArray(t)?t.forEach(i):i(t),a}clear(t){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const i=r[n];(!t||ix(this,this[i],i,t,!0))&&(delete this[i],a=!0)}return a}normalize(t){const r=this,n={};return pe.forEach(this,(a,i)=>{const s=pe.findKey(n,i);if(s){r[s]=cm(a),delete r[i];return}const o=t?gB(i):String(i).trim();o!==i&&delete r[i],r[o]=cm(a),n[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return pe.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=t&&pe.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(a=>n.set(a)),n}static accessor(t){const n=(this[KS]=this[KS]={accessors:{}}).accessors,a=this.prototype;function i(s){const o=Lu(s);n[o]||(xB(a,s),n[o]=!0)}return pe.isArray(t)?t.forEach(i):i(t),this}}gp.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);pe.reduceDescriptors(gp.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});pe.freezeMethods(gp);const Ei=gp;function sx(e,t){const r=this||gb,n=t||r,a=Ei.from(n.headers);let i=n.data;return pe.forEach(e,function(o){i=o.call(r,i,a.normalize(),t?t.status:void 0)}),a.normalize(),i}function JT(e){return!!(e&&e.__CANCEL__)}function ou(e,t,r){pt.call(this,e??"canceled",pt.ERR_CANCELED,t,r),this.name="CanceledError"}pe.inherits(ou,pt,{__CANCEL__:!0});function QT(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new pt("Request failed with status code "+r.status,[pt.ERR_BAD_REQUEST,pt.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function vB(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function yB(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a=0,i=0,s;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),d=n[i];s||(s=u),r[a]=c,n[a]=u;let f=i,h=0;for(;f!==a;)h+=r[f++],f=f%e;if(a=(a+1)%e,a===i&&(i=(i+1)%e),u-s<t)return;const p=d&&u-d;return p?Math.round(h*1e3/p):void 0}}function bB(e,t){let r=0,n=1e3/t,a,i;const s=(u,d=Date.now())=>{r=d,a=null,i&&(clearTimeout(i),i=null),e(...u)};return[(...u)=>{const d=Date.now(),f=d-r;f>=n?s(u,d):(a=u,i||(i=setTimeout(()=>{i=null,s(a)},n-f)))},()=>a&&s(a)]}const Wm=(e,t,r=3)=>{let n=0;const a=yB(50,250);return bB(i=>{const s=i.loaded,o=i.lengthComputable?i.total:void 0,c=s-n,u=a(c),d=s<=o;n=s;const f={loaded:s,total:o,progress:o?s/o:void 0,bytes:c,rate:u||void 0,estimated:u&&o&&d?(o-s)/u:void 0,event:i,lengthComputable:o!=null,[t?"download":"upload"]:!0};e(f)},r)},XS=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},qS=e=>(...t)=>pe.asap(()=>e(...t)),wB=An.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,An.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(An.origin),An.navigator&&/(msie|trident)/i.test(An.navigator.userAgent)):()=>!0,NB=An.hasStandardBrowserEnv?{write(e,t,r,n,a,i){const s=[e+"="+encodeURIComponent(t)];pe.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),pe.isString(n)&&s.push("path="+n),pe.isString(a)&&s.push("domain="+a),i===!0&&s.push("secure"),document.cookie=s.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function SB(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function kB(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function ZT(e,t,r){let n=!SB(t);return e&&(n||r==!1)?kB(e,t):t}const YS=e=>e instanceof Ei?{...e}:e;function pl(e,t){t=t||{};const r={};function n(u,d,f,h){return pe.isPlainObject(u)&&pe.isPlainObject(d)?pe.merge.call({caseless:h},u,d):pe.isPlainObject(d)?pe.merge({},d):pe.isArray(d)?d.slice():d}function a(u,d,f,h){if(pe.isUndefined(d)){if(!pe.isUndefined(u))return n(void 0,u,f,h)}else return n(u,d,f,h)}function i(u,d){if(!pe.isUndefined(d))return n(void 0,d)}function s(u,d){if(pe.isUndefined(d)){if(!pe.isUndefined(u))return n(void 0,u)}else return n(void 0,d)}function o(u,d,f){if(f in t)return n(u,d);if(f in e)return n(void 0,u)}const c={url:i,method:i,data:i,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:o,headers:(u,d,f)=>a(YS(u),YS(d),f,!0)};return pe.forEach(Object.keys({...e,...t}),function(d){const f=c[d]||a,h=f(e[d],t[d],d);pe.isUndefined(h)&&f!==o||(r[d]=h)}),r}const e3=e=>{const t=pl({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:i,headers:s,auth:o}=t;if(t.headers=s=Ei.from(s),t.url=XT(ZT(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&s.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),pe.isFormData(r)){if(An.hasStandardBrowserEnv||An.hasStandardBrowserWebWorkerEnv)s.setContentType(void 0);else if(pe.isFunction(r.getHeaders)){const c=r.getHeaders(),u=["content-type","content-length"];Object.entries(c).forEach(([d,f])=>{u.includes(d.toLowerCase())&&s.set(d,f)})}}if(An.hasStandardBrowserEnv&&(n&&pe.isFunction(n)&&(n=n(t)),n||n!==!1&&wB(t.url))){const c=a&&i&&NB.read(i);c&&s.set(a,c)}return t},_B=typeof XMLHttpRequest<"u",EB=_B&&function(e){return new Promise(function(r,n){const a=e3(e);let i=a.data;const s=Ei.from(a.headers).normalize();let{responseType:o,onUploadProgress:c,onDownloadProgress:u}=a,d,f,h,p,x;function g(){p&&p(),x&&x(),a.cancelToken&&a.cancelToken.unsubscribe(d),a.signal&&a.signal.removeEventListener("abort",d)}let y=new XMLHttpRequest;y.open(a.method.toUpperCase(),a.url,!0),y.timeout=a.timeout;function v(){if(!y)return;const b=Ei.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),k={data:!o||o==="text"||o==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:b,config:e,request:y};QT(function(E){r(E),g()},function(E){n(E),g()},k),y=null}"onloadend"in y?y.onloadend=v:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(v)},y.onabort=function(){y&&(n(new pt("Request aborted",pt.ECONNABORTED,e,y)),y=null)},y.onerror=function(S){const k=S&&S.message?S.message:"Network Error",_=new pt(k,pt.ERR_NETWORK,e,y);_.event=S||null,n(_),y=null},y.ontimeout=function(){let S=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const k=a.transitional||qT;a.timeoutErrorMessage&&(S=a.timeoutErrorMessage),n(new pt(S,k.clarifyTimeoutError?pt.ETIMEDOUT:pt.ECONNABORTED,e,y)),y=null},i===void 0&&s.setContentType(null),"setRequestHeader"in y&&pe.forEach(s.toJSON(),function(S,k){y.setRequestHeader(k,S)}),pe.isUndefined(a.withCredentials)||(y.withCredentials=!!a.withCredentials),o&&o!=="json"&&(y.responseType=a.responseType),u&&([h,x]=Wm(u,!0),y.addEventListener("progress",h)),c&&y.upload&&([f,p]=Wm(c),y.upload.addEventListener("progress",f),y.upload.addEventListener("loadend",p)),(a.cancelToken||a.signal)&&(d=b=>{y&&(n(!b||b.type?new ou(null,e,y):b),y.abort(),y=null)},a.cancelToken&&a.cancelToken.subscribe(d),a.signal&&(a.signal.aborted?d():a.signal.addEventListener("abort",d)));const w=vB(a.url);if(w&&An.protocols.indexOf(w)===-1){n(new pt("Unsupported protocol "+w+":",pt.ERR_BAD_REQUEST,e));return}y.send(i||null)})},CB=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,a;const i=function(u){if(!a){a=!0,o();const d=u instanceof Error?u:this.reason;n.abort(d instanceof pt?d:new ou(d instanceof Error?d.message:d))}};let s=t&&setTimeout(()=>{s=null,i(new pt(`timeout ${t} of ms exceeded`,pt.ETIMEDOUT))},t);const o=()=>{e&&(s&&clearTimeout(s),s=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(i):u.removeEventListener("abort",i)}),e=null)};e.forEach(u=>u.addEventListener("abort",i));const{signal:c}=n;return c.unsubscribe=()=>pe.asap(o),c}},AB=CB,TB=function*(e,t){let r=e.byteLength;if(!t||r<t){yield e;return}let n=0,a;for(;n<r;)a=n+t,yield e.slice(n,a),n=a},PB=async function*(e,t){for await(const r of OB(e))yield*TB(r,t)},OB=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},JS=(e,t,r,n)=>{const a=PB(e,t);let i=0,s,o=c=>{s||(s=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await a.next();if(u){o(),c.close();return}let f=d.byteLength;if(r){let h=i+=f;r(h)}c.enqueue(new Uint8Array(d))}catch(u){throw o(u),u}},cancel(c){return o(c),a.return()}},{highWaterMark:2})},QS=64*1024,{isFunction:y0}=pe,DB=(({Request:e,Response:t})=>({Request:e,Response:t}))(pe.global),{ReadableStream:ZS,TextEncoder:ek}=pe.global,tk=(e,...t)=>{try{return!!e(...t)}catch{return!1}},RB=e=>{e=pe.merge.call({skipUndefined:!0},DB,e);const{fetch:t,Request:r,Response:n}=e,a=t?y0(t):typeof fetch=="function",i=y0(r),s=y0(n);if(!a)return!1;const o=a&&y0(ZS),c=a&&(typeof ek=="function"?(x=>g=>x.encode(g))(new ek):async x=>new Uint8Array(await new r(x).arrayBuffer())),u=i&&o&&tk(()=>{let x=!1;const g=new r(An.origin,{body:new ZS,method:"POST",get duplex(){return x=!0,"half"}}).headers.has("Content-Type");return x&&!g}),d=s&&o&&tk(()=>pe.isReadableStream(new n("").body)),f={stream:d&&(x=>x.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(x=>{!f[x]&&(f[x]=(g,y)=>{let v=g&&g[x];if(v)return v.call(g);throw new pt(`Response type '${x}' is not supported`,pt.ERR_NOT_SUPPORT,y)})});const h=async x=>{if(x==null)return 0;if(pe.isBlob(x))return x.size;if(pe.isSpecCompliantForm(x))return(await new r(An.origin,{method:"POST",body:x}).arrayBuffer()).byteLength;if(pe.isArrayBufferView(x)||pe.isArrayBuffer(x))return x.byteLength;if(pe.isURLSearchParams(x)&&(x=x+""),pe.isString(x))return(await c(x)).byteLength},p=async(x,g)=>{const y=pe.toFiniteNumber(x.getContentLength());return y??h(g)};return async x=>{let{url:g,method:y,data:v,signal:w,cancelToken:b,timeout:S,onDownloadProgress:k,onUploadProgress:_,responseType:E,headers:P,withCredentials:A="same-origin",fetchOptions:T}=e3(x),R=t||fetch;E=E?(E+"").toLowerCase():"text";let D=AB([w,b&&b.toAbortSignal()],S),L=null;const z=D&&D.unsubscribe&&(()=>{D.unsubscribe()});let X;try{if(_&&u&&y!=="get"&&y!=="head"&&(X=await p(P,v))!==0){let oe=new r(g,{method:"POST",body:v,duplex:"half"}),I;if(pe.isFormData(v)&&(I=oe.headers.get("content-type"))&&P.setContentType(I),oe.body){const[W,U]=XS(X,Wm(qS(_)));v=JS(oe.body,QS,W,U)}}pe.isString(A)||(A=A?"include":"omit");const Y=i&&"credentials"in r.prototype,q={...T,signal:D,method:y.toUpperCase(),headers:P.normalize().toJSON(),body:v,duplex:"half",credentials:Y?A:void 0};L=i&&new r(g,q);let ee=await(i?R(L,T):R(g,q));const V=d&&(E==="stream"||E==="response");if(d&&(k||V&&z)){const oe={};["status","statusText","headers"].forEach(G=>{oe[G]=ee[G]});const I=pe.toFiniteNumber(ee.headers.get("content-length")),[W,U]=k&&XS(I,Wm(qS(k),!0))||[];ee=new n(JS(ee.body,QS,W,()=>{U&&U(),z&&z()}),oe)}E=E||"text";let ae=await f[pe.findKey(f,E)||"text"](ee,x);return!V&&z&&z(),await new Promise((oe,I)=>{QT(oe,I,{data:ae,headers:Ei.from(ee.headers),status:ee.status,statusText:ee.statusText,config:x,request:L})})}catch(Y){throw z&&z(),Y&&Y.name==="TypeError"&&/Load failed|fetch/i.test(Y.message)?Object.assign(new pt("Network Error",pt.ERR_NETWORK,x,L),{cause:Y.cause||Y}):pt.from(Y,Y&&Y.code,x,L)}}},MB=new Map,t3=e=>{let t=e?e.env:{};const{fetch:r,Request:n,Response:a}=t,i=[n,a,r];let s=i.length,o=s,c,u,d=MB;for(;o--;)c=i[o],u=d.get(c),u===void 0&&d.set(c,u=o?new Map:RB(t)),d=u;return u};t3();const Jv={http:qL,xhr:EB,fetch:{get:t3}};pe.forEach(Jv,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const rk=e=>`- ${e}`,IB=e=>pe.isFunction(e)||e===null||e===!1,r3={getAdapter:(e,t)=>{e=pe.isArray(e)?e:[e];const{length:r}=e;let n,a;const i={};for(let s=0;s<r;s++){n=e[s];let o;if(a=n,!IB(n)&&(a=Jv[(o=String(n)).toLowerCase()],a===void 0))throw new pt(`Unknown adapter '${o}'`);if(a&&(pe.isFunction(a)||(a=a.get(t))))break;i[o||"#"+s]=a}if(!a){const s=Object.entries(i).map(([c,u])=>`adapter ${c} `+(u===!1?"is not supported by the environment":"is not available in the build"));let o=r?s.length>1?`since :
`+s.map(rk).join(`
`):" "+rk(s[0]):"as no adapter specified";throw new pt("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return a},adapters:Jv};function ox(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ou(null,e)}function nk(e){return ox(e),e.headers=Ei.from(e.headers),e.data=sx.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),r3.getAdapter(e.adapter||gb.adapter,e)(e).then(function(n){return ox(e),n.data=sx.call(e,e.transformResponse,n),n.headers=Ei.from(n.headers),n},function(n){return JT(n)||(ox(e),n&&n.response&&(n.response.data=sx.call(e,e.transformResponse,n.response),n.response.headers=Ei.from(n.response.headers))),Promise.reject(n)})}const n3="1.12.2",xp={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{xp[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const ak={};xp.transitional=function(t,r,n){function a(i,s){return"[Axios v"+n3+"] Transitional option '"+i+"'"+s+(n?". "+n:"")}return(i,s,o)=>{if(t===!1)throw new pt(a(s," has been removed"+(r?" in "+r:"")),pt.ERR_DEPRECATED);return r&&!ak[s]&&(ak[s]=!0,console.warn(a(s," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,s,o):!0}};xp.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function FB(e,t,r){if(typeof e!="object")throw new pt("options must be an object",pt.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const i=n[a],s=t[i];if(s){const o=e[i],c=o===void 0||s(o,i,e);if(c!==!0)throw new pt("option "+i+" must be "+c,pt.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new pt("Unknown option "+i,pt.ERR_BAD_OPTION)}}const um={assertOptions:FB,validators:xp},Ri=um.validators;class Gm{constructor(t){this.defaults=t||{},this.interceptors={request:new VS,response:new VS}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const i=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=pl(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:i}=r;n!==void 0&&um.assertOptions(n,{silentJSONParsing:Ri.transitional(Ri.boolean),forcedJSONParsing:Ri.transitional(Ri.boolean),clarifyTimeoutError:Ri.transitional(Ri.boolean)},!1),a!=null&&(pe.isFunction(a)?r.paramsSerializer={serialize:a}:um.assertOptions(a,{encode:Ri.function,serialize:Ri.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),um.assertOptions(r,{baseUrl:Ri.spelling("baseURL"),withXsrfToken:Ri.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let s=i&&pe.merge(i.common,i[r.method]);i&&pe.forEach(["delete","get","head","post","put","patch","common"],x=>{delete i[x]}),r.headers=Ei.concat(s,i);const o=[];let c=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(r)===!1||(c=c&&g.synchronous,o.unshift(g.fulfilled,g.rejected))});const u=[];this.interceptors.response.forEach(function(g){u.push(g.fulfilled,g.rejected)});let d,f=0,h;if(!c){const x=[nk.bind(this),void 0];for(x.unshift(...o),x.push(...u),h=x.length,d=Promise.resolve(r);f<h;)d=d.then(x[f++],x[f++]);return d}h=o.length;let p=r;for(;f<h;){const x=o[f++],g=o[f++];try{p=x(p)}catch(y){g.call(this,y);break}}try{d=nk.call(this,p)}catch(x){return Promise.reject(x)}for(f=0,h=u.length;f<h;)d=d.then(u[f++],u[f++]);return d}getUri(t){t=pl(this.defaults,t);const r=ZT(t.baseURL,t.url,t.allowAbsoluteUrls);return XT(r,t.params,t.paramsSerializer)}}pe.forEach(["delete","get","head","options"],function(t){Gm.prototype[t]=function(r,n){return this.request(pl(n||{},{method:t,url:r,data:(n||{}).data}))}});pe.forEach(["post","put","patch"],function(t){function r(n){return function(i,s,o){return this.request(pl(o||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:i,data:s}))}}Gm.prototype[t]=r(),Gm.prototype[t+"Form"]=r(!0)});const dm=Gm;class xb{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const n=this;this.promise.then(a=>{if(!n._listeners)return;let i=n._listeners.length;for(;i-- >0;)n._listeners[i](a);n._listeners=null}),this.promise.then=a=>{let i;const s=new Promise(o=>{n.subscribe(o),i=o}).then(a);return s.cancel=function(){n.unsubscribe(i)},s},t(function(i,s,o){n.reason||(n.reason=new ou(i,s,o),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new xb(function(a){t=a}),cancel:t}}}const LB=xb;function BB(e){return function(r){return e.apply(null,r)}}function jB(e){return pe.isObject(e)&&e.isAxiosError===!0}const Qv={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Qv).forEach(([e,t])=>{Qv[t]=e});const $B=Qv;function a3(e){const t=new dm(e),r=FT(dm.prototype.request,t);return pe.extend(r,dm.prototype,t,{allOwnKeys:!0}),pe.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return a3(pl(e,a))},r}const Lr=a3(gb);Lr.Axios=dm;Lr.CanceledError=ou;Lr.CancelToken=LB;Lr.isCancel=JT;Lr.VERSION=n3;Lr.toFormData=pp;Lr.AxiosError=pt;Lr.Cancel=Lr.CanceledError;Lr.all=function(t){return Promise.all(t)};Lr.spread=BB;Lr.isAxiosError=jB;Lr.mergeConfig=pl;Lr.AxiosHeaders=Ei;Lr.formToJSON=e=>YT(pe.isHTMLForm(e)?new FormData(e):e);Lr.getAdapter=r3.getAdapter;Lr.HttpStatusCode=$B;Lr.default=Lr;const lx=Lr,$c=({setCurrentPage:e,selectedComponents:t,setSelectedComponents:r,onLoaded:n,user:a,onShowAuth:i,setUser:s})=>{const[o,c]=N.useState({cpu:null,motherboard:null,gpu:null,ram:null,storage:null,psu:null,case:null,cooler:null}),u=N.useMemo(()=>t||o,[t,o]),d=r||c,[f,h]=N.useState(!1),[p,x]=N.useState(1),[g,y]=N.useState(!0),[v,w]=N.useState(!1),[b,S]=N.useState(!1),[k,_]=N.useState(!1),[E,P]=N.useState(0),[A,T]=N.useState(!1),[R,D]=N.useState(null),[L,z]=N.useState(""),[X,Y]=N.useState(""),[q,ee]=N.useState(!1),[V,ae]=N.useState(!1),[oe,I]=N.useState(!1),[W,U]=N.useState(null),[G,ne]=N.useState(!1),[K,le]=N.useState({}),[Q,ce]=N.useState({}),[be,j]=N.useState(!1),[$e,Ee]=N.useState([]),[Ae,Be]=N.useState(100),[we,de]=N.useState({}),[Ge,et]=N.useState({}),[Qe,te]=N.useState(null),De=N.useRef(null),ze=N.useRef(!1),ct=N.useMemo(()=>[{key:"cpu",name:"Processor",icon:ua,description:"Brain of your PC",priority:1},{key:"motherboard",name:"Motherboard",icon:up,description:"Connects everything",priority:2},{key:"gpu",name:"Graphics Card",icon:Ki,description:"Handles graphics",priority:3},{key:"ram",name:"Memory",icon:ti,description:"System memory",priority:4},{key:"storage",name:"Storage",icon:au,description:"Data storage",priority:5},{key:"psu",name:"Power Supply",icon:Ta,description:"Powers everything",priority:6},{key:"case",name:"Case",icon:Ye,description:"Houses components",priority:7},{key:"cooler",name:"Cooling",icon:ta,description:"Keeps it cool",priority:8}],[]),Ke=N.useCallback(()=>ct[p-1]||ct[0],[ct,p]),mt=N.useCallback(C=>{switch(C){case"cpu":return"CPU";case"motherboard":return"Motherboard";case"gpu":return"GPU";case"ram":return"RAM";case"storage":return"Storage";case"psu":return"PSU";case"case":return"Case";case"cooler":return"Cooler";default:return""}},[]);N.useEffect(()=>{if(!f)return;const C=Xo(u);Be(C.score)},[u,f]),N.useEffect(()=>{(async()=>{try{const M=Ke();if(!M||!M.key)return;const B=mt(M.key),O=ha("components",{category:B,...Qe&&{branch:Qe}}),H=await(await fetch(O)).json();H.success&&Ee(H.data)}catch(M){console.error("Error fetching components for comparison:",M)}})()},[Ke,mt,Qe]);const ht=N.useCallback(C=>{const M={cpu:null,motherboard:null,gpu:null,ram:null,storage:null,psu:null,case:null,cooler:null},B={cpu:["cpu","processor","procie","procie only","processor only"],motherboard:["motherboard","mobo"],gpu:["gpu","graphics","graphics card","video","video card","vga"],ram:["ram","memory","ddr","ddr4","ddr5","ram 3200mhz"],storage:["storage","ssd","nvme","ssd nvme","hdd","hard drive","drive"],psu:["psu","power supply","psu - tr","tr psu"],case:["case","chassis","case gaming"],cooler:["cooler","coolers","cooling","aio","cpu cooler","liquid cooler","water cooling","fan","heatsink"]},O=C||{},F={};Object.keys(O).forEach(Z=>{F[Z.toLowerCase()]=O[Z]});const H={};return Object.entries(B).forEach(([Z,se])=>{for(const ie of se)if(F[ie]){H[Z]=F[ie];break}}),Object.keys(F).forEach(Z=>{B[Z]&&(H[Z]=F[Z])}),{...M,...H}},[]),Re=N.useCallback((C,M)=>{if(!C)return null;if(M==="socket"){const B=[C.socket,C.Socket,C.type,C.Type,C.model,C.Model,C.name,C.Name,C.specs&&C.specs.socket,C.specs&&C.specs.type,C.specs&&C.specs.model,C.specs&&C.specs.name];for(let O of B)if(typeof O=="string"&&O.trim()){const F=O.trim().toLowerCase();if(F.includes("am4"))return"am4";if(F.includes("lga1200"))return"lga1200";if(F.includes("am5"))return"am5";if(F.includes("lga1700"))return"lga1700"}return null}if(M==="brand"){const B=[C.brand,C.Brand,C.name,C.Name,C.model,C.Model,C.type,C.Type,C.specs&&C.specs.brand,C.specs&&C.specs.name];for(let O of B)if(typeof O=="string"&&O.trim()){const F=O.trim().toLowerCase();if(F.includes("amd"))return"amd";if(F.includes("intel"))return"intel"}return null}return M==="ramType"?C.ram_type||C.type||C.specs&&(C.specs.ram_type||C.specs.type)||null:M==="formFactor"?C.form_factor||C.specs&&C.specs.form_factor||null:C[M]||C.specs&&C.specs[M]||null},[]),tt=N.useCallback(async C=>{try{const M=Object.values(C).filter(H=>H&&typeof H=="number");if(M.length===0)return{};const B=`${ve}/get_components_by_ids.php?ids=${M.join(",")}`,F=await(await fetch(B)).json();if(F.success&&F.data){const H={};return F.data.forEach(Z=>{const se=Object.keys(C).find(ie=>C[ie]==Z.id);se&&(H[se]=Z)}),H}return{}}catch(M){return console.error("Error fetching components by IDs:",M),{}}},[]);N.useCallback(async(C,M)=>{const B=mt(C);if(B){et(O=>({...O,[C]:!0}));try{let O={category:B,limit:5};M.socket&&(O.socket=M.socket),M.type&&(O.ramType=M.type),M.minWattage&&(O.minWattage=M.minWattage),M.minSize&&(O.minSize=M.minSize),M.formFactor&&(O.formFactor=M.formFactor);let{data:F}=await lx.get(`${ve}/recommendations.php`,{params:O});if(!F.data||F.data.length===0){const H={category:B,limit:5,minPrice:1e3,maxPrice:5e5},Z=await lx.get(`${ve}/recommendations.php`,{params:H});Z.data.data&&Z.data.data.length>0&&(F=Z.data)}if(!F.data||F.data.length===0){const H={category:B,limit:3},Z=await lx.get(`${ve}/recommendations.php`,{params:H});Z.data.data&&Z.data.data.length>0&&(F=Z.data)}de(H=>({...H,[C]:F.data||[]}))}catch(O){console.error("Error fetching recommendations:",O),de(F=>({...F,[C]:[]}))}finally{et(O=>({...O,[C]:!1}))}}},[mt]);const kt=N.useCallback(C=>{const M=u[C];if(!M)return null;const B=[];if(C==="cpu"&&u.motherboard){const O=Re(M,"socket"),F=Re(u.motherboard,"socket");O&&F&&O!==F&&!(O.toLowerCase()==="am4"&&F.toLowerCase()==="am4")&&B.push({type:"replace",message:`CPU socket (${O}) doesn't match motherboard (${F})`,action:"Replace CPU",targetCategory:"cpu",requirements:{socket:F}})}if(C==="motherboard"){const O=Re(M,"socket"),F=Re(M,"ramType");if(u.cpu){const H=Re(u.cpu,"socket");O&&H&&O!==H&&!(O.toLowerCase()==="am4"&&H.toLowerCase()==="am4")&&B.push({type:"replace",message:`Motherboard socket (${O}) doesn't match CPU (${H})`,action:"Replace Motherboard",targetCategory:"motherboard",requirements:{socket:H}})}if(u.ram){const H=Re(u.ram,"ramType");F&&H&&F!==H&&B.push({type:"replace",message:`Motherboard supports ${F} but RAM is ${H}`,action:"Replace RAM",targetCategory:"ram",requirements:{type:F}})}}if(C==="ram"&&u.motherboard){const O=Re(M,"ramType"),F=Re(u.motherboard,"ramType");O&&F&&O!==F&&B.push({type:"replace",message:`RAM type (${O}) doesn't match motherboard (${F})`,action:"Replace RAM",targetCategory:"ram",requirements:{type:F}});const H=Re(M,"sticks")||Re(M,"modules")||1,Z=Re(u.motherboard,"ram_slots")||Re(u.motherboard,"slots")||2;H>Z&&B.push({type:"replace",message:`Selected RAM (${H} sticks) exceeds motherboard slots (${Z})`,action:"Replace RAM",targetCategory:"ram",requirements:{maxSticks:Z}})}if(C==="storage"&&u.motherboard){const O=Re(M,"interface")||Re(M,"type"),F=Re(u.motherboard,"storage_interfaces")||Re(u.motherboard,"storage_support");O&&F&&!String(F).toLowerCase().includes(String(O).toLowerCase())&&B.push({type:"replace",message:`Storage interface (${O}) not supported by motherboard (${F})`,action:"Replace Storage",targetCategory:"storage",requirements:{interface:F}})}if(C==="psu"){const O=Re(u.cpu,"tdp")||0,F=Re(u.gpu,"tdp")||0,H=O+F+100,Z=Math.ceil(H*1.2/10)*10,se=Re(M,"wattage");if(se&&se<Z&&B.push({type:"upgrade",message:`PSU (${se}W) may not provide enough power (${Z}W recommended)`,action:"Upgrade PSU",targetCategory:"psu",requirements:{minWattage:Z}}),u.case){const ie=Re(M,"form_factor")||Re(M,"type"),ue=Re(u.case,"psu_support")||Re(u.case,"psu_type");ie&&ue&&!String(ue).toLowerCase().includes(String(ie).toLowerCase())&&B.push({type:"replace",message:`PSU form factor (${ie}) not supported by case (${ue})`,action:"Replace PSU",targetCategory:"psu",requirements:{form_factor:ue}})}}if(C==="gpu"&&u.case){const O=Re(M,"length")||Re(M,"max_length"),F=Re(u.case,"gpu_max_length")||Re(u.case,"max_gpu_length");O&&F&&Number(O)>Number(F)&&B.push({type:"replace",message:`GPU length (${O}mm) exceeds case max GPU length (${F}mm)`,action:"Replace GPU",targetCategory:"gpu",requirements:{maxLength:F}})}if(C==="cooler"&&u.case){const O=Re(M,"height")||Re(M,"max_height"),F=Re(u.case,"cooler_max_height")||Re(u.case,"max_cooler_height");O&&F&&Number(O)>Number(F)&&B.push({type:"replace",message:`Cooler height (${O}mm) exceeds case max cooler height (${F}mm)`,action:"Replace Cooler",targetCategory:"cooler",requirements:{maxHeight:F}})}if(C==="case"&&u.motherboard){const O=Re(u.case,"formFactor"),F=Re(u.motherboard,"formFactor");O&&F&&((Array.isArray(O)?O.map(Z=>Z.toLowerCase()):String(O).split(/,|\//).map(Z=>Z.trim().toLowerCase())).includes(String(F).toLowerCase())||B.push({type:"replace",message:`Case form factor (${O}) may not fit motherboard (${F})`,action:"Replace Case",targetCategory:"case",requirements:{formFactor:F}}))}return B},[u,Re]),Lt=(C,M=!1)=>C>=90?M?"bg-green-500":"text-green-600":C>=70?M?"bg-yellow-500":"text-yellow-600":C>=50?M?"bg-orange-500":"text-orange-600":M?"bg-red-500":"text-red-600",xe=C=>C>=90?"bg-green-50 border-green-400":C>=70?"bg-yellow-50 border-yellow-400":C>=50?"bg-orange-50 border-orange-400":"bg-red-50 border-red-400",Ie=C=>C>=90?"text-green-800":C>=70?"text-yellow-800":C>=50?"text-orange-800":"text-red-800",ut=C=>C>=90?"Excellent! Your build is highly compatible and ready for assembly.":C>=70?"Good compatibility with minor optimizations available.":C>=50?"Moderate compatibility - some components may need adjustment.":C>0?"Low compatibility - significant issues detected that need attention.":"No components selected yet - start building to see compatibility score.",Ht=N.useCallback((C,M)=>{d(O=>({...O,[C]:M})),ct.findIndex(O=>O.key===C)===p-1&&p<ct.length&&x(p+1)},[d,ct,p]),kr=N.useCallback(C=>{d(M=>({...M,[C]:null}))},[d]);N.useCallback(C=>{x(ct.findIndex(M=>M.key===C.targetCategory)+1)},[ct]);const _r=N.useCallback(()=>{const C={cpu:null,motherboard:null,gpu:null,ram:null,storage:null,psu:null,case:null,cooler:null};try{d(C)}catch{}try{c&&c(C)}catch{}try{localStorage.removeItem("builditpc-selected-components")}catch{}try{localStorage.removeItem("builditpc-editing-build")}catch{}le({}),ce({}),de({}),Be(0),x(1),I(!1),U(null),z(""),Y("");try{De.current=JSON.stringify(C)}catch{}P(M=>M+1);try{window.dispatchEvent(new CustomEvent("builditpc:clear"))}catch{}},[d,c]),re=N.useCallback(()=>Object.values(u).filter(C=>C).reduce((C,M)=>{if(typeof M=="object"&&M!==null){const B=typeof M.price=="string"?parseFloat(M.price):M.price||0;return C+B}return C},0),[u]),Ne=N.useCallback(()=>["cpu","motherboard","gpu","ram","storage","psu","case"].filter(O=>{const F=u[O];return!F||typeof F!="object"||Object.keys(F).length===0?!1:F.id&&F.name}).length===0?0:Xo(u).score,[u]),je=N.useCallback(()=>{const C=[];return K.cpu_motherboard===!1&&C.push("cpu","motherboard"),K.ram_motherboard===!1&&C.push("ram","motherboard"),K.ram_slots===!1&&C.push("ram","motherboard"),K.ram_speed===!1&&C.push("ram","motherboard"),K.storage_interface===!1&&C.push("storage","motherboard"),K.psu_power===!1&&C.push("psu"),K.psu_form_factor===!1&&C.push("psu","case"),K.case_motherboard===!1&&C.push("case","motherboard"),K.gpu_length===!1&&C.push("gpu","case"),K.cooler_height===!1&&C.push("cooler","case"),K.cooler_socket===!1&&C.push("cooler","cpu"),K.ram_cpu_speed===!1&&C.push("ram","cpu"),new Set(C)},[K]),at=N.useCallback(()=>Object.entries(u).filter(([C,M])=>M!=null).length,[u]),_e=N.useCallback(()=>7,[]),Xe=N.useCallback(()=>["cpu","motherboard","gpu","ram","storage","psu","case"].filter(M=>{const B=u[M];return!B||typeof B!="object"||Object.keys(B).length===0?!1:B.id&&B.name}).length,[u]);N.useCallback(()=>Xe()>=5,[Xe]);const Xr=N.useCallback(()=>{const C=u;let M=0,B=0,O=0,F=0;if(C.gpu&&C.cpu){const H=typeof C.gpu=="object"&&C.gpu.price||0,Z=typeof C.cpu=="object"&&C.cpu.price||0;M=Math.min(100,H/5e4*100+Z/3e4*100)}if(C.cpu&&C.ram){const H=typeof C.cpu=="object"&&C.cpu.cores||0,Z=typeof C.ram=="object"&&C.ram.capacity||0;B=Math.min(100,H/16*100+Z/64*100)}return C.cooler&&typeof C.cooler=="object"?O=C.cooler.type==="AIO Liquid Cooler"?100:C.cooler.type==="Air Cooler"?80:60:O=40,C.motherboard&&(typeof C.motherboard=="object"?F=C.motherboard.ram_type==="DDR5"?100:70:F=70),{gamingScore:M,workstationScore:B,coolingScore:O,upgradeScore:F}},[u]),J=N.useMemo(()=>Xr(),[Xr]),he=N.useCallback(()=>{const C=["cpu","motherboard","gpu","ram","storage","psu","case"],M=C.filter(B=>{const O=u[B];return!O||typeof O!="object"||Object.keys(O).length===0?!1:O.id&&O.name}).length;return Math.round(M/C.length*100)},[u]);N.useCallback(C=>{if(!u[C])return!1;switch(C){case"cpu":return K.cpu_motherboard===!1||K.cooler_socket===!1||K.ram_cpu_speed===!1;case"motherboard":return K.cpu_motherboard===!1||K.ram_motherboard===!1||K.ram_slots===!1||K.ram_speed===!1||K.storage_interface===!1||K.case_motherboard===!1;case"ram":return K.ram_motherboard===!1||K.ram_slots===!1||K.ram_speed===!1||K.ram_cpu_speed===!1;case"storage":return K.storage_interface===!1;case"psu":return K.psu_power===!1||K.psu_form_factor===!1;case"case":return K.case_motherboard===!1||K.gpu_length===!1||K.cooler_height===!1||K.psu_form_factor===!1;case"gpu":return K.gpu_length===!1;case"cooler":return K.cooler_height===!1||K.cooler_socket===!1;default:return!1}},[u,K]);const Fe=Object.values(K).some(C=>C===!1),ot=()=>Xe()===_e()?Fe?K.cpu_motherboard===!1?"Incompatible: Socket mismatch":"Compatibility issues detected":Ne()===100?"Build compatible and ready":"":"Build incomplete, please add more components",Tt=C=>{try{const M=C.split(".")[1];if(!M)return!0;let B=M.replace(/-/g,"+").replace(/_/g,"/");for(;B.length%4;)B+="=";const O=JSON.parse(atob(B));return O.exp?Date.now()>=O.exp*1e3:!1}catch{return!0}},[Pr,xr]=N.useState(!1),Nt=N.useCallback(async()=>{try{if(Xe()<_e()){alert("Build incomplete, please add more components");return}if(Fe){K.cpu_motherboard===!1?alert("Incompatible: Socket mismatch"):alert("Please resolve critical compatibility issues before proceeding.");return}const C=localStorage.getItem("token");if(!C||Tt(C)||!a){_(!0);return}const M=["cpu","motherboard","gpu","ram","storage","psu","case"],B=["cooler"],O=[],F=se=>{if(se&&typeof se.id=="number"){const ie=typeof se.price=="string"?parseFloat(se.price):se.price||0;O.push({component_id:se.id,quantity:1,unit_price:ie})}};if(M.forEach(se=>F(u[se])),B.forEach(se=>F(u[se])),O.length===0){alert("No valid components found to place an order.");return}T(!0);const H=await fetch(`${ve}/index.php?endpoint=orders${Qe?`&branch=${encodeURIComponent(Qe)}`:""}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${C}`},body:JSON.stringify({user_id:a==null?void 0:a.id,status:"Completed",items:O})}),Z=await H.json().catch(()=>({}));if(!H.ok||!Z.success)throw new Error(Z.error||"Failed to place order");D({order_id:Z.order_id,total:Z.total})}catch(C){console.error("Order creation failed:",C),alert(`Failed to place order: ${C.message}`)}finally{T(!1)}},[u,a,Fe,_e,Xe,ve,Qe]),Ct=N.useCallback(async()=>{var F;if(!L.trim())return;const C=localStorage.getItem("token");if(Pr)return;if(!C||Tt(C)||!a){_(!0);return}if(V)return;const M=Object.fromEntries(Object.entries(u).filter(([H,Z])=>Z&&typeof Z.id=="number")),O=["cpu","motherboard","gpu","ram","storage","psu","case"].filter(H=>!M[H]);if(O.length>0){alert("Please select valid components for: "+O.join(", "));return}ae(!0);try{const H={name:L,description:X,components:M,compatibility:Ae,totalPrice:re(),is_public:q},Z=typeof W=="string"?parseInt(W,10):W,se=oe&&Number.isFinite(Z)&&Z>0,ie=se?"PUT":"POST";let ue=se?`${ve}/index.php?endpoint=builds&id=${Z}`:`${ve}/index.php?endpoint=builds`;const fe={"Content-Type":"application/json"};C&&(fe.Authorization=`Bearer ${C}`);const Se=await fetch(ue,{method:ie,headers:fe,body:JSON.stringify(H)}),Te=await Se.json();if(Te.success){const Ue=((F=Te.data)==null?void 0:F.id)||Te.build_id;if(Ue)try{await _t(Ue),alert("Your build has been saved and submitted for community review! Admins will review and approve it for the community.")}catch(Le){console.error("Error during community submission:",Le),alert("Build saved successfully, but there was an error submitting for community review. You can submit it for review later from your builds.")}else alert("Build saved successfully!");z(""),Y(""),w(!1),localStorage.removeItem("builditpc-selected-components"),localStorage.removeItem("builditpc-editing-build"),I(!1),U(null),alert(oe?"Build updated successfully! You can view it in My Builds.":"Build saved successfully! You can view it in My Builds."),e("my-builds")}else Se.status===409?alert("A build with this name and configuration already exists. Please choose a different name or modify your components."):alert("Error saving build: "+(Te.error||"Unknown error"))}catch(H){console.error("Error saving build:",H),alert("Error saving build. Please try again.")}finally{ae(!1)}},[L,X,u,oe,W,Xo,re,e,a,s,Pr]),_t=N.useCallback(async C=>{const M=localStorage.getItem("token");if(!M||Tt(M)||!a)throw _(!0),new Error("Authentication required");ne(!0);try{const B=await fetch(`${ve}/index.php?endpoint=community_submission`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${M}`},body:JSON.stringify({build_id:C,build_name:L,build_description:X,total_price:re(),compatibility:Ae})});if(!B.ok){const F=await B.text();throw console.error("Server response:",F),new Error(`HTTP error! status: ${B.status}`)}const O=await B.json();if(!O.success)throw console.error("Submission failed:",O.error),new Error(O.error||"Failed to submit build for review");return O}catch(B){throw console.error("Error in handleSubmitToCommunity:",B),B}finally{ne(!1)}},[L,X,re,Xo,a]);return N.useEffect(()=>{if(ze.current)return;(async()=>{try{let M=ht({});if(t&&Object.keys(t).length>0)if(Object.values(t).some(O=>typeof O=="number")){const O=await tt(t);M=ht(O)}else M=ht(t);else if(a&&a.id){const B=localStorage.getItem("builditpc-selected-components");if(B)try{const O=JSON.parse(B);M=ht(O),Object.values(O).some(H=>H!=null&&typeof H=="object"&&Object.keys(H).length>0&&H.id&&H.name)&&(S(!0),setTimeout(()=>S(!1),5e3))}catch(O){console.error("Error parsing saved components:",O)}}else localStorage.removeItem("builditpc-selected-components"),localStorage.removeItem("builditpc-editing-build");if(d(M),h(!0),n&&n(),a&&a.id){const B=localStorage.getItem("builditpc-editing-build");if(B)try{const O=JSON.parse(B),F=typeof O.id=="string"?parseInt(O.id,10):O.id;Number.isFinite(F)&&F>0?(I(!0),U(F)):(I(!1),U(null)),z(O.name||""),Y(O.description||"")}catch(O){console.error("Error parsing editing build data:",O)}}ze.current=!0}catch(M){console.error("Error initializing component:",M),h(!0),ze.current=!0}})()},[t]),N.useEffect(()=>{if(!f)return;const C={},M={},B=(O,F)=>{if(!O)return null;const Z={socket:["socket","Socket","type","Type","cpu_socket"],ramType:["ramType","ram_type","memory_type","type","Type","ddr"],formFactor:["formFactor","form_factor","size","Size","type","Type"],wattage:["wattage","Wattage","power","Power","w","W"],tdp:["tdp","TDP","thermal_design_power","power_consumption"],length:["length","Length","max_length","maxLength","size"],height:["height","Height","max_height","maxHeight"],width:["width","Width","max_width","maxWidth"],interface:["interface","Interface","connection","Connection","type","Type"],slots:["slots","Slots","ram_slots","memory_slots","dimms"],sticks:["sticks","Sticks","modules","Modules","ram_modules"],storage_interfaces:["storage_interfaces","storage_support","sata_ports","m2_slots"],gpu_max_length:["gpu_max_length","max_gpu_length","gpu_length","max_length"],cooler_max_height:["cooler_max_height","max_cooler_height","cpu_cooler_height"],psu_support:["psu_support","psu_type","power_supply_support"],chipset:["chipset","Chipset","platform","Platform"]}[F]||[F];for(const ie of Z){if(O[ie])return O[ie];if(O.specs&&O.specs[ie])return O.specs[ie]}const se=`${O.name||""} ${O.description||""}`.toLowerCase();return F==="socket"&&se.includes("am4")?"AM4":F==="socket"&&se.includes("am5")?"AM5":F==="socket"&&se.includes("lga1200")?"LGA1200":F==="socket"&&se.includes("lga1700")?"LGA1700":F==="ramType"&&se.includes("ddr4")?"DDR4":F==="ramType"&&se.includes("ddr5")?"DDR5":F==="formFactor"&&se.includes("atx")?"ATX":F==="formFactor"&&se.includes("micro-atx")?"Micro-ATX":F==="formFactor"&&se.includes("mini-itx")?"Mini-ITX":null};if(u.cpu&&u.motherboard){const O=B(u.cpu,"socket"),F=B(u.motherboard,"socket"),H=u.cpu.name||"",Z=u.motherboard.name||"",ie=(()=>{if(!O||!F)return null;const ue=O.toLowerCase().trim(),fe=F.toLowerCase().trim();if(ue.includes("am4")&&fe.includes("am4")){const Se=/ryzen\s*(5[0-9]{3}|5600|5700|5800|5900|5950)/i.test(H),Te=/(a320|b350|b450|a520)/i.test(Z);return Se&&Te?{compatible:!0,warning:"May require BIOS update for Ryzen 5000 series"}:{compatible:!0}}return ue.includes("am5")&&fe.includes("am5")?{compatible:!0}:ue.includes("lga1200")&&fe.includes("lga1200")?{compatible:!0}:ue.includes("lga1700")&&fe.includes("lga1700")?{compatible:!0}:ue.includes("lga1851")&&fe.includes("lga1851")?{compatible:!0}:{compatible:!1}})();ie===null?M.cpu_motherboard="Cannot determine socket compatibility (missing data)":ie.compatible?(C.cpu_motherboard=!0,ie.warning&&(M.cpu_motherboard=`Compatible. ${ie.warning}`)):(C.cpu_motherboard=!1,M.cpu_motherboard=`CPU socket (${O}) is not compatible with motherboard socket (${F})`)}if(u.ram&&u.motherboard){const O=B(u.ram,"ramType"),F=B(u.motherboard,"ramType"),H=B(u.ram,"sticks")||1,Z=B(u.motherboard,"slots")||2,se=B(u.ram,"speed")||B(u.ram,"frequency"),ie=B(u.motherboard,"max_ram_speed")||B(u.motherboard,"memory_speed");if(O&&F){const ue=O.toLowerCase().trim(),fe=F.toLowerCase().trim();ue!==fe?(C.ram_motherboard=!1,M.ram_motherboard=`RAM type (${O}) is not compatible with motherboard (${F})`):C.ram_motherboard=!0}else M.ram_motherboard="Cannot determine RAM type compatibility (missing data)";if(H>Z&&(C.ram_slots=!1,M.ram_slots=`Selected RAM (${H} sticks) exceeds motherboard slots (${Z})`),se&&ie){const ue=parseInt(se),fe=parseInt(ie);ue>fe&&(C.ram_speed=!1,M.ram_speed=`RAM speed (${se}MHz) exceeds motherboard maximum (${ie}MHz)`)}}if(u.storage&&u.motherboard){const O=B(u.storage,"interface"),F=B(u.motherboard,"storage_interfaces");if(O&&F){const H=O.toLowerCase(),Z=F.toLowerCase();H.includes("sata")&&Z.includes("sata")||H.includes("nvme")&&Z.includes("nvme")||H.includes("m.2")&&Z.includes("m.2")||H.includes("pcie")&&Z.includes("pcie")?C.storage_interface=!0:(C.storage_interface=!1,M.storage_interface=`Storage interface (${O}) not supported by motherboard`)}else M.storage_interface="Cannot determine storage compatibility (missing data)"}if(u.psu){const O=B(u.psu,"wattage");if(O){let F=0;if(u.cpu){const se=B(u.cpu,"tdp")||65;F+=parseInt(se)}if(u.gpu){const se=B(u.gpu,"tdp")||150;F+=parseInt(se)}F+=100;const H=Math.ceil(F*1.2/50)*50,Z=parseInt(O);Z<H?(C.psu_power=!1,M.psu_power=`PSU wattage (${O}W) is below recommended (${H}W) for your components`):Z<H*1.5?(C.psu_power=!0,M.psu_power=`PSU wattage (${O}W) is adequate but consider ${H*1.5}W for better efficiency`):C.psu_power=!0}else M.psu_power="Cannot determine PSU compatibility (missing wattage data)";if(u.case){const F=B(u.psu,"form_factor"),H=B(u.case,"psu_support");if(F&&H){const Z=F.toLowerCase(),se=H.toLowerCase();Z.includes("atx")&&se.includes("atx")||Z.includes("sfx")&&se.includes("sfx")||Z.includes("sfx-l")&&se.includes("sfx-l")?C.psu_form_factor=!0:(C.psu_form_factor=!1,M.psu_form_factor=`PSU form factor (${F}) not supported by case`)}}}if(u.case&&u.motherboard){const O=B(u.case,"formFactor"),F=B(u.motherboard,"formFactor");if(O&&F){const H=O.toLowerCase(),Z=F.toLowerCase();({atx:["atx","micro-atx","mini-itx"],"micro-atx":["micro-atx","mini-itx"],"mini-itx":["mini-itx"],"e-atx":["e-atx","atx","micro-atx","mini-itx"]}[H]||[]).includes(Z)?C.case_motherboard=!0:(C.case_motherboard=!1,M.case_motherboard=`Case form factor (${O}) does not support motherboard (${F})`)}else M.case_motherboard="Cannot determine form factor compatibility (missing data)"}if(u.gpu&&u.case){const O=B(u.gpu,"length"),F=B(u.case,"gpu_max_length");if(O&&F){const H=parseInt(O),Z=parseInt(F);H>Z?(C.gpu_length=!1,M.gpu_length=`GPU length (${O}mm) exceeds case maximum (${F}mm)`):C.gpu_length=!0}else M.gpu_length="Cannot determine GPU-case compatibility (missing data)"}if(u.cooler&&u.case){const O=B(u.cooler,"height"),F=B(u.case,"cooler_max_height");if(O&&F){const H=parseInt(O),Z=parseInt(F);H>Z?(C.cooler_height=!1,M.cooler_height=`Cooler height (${O}mm) exceeds case maximum (${F}mm)`):C.cooler_height=!0}else M.cooler_height="Cannot determine cooler-case compatibility (missing data)"}if(u.cooler&&u.cpu){const O=B(u.cooler,"socket"),F=B(u.cpu,"socket");if(O&&F){const H=O.toLowerCase(),Z=F.toLowerCase();H.includes("am4")&&Z.includes("am4")||H.includes("am5")&&Z.includes("am5")||H.includes("lga1200")&&Z.includes("lga1200")||H.includes("lga1700")&&Z.includes("lga1700")||H.includes("universal")||H.includes("all")?C.cooler_socket=!0:(C.cooler_socket=!1,M.cooler_socket=`CPU cooler socket (${O}) not compatible with CPU (${F})`)}}if(u.ram&&u.cpu){const O=B(u.ram,"speed"),F=B(u.cpu,"max_memory_speed");if(O&&F){const H=parseInt(O),Z=parseInt(F);H>Z&&(C.ram_cpu_speed=!1,M.ram_cpu_speed=`RAM speed (${O}MHz) exceeds CPU maximum (${F}MHz)`)}}le(C),ce(M)},[u,f]),N.useEffect(()=>{if(!a||!a.id)return;const C=JSON.stringify(u),M=De.current;C!==M&&(localStorage.setItem("builditpc-selected-components",C),De.current=C)},[u,a]),N.useEffect(()=>{(!a||!a.id)&&(localStorage.removeItem("builditpc-selected-components"),localStorage.removeItem("builditpc-editing-build"),De.current=null)},[a]),N.useEffect(()=>()=>{oe&&localStorage.removeItem("builditpc-editing-build"),ze.current=!1},[oe]),N.useEffect(()=>{const C=localStorage.getItem("token");!a&&typeof s=="function"&&C&&!Tt(C)&&(xr(!0),fetch(`${ve}/index.php?endpoint=profile`,{method:"GET",headers:{Authorization:`Bearer ${C}`}}).then(M=>M.status===401?null:M.json()).then(M=>{M&&M.success&&M.user&&s(M.user)}).catch(()=>{}).finally(()=>xr(!1)))},[a,s]),f?m("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:[Fe&&m("div",{className:"bg-red-100 border border-red-300 text-red-800 px-6 py-4 flex items-center justify-between shadow-md",children:[m("div",{className:"flex items-center gap-3",children:[l($r,{className:"w-6 h-6 text-red-600"}),l("span",{className:"font-semibold",children:"Compatibility Issues Detected!"}),l("span",{className:"text-sm",children:"Some components are not compatible. Please review the issues below before saving your build."})]}),l("button",{onClick:()=>{var C;return window.scrollTo({top:((C=document.getElementById("compatibility-checker"))==null?void 0:C.offsetTop)||0,behavior:"smooth"})},className:"ml-4 px-4 py-2 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 transition-colors",children:"Review Issues"})]}),l("div",{className:"bg-white shadow-sm border-b border-gray-200",children:l("div",{className:"w-full px-4 sm:px-6 lg:px-8 xl:px-12 2xl:px-16 py-6",children:m("div",{className:"flex items-center justify-between",children:[m("div",{children:[m("div",{className:"flex items-center gap-3",children:[l("h1",{className:"text-3xl font-bold text-gray-900",children:"PC Assembly"}),oe&&m("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:[l(_i,{className:"w-4 h-4 mr-1"}),"Editing Build"]})]}),l("p",{className:"text-gray-600 mt-1",children:oe?"Modify your existing build configuration":"Build your dream PC with confidence"})]}),l("div",{className:"flex items-center gap-4",children:m("button",{onClick:()=>y(!g),className:"flex items-center gap-2 px-4 py-2 bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors",children:[l(qa,{className:"w-4 h-4"}),g?"Hide Tips":"Show Tips"]})})]})})}),b&&l("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-6 mb-4",children:l("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-xl p-4 shadow-sm",children:m("div",{className:"flex items-center justify-between",children:[m("div",{className:"flex items-center gap-3",children:[l("div",{className:"flex-shrink-0",children:l("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:l(yt,{className:"w-5 h-5 text-green-600"})})}),m("div",{children:[l("h3",{className:"text-sm font-semibold text-green-900",children:"Components Restored"}),l("p",{className:"text-sm text-green-700",children:"Your previously selected components have been restored from your last session."})]})]}),l("button",{onClick:()=>S(!1),className:"flex-shrink-0 p-1 text-green-400 hover:text-green-600 hover:bg-green-100 rounded-full transition-colors duration-200","aria-label":"Dismiss notification",children:l(Gn,{className:"w-4 h-4"})})]})})}),l("div",{className:"w-full px-2 sm:px-4 lg:px-6 xl:px-8 2xl:px-12 py-4 sm:py-6 lg:py-8",children:m("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-4 sm:gap-6 lg:gap-8",children:[m("div",{className:"lg:col-span-8 xl:col-span-8 2xl:col-span-9 space-y-4 sm:space-y-6 lg:space-y-8",children:[Xe()>=3&&m("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 sm:p-6",children:[m("div",{className:"flex items-center gap-2 sm:gap-3 mb-4 sm:mb-6",children:[l(Bc,{className:"w-5 h-5 sm:w-6 sm:h-6 text-purple-600"}),l("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:"Performance Analysis"})]}),m("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[m("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-4",children:[m("div",{className:"flex items-center gap-2 mb-2",children:[l(Ki,{className:"w-5 h-5 text-blue-600"}),l("span",{className:"font-medium text-blue-900",children:"Gaming"})]}),m("div",{className:"text-2xl font-bold text-blue-700",children:[Math.round(J.gamingScore),"%"]}),l("div",{className:"w-full bg-blue-200 rounded-full h-2 mt-2",children:l("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-500",style:{width:`${J.gamingScore}%`}})})]}),m("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-4",children:[m("div",{className:"flex items-center gap-2 mb-2",children:[l(sb,{className:"w-5 h-5 text-purple-600"}),l("span",{className:"font-medium text-purple-900",children:"Workstation"})]}),m("div",{className:"text-2xl font-bold text-purple-700",children:[Math.round(J.workstationScore),"%"]}),l("div",{className:"w-full bg-purple-200 rounded-full h-2 mt-2",children:l("div",{className:"bg-purple-600 h-2 rounded-full transition-all duration-500",style:{width:`${J.workstationScore}%`}})})]}),m("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-4",children:[m("div",{className:"flex items-center gap-2 mb-2",children:[l(ta,{className:"w-5 h-5 text-green-600"}),l("span",{className:"font-medium text-green-900",children:"Cooling"})]}),m("div",{className:"text-2xl font-bold text-green-700",children:[Math.round(J.coolingScore),"%"]}),l("div",{className:"w-full bg-green-200 rounded-full h-2 mt-2",children:l("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-500",style:{width:`${J.coolingScore}%`}})})]}),m("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 rounded-lg p-4",children:[m("div",{className:"flex items-center gap-2 mb-2",children:[l(Hi,{className:"w-5 h-5 text-orange-600"}),l("span",{className:"font-medium text-orange-900",children:"Upgrade Path"})]}),m("div",{className:"text-2xl font-bold text-orange-700",children:[Math.round(J.upgradeScore),"%"]}),l("div",{className:"w-full bg-orange-200 rounded-full h-2 mt-2",children:l("div",{className:"bg-orange-600 h-2 rounded-full transition-all duration-500",style:{width:`${J.upgradeScore}%`}})})]})]})]}),m("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[m("div",{className:"flex items-center justify-between mb-6",children:[m("div",{className:"flex items-center gap-3",children:[l("div",{className:"p-2 bg-green-100 rounded-lg",children:l(md,{className:"w-5 h-5 text-green-600"})}),m("div",{children:[l("h2",{className:"text-xl font-semibold text-gray-900",children:"Build Progress"}),l("p",{className:"text-sm text-gray-600",children:"Track your component selection progress"})]})]}),m("div",{className:"flex items-center gap-4",children:[m("div",{className:"text-right",children:[m("div",{className:"text-2xl font-bold text-green-600",children:[Xe(),"/",_e()]}),l("div",{className:"text-sm text-gray-600",children:"components selected"})]}),m("div",{className:"w-16 h-16 relative",children:[m("svg",{className:"w-16 h-16 transform -rotate-90",viewBox:"0 0 36 36",children:[l("path",{className:"text-gray-200",stroke:"currentColor",strokeWidth:"3",fill:"none",d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"}),l("path",{className:"text-green-600",stroke:"currentColor",strokeWidth:"3",fill:"none",strokeDasharray:`${Xe()/_e()*100}, 100`,d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"})]}),l("div",{className:"absolute inset-0 flex items-center justify-center",children:m("span",{className:"text-sm font-semibold text-gray-700",children:[Math.round(Xe()/_e()*100),"%"]})})]})]})]}),l("div",{className:"grid grid-cols-4 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 xl:grid-cols-8 2xl:grid-cols-8 gap-2 sm:gap-3 lg:gap-4",children:ct.map((C,M)=>{const B=u[C.key],O=M+1===p,F=M+1<p;C.key==="cpu"||C.key==="motherboard"||je().has(C.key);const H=C.icon;return l("div",{className:`relative group cursor-pointer ${O?"scale-105":""}`,onClick:()=>x(M+1),children:m("div",{className:`
                        w-full aspect-square rounded-lg border-2 flex flex-col items-center justify-center p-2 transition-all duration-200
                        ${B?"bg-green-50 border-green-500 text-green-700":O?"bg-blue-50 border-blue-500 text-blue-700":F?"bg-gray-50 border-gray-300 text-gray-600":"bg-white border-gray-200 text-gray-400 hover:border-gray-300"}
                      `,children:[l(H,{className:`w-6 h-6 mb-1 ${B?"text-green-600":O?"text-blue-600":""}`}),l("span",{className:"text-xs font-medium text-center leading-tight",children:C.name}),B&&l(yt,{className:"w-4 h-4 text-green-600 absolute -top-1 -right-1"})]})},C.key)})})]}),g&&m("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl border border-blue-200 p-6",children:[m("div",{className:"flex items-center gap-3 mb-4",children:[l(qa,{className:"w-6 h-6 text-blue-600"}),l("h3",{className:"text-lg font-semibold text-blue-900",children:"Building Tips"})]}),m("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-blue-800",children:[m("div",{className:"flex items-start gap-2",children:[l(MT,{className:"w-4 h-4 mt-0.5 text-blue-600 flex-shrink-0"}),l("span",{children:"Start with CPU and motherboard - they determine compatibility for other parts"})]}),m("div",{className:"flex items-start gap-2",children:[l(na,{className:"w-4 h-4 mt-0.5 text-blue-600 flex-shrink-0"}),l("span",{children:"Ensure your power supply has enough wattage for all components"})]}),m("div",{className:"flex items-start gap-2",children:[l(Bc,{className:"w-4 h-4 mt-0.5 text-blue-600 flex-shrink-0"}),l("span",{children:"Consider future upgrades when choosing motherboard and case"})]}),m("div",{className:"flex items-start gap-2",children:[l(ho,{className:"w-4 h-4 mt-0.5 text-blue-600 flex-shrink-0"}),l("span",{children:"Don't rush - take time to research and compare components"})]})]})]}),m("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[l("div",{className:"bg-gradient-to-r from-green-600 to-green-700 px-6 py-4",children:m("div",{className:"flex items-center gap-3",children:[(()=>{const M=Ke().icon;return l(M,{className:"w-6 h-6 text-white"})})(),m("div",{children:[m("h2",{className:"text-xl font-semibold text-white",children:["Select ",Ke().name]}),l("p",{className:"text-green-100 text-sm",children:Ke().description})]})]})}),m("div",{className:"p-4 sm:p-6 lg:p-8",children:[l("div",{className:"mb-8",children:l("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-200 p-4 sm:p-6 mb-4 sm:mb-6",children:m("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-3 sm:gap-4",children:[m("div",{className:"flex-1",children:[m("div",{className:"flex items-center gap-3 mb-3",children:[l("div",{className:"p-2 bg-blue-100 rounded-lg",children:l(na,{className:"w-5 h-5 text-blue-600"})}),m("div",{children:[l("h3",{className:"text-lg font-semibold text-gray-900",children:"Compatibility Score"}),l("p",{className:"text-sm text-gray-600",children:"Overall system compatibility rating"})]})]}),m("div",{className:"space-y-3",children:[m("div",{className:"flex items-center justify-between",children:[l("span",{className:"text-sm font-medium text-gray-700",children:"System Compatibility"}),m("span",{className:`text-lg font-bold ${Lt(Ae)}`,children:[Ae,"%"]})]}),m("div",{className:"relative",children:[l("div",{className:"w-full bg-gray-200 rounded-full h-4 overflow-hidden",children:l("div",{className:`h-4 rounded-full transition-all duration-1000 ease-out ${Lt(Ae,!0)}`,style:{width:`${Ae}%`}})}),m("div",{className:"flex justify-between mt-1 text-xs text-gray-500",children:[l("span",{children:"0%"}),l("span",{children:"25%"}),l("span",{children:"50%"}),l("span",{children:"75%"}),l("span",{children:"100%"})]})]}),l("div",{className:`p-3 rounded-lg border-l-4 ${xe(Ae)}`,children:l("p",{className:`text-sm font-medium ${Ie(Ae)}`,children:ut(Ae)})})]})]}),m("div",{className:"flex flex-col gap-4",children:[m("button",{onClick:()=>j(!0),className:"flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium shadow-sm",children:[l(_8,{className:"w-4 h-4"}),"Compare Compatibility"]}),l("div",{className:"text-sm text-gray-700 text-center",children:ot()}),m("div",{className:"bg-white rounded-lg border border-gray-200 p-3",children:[l("div",{className:"flex items-center gap-2 mb-2",children:l("span",{className:"text-sm font-medium text-gray-700",children:"Branch Filter:"})}),m("div",{className:"inline-flex rounded-lg border overflow-hidden shadow-sm",children:[l("button",{className:`px-4 py-2 text-sm font-medium transition-colors ${Qe===null?"bg-green-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,onClick:()=>te(null),type:"button",children:"All Branches"}),l("button",{className:`px-4 py-2 text-sm font-medium border-l transition-colors ${Qe==="BULACAN"?"bg-green-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,onClick:()=>te("BULACAN"),type:"button",children:"Bulacan"}),l("button",{className:`px-4 py-2 text-sm font-medium border-l transition-colors ${Qe==="MARIKINA"?"bg-green-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,onClick:()=>te("MARIKINA"),type:"button",children:"Marikina"})]})]})]})]})})}),l(oL,{selectedComponents:u,onComponentSelect:Ht,onComponentRemove:kr,activeCategory:Ke().key,prefetchedComponents:$e,recommendations:we[Ke().key]||[],loadingRecommendations:Ge[Ke().key]||!1,compatibilityIssues:kt(Ke().key)||[],branch:Qe},`ecs-${E}-${Ke().key}`)]})]})]}),m("div",{className:"lg:col-span-4 xl:col-span-4 2xl:col-span-3 space-y-4 sm:space-y-6 lg:space-y-8",children:[l(lL,{compatibilityStatus:K,compatibilityScore:Ne(),compatibilityDetails:Q,selectionProgress:he()}),m("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-4 sm:p-6",children:[m("div",{className:"mb-4 sm:mb-6 lg:mb-8",children:[m("div",{className:"flex items-center justify-between mb-6",children:[m("div",{className:"flex items-center gap-4",children:[l("div",{className:"p-3 bg-gradient-to-br from-green-100 to-blue-100 rounded-xl",children:l(Vv,{className:"w-7 h-7 text-green-600"})}),m("div",{children:[l("h3",{className:"text-2xl font-bold text-gray-900",children:"Build Summary"}),l("p",{className:"text-gray-600",children:"Track your PC build progress and components"})]})]}),m("div",{className:"text-right",children:[m("div",{className:"text-3xl font-bold text-green-600",children:[Math.round(Xe()/_e()*100),"%"]}),l("div",{className:"text-sm text-gray-600",children:"Complete"})]})]}),m("div",{className:"bg-gradient-to-r from-gray-50 to-blue-50 rounded-xl p-3 sm:p-4 mb-4 sm:mb-6",children:[m("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-0 mb-2 sm:mb-3",children:[l("span",{className:"text-xs sm:text-sm font-semibold text-gray-700",children:"Build Progress"}),m("span",{className:"text-xs sm:text-sm font-bold text-gray-900",children:[Xe(),"/",_e()," Components"]})]}),l("div",{className:"w-full bg-gray-200 rounded-full h-4 mb-3",children:l("div",{className:"bg-gradient-to-r from-green-500 to-green-600 h-4 rounded-full transition-all duration-700 shadow-sm",style:{width:`${Xe()/_e()*100}%`}})}),l("div",{className:`p-3 rounded-lg border-l-4 ${Xe()===0?"bg-blue-50 border-blue-400":Xe()===_e()?"bg-green-50 border-green-400":"bg-yellow-50 border-yellow-400"}`,children:l("p",{className:`text-sm font-medium ${Xe()===0?"text-blue-800":Xe()===_e()?"text-green-800":"text-yellow-800"}`,children:Xe()===0?"Start building by selecting components from the categories above":Xe()===_e()?"Build complete! Ready for final review and ordering":`${_e()-Xe()} more components needed to complete your build`})})]})]}),m("div",{className:"mb-6 sm:mb-8",children:[m("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[l("h4",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Selected Components"}),m("span",{className:"text-xs sm:text-sm text-gray-500",children:[at()," items"]})]}),m("div",{className:"space-y-2 sm:space-y-3 max-h-64 sm:max-h-80 overflow-y-auto pr-1 sm:pr-2",children:[Object.entries(u).map(([C,M])=>M&&l("div",{className:"group bg-gradient-to-r from-gray-50 to-blue-50 rounded-xl border border-gray-200 p-3 sm:p-4 hover:shadow-md transition-all duration-200",children:m("div",{className:"flex items-center justify-between",children:[m("div",{className:"flex items-center gap-2 sm:gap-3 lg:gap-4 flex-1 min-w-0",children:[l("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-br from-green-100 to-blue-100 rounded-xl flex items-center justify-center flex-shrink-0",children:l("span",{className:"text-xs sm:text-sm font-bold text-green-600",children:C==="motherboard"?"MB":C==="gpu"?"GPU":C==="storage"?"SSD":C==="psu"?"PSU":C==="cooler"?"FAN":C.toUpperCase()})}),m("div",{className:"flex-1 min-w-0",children:[l("h5",{className:"font-semibold text-gray-900 text-xs sm:text-sm mb-1 truncate",children:M.name}),m("div",{className:"flex items-center gap-2 sm:gap-3 text-xs text-gray-600",children:[l("span",{className:"font-bold text-green-600 text-xs sm:text-sm",children:gt(M.price)}),l("span",{className:"w-1 h-1 bg-gray-400 rounded-full"}),m("span",{className:"truncate",children:[M.socket&&`Socket: ${M.socket}`,M.memory&&`Memory: ${M.memory}`,M.type&&M.speed&&`${M.type} ${M.speed}`,M.capacity&&`Capacity: ${M.capacity}`,M.wattage&&`${M.wattage}W`,M.size&&`Size: ${M.size}`]})]})]})]}),m("div",{className:"flex items-center gap-2 flex-shrink-0",children:[l("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),l("button",{onClick:()=>kr(C),className:"p-2 text-red-400 hover:text-red-600 rounded-lg hover:bg-red-50 transition-all duration-200 opacity-0 group-hover:opacity-100",title:"Remove component",children:l(an,{className:"w-4 h-4"})})]})]})},C)),at()===0&&m("div",{className:"text-center py-12 bg-gradient-to-br from-gray-50 to-blue-50 rounded-xl border-2 border-dashed border-gray-300",children:[l("div",{className:"p-4 bg-white rounded-full w-20 h-20 mx-auto mb-4 flex items-center justify-center",children:l(Ye,{className:"w-10 h-10 text-gray-400"})}),l("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Components Selected"}),l("p",{className:"text-gray-600 mb-4",children:"Start building by selecting components from the categories above"}),m("div",{className:"flex items-center justify-center gap-2 text-sm text-blue-600",children:[l(Hi,{className:"w-4 h-4"}),l("span",{children:"Choose your first component to begin"})]})]})]})]}),m("div",{className:"bg-gradient-to-r from-gray-50 to-green-50 rounded-xl p-4 sm:p-6 border border-gray-200",children:[m("div",{className:"flex items-center gap-2 sm:gap-3 mb-4 sm:mb-6",children:[l("div",{className:"p-2 bg-green-100 rounded-lg",children:l("span",{className:"text-green-600 text-lg font-bold",children:""})}),l("h4",{className:"text-lg font-semibold text-gray-900",children:"Price Summary"})]}),m("div",{className:"space-y-4 mb-6",children:[m("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200",children:[l("span",{className:"text-gray-600 font-medium",children:"Subtotal:"}),l("span",{className:"text-lg font-semibold text-gray-900",children:gt(re())})]}),m("div",{className:"flex items-center justify-between p-4 bg-gradient-to-r from-green-50 to-blue-50 rounded-lg border-2 border-green-200",children:[m("div",{className:"flex items-center gap-3",children:[l("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:l("span",{className:"text-green-600 font-bold",children:""})}),l("span",{className:"text-lg font-semibold text-gray-900",children:"Total Price:"})]}),l("span",{className:"text-3xl font-bold text-green-600",children:gt(re())})]})]}),m("div",{className:"space-y-4",children:[m("div",{className:"grid grid-cols-1 gap-3",children:[m("button",{onClick:()=>w(!0),className:`flex items-center justify-center gap-3 px-6 py-4 rounded-xl font-semibold text-lg transition-all duration-200 ${a?"bg-gradient-to-r from-green-600 to-green-700 text-white shadow-lg hover:shadow-xl hover:from-green-700 hover:to-green-800 transform hover:scale-105":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,disabled:!a,title:a?"":"Please log in to save builds",children:[l(om,{className:"w-5 h-5"}),oe?"Update Build":"Save Build",!a&&l("span",{className:"text-sm ml-2 opacity-75",children:"(Login Required)"})]}),l("button",{onClick:Nt,className:`flex items-center justify-center gap-3 px-6 py-4 rounded-xl font-semibold text-lg transition-all duration-200 ${Xe()===_e()?Ne()===100?"bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-lg hover:shadow-xl hover:from-blue-700 hover:to-purple-700 transform hover:scale-105":"bg-gradient-to-r from-orange-500 to-red-500 text-white shadow-lg hover:shadow-xl hover:from-orange-600 hover:to-red-600":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,disabled:Xe()<_e(),children:A?m("div",{className:"flex items-center justify-center gap-3",children:[l("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),l("span",{children:"Placing order..."})]}):Xe()===_e()?Ne()===100?m("div",{className:"flex items-center justify-center gap-3",children:[l(Vv,{className:"w-5 h-5"}),l("span",{children:"Complete Build!"})]}):m("div",{className:"flex items-center justify-center gap-3",children:[l($r,{className:"w-5 h-5"}),l("span",{children:"Complete Build (with warnings)"})]}):`Select ${_e()-Xe()} more components`})]}),l("div",{className:"pt-2 border-t border-gray-200",children:m("button",{onClick:_r,className:"w-full flex items-center justify-center gap-3 px-6 py-3 rounded-xl font-semibold text-lg bg-red-50 text-red-600 border border-red-200 hover:bg-red-100 hover:border-red-300 transition-all duration-200",children:[l(an,{className:"w-5 h-5"}),"Clear All Components"]})})]}),Xe()===_e()&&l("div",{className:"text-center text-sm mt-4 p-3 rounded-lg",children:Ne()===100?m("div",{className:"text-green-600 bg-green-50",children:[l("p",{className:"font-medium",children:"Ready to proceed with your build!"}),!u.cooler&&l("p",{className:"text-yellow-600 mt-1 text-xs",children:"Consider adding an aftermarket cooler for better performance"})]}):m("div",{className:"text-orange-600 bg-orange-50",children:[l("p",{className:"font-medium",children:"Build ready with compatibility warnings"}),l("p",{className:"text-xs mt-1",children:"Your build can be completed, but consider reviewing the warnings above for optimal performance"}),!u.cooler&&l("p",{className:"text-yellow-600 mt-1 text-xs",children:"Consider adding an aftermarket cooler for better performance"})]})})]})]})]})]})}),v&&l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:m("div",{className:"bg-white rounded-xl max-w-2xl w-full shadow-2xl max-h-[90vh] overflow-y-auto",children:[l("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-xl",children:m("div",{className:"flex items-center justify-between",children:[m("div",{className:"flex items-center gap-3",children:[l("div",{className:"w-12 h-12 bg-gradient-to-br from-green-500 to-blue-600 rounded-full flex items-center justify-center",children:l(om,{className:"w-6 h-6 text-white"})}),m("div",{children:[l("h2",{className:"text-2xl font-bold text-gray-900",children:oe?"Update Your Build":"Save Your Build"}),l("p",{className:"text-sm text-gray-600",children:"Save your PC configuration for future reference"})]})]}),l("button",{onClick:()=>w(!1),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors",children:l(Gn,{className:"w-6 h-6"})})]})}),l("div",{className:"p-6",children:m("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[m("div",{className:"space-y-6",children:[m("div",{children:[l("label",{htmlFor:"build-name",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Build Name *"}),l("input",{id:"build-name",type:"text",value:L,onChange:C=>z(C.target.value),placeholder:"e.g., Gaming Beast Pro, Workstation Build",className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors ${L.trim()===""?"border-red-300 focus:ring-red-500":"border-gray-300"}`,maxLength:50}),m("p",{className:`text-xs mt-2 ${L.trim()===""?"text-red-500":"text-gray-500"}`,children:[L.length,"/50 characters ",L.trim()===""&&"(Required)"]})]}),m("div",{children:[l("label",{htmlFor:"build-description",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Description (Optional)"}),l("textarea",{id:"build-description",value:X,onChange:C=>Y(C.target.value),placeholder:"Describe your build, intended use, or any special features...",rows:"4",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none transition-colors",maxLength:200}),m("p",{className:"text-xs text-gray-500 mt-2",children:[X.length,"/200 characters"]})]}),l("div",{className:"bg-gray-50 rounded-xl p-4",children:m("div",{className:"flex items-center justify-between mb-3",children:[m("div",{children:[l("h3",{className:"text-sm font-semibold text-gray-900",children:"Build Visibility"}),l("p",{className:"text-xs text-gray-600 mt-1",children:"Your build will be visible to other users in the Community Builds section. You can change this later."})]}),m("div",{className:"flex items-center gap-3",children:[l("span",{className:`text-sm font-medium ${q?"text-green-600":"text-gray-500"}`,children:q?"Public":"Private"}),l("button",{type:"button",onClick:()=>ee(!q),className:`relative inline-flex h-7 w-12 items-center rounded-full transition-colors duration-200 ${q?"bg-green-600":"bg-gray-300"}`,children:l("span",{className:`inline-block h-5 w-5 transform rounded-full bg-white shadow-md transition-transform duration-200 ${q?"translate-x-6":"translate-x-1"}`})})]})]})}),l("div",{className:"bg-blue-50 rounded-xl p-4 border border-blue-200",children:m("div",{className:"flex items-start gap-3",children:[l("div",{className:"mt-1 p-2 bg-blue-100 rounded-full",children:l(iu,{className:"w-5 h-5 text-blue-600"})}),m("div",{className:"flex-1",children:[l("h3",{className:"block text-sm font-semibold text-gray-900 mb-1",children:"Community Review Required"}),l("p",{className:"text-sm text-gray-700 mb-3",children:"All builds are submitted for admin review to ensure quality. Your build will be reviewed before being featured in the Community Builds section."}),m("div",{className:"p-3 bg-blue-100 border border-blue-300 rounded-lg",children:[m("div",{className:"flex items-center gap-2 text-sm text-blue-800 mb-1",children:[l(yt,{className:"w-4 h-4"}),l("span",{className:"font-medium",children:"Review Required"})]}),l("p",{className:"text-xs text-blue-700",children:"Your build will be reviewed by our team. You'll be notified once it's approved or if any changes are needed."})]})]})]})})]}),m("div",{className:"space-y-6",children:[m("div",{className:"bg-gradient-to-br from-green-50 to-blue-50 rounded-xl p-6 border border-green-200",children:[m("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[l(Ye,{className:"w-5 h-5 text-green-600"}),"Build Summary"]}),m("div",{className:"space-y-4",children:[m("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200",children:[m("div",{className:"flex items-center gap-3",children:[l("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:l(Ye,{className:"w-4 h-4 text-blue-600"})}),l("span",{className:"text-sm font-medium text-gray-700",children:"Components"})]}),m("span",{className:"text-lg font-bold text-blue-600",children:[Xe(),"/",_e()]})]}),m("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200",children:[m("div",{className:"flex items-center gap-3",children:[l("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:l(yt,{className:"w-4 h-4 text-green-600"})}),l("span",{className:"text-sm font-medium text-gray-700",children:"Compatibility"})]}),m("span",{className:"text-lg font-bold text-green-600",children:[Ne(),"%"]})]}),m("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200",children:[m("div",{className:"flex items-center gap-3",children:[l("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center",children:l("span",{className:"text-lg font-bold text-purple-600",children:""})}),l("span",{className:"text-sm font-medium text-gray-700",children:"Total Price"})]}),l("span",{className:"text-lg font-bold text-purple-600",children:re().toLocaleString()})]})]})]}),Ne()<100&&m("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4",children:[m("div",{className:"flex items-center gap-2 mb-2",children:[l($r,{className:"w-5 h-5 text-yellow-600"}),l("span",{className:"text-sm font-semibold text-yellow-800",children:"Compatibility Notice"})]}),l("p",{className:"text-xs text-yellow-700",children:"Your build has some compatibility warnings. Consider reviewing the compatibility checker for optimal performance."})]}),m("div",{className:"space-y-3",children:[l("button",{onClick:Ct,disabled:!L.trim()||Fe||V,className:`w-full flex items-center justify-center gap-3 px-6 py-4 rounded-xl font-semibold text-white text-lg transition-all duration-200 shadow-lg ${!L.trim()||Fe?"bg-gray-400 cursor-not-allowed":"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 hover:shadow-xl transform hover:scale-[1.02]"}`,title:L.trim()?Fe?"Cannot save build due to compatibility issues":"Save your build":"Please enter a build name",children:V?m(lt,{children:[l("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),l("span",{children:"Saving..."})]}):m(lt,{children:[l(om,{className:"w-5 h-5"}),l("span",{children:oe?"Update Build":"Save Build"})]})}),l("button",{onClick:()=>w(!1),className:"w-full px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-xl font-medium hover:bg-gray-50 transition-colors",children:"Cancel"})]})]})]})})]})}),R&&l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:m("div",{className:"bg-white rounded-xl max-w-md w-full shadow-2xl",children:[l("div",{className:"p-6 border-b border-gray-200",children:l("h2",{className:"text-xl font-semibold text-gray-900",children:"Order Placed Successfully"})}),m("div",{className:"p-6 space-y-3",children:[l("p",{className:"text-sm text-gray-700",children:"Your PC build has been recorded as a sales order."}),m("div",{className:"flex items-center justify-between text-sm",children:[l("span",{className:"text-gray-600",children:"Order ID:"}),m("span",{className:"font-semibold text-gray-900",children:["#",R.order_id]})]}),m("div",{className:"flex items-center justify-between text-sm",children:[l("span",{className:"text-gray-600",children:"Order Total:"}),m("span",{className:"font-semibold text-green-700",children:["",Number(R.total||0).toLocaleString()]})]})]}),l("div",{className:"p-6 pt-0 flex items-center justify-end gap-3",children:l("button",{onClick:()=>{D(null);try{_r()}catch{}},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Done"})})]})}),k&&l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:m("div",{className:"bg-white rounded-xl max-w-md w-full shadow-2xl",children:[m("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[m("div",{className:"flex items-center gap-3",children:[l("div",{className:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center",children:l(na,{className:"w-5 h-5 text-orange-600"})}),l("h2",{className:"text-xl font-semibold text-gray-900",children:"Login Required"})]}),l("button",{onClick:()=>_(!1),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:l(Gn,{className:"w-5 h-5"})})]}),m("div",{className:"p-6",children:[m("div",{className:"text-center mb-6",children:[l("div",{className:"w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l(na,{className:"w-8 h-8 text-orange-600"})}),l("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Save Your Build"}),l("p",{className:"text-gray-600",children:"You need to be logged in to save your PC build configuration. This will allow you to access your builds later and share them with others."})]}),m("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[l("h4",{className:"font-medium text-gray-900 mb-3",children:"Your Build Preview"}),m("div",{className:"space-y-2 text-sm",children:[m("div",{className:"flex justify-between",children:[l("span",{className:"text-gray-600",children:"Components:"}),m("span",{className:"font-medium",children:[Xe(),"/",_e()," selected"]})]}),m("div",{className:"flex justify-between",children:[l("span",{className:"text-gray-600",children:"Compatibility:"}),m("span",{className:"font-medium text-green-600",children:[Ne(),"%"]})]}),m("div",{className:"flex justify-between",children:[l("span",{className:"text-gray-600",children:"Total Price:"}),m("span",{className:"font-medium text-green-600",children:["",re().toLocaleString()]})]})]})]}),m("div",{className:"flex flex-col gap-3",children:[m("button",{onClick:()=>{_(!1),i("login")},className:"w-full px-4 py-3 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 transition-colors flex items-center justify-center gap-2",children:[l(A8,{className:"w-5 h-5"}),"Login to Save Build"]}),m("button",{onClick:()=>{_(!1),i("register")},className:"w-full px-4 py-3 border-2 border-gray-300 text-gray-700 rounded-lg font-semibold hover:bg-gray-50 transition-colors flex items-center justify-center gap-2",children:[l(Ko,{className:"w-5 h-5"}),"Create Account"]}),l("button",{onClick:()=>_(!1),className:"w-full px-4 py-2 text-gray-500 hover:text-gray-700 transition-colors",children:"Continue building without saving"})]})]})]})}),l(cL,{isOpen:be,onClose:()=>j(!1),selectedComponents:u,currentCategory:Ke().key,allComponents:$e,onComponentSelect:Ht})]}):l("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center",children:m("div",{className:"text-center",children:[l("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-green-600 mx-auto mb-4"}),l("h3",{className:"text-xl font-medium text-gray-900 mb-2",children:"Loading PC Assembly..."}),l("p",{className:"text-gray-600",children:"Please wait while we load your components."})]})})},i3=e=>m("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:[l("div",{className:"bg-white shadow-sm border-b border-gray-200 mb-4 sm:mb-6",children:l("div",{className:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4",children:m("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4",children:[m("div",{className:"flex items-center gap-2 sm:gap-3",children:[l("div",{className:"p-1.5 sm:p-2 bg-purple-100 rounded-lg",children:l(na,{className:"w-5 h-5 sm:w-6 sm:h-6 text-purple-600"})}),m("div",{children:[l("h1",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900",children:"PC Assembly - Admin"}),l("p",{className:"text-xs sm:text-sm text-gray-600",children:"PC building interface with administrative access"})]})]}),l("div",{className:"flex items-center gap-2",children:l("div",{className:"px-2 sm:px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-xs sm:text-sm font-medium",children:"Admin Access"})})]})})}),l("div",{className:"px-2 sm:px-4 lg:px-6 pb-4 sm:pb-6 lg:pb-8",children:l($c,{...e})})]}),UB=e=>m("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:[l("div",{className:"bg-white shadow-sm border-b border-gray-200 mb-4 sm:mb-6",children:l("div",{className:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4",children:m("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4",children:[m("div",{className:"flex items-center gap-2 sm:gap-3",children:[l("div",{className:"p-1.5 sm:p-2 bg-blue-100 rounded-lg",children:l(na,{className:"w-5 h-5 sm:w-6 sm:h-6 text-blue-600"})}),m("div",{children:[l("h1",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900",children:"PC Assembly - Employee"}),l("p",{className:"text-xs sm:text-sm text-gray-600",children:"PC building interface for employee use"})]})]}),l("div",{className:"flex items-center gap-2",children:l("div",{className:"px-2 sm:px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs sm:text-sm font-medium",children:"Employee Access"})})]})})}),l("div",{className:"px-2 sm:px-4 lg:px-6 pb-4 sm:pb-6 lg:pb-8",children:l($c,{...e})})]}),Bu=`${ve}/chat.php`,ju=()=>{const e=localStorage.getItem("token");return e?{Authorization:`Bearer ${e}`}:{}},zB=({user:e,customStyles:t={}})=>{const[r,n]=N.useState(()=>localStorage.getItem("builditpc_chat_session_id")||null),[a,i]=N.useState(()=>localStorage.getItem("builditpc_guest_name")||""),[s,o]=N.useState(()=>localStorage.getItem("builditpc_guest_email")||""),[c,u]=N.useState([]),[d,f]=N.useState(""),[h,p]=N.useState(!1),[x,g]=N.useState(!1),[y,v]=N.useState(null),[w,b]=N.useState("open"),S=N.useRef(null),[k,_]=N.useState(""),[E,P]=N.useState(""),[A,T]=N.useState(0),R=async()=>{if(!(!(e!=null&&e.id)||!r))try{await fetch(`${Bu}?update_last_seen`,{method:"POST",headers:{"Content-Type":"application/json",...ju()},body:JSON.stringify({user_id:e.id,session_id:r})})}catch(q){console.error("Error updating last seen:",q)}};N.useEffect(()=>{if(!r)return;R();const q=async()=>{var V;try{const oe=await(await fetch(`${Bu}?messages&session_id=${r}${e?`&user_id=${e.id}`:""}`,{headers:ju()})).json();oe.success&&(u(oe.messages||[]),(V=S.current)==null||V.scrollIntoView({behavior:"smooth"}))}catch(ae){console.error("Error fetching messages:",ae)}};q();const ee=setInterval(q,2e3);return()=>clearInterval(ee)},[r,e]),N.useEffect(()=>{var q;(q=S.current)==null||q.scrollIntoView({behavior:"smooth"})},[c]),N.useEffect(()=>{a&&localStorage.setItem("builditpc_guest_name",a),s&&localStorage.setItem("builditpc_guest_email",s)},[a,s]);const D=async()=>{g(!0),v(null);try{const ee=await(await fetch(`${Bu}?send`,{method:"POST",headers:{"Content-Type":"application/json",...ju()},body:JSON.stringify({session_id:null,sender:"user",message:d,guest_name:e?void 0:a,guest_email:e?void 0:s,user_id:e?e.id:void 0})})).json();if(ee.error)throw new Error(ee.error);ee.session_id&&(n(ee.session_id),localStorage.setItem("builditpc_chat_session_id",ee.session_id),b("open")),f("")}catch(q){v("Failed to start chat session: "+q.message)}g(!1)},L=async()=>{if(d.trim()){g(!0),v(null);try{if(!r){await D();return}const ee=await(await fetch(`${Bu}?send`,{method:"POST",headers:{"Content-Type":"application/json",...ju()},body:JSON.stringify({session_id:r,sender:"user",message:d})})).json();if(ee.error)throw new Error(ee.error);f(""),p(!1)}catch(q){v("Failed to send message: "+q.message)}g(!1)}},z=q=>{f(q.target.value),!h&&q.target.value.length>0?p(!0):h&&q.target.value.length===0&&p(!1)},X=async()=>{if(window.confirm("Are you sure you want to clear this conversation? This cannot be undone."))try{await fetch(`${Bu}?delete_session`,{method:"POST",headers:{"Content-Type":"application/json",...ju()},body:JSON.stringify({session_id:r})}),n(null),localStorage.removeItem("builditpc_chat_session_id"),u([]),T(0),b("open")}catch{v("Failed to clear conversation")}};if(!e&&!a){const q=()=>{k.trim()&&(i(k.trim()),E.trim()&&o(E.trim()))};return l("div",{className:"flex flex-col items-center h-full max-h-[600px] py-4 px-6",children:m("div",{className:"bg-white rounded-lg w-full max-w-md",children:[m("div",{className:"text-center mb-6",children:[l(Ca,{className:"w-10 h-10 text-green-600 mx-auto mb-2"}),l("h2",{className:"text-xl font-bold text-gray-800 mb-1",children:"Start Chat Support"}),l("p",{className:"text-sm text-gray-600",children:"Get help from our expert team"})]}),m("div",{className:"space-y-4 px-6",children:[m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Your Name *"}),l("input",{type:"text",className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent text-sm",placeholder:"Enter your name",value:k,onChange:ee=>_(ee.target.value),onKeyDown:ee=>{ee.key==="Enter"&&q()}})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email (Optional)"}),l("input",{type:"email",className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent text-sm",placeholder:"Enter your email",value:E,onChange:ee=>P(ee.target.value),onKeyDown:ee=>{ee.key==="Enter"&&q()}})]}),l("div",{className:"pb-4",children:l("button",{className:"w-full bg-green-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm",onClick:q,disabled:!k.trim(),children:"Start Chat"})})]})]})})}return m("div",{className:"flex flex-col h-full bg-white",children:[l("style",{children:`
    /* Common scrollbar styles */
    .custom-scrollbar::-webkit-scrollbar {
      width: 10px;
      height: 10px;
    }
    .custom-scrollbar::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 6px;
    }
    .custom-scrollbar::-webkit-scrollbar-thumb {
      background: #c1c1c1;
      border-radius: 6px;
      border: 2px solid #f1f1f1;
    }
    .custom-scrollbar::-webkit-scrollbar-thumb:hover {
      background: #a8a8a8;
    }
    
    /* Firefox */
    .custom-scrollbar {
      scrollbar-width: thin;
      scrollbar-color: #c1c1c1 #f1f1f1;
    }
    
    /* Ensure smooth scrolling on all devices */
    .custom-scrollbar {
      -webkit-overflow-scrolling: touch;
      -ms-overflow-style: -ms-autohiding-scrollbar;
      overflow-y: auto;
    }
    
    /* Messages area specific styles */
    .messages-area::-webkit-scrollbar-thumb {
      background: #c1c1c1;
      border: 2px solid #ffffff;
    }
    
    /* For smaller screens */
    @media (max-width: 640px) {
      .custom-scrollbar::-webkit-scrollbar {
        width: 6px;
        height: 6px;
      }
    }
  `}),l("div",{className:"border-b border-gray-200 bg-white p-3 flex justify-end",children:r&&m("button",{onClick:X,className:"flex items-center gap-1 text-red-600 hover:text-red-700 text-sm font-medium px-3 py-1.5 rounded-md hover:bg-red-50 transition-colors",title:"Clear Conversation",children:[l(an,{className:"w-4 h-4"}),"Clear Chat"]})}),l("div",{className:"flex-grow overflow-y-auto custom-scrollbar messages-area",style:{maxHeight:"calc(100vh - 250px)",WebkitOverflowScrolling:"touch"},children:m("div",{className:"p-6 space-y-4",children:[c.length===0?m("div",{className:"flex flex-col items-center justify-start min-h-[250px] pt-8",children:[l("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Welcome to BuildIT PC Support"}),l("p",{className:"text-sm text-gray-600 text-center max-w-sm mb-6",children:"Our support team is here to help! Type your message below."})]}):c.map((q,ee)=>l("div",{className:`flex items-start gap-2 ${q.sender==="user"?"justify-end":"justify-start"}`,children:m("div",{className:`group relative rounded-lg px-4 py-3 max-w-[80%] shadow-sm ${q.sender==="user"?"bg-green-600 text-white":"bg-gray-100 text-gray-800"}`,children:[l("div",{className:"text-sm whitespace-pre-wrap",children:q.message}),l("div",{className:`text-xs mt-1 ${q.sender==="user"?"text-green-100":"text-gray-500"}`,children:new Date(q.sent_at).toLocaleTimeString()})]})},q.id||ee)),h&&l("div",{className:"flex justify-start",children:l("div",{className:"bg-gray-100 rounded-lg px-4 py-3",children:m("div",{className:"flex items-center gap-1",children:[l("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),l("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),l("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})}),l("div",{ref:S})]})}),m("div",{className:"mt-auto border-t bg-white",children:[y&&l("div",{className:"bg-red-50 border border-red-200 text-red-700 p-4 text-center text-sm",children:y}),m("div",{className:"p-4 flex items-center gap-3",children:[l("input",{type:"text",className:"flex-grow p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:w==="resolved"?"Chat resolved. Start a new conversation...":"Type your message...",value:d,onChange:z,onKeyDown:q=>{q.key==="Enter"&&!q.shiftKey&&(q.preventDefault(),L())},disabled:x||w==="resolved"}),m("button",{onClick:L,disabled:x||!d.trim()||w==="resolved",className:`p-3 rounded-lg font-semibold flex items-center gap-2 transition-colors min-w-[90px] justify-center ${x||w==="resolved"?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"}`,children:[l(Il,{className:"w-5 h-5"}),x?"Sending...":"Send"]})]}),w==="resolved"&&l("div",{className:"bg-yellow-50 border-t border-yellow-100 px-4 py-2 text-center text-sm text-yellow-700",children:"This chat has been marked as resolved. Start a new conversation to continue."})]})]})},es=`${ve}/chat.php`,ts=()=>{const e=localStorage.getItem("token");return e?{Authorization:`Bearer ${e}`}:{}},HB=({user:e})=>{const[t,r]=N.useState([]),[n,a]=N.useState(null),[i,s]=N.useState(""),[o,c]=N.useState(""),[u,d]=N.useState([]),[f,h]=N.useState(!0),[p,x]=N.useState(!1),[g,y]=N.useState(null),[v,w]=N.useState(null),[b,S]=N.useState(!1),[k,_]=N.useState(""),[E,P]=N.useState(!1),A=N.useRef(null),T=N.useRef(null),R=()=>{var K;if(T.current){const le=T.current;le.scrollHeight-le.scrollTop<=le.clientHeight+100&&((K=A.current)==null||K.scrollIntoView({behavior:"smooth"}))}};N.useEffect(()=>{R()},[u]);const D=K=>K?K.includes("Admin")?l("span",{className:"inline-block bg-purple-100 text-purple-700 px-2 py-0.5 rounded-full text-xs font-semibold ml-2",children:"Admin"}):K.includes("Employee")?l("span",{className:"inline-block bg-blue-100 text-blue-700 px-2 py-0.5 rounded-full text-xs font-semibold ml-2",children:"Employee"}):null:null,L=K=>K?l("span",{className:"inline-block bg-green-100 text-green-700 px-2 py-0.5 rounded-full text-xs font-semibold ml-2",children:"Active"}):l("span",{className:"inline-block bg-red-100 text-red-700 px-2 py-0.5 rounded-full text-xs font-semibold ml-2",children:"Disabled"}),z=K=>{const le={low:"bg-gray-100 text-gray-700",normal:"bg-blue-100 text-blue-700",high:"bg-orange-100 text-orange-700",urgent:"bg-red-100 text-red-700"};return l("span",{className:`inline-block ${le[K]||le.normal} px-2 py-0.5 rounded-full text-xs font-semibold`,children:K?K.charAt(0).toUpperCase()+K.slice(1):"Normal"})},X=async()=>{try{const le=await(await fetch(`${es}?stats`,{headers:ts()})).json();le.success&&w(le.stats)}catch(K){console.error("Error fetching stats:",K)}},Y=async()=>{h(!0);try{const le=await(await fetch(`${es}?sessions`,{headers:ts()})).json();le.success?(r(le.sessions||[]),le.sessions&&le.sessions.length>0&&!n&&a(le.sessions[0].id)):le.error&&y(le.error)}catch{y("Failed to load chat sessions.")}h(!1)},q=async()=>{if(n){x(!0);try{const le=await(await fetch(`${es}?messages&session_id=${n}`,{headers:ts()})).json();le.success&&d(le.messages||[])}catch{y("Failed to load messages.")}x(!1)}};N.useEffect(()=>{Y(),X()},[]);const ee=t.filter(K=>{const le=i.toLowerCase(),Q=(K.username||"").toLowerCase(),ce=(K.guest_name||"").toLowerCase(),be=(K.guest_email||"").toLowerCase();return["debug test user","test user","debug@test.com","test@example.com"].some($e=>ce===$e||be===$e||Q===$e)?!1:!le||Q.includes(le)||ce.includes(le)||be.includes(le)});N.useEffect(()=>{ee.length===0?a(null):ee.some(K=>K.id===n)||a(ee[0].id)},[ee,n]),N.useEffect(()=>{n&&q()},[n]),N.useEffect(()=>{const K=setInterval(()=>{Y()},1e4);return()=>clearInterval(K)},[]),N.useEffect(()=>{const K=setInterval(()=>{n&&q()},5e3);return()=>clearInterval(K)},[n]);const V=t.find(K=>K.id===n),ae=async()=>{if(!(!o.trim()||!n))try{(await(await fetch(`${es}?send`,{method:"POST",headers:{"Content-Type":"application/json",...ts()},body:JSON.stringify({session_id:n,message:o.trim(),sender:"admin"})})).json()).success&&(c(""),q(),Y())}catch{y("Failed to send message.")}},oe=async()=>{P(!0)},I=async()=>{try{(await(await fetch(`${es}?reopen`,{method:"POST",headers:{"Content-Type":"application/json",...ts()},body:JSON.stringify({session_id:n})})).json()).success&&(Y(),q())}catch{y("Failed to reopen chat.")}},W=async K=>{try{(await(await fetch(`${es}?update_priority`,{method:"POST",headers:{"Content-Type":"application/json",...ts()},body:JSON.stringify({session_id:n,priority:K})})).json()).success&&Y()}catch{y("Failed to update priority.")}},U=async K=>{if(confirm("Are you sure you want to delete this message?"))try{(await(await fetch(`${es}?delete_message`,{method:"POST",headers:{"Content-Type":"application/json",...ts()},body:JSON.stringify({message_id:K})})).json()).success&&q()}catch{y("Failed to delete message.")}},G=async K=>{if(confirm("Are you sure you want to delete this chat session? This action cannot be undone."))try{(await(await fetch(`${es}?delete_session`,{method:"POST",headers:{"Content-Type":"application/json",...ts()},body:JSON.stringify({session_id:K})})).json()).success&&(n===K&&(a(null),d([])),Y())}catch{y("Failed to delete chat session.")}},ne=async()=>{try{(await(await fetch(`${es}?resolve`,{method:"POST",headers:{"Content-Type":"application/json",...ts()},body:JSON.stringify({session_id:n,resolution_notes:k})})).json()).success&&(P(!1),_(""),Y(),q())}catch{y("Failed to resolve chat.")}};return m("div",{className:"flex h-screen w-full bg-gray-50 overflow-hidden",style:{margin:0,padding:0},children:[m("div",{className:"w-1/3 min-w-[350px] max-w-sm border-r bg-white flex flex-col shadow-lg h-full",children:[m("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 flex-shrink-0",children:[l("h2",{className:"page-title",children:"Chat Support"}),m("div",{className:"flex items-center gap-2",children:[l("button",{onClick:()=>S(!b),className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",title:"Toggle Statistics",children:l(zd,{className:"w-5 h-5"})}),l("button",{onClick:()=>{Y(),X()},className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",title:"Refresh",children:l(v0,{className:"w-5 h-5"})})]})]}),b&&v&&m("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-3 border-b border-blue-200 flex-shrink-0",children:[l("h3",{className:"font-semibold text-blue-800 mb-2 text-sm",children:"Today's Statistics"}),m("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[m("div",{className:"bg-white p-2 rounded-lg border shadow-sm",children:[l("div",{className:"text-blue-600 font-bold text-lg",children:v.open_sessions}),l("div",{className:"text-gray-600 text-xs",children:"Open Chats"})]}),m("div",{className:"bg-white p-2 rounded-lg border shadow-sm",children:[l("div",{className:"text-green-600 font-bold text-lg",children:v.today_sessions}),l("div",{className:"text-gray-600 text-xs",children:"Today's Total"})]}),m("div",{className:"bg-white p-2 rounded-lg border shadow-sm",children:[l("div",{className:"text-purple-600 font-bold text-lg",children:v.total_sessions}),l("div",{className:"text-gray-600 text-xs",children:"All Time"})]}),m("div",{className:"bg-white p-2 rounded-lg border shadow-sm",children:[m("div",{className:"text-orange-600 font-bold text-lg",children:[v.avg_response_time,"m"]}),l("div",{className:"text-gray-600 text-xs",children:"Avg Response"})]})]})]}),l("div",{className:"p-4 border-b border-gray-200 flex-shrink-0",children:m("div",{className:"relative",children:[l(Wi,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),l("input",{type:"text",placeholder:"Search user or email...",className:"w-full pl-12 pr-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-transparent bg-gray-50",value:i,onChange:K=>s(K.target.value)})]})}),l("div",{className:"flex-1 overflow-y-auto min-h-0 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100",children:f?m("div",{className:"flex items-center justify-center h-32 text-gray-400",children:[l(v0,{className:"w-5 h-5 animate-spin mr-2"}),"Loading chats..."]}):m("div",{className:"p-4",children:[ee.map(K=>l("div",{className:`p-4 rounded-lg cursor-pointer transition-all duration-200 mb-2 ${n===K.id?"bg-green-50 border-2 border-green-500 shadow-lg":"hover:bg-gray-50 border border-gray-200 hover:border-gray-300"}`,onClick:()=>a(K.id),children:m("div",{className:"flex items-start justify-between",children:[m("div",{className:"flex-1 min-w-0",children:[m("div",{className:"flex items-center gap-2 mb-2",children:[l("div",{className:"font-semibold truncate flex items-center gap-2",children:K.user_id?m(lt,{children:[l(BS,{className:"inline w-5 h-5 text-green-500",title:"Registered User"}),K.username||`User #${K.user_id}`]}):m(lt,{children:[l(LS,{className:"inline w-5 h-5 text-gray-400",title:"Guest"}),K.guest_name||"Guest"]})}),z(K.priority)]}),l("div",{className:"text-sm text-gray-500 truncate mb-1",children:K.guest_email||""}),l("div",{className:"text-xs text-gray-400",children:K.last_message_time?new Date(K.last_message_time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""})]}),m("div",{className:"flex items-center gap-2 ml-3",children:[K.unread_messages>0&&l("div",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full font-semibold min-w-[22px] text-center",children:K.unread_messages}),K.status==="resolved"?l(yt,{className:"w-5 h-5 text-green-500",title:"Resolved"}):l(Ca,{className:"w-5 h-5 text-blue-500",title:"Open"}),l("button",{className:"text-red-400 hover:text-red-600 opacity-80 hover:opacity-100 transition-opacity",title:"Delete chat session",onClick:le=>{le.stopPropagation(),G(K.id)},children:l(an,{className:"w-4 h-4"})})]})]})},K.id)),ee.length===0&&!f&&m("div",{className:"text-center py-12 text-gray-400",children:[l(Ca,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),l("div",{className:"text-lg font-medium mb-2",children:"No chats found"}),l("div",{className:"text-sm",children:"Start a conversation to see it here"})]})]})})]}),m("div",{className:"flex-1 flex flex-col bg-white overflow-hidden h-full min-h-0",children:[g&&l("div",{className:"bg-red-50 border border-red-200 text-red-700 p-4 text-center text-sm flex-shrink-0",children:g}),V?m("div",{className:"flex flex-col h-full min-h-0",children:[m("div",{className:"flex items-center justify-between bg-white px-6 py-6 border-b border-gray-200 shadow-sm flex-shrink-0",children:[m("div",{className:"flex-1",children:[m("div",{className:"font-bold text-xl flex items-center gap-3 mb-2",children:[V.user_id?m(lt,{children:[l(BS,{className:"inline w-6 h-6 text-green-500",title:"Registered User"}),V.username||`User #${V.user_id}`]}):m(lt,{children:[l(LS,{className:"inline w-6 h-6 text-gray-400",title:"Guest"}),V.guest_name||"Guest"]}),D((e==null?void 0:e.roles)||[]),l("span",{className:`inline-block ${V.status==="resolved"?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"} px-2 py-0.5 rounded-full text-xs font-semibold`,children:V.status==="resolved"?"Resolved":"Open"}),typeof(e==null?void 0:e.is_active)=="boolean"&&L(!!e.is_active),z(V.priority)]}),l("div",{className:"text-sm text-gray-500 mb-1",children:V.guest_email||""}),m("div",{className:"text-xs text-gray-400",children:["Created ",V.created_at?new Date(V.created_at).toLocaleDateString():""]})]}),m("div",{className:"flex items-center gap-4",children:[m("select",{value:V.priority||"normal",onChange:K=>W(K.target.value),className:"border border-gray-300 rounded-lg px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-green-400 bg-white",children:[l("option",{value:"low",children:"Low Priority"}),l("option",{value:"normal",children:"Normal"}),l("option",{value:"high",children:"High"}),l("option",{value:"urgent",children:"Urgent"})]}),V.status==="resolved"?m("button",{className:"bg-blue-500 text-white px-6 py-2 rounded-lg flex items-center hover:bg-blue-600 transition-colors shadow-sm",onClick:I,children:[l(v0,{className:"w-4 h-4 mr-2"})," Reopen"]}):m("button",{className:"bg-green-500 text-white px-6 py-2 rounded-lg flex items-center hover:bg-green-600 transition-colors shadow-sm",onClick:oe,children:[l(yt,{className:"w-4 h-4 mr-2"})," Resolve"]})]})]}),l("div",{ref:T,className:"flex-1 overflow-y-auto overflow-x-hidden bg-gray-50 p-4 min-h-0",style:{scrollbarWidth:"thin",scrollbarColor:"#9ca3af #f1f5f9",flex:"1 1 auto",minHeight:"0px"},children:p?m("div",{className:"flex items-center justify-center h-32 text-gray-400",children:[l(v0,{className:"w-5 h-5 animate-spin mr-2"}),"Loading messages..."]}):u.length===0?l("div",{className:"flex items-center justify-center h-full text-gray-400",children:m("div",{className:"text-center",children:[l(Ca,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),l("div",{className:"text-lg font-medium mb-2",children:"No messages yet"}),l("div",{className:"text-sm",children:"Start the conversation by sending a message"})]})}):m("div",{className:"space-y-4",children:[u.map((K,le)=>l("div",{className:`flex ${K.sender==="admin"?"justify-end":"justify-start"}`,children:m("div",{className:`group relative max-w-xs lg:max-w-md xl:max-w-lg ${K.sender==="admin"?"ml-auto":"mr-auto"}`,children:[m("div",{className:`relative rounded-2xl px-5 py-4 shadow-sm ${K.sender==="admin"?"bg-green-500 text-white":K.message_type==="system"?"bg-gray-200 text-gray-700 border border-gray-300":"bg-white text-gray-800 border border-gray-200"}`,children:[l("button",{className:"absolute -top-2 -right-2 opacity-0 group-hover:opacity-100 transition-opacity bg-red-500 text-white rounded-full p-1.5 hover:bg-red-600 z-10 shadow-lg",title:"Delete message",onClick:()=>U(K.id),children:l(an,{className:"w-3 h-3"})}),l("div",{className:"text-sm whitespace-pre-wrap break-words leading-relaxed",children:K.message}),K.message_type!=="text"&&l("div",{className:"text-xs opacity-70 mt-2 pt-2 border-t border-opacity-20",children:K.message_type})]}),l("div",{className:`text-xs text-gray-500 mt-2 ${K.sender==="admin"?"text-right":"text-left"}`,children:K.sent_at?new Date(K.sent_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""})]})},K.id||le)),l("div",{ref:A})]})}),l("div",{className:"px-6 py-4 border-t border-gray-200 bg-white flex-shrink-0 sticky bottom-0",children:m("div",{className:"flex items-center gap-3",children:[l("div",{className:"flex-1 relative",children:l("input",{type:"text",className:"w-full border border-gray-300 rounded-2xl px-6 py-3 pr-16 focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-transparent resize-none text-base",placeholder:"Type your reply...",value:o,onChange:K=>c(K.target.value),onKeyDown:K=>{K.key==="Enter"&&!K.shiftKey&&(K.preventDefault(),ae())}})}),l("button",{className:"bg-green-500 text-white p-2 rounded-full hover:bg-green-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed shadow-lg",onClick:ae,disabled:!o.trim(),children:l(Il,{className:"w-5 h-5"})})]})})]}):l("div",{className:"flex-1 flex items-center justify-center text-gray-400",children:m("div",{className:"text-center",children:[l(Ca,{className:"w-24 h-24 mx-auto mb-6 opacity-50"}),l("div",{className:"text-2xl font-medium mb-3",children:"Select a chat to view messages"}),l("div",{className:"text-base",children:"Choose a conversation from the sidebar to start responding"})]})})]}),E&&l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:m("div",{className:"bg-white rounded-xl p-8 w-full max-w-md mx-4 shadow-2xl",children:[l("h3",{className:"text-xl font-bold mb-6",children:"Resolve Chat Session"}),l("textarea",{className:"w-full border border-gray-300 rounded-lg px-4 py-3 mb-6 focus:outline-none focus:ring-2 focus:ring-green-400 resize-none",placeholder:"Add resolution notes (optional)...",value:k,onChange:K=>_(K.target.value),rows:4}),m("div",{className:"flex gap-3 justify-end",children:[l("button",{className:"px-6 py-2 text-gray-600 hover:text-gray-800 transition-colors",onClick:()=>{P(!1),_("")},children:"Cancel"}),l("button",{className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",onClick:ne,children:"Resolve"})]})]})})]})},pd=({user:e,fullScreen:t=!1,customStyles:r={},hideHeader:n=!1})=>{var f,h,p,x;const[a,i]=N.useState(null),[s,o]=N.useState(!0),[c,u]=N.useState(null);if(N.useEffect(()=>{(async()=>{try{const y=localStorage.getItem("token"),v=await fetch(`${ve}/chat.php?check_permissions`,{headers:{Authorization:`Bearer ${y}`}});if(!v.ok)throw new Error(`HTTP error! status: ${v.status}`);const w=await v.json();w.success?i(w):i({hasPermission:!1,canRead:!1,canWrite:!1})}catch(y){console.error("Error checking permissions:",y),i({hasPermission:!1,canRead:!1,canWrite:!1}),u("Failed to load chat support")}finally{o(!1)}})()},[e]),s)return l("div",{className:"flex items-center justify-center h-64",children:m("div",{className:"text-center",children:[l(Ca,{className:"w-8 h-8 animate-pulse text-green-600 mx-auto mb-2"}),l("div",{className:"text-gray-600",children:"Loading chat support..."})]})});if(c)return l("div",{className:"flex items-center justify-center h-64",children:m("div",{className:"text-center text-red-600",children:[l($r,{className:"w-8 h-8 mx-auto mb-2"}),l("div",{children:c})]})});const d=()=>{var g,y;return a!=null&&a.canRead&&((g=e==null?void 0:e.roles)!=null&&g.includes("Admin")||(y=e==null?void 0:e.roles)!=null&&y.includes("Employee"))?l("div",{className:t?"h-screen":"h-full",children:l(HB,{user:e})}):l("div",{className:t?"h-screen":"h-full",children:l(zB,{user:e,customStyles:r,hideHeader:n})})};return a&&!a.hasPermission&&e&&((f=e.roles)!=null&&f.includes("Admin")||(h=e.roles)!=null&&h.includes("Employee"))?l("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:m("div",{className:"text-center max-w-md mx-auto p-8",children:[l(na,{className:"w-16 h-16 text-red-500 mx-auto mb-6"}),l("h3",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Access Restricted"}),l("p",{className:"text-gray-600 mb-6 text-lg",children:"You don't have permission to access chat support management."}),l("p",{className:"text-sm text-gray-500 mb-6",children:"Your access to this feature has been disabled by a Super Admin."}),l("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:m("p",{className:"text-yellow-800 text-sm",children:[l("strong",{children:"Need access?"})," Contact your Super Administrator to enable chat support permissions for your account."]})})]})}):!s&&!a&&e&&((p=e.roles)!=null&&p.includes("Admin")||(x=e.roles)!=null&&x.includes("Employee"))?l("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:m("div",{className:"text-center max-w-md mx-auto p-8",children:[l($r,{className:"w-16 h-16 text-yellow-500 mx-auto mb-6"}),l("h3",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Unable to Load Chat Support"}),l("p",{className:"text-gray-600 mb-6 text-lg",children:"There was an error loading your chat support permissions."}),l("p",{className:"text-sm text-gray-500 mb-6",children:"Please try refreshing the page or contact your administrator."}),l("button",{onClick:()=>window.location.reload(),className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors",children:"Refresh Page"})]})}):!s&&a===null?l("div",{className:"flex items-center justify-center h-64",children:m("div",{className:"text-center text-gray-600",children:[l($r,{className:"w-8 h-8 mx-auto mb-2"}),l("div",{children:"Loading chat support..."})]})}):l("div",{className:"relative",children:d()})},s3=({buildId:e,user:t,className:r=""})=>{const[n,a]=N.useState([]),[i,s]=N.useState(!0),[o,c]=N.useState(!1),[u,d]=N.useState(""),[f,h]=N.useState(null),[p,x]=N.useState(null),[g,y]=N.useState(""),[v,w]=N.useState({}),[b,S]=N.useState(""),k=async()=>{try{s(!0);const z=await(await fetch(`${ve}/build_comments.php?action=list&build_id=${e}`)).json();z.success?a(z.data):S(z.error||"Failed to load comments")}catch(L){console.error("Failed to load comments:",L),S("Failed to load comments. Please refresh the page.")}finally{s(!1)}};N.useEffect(()=>{e&&k()},[e]);const _=async L=>{if(L.preventDefault(),!(!u.trim()||o))try{c(!0),S("");const X=await(await qe(`${ve}/build_comments.php?action=add`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({build_id:e,comment_text:u.trim(),parent_id:f})})).json();X.success?(d(""),h(null),await k()):S(X.error||"Failed to submit comment")}catch(z){console.error("Comment submission error:",z),S("Failed to submit comment. Please try again.")}finally{c(!1)}},E=async L=>{if(g.trim())try{const X=await(await qe(`${ve}/build_comments.php?action=edit`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({comment_id:L,comment_text:g.trim()})})).json();X.success?(x(null),y(""),await k()):S(X.error||"Failed to update comment")}catch{S("Failed to update comment")}},P=async L=>{if(confirm("Are you sure you want to delete this comment?"))try{const X=await(await qe(`${ve}/build_comments.php?action=delete&comment_id=${L}`,{method:"DELETE"})).json();X.success?await k():S(X.error||"Failed to delete comment")}catch{S("Failed to delete comment")}},A=L=>{const z=new Date(L),Y=Math.floor((new Date-z)/(1e3*60*60));return Y<1?"Just now":Y<24?`${Y}h ago`:Y<168?`${Math.floor(Y/24)}d ago`:z.toLocaleDateString()},T=L=>L.first_name&&L.last_name?`${L.first_name} ${L.last_name}`:L.username||"Anonymous",R=L=>t&&(t.id===L.user_id||t.role==="admin"||t.role==="super_admin"),D=(L,z=0)=>{const X=z>0;return l("div",{className:`${X?"ml-8 mt-3":"mb-4"}`,children:m("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[m("div",{className:"flex items-start justify-between",children:[m("div",{className:"flex items-center gap-2 mb-2",children:[l("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:l(Ko,{className:"w-4 h-4 text-white"})}),m("div",{children:[l("div",{className:"font-medium text-gray-900",children:T(L)}),m("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[l(ho,{className:"w-3 h-3"}),l("span",{children:A(L.created_at)}),L.is_edited&&l("span",{className:"text-xs text-gray-400",children:"(edited)"})]})]})]}),R(L)&&m("div",{className:"relative",children:[l("button",{onClick:()=>w(Y=>({...Y,[L.id]:!Y[L.id]})),className:"p-1 hover:bg-gray-200 rounded-full",children:l(R8,{className:"w-4 h-4 text-gray-500"})}),v[L.id]&&m("div",{className:"absolute right-0 top-8 bg-white border border-gray-200 rounded-lg shadow-lg z-10",children:[m("button",{onClick:()=>{x(L.id),y(L.comment_text),w(Y=>({...Y,[L.id]:!1}))},className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left",children:[l(M8,{className:"w-3 h-3"}),"Edit"]}),m("button",{onClick:()=>{P(L.id),w(Y=>({...Y,[L.id]:!1}))},className:"flex items-center gap-2 px-3 py-2 text-sm text-red-600 hover:bg-red-50 w-full text-left",children:[l(an,{className:"w-3 h-3"}),"Delete"]})]})]})]}),p===L.id?m("div",{className:"mt-2",children:[l("textarea",{value:g,onChange:Y=>y(Y.target.value),className:"w-full p-2 border border-gray-300 rounded-lg resize-none",rows:"3",maxLength:"1000"}),m("div",{className:"flex gap-2 mt-2",children:[l("button",{onClick:()=>E(L.id),className:"px-3 py-1 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700",children:"Save"}),l("button",{onClick:()=>{x(null),y("")},className:"px-3 py-1 bg-gray-300 text-gray-700 text-sm rounded-lg hover:bg-gray-400",children:"Cancel"})]})]}):l("div",{className:"text-gray-800 whitespace-pre-wrap",children:L.comment_text}),!X&&t&&l("div",{className:"flex gap-2 mt-3",children:m("button",{onClick:()=>h(L.id),className:"flex items-center gap-1 text-sm text-blue-600 hover:text-blue-700",children:[l(F8,{className:"w-3 h-3"}),"Reply"]})}),L.replies&&L.replies.length>0&&l("div",{className:"mt-3",children:L.replies.map(Y=>D(Y,z+1))})]})},L.id)};return i?l("div",{className:`bg-white rounded-lg border border-gray-200 p-6 ${r}`,children:l("div",{className:"flex items-center justify-center py-8",children:l("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):m("div",{className:`bg-white rounded-lg border border-gray-200 ${r}`,children:[m("div",{className:"p-6 border-b border-gray-200",children:[m("div",{className:"flex items-center gap-2 mb-4",children:[l(Gv,{className:"w-5 h-5 text-blue-600"}),m("h3",{className:"text-lg font-semibold text-gray-900",children:["Comments (",n.length,")"]})]}),b&&l("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:b}),t?m("form",{onSubmit:_,className:"mb-6",children:[l("div",{className:"space-y-3",children:m("div",{children:[l("textarea",{value:u,onChange:L=>d(L.target.value),placeholder:f?"Write a reply...":"Write a comment...",className:"w-full p-3 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"3",maxLength:"1000",required:!0}),m("div",{className:"flex justify-between items-center mt-1",children:[m("div",{className:"text-xs text-gray-500",children:[u.length,"/1000 characters"]}),m("button",{type:"submit",disabled:!u.trim()||o,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 text-sm font-medium",children:[o?l("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):l(Il,{className:"w-4 h-4"}),f?"Reply":"Comment"]})]})]})}),f&&l("div",{className:"mt-2",children:l("button",{type:"button",onClick:()=>h(null),className:"text-sm text-gray-500 hover:text-gray-700",children:"Cancel reply"})})]}):l("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg text-center",children:m("p",{className:"text-gray-600",children:["Please ",l("a",{href:"/login",className:"text-blue-600 hover:underline",children:"login"})," to comment"]})})]}),l("div",{className:"p-6",children:n.length===0?m("div",{className:"text-center py-8 text-gray-500",children:[l(Gv,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),l("p",{children:"No comments yet. Be the first to comment!"})]}):l("div",{className:"space-y-4",children:n.map(L=>D(L))})})]})};function ik(e){try{const t=e.split(".")[1];if(!t)return!0;let r=t.replace(/-/g,"+").replace(/_/g,"/");for(;r.length%4;)r+="=";const n=JSON.parse(atob(r));return n.exp?Date.now()>=n.exp*1e3:!1}catch{return!0}}const sk=({setCurrentPage:e,setSelectedComponents:t,user:r})=>{const[n,a]=N.useState([]),[i,s]=N.useState(!0),[o,c]=N.useState(null),[u,d]=N.useState(!1),[f,h]=N.useState(null),[p,x]=N.useState(null),[g,y]=N.useState([]);N.useEffect(()=>{(async()=>{const X=localStorage.getItem("token");if(!X||ik(X)){s(!1);return}try{const Y={Authorization:`Bearer ${X}`},q=await fetch(`${ve}/index.php?endpoint=builds`,{method:"GET",headers:Y});if(q.status===401){s(!1),a([]);return}const ee=await q.json();ee.success?a(ee.data):a([])}catch{a([])}finally{s(!1)}})()},[]),N.useEffect(()=>{(async()=>{const X=localStorage.getItem("token");if(!(!X||ik(X)))try{const q=await(await fetch(`${ve}/community_submission.php`,{headers:{Authorization:`Bearer ${X}`}})).json();q.success&&y(q.data||[])}catch{}})()},[]);const v=z=>{h(z),d(!0)},w=async()=>{if(f)try{const z=localStorage.getItem("token"),Y=await(await fetch(`${ve}/index.php?endpoint=builds&id=${f}`,{method:"DELETE",headers:{Authorization:`Bearer ${z}`}})).json();Y.success?(a(q=>q.filter(ee=>ee.id!==f)),d(!1),h(null)):alert("Error deleting build: "+(Y.error||"Unknown error"))}catch(z){console.error("Error deleting build:",z),alert("Error deleting build. Please try again.")}},b=async z=>{x(z);try{const X=localStorage.getItem("token"),q=await(await fetch(`${ve}/index.php?endpoint=builds&public=1&id=${z}`,{method:"PUT",headers:{Authorization:`Bearer ${X}`}})).json();q.success?(a(ee=>ee.map(V=>V.id===z?{...V,isPublic:q.is_public}:V)),alert(q.message)):alert(q.error||"Unable to change visibility.")}catch(X){console.error("Error updating build visibility:",X),alert("Error updating build visibility. Please try again.")}finally{x(null)}},S=async z=>{try{const X=localStorage.getItem("token"),q=await(await fetch(`${ve}/index.php?endpoint=community_submission`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${X}`},body:JSON.stringify({build_id:z.id,build_name:z.name,build_description:z.description||"",total_price:z.totalPrice||0,compatibility:z.compatibility||0})})).json();q.success?(alert("Build submitted for community review! Admins will review and approve it for the community."),y(ee=>[{id:q.submission_id,build_id:z.id,status:"pending"},...ee])):alert(q.error||"Failed to submit for review.")}catch(X){console.error("Error submitting to community:",X),alert("Network error while submitting. Please try again.")}},k=z=>{let X={};Array.isArray(z.components)?z.components.forEach(Y=>{Y&&Y.category&&(X[Y.category.toLowerCase()]=Y)}):z.components&&typeof z.components=="object"&&(Object.keys(z.components).every(q=>!isNaN(Number(q)))?Object.values(z.components).forEach(q=>{q&&q.category&&(X[q.category.toLowerCase()]=q)}):X={...z.components}),localStorage.setItem("builditpc-selected-components",JSON.stringify(X)),localStorage.setItem("builditpc-editing-build",JSON.stringify({id:z.id,name:z.name,description:z.description})),typeof t=="function"&&t(X),e("pc-assembly")},_=z=>new Date(z).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),E=z=>z>=90?{status:"Excellent",color:"text-green-600",bgColor:"bg-green-100",icon:l(yt,{className:"w-4 h-4"})}:z>=70?{status:"Good",color:"text-yellow-600",bgColor:"bg-yellow-100",icon:l(mo,{className:"w-4 h-4"})}:{status:"Issues",color:"text-red-600",bgColor:"bg-red-100",icon:l(mo,{className:"w-4 h-4"})},P=z=>{const X=Number(z);return isNaN(X)?0:X},A=z=>{if(!z)return"N/A";const X=new Date(z);return isNaN(X)?"N/A":X.toLocaleDateString()},T=()=>m("div",{className:"flex flex-col items-center justify-center py-16 px-6",children:[l("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-6",children:l("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})})}),l("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No builds yet"}),l("p",{className:"text-gray-600 text-center max-w-md mb-8",children:"You haven't saved any PC builds yet. Start building your dream PC in the PC Assembly section and save your configurations for future reference."}),l("div",{className:"flex flex-col sm:flex-row gap-4",children:m("button",{onClick:()=>e("pc-assembly"),className:"bg-green-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-700 transition-colors flex items-center gap-2",children:[l(Vn,{className:"w-5 h-5"}),"Start Building"]})}),m("div",{className:"mt-8 p-6 bg-blue-50 rounded-lg max-w-md",children:[l("h4",{className:"font-semibold text-blue-900 mb-2",children:"Pro Tips:"}),m("ul",{className:"text-sm text-blue-800 space-y-1",children:[l("li",{children:" Save multiple builds to compare different configurations"}),l("li",{children:" Share your builds with friends for feedback"}),l("li",{children:" Export parts lists to local retailers"}),l("li",{children:" Track price changes on your saved components"})]})]})]}),R=({build:z})=>{const X=Array.isArray(z.components)?z.components:Object.values(z.components||{});let Y=typeof z.compatibility=="number"?z.compatibility:0;if((!Y||Y===0)&&X.length>0)try{const V={cpu:["cpu","processor","procie"],motherboard:["motherboard","mobo"],gpu:["gpu","graphics card","graphics","video card"],ram:["ram","memory"],storage:["storage","ssd","hdd","nvme"],psu:["psu","power supply"],case:["case","chassis"],cooler:["cooler","cooling","aio"]},ae={};X.forEach(I=>{const W=String((I==null?void 0:I.category)||"").toLowerCase(),U=Object.keys(V).find(G=>G===W||V[G].some(ne=>W.includes(ne)));U&&(ae[U]=I)});const oe=Xo(ae);oe&&typeof oe.score=="number"&&(Y=oe.score)}catch{}const q=E(Y),ee=g.find(V=>V.build_id===z.id);return l("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:m("div",{className:"p-6",children:[m("div",{className:"flex items-start justify-between mb-4",children:[m("div",{className:"flex-1",children:[l("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:z.name}),l("p",{className:"text-sm text-gray-600 mb-2",children:z.description}),m("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[m("div",{className:"flex items-center gap-1",children:[l(Hd,{className:"w-4 h-4"}),A(z.createdAt)]}),m("div",{className:"flex items-center gap-1",children:[l("span",{className:"text-gray-700",children:""}),gt(P(z.totalPrice))]})]})]}),m("div",{className:"flex items-center gap-2",children:[l("button",{onClick:()=>b(z.id),disabled:p===z.id,className:`p-2 rounded-lg transition-colors ${z.isPublic?"text-green-600 hover:text-green-700 hover:bg-green-50":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,title:z.isPublic?"Make Private":"Make Public",children:p===z.id?l("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}):z.isPublic?l(nx,{className:"w-4 h-4"}):l(ib,{className:"w-4 h-4"})}),!z.isPublic&&l("button",{onClick:()=>S(z),disabled:ee&&ee.status==="pending",className:`p-2 rounded-lg transition-colors ${ee&&ee.status==="pending"?"text-yellow-600 bg-yellow-50":"text-blue-600 hover:text-blue-700 hover:bg-blue-50"}`,title:ee&&ee.status==="pending"?"Awaiting admin review":"Submit to Community",children:ee&&ee.status==="pending"?l(ho,{className:"w-4 h-4"}):l(hc,{className:"w-4 h-4"})}),l("button",{onClick:()=>k(z),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:l(_i,{className:"w-4 h-4"})}),l("button",{onClick:()=>v(z.id),className:"p-2 text-red-400 hover:text-red-600 rounded-lg hover:bg-red-50",children:l(an,{className:"w-4 h-4"})})]})]}),m("div",{className:"flex items-center justify-between mb-4",children:[m("div",{className:"flex items-center gap-3",children:[m("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full ${q.bgColor}`,children:[q.icon,m("span",{className:`text-sm font-medium ${q.color}`,children:[Y,"% Compatible"]})]}),z.isPublic&&m("div",{className:"flex items-center gap-1 px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs font-medium",children:[l(nx,{className:"w-3 h-3"}),"Public"]})]}),m("div",{className:"flex items-center gap-2",children:[l("span",{className:"text-sm text-gray-500",children:"Last updated:"}),l("span",{className:"text-sm font-medium text-gray-900",children:A(z.updatedAt)})]})]}),l("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:X.map((V,ae)=>m("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[l("div",{className:"text-xs font-medium text-gray-600 mb-1",children:V.category}),l("div",{className:"text-sm font-semibold text-gray-900 truncate",children:V.name}),l("div",{className:"text-xs text-gray-500",children:gt(V.price||0)})]},ae))}),m("div",{className:"flex gap-3",children:[m("button",{className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center justify-center gap-2",onClick:()=>c(z),children:[l(lo,{className:"w-4 h-4"}),"View Details"]}),m("button",{onClick:()=>k(z),className:"flex-1 border-2 border-gray-300 text-gray-700 py-2 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors flex items-center justify-center gap-2",children:[l(_i,{className:"w-4 h-4"}),"Edit Build"]}),l("button",{onClick:()=>b(z.id),disabled:p===z.id,className:`flex-1 border-2 py-2 px-4 rounded-lg font-medium transition-colors flex items-center justify-center gap-2 ${z.isPublic?"border-green-300 text-green-700 bg-green-50 hover:bg-green-100":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:p===z.id?l("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}):z.isPublic?m(lt,{children:[l(nx,{className:"w-4 h-4"}),"Shared"]}):m(lt,{children:[l(hc,{className:"w-4 h-4"}),"Share"]})})]})]})})};if(i)return l("div",{className:"flex items-center justify-center h-64",children:m("div",{className:"text-center",children:[l("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),l("p",{className:"mt-4 text-gray-600",children:"Loading your builds..."})]})});const D=n.length,L=n.reduce((z,X)=>z+P(X.totalPrice),0);return m("div",{className:"p-6",children:[m("div",{className:"mb-8",children:[m("div",{className:"flex items-center justify-between mb-4",children:[m("div",{children:[l("h1",{className:"text-3xl font-bold mb-1",children:"My Builds"}),l("p",{className:"text-gray-600",children:"Manage and organize your saved PC configurations"})]}),m("div",{className:"flex gap-3",children:[m("button",{onClick:()=>e("prebuilt-pcs"),className:"border-2 border-gray-300 text-gray-700 px-5 py-2 rounded-lg font-semibold hover:bg-gray-50 transition-colors flex items-center gap-2",children:[l(hc,{className:"w-5 h-5"})," Browse Community"]}),n.length>0&&m("button",{className:"bg-green-600 text-white px-5 py-2 rounded-lg font-semibold hover:bg-green-700 transition-colors flex items-center gap-2",onClick:()=>e("pc-assembly"),children:[l(Vn,{className:"w-5 h-5"})," New Build"]})]})]}),n.length>0&&m("div",{className:"mb-6 text-gray-700 text-lg",children:["Total builds: ",D,"    Total value: ",gt(L)]})]}),n.length===0?l(T,{}):l("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:n.map(z=>l(R,{build:z},z.id))}),u&&l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:m("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[m("div",{className:"flex items-center gap-3 mb-4",children:[l("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:l(an,{className:"w-5 h-5 text-red-600"})}),l("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete Build"})]}),l("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to delete this build? This action cannot be undone."}),m("div",{className:"flex gap-3",children:[l("button",{onClick:()=>d(!1),className:"flex-1 border-2 border-gray-300 text-gray-700 py-2 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Cancel"}),l("button",{onClick:w,className:"flex-1 bg-red-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-red-700 transition-colors",children:"Delete"})]})]})}),o&&(()=>{const z=Array.isArray(o.components)?o.components:Object.values(o.components||{});let X=typeof o.compatibility=="number"?o.compatibility:0;if((!X||X===0)&&z.length>0)try{const Y={cpu:["cpu","processor","procie"],motherboard:["motherboard","mobo"],gpu:["gpu","graphics card","graphics","video card"],ram:["ram","memory"],storage:["storage","ssd","hdd","nvme"],psu:["psu","power supply"],case:["case","chassis"],cooler:["cooler","cooling","aio"]},q={};z.forEach(V=>{const ae=String((V==null?void 0:V.category)||"").toLowerCase(),oe=Object.keys(Y).find(I=>I===ae||Y[I].some(W=>ae.includes(W)));oe&&(q[oe]=V)});const ee=Xo(q);ee&&typeof ee.score=="number"&&(X=ee.score)}catch{}return l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:m("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[l("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-xl",children:m("div",{className:"flex items-center justify-between",children:[m("div",{className:"flex items-center gap-4",children:[l("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:l("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})})}),m("div",{children:[l("h2",{className:"text-2xl font-bold text-gray-900",children:o.name}),l("p",{className:"text-gray-600",children:o.description})]})]}),l("button",{onClick:()=>c(null),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors",children:l("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),m("div",{className:"p-6",children:[m("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[m("div",{className:"bg-gradient-to-br from-green-50 to-blue-50 rounded-xl p-6 border border-green-200",children:[m("div",{className:"flex items-center gap-3 mb-3",children:[l("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:l(yt,{className:"w-5 h-5 text-green-600"})}),m("div",{children:[l("h3",{className:"font-semibold text-gray-900",children:"Compatibility"}),m("p",{className:"text-2xl font-bold text-green-600",children:[X,"%"]})]})]}),l("div",{className:"w-full bg-gray-200 rounded-full h-2",children:l("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${X}%`}})})]}),m("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl p-6 border border-blue-200",children:[m("div",{className:"flex items-center gap-3 mb-3",children:[l("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:l("span",{className:"text-blue-600 text-xl font-bold",children:""})}),m("div",{children:[l("h3",{className:"font-semibold text-gray-900",children:"Total Price"}),l("p",{className:"text-2xl font-bold text-blue-600",children:gt(o.totalPrice||0)})]})]}),l("p",{className:"text-sm text-gray-600",children:"All components included"})]}),m("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-6 border border-purple-200",children:[m("div",{className:"flex items-center gap-3 mb-3",children:[l("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:l(Ye,{className:"w-5 h-5 text-purple-600"})}),m("div",{children:[l("h3",{className:"font-semibold text-gray-900",children:"Components"}),l("p",{className:"text-2xl font-bold text-purple-600",children:z.length})]})]}),l("p",{className:"text-sm text-gray-600",children:"Parts in this build"})]})]}),m("div",{className:"bg-gray-50 rounded-xl p-6 mb-8",children:[m("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[l(Hd,{className:"w-5 h-5 text-gray-600"}),"Build Timeline"]}),m("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[m("div",{className:"flex items-center gap-3",children:[l("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:l(yt,{className:"w-4 h-4 text-green-600"})}),m("div",{children:[l("p",{className:"font-medium text-gray-900",children:"Created"}),l("p",{className:"text-sm text-gray-600",children:_(o.createdAt)})]})]}),m("div",{className:"flex items-center gap-3",children:[l("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:l(ho,{className:"w-4 h-4 text-blue-600"})}),m("div",{children:[l("p",{className:"font-medium text-gray-900",children:"Last Updated"}),l("p",{className:"text-sm text-gray-600",children:_(o.updatedAt)})]})]})]})]}),m("div",{children:[m("h3",{className:"text-xl font-bold text-gray-900 mb-6 flex items-center gap-2",children:[l(Ye,{className:"w-6 h-6 text-gray-600"}),"Build Components"]}),l("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:z.map((Y,q)=>l("div",{className:"bg-white border border-gray-200 rounded-xl p-6 hover:shadow-lg transition-shadow",children:m("div",{className:"flex items-start gap-4",children:[l("div",{className:"w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0",children:l(Ye,{className:"w-8 h-8 text-gray-400"})}),m("div",{className:"flex-1 min-w-0",children:[m("div",{className:"flex items-center justify-between mb-2",children:[l("span",{className:"inline-block bg-green-100 text-green-800 text-xs font-medium px-2 py-1 rounded-full",children:Y.category}),l("span",{className:"text-lg font-bold text-green-600",children:gt(Y.price||0)})]}),l("h4",{className:"font-semibold text-gray-900 text-lg mb-2 line-clamp-2",children:Y.name}),Y.brand&&m("p",{className:"text-sm text-gray-600 mb-2",children:["Brand: ",l("span",{className:"font-medium",children:Y.brand})]}),Y.specs&&l("div",{className:"text-xs text-gray-500 space-y-1",children:Object.entries(Y.specs).slice(0,3).map(([ee,V])=>m("div",{className:"flex justify-between",children:[m("span",{className:"capitalize",children:[ee.replace(/_/g," "),":"]}),l("span",{className:"font-medium",children:V})]},ee))})]})]})},q))})]}),o.isPublic&&l("div",{className:"mt-8",children:l(s3,{buildId:o.id,user:r,className:"mb-8"})}),m("div",{className:"flex gap-4 mt-8 pt-6 border-t border-gray-200",children:[m("button",{onClick:()=>k(o),className:"flex-1 bg-green-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-green-700 transition-colors flex items-center justify-center gap-2",children:[l(_i,{className:"w-5 h-5"}),"Edit Build"]}),m("button",{className:"flex-1 border-2 border-gray-300 text-gray-700 py-3 px-6 rounded-lg font-semibold hover:bg-gray-50 transition-colors flex items-center justify-center gap-2",children:[l(hc,{className:"w-5 h-5"}),"Share Build"]})]})]})]})})})()]})},ok=({setCurrentPage:e})=>{const[t,r]=N.useState([]),[n,a]=N.useState(!0),[i,s]=N.useState(null),[o,c]=N.useState(!1),u=v=>{try{const w=v.split(".")[1];if(!w)return!0;let b=w.replace(/-/g,"+").replace(/_/g,"/");for(;b.length%4;)b+="=";const S=JSON.parse(atob(b));return S.exp?Date.now()>=S.exp*1e3:!1}catch{return!0}};N.useEffect(()=>{(async()=>{try{const w=localStorage.getItem("token");if(!w||u(w)){r([]),a(!1);return}const b=await fetch(`${ve}/index.php?endpoint=orders`,{method:"GET",headers:{Authorization:`Bearer ${w}`}});if(b.status===401){r([]),a(!1);return}const S=await b.json();if(S&&S.success&&Array.isArray(S.data)){const k=S.data.map(_=>({id:_.id,orderNumber:_.id,description:_.notes||"",status:(_.status||"pending").toString().toLowerCase(),orderDate:_.order_date,totalAmount:Number(_.total??_.total_price??0),itemCount:Number(_.item_count||0),items:[],progress:(()=>{const E=(_.status||"").toString().toLowerCase();return E==="pending"?.25:E==="processing"?.5:E==="shipped"?.75:E==="delivered"||E==="completed"?1:0})()}));r(k)}else r([])}catch(w){console.error("Error loading orders:",w),r([])}finally{a(!1)}})()},[]);const d=v=>{switch(v){case"pending":return{color:"text-yellow-600",bgColor:"bg-yellow-100",icon:l(ho,{className:"w-4 h-4"})};case"processing":return{color:"text-blue-600",bgColor:"bg-blue-100",icon:l(Ye,{className:"w-4 h-4"})};case"shipped":return{color:"text-purple-600",bgColor:"bg-purple-100",icon:l($8,{className:"w-4 h-4"})};case"delivered":return{color:"text-green-600",bgColor:"bg-green-100",icon:l(yt,{className:"w-4 h-4"})};case"completed":return{color:"text-green-600",bgColor:"bg-green-100",icon:l(yt,{className:"w-4 h-4"})};case"cancelled":return{color:"text-red-600",bgColor:"bg-red-100",icon:l(Cn,{className:"w-4 h-4"})};default:return{color:"text-gray-600",bgColor:"bg-gray-100",icon:l(mo,{className:"w-4 h-4"})}}},f=v=>{switch(v){case"pending":return"Pending Payment";case"processing":return"Processing";case"shipped":return"Shipped";case"delivered":return"Delivered";case"completed":return"Completed";case"cancelled":return"Cancelled";default:return"Unknown"}},h=v=>new Date(v).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),p=async v=>{try{const w=localStorage.getItem("token");if(!w||u(w))return;const b=await fetch(`${ve}/index.php?endpoint=orders&id=${v}`,{method:"GET",headers:{Authorization:`Bearer ${w}`}});if(b.status===401)return;const S=await b.json();if(S&&S.success&&S.data){const k=S.data,_=Array.isArray(k.items)?k.items.map(A=>({name:A.component_name||`Component #${A.component_id}`,category:A.category||"Component",price:Number(A.price||0),quantity:Number(A.quantity||1)})):[],E=_.reduce((A,T)=>A+(T.quantity||0),0),P={id:k.id,orderNumber:k.id,description:k.notes||"",status:(k.status||"pending").toString().toLowerCase(),orderDate:k.order_date,totalAmount:Number(k.total??k.total_price??0),itemCount:E,items:_,subtotal:_.reduce((A,T)=>A+T.price*T.quantity,0),shipping:0,tax:0,progress:(()=>{const A=(k.status||"").toString().toLowerCase();return A==="pending"?.25:A==="processing"?.5:A==="shipped"?.75:A==="delivered"||A==="completed"?1:0})()};s(P),c(!0)}}catch(w){console.error("Error loading order details:",w)}},x=()=>m("div",{className:"flex flex-col items-center justify-center py-16 px-6",children:[l("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-6",children:l(Vv,{className:"w-12 h-12 text-gray-400"})}),l("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No orders yet"}),l("p",{className:"text-gray-600 text-center max-w-md mb-8",children:"You haven't placed any orders yet. Once you purchase components, your order history will appear here."}),l("div",{className:"flex flex-col sm:flex-row gap-4 mb-8",children:m("button",{onClick:()=>e("pc-assembly"),className:"bg-green-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-700 transition-colors flex items-center gap-2",children:[l(Vn,{className:"w-5 h-5"}),"Start Building"]})}),m("div",{className:"flex flex-col md:flex-row gap-6 w-full max-w-3xl justify-center items-stretch",children:[m("div",{className:"p-6 bg-blue-50 rounded-lg border border-blue-200 flex-1 mb-0",children:[m("div",{className:"flex items-center gap-3 mb-3",children:[l("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:l(Ye,{className:"w-5 h-5 text-blue-600"})}),l("h4",{className:"font-semibold text-blue-900",children:"Component Orders"})]}),l("p",{className:"text-sm text-blue-800",children:"Purchase individual components from our partner retailers and track your orders here."})]}),m("div",{className:"p-6 bg-yellow-50 rounded-lg border border-yellow-200 flex-1 mt-6 md:mt-0",children:[l("h4",{className:"font-semibold text-yellow-900 mb-2",children:"How it works:"}),m("ul",{className:"text-sm text-yellow-800 space-y-1",children:[l("li",{children:" Build your PC using our compatibility checker"}),l("li",{children:" Purchase components from partner retailers"}),l("li",{children:" Track your orders and shipping status"}),l("li",{children:" Get notifications on order updates"})]})]})]})]}),g=({order:v})=>{const w=d(v.status);return l("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:m("div",{className:"p-6",children:[l("div",{className:"flex items-start justify-between mb-4",children:m("div",{className:"flex-1",children:[m("div",{className:"flex items-center gap-3 mb-2",children:[m("h3",{className:"text-lg font-semibold text-gray-900",children:["Order #",v.orderNumber]}),m("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full ${w.bgColor}`,children:[w.icon,l("span",{className:`text-sm font-medium ${w.color}`,children:f(v.status)})]})]}),l("p",{className:"text-sm text-gray-600 mb-2",children:v.description}),m("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[m("div",{className:"flex items-center gap-1",children:[l(Hd,{className:"w-4 h-4"}),h(v.orderDate)]}),l("div",{className:"flex items-center gap-1",children:gt(v.totalAmount)}),m("div",{className:"flex items-center gap-1",children:[l(Ye,{className:"w-4 h-4"}),v.itemCount," ",v.itemCount===1?"item":"items"]})]})]})}),m("div",{className:"mb-4",children:[m("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-2",children:[l("span",{children:"Order Progress"}),m("span",{children:[Math.round((v.progress||0)*100),"%"]})]}),l("div",{className:"w-full bg-gray-200 rounded-full h-2",children:l("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${(v.progress||0)*100}%`}})})]}),m("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-3 mb-4",children:[v.items.slice(0,3).map((b,S)=>m("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[l("div",{className:"text-xs font-medium text-gray-600 mb-1",children:b.category}),l("div",{className:"text-sm font-semibold text-gray-900 truncate",children:b.name}),l("div",{className:"text-xs text-gray-500",children:gt(b.price)})]},S)),v.items.length>3&&l("div",{className:"text-center p-3 bg-gray-50 rounded-lg flex items-center justify-center",children:m("span",{className:"text-sm text-gray-500",children:["+",v.items.length-3," more"]})})]}),l("div",{className:"flex gap-3",children:m("button",{onClick:()=>p(v.id),className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center justify-center gap-2",children:[l(lo,{className:"w-4 h-4"}),"View Details"]})})]})})},y=({order:v,onClose:w})=>{if(!v)return null;const b=d(v.status);return l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:m("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[m("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[m("div",{className:"flex items-center gap-3",children:[l("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:l(Ye,{className:"w-5 h-5 text-green-600"})}),m("div",{children:[m("h2",{className:"text-xl font-semibold text-gray-900",children:["Order #",v.orderNumber]}),l("p",{className:"text-sm text-gray-600",children:h(v.orderDate)})]})]}),l("button",{onClick:w,className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:l(Gn,{className:"w-5 h-5"})})]}),m("div",{className:"p-6",children:[l("div",{className:"mb-6",children:m("div",{className:`inline-flex items-center gap-2 px-4 py-2 rounded-full ${b.bgColor}`,children:[b.icon,l("span",{className:`font-medium ${b.color}`,children:f(v.status)})]})}),m("div",{className:"mb-6",children:[l("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Order Items"}),l("div",{className:"space-y-3",children:v.items.map((S,k)=>m("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[m("div",{className:"flex items-center gap-4",children:[l("div",{className:"w-12 h-12 bg-white rounded-lg flex items-center justify-center",children:l(Ye,{className:"w-6 h-6 text-gray-600"})}),m("div",{children:[l("h4",{className:"font-medium text-gray-900",children:S.name}),l("p",{className:"text-sm text-gray-600",children:S.category})]})]}),m("div",{className:"text-right",children:[l("p",{className:"font-medium text-gray-900",children:gt(S.price)}),m("p",{className:"text-sm text-gray-600",children:["Qty: ",S.quantity]})]})]},k))})]}),m("div",{className:"border-t pt-6",children:[l("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Order Summary"}),m("div",{className:"space-y-2",children:[m("div",{className:"flex justify-between",children:[l("span",{className:"text-gray-600",children:"Subtotal:"}),l("span",{className:"font-medium",children:gt(v.subtotal)})]}),m("div",{className:"flex justify-between",children:[l("span",{className:"text-gray-600",children:"Shipping:"}),l("span",{className:"font-medium text-green-600",children:gt(v.shipping)})]}),m("div",{className:"flex justify-between",children:[l("span",{className:"text-gray-600",children:"Tax:"}),l("span",{className:"font-medium",children:gt(v.tax)})]}),m("div",{className:"flex justify-between text-lg font-semibold border-t pt-2",children:[l("span",{className:"text-gray-900",children:"Total:"}),l("span",{className:"text-green-600",children:gt(v.totalAmount)})]})]})]})]})]})})};return n?l("div",{className:"flex items-center justify-center h-64",children:m("div",{className:"text-center",children:[l("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),l("p",{className:"mt-4 text-gray-600",children:"Loading your orders..."})]})}):m("div",{className:"p-6",children:[m("div",{className:"mb-8",children:[l("div",{className:"flex items-center justify-between mb-4",children:m("div",{children:[l("h1",{className:"text-2xl font-bold text-gray-900",children:"My Orders"}),l("p",{className:"text-gray-600",children:"Track your component orders"})]})}),t.length>0&&m("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[m("span",{children:["Total orders: ",t.length]}),l("span",{children:""}),m("span",{children:["Total spent: ",gt(t.reduce((v,w)=>v+w.totalAmount,0))]})]})]}),t.length===0?l(x,{}):l("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:t.map(v=>l(g,{order:v},v.id))}),o&&i&&l(y,{order:i,onClose:()=>{c(!1),s(null)}})]})},o3=({rating:e=0,maxRating:t=5,size:r="md",interactive:n=!1,onRatingChange:a=null,showAverage:i=!1,totalRatings:s=0,userRating:o=0,className:c=""})=>{const[u,d]=N.useState(0),[f,h]=N.useState(Number(e)||0);N.useEffect(()=>{h(Number(e)||0)},[e]);const p={sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6",xl:"w-8 h-8"},x=w=>{n&&a&&(h(w),a(w))},g=w=>{n&&d(w)},y=()=>{n&&d(0)},v=n&&u||f;return m("div",{className:`flex items-center gap-1 ${c}`,children:[l("div",{className:"flex items-center gap-0.5",onMouseLeave:y,children:Array.from({length:t},(w,b)=>{const S=b+1,k=S<=v,_=S===Math.ceil(v)&&v%1!==0;return l("button",{type:"button",className:`${p[r]} transition-colors ${n?"cursor-pointer hover:scale-110 transform transition-transform":"cursor-default"}`,onClick:()=>x(S),onMouseEnter:()=>g(S),disabled:!n,children:l(ob,{className:`${k?"text-yellow-400 fill-current":_?"text-yellow-400 fill-current opacity-50":"text-gray-300"}`,size:r==="sm"?16:r==="md"?20:r==="lg"?24:32})},b)})}),i&&m("div",{className:"ml-2 text-sm text-gray-600",children:[l("span",{className:"font-medium",children:Number(f||0).toFixed(1)}),s>0&&m("span",{className:"text-gray-500",children:[" (",s," rating",s!==1?"s":"",")"]})]})]})},WB=({isOpen:e,onClose:t,buildId:r,buildName:n,onSubmitRating:a,existingRating:i=null,className:s=""})=>{const[o,c]=N.useState(0),[u,d]=N.useState(""),[f,h]=N.useState(!1),[p,x]=N.useState("");N.useEffect(()=>{i?(c(i.rating||0),d(i.review_text||"")):(c(0),d(""))},[i,e]);const g=async()=>{if(o===0){x("Please select a rating");return}h(!0),x("");try{await a({build_id:r,rating:o,review_text:u.trim()}),t()}catch(v){x(v.message||"Failed to submit rating")}finally{h(!1)}},y=()=>{c(0),d(""),x(""),t()};return e?l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:m("div",{className:"p-6",children:[m("div",{className:"flex items-center justify-between mb-6",children:[l("h2",{className:"text-xl font-semibold text-gray-900",children:i?"Update Rating":"Rate This Build"}),l("button",{onClick:y,className:"text-gray-400 hover:text-gray-600 transition-colors",children:l(Gn,{className:"w-6 h-6"})})]}),m("div",{className:"mb-6",children:[l("h3",{className:"font-medium text-gray-900 mb-1",children:n}),l("p",{className:"text-sm text-gray-600",children:"How would you rate this build?"})]}),m("div",{className:"mb-6",children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Rating *"}),l(o3,{rating:o,maxRating:5,size:"lg",interactive:!0,onRatingChange:c,className:"justify-center"}),l("div",{className:"text-center mt-2",children:l("span",{className:"text-sm text-gray-600",children:o===0?"Select a rating":o===1?"Poor":o===2?"Fair":o===3?"Good":o===4?"Very Good":o===5?"Excellent":""})})]}),m("div",{className:"mb-6",children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Review (Optional)"}),l("textarea",{value:u,onChange:v=>d(v.target.value),placeholder:"Share your thoughts about this build...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none",rows:4,maxLength:500}),m("div",{className:"text-right text-xs text-gray-500 mt-1",children:[u.length,"/500 characters"]})]}),p&&l("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:l("p",{className:"text-sm text-red-600",children:p})}),m("div",{className:"flex gap-3",children:[l("button",{onClick:y,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Cancel"}),l("button",{onClick:g,disabled:o===0||f,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:f?m(lt,{children:[l("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Submitting..."]}):m(lt,{children:[l(Il,{className:"w-4 h-4"}),i?"Update Rating":"Submit Rating"]})})]})]})})}):null};class GB extends ft.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error("ErrorBoundary caught an error:",t,r)}render(){return this.state.hasError?m("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[l("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Something went wrong"}),l("p",{className:"text-red-600 mb-4",children:"There was an error loading this component. Please try refreshing the page."}),l("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Refresh Page"})]}):this.props.children}}const VB=`${ve}/prebuilts.php`,Fo={cpu:["cpu","processor","procie","procie only","processor only"],motherboard:["motherboard","mobo"],gpu:["gpu","graphics","graphics card","video","video card","vga"],ram:["ram","memory","ram 3200mhz","ddr","ddr4","ddr5"],storage:["storage","ssd","nvme","ssd nvme","hdd","hard drive","drive"],psu:["psu","power supply","psu - tr","tr psu"],case:["case","chassis","case gaming"],cooler:["cooler","coolers","aio","cooling","cpu cooler","water cooling","liquid cooler","fan","heatsink"]};async function KB(e){if(!e||typeof e!="object")return{};const t=Object.values(e).map(i=>typeof i=="string"?parseInt(i,10):i).filter(i=>Number.isFinite(i)&&i>0);if(t.length===0)return{};const r=`${ve}/get_components_by_ids.php?ids=${t.join(",")}`,a=await(await fetch(r)).json();if(a.success&&a.data){const i={};return a.data.forEach(s=>{const o=Object.keys(e).find(c=>e[c]==s.id);o&&(i[o]=s)}),i}return{}}async function b0(e,t={}){const n={cpu:"CPU",motherboard:"Motherboard",gpu:"GPU",ram:"RAM",storage:"Storage",psu:"PSU",case:"Case",cooler:"Cooler"}[e];if(!n)return null;try{const a=ha("components",{category:n}),s=await(await fetch(a)).json();if(!s.success||!Array.isArray(s.data)||s.data.length===0)return null;const o=s.data.slice();return o.sort((c,u)=>(Number(c.price)||0)-(Number(u.price)||0)),o[0]||null}catch{return null}}const lk=({setCurrentPage:e,setSelectedComponents:t,onPrebuiltSelect:r,user:n})=>{const[a,i]=N.useState([]),[s,o]=N.useState("all"),[c,u]=N.useState("all"),[d,f]=N.useState(""),[h,p]=N.useState("name"),[x,g]=N.useState(!0),[y,v]=N.useState(null),[w,b]=N.useState("all"),[S,k]=N.useState([]),[_,E]=N.useState(!0),[P,A]=N.useState(null),[T,R]=N.useState(""),[D,L]=N.useState("newest"),[z,X]=N.useState("all"),[Y,q]=N.useState("prebuilts"),[ee,V]=N.useState([]),[ae,oe]=N.useState(!1),[I,W]=N.useState(null),[U,G]=N.useState({}),[ne,K]=N.useState(""),[le,Q]=N.useState(!1),[ce,be]=N.useState({}),[j,$e]=N.useState({}),[Ee,Ae]=N.useState(!1),[Be,we]=N.useState(null),[de,Ge]=N.useState("");N.useEffect(()=>{(async()=>{g(!0),v(null);try{const Fe=await(await fetch(`${VB}`)).json();Array.isArray(Fe)?i(Fe):i([])}catch{v("Failed to fetch prebuilts."),i([])}g(!1)})()},[]),N.useEffect(()=>{(async()=>{E(!0);try{const Fe=await(await fetch(`${ve}/index.php?endpoint=builds&public=1`)).json();Fe.success?k(Fe.data):k([])}catch(he){console.error("Error fetching public builds:",he),k([])}finally{E(!1)}})()},[]),N.useEffect(()=>{S.length>0&&S.forEach(J=>{_r(J.id),re(J.id)})},[S]),N.useEffect(()=>{Lt()&&(xe(),Ie())},[n]);const et=J=>{const he=te(J);return he==="amd"?l("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full bg-red-100 text-red-700 text-xs font-semibold",children:"AMD"}):he==="intel"?l("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full bg-blue-100 text-blue-700 text-xs font-semibold",children:"Intel"}):l("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full bg-gray-100 text-gray-700 text-xs font-semibold",children:"Mixed"})},Qe=J=>{const he=`${J.name||""} ${J.description||""}`,Fe=he.match(/(R[3579] \d{3,4}X?|Ryzen\s?\d|i[3579]-?\d{3,5}|Intel\s?Core\s?i[3579]-?\d{3,5})/i),ot=he.match(/(RTX\s?\d{3,4}|GTX\s?\d{3,4}|RX\s?\d{3,4}|Arc\s?\w+|IGPU)/i),Tt=he.match(/(\d{2,3})\s?GB\s?(DDR\d)?/i),Pr=he.match(/(\d(?:\.\d)?\s?TB|\d{3,4}\s?GB)\s?(NVME|SSD|HDD)?/i);return{cpu:Fe?Fe[0]:null,gpu:ot?ot[0]:null,ram:Tt?`${Tt[1]}GB`:null,storage:Pr?Pr[0].replace(/\s+/g," "):null}},te=J=>{if(J.brand){const Fe=String(J.brand).toLowerCase();if(Fe.includes("amd"))return"amd";if(Fe.includes("intel"))return"intel"}const he=`${J.name||""} ${J.description||""}`.toLowerCase();return he.includes("amd")||he.includes("ryzen")?"amd":he.includes("intel")||he.includes("core i")?"intel":"other"},De=[{id:"all",name:"All PCs",count:a.length},...Array.from(new Set(a.map(J=>J.category))).filter(Boolean).map(J=>({id:J,name:J.charAt(0).toUpperCase()+J.slice(1),count:a.filter(he=>he.category===J).length}))],ze=[{id:"all",name:"All Brands",count:a.length},{id:"amd",name:"AMD Builds",count:a.filter(J=>te(J)==="amd").length},{id:"intel",name:"Intel Builds",count:a.filter(J=>te(J)==="intel").length}];a.filter(J=>s==="all"||J.category===s).filter(J=>c==="all"||te(J)===c).filter(J=>J.name&&J.name.toLowerCase().includes(d.toLowerCase())).sort((J,he)=>{switch(h){case"price":return J.price-he.price;case"name":return J.name.localeCompare(he.name);default:return 0}});const ct=async J=>{try{let he={};if(J.component_ids)if(typeof J.component_ids=="string")try{he=JSON.parse(J.component_ids)}catch{alert("This prebuilt has invalid component data and cannot be loaded. Please contact support or try another prebuilt.");return}else he=J.component_ids;else J.componentIds&&(he=J.componentIds);if(!he||Object.keys(he).length===0){alert("This prebuilt has no components and cannot be loaded.");return}const Fe=await KB(he);if(!Fe||Object.keys(Fe).length===0){alert("The components for this prebuilt could not be found.");return}const ot={},Tt=Object.keys(Fe).reduce((_t,C)=>(_t[C.toLowerCase()]=Fe[C],_t),{});Object.entries(Fo).forEach(([_t,C])=>{for(const M of C)if(Tt[M]){ot[_t]=Tt[M];break}}),Object.keys(Fe).forEach(_t=>{Fo[_t]&&(ot[_t]=Fe[_t])});const Pr=Object.keys(he||{}).map(_t=>String(_t).toLowerCase());if((Fo.cooler||[]).some(_t=>Pr.includes(_t))&&!ot.cooler){const _t=await b0("cooler");_t&&(ot.cooler=_t)}const Ct=["cpu","motherboard","gpu","ram","storage","psu","case"].filter(_t=>!ot[_t]);Ct.length>0&&(await Promise.all(Ct.map(C=>b0(C)))).forEach((C,M)=>{C&&(ot[Ct[M]]=C)});try{localStorage.setItem("builditpc-selected-components",JSON.stringify(ot)),localStorage.setItem("builditpc-editing-build",JSON.stringify({name:(J.name||"Prebuilt")+" (Prebuilt)",description:J.description||""}))}catch{}r?r(ot):(t&&t(ot),e("pc-assembly"))}catch(he){console.error("Error loading prebuilt components:",he),alert("Error loading prebuilt components. Please try again.")}},Ke=J=>{switch(J){case"gaming":return l(Ta,{className:"w-5 h-5"});case"workstation":return l(sb,{className:"w-5 h-5"});case"cooling":return l(ta,{className:"w-5 h-5"});default:return l(Ye,{className:"w-5 h-5"})}},mt=J=>new Date(J).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),ht=J=>J>=90?{status:"Excellent",color:"text-green-600",bgColor:"bg-green-100",icon:l(yt,{className:"w-4 h-4"})}:J>=70?{status:"Good",color:"text-yellow-600",bgColor:"bg-yellow-100",icon:l(mo,{className:"w-4 h-4"})}:{status:"Issues",color:"text-red-600",bgColor:"bg-red-100",icon:l(mo,{className:"w-4 h-4"})},Re=J=>{const he=Number(J);return isNaN(he)?0:he},tt=async J=>{let he={};Array.isArray(J.components)?J.components.forEach(Nt=>{Nt&&Nt.category&&(he[Nt.category.toLowerCase()]=Nt)}):J.components&&typeof J.components=="object"&&(Object.keys(J.components).every(Ct=>!isNaN(Number(Ct)))?Object.values(J.components).forEach(Ct=>{Ct&&Ct.category&&(he[Ct.category.toLowerCase()]=Ct)}):he={...J.components});const Fe={},ot=Object.keys(he).reduce((Nt,Ct)=>(Nt[Ct.toLowerCase()]=he[Ct],Nt),{});Object.entries(Fo).forEach(([Nt,Ct])=>{for(const _t of Ct)if(ot[_t]){Fe[Nt]=ot[_t];break}}),Object.keys(he).forEach(Nt=>{Fo[Nt]&&(Fe[Nt]=he[Nt])});const Pr=["cpu","motherboard","gpu","ram","storage","psu","case"].filter(Nt=>!Fe[Nt]);Pr.length>0&&(await Promise.all(Pr.map(Ct=>b0(Ct)))).forEach((Ct,_t)=>{Ct&&(Fe[Pr[_t]]=Ct)});let xr=!1;if(Array.isArray(J.components))xr=J.components.some(Nt=>{const Ct=((Nt==null?void 0:Nt.category)||"").toLowerCase();return(Fo.cooler||[]).some(_t=>Ct.includes(_t))});else if(J.components&&typeof J.components=="object"){const Nt=Object.keys(J.components).map(Ct=>Ct.toLowerCase());xr=(Fo.cooler||[]).some(Ct=>Nt.includes(Ct))}if(xr&&!Fe.cooler){const Nt=await b0("cooler");Nt&&(Fe.cooler=Nt)}try{localStorage.setItem("builditpc-selected-components",JSON.stringify(Fe)),localStorage.setItem("builditpc-editing-build",JSON.stringify({name:J.name+" (Copy)",description:J.description+" - Shared by "+J.creator_name}))}catch{}typeof t=="function"&&t(Fe),e("pc-assembly")},kt=J=>{const he=`${window.location.origin}/prebuilt-pcs?build=${J}`;navigator.clipboard.writeText(he).then(()=>{alert("Build link copied to clipboard!")})},Lt=()=>!n||!n.roles?!1:(Array.isArray(n.roles)?n.roles:n.roles.split(",").map(he=>he.trim())).some(he=>["Admin","Super Admin","Employee"].includes(he)),xe=async()=>{if(Lt()){oe(!0);try{const J=localStorage.getItem("token"),Fe=await(await fetch(`${ve}/index.php?endpoint=community_management&action=submissions`,{headers:{Authorization:`Bearer ${J}`}})).json();Fe.success&&V(Fe.data)}catch(J){console.error("Error fetching community submissions:",J)}finally{oe(!1)}}},Ie=async()=>{if(Lt())try{const J=localStorage.getItem("token"),Fe=await(await fetch(`${ve}/index.php?endpoint=community_management&action=stats`,{headers:{Authorization:`Bearer ${J}`}})).json();if(Fe.success){const ot={};Fe.data.forEach(Tt=>{ot[Tt.status]=Tt.count}),G(ot)}}catch(J){console.error("Error fetching submission stats:",J)}},ut=async(J,he)=>{Q(!0);try{const Fe=localStorage.getItem("token"),Tt=await(await fetch(`${ve}/index.php?endpoint=community_management&action=review`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Fe}`},body:JSON.stringify({submission_id:J,status:he,admin_notes:ne})})).json();Tt.success?(alert(`Submission ${he} successfully!`),W(null),K(""),xe(),Ie()):alert("Error reviewing submission: "+(Tt.error||"Unknown error"))}catch(Fe){console.error("Error reviewing submission:",Fe),alert("Error reviewing submission. Please try again.")}finally{Q(!1)}},Ht=async(J,he)=>{if(confirm(`Are you sure you want to delete the submission "${he}"? This action cannot be undone.`))try{const Fe=localStorage.getItem("token"),Tt=await(await fetch(`${ve}/delete_submission.php`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Fe}`},body:JSON.stringify({submission_id:J})})).json();Tt.success?(alert("Submission deleted successfully!"),xe(),Ie()):alert("Error deleting submission: "+(Tt.error||"Unknown error"))}catch(Fe){console.error("Error deleting submission:",Fe),alert("Error deleting submission. Please try again.")}},kr=async(J,he)=>{try{await fetch(`${ve}/update_build_compatibility.php`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({build_id:J,compatibility:he})})}catch{}},_r=async J=>{try{const he=localStorage.getItem("token");if(!he)return;const ot=await(await fetch(`${ve}/build_ratings.php?action=stats&build_id=${J}`,{headers:{Authorization:`Bearer ${he}`}})).json();ot.success&&be(Tt=>({...Tt,[J]:ot.data}))}catch(he){console.error("Error fetching build ratings:",he)}},re=async J=>{try{const he=localStorage.getItem("token");if(!he)return;const ot=await(await fetch(`${ve}/build_ratings.php?action=user_rating&build_id=${J}`,{headers:{Authorization:`Bearer ${he}`}})).json();ot.success&&$e(Tt=>({...Tt,[J]:ot.data}))}catch(he){console.error("Error fetching user rating:",he)}},Ne=async J=>{try{const he=localStorage.getItem("token");if(!he)throw new Error("Please log in to rate builds");const ot=await(await fetch(`${ve}/build_ratings.php?action=submit`,{method:"POST",headers:{Authorization:`Bearer ${he}`,"Content-Type":"application/json"},body:JSON.stringify(J)})).json();if(ot.success)return await _r(J.build_id),await re(J.build_id),ot;throw new Error(ot.error||"Failed to submit rating")}catch(he){throw console.error("Error submitting rating:",he),he}},je=(J,he)=>{if(!localStorage.getItem("token")){alert("Please log in to rate builds");return}we(J),Ge(he),Ae(!0)},at=()=>{Ae(!1),we(null),Ge("")},_e=S.filter(J=>J.name.toLowerCase().includes(T.toLowerCase())||J.description.toLowerCase().includes(T.toLowerCase())||J.creator_name.toLowerCase().includes(T.toLowerCase())).map(J=>{try{const he=typeof J.compatibility=="number"&&J.compatibility>0,Fe=Array.isArray(J.components)?J.components:Object.values(J.components||{});if(!he&&Fe.length>0){const ot={cpu:["cpu","processor","procie"],motherboard:["motherboard","mobo"],gpu:["gpu","graphics card","graphics","video card","vga"],ram:["ram","memory"],storage:["storage","ssd","hdd","nvme"],psu:["psu","power supply"],case:["case","chassis"],cooler:["cooler","cooling","aio"]},Tt={};Fe.forEach(xr=>{const Nt=String((xr==null?void 0:xr.category)||"").toLowerCase(),Ct=Object.keys(ot).find(_t=>_t===Nt||ot[_t].some(C=>Nt.includes(C)));Ct&&(Tt[Ct]=xr)});const Pr=Xo(Tt);if(Pr&&typeof Pr.score=="number"){const xr={...J,compatibility:Pr.score};return J.id&&kr(J.id,Pr.score),xr}}}catch{}return J}).filter(J=>{const he=Re(J.totalPrice);switch(z){case"under-50k":return he<5e4;case"50k-100k":return he>=5e4&&he<1e5;case"100k-200k":return he>=1e5&&he<2e5;case"over-200k":return he>=2e5;default:return!0}}).sort((J,he)=>{switch(D){case"newest":return new Date(he.createdAt)-new Date(J.createdAt);case"oldest":return new Date(J.createdAt)-new Date(he.createdAt);case"price-low":return Re(J.totalPrice)-Re(he.totalPrice);case"price-high":return Re(he.totalPrice)-Re(J.totalPrice);case"compatibility":return he.compatibility-J.compatibility;default:return 0}}),Xe=J=>{if(typeof J=="number"&&Number.isFinite(J))return J;if(typeof J=="string"){const he=J.replace(/[^0-9.\-]/g,""),Fe=Number(he);return Number.isFinite(Fe)?Fe:0}return 0},Xr=a.filter(J=>s==="all"||J.category===s).filter(J=>c==="all"||te(J)===c).filter(J=>J.name.toLowerCase().includes(d.toLowerCase())).filter(J=>{const he=Xe(J.price);switch(w){case"under-50k":return he<5e4;case"50k-100k":return he>=5e4&&he<1e5;case"100k-200k":return he>=1e5&&he<2e5;case"over-200k":return he>=2e5;default:return!0}}).sort((J,he)=>h==="price-asc"?Xe(J.price)-Xe(he.price):h==="price-desc"?Xe(he.price)-Xe(J.price):String(J.name).localeCompare(String(he.name)));return m("div",{className:"min-h-screen bg-gray-50",children:[l("div",{className:"bg-white shadow-sm border-b border-gray-200",children:m("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[m("div",{className:"text-center",children:[l("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Prebuilt PC Systems"}),l("p",{className:"text-lg text-gray-600 max-w-3xl mx-auto",children:"Expertly curated PC configurations using real components from our inventory."})]}),l("div",{className:"flex justify-center mt-8",children:m("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[m("button",{onClick:()=>q("prebuilts"),className:`px-6 py-3 rounded-md font-medium transition-colors flex items-center gap-2 ${Y==="prebuilts"?"bg-white text-green-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[l(Ye,{className:"w-5 h-5"}),"Prebuilt PCs"]}),m("button",{onClick:()=>q("community"),className:`px-6 py-3 rounded-md font-medium transition-colors flex items-center gap-2 ${Y==="community"?"bg-white text-green-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[l(iu,{className:"w-5 h-5"}),"Community Builds"]}),Lt()&&m("button",{onClick:()=>q("management"),className:`px-6 py-3 rounded-md font-medium transition-colors flex items-center gap-2 ${Y==="management"?"bg-white text-green-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[l(md,{className:"w-5 h-5"}),"Community Management",U.pending>0&&l("span",{className:"ml-1 bg-red-500 text-white text-xs px-2 py-0.5 rounded-full",children:U.pending})]})]})})]})}),m("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[Y==="prebuilts"&&m(lt,{children:[m("div",{className:"card mb-8",children:[m("div",{className:"flex flex-col lg:flex-row gap-4",children:[m("div",{className:"flex-1 relative",children:[l(Wi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),l("input",{type:"text",placeholder:"Search prebuilt PCs...",value:d,onChange:J=>f(J.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),m("select",{value:h,onChange:J=>p(J.target.value),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[l("option",{value:"name",children:"Sort by Name"}),l("option",{value:"price-asc",children:"Price: Low to High"}),l("option",{value:"price-desc",children:"Price: High to Low"})]})]}),m("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4 mt-6",children:[m("div",{children:[l("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Categories"}),l("div",{className:"flex flex-wrap gap-2",children:De.map(J=>m("button",{onClick:()=>o(J.id),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center ${s===J.id?"bg-green-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[Ke(J.id),l("span",{className:"ml-2",children:J.name}),l("span",{className:"ml-2 bg-white bg-opacity-20 px-2 py-0.5 rounded-full text-xs",children:J.count})]},J.id))})]}),m("div",{children:[l("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Brands"}),l("div",{className:"flex flex-wrap gap-2",children:ze.map(J=>m("button",{onClick:()=>u(J.id),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center ${c===J.id?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[l(ua,{className:"w-5 h-5"}),l("span",{className:"ml-2",children:J.name}),l("span",{className:"ml-2 bg-white bg-opacity-20 px-2 py-0.5 rounded-full text-xs",children:J.count})]},J.id))})]})]})]}),m("div",{className:"card mb-6 p-4 grid grid-cols-1 md:grid-cols-3 gap-4",children:[m("div",{children:[l("label",{className:"block text-sm text-gray-600 mb-1",children:"Sort"}),m("select",{value:h,onChange:J=>p(J.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[l("option",{value:"name",children:"Name"}),l("option",{value:"price-asc",children:"Price: Low to High"}),l("option",{value:"price-desc",children:"Price: High to Low"})]})]}),m("div",{children:[l("label",{className:"block text-sm text-gray-600 mb-1",children:"Price Range"}),m("select",{value:w,onChange:J=>b(J.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[l("option",{value:"all",children:"All"}),l("option",{value:"under-50k",children:"Under 50,000"}),l("option",{value:"50k-100k",children:"50,000 - 100,000"}),l("option",{value:"100k-200k",children:"100,000 - 200,000"}),l("option",{value:"over-200k",children:"Over 200,000"})]})]})]}),m("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[x&&Array.from({length:6}).map((J,he)=>m("div",{className:"card p-6 animate-pulse",children:[l("div",{className:"h-5 w-2/3 bg-gray-200 rounded mb-3"}),l("div",{className:"h-4 w-full bg-gray-100 rounded mb-2"}),l("div",{className:"h-4 w-5/6 bg-gray-100 rounded mb-2"}),l("div",{className:"h-4 w-1/2 bg-gray-100 rounded"})]},`s-${he}`)),!x&&Xr.length===0&&l("div",{className:"col-span-full",children:m("div",{className:"card p-8 text-center text-gray-600",children:[l(Ye,{className:"w-10 h-10 text-gray-400 mx-auto mb-2"}),"No results found"]})}),!x&&Xr.map(J=>m("div",{onClick:()=>ct(J),className:"card relative cursor-pointer hover:border-green-300",children:[l("div",{className:"absolute top-4 left-4 flex gap-2",children:!(J.in_stock||J.inStock)&&l("span",{className:"bg-gray-500 text-white px-2 py-1 rounded-full text-xs font-medium",children:"OUT OF STOCK"})}),l("div",{className:"absolute top-4 right-4 bg-green-600 text-white p-2 rounded-full opacity-0 hover:opacity-100 transition-opacity",children:l(Hi,{className:"w-4 h-4"})}),m("div",{className:"p-6",children:[m("div",{className:"flex items-start justify-between gap-2 mb-2",children:[l("h2",{className:"text-xl font-bold text-gray-900",children:J.name}),et(J)]}),l("div",{className:"text-gray-600 mb-2",children:J.description}),(()=>{const he=Qe(J);return m("div",{className:"flex flex-wrap gap-2 mb-3",children:[he.cpu&&m("span",{className:"inline-flex items-center px-2 py-1 rounded bg-gray-100 text-gray-800 text-xs",children:["CPU: ",he.cpu]}),he.gpu&&m("span",{className:"inline-flex items-center px-2 py-1 rounded bg-gray-100 text-gray-800 text-xs",children:["GPU: ",he.gpu]}),he.ram&&m("span",{className:"inline-flex items-center px-2 py-1 rounded bg-gray-100 text-gray-800 text-xs",children:["RAM: ",he.ram]}),he.storage&&m("span",{className:"inline-flex items-center px-2 py-1 rounded bg-gray-100 text-gray-800 text-xs",children:["Storage: ",he.storage]})]})})(),m("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-600 mb-2",children:[m("li",{className:"flex items-center gap-1",children:[l(L8,{className:"w-4 h-4 text-green-500"}),l("span",{className:"font-medium",children:"Category:"})," ",J.category]}),m("li",{className:"flex items-center gap-1",children:[l(k8,{className:"w-4 h-4 text-green-500"}),l("span",{className:"font-medium",children:"Price:"})," ",gt(J.price,{minimumFractionDigits:0,maximumFractionDigits:0})]})]})]})]},J.id))]})]}),Y==="community"&&m("div",{children:[m("div",{className:"mb-8",children:[m("div",{className:"flex items-center justify-between mb-4",children:[m("div",{children:[l("h2",{className:"text-2xl font-bold mb-1",children:"Community Builds"}),l("p",{className:"text-gray-600",children:"Discover and get inspired by PC builds shared by the community"})]}),m("div",{className:"flex gap-3",children:[m("button",{onClick:()=>e("my-builds"),className:"border-2 border-gray-300 text-gray-700 px-5 py-2 rounded-lg font-semibold hover:bg-gray-50 transition-colors flex items-center gap-2",children:[l(lo,{className:"w-5 h-5"})," My Builds"]}),m("button",{onClick:()=>e("pc-assembly"),className:"bg-green-600 text-white px-5 py-2 rounded-lg font-semibold hover:bg-green-700 transition-colors flex items-center gap-2",children:[l(Ye,{className:"w-5 h-5"})," Create Build"]})]})]}),S.length>0&&m("div",{className:"mb-6 text-gray-700 text-lg",children:["Total builds: ",_e.length,"    Total value: ",gt(_e.reduce((J,he)=>J+Re(he.totalPrice),0))]})]}),S.length>0&&l("div",{className:"card mb-6 p-4",children:m("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[m("div",{className:"relative",children:[l(Wi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),l("input",{type:"text",placeholder:"Search builds, creators...",value:T,onChange:J=>R(J.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),m("select",{value:D,onChange:J=>L(J.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[l("option",{value:"newest",children:"Newest First"}),l("option",{value:"oldest",children:"Oldest First"}),l("option",{value:"price-low",children:"Price: Low to High"}),l("option",{value:"price-high",children:"Price: High to Low"}),l("option",{value:"compatibility",children:"Best Compatibility"})]}),m("select",{value:z,onChange:J=>X(J.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[l("option",{value:"all",children:"All Prices"}),l("option",{value:"under-50k",children:"Under 50,000"}),l("option",{value:"50k-100k",children:"50,000 - 100,000"}),l("option",{value:"100k-200k",children:"100,000 - 200,000"}),l("option",{value:"over-200k",children:"Over 200,000"})]}),m("div",{className:"text-sm text-gray-600 flex items-center justify-center",children:[_e.length," of ",S.length," builds"]})]})}),_?l("div",{className:"flex items-center justify-center h-64",children:m("div",{className:"text-center",children:[l("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),l("p",{className:"mt-4 text-gray-600",children:"Loading community builds..."})]})}):S.length===0?m("div",{className:"flex flex-col items-center justify-center py-16 px-6",children:[l("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-6",children:l(hc,{className:"w-12 h-12 text-gray-400"})}),l("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No public builds yet"}),l("p",{className:"text-gray-600 text-center max-w-md mb-8",children:"Be the first to share your PC build with the community! Create a build and make it public to inspire others."}),m("div",{className:"flex flex-col sm:flex-row gap-4",children:[m("button",{onClick:()=>e("pc-assembly"),className:"bg-green-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-700 transition-colors flex items-center gap-2",children:[l(Ye,{className:"w-5 h-5"}),"Create Your Build"]}),m("button",{onClick:()=>e("my-builds"),className:"border-2 border-gray-300 text-gray-700 px-6 py-3 rounded-lg font-semibold hover:bg-gray-50 transition-colors flex items-center gap-2",children:[l(lo,{className:"w-5 h-5"}),"View My Builds"]})]})]}):_e.length===0?m("div",{className:"text-center py-16",children:[l("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6",children:l(Wi,{className:"w-12 h-12 text-gray-400"})}),l("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No builds found"}),l("p",{className:"text-gray-600",children:"Try adjusting your search or filter criteria."})]}):l("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:_e.map(J=>{var he,Fe;return l("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:m("div",{className:"p-6",children:[m("div",{className:"flex items-start justify-between mb-4",children:[m("div",{className:"flex-1",children:[l("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:J.name}),l("p",{className:"text-sm text-gray-600 mb-2",children:J.description}),m("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[m("div",{className:"flex items-center gap-1",children:[l(Ko,{className:"w-4 h-4"}),J.creator_name]}),m("div",{className:"flex items-center gap-1",children:[l(Hd,{className:"w-4 h-4"}),mt(J.createdAt)]}),m("div",{className:"flex items-center gap-1",children:[l(Ye,{className:"w-4 h-4"}),gt(Re(J.totalPrice))]})]})]}),l("div",{className:"flex items-center gap-2",children:l("button",{onClick:()=>kt(J.id),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",title:"Copy build link",children:l(IS,{className:"w-4 h-4"})})})]}),m("div",{className:"flex items-center justify-between mb-4",children:[m("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full ${ht(J.compatibility).bgColor}`,children:[ht(J.compatibility).icon,m("span",{className:`text-sm font-medium ${ht(J.compatibility).color}`,children:[J.compatibility,"% Compatible"]})]}),m("div",{className:"flex items-center gap-2",children:[l("span",{className:"text-sm text-gray-500",children:"Shared:"}),l("span",{className:"text-sm font-medium text-gray-900",children:mt(J.createdAt)})]})]}),m("div",{className:"flex items-center justify-between mb-4",children:[l("div",{className:"flex items-center gap-3",children:l(GB,{children:l(o3,{rating:Number((he=ce[J.id])==null?void 0:he.average_rating)||0,maxRating:5,size:"sm",showAverage:!0,totalRatings:Number((Fe=ce[J.id])==null?void 0:Fe.total_ratings)||0,className:"text-yellow-500"})})}),m("button",{onClick:()=>je(J.id,J.name),className:"flex items-center gap-1 px-3 py-1 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:[l(ob,{className:"w-4 h-4"}),localStorage.getItem("token")?j[J.id]?"Update Rating":"Rate Build":"Login to Rate"]})]}),m("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[(Array.isArray(J.components)?J.components:Object.values(J.components||{})).slice(0,8).map((ot,Tt)=>m("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[l("div",{className:"text-xs font-medium text-gray-600 mb-1",children:ot.category}),l("div",{className:"text-sm font-semibold text-gray-900 truncate",children:ot.name}),l("div",{className:"text-xs text-gray-500",children:gt(ot.price||0)})]},Tt)),(Array.isArray(J.components)?J.components:Object.values(J.components||{})).length>8&&m("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[m("div",{className:"text-xs font-medium text-blue-600 mb-1",children:["+",(Array.isArray(J.components)?J.components:Object.values(J.components||{})).length-8," more"]}),l("div",{className:"text-sm font-semibold text-blue-800",children:"components"})]})]}),m("div",{className:"flex gap-3",children:[m("button",{className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center justify-center gap-2",onClick:()=>A(J),children:[l(lo,{className:"w-4 h-4"}),"View Details"]}),m("button",{onClick:()=>tt(J),className:"flex-1 border-2 border-gray-300 text-gray-700 py-2 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors flex items-center justify-center gap-2",children:[l(oo,{className:"w-4 h-4"}),"Use This Build"]})]})]})},J.id)})})]}),Y==="management"&&Lt()&&m("div",{children:[m("div",{className:"mb-8",children:[l("div",{className:"flex items-center justify-between mb-4",children:m("div",{children:[l("h2",{className:"text-2xl font-bold mb-1",children:"Community Management"}),l("p",{className:"text-gray-600",children:"Review and manage community build submissions"})]})}),m("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[l("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:m("div",{className:"flex items-center gap-3",children:[l("div",{className:"w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center",children:l(ho,{className:"w-5 h-5 text-yellow-600"})}),m("div",{children:[l("h3",{className:"font-semibold text-gray-900",children:"Pending"}),l("p",{className:"text-2xl font-bold text-yellow-600",children:U.pending||0})]})]})}),l("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:m("div",{className:"flex items-center gap-3",children:[l("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:l(yt,{className:"w-5 h-5 text-green-600"})}),m("div",{children:[l("h3",{className:"font-semibold text-gray-900",children:"Approved"}),l("p",{className:"text-2xl font-bold text-green-600",children:U.approved||0})]})]})}),l("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:m("div",{className:"flex items-center gap-3",children:[l("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:l(Cn,{className:"w-5 h-5 text-red-600"})}),m("div",{children:[l("h3",{className:"font-semibold text-gray-900",children:"Rejected"}),l("p",{className:"text-2xl font-bold text-red-600",children:U.rejected||0})]})]})})]})]}),ae?l("div",{className:"flex items-center justify-center h-64",children:m("div",{className:"text-center",children:[l("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),l("p",{className:"mt-4 text-gray-600",children:"Loading submissions..."})]})}):ee.length===0?m("div",{className:"flex flex-col items-center justify-center py-16 px-6",children:[l("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-6",children:l(md,{className:"w-12 h-12 text-gray-400"})}),l("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No submissions to review"}),l("p",{className:"text-gray-600 text-center max-w-md",children:"All community build submissions have been reviewed. Check back later for new submissions."})]}):l("div",{className:"space-y-4",children:ee.map(J=>l("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:m("div",{className:"flex items-start justify-between mb-4",children:[m("div",{className:"flex-1",children:[m("div",{className:"flex items-center gap-3 mb-2",children:[l("h3",{className:"text-lg font-semibold text-gray-900",children:J.build_name}),l("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${J.status==="pending"?"bg-yellow-100 text-yellow-800":J.status==="approved"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:J.status.charAt(0).toUpperCase()+J.status.slice(1)})]}),l("p",{className:"text-sm text-gray-600 mb-2",children:J.build_description}),m("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[m("div",{className:"flex items-center gap-1",children:[l(Ko,{className:"w-4 h-4"}),J.submitter_name]}),m("div",{className:"flex items-center gap-1",children:[l(Hd,{className:"w-4 h-4"}),mt(J.submitted_at)]}),m("div",{className:"flex items-center gap-1",children:[l(Ye,{className:"w-4 h-4"}),gt(J.total_price)]}),m("div",{className:"flex items-center gap-1",children:[l(yt,{className:"w-4 h-4"}),J.compatibility,"% Compatible"]})]}),J.admin_notes&&l("div",{className:"mt-2 p-3 bg-gray-50 rounded-lg",children:m("p",{className:"text-sm text-gray-700",children:[l("strong",{children:"Admin Notes:"})," ",J.admin_notes]})})]}),m("div",{className:"flex gap-2",children:[J.status==="pending"&&l("button",{onClick:()=>W(J),className:"px-4 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition-colors",children:"Review"}),(J.status==="approved"||J.status==="rejected")&&l("button",{onClick:()=>Ht(J.id,J.build_name),className:"px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition-colors",children:"Delete"})]})]})},J.id))})]}),P&&(()=>{const J=Array.isArray(P.components)?P.components:Object.values(P.components||{});return l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:m("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[l("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-xl",children:m("div",{className:"flex items-center justify-between",children:[m("div",{className:"flex items-center gap-4",children:[l("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:l(hc,{className:"w-6 h-6 text-green-600"})}),m("div",{children:[l("h2",{className:"text-2xl font-bold text-gray-900",children:P.name}),m("p",{className:"text-gray-600",children:["Shared by ",P.creator_name]})]})]}),l("button",{onClick:()=>A(null),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors",children:l("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),m("div",{className:"p-6",children:[m("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[m("div",{className:"bg-gradient-to-br from-green-50 to-blue-50 rounded-xl p-6 border border-green-200",children:[m("div",{className:"flex items-center gap-3 mb-3",children:[l("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:l(yt,{className:"w-5 h-5 text-green-600"})}),m("div",{children:[l("h3",{className:"font-semibold text-gray-900",children:"Compatibility"}),m("p",{className:"text-2xl font-bold text-green-600",children:[P.compatibility,"%"]})]})]}),l("div",{className:"w-full bg-gray-200 rounded-full h-2",children:l("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${P.compatibility}%`}})})]}),m("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl p-6 border border-blue-200",children:[m("div",{className:"flex items-center gap-3 mb-3",children:[l("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:l(Ye,{className:"w-5 h-5 text-blue-600"})}),m("div",{children:[l("h3",{className:"font-semibold text-gray-900",children:"Total Price"}),l("p",{className:"text-2xl font-bold text-blue-600",children:gt(P.totalPrice||0)})]})]}),l("p",{className:"text-sm text-gray-600",children:"All components included"})]}),m("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-6 border border-purple-200",children:[m("div",{className:"flex items-center gap-3 mb-3",children:[l("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:l(Ko,{className:"w-5 h-5 text-purple-600"})}),m("div",{children:[l("h3",{className:"font-semibold text-gray-900",children:"Creator"}),l("p",{className:"text-lg font-bold text-purple-600",children:P.creator_name})]})]}),m("p",{className:"text-sm text-gray-600",children:["Build shared on ",mt(P.createdAt)]})]})]}),m("div",{className:"bg-gray-50 rounded-xl p-6 mb-8",children:[m("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[l(Gv,{className:"w-5 h-5 text-gray-600"}),"Build Description"]}),l("p",{className:"text-gray-700 leading-relaxed",children:P.description})]}),m("div",{children:[m("h3",{className:"text-xl font-bold text-gray-900 mb-6 flex items-center gap-2",children:[l(Ye,{className:"w-6 h-6 text-gray-600"}),"Build Components"]}),l("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:J.sort((he,Fe)=>{var Ct,_t;const ot=["motherboard","cpu","gpu","ram","storage","psu","case","cooler"],Tt=((Ct=he==null?void 0:he.category)==null?void 0:Ct.toLowerCase())||"",Pr=((_t=Fe==null?void 0:Fe.category)==null?void 0:_t.toLowerCase())||"",xr=ot.indexOf(Tt),Nt=ot.indexOf(Pr);return xr!==-1&&Nt!==-1?xr-Nt:xr!==-1?-1:Nt!==-1?1:((he==null?void 0:he.category)||"").localeCompare((Fe==null?void 0:Fe.category)||"")}).map((he,Fe)=>l("div",{className:"bg-white border border-gray-200 rounded-xl p-6 hover:shadow-lg transition-shadow",children:m("div",{className:"flex items-start gap-4",children:[l("div",{className:"w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0",children:l(Ye,{className:"w-8 h-8 text-gray-400"})}),m("div",{className:"flex-1 min-w-0",children:[m("div",{className:"flex items-center justify-between mb-2",children:[l("span",{className:"inline-block bg-green-100 text-green-800 text-xs font-medium px-2 py-1 rounded-full",children:he.category}),l("span",{className:"text-lg font-bold text-green-600",children:gt(he.price||0)})]}),l("h4",{className:"font-semibold text-gray-900 text-lg mb-2 line-clamp-2",children:he.name}),he.brand&&m("p",{className:"text-sm text-gray-600 mb-2",children:["Brand: ",l("span",{className:"font-medium",children:he.brand})]}),he.specs&&l("div",{className:"text-xs text-gray-500 space-y-1",children:Object.entries(he.specs).slice(0,3).map(([ot,Tt])=>m("div",{className:"flex justify-between",children:[m("span",{className:"capitalize",children:[ot.replace(/_/g," "),":"]}),l("span",{className:"font-medium",children:Tt})]},ot))})]})]})},Fe))})]}),l("div",{className:"mt-8",children:l(s3,{buildId:P.id,user:n,className:"mb-8"})}),m("div",{className:"flex gap-4 mt-8 pt-6 border-t border-gray-200",children:[m("button",{onClick:()=>tt(P),className:"flex-1 bg-green-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-green-700 transition-colors flex items-center justify-center gap-2",children:[l(oo,{className:"w-5 h-5"}),"Use This Build"]}),m("button",{onClick:()=>kt(P.id),className:"flex-1 border-2 border-gray-300 text-gray-700 py-3 px-6 rounded-lg font-semibold hover:bg-gray-50 transition-colors flex items-center justify-center gap-2",children:[l(IS,{className:"w-5 h-5"}),"Copy Link"]})]})]})]})})})(),I&&l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:m("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[l("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-xl",children:m("div",{className:"flex items-center justify-between",children:[m("div",{className:"flex items-center gap-4",children:[l("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:l(md,{className:"w-6 h-6 text-blue-600"})}),m("div",{children:[l("h2",{className:"text-2xl font-bold text-gray-900",children:"Review Submission"}),l("p",{className:"text-gray-600",children:I.build_name})]})]}),l("button",{onClick:()=>W(null),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors",children:l(Gn,{className:"w-6 h-6"})})]})}),m("div",{className:"p-6",children:[m("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[m("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl p-6 border border-blue-200",children:[m("div",{className:"flex items-center gap-3 mb-3",children:[l("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:l(Ko,{className:"w-5 h-5 text-blue-600"})}),m("div",{children:[l("h3",{className:"font-semibold text-gray-900",children:"Submitter"}),l("p",{className:"text-lg font-bold text-blue-600",children:I.submitter_name})]})]}),m("p",{className:"text-sm text-gray-600",children:["Submitted on ",mt(I.submitted_at)]})]}),m("div",{className:"bg-gradient-to-br from-green-50 to-blue-50 rounded-xl p-6 border border-green-200",children:[m("div",{className:"flex items-center gap-3 mb-3",children:[l("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:l(yt,{className:"w-5 h-5 text-green-600"})}),m("div",{children:[l("h3",{className:"font-semibold text-gray-900",children:"Compatibility"}),m("p",{className:"text-2xl font-bold text-green-600",children:[I.compatibility,"%"]})]})]}),l("div",{className:"w-full bg-gray-200 rounded-full h-2",children:l("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${I.compatibility}%`}})})]})]}),m("div",{className:"bg-gray-50 rounded-xl p-6 mb-6",children:[l("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Build Information"}),m("div",{className:"space-y-3",children:[m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Build Name"}),l("p",{className:"text-gray-900 font-medium",children:I.build_name})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),l("p",{className:"text-gray-900",children:I.build_description||"No description provided"})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Price"}),l("p",{className:"text-gray-900 font-medium",children:gt(I.total_price)})]})]})]}),m("div",{className:"mb-6",children:[l("label",{htmlFor:"review-notes",className:"block text-sm font-medium text-gray-700 mb-2",children:"Review Notes (Optional)"}),l("textarea",{id:"review-notes",value:ne,onChange:J=>K(J.target.value),placeholder:"Add notes about your decision (will be shared with the submitter)...",rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none",maxLength:500}),m("p",{className:"text-xs text-gray-500 mt-1",children:[ne.length,"/500 characters"]})]}),m("div",{className:"flex gap-4 pt-6 border-t border-gray-200",children:[l("button",{onClick:()=>W(null),className:"flex-1 px-4 py-3 border-2 border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Cancel"}),l("button",{onClick:()=>ut(I.id,"rejected"),disabled:le,className:"flex-1 px-4 py-3 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition-colors disabled:opacity-50",children:le?"Processing...":"Reject"}),l("button",{onClick:()=>ut(I.id,"approved"),disabled:le,className:"flex-1 px-4 py-3 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition-colors disabled:opacity-50",children:le?"Processing...":"Approve"})]})]})]})})]}),l(WB,{isOpen:Ee,onClose:at,buildId:Be,buildName:de,onSubmitRating:Ne,existingRating:Be?j[Be]:null})]})},Vm=({user:e})=>{const{notifications:t,loading:r,markAsRead:n,markAllAsRead:a,deleteNotification:i,deleteAllNotifications:s}=dp(),[o,c]=N.useState("all"),u=g=>{switch(g){case"order":return l(yt,{className:"w-5 h-5 text-green-600"});case"build":return l(mo,{className:"w-5 h-5 text-orange-600"});case"system":return l(mc,{className:"w-5 h-5 text-blue-600"});case"promo":return l(Ea,{className:"w-5 h-5 text-purple-600"});case"support":return l(yt,{className:"w-5 h-5 text-blue-600"});default:return l(Ea,{className:"w-5 h-5 text-gray-600"})}},d=(g,y)=>{if(!g)return null;if(y==="stock"){const v=g.split(`
`).filter(_=>_.trim().length>0),w=v[0]||"",b=v.slice(1).filter(_=>_.trim().startsWith("-")),S=v.slice(1).filter(_=>!_.trim().startsWith("-")),k=S.length>0?S[S.length-1]:"";return m("div",{children:[w&&l("p",{className:"text-sm text-gray-600 mt-1",children:w}),b.length>0&&l("ul",{className:"list-disc pl-5 text-sm text-gray-600 mt-1 space-y-1",children:b.map((_,E)=>l("li",{children:_.replace(/^[-\s]+/,"")},E))}),k&&l("p",{className:"text-sm text-gray-600 mt-2",children:k})]})}return l("p",{className:"text-sm text-gray-600 mt-1 whitespace-pre-line",children:g})},f=g=>{switch(g){case"high":return"border-l-red-500";case"medium":return"border-l-orange-500";case"low":return"border-l-green-500";default:return"border-l-gray-500"}},h=g=>{if(!g||isNaN(g.getTime()))return"Unknown time";const y=Date.now()-g.getTime(),v=Math.abs(y),w=Math.floor(v/(1e3*60)),b=Math.floor(v/(1e3*60*60)),S=Math.floor(v/(1e3*60*60*24));if(v<60*1e3)return"just now";const k=y<0,_=" ago",E="in ";return w<60?k?`${E}${w} minute${w!==1?"s":""}`:`${w} minute${w!==1?"s":""}${_}`:b<24?k?`${E}${b} hour${b!==1?"s":""}`:`${b} hour${b!==1?"s":""}${_}`:k?`${E}${S} day${S!==1?"s":""}`:`${S} day${S!==1?"s":""}${_}`},p=t.filter(g=>o==="unread"?!g.read:o==="read"?g.read:!0),x=t.filter(g=>!g.read).length;return r?l("div",{className:"flex items-center justify-center h-full",children:l("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"})}):m("div",{className:"p-6 max-w-4xl mx-auto",children:[m("div",{className:"flex items-center justify-between mb-6",children:[m("div",{className:"flex items-center space-x-3",children:[l("div",{className:"w-10 h-10 bg-green-600 rounded-lg flex items-center justify-center",children:l(Ea,{className:"w-6 h-6 text-white"})}),m("div",{children:[l("h1",{className:"text-2xl font-bold text-gray-900",children:"Notifications"}),m("p",{className:"text-sm text-gray-500",children:[x," unread notification",x!==1?"s":""]})]})]}),m("div",{className:"flex items-center space-x-3",children:[m("select",{value:o,onChange:g=>c(g.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[l("option",{value:"all",children:"All Notifications"}),l("option",{value:"unread",children:"Unread"}),l("option",{value:"read",children:"Read"})]}),x>0&&l("button",{onClick:a,className:"px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-md hover:bg-green-700 transition-colors",children:"Mark All as Read"}),t.length>0&&l("button",{onClick:()=>{window.confirm("Are you sure you want to delete all notifications?")&&s()},className:"px-4 py-2 bg-red-600 text-white text-sm font-medium rounded-md hover:bg-red-700 transition-colors",children:"Delete All"})]})]}),l("div",{className:"space-y-3",children:p.length===0?m("div",{className:"text-center py-12",children:[l(Ea,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:o==="all"?"No notifications yet":`No ${o} notifications`}),l("p",{className:"text-gray-500",children:o==="all"?"You'll see important updates here when they arrive.":`You have no ${o} notifications at the moment.`})]}):p.map(g=>l("div",{className:`bg-white rounded-lg border border-gray-200 p-4 transition-all duration-200 hover:shadow-md ${g.read?"":"border-l-4 "+f(g.priority)} ${g.read?"":"bg-blue-50"}`,children:m("div",{className:"flex items-start space-x-3",children:[l("div",{className:"flex-shrink-0 mt-1",children:u(g.type)}),l("div",{className:"flex-1 min-w-0",children:m("div",{className:"flex items-start justify-between",children:[m("div",{className:"flex-1",children:[l("h3",{className:`text-sm font-medium ${g.read?"text-gray-700":"text-gray-900"}`,children:g.title}),d(g.message,g.type),m("div",{className:"flex items-center mt-2 text-xs text-gray-500",children:[l(ho,{className:"w-3 h-3 mr-1"}),h(g.timestamp)]})]}),m("div",{className:"flex items-center space-x-2 ml-4",children:[!g.read&&l("button",{onClick:()=>n(g.id),className:"p-1 text-gray-400 hover:text-green-600 transition-colors",title:"Mark as read",children:l(rb,{className:"w-4 h-4"})}),l("button",{onClick:()=>i(g.id),className:"p-1 text-gray-400 hover:text-red-600 transition-colors",title:"Delete notification",children:l(an,{className:"w-4 h-4"})})]})]})})]})},g.id))})]})};function l3(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=l3(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function It(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=l3(e))&&(n&&(n+=" "),n+=t);return n}var XB=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function vb(e){if(typeof e!="string")return!1;var t=XB;return t.includes(e)}var qB=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function c3(e){if(typeof e!="string")return!1;var t=qB;return t.includes(e)}function u3(e){return typeof e=="string"&&e.startsWith("data-")}function Ra(e){var t=Object.entries(e).filter(r=>{var[n]=r;return c3(n)||u3(n)});return Object.fromEntries(t)}function gl(e){if(e==null)return null;if(N.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return Ra(t)}return typeof e=="object"&&!Array.isArray(e)?Ra(e):null}function Kn(e){var t=Object.entries(e).filter(r=>{var[n]=r;return c3(n)||u3(n)||vb(n)});return Object.fromEntries(t)}function YB(e){return e==null?null:N.isValidElement(e)?Kn(e.props):typeof e=="object"&&!Array.isArray(e)?Kn(e):null}var JB=["children","width","height","viewBox","className","style","title","desc"];function Zv(){return Zv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zv.apply(null,arguments)}function QB(e,t){if(e==null)return{};var r,n,a=ZB(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ZB(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var yb=N.forwardRef((e,t)=>{var{children:r,width:n,height:a,viewBox:i,className:s,style:o,title:c,desc:u}=e,d=QB(e,JB),f=i||{width:n,height:a,x:0,y:0},h=It("recharts-surface",s);return N.createElement("svg",Zv({},Kn(d),{className:h,width:n,height:a,style:o,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height),ref:t}),N.createElement("title",null,c),N.createElement("desc",null,u),r)}),e7=["children","className"];function ey(){return ey=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ey.apply(null,arguments)}function t7(e,t){if(e==null)return{};var r,n,a=r7(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function r7(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var pn=N.forwardRef((e,t)=>{var{children:r,className:n}=e,a=t7(e,e7),i=It("recharts-layer",n);return N.createElement("g",ey({className:i},Kn(a),{ref:t}),r)}),d3=N.createContext(null),n7=()=>N.useContext(d3);function Xt(e){return function(){return e}}const f3=Math.cos,Km=Math.sin,Oi=Math.sqrt,Xm=Math.PI,vp=2*Xm,ty=Math.PI,ry=2*ty,$o=1e-6,a7=ry-$o;function m3(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function i7(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return m3;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class s7{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?m3:i7(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,s){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,o=this._y1,c=n-t,u=a-r,d=s-t,f=o-r,h=d*d+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(h>$o)if(!(Math.abs(f*c-u*d)>$o)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let p=n-s,x=a-o,g=c*c+u*u,y=p*p+x*x,v=Math.sqrt(g),w=Math.sqrt(h),b=i*Math.tan((ty-Math.acos((g+h-y)/(2*v*w)))/2),S=b/w,k=b/v;Math.abs(S-1)>$o&&this._append`L${t+S*d},${r+S*f}`,this._append`A${i},${i},0,0,${+(f*p>d*x)},${this._x1=t+k*c},${this._y1=r+k*u}`}}arc(t,r,n,a,i,s){if(t=+t,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(a),c=n*Math.sin(a),u=t+o,d=r+c,f=1^s,h=s?a-i:i-a;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>$o||Math.abs(this._y1-d)>$o)&&this._append`L${u},${d}`,n&&(h<0&&(h=h%ry+ry),h>a7?this._append`A${n},${n},0,1,${f},${t-o},${r-c}A${n},${n},0,1,${f},${this._x1=u},${this._y1=d}`:h>$o&&this._append`A${n},${n},0,${+(h>=ty)},${f},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function bb(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new s7(t)}function wb(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function h3(e){this._context=e}h3.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function yp(e){return new h3(e)}function p3(e){return e[0]}function g3(e){return e[1]}function x3(e,t){var r=Xt(!0),n=null,a=yp,i=null,s=bb(o);e=typeof e=="function"?e:e===void 0?p3:Xt(e),t=typeof t=="function"?t:t===void 0?g3:Xt(t);function o(c){var u,d=(c=wb(c)).length,f,h=!1,p;for(n==null&&(i=a(p=s())),u=0;u<=d;++u)!(u<d&&r(f=c[u],u,c))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+e(f,u,c),+t(f,u,c));if(p)return i=null,p+""||null}return o.x=function(c){return arguments.length?(e=typeof c=="function"?c:Xt(+c),o):e},o.y=function(c){return arguments.length?(t=typeof c=="function"?c:Xt(+c),o):t},o.defined=function(c){return arguments.length?(r=typeof c=="function"?c:Xt(!!c),o):r},o.curve=function(c){return arguments.length?(a=c,n!=null&&(i=a(n)),o):a},o.context=function(c){return arguments.length?(c==null?n=i=null:i=a(n=c),o):n},o}function w0(e,t,r){var n=null,a=Xt(!0),i=null,s=yp,o=null,c=bb(u);e=typeof e=="function"?e:e===void 0?p3:Xt(+e),t=typeof t=="function"?t:Xt(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?g3:Xt(+r);function u(f){var h,p,x,g=(f=wb(f)).length,y,v=!1,w,b=new Array(g),S=new Array(g);for(i==null&&(o=s(w=c())),h=0;h<=g;++h){if(!(h<g&&a(y=f[h],h,f))===v)if(v=!v)p=h,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),x=h-1;x>=p;--x)o.point(b[x],S[x]);o.lineEnd(),o.areaEnd()}v&&(b[h]=+e(y,h,f),S[h]=+t(y,h,f),o.point(n?+n(y,h,f):b[h],r?+r(y,h,f):S[h]))}if(w)return o=null,w+""||null}function d(){return x3().defined(a).curve(s).context(i)}return u.x=function(f){return arguments.length?(e=typeof f=="function"?f:Xt(+f),n=null,u):e},u.x0=function(f){return arguments.length?(e=typeof f=="function"?f:Xt(+f),u):e},u.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:Xt(+f),u):n},u.y=function(f){return arguments.length?(t=typeof f=="function"?f:Xt(+f),r=null,u):t},u.y0=function(f){return arguments.length?(t=typeof f=="function"?f:Xt(+f),u):t},u.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:Xt(+f),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(n).y(t)},u.defined=function(f){return arguments.length?(a=typeof f=="function"?f:Xt(!!f),u):a},u.curve=function(f){return arguments.length?(s=f,i!=null&&(o=s(i)),u):s},u.context=function(f){return arguments.length?(f==null?i=o=null:o=s(i=f),u):i},u}class v3{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function o7(e){return new v3(e,!0)}function l7(e){return new v3(e,!1)}const Nb={draw(e,t){const r=Oi(t/Xm);e.moveTo(r,0),e.arc(0,0,r,0,vp)}},c7={draw(e,t){const r=Oi(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},y3=Oi(1/3),u7=y3*2,d7={draw(e,t){const r=Oi(t/u7),n=r*y3;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},f7={draw(e,t){const r=Oi(t),n=-r/2;e.rect(n,n,r,r)}},m7=.8908130915292852,b3=Km(Xm/10)/Km(7*Xm/10),h7=Km(vp/10)*b3,p7=-f3(vp/10)*b3,g7={draw(e,t){const r=Oi(t*m7),n=h7*r,a=p7*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const s=vp*i/5,o=f3(s),c=Km(s);e.lineTo(c*r,-o*r),e.lineTo(o*n-c*a,c*n+o*a)}e.closePath()}},cx=Oi(3),x7={draw(e,t){const r=-Oi(t/(cx*3));e.moveTo(0,r*2),e.lineTo(-cx*r,-r),e.lineTo(cx*r,-r),e.closePath()}},$a=-.5,Ua=Oi(3)/2,ny=1/Oi(12),v7=(ny/2+1)*3,y7={draw(e,t){const r=Oi(t/v7),n=r/2,a=r*ny,i=n,s=r*ny+r,o=-i,c=s;e.moveTo(n,a),e.lineTo(i,s),e.lineTo(o,c),e.lineTo($a*n-Ua*a,Ua*n+$a*a),e.lineTo($a*i-Ua*s,Ua*i+$a*s),e.lineTo($a*o-Ua*c,Ua*o+$a*c),e.lineTo($a*n+Ua*a,$a*a-Ua*n),e.lineTo($a*i+Ua*s,$a*s-Ua*i),e.lineTo($a*o+Ua*c,$a*c-Ua*o),e.closePath()}};function b7(e,t){let r=null,n=bb(a);e=typeof e=="function"?e:Xt(e||Nb),t=typeof t=="function"?t:Xt(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:Xt(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:Xt(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function qm(){}function Ym(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function w3(e){this._context=e}w3.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Ym(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Ym(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function w7(e){return new w3(e)}function N3(e){this._context=e}N3.prototype={areaStart:qm,areaEnd:qm,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Ym(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function N7(e){return new N3(e)}function S3(e){this._context=e}S3.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:Ym(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function S7(e){return new S3(e)}function k3(e){this._context=e}k3.prototype={areaStart:qm,areaEnd:qm,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function k7(e){return new k3(e)}function ck(e){return e<0?-1:1}function uk(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),s=(r-e._y1)/(a||n<0&&-0),o=(i*a+s*n)/(n+a);return(ck(i)+ck(s))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs(o))||0}function dk(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function ux(e,t,r){var n=e._x0,a=e._y0,i=e._x1,s=e._y1,o=(i-n)/3;e._context.bezierCurveTo(n+o,a+o*t,i-o,s-o*r,i,s)}function Jm(e){this._context=e}Jm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:ux(this,this._t0,dk(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,ux(this,dk(this,r=uk(this,e,t)),r);break;default:ux(this,this._t0,r=uk(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function _3(e){this._context=new E3(e)}(_3.prototype=Object.create(Jm.prototype)).point=function(e,t){Jm.prototype.point.call(this,t,e)};function E3(e){this._context=e}E3.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function _7(e){return new Jm(e)}function E7(e){return new _3(e)}function C3(e){this._context=e}C3.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=fk(e),a=fk(t),i=0,s=1;s<r;++i,++s)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[s],t[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function fk(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),s=new Array(r);for(a[0]=0,i[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,s[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,s[t]-=n*s[t-1];for(a[r-1]=s[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(s[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function C7(e){return new C3(e)}function bp(e,t){this._context=e,this._t=t}bp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function A7(e){return new bp(e,.5)}function T7(e){return new bp(e,0)}function P7(e){return new bp(e,1)}function Uc(e,t){if((s=e.length)>1)for(var r=1,n,a,i=e[t[0]],s,o=i.length;r<s;++r)for(a=i,i=e[t[r]],n=0;n<o;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function ay(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function O7(e,t){return e[t]}function D7(e){const t=[];return t.key=e,t}function R7(){var e=Xt([]),t=ay,r=Uc,n=O7;function a(i){var s=Array.from(e.apply(this,arguments),D7),o,c=s.length,u=-1,d;for(const f of i)for(o=0,++u;o<c;++o)(s[o][u]=[0,+n(f,s[o].key,u,i)]).data=f;for(o=0,d=wb(t(s));o<c;++o)s[d[o]].index=o;return r(s,d),s}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:Xt(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:Xt(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?ay:typeof i=="function"?i:Xt(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??Uc,a):r},a}function M7(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,s;a<i;++a){for(s=r=0;r<n;++r)s+=e[r][a][1]||0;if(s)for(r=0;r<n;++r)e[r][a][1]/=s}Uc(e,t)}}function I7(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var s=0,o=0;s<a;++s)o+=e[s][r][1]||0;n[r][1]+=n[r][0]=-o/2}Uc(e,t)}}function F7(e,t){if(!(!((s=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,s;n<i;++n){for(var o=0,c=0,u=0;o<s;++o){for(var d=e[t[o]],f=d[n][1]||0,h=d[n-1][1]||0,p=(f-h)/2,x=0;x<o;++x){var g=e[t[x]],y=g[n][1]||0,v=g[n-1][1]||0;p+=y-v}c+=f,u+=p*f}a[n-1][1]+=a[n-1][0]=r,c&&(r-=u/c)}a[n-1][1]+=a[n-1][0]=r,Uc(e,t)}}var wp={},A3={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(A3);var Sb={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(Sb);var Np={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var n;return typeof r=="string"||typeof r=="symbol"?r:Object.is((n=r==null?void 0:r.valueOf)==null?void 0:n.call(r),-0)?"-0":String(r)}e.toKey=t})(Np);var Sp={},T3={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}e.toString=t})(T3);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=T3,r=Np;function n(a){if(Array.isArray(a))return a.map(r.toKey);if(typeof a=="symbol")return[a];a=t.toString(a);const i=[],s=a.length;if(s===0)return i;let o=0,c="",u="",d=!1;for(a.charCodeAt(0)===46&&(i.push(""),o++);o<s;){const f=a[o];u?f==="\\"&&o+1<s?(o++,c+=a[o]):f===u?u="":c+=f:d?f==='"'||f==="'"?u=f:f==="]"?(d=!1,i.push(c),c=""):c+=f:f==="["?(d=!0,c&&(i.push(c),c="")):f==="."?c&&(i.push(c),c=""):c+=f,o++}return c&&i.push(c),i}e.toPath=n})(Sp);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=A3,r=Sb,n=Np,a=Sp;function i(o,c,u){if(o==null)return u;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return u;const d=o[c];return d===void 0?r.isDeepKey(c)?i(o,a.toPath(c),u):u:d}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const d=o[c];return d===void 0?u:d}default:{if(Array.isArray(c))return s(o,c,u);if(Object.is(c==null?void 0:c.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return u;const d=o[c];return d===void 0?u:d}}}function s(o,c,u){if(c.length===0)return u;let d=o;for(let f=0;f<c.length;f++){if(d==null||t.isUnsafeProperty(c[f]))return u;d=d[c[f]]}return d===void 0?u:d}e.get=i})(wp);var L7=wp.get;const xl=Es(L7);var tn=e=>e===0?0:e>0?1:-1,ci=e=>typeof e=="number"&&e!=+e,ws=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,Je=e=>(typeof e=="number"||e instanceof Number)&&!ci(e),Xi=e=>Je(e)||typeof e=="string",B7=0,Wd=e=>{var t=++B7;return"".concat(e||"").concat(t)},Pn=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Je(t)&&typeof t!="string")return n;var i;if(ws(t)){if(r==null)return n;var s=t.indexOf("%");i=r*parseFloat(t.slice(0,s))/100}else i=+t;return ci(i)&&(i=n),a&&r!=null&&i>r&&(i=r),i},P3=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[e[n]])r[e[n]]=!0;else return!0;return!1};function br(e,t,r){return Je(e)&&Je(t)?e+r*(t-e):t}function O3(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):xl(n,t))===r)}var or=e=>e===null||typeof e>"u",_f=e=>or(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),j7=["type","size","sizeType"];function iy(){return iy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},iy.apply(null,arguments)}function mk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function hk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mk(Object(r),!0).forEach(function(n){$7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $7(e,t,r){return(t=U7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U7(e){var t=z7(e,"string");return typeof t=="symbol"?t:t+""}function z7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function H7(e,t){if(e==null)return{};var r,n,a=W7(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function W7(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var D3={symbolCircle:Nb,symbolCross:c7,symbolDiamond:d7,symbolSquare:f7,symbolStar:g7,symbolTriangle:x7,symbolWye:y7},G7=Math.PI/180,V7=e=>{var t="symbol".concat(_f(e));return D3[t]||Nb},K7=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*G7;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},X7=(e,t)=>{D3["symbol".concat(_f(e))]=t},kb=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,a=H7(e,j7),i=hk(hk({},a),{},{type:t,size:r,sizeType:n}),s="circle";typeof t=="string"&&(s=t);var o=()=>{var h=V7(s),p=b7().type(h).size(K7(r,n,s)),x=p();if(x!==null)return x},{className:c,cx:u,cy:d}=i,f=Kn(i);return u===+u&&d===+d&&r===+r?N.createElement("path",iy({},f,{className:It("recharts-symbols",c),transform:"translate(".concat(u,", ").concat(d,")"),d:o()})):null};kb.registerSymbol=X7;var _b=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(N.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{vb(a)&&(n[a]=t||(i=>r[a](r,i)))}),n},q7=(e,t,r)=>n=>(e(t,r,n),null),Ef=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(a=>{var i=e[a];vb(a)&&typeof i=="function"&&(n||(n={}),n[a]=q7(i,t,r))}),n};function sy(){return sy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sy.apply(null,arguments)}function pk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Y7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pk(Object(r),!0).forEach(function(n){Eb(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Eb(e,t,r){return(t=J7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J7(e){var t=Q7(e,"string");return typeof t=="symbol"?t:t+""}function Q7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var za=32;class Cb extends N.PureComponent{renderIcon(t,r){var{inactiveColor:n}=this.props,a=za/2,i=za/6,s=za/3,o=t.inactive?n:t.color,c=r??t.type;if(c==="none")return null;if(c==="plainline")return N.createElement("line",{strokeWidth:4,fill:"none",stroke:o,strokeDasharray:t.payload.strokeDasharray,x1:0,y1:a,x2:za,y2:a,className:"recharts-legend-icon"});if(c==="line")return N.createElement("path",{strokeWidth:4,fill:"none",stroke:o,d:"M0,".concat(a,"h").concat(s,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(2*s,",").concat(a,`
            H`).concat(za,"M").concat(2*s,",").concat(a,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(s,",").concat(a),className:"recharts-legend-icon"});if(c==="rect")return N.createElement("path",{stroke:"none",fill:o,d:"M0,".concat(za/8,"h").concat(za,"v").concat(za*3/4,"h").concat(-za,"z"),className:"recharts-legend-icon"});if(N.isValidElement(t.legendIcon)){var u=Y7({},t);return delete u.legendIcon,N.cloneElement(t.legendIcon,u)}return N.createElement(kb,{fill:o,cx:a,cy:a,size:za,sizeType:"diameter",type:c})}renderItems(){var{payload:t,iconSize:r,layout:n,formatter:a,inactiveColor:i,iconType:s}=this.props,o={x:0,y:0,width:za,height:za},c={display:n==="horizontal"?"inline-block":"block",marginRight:10},u={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((d,f)=>{var h=d.formatter||a,p=It({"recharts-legend-item":!0,["legend-item-".concat(f)]:!0,inactive:d.inactive});if(d.type==="none")return null;var x=d.inactive?i:d.color,g=h?h(d.value,d,f):d.value;return N.createElement("li",sy({className:p,style:c,key:"legend-item-".concat(f)},Ef(this.props,d,f)),N.createElement(yb,{width:r,height:r,viewBox:o,style:u,"aria-label":"".concat(g," legend icon")},this.renderIcon(d,s)),N.createElement("span",{className:"recharts-legend-item-text",style:{color:x}},g))})}render(){var{payload:t,layout:r,align:n}=this.props;if(!t||!t.length)return null;var a={padding:0,margin:0,textAlign:r==="horizontal"?n:"left"};return N.createElement("ul",{className:"recharts-default-legend",style:a},this.renderItems())}}Eb(Cb,"displayName","Legend");Eb(Cb,"defaultProps",{align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"});var R3={},M3={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const a=new Map;for(let i=0;i<r.length;i++){const s=r[i],o=n(s);a.has(o)||a.set(o,s)}return Array.from(a.values())}e.uniqBy=t})(M3);var Ab={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(Ab);var I3={},kp={},F3={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(F3);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=F3;function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(kp);var L3={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(L3);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=kp,r=L3;function n(a){return r.isObjectLike(a)&&t.isArrayLike(a)}e.isArrayLikeObject=n})(I3);var B3={},j3={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=wp;function r(n){return function(a){return t.get(a,n)}}e.property=r})(j3);var $3={},dx={},fx={},Tb={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(Tb);var Pb={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(Pb);var Ob={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.eq=t})(Ob);var gk;function Z7(){return gk||(gk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Db(),r=Tb,n=Pb,a=Ob;function i(f,h,p){return typeof p!="function"?t.isMatch(f,h):s(f,h,function x(g,y,v,w,b,S){const k=p(g,y,v,w,b,S);return k!==void 0?!!k:s(g,y,x,S)},new Map)}function s(f,h,p,x){if(h===f)return!0;switch(typeof h){case"object":return o(f,h,p,x);case"function":return Object.keys(h).length>0?s(f,{...h},p,x):a.eq(f,h);default:return r.isObject(f)?typeof h=="string"?h==="":!0:a.eq(f,h)}}function o(f,h,p,x){if(h==null)return!0;if(Array.isArray(h))return u(f,h,p,x);if(h instanceof Map)return c(f,h,p,x);if(h instanceof Set)return d(f,h,p,x);const g=Object.keys(h);if(f==null)return g.length===0;if(g.length===0)return!0;if(x&&x.has(h))return x.get(h)===f;x&&x.set(h,f);try{for(let y=0;y<g.length;y++){const v=g[y];if(!n.isPrimitive(f)&&!(v in f)||h[v]===void 0&&f[v]!==void 0||h[v]===null&&f[v]!==null||!p(f[v],h[v],v,f,h,x))return!1}return!0}finally{x&&x.delete(h)}}function c(f,h,p,x){if(h.size===0)return!0;if(!(f instanceof Map))return!1;for(const[g,y]of h.entries()){const v=f.get(g);if(p(v,y,g,f,h,x)===!1)return!1}return!0}function u(f,h,p,x){if(h.length===0)return!0;if(!Array.isArray(f))return!1;const g=new Set;for(let y=0;y<h.length;y++){const v=h[y];let w=!1;for(let b=0;b<f.length;b++){if(g.has(b))continue;const S=f[b];let k=!1;if(p(S,v,y,f,h,x)&&(k=!0),k){g.add(b),w=!0;break}}if(!w)return!1}return!0}function d(f,h,p,x){return h.size===0?!0:f instanceof Set?u([...f],[...h],p,x):!1}e.isMatchWith=i,e.isSetMatch=d}(fx)),fx}var xk;function Db(){return xk||(xk=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Z7();function r(n,a){return t.isMatchWith(n,a,()=>{})}e.isMatch=r}(dx)),dx}var U3={},Rb={},z3={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(z3);var Mb={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(Mb);var Ib={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",i="[object Arguments]",s="[object Symbol]",o="[object Date]",c="[object Map]",u="[object Set]",d="[object Array]",f="[object Function]",h="[object ArrayBuffer]",p="[object Object]",x="[object Error]",g="[object DataView]",y="[object Uint8Array]",v="[object Uint8ClampedArray]",w="[object Uint16Array]",b="[object Uint32Array]",S="[object BigUint64Array]",k="[object Int8Array]",_="[object Int16Array]",E="[object Int32Array]",P="[object BigInt64Array]",A="[object Float32Array]",T="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=h,e.arrayTag=d,e.bigInt64ArrayTag=P,e.bigUint64ArrayTag=S,e.booleanTag=a,e.dataViewTag=g,e.dateTag=o,e.errorTag=x,e.float32ArrayTag=A,e.float64ArrayTag=T,e.functionTag=f,e.int16ArrayTag=_,e.int32ArrayTag=E,e.int8ArrayTag=k,e.mapTag=c,e.numberTag=n,e.objectTag=p,e.regexpTag=t,e.setTag=u,e.stringTag=r,e.symbolTag=s,e.uint16ArrayTag=w,e.uint32ArrayTag=b,e.uint8ArrayTag=y,e.uint8ClampedArrayTag=v})(Ib);var H3={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(H3);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=z3,r=Mb,n=Ib,a=Pb,i=H3;function s(d,f){return o(d,void 0,d,new Map,f)}function o(d,f,h,p=new Map,x=void 0){const g=x==null?void 0:x(d,f,h,p);if(g!==void 0)return g;if(a.isPrimitive(d))return d;if(p.has(d))return p.get(d);if(Array.isArray(d)){const y=new Array(d.length);p.set(d,y);for(let v=0;v<d.length;v++)y[v]=o(d[v],v,h,p,x);return Object.hasOwn(d,"index")&&(y.index=d.index),Object.hasOwn(d,"input")&&(y.input=d.input),y}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const y=new RegExp(d.source,d.flags);return y.lastIndex=d.lastIndex,y}if(d instanceof Map){const y=new Map;p.set(d,y);for(const[v,w]of d)y.set(v,o(w,v,h,p,x));return y}if(d instanceof Set){const y=new Set;p.set(d,y);for(const v of d)y.add(o(v,void 0,h,p,x));return y}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(i.isTypedArray(d)){const y=new(Object.getPrototypeOf(d)).constructor(d.length);p.set(d,y);for(let v=0;v<d.length;v++)y[v]=o(d[v],v,h,p,x);return y}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const y=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return p.set(d,y),c(y,d,h,p,x),y}if(typeof File<"u"&&d instanceof File){const y=new File([d],d.name,{type:d.type});return p.set(d,y),c(y,d,h,p,x),y}if(typeof Blob<"u"&&d instanceof Blob){const y=new Blob([d],{type:d.type});return p.set(d,y),c(y,d,h,p,x),y}if(d instanceof Error){const y=new d.constructor;return p.set(d,y),y.message=d.message,y.name=d.name,y.stack=d.stack,y.cause=d.cause,c(y,d,h,p,x),y}if(d instanceof Boolean){const y=new Boolean(d.valueOf());return p.set(d,y),c(y,d,h,p,x),y}if(d instanceof Number){const y=new Number(d.valueOf());return p.set(d,y),c(y,d,h,p,x),y}if(d instanceof String){const y=new String(d.valueOf());return p.set(d,y),c(y,d,h,p,x),y}if(typeof d=="object"&&u(d)){const y=Object.create(Object.getPrototypeOf(d));return p.set(d,y),c(y,d,h,p,x),y}return d}function c(d,f,h=d,p,x){const g=[...Object.keys(f),...t.getSymbols(f)];for(let y=0;y<g.length;y++){const v=g[y],w=Object.getOwnPropertyDescriptor(d,v);(w==null||w.writable)&&(d[v]=o(f[v],v,h,p,x))}}function u(d){switch(r.getTag(d)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=s,e.cloneDeepWithImpl=o,e.copyProperties=c})(Rb);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Rb;function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(U3);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Db(),r=U3;function n(a){return a=r.cloneDeep(a),i=>t.isMatch(i,a)}e.matches=n})($3);var W3={},G3={},V3={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Rb,r=Ib;function n(a,i){return t.cloneDeepWith(a,(s,o,c,u)=>{const d=i==null?void 0:i(s,o,c,u);if(d!==void 0)return d;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case r.numberTag:case r.stringTag:case r.booleanTag:{const f=new a.constructor(a==null?void 0:a.valueOf());return t.copyProperties(f,a),f}case r.argumentsTag:{const f={};return t.copyProperties(f,a),f.length=a.length,f[Symbol.iterator]=a[Symbol.iterator],f}default:return}})}e.cloneDeepWith=n})(V3);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=V3;function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(G3);var K3={},Fb={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(Fb);var X3={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Mb;function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(X3);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Sb,r=Fb,n=X3,a=Sp;function i(s,o){let c;if(Array.isArray(o)?c=o:typeof o=="string"&&t.isDeepKey(o)&&(s==null?void 0:s[o])==null?c=a.toPath(o):c=[o],c.length===0)return!1;let u=s;for(let d=0;d<c.length;d++){const f=c[d];if((u==null||!Object.hasOwn(u,f))&&!((Array.isArray(u)||n.isArguments(u))&&r.isIndex(f)&&f<u.length))return!1;u=u[f]}return!0}e.has=i})(K3);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Db(),r=Np,n=G3,a=wp,i=K3;function s(o,c){switch(typeof o){case"object":{Object.is(o==null?void 0:o.valueOf(),-0)&&(o="-0");break}case"number":{o=r.toKey(o);break}}return c=n.cloneDeep(c),function(u){const d=a.get(u,o);return d===void 0?i.has(u,o):c===void 0?d===void 0:t.isMatch(d,c)}}e.matchesProperty=s})(W3);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ab,r=j3,n=$3,a=W3;function i(s){if(s==null)return t.identity;switch(typeof s){case"function":return s;case"object":return Array.isArray(s)&&s.length===2?a.matchesProperty(s[0],s[1]):n.matches(s);case"string":case"symbol":case"number":return r.property(s)}}e.iteratee=i})(B3);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=M3,r=Ab,n=I3,a=B3;function i(s,o=r.identity){return n.isArrayLikeObject(s)?t.uniqBy(Array.from(s),a.iteratee(o)):[]}e.uniqBy=i})(R3);var ej=R3.uniqBy;const vk=Es(ej);function q3(e,t,r){return t===!0?vk(e,r):typeof t=="function"?vk(e,t):e}var Y3={exports:{}},J3={},Q3={exports:{}},Z3={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zc=N;function tj(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var rj=typeof Object.is=="function"?Object.is:tj,nj=zc.useState,aj=zc.useEffect,ij=zc.useLayoutEffect,sj=zc.useDebugValue;function oj(e,t){var r=t(),n=nj({inst:{value:r,getSnapshot:t}}),a=n[0].inst,i=n[1];return ij(function(){a.value=r,a.getSnapshot=t,mx(a)&&i({inst:a})},[e,r,t]),aj(function(){return mx(a)&&i({inst:a}),e(function(){mx(a)&&i({inst:a})})},[e]),sj(r),r}function mx(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!rj(e,r)}catch{return!0}}function lj(e,t){return t()}var cj=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?lj:oj;Z3.useSyncExternalStore=zc.useSyncExternalStore!==void 0?zc.useSyncExternalStore:cj;Q3.exports=Z3;var uj=Q3.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _p=N,dj=uj;function fj(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var mj=typeof Object.is=="function"?Object.is:fj,hj=dj.useSyncExternalStore,pj=_p.useRef,gj=_p.useEffect,xj=_p.useMemo,vj=_p.useDebugValue;J3.useSyncExternalStoreWithSelector=function(e,t,r,n,a){var i=pj(null);if(i.current===null){var s={hasValue:!1,value:null};i.current=s}else s=i.current;i=xj(function(){function c(p){if(!u){if(u=!0,d=p,p=n(p),a!==void 0&&s.hasValue){var x=s.value;if(a(x,p))return f=x}return f=p}if(x=f,mj(d,p))return x;var g=n(p);return a!==void 0&&a(x,g)?(d=p,x):(d=p,f=g)}var u=!1,d,f,h=r===void 0?null:r;return[function(){return c(t())},h===null?void 0:function(){return c(h())}]},[t,r,n,a]);var o=hj(e,i[0],i[1]);return gj(function(){s.hasValue=!0,s.value=o},[o]),vj(o),o};Y3.exports=J3;var yj=Y3.exports,Lb=N.createContext(null),bj=e=>e,lr=()=>{var e=N.useContext(Lb);return e?e.store.dispatch:bj},fm=()=>{},wj=()=>fm,Nj=(e,t)=>e===t;function Ve(e){var t=N.useContext(Lb);return yj.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:wj,t?t.store.getState:fm,t?t.store.getState:fm,t?e:fm,Nj)}function Sj(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function kj(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function _j(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var yk=e=>Array.isArray(e)?e:[e];function Ej(e){const t=Array.isArray(e[0])?e[0]:e;return _j(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function Cj(e,t){const r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var Aj=class{constructor(e){this.value=e}deref(){return this.value}},Tj=typeof WeakRef<"u"?WeakRef:Aj,Pj=0,bk=1;function N0(){return{s:Pj,v:void 0,o:null,p:null}}function e6(e,t={}){let r=N0();const{resultEqualityCheck:n}=t;let a,i=0;function s(){var f;let o=r;const{length:c}=arguments;for(let h=0,p=c;h<p;h++){const x=arguments[h];if(typeof x=="function"||typeof x=="object"&&x!==null){let g=o.o;g===null&&(o.o=g=new WeakMap);const y=g.get(x);y===void 0?(o=N0(),g.set(x,o)):o=y}else{let g=o.p;g===null&&(o.p=g=new Map);const y=g.get(x);y===void 0?(o=N0(),g.set(x,o)):o=y}}const u=o;let d;if(o.s===bk)d=o.v;else if(d=e.apply(null,arguments),i++,n){const h=((f=a==null?void 0:a.deref)==null?void 0:f.call(a))??a;h!=null&&n(h,d)&&(d=h,i!==0&&i--),a=typeof d=="object"&&d!==null||typeof d=="function"?new Tj(d):d}return u.s=bk,u.v=d,d}return s.clearCache=()=>{r=N0(),s.resetResultsCount()},s.resultsCount=()=>i,s.resetResultsCount=()=>{i=0},s}function Oj(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let i=0,s=0,o,c={},u=a.pop();typeof u=="object"&&(c=u,u=a.pop()),Sj(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...r,...c},{memoize:f,memoizeOptions:h=[],argsMemoize:p=e6,argsMemoizeOptions:x=[],devModeChecks:g={}}=d,y=yk(h),v=yk(x),w=Ej(a),b=f(function(){return i++,u.apply(null,arguments)},...y),S=p(function(){s++;const _=Cj(w,arguments);return o=b.apply(null,_),o},...v);return Object.assign(S,{resultFunc:u,memoizedResultFunc:b,dependencies:w,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>o,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:f,argsMemoize:p})};return Object.assign(n,{withTypes:()=>n}),n}var me=Oj(e6),Dj=Object.assign((e,t=me)=>{kj(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(i=>e[i]);return t(n,(...i)=>i.reduce((s,o,c)=>(s[r[c]]=o,s),{}))},{withTypes:()=>Dj}),t6={},r6={},n6={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,i)=>{if(n!==a){const s=t(n),o=t(a);if(s===o&&s===0){if(n<a)return i==="desc"?1:-1;if(n>a)return i==="desc"?-1:1}return i==="desc"?o-s:s-o}return 0};e.compareValues=r})(n6);var a6={},Bb={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(Bb);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Bb,r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,s){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(n.test(i)||!r.test(i))||s!=null&&Object.hasOwn(s,i)}e.isKey=a})(a6);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=n6,r=a6,n=Sp;function a(i,s,o,c){if(i==null)return[];o=c?void 0:o,Array.isArray(i)||(i=Object.values(i)),Array.isArray(s)||(s=s==null?[null]:[s]),s.length===0&&(s=[null]),Array.isArray(o)||(o=o==null?[]:[o]),o=o.map(p=>String(p));const u=(p,x)=>{let g=p;for(let y=0;y<x.length&&g!=null;++y)g=g[x[y]];return g},d=(p,x)=>x==null||p==null?x:typeof p=="object"&&"key"in p?Object.hasOwn(x,p.key)?x[p.key]:u(x,p.path):typeof p=="function"?p(x):Array.isArray(p)?u(x,p):typeof x=="object"?x[p]:x,f=s.map(p=>(Array.isArray(p)&&p.length===1&&(p=p[0]),p==null||typeof p=="function"||Array.isArray(p)||r.isKey(p)?p:{key:p,path:n.toPath(p)}));return i.map(p=>({original:p,criteria:f.map(x=>d(x,p))})).slice().sort((p,x)=>{for(let g=0;g<f.length;g++){const y=t.compareValues(p.criteria[g],x.criteria[g],o[g]);if(y!==0)return y}return 0}).map(p=>p.original)}e.orderBy=a})(r6);var i6={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const a=[],i=Math.floor(n),s=(o,c)=>{for(let u=0;u<o.length;u++){const d=o[u];Array.isArray(d)&&c<i?s(d,c+1):a.push(d)}};return s(r,0),a}e.flatten=t})(i6);var jb={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Fb,r=kp,n=Tb,a=Ob;function i(s,o,c){return n.isObject(c)&&(typeof o=="number"&&r.isArrayLike(c)&&t.isIndex(o)&&o<c.length||typeof o=="string"&&o in c)?a.eq(c[o],s):!1}e.isIterateeCall=i})(jb);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=r6,r=i6,n=jb;function a(i,...s){const o=s.length;return o>1&&n.isIterateeCall(i,s[0],s[1])?s=[]:o>2&&n.isIterateeCall(s[0],s[1],s[2])&&(s=[s[0]]),t.orderBy(i,r.flatten(s),["asc"])}e.sortBy=a})(t6);var Rj=t6.sortBy;const Ep=Es(Rj);var s6=e=>e.legend.settings,Mj=e=>e.legend.size,Ij=e=>e.legend.payload,Fj=me([Ij,s6],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?Ep(n,r):n});function Lj(){return Ve(Fj)}var S0=1;function o6(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=N.useState({height:0,left:0,top:0,width:0}),n=N.useCallback(a=>{if(a!=null){var i=a.getBoundingClientRect(),s={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(s.height-t.height)>S0||Math.abs(s.left-t.left)>S0||Math.abs(s.top-t.top)>S0||Math.abs(s.width-t.width)>S0)&&r({height:s.height,left:s.left,top:s.top,width:s.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function ln(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Bj=(()=>typeof Symbol=="function"&&Symbol.observable||"@@observable")(),wk=Bj,hx=()=>Math.random().toString(36).substring(7).split("").join("."),jj={INIT:`@@redux/INIT${hx()}`,REPLACE:`@@redux/REPLACE${hx()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${hx()}`},Qm=jj;function $b(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function l6(e,t,r){if(typeof e!="function")throw new Error(ln(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(ln(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(ln(1));return r(l6)(e,t)}let n=e,a=t,i=new Map,s=i,o=0,c=!1;function u(){s===i&&(s=new Map,i.forEach((y,v)=>{s.set(v,y)}))}function d(){if(c)throw new Error(ln(3));return a}function f(y){if(typeof y!="function")throw new Error(ln(4));if(c)throw new Error(ln(5));let v=!0;u();const w=o++;return s.set(w,y),function(){if(v){if(c)throw new Error(ln(6));v=!1,u(),s.delete(w),i=null}}}function h(y){if(!$b(y))throw new Error(ln(7));if(typeof y.type>"u")throw new Error(ln(8));if(typeof y.type!="string")throw new Error(ln(17));if(c)throw new Error(ln(9));try{c=!0,a=n(a,y)}finally{c=!1}return(i=s).forEach(w=>{w()}),y}function p(y){if(typeof y!="function")throw new Error(ln(10));n=y,h({type:Qm.REPLACE})}function x(){const y=f;return{subscribe(v){if(typeof v!="object"||v===null)throw new Error(ln(11));function w(){const S=v;S.next&&S.next(d())}return w(),{unsubscribe:y(w)}},[wk](){return this}}}return h({type:Qm.INIT}),{dispatch:h,subscribe:f,getState:d,replaceReducer:p,[wk]:x}}function $j(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:Qm.INIT})>"u")throw new Error(ln(12));if(typeof r(void 0,{type:Qm.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(ln(13))})}function c6(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const s=t[i];typeof e[s]=="function"&&(r[s]=e[s])}const n=Object.keys(r);let a;try{$j(r)}catch(i){a=i}return function(s={},o){if(a)throw a;let c=!1;const u={};for(let d=0;d<n.length;d++){const f=n[d],h=r[f],p=s[f],x=h(p,o);if(typeof x>"u")throw o&&o.type,new Error(ln(14));u[f]=x,c=c||x!==p}return c=c||n.length!==Object.keys(s).length,c?u:s}}function Zm(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function Uj(...e){return t=>(r,n)=>{const a=t(r,n);let i=()=>{throw new Error(ln(15))};const s={getState:a.getState,dispatch:(c,...u)=>i(c,...u)},o=e.map(c=>c(s));return i=Zm(...o)(a.dispatch),{...a,dispatch:i}}}function u6(e){return $b(e)&&"type"in e&&typeof e.type=="string"}var d6=Symbol.for("immer-nothing"),Nk=Symbol.for("immer-draftable"),Ma=Symbol.for("immer-state");function bi(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Hc=Object.getPrototypeOf;function vl(e){return!!e&&!!e[Ma]}function Ns(e){var t;return e?f6(e)||Array.isArray(e)||!!e[Nk]||!!((t=e.constructor)!=null&&t[Nk])||Cf(e)||Ap(e):!1}var zj=Object.prototype.constructor.toString();function f6(e){if(!e||typeof e!="object")return!1;const t=Hc(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===zj}function eh(e,t){Cp(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function Cp(e){const t=e[Ma];return t?t.type_:Array.isArray(e)?1:Cf(e)?2:Ap(e)?3:0}function oy(e,t){return Cp(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function m6(e,t,r){const n=Cp(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function Hj(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Cf(e){return e instanceof Map}function Ap(e){return e instanceof Set}function Uo(e){return e.copy_||e.base_}function ly(e,t){if(Cf(e))return new Map(e);if(Ap(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=f6(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[Ma];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const s=a[i],o=n[s];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[s]})}return Object.create(Hc(e),n)}else{const n=Hc(e);if(n!==null&&r)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function Ub(e,t=!1){return Tp(e)||vl(e)||!Ns(e)||(Cp(e)>1&&Object.defineProperties(e,{set:{value:k0},add:{value:k0},clear:{value:k0},delete:{value:k0}}),Object.freeze(e),t&&Object.values(e).forEach(r=>Ub(r,!0))),e}function k0(){bi(2)}function Tp(e){return Object.isFrozen(e)}var Wj={};function yl(e){const t=Wj[e];return t||bi(0,e),t}var Gd;function h6(){return Gd}function Gj(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Sk(e,t){t&&(yl("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function cy(e){uy(e),e.drafts_.forEach(Vj),e.drafts_=null}function uy(e){e===Gd&&(Gd=e.parent_)}function kk(e){return Gd=Gj(Gd,e)}function Vj(e){const t=e[Ma];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function _k(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[Ma].modified_&&(cy(t),bi(4)),Ns(e)&&(e=th(t,e),t.parent_||rh(t,e)),t.patches_&&yl("Patches").generateReplacementPatches_(r[Ma].base_,e,t.patches_,t.inversePatches_)):e=th(t,r,[]),cy(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==d6?e:void 0}function th(e,t,r){if(Tp(t))return t;const n=t[Ma];if(!n)return eh(t,(a,i)=>Ek(e,n,t,a,i,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return rh(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const a=n.copy_;let i=a,s=!1;n.type_===3&&(i=new Set(a),a.clear(),s=!0),eh(i,(o,c)=>Ek(e,n,a,o,c,r,s)),rh(e,a,!1),r&&e.patches_&&yl("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function Ek(e,t,r,n,a,i,s){if(vl(a)){const o=i&&t&&t.type_!==3&&!oy(t.assigned_,n)?i.concat(n):void 0,c=th(e,a,o);if(m6(r,n,c),vl(c))e.canAutoFreeze_=!1;else return}else s&&r.add(a);if(Ns(a)&&!Tp(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;th(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(Cf(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&rh(e,a)}}function rh(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Ub(t,r)}function Kj(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:h6(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,i=zb;r&&(a=[n],i=Vd);const{revoke:s,proxy:o}=Proxy.revocable(a,i);return n.draft_=o,n.revoke_=s,o}var zb={get(e,t){if(t===Ma)return e;const r=Uo(e);if(!oy(r,t))return Xj(e,r,t);const n=r[t];return e.finalized_||!Ns(n)?n:n===px(e.base_,t)?(gx(e),e.copy_[t]=fy(n,e)):n},has(e,t){return t in Uo(e)},ownKeys(e){return Reflect.ownKeys(Uo(e))},set(e,t,r){const n=p6(Uo(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=px(Uo(e),t),i=a==null?void 0:a[Ma];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(Hj(r,a)&&(r!==void 0||oy(e.base_,t)))return!0;gx(e),dy(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return px(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,gx(e),dy(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Uo(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){bi(11)},getPrototypeOf(e){return Hc(e.base_)},setPrototypeOf(){bi(12)}},Vd={};eh(zb,(e,t)=>{Vd[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Vd.deleteProperty=function(e,t){return Vd.set.call(this,e,t,void 0)};Vd.set=function(e,t,r){return zb.set.call(this,e[0],t,r,e[0])};function px(e,t){const r=e[Ma];return(r?Uo(r):e)[t]}function Xj(e,t,r){var a;const n=p6(t,r);return n?"value"in n?n.value:(a=n.get)==null?void 0:a.call(e.draft_):void 0}function p6(e,t){if(!(t in e))return;let r=Hc(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Hc(r)}}function dy(e){e.modified_||(e.modified_=!0,e.parent_&&dy(e.parent_))}function gx(e){e.copy_||(e.copy_=ly(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var qj=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const s=this;return function(c=i,...u){return s.produce(c,d=>r.call(this,d,...u))}}typeof r!="function"&&bi(6),n!==void 0&&typeof n!="function"&&bi(7);let a;if(Ns(t)){const i=kk(this),s=fy(t,void 0);let o=!0;try{a=r(s),o=!1}finally{o?cy(i):uy(i)}return Sk(i,n),_k(a,i)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===d6&&(a=void 0),this.autoFreeze_&&Ub(a,!0),n){const i=[],s=[];yl("Patches").generateReplacementPatches_(t,a,i,s),n(i,s)}return a}else bi(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(s,...o)=>this.produceWithPatches(s,c=>t(c,...o));let n,a;return[this.produce(t,r,(s,o)=>{n=s,a=o}),n,a]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Ns(e)||bi(8),vl(e)&&(e=ms(e));const t=kk(this),r=fy(e,void 0);return r[Ma].isManual_=!0,uy(t),r}finishDraft(e,t){const r=e&&e[Ma];(!r||!r.isManual_)&&bi(9);const{scope_:n}=r;return Sk(n,t),_k(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const n=yl("Patches").applyPatches_;return vl(e)?n(e,t):this.produce(e,a=>n(a,t))}};function fy(e,t){const r=Cf(e)?yl("MapSet").proxyMap_(e,t):Ap(e)?yl("MapSet").proxySet_(e,t):Kj(e,t);return(t?t.scope_:h6()).drafts_.push(r),r}function ms(e){return vl(e)||bi(10,e),g6(e)}function g6(e){if(!Ns(e)||Tp(e))return e;const t=e[Ma];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=ly(e,t.scope_.immer_.useStrictShallowCopy_)}else r=ly(e,!0);return eh(r,(n,a)=>{m6(r,n,g6(a))}),t&&(t.finalized_=!1),r}var Yj=new qj,x6=Yj.produce;function v6(e){return({dispatch:r,getState:n})=>a=>i=>typeof i=="function"?i(r,n,e):a(i)}var Jj=v6(),Qj=v6,Zj=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Zm:Zm.apply(null,arguments)};function ui(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(Pa(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>u6(n)&&n.type===e,r}var y6=class Zu extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Zu.prototype)}static get[Symbol.species](){return Zu}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Zu(...t[0].concat(this)):new Zu(...t.concat(this))}};function Ck(e){return Ns(e)?x6(e,()=>{}):e}function _0(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function e9(e){return typeof e=="boolean"}var t9=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:i=!0}=t??{};let s=new y6;return r&&(e9(r)?s.push(Jj):s.push(Qj(r.extraArgument))),s},b6="RTK_autoBatch",Un=()=>e=>({payload:e,meta:{[b6]:!0}}),Ak=e=>t=>{setTimeout(t,e)},w6=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let a=!0,i=!1,s=!1;const o=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Ak(10):e.type==="callback"?e.queueNotification:Ak(e.timeout),u=()=>{s=!1,i&&(i=!1,o.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const f=()=>a&&d(),h=n.subscribe(f);return o.add(d),()=>{h(),o.delete(d)}},dispatch(d){var f;try{return a=!((f=d==null?void 0:d.meta)!=null&&f[b6]),i=!a,i&&(s||(s=!0,c(u))),n.dispatch(d)}finally{a=!0}}})},r9=e=>function(r){const{autoBatch:n=!0}=r??{};let a=new y6(e);return n&&a.push(w6(typeof n=="object"?n:void 0)),a};function n9(e){const t=t9(),{reducer:r=void 0,middleware:n,devTools:a=!0,duplicateMiddlewareCheck:i=!0,preloadedState:s=void 0,enhancers:o=void 0}=e||{};let c;if(typeof r=="function")c=r;else if($b(r))c=c6(r);else throw new Error(Pa(1));let u;typeof n=="function"?u=n(t):u=t();let d=Zm;a&&(d=Zj({trace:!1,...typeof a=="object"&&a}));const f=Uj(...u),h=r9(f);let p=typeof o=="function"?o(h):h();const x=d(...p);return l6(c,s,x)}function N6(e){const t={},r=[];let n;const a={addCase(i,s){const o=typeof i=="string"?i:i.type;if(!o)throw new Error(Pa(28));if(o in t)throw new Error(Pa(29));return t[o]=s,a},addAsyncThunk(i,s){return s.pending&&(t[i.pending.type]=s.pending),s.rejected&&(t[i.rejected.type]=s.rejected),s.fulfilled&&(t[i.fulfilled.type]=s.fulfilled),s.settled&&r.push({matcher:i.settled,reducer:s.settled}),a},addMatcher(i,s){return r.push({matcher:i,reducer:s}),a},addDefaultCase(i){return n=i,a}};return e(a),[t,r,n]}function a9(e){return typeof e=="function"}function i9(e,t){let[r,n,a]=N6(t),i;if(a9(e))i=()=>Ck(e());else{const o=Ck(e);i=()=>o}function s(o=i(),c){let u=[r[c.type],...n.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[a]),u.reduce((d,f)=>{if(f)if(vl(d)){const p=f(d,c);return p===void 0?d:p}else{if(Ns(d))return x6(d,h=>f(h,c));{const h=f(d,c);if(h===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return h}}return d},o)}return s.getInitialState=i,s}var s9="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",o9=(e=21)=>{let t="",r=e;for(;r--;)t+=s9[Math.random()*64|0];return t},l9=Symbol.for("rtk-slice-createasyncthunk");function c9(e,t){return`${e}/${t}`}function u9({creators:e}={}){var r;const t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[l9];return function(a){const{name:i,reducerPath:s=i}=a;if(!i)throw new Error(Pa(11));typeof process<"u";const o=(typeof a.reducers=="function"?a.reducers(f9()):a.reducers)||{},c=Object.keys(o),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(S,k){const _=typeof S=="string"?S:S.type;if(!_)throw new Error(Pa(12));if(_ in u.sliceCaseReducersByType)throw new Error(Pa(13));return u.sliceCaseReducersByType[_]=k,d},addMatcher(S,k){return u.sliceMatchers.push({matcher:S,reducer:k}),d},exposeAction(S,k){return u.actionCreators[S]=k,d},exposeCaseReducer(S,k){return u.sliceCaseReducersByName[S]=k,d}};c.forEach(S=>{const k=o[S],_={reducerName:S,type:c9(i,S),createNotation:typeof a.reducers=="function"};h9(k)?g9(_,k,d,t):m9(_,k,d)});function f(){const[S={},k=[],_=void 0]=typeof a.extraReducers=="function"?N6(a.extraReducers):[a.extraReducers],E={...S,...u.sliceCaseReducersByType};return i9(a.initialState,P=>{for(let A in E)P.addCase(A,E[A]);for(let A of u.sliceMatchers)P.addMatcher(A.matcher,A.reducer);for(let A of k)P.addMatcher(A.matcher,A.reducer);_&&P.addDefaultCase(_)})}const h=S=>S,p=new Map,x=new WeakMap;let g;function y(S,k){return g||(g=f()),g(S,k)}function v(){return g||(g=f()),g.getInitialState()}function w(S,k=!1){function _(P){let A=P[S];return typeof A>"u"&&k&&(A=_0(x,_,v)),A}function E(P=h){const A=_0(p,k,()=>new WeakMap);return _0(A,P,()=>{const T={};for(const[R,D]of Object.entries(a.selectors??{}))T[R]=d9(D,P,()=>_0(x,P,v),k);return T})}return{reducerPath:S,getSelectors:E,get selectors(){return E(_)},selectSlice:_}}const b={name:i,reducer:y,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:v,...w(s),injectInto(S,{reducerPath:k,..._}={}){const E=k??s;return S.inject({reducerPath:E,reducer:y},_),{...b,...w(E,!0)}}};return b}}function d9(e,t,r,n){function a(i,...s){let o=t(i);return typeof o>"u"&&n&&(o=r()),e(o,...s)}return a.unwrapped=e,a}var ja=u9();function f9(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function m9({type:e,reducerName:t,createNotation:r},n,a){let i,s;if("reducer"in n){if(r&&!p9(n))throw new Error(Pa(17));i=n.reducer,s=n.prepare}else i=n;a.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,s?ui(e,s):ui(e))}function h9(e){return e._reducerDefinitionType==="asyncThunk"}function p9(e){return e._reducerDefinitionType==="reducerWithPrepare"}function g9({type:e,reducerName:t},r,n,a){if(!a)throw new Error(Pa(18));const{payloadCreator:i,fulfilled:s,pending:o,rejected:c,settled:u,options:d}=r,f=a(e,i,d);n.exposeAction(t,f),s&&n.addCase(f.fulfilled,s),o&&n.addCase(f.pending,o),c&&n.addCase(f.rejected,c),u&&n.addMatcher(f.settled,u),n.exposeCaseReducer(t,{fulfilled:s||E0,pending:o||E0,rejected:c||E0,settled:u||E0})}function E0(){}var x9="task",S6="listener",k6="completed",Hb="cancelled",v9=`task-${Hb}`,y9=`task-${k6}`,my=`${S6}-${Hb}`,b9=`${S6}-${k6}`,Pp=class{constructor(e){Pg(this,"name","TaskAbortError");Pg(this,"message");this.code=e,this.message=`${x9} ${Hb} (reason: ${e})`}},Wb=(e,t)=>{if(typeof e!="function")throw new TypeError(Pa(32))},nh=()=>{},_6=(e,t=nh)=>(e.catch(t),e),E6=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),tl=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},rl=e=>{if(e.aborted){const{reason:t}=e;throw new Pp(t)}};function C6(e,t){let r=nh;return new Promise((n,a)=>{const i=()=>a(new Pp(e.reason));if(e.aborted){i();return}r=E6(e,i),t.finally(()=>r()).then(n,a)}).finally(()=>{r=nh})}var w9=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof Pp?"cancelled":"rejected",error:r}}finally{t==null||t()}},ah=e=>t=>_6(C6(e,t).then(r=>(rl(e),r))),A6=e=>{const t=ah(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:kc}=Object,Tk={},Op="listenerMiddleware",N9=(e,t)=>{const r=n=>E6(e,()=>tl(n,e.reason));return(n,a)=>{Wb(n);const i=new AbortController;r(i);const s=w9(async()=>{rl(e),rl(i.signal);const o=await n({pause:ah(i.signal),delay:A6(i.signal),signal:i.signal});return rl(i.signal),o},()=>tl(i,y9));return a!=null&&a.autoJoin&&t.push(s.catch(nh)),{result:ah(e)(s),cancel(){tl(i,v9)}}}},S9=(e,t)=>{const r=async(n,a)=>{rl(t);let i=()=>{};const o=[new Promise((c,u)=>{let d=e({predicate:n,effect:(f,h)=>{h.unsubscribe(),c([f,h.getState(),h.getOriginalState()])}});i=()=>{d(),u()}})];a!=null&&o.push(new Promise(c=>setTimeout(c,a,null)));try{const c=await C6(t,Promise.race(o));return rl(t),c}finally{i()}};return(n,a)=>_6(r(n,a))},T6=e=>{let{type:t,actionCreator:r,matcher:n,predicate:a,effect:i}=e;if(t)a=ui(t).match;else if(r)t=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(Pa(21));return Wb(i),{predicate:a,type:t,effect:i}},P6=kc(e=>{const{type:t,predicate:r,effect:n}=T6(e);return{id:o9(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Pa(22))}}},{withTypes:()=>P6}),Pk=(e,t)=>{const{type:r,effect:n,predicate:a}=T6(t);return Array.from(e.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===a)&&i.effect===n)},hy=e=>{e.pending.forEach(t=>{tl(t,my)})},k9=(e,t)=>()=>{for(const r of t.keys())hy(r);e.clear()},Ok=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},O6=kc(ui(`${Op}/add`),{withTypes:()=>O6}),_9=ui(`${Op}/removeAll`),D6=kc(ui(`${Op}/remove`),{withTypes:()=>D6}),E9=(...e)=>{console.error(`${Op}/error`,...e)},Af=(e={})=>{const t=new Map,r=new Map,n=p=>{const x=r.get(p)??0;r.set(p,x+1)},a=p=>{const x=r.get(p)??1;x===1?r.delete(p):r.set(p,x-1)},{extra:i,onError:s=E9}=e;Wb(s);const o=p=>(p.unsubscribe=()=>t.delete(p.id),t.set(p.id,p),x=>{p.unsubscribe(),x!=null&&x.cancelActive&&hy(p)}),c=p=>{const x=Pk(t,p)??P6(p);return o(x)};kc(c,{withTypes:()=>c});const u=p=>{const x=Pk(t,p);return x&&(x.unsubscribe(),p.cancelActive&&hy(x)),!!x};kc(u,{withTypes:()=>u});const d=async(p,x,g,y)=>{const v=new AbortController,w=S9(c,v.signal),b=[];try{p.pending.add(v),n(p),await Promise.resolve(p.effect(x,kc({},g,{getOriginalState:y,condition:(S,k)=>w(S,k).then(Boolean),take:w,delay:A6(v.signal),pause:ah(v.signal),extra:i,signal:v.signal,fork:N9(v.signal,b),unsubscribe:p.unsubscribe,subscribe:()=>{t.set(p.id,p)},cancelActiveListeners:()=>{p.pending.forEach((S,k,_)=>{S!==v&&(tl(S,my),_.delete(S))})},cancel:()=>{tl(v,my),p.pending.delete(v)},throwIfCancelled:()=>{rl(v.signal)}})))}catch(S){S instanceof Pp||Ok(s,S,{raisedBy:"effect"})}finally{await Promise.all(b),tl(v,b9),a(p),p.pending.delete(v)}},f=k9(t,r);return{middleware:p=>x=>g=>{if(!u6(g))return x(g);if(O6.match(g))return c(g.payload);if(_9.match(g)){f();return}if(D6.match(g))return u(g.payload);let y=p.getState();const v=()=>{if(y===Tk)throw new Error(Pa(23));return y};let w;try{if(w=x(g),t.size>0){const b=p.getState(),S=Array.from(t.values());for(const k of S){let _=!1;try{_=k.predicate(g,b,y)}catch(E){_=!1,Ok(s,E,{raisedBy:"predicate"})}_&&d(k,g,p,v)}}}finally{y=Tk}return w},startListening:c,stopListening:u,clearListeners:f}};function Pa(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var C9={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},R6=ja({name:"chartLayout",initialState:C9,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,a,i;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(a=t.payload.bottom)!==null&&a!==void 0?a:0,e.margin.left=(i=t.payload.left)!==null&&i!==void 0?i:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:A9,setLayout:T9,setChartSize:P9,setScale:O9}=R6.actions,D9=R6.reducer;function Dk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Rk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Dk(Object(r),!0).forEach(function(n){R9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function R9(e,t,r){return(t=M9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function M9(e){var t=I9(e,"string");return typeof t=="symbol"?t:t+""}function I9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ih=Math.PI/180,F9=e=>e*180/Math.PI,Ir=(e,t,r,n)=>({x:e+Math.cos(-ih*n)*r,y:t+Math.sin(-ih*n)*r}),M6=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0,width:0,height:0,brushBottom:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},L9=(e,t)=>{var{x:r,y:n}=e,{x:a,y:i}=t;return Math.sqrt((r-a)**2+(n-i)**2)},B9=(e,t)=>{var{x:r,y:n}=e,{cx:a,cy:i}=t,s=L9({x:r,y:n},{x:a,y:i});if(s<=0)return{radius:s,angle:0};var o=(r-a)/s,c=Math.acos(o);return n>i&&(c=2*Math.PI-c),{radius:s,angle:F9(c),angleInRadian:c}},j9=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),a=Math.floor(r/360),i=Math.min(n,a);return{startAngle:t-i*360,endAngle:r-i*360}},$9=(e,t)=>{var{startAngle:r,endAngle:n}=t,a=Math.floor(r/360),i=Math.floor(n/360),s=Math.min(a,i);return e+s*360},U9=(e,t)=>{var{x:r,y:n}=e,{radius:a,angle:i}=B9({x:r,y:n},t),{innerRadius:s,outerRadius:o}=t;if(a<s||a>o||a===0)return null;var{startAngle:c,endAngle:u}=j9(t),d=i,f;if(c<=u){for(;d>u;)d-=360;for(;d<c;)d+=360;f=d>=c&&d<=u}else{for(;d>c;)d-=360;for(;d<u;)d+=360;f=d>=u&&d<=c}return f?Rk(Rk({},t),{},{radius:a,angle:$9(d,t)}):null};function I6(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function Mk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Za(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Mk(Object(r),!0).forEach(function(n){z9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Mk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function z9(e,t,r){return(t=H9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function H9(e){var t=W9(e,"string");return typeof t=="symbol"?t:t+""}function W9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yt(e,t,r){return or(e)||or(t)?r:Xi(t)?xl(e,t,r):typeof t=="function"?t(e):r}var G9=(e,t,r,n,a)=>{var i,s=-1,o=(i=t==null?void 0:t.length)!==null&&i!==void 0?i:0;if(o<=1||e==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var c=0;c<o;c++){var u=c>0?r[c-1].coordinate:r[o-1].coordinate,d=r[c].coordinate,f=c>=o-1?r[0].coordinate:r[c+1].coordinate,h=void 0;if(tn(d-u)!==tn(f-d)){var p=[];if(tn(f-d)===tn(a[1]-a[0])){h=f;var x=d+a[1]-a[0];p[0]=Math.min(x,(x+u)/2),p[1]=Math.max(x,(x+u)/2)}else{h=u;var g=f+a[1]-a[0];p[0]=Math.min(d,(g+d)/2),p[1]=Math.max(d,(g+d)/2)}var y=[Math.min(d,(h+d)/2),Math.max(d,(h+d)/2)];if(e>y[0]&&e<=y[1]||e>=p[0]&&e<=p[1]){({index:s}=r[c]);break}}else{var v=Math.min(u,f),w=Math.max(u,f);if(e>(v+d)/2&&e<=(w+d)/2){({index:s}=r[c]);break}}}else if(t){for(var b=0;b<o;b++)if(b===0&&e<=(t[b].coordinate+t[b+1].coordinate)/2||b>0&&b<o-1&&e>(t[b].coordinate+t[b-1].coordinate)/2&&e<=(t[b].coordinate+t[b+1].coordinate)/2||b===o-1&&e>(t[b].coordinate+t[b-1].coordinate)/2){({index:s}=t[b]);break}}return s},V9=(e,t,r)=>{if(t&&r){var{width:n,height:a}=r,{align:i,verticalAlign:s,layout:o}=t;if((o==="vertical"||o==="horizontal"&&s==="middle")&&i!=="center"&&Je(e[i]))return Za(Za({},e),{},{[i]:e[i]+(n||0)});if((o==="horizontal"||o==="vertical"&&i==="center")&&s!=="middle"&&Je(e[s]))return Za(Za({},e),{},{[s]:e[s]+(a||0)})}return e},Co=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",F6=(e,t,r,n)=>{if(n)return e.map(o=>o.coordinate);var a,i,s=e.map(o=>(o.coordinate===t&&(a=!0),o.coordinate===r&&(i=!0),o.coordinate));return a||s.push(t),i||s.push(r),s},L6=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:a,range:i,scale:s,realScaleType:o,isCategorical:c,categoricalDomain:u,tickCount:d,ticks:f,niceTicks:h,axisType:p}=e;if(!s)return null;var x=o==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,g=(t||r)&&a==="category"&&s.bandwidth?s.bandwidth()/x:0;if(g=p==="angleAxis"&&i&&i.length>=2?tn(i[0]-i[1])*2*g:g,t&&(f||h)){var y=(f||h||[]).map((v,w)=>{var b=n?n.indexOf(v):v;return{coordinate:s(b)+g,value:v,offset:g,index:w}});return y.filter(v=>!ci(v.coordinate))}return c&&u?u.map((v,w)=>({coordinate:s(v)+g,value:v,index:w,offset:g})):s.ticks&&!r&&d!=null?s.ticks(d).map((v,w)=>({coordinate:s(v)+g,value:v,offset:g,index:w})):s.domain().map((v,w)=>({coordinate:s(v)+g,value:n?n[v]:v,index:w,offset:g}))},Ik=1e-4,K9=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),a=Math.min(n[0],n[1])-Ik,i=Math.max(n[0],n[1])+Ik,s=e(t[0]),o=e(t[r-1]);(s<a||s>i||o<a||o>i)&&e.domain([t[0],t[r-1]])}},X9=(e,t)=>{if(!t||t.length!==2||!Je(t[0])||!Je(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!Je(e[0])||e[0]<r)&&(a[0]=r),(!Je(e[1])||e[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},q9=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0,s=0;s<t;++s){var o=ci(e[s][r][1])?e[s][r][0]:e[s][r][1];o>=0?(e[s][r][0]=a,e[s][r][1]=a+o,a=e[s][r][1]):(e[s][r][0]=i,e[s][r][1]=i+o,i=e[s][r][1])}},Y9=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0;i<t;++i){var s=ci(e[i][r][1])?e[i][r][0]:e[i][r][1];s>=0?(e[i][r][0]=a,e[i][r][1]=a+s,a=e[i][r][1]):(e[i][r][0]=0,e[i][r][1]=0)}},J9={sign:q9,expand:M7,none:Uc,silhouette:I7,wiggle:F7,positive:Y9},Q9=(e,t,r)=>{var n=J9[r],a=R7().keys(t).value((i,s)=>+Yt(i,s,0)).order(ay).offset(n);return a(e)};function Z9(e){return e==null?void 0:String(e)}function Fk(e){var{axis:t,ticks:r,bandSize:n,entry:a,index:i,dataKey:s}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!or(a[t.dataKey])){var o=O3(r,"value",a[t.dataKey]);if(o)return o.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var c=Yt(a,or(s)?t.dataKey:s);return or(c)?null:t.scale(c)}var Lk=e=>{var{axis:t,ticks:r,offset:n,bandSize:a,entry:i,index:s}=e;if(t.type==="category")return r[s]?r[s].coordinate+n:null;var o=Yt(i,t.dataKey,t.scale.domain()[s]);return or(o)?null:t.scale(o)-a/2+n},e$=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},t$=e=>{var t=e.flat(2).filter(Je);return[Math.min(...t),Math.max(...t)]},r$=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],n$=(e,t,r)=>{if(e!=null)return r$(Object.keys(e).reduce((n,a)=>{var i=e[a],{stackedData:s}=i,o=s.reduce((c,u)=>{var d=I6(u,t,r),f=t$(d);return[Math.min(c[0],f[0]),Math.max(c[1],f[1])]},[1/0,-1/0]);return[Math.min(o[0],n[0]),Math.max(o[1],n[1])]},[1/0,-1/0]))},Bk=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,jk=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Kd=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var a=Ep(t,d=>d.coordinate),i=1/0,s=1,o=a.length;s<o;s++){var c=a[s],u=a[s-1];i=Math.min((c.coordinate||0)-(u.coordinate||0),i)}return i===1/0?0:i}return r?void 0:0};function $k(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:a,name:i}=e;return Za(Za({},t),{},{dataKey:r,payload:n,value:a,name:i})}function lu(e,t){if(e)return String(e);if(typeof t=="string")return t}function a$(e,t,r,n,a){if(r==="horizontal"||r==="vertical"){var i=e>=a.left&&e<=a.left+a.width&&t>=a.top&&t<=a.top+a.height;return i?{x:e,y:t}:null}return n?U9({x:e,y:t},n):null}var i$=(e,t,r,n)=>{var a=t.find(u=>u&&u.index===r);if(a){if(e==="horizontal")return{x:a.coordinate,y:n.y};if(e==="vertical")return{x:n.x,y:a.coordinate};if(e==="centric"){var i=a.coordinate,{radius:s}=n;return Za(Za(Za({},n),Ir(n.cx,n.cy,s,i)),{},{angle:i,radius:s})}var o=a.coordinate,{angle:c}=n;return Za(Za(Za({},n),Ir(n.cx,n.cy,o,c)),{},{angle:c,radius:o})}return{x:0,y:0}},s$=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,As=e=>e.layout.width,Ts=e=>e.layout.height,o$=e=>e.layout.scale,B6=e=>e.layout.margin,Dp=me(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),Rp=me(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),j6="data-recharts-item-index",$6="data-recharts-item-data-key",Tf=60;function Uk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function C0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Uk(Object(r),!0).forEach(function(n){l$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Uk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function l$(e,t,r){return(t=c$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c$(e){var t=u$(e,"string");return typeof t=="symbol"?t:t+""}function u$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var d$=e=>e.brush.height;function f$(e){var t=Rp(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:Tf;return r+a}return r},0)}function m$(e){var t=Rp(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:Tf;return r+a}return r},0)}function h$(e){var t=Dp(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function p$(e){var t=Dp(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var Wr=me([As,Ts,B6,d$,f$,m$,h$,p$,s6,Mj],(e,t,r,n,a,i,s,o,c,u)=>{var d={left:(r.left||0)+a,right:(r.right||0)+i},f={top:(r.top||0)+s,bottom:(r.bottom||0)+o},h=C0(C0({},f),d),p=h.bottom;h.bottom+=n,h=V9(h,c,u);var x=e-h.left-h.right,g=t-h.top-h.bottom;return C0(C0({brushBottom:p},h),{},{width:Math.max(x,0),height:Math.max(g,0)})}),g$=me(Wr,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),Gb=me(As,Ts,(e,t)=>({x:0,y:0,width:e,height:t})),x$=N.createContext(null),Jn=()=>N.useContext(x$)!=null,Mp=e=>e.brush,Ip=me([Mp,Wr,B6],(e,t,r)=>({height:e.height,x:Je(e.x)?e.x:t.left,y:Je(e.y)?e.y:t.top+t.height+t.brushBottom-((r==null?void 0:r.bottom)||0),width:Je(e.width)?e.width:t.width})),U6={},z6={},H6={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:a,edges:i}={}){let s,o=null;const c=i!=null&&i.includes("leading"),u=i==null||i.includes("trailing"),d=()=>{o!==null&&(r.apply(s,o),s=void 0,o=null)},f=()=>{u&&d(),g()};let h=null;const p=()=>{h!=null&&clearTimeout(h),h=setTimeout(()=>{h=null,f()},n)},x=()=>{h!==null&&(clearTimeout(h),h=null)},g=()=>{x(),s=void 0,o=null},y=()=>{d()},v=function(...w){if(a!=null&&a.aborted)return;s=this,o=w;const b=h==null;p(),c&&b&&d()};return v.schedule=p,v.cancel=g,v.flush=y,a==null||a.addEventListener("abort",g,{once:!0}),v}e.debounce=t})(H6);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=H6;function r(n,a=0,i={}){typeof i!="object"&&(i={});const{leading:s=!1,trailing:o=!0,maxWait:c}=i,u=Array(2);s&&(u[0]="leading"),o&&(u[1]="trailing");let d,f=null;const h=t.debounce(function(...g){d=n.apply(this,g),f=null},a,{edges:u}),p=function(...g){return c!=null&&(f===null&&(f=Date.now()),Date.now()-f>=c)?(d=n.apply(this,g),f=Date.now(),h.cancel(),h.schedule(),d):(h.apply(this,g),d)},x=()=>(h.flush(),d);return p.cancel=h.cancel,p.flush=x,p}e.debounce=r})(z6);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=z6;function r(n,a=0,i={}){const{leading:s=!0,trailing:o=!0}=i;return t.debounce(n,a,{leading:s,maxWait:a,trailing:o})}e.throttle=r})(U6);var v$=U6.throttle;const y$=Es(v$);var sh=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]},W6=(e,t,r)=>{var{width:n="100%",height:a="100%",aspect:i,maxHeight:s}=r,o=ws(n)?e:Number(n),c=ws(a)?t:Number(a);return i&&i>0&&(o?c=o/i:c&&(o=c*i),s&&c>s&&(c=s)),{calculatedWidth:o,calculatedHeight:c}},b$={width:0,height:0,overflow:"visible"},w$={width:0,overflowX:"visible"},N$={height:0,overflowY:"visible"},S$={},k$=e=>{var{width:t,height:r}=e,n=ws(t),a=ws(r);return n&&a?b$:n?w$:a?N$:S$};function _$(e){var{width:t,height:r,aspect:n}=e,a=t,i=r;return a===void 0&&i===void 0?(a="100%",i="100%"):a===void 0?a=n&&n>0?void 0:"100%":i===void 0&&(i=n&&n>0?void 0:"100%"),{width:a,height:i}}function Mn(e){return Number.isFinite(e)}function Wc(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function py(){return py=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},py.apply(null,arguments)}function zk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Hk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zk(Object(r),!0).forEach(function(n){E$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function E$(e,t,r){return(t=C$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C$(e){var t=A$(e,"string");return typeof t=="symbol"?t:t+""}function A$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var G6=N.createContext({width:-1,height:-1});function V6(e){var{children:t,width:r,height:n}=e,a=N.useMemo(()=>({width:r,height:n}),[r,n]);return r<=0||n<=0?null:N.createElement(G6.Provider,{value:a},t)}var Vb=()=>N.useContext(G6),T$=N.forwardRef((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a,height:i,minWidth:s=0,minHeight:o,maxHeight:c,children:u,debounce:d=0,id:f,className:h,onResize:p,style:x={}}=e,g=N.useRef(null),y=N.useRef();y.current=p,N.useImperativeHandle(t,()=>g.current);var[v,w]=N.useState({containerWidth:n.width,containerHeight:n.height}),b=N.useCallback((P,A)=>{w(T=>{var R=Math.round(P),D=Math.round(A);return T.containerWidth===R&&T.containerHeight===D?T:{containerWidth:R,containerHeight:D}})},[]);N.useEffect(()=>{var P=D=>{var L,{width:z,height:X}=D[0].contentRect;b(z,X),(L=y.current)===null||L===void 0||L.call(y,z,X)};d>0&&(P=y$(P,d,{trailing:!0,leading:!1}));var A=new ResizeObserver(P),{width:T,height:R}=g.current.getBoundingClientRect();return b(T,R),A.observe(g.current),()=>{A.disconnect()}},[b,d]);var{containerWidth:S,containerHeight:k}=v;sh(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:_,calculatedHeight:E}=W6(S,k,{width:a,height:i,aspect:r,maxHeight:c});return sh(_>0||E>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,_,E,a,i,s,o,r),N.createElement("div",{id:f?"".concat(f):void 0,className:It("recharts-responsive-container",h),style:Hk(Hk({},x),{},{width:a,height:i,minWidth:s,minHeight:o,maxHeight:c}),ref:g},N.createElement("div",{style:k$({width:a,height:i})},N.createElement(V6,{width:_,height:E},u)))}),ga=N.forwardRef((e,t)=>{var r=Vb();if(Wc(r.width)&&Wc(r.height))return e.children;var{width:n,height:a}=_$({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:i,calculatedHeight:s}=W6(void 0,void 0,{width:n,height:a,aspect:e.aspect,maxHeight:e.maxHeight});return Je(i)&&Je(s)?N.createElement(V6,{width:i,height:s},e.children):N.createElement(T$,py({},e,{width:n,height:a,ref:t}))}),Fp=()=>{var e,t=Jn(),r=Ve(g$),n=Ve(Ip),a=(e=Ve(Mp))===null||e===void 0?void 0:e.padding;return!t||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},P$={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},K6=()=>{var e;return(e=Ve(Wr))!==null&&e!==void 0?e:P$},Kb=()=>Ve(As),Xb=()=>Ve(Ts),O$=()=>Ve(e=>e.layout.margin),Ot=e=>e.layout.layoutType,Lp=()=>Ve(Ot),Bp=e=>{var t=lr(),r=Jn(),{width:n,height:a}=e,i=Vb(),s=n,o=a;return i&&(s=i.width>0?i.width:n,o=i.height>0?i.height:a),N.useEffect(()=>{!r&&Wc(s)&&Wc(o)&&t(P9({width:s,height:o}))},[t,r,s,o]),null},D$={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},X6=ja({name:"legend",initialState:D$,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:Un()},removeLegendPayload:{reducer(e,t){var r=ms(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)},prepare:Un()}}}),{setLegendSize:Wk,setLegendSettings:R$,addLegendPayload:q6,removeLegendPayload:Y6}=X6.actions,M$=X6.reducer,I$=["contextPayload"];function gy(){return gy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gy.apply(null,arguments)}function Gk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Gc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Gk(Object(r),!0).forEach(function(n){qb(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Gk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qb(e,t,r){return(t=F$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function F$(e){var t=L$(e,"string");return typeof t=="symbol"?t:t+""}function L$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function B$(e,t){if(e==null)return{};var r,n,a=j$(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function j$(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function $$(e){return e.value}function U$(e){var{contextPayload:t}=e,r=B$(e,I$),n=q3(t,e.payloadUniqBy,$$),a=Gc(Gc({},r),{},{payload:n});return N.isValidElement(e.content)?N.cloneElement(e.content,a):typeof e.content=="function"?N.createElement(e.content,a):N.createElement(Cb,a)}function z$(e,t,r,n,a,i){var{layout:s,align:o,verticalAlign:c}=t,u,d;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(o==="center"&&s==="vertical"?u={left:((n||0)-i.width)/2}:u=o==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(c==="middle"?d={top:((a||0)-i.height)/2}:d=c==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),Gc(Gc({},u),d)}function H$(e){var t=lr();return N.useEffect(()=>{t(R$(e))},[t,e]),null}function W$(e){var t=lr();return N.useEffect(()=>(t(Wk(e)),()=>{t(Wk({width:0,height:0}))}),[t,e]),null}function G$(e){var t=Lj(),r=n7(),n=O$(),{width:a,height:i,wrapperStyle:s,portal:o}=e,[c,u]=o6([t]),d=Kb(),f=Xb();if(d==null||f==null)return null;var h=d-(n.left||0)-(n.right||0),p=Qr.getWidthOrHeight(e.layout,i,a,h),x=o?s:Gc(Gc({position:"absolute",width:(p==null?void 0:p.width)||a||"auto",height:(p==null?void 0:p.height)||i||"auto"},z$(s,e,n,d,f,c)),s),g=o??r;if(g==null)return null;var y=N.createElement("div",{className:"recharts-legend-wrapper",style:x,ref:u},N.createElement(H$,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),N.createElement(W$,{width:c.width,height:c.height}),N.createElement(U$,gy({},e,p,{margin:n,chartWidth:d,chartHeight:f,contextPayload:t})));return tb.createPortal(y,g)}class Qr extends N.PureComponent{static getWidthOrHeight(t,r,n,a){return t==="vertical"&&Je(r)?{height:r}:t==="horizontal"?{width:n||a}:null}render(){return N.createElement(G$,this.props)}}qb(Qr,"displayName","Legend");qb(Qr,"defaultProps",{align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"});function xy(){return xy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xy.apply(null,arguments)}function Vk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Vk(Object(r),!0).forEach(function(n){V$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function V$(e,t,r){return(t=K$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K$(e){var t=X$(e,"string");return typeof t=="symbol"?t:t+""}function X$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function q$(e){return Array.isArray(e)&&Xi(e[0])&&Xi(e[1])?e.join(" ~ "):e}var Y$=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:i,formatter:s,itemSorter:o,wrapperClassName:c,labelClassName:u,label:d,labelFormatter:f,accessibilityLayer:h=!1}=e,p=()=>{if(i&&i.length){var k={padding:0,margin:0},_=(o?Ep(i,o):i).map((E,P)=>{if(E.type==="none")return null;var A=E.formatter||s||q$,{value:T,name:R}=E,D=T,L=R;if(A){var z=A(T,R,E,P,i);if(Array.isArray(z))[D,L]=z;else if(z!=null)D=z;else return null}var X=xx({display:"block",paddingTop:4,paddingBottom:4,color:E.color||"#000"},n);return N.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(P),style:X},Xi(L)?N.createElement("span",{className:"recharts-tooltip-item-name"},L):null,Xi(L)?N.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,N.createElement("span",{className:"recharts-tooltip-item-value"},D),N.createElement("span",{className:"recharts-tooltip-item-unit"},E.unit||""))});return N.createElement("ul",{className:"recharts-tooltip-item-list",style:k},_)}return null},x=xx({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),g=xx({margin:0},a),y=!or(d),v=y?d:"",w=It("recharts-default-tooltip",c),b=It("recharts-tooltip-label",u);y&&f&&i!==void 0&&i!==null&&(v=f(d,i));var S=h?{role:"status","aria-live":"assertive"}:{};return N.createElement("div",xy({className:w,style:x},S),N.createElement("p",{className:b,style:g},N.isValidElement(v)?v:"".concat(v)),p())},$u="recharts-tooltip-wrapper",J$={visibility:"hidden"};function Q$(e){var{coordinate:t,translateX:r,translateY:n}=e;return It($u,{["".concat($u,"-right")]:Je(r)&&t&&Je(t.x)&&r>=t.x,["".concat($u,"-left")]:Je(r)&&t&&Je(t.x)&&r<t.x,["".concat($u,"-bottom")]:Je(n)&&t&&Je(t.y)&&n>=t.y,["".concat($u,"-top")]:Je(n)&&t&&Je(t.y)&&n<t.y})}function Kk(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:a,position:i,reverseDirection:s,tooltipDimension:o,viewBox:c,viewBoxDimension:u}=e;if(i&&Je(i[n]))return i[n];var d=r[n]-o-(a>0?a:0),f=r[n]+a;if(t[n])return s[n]?d:f;var h=c[n];if(h==null)return 0;if(s[n]){var p=d,x=h;return p<x?Math.max(f,h):Math.max(d,h)}if(u==null)return 0;var g=f+o,y=h+u;return g>y?Math.max(d,h):Math.max(f,h)}function Z$(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function eU(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:i,tooltipBox:s,useTranslate3d:o,viewBox:c}=e,u,d,f;return s.height>0&&s.width>0&&r?(d=Kk({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.width,viewBox:c,viewBoxDimension:c.width}),f=Kk({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.height,viewBox:c,viewBoxDimension:c.height}),u=Z$({translateX:d,translateY:f,useTranslate3d:o})):u=J$,{cssProperties:u,cssClasses:Q$({translateX:d,translateY:f,coordinate:r})}}function Xk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function A0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Xk(Object(r),!0).forEach(function(n){vy(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vy(e,t,r){return(t=tU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tU(e){var t=rU(e,"string");return typeof t=="symbol"?t:t+""}function rU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class nU extends N.PureComponent{constructor(){super(...arguments),vy(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),vy(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,a,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:i,coordinate:s,hasPayload:o,isAnimationActive:c,offset:u,position:d,reverseDirection:f,useTranslate3d:h,viewBox:p,wrapperStyle:x,lastBoundingBox:g,innerRef:y,hasPortalFromProps:v}=this.props,{cssClasses:w,cssProperties:b}=eU({allowEscapeViewBox:r,coordinate:s,offsetTopLeft:u,position:d,reverseDirection:f,tooltipBox:{height:g.height,width:g.width},useTranslate3d:h,viewBox:p}),S=v?{}:A0(A0({transition:c&&t?"transform ".concat(n,"ms ").concat(a):void 0},b),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&o?"visible":"hidden",position:"absolute",top:0,left:0}),k=A0(A0({},S),{},{visibility:!this.state.dismissed&&t&&o?"visible":"hidden"},x);return N.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:w,style:k,ref:y},i)}}var aU=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Ao={devToolsEnabled:!1,isSsr:aU()},J6=()=>Ve(e=>e.rootProps.accessibilityLayer);function yy(){return yy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yy.apply(null,arguments)}function qk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Yk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qk(Object(r),!0).forEach(function(n){iU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iU(e,t,r){return(t=sU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sU(e){var t=oU(e,"string");return typeof t=="symbol"?t:t+""}function oU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jk={curveBasisClosed:N7,curveBasisOpen:S7,curveBasis:w7,curveBumpX:o7,curveBumpY:l7,curveLinearClosed:k7,curveLinear:yp,curveMonotoneX:_7,curveMonotoneY:E7,curveNatural:C7,curveStep:A7,curveStepAfter:P7,curveStepBefore:T7},T0=e=>Mn(e.x)&&Mn(e.y),Uu=e=>e.x,zu=e=>e.y,lU=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(_f(e));return(r==="curveMonotone"||r==="curveBump")&&t?Jk["".concat(r).concat(t==="vertical"?"Y":"X")]:Jk[r]||yp},cU=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:a,connectNulls:i=!1}=e,s=lU(t,a),o=i?r.filter(T0):r,c;if(Array.isArray(n)){var u=i?n.filter(f=>T0(f)):n,d=o.map((f,h)=>Yk(Yk({},f),{},{base:u[h]}));return a==="vertical"?c=w0().y(zu).x1(Uu).x0(f=>f.base.x):c=w0().x(Uu).y1(zu).y0(f=>f.base.y),c.defined(T0).curve(s),c(d)}return a==="vertical"&&Je(n)?c=w0().y(zu).x1(Uu).x0(n):Je(n)?c=w0().x(Uu).y1(zu).y0(n):c=x3().x(Uu).y(zu),c.defined(T0).curve(s),c(o)},Yb=e=>{var{className:t,points:r,path:n,pathRef:a}=e;if((!r||!r.length)&&!n)return null;var i=r&&r.length?cU(e):n;return N.createElement("path",yy({},Ra(e),_b(e),{className:It("recharts-curve",t),d:i===null?void 0:i,ref:a}))},uU=["x","y","top","left","width","height","className"];function by(){return by=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},by.apply(null,arguments)}function Qk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function dU(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Qk(Object(r),!0).forEach(function(n){fU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fU(e,t,r){return(t=mU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mU(e){var t=hU(e,"string");return typeof t=="symbol"?t:t+""}function hU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pU(e,t){if(e==null)return{};var r,n,a=gU(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function gU(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var xU=(e,t,r,n,a,i)=>"M".concat(e,",").concat(a,"v").concat(n,"M").concat(i,",").concat(t,"h").concat(r),vU=e=>{var{x:t=0,y:r=0,top:n=0,left:a=0,width:i=0,height:s=0,className:o}=e,c=pU(e,uU),u=dU({x:t,y:r,top:n,left:a,width:i,height:s},c);return!Je(t)||!Je(r)||!Je(i)||!Je(s)||!Je(n)||!Je(a)?null:N.createElement("path",by({},Kn(u),{className:It("recharts-cross",o),d:xU(t,r,i,s,n,a)}))};function yU(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function Zk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bU(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Zk(Object(r),!0).forEach(function(n){wU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wU(e,t,r){return(t=NU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NU(e){var t=SU(e,"string");return typeof t=="symbol"?t:t+""}function SU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gn(e,t){var r=bU({},e),n=t,a=Object.keys(t),i=a.reduce((s,o)=>(s[o]===void 0&&n[o]!==void 0&&(s[o]=n[o]),s),r);return i}function kU(){}function _U(e){return e!=null}function e_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function t_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?e_(Object(r),!0).forEach(function(n){EU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):e_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function EU(e,t,r){return(t=CU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CU(e){var t=AU(e,"string");return typeof t=="symbol"?t:t+""}function AU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TU=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),Q6=(e,t,r)=>e.map(n=>"".concat(TU(n)," ").concat(t,"ms ").concat(r)).join(","),PU=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(a=>n.includes(a))),Xd=(e,t)=>Object.keys(t).reduce((r,n)=>t_(t_({},r),{},{[n]:e(n,t[n])}),{});function r_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function un(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?r_(Object(r),!0).forEach(function(n){OU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):r_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OU(e,t,r){return(t=DU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DU(e){var t=RU(e,"string");return typeof t=="symbol"?t:t+""}function RU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oh=(e,t,r)=>e+(t-e)*r,wy=e=>{var{from:t,to:r}=e;return t!==r},Z6=(e,t,r)=>{var n=Xd((a,i)=>{if(wy(i)){var[s,o]=e(i.from,i.to,i.velocity);return un(un({},i),{},{from:s,velocity:o})}return i},t);return r<1?Xd((a,i)=>wy(i)?un(un({},i),{},{velocity:oh(i.velocity,n[a].velocity,r),from:oh(i.from,n[a].from,r)}):i,t):Z6(e,n,r-1)};function MU(e,t,r,n,a,i){var s,o=n.reduce((h,p)=>un(un({},h),{},{[p]:{from:e[p],velocity:0,to:t[p]}}),{}),c=()=>Xd((h,p)=>p.from,o),u=()=>!Object.values(o).filter(wy).length,d=null,f=h=>{s||(s=h);var p=h-s,x=p/r.dt;o=Z6(r,o,x),a(un(un(un({},e),t),c())),s=h,u()||(d=i.setTimeout(f))};return()=>(d=i.setTimeout(f),()=>{d()})}function IU(e,t,r,n,a,i,s){var o=null,c=a.reduce((f,h)=>un(un({},f),{},{[h]:[e[h],t[h]]}),{}),u,d=f=>{u||(u=f);var h=(f-u)/n,p=Xd((g,y)=>oh(...y,r(h)),c);if(i(un(un(un({},e),t),p)),h<1)o=s.setTimeout(d);else{var x=Xd((g,y)=>oh(...y,r(1)),c);i(un(un(un({},e),t),x))}};return()=>(o=s.setTimeout(d),()=>{o()})}const FU=(e,t,r,n,a,i)=>{var s=PU(e,t);return r.isStepper===!0?MU(e,t,r,s,a,i):IU(e,t,r,n,s,a,i)};var lh=1e-4,e5=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],t5=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),n_=(e,t)=>r=>{var n=e5(e,t);return t5(n,r)},LU=(e,t)=>r=>{var n=e5(e,t),a=[...n.map((i,s)=>i*s).slice(1),0];return t5(a,r)},a_=function(){for(var t,r,n,a,i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];if(s.length===1)switch(s[0]){case"linear":[t,n,r,a]=[0,0,1,1];break;case"ease":[t,n,r,a]=[.25,.1,.25,1];break;case"ease-in":[t,n,r,a]=[.42,0,1,1];break;case"ease-out":[t,n,r,a]=[.42,0,.58,1];break;case"ease-in-out":[t,n,r,a]=[0,0,.58,1];break;default:{var c=s[0].split("(");c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4&&([t,n,r,a]=c[1].split(")")[0].split(",").map(x=>parseFloat(x)))}}else s.length===4&&([t,n,r,a]=s);var u=n_(t,r),d=n_(n,a),f=LU(t,r),h=x=>x>1?1:x<0?0:x,p=x=>{for(var g=x>1?1:x,y=g,v=0;v<8;++v){var w=u(y)-g,b=f(y);if(Math.abs(w-g)<lh||b<lh)return d(y);y=h(y-w/b)}return d(y)};return p.isStepper=!1,p},BU=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=t,i=(s,o,c)=>{var u=-(s-o)*r,d=c*n,f=c+(u-d)*a/1e3,h=c*a/1e3+s;return Math.abs(h-o)<lh&&Math.abs(f)<lh?[o,0]:[h,f]};return i.isStepper=!0,i.dt=a,i},jU=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return a_(e);case"spring":return BU();default:if(e.split("(")[0]==="cubic-bezier")return a_(e)}return typeof e=="function"?e:null};function $U(e){var t,r=()=>null,n=!1,a=null,i=s=>{if(!n){if(Array.isArray(s)){if(!s.length)return;var o=s,[c,...u]=o;if(typeof c=="number"){a=e.setTimeout(i.bind(null,u),c);return}i(c),a=e.setTimeout(i.bind(null,u));return}typeof s=="string"&&(t=s,r(t)),typeof s=="object"&&(t=s,r(t)),typeof s=="function"&&s()}};return{stop:()=>{n=!0},start:s=>{n=!1,a&&(a(),a=null),i(s)},subscribe:s=>(r=s,()=>{r=()=>null}),getTimeoutController:()=>e}}class UU{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,i=s=>{s-n>=r?t(s):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(i))};return a=requestAnimationFrame(i),()=>{cancelAnimationFrame(a)}}}function zU(){return $U(new UU)}var HU=N.createContext(zU);function WU(e,t){var r=N.useContext(HU);return N.useMemo(()=>t??r(e),[e,t,r])}var GU={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},i_={t:0},vx={t:1};function Pf(e){var t=gn(e,GU),{isActive:r,canBegin:n,duration:a,easing:i,begin:s,onAnimationEnd:o,onAnimationStart:c,children:u}=t,d=WU(t.animationId,t.animationManager),[f,h]=N.useState(r?i_:vx),p=N.useRef(null);return N.useEffect(()=>{r||h(vx)},[r]),N.useEffect(()=>{if(!r||!n)return kU;var x=FU(i_,vx,jU(i),a,h,d.getTimeoutController()),g=()=>{p.current=x()};return d.start([c,s,g,a,o]),()=>{d.stop(),p.current&&p.current(),o()}},[r,n,a,i,s,c,o,d]),u(f.t)}function Of(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=N.useRef(Wd(t)),n=N.useRef(e);return n.current!==e&&(r.current=Wd(t),n.current=e),r.current}var VU=["radius"],KU=["radius"];function s_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function o_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s_(Object(r),!0).forEach(function(n){XU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XU(e,t,r){return(t=qU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qU(e){var t=YU(e,"string");return typeof t=="symbol"?t:t+""}function YU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ch(){return ch=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ch.apply(null,arguments)}function l_(e,t){if(e==null)return{};var r,n,a=JU(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function JU(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var c_=(e,t,r,n,a)=>{var i=Math.min(Math.abs(r)/2,Math.abs(n)/2),s=n>=0?1:-1,o=r>=0?1:-1,c=n>=0&&r>=0||n<0&&r<0?1:0,u;if(i>0&&a instanceof Array){for(var d=[0,0,0,0],f=0,h=4;f<h;f++)d[f]=a[f]>i?i:a[f];u="M".concat(e,",").concat(t+s*d[0]),d[0]>0&&(u+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(c,",").concat(e+o*d[0],",").concat(t)),u+="L ".concat(e+r-o*d[1],",").concat(t),d[1]>0&&(u+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(c,`,
        `).concat(e+r,",").concat(t+s*d[1])),u+="L ".concat(e+r,",").concat(t+n-s*d[2]),d[2]>0&&(u+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(c,`,
        `).concat(e+r-o*d[2],",").concat(t+n)),u+="L ".concat(e+o*d[3],",").concat(t+n),d[3]>0&&(u+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(t+n-s*d[3])),u+="Z"}else if(i>0&&a===+a&&a>0){var p=Math.min(i,a);u="M ".concat(e,",").concat(t+s*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+o*p,",").concat(t,`
            L `).concat(e+r-o*p,",").concat(t,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+r,",").concat(t+s*p,`
            L `).concat(e+r,",").concat(t+n-s*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+r-o*p,",").concat(t+n,`
            L `).concat(e+o*p,",").concat(t+n,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e,",").concat(t+n-s*p," Z")}else u="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return u},QU={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},r5=e=>{var t=gn(e,QU),r=N.useRef(null),[n,a]=N.useState(-1);N.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var Y=r.current.getTotalLength();Y&&a(Y)}catch{}},[]);var{x:i,y:s,width:o,height:c,radius:u,className:d}=t,{animationEasing:f,animationDuration:h,animationBegin:p,isAnimationActive:x,isUpdateAnimationActive:g}=t,y=N.useRef(o),v=N.useRef(c),w=N.useRef(i),b=N.useRef(s),S=N.useMemo(()=>({x:i,y:s,width:o,height:c,radius:u}),[i,s,o,c,u]),k=Of(S,"rectangle-");if(i!==+i||s!==+s||o!==+o||c!==+c||o===0||c===0)return null;var _=It("recharts-rectangle",d);if(!g){var E=Kn(t),P=l_(E,VU);return N.createElement("path",ch({},P,{radius:typeof u=="number"?u:void 0,className:_,d:c_(i,s,o,c,u)}))}var A=y.current,T=v.current,R=w.current,D=b.current,L="0px ".concat(n===-1?1:n,"px"),z="".concat(n,"px 0px"),X=Q6(["strokeDasharray"],h,typeof f=="string"?f:void 0);return N.createElement(Pf,{animationId:k,key:k,canBegin:n>0,duration:h,easing:f,isActive:g,begin:p},Y=>{var q=br(A,o,Y),ee=br(T,c,Y),V=br(R,i,Y),ae=br(D,s,Y);r.current&&(y.current=q,v.current=ee,w.current=V,b.current=ae);var oe;x?Y>0?oe={transition:X,strokeDasharray:z}:oe={strokeDasharray:L}:oe={strokeDasharray:z};var I=Kn(t),W=l_(I,KU);return N.createElement("path",ch({},W,{radius:typeof u=="number"?u:void 0,className:_,d:c_(V,ae,q,ee,u),ref:r,style:o_(o_({},oe),t.style)}))})};function n5(e){var{cx:t,cy:r,radius:n,startAngle:a,endAngle:i}=e,s=Ir(t,r,n,a),o=Ir(t,r,n,i);return{points:[s,o],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function Ny(){return Ny=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ny.apply(null,arguments)}var ZU=(e,t)=>{var r=tn(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},P0=e=>{var{cx:t,cy:r,radius:n,angle:a,sign:i,isExternal:s,cornerRadius:o,cornerIsExternal:c}=e,u=o*(s?1:-1)+n,d=Math.asin(o/u)/ih,f=c?a:a+i*d,h=Ir(t,r,u,f),p=Ir(t,r,n,f),x=c?a-i*d:a,g=Ir(t,r,u*Math.cos(d*ih),x);return{center:h,circleTangency:p,lineTangency:g,theta:d}},a5=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:i,endAngle:s}=e,o=ZU(i,s),c=i+o,u=Ir(t,r,a,i),d=Ir(t,r,a,c),f="M ".concat(u.x,",").concat(u.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(o)>180),",").concat(+(i>c),`,
    `).concat(d.x,",").concat(d.y,`
  `);if(n>0){var h=Ir(t,r,n,i),p=Ir(t,r,n,c);f+="L ".concat(p.x,",").concat(p.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(o)>180),",").concat(+(i<=c),`,
            `).concat(h.x,",").concat(h.y," Z")}else f+="L ".concat(t,",").concat(r," Z");return f},ez=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,cornerRadius:i,forceCornerRadius:s,cornerIsExternal:o,startAngle:c,endAngle:u}=e,d=tn(u-c),{circleTangency:f,lineTangency:h,theta:p}=P0({cx:t,cy:r,radius:a,angle:c,sign:d,cornerRadius:i,cornerIsExternal:o}),{circleTangency:x,lineTangency:g,theta:y}=P0({cx:t,cy:r,radius:a,angle:u,sign:-d,cornerRadius:i,cornerIsExternal:o}),v=o?Math.abs(c-u):Math.abs(c-u)-p-y;if(v<0)return s?"M ".concat(h.x,",").concat(h.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):a5({cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:c,endAngle:u});var w="M ".concat(h.x,",").concat(h.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(f.x,",").concat(f.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(v>180),",").concat(+(d<0),",").concat(x.x,",").concat(x.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(g.x,",").concat(g.y,`
  `);if(n>0){var{circleTangency:b,lineTangency:S,theta:k}=P0({cx:t,cy:r,radius:n,angle:c,sign:d,isExternal:!0,cornerRadius:i,cornerIsExternal:o}),{circleTangency:_,lineTangency:E,theta:P}=P0({cx:t,cy:r,radius:n,angle:u,sign:-d,isExternal:!0,cornerRadius:i,cornerIsExternal:o}),A=o?Math.abs(c-u):Math.abs(c-u)-k-P;if(A<0&&i===0)return"".concat(w,"L").concat(t,",").concat(r,"Z");w+="L".concat(E.x,",").concat(E.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(_.x,",").concat(_.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(A>180),",").concat(+(d>0),",").concat(b.x,",").concat(b.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(S.x,",").concat(S.y,"Z")}else w+="L".concat(t,",").concat(r,"Z");return w},tz={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},i5=e=>{var t=gn(e,tz),{cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:c,startAngle:u,endAngle:d,className:f}=t;if(i<a||u===d)return null;var h=It("recharts-sector",f),p=i-a,x=Pn(s,p,0,!0),g;return x>0&&Math.abs(u-d)<360?g=ez({cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:Math.min(x,p/2),forceCornerRadius:o,cornerIsExternal:c,startAngle:u,endAngle:d}):g=a5({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:u,endAngle:d}),N.createElement("path",Ny({},Kn(t),{className:h,d:g}))};function rz(e,t,r){var n,a,i,s;if(e==="horizontal")n=t.x,i=n,a=r.top,s=r.top+r.height;else if(e==="vertical")a=t.y,s=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:o,cy:c,innerRadius:u,outerRadius:d,angle:f}=t,h=Ir(o,c,u,f),p=Ir(o,c,d,f);n=h.x,a=h.y,i=p.x,s=p.y}else return n5(t);return[{x:n,y:a},{x:i,y:s}]}var s5={},o5={},l5={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Bb;function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(l5);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=l5;function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(o5);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=jb,r=o5;function n(a,i,s){s&&typeof s!="number"&&t.isIterateeCall(a,i,s)&&(i=s=void 0),a=r.toFinite(a),i===void 0?(i=a,a=0):i=r.toFinite(i),s=s===void 0?a<i?1:-1:r.toFinite(s);const o=Math.max(Math.ceil((i-a)/(s||1)),0),c=new Array(o);for(let u=0;u<o;u++)c[u]=a,a+=s;return c}e.range=n})(s5);var nz=s5.range;const c5=Es(nz);function co(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function az(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Jb(e){let t,r,n;e.length!==2?(t=co,r=(o,c)=>co(e(o),c),n=(o,c)=>e(o)-c):(t=e===co||e===az?e:iz,r=e,n=e);function a(o,c,u=0,d=o.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(o[f],c)<0?u=f+1:d=f}while(u<d)}return u}function i(o,c,u=0,d=o.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(o[f],c)<=0?u=f+1:d=f}while(u<d)}return u}function s(o,c,u=0,d=o.length){const f=a(o,c,u,d-1);return f>u&&n(o[f-1],c)>-n(o[f],c)?f-1:f}return{left:a,center:s,right:i}}function iz(){return 0}function u5(e){return e===null?NaN:+e}function*sz(e,t){if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(yield r);else{let r=-1;for(let n of e)(n=t(n,++r,e))!=null&&(n=+n)>=n&&(yield n)}}const oz=Jb(co),lz=oz.right;Jb(u5).center;const Df=lz;class u_ extends Map{constructor(t,r=dz){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(d_(this,t))}has(t){return super.has(d_(this,t))}set(t,r){return super.set(cz(this,t),r)}delete(t){return super.delete(uz(this,t))}}function d_({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function cz({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function uz({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function dz(e){return e!==null&&typeof e=="object"?e.valueOf():e}function fz(e=co){if(e===co)return d5;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function d5(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const mz=Math.sqrt(50),hz=Math.sqrt(10),pz=Math.sqrt(2);function uh(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=mz?10:i>=hz?5:i>=pz?2:1;let o,c,u;return a<0?(u=Math.pow(10,-a)/s,o=Math.round(e*u),c=Math.round(t*u),o/u<e&&++o,c/u>t&&--c,u=-u):(u=Math.pow(10,a)*s,o=Math.round(e/u),c=Math.round(t/u),o*u<e&&++o,c*u>t&&--c),c<o&&.5<=r&&r<2?uh(e,t,r*2):[o,c,u]}function Sy(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,s]=n?uh(t,e,r):uh(e,t,r);if(!(i>=a))return[];const o=i-a+1,c=new Array(o);if(n)if(s<0)for(let u=0;u<o;++u)c[u]=(i-u)/-s;else for(let u=0;u<o;++u)c[u]=(i-u)*s;else if(s<0)for(let u=0;u<o;++u)c[u]=(a+u)/-s;else for(let u=0;u<o;++u)c[u]=(a+u)*s;return c}function ky(e,t,r){return t=+t,e=+e,r=+r,uh(e,t,r)[2]}function _y(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?ky(t,e,r):ky(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function f_(e,t){let r;if(t===void 0)for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let a of e)(a=t(a,++n,e))!=null&&(r<a||r===void 0&&a>=a)&&(r=a)}return r}function m_(e,t){let r;if(t===void 0)for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let a of e)(a=t(a,++n,e))!=null&&(r>a||r===void 0&&a>=a)&&(r=a)}return r}function f5(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?d5:fz(a);n>r;){if(n-r>600){const c=n-r+1,u=t-r+1,d=Math.log(c),f=.5*Math.exp(2*d/3),h=.5*Math.sqrt(d*f*(c-f)/c)*(u-c/2<0?-1:1),p=Math.max(r,Math.floor(t-u*f/c+h)),x=Math.min(n,Math.floor(t+(c-u)*f/c+h));f5(e,t,p,x,a)}const i=e[t];let s=r,o=n;for(Hu(e,r,t),a(e[n],i)>0&&Hu(e,r,n);s<o;){for(Hu(e,s,o),++s,--o;a(e[s],i)<0;)++s;for(;a(e[o],i)>0;)--o}a(e[r],i)===0?Hu(e,r,o):(++o,Hu(e,o,n)),o<=t&&(r=o+1),t<=o&&(n=o-1)}return e}function Hu(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function gz(e,t,r){if(e=Float64Array.from(sz(e,r)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return m_(e);if(t>=1)return f_(e);var n,a=(n-1)*t,i=Math.floor(a),s=f_(f5(e,i).subarray(0,i+1)),o=m_(e.subarray(i+1));return s+(o-s)*(a-i)}}function xz(e,t,r=u5){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),s=+r(e[i],i,e),o=+r(e[i+1],i+1,e);return s+(o-s)*(a-i)}}function vz(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function fi(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Ps(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Ey=Symbol("implicit");function Qb(){var e=new u_,t=[],r=[],n=Ey;function a(i){let s=e.get(i);if(s===void 0){if(n!==Ey)return n;e.set(i,s=t.push(i)-1)}return r[s%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new u_;for(const s of i)e.has(s)||e.set(s,t.push(s)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return Qb(t,r).unknown(n)},fi.apply(a,arguments),a}function Zb(){var e=Qb().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,s,o=!1,c=0,u=0,d=.5;delete e.unknown;function f(){var h=t().length,p=a<n,x=p?a:n,g=p?n:a;i=(g-x)/Math.max(1,h-c+u*2),o&&(i=Math.floor(i)),x+=(g-x-i*(h-c))*d,s=i*(1-c),o&&(x=Math.round(x),s=Math.round(s));var y=vz(h).map(function(v){return x+i*v});return r(p?y.reverse():y)}return e.domain=function(h){return arguments.length?(t(h),f()):t()},e.range=function(h){return arguments.length?([n,a]=h,n=+n,a=+a,f()):[n,a]},e.rangeRound=function(h){return[n,a]=h,n=+n,a=+a,o=!0,f()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(h){return arguments.length?(o=!!h,f()):o},e.padding=function(h){return arguments.length?(c=Math.min(1,u=+h),f()):c},e.paddingInner=function(h){return arguments.length?(c=Math.min(1,h),f()):c},e.paddingOuter=function(h){return arguments.length?(u=+h,f()):u},e.align=function(h){return arguments.length?(d=Math.max(0,Math.min(1,h)),f()):d},e.copy=function(){return Zb(t(),[n,a]).round(o).paddingInner(c).paddingOuter(u).align(d)},fi.apply(f(),arguments)}function m5(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return m5(t())},e}function yz(){return m5(Zb.apply(null,arguments).paddingInner(1))}function ew(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function h5(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Rf(){}var qd=.7,dh=1/qd,_c="\\s*([+-]?\\d+)\\s*",Yd="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Gi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",bz=/^#([0-9a-f]{3,8})$/,wz=new RegExp(`^rgb\\(${_c},${_c},${_c}\\)$`),Nz=new RegExp(`^rgb\\(${Gi},${Gi},${Gi}\\)$`),Sz=new RegExp(`^rgba\\(${_c},${_c},${_c},${Yd}\\)$`),kz=new RegExp(`^rgba\\(${Gi},${Gi},${Gi},${Yd}\\)$`),_z=new RegExp(`^hsl\\(${Yd},${Gi},${Gi}\\)$`),Ez=new RegExp(`^hsla\\(${Yd},${Gi},${Gi},${Yd}\\)$`),h_={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ew(Rf,Jd,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:p_,formatHex:p_,formatHex8:Cz,formatHsl:Az,formatRgb:g_,toString:g_});function p_(){return this.rgb().formatHex()}function Cz(){return this.rgb().formatHex8()}function Az(){return p5(this).formatHsl()}function g_(){return this.rgb().formatRgb()}function Jd(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=bz.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?x_(t):r===3?new aa(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?O0(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?O0(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=wz.exec(e))?new aa(t[1],t[2],t[3],1):(t=Nz.exec(e))?new aa(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Sz.exec(e))?O0(t[1],t[2],t[3],t[4]):(t=kz.exec(e))?O0(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=_z.exec(e))?b_(t[1],t[2]/100,t[3]/100,1):(t=Ez.exec(e))?b_(t[1],t[2]/100,t[3]/100,t[4]):h_.hasOwnProperty(e)?x_(h_[e]):e==="transparent"?new aa(NaN,NaN,NaN,0):null}function x_(e){return new aa(e>>16&255,e>>8&255,e&255,1)}function O0(e,t,r,n){return n<=0&&(e=t=r=NaN),new aa(e,t,r,n)}function Tz(e){return e instanceof Rf||(e=Jd(e)),e?(e=e.rgb(),new aa(e.r,e.g,e.b,e.opacity)):new aa}function Cy(e,t,r,n){return arguments.length===1?Tz(e):new aa(e,t,r,n??1)}function aa(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}ew(aa,Cy,h5(Rf,{brighter(e){return e=e==null?dh:Math.pow(dh,e),new aa(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?qd:Math.pow(qd,e),new aa(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new aa(nl(this.r),nl(this.g),nl(this.b),fh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:v_,formatHex:v_,formatHex8:Pz,formatRgb:y_,toString:y_}));function v_(){return`#${Yo(this.r)}${Yo(this.g)}${Yo(this.b)}`}function Pz(){return`#${Yo(this.r)}${Yo(this.g)}${Yo(this.b)}${Yo((isNaN(this.opacity)?1:this.opacity)*255)}`}function y_(){const e=fh(this.opacity);return`${e===1?"rgb(":"rgba("}${nl(this.r)}, ${nl(this.g)}, ${nl(this.b)}${e===1?")":`, ${e})`}`}function fh(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function nl(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Yo(e){return e=nl(e),(e<16?"0":"")+e.toString(16)}function b_(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new wi(e,t,r,n)}function p5(e){if(e instanceof wi)return new wi(e.h,e.s,e.l,e.opacity);if(e instanceof Rf||(e=Jd(e)),!e)return new wi;if(e instanceof wi)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),s=NaN,o=i-a,c=(i+a)/2;return o?(t===i?s=(r-n)/o+(r<n)*6:r===i?s=(n-t)/o+2:s=(t-r)/o+4,o/=c<.5?i+a:2-i-a,s*=60):o=c>0&&c<1?0:s,new wi(s,o,c,e.opacity)}function Oz(e,t,r,n){return arguments.length===1?p5(e):new wi(e,t,r,n??1)}function wi(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}ew(wi,Oz,h5(Rf,{brighter(e){return e=e==null?dh:Math.pow(dh,e),new wi(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?qd:Math.pow(qd,e),new wi(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new aa(yx(e>=240?e-240:e+120,a,n),yx(e,a,n),yx(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new wi(w_(this.h),D0(this.s),D0(this.l),fh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=fh(this.opacity);return`${e===1?"hsl(":"hsla("}${w_(this.h)}, ${D0(this.s)*100}%, ${D0(this.l)*100}%${e===1?")":`, ${e})`}`}}));function w_(e){return e=(e||0)%360,e<0?e+360:e}function D0(e){return Math.max(0,Math.min(1,e||0))}function yx(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const tw=e=>()=>e;function Dz(e,t){return function(r){return e+r*t}}function Rz(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function Mz(e){return(e=+e)==1?g5:function(t,r){return r-t?Rz(t,r,e):tw(isNaN(t)?r:t)}}function g5(e,t){var r=t-e;return r?Dz(e,r):tw(isNaN(e)?t:e)}const N_=function e(t){var r=Mz(t);function n(a,i){var s=r((a=Cy(a)).r,(i=Cy(i)).r),o=r(a.g,i.g),c=r(a.b,i.b),u=g5(a.opacity,i.opacity);return function(d){return a.r=s(d),a.g=o(d),a.b=c(d),a.opacity=u(d),a+""}}return n.gamma=e,n}(1);function Iz(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function Fz(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Lz(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=cu(e[s],t[s]);for(;s<r;++s)i[s]=t[s];return function(o){for(s=0;s<n;++s)i[s]=a[s](o);return i}}function Bz(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function mh(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function jz(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=cu(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var Ay=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,bx=new RegExp(Ay.source,"g");function $z(e){return function(){return e}}function Uz(e){return function(t){return e(t)+""}}function zz(e,t){var r=Ay.lastIndex=bx.lastIndex=0,n,a,i,s=-1,o=[],c=[];for(e=e+"",t=t+"";(n=Ay.exec(e))&&(a=bx.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),o[s]?o[s]+=i:o[++s]=i),(n=n[0])===(a=a[0])?o[s]?o[s]+=a:o[++s]=a:(o[++s]=null,c.push({i:s,x:mh(n,a)})),r=bx.lastIndex;return r<t.length&&(i=t.slice(r),o[s]?o[s]+=i:o[++s]=i),o.length<2?c[0]?Uz(c[0].x):$z(t):(t=c.length,function(u){for(var d=0,f;d<t;++d)o[(f=c[d]).i]=f.x(u);return o.join("")})}function cu(e,t){var r=typeof t,n;return t==null||r==="boolean"?tw(t):(r==="number"?mh:r==="string"?(n=Jd(t))?(t=n,N_):zz:t instanceof Jd?N_:t instanceof Date?Bz:Fz(t)?Iz:Array.isArray(t)?Lz:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?jz:mh)(e,t)}function rw(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function Hz(e,t){t===void 0&&(t=e,e=cu);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(s){var o=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return i[o](s-o)}}function Wz(e){return function(){return e}}function hh(e){return+e}var S_=[0,1];function Hn(e){return e}function Ty(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:Wz(isNaN(t)?NaN:.5)}function Gz(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function Vz(e,t,r){var n=e[0],a=e[1],i=t[0],s=t[1];return a<n?(n=Ty(a,n),i=r(s,i)):(n=Ty(n,a),i=r(i,s)),function(o){return i(n(o))}}function Kz(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)a[s]=Ty(e[s],e[s+1]),i[s]=r(t[s],t[s+1]);return function(o){var c=Df(e,o,1,n)-1;return i[c](a[c](o))}}function Mf(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function jp(){var e=S_,t=S_,r=cu,n,a,i,s=Hn,o,c,u;function d(){var h=Math.min(e.length,t.length);return s!==Hn&&(s=Gz(e[0],e[h-1])),o=h>2?Kz:Vz,c=u=null,f}function f(h){return h==null||isNaN(h=+h)?i:(c||(c=o(e.map(n),t,r)))(n(s(h)))}return f.invert=function(h){return s(a((u||(u=o(t,e.map(n),mh)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,hh),d()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),d()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),r=rw,d()},f.clamp=function(h){return arguments.length?(s=h?!0:Hn,d()):s!==Hn},f.interpolate=function(h){return arguments.length?(r=h,d()):r},f.unknown=function(h){return arguments.length?(i=h,f):i},function(h,p){return n=h,a=p,d()}}function nw(){return jp()(Hn,Hn)}function Xz(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function ph(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Vc(e){return e=ph(Math.abs(e)),e?e[1]:NaN}function qz(e,t){return function(r,n){for(var a=r.length,i=[],s=0,o=e[0],c=0;a>0&&o>0&&(c+o+1>n&&(o=Math.max(1,n-c)),i.push(r.substring(a-=o,a+o)),!((c+=o+1)>n));)o=e[s=(s+1)%e.length];return i.reverse().join(t)}}function Yz(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var Jz=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Qd(e){if(!(t=Jz.exec(e)))throw new Error("invalid format: "+e);var t;return new aw({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Qd.prototype=aw.prototype;function aw(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}aw.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Qz(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var x5;function Zz(e,t){var r=ph(e,t);if(!r)return e+"";var n=r[0],a=r[1],i=a-(x5=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+ph(e,Math.max(0,t+i-1))[0]}function k_(e,t){var r=ph(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const __={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Xz,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>k_(e*100,t),r:k_,s:Zz,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function E_(e){return e}var C_=Array.prototype.map,A_=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function eH(e){var t=e.grouping===void 0||e.thousands===void 0?E_:qz(C_.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?E_:Yz(C_.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(f){f=Qd(f);var h=f.fill,p=f.align,x=f.sign,g=f.symbol,y=f.zero,v=f.width,w=f.comma,b=f.precision,S=f.trim,k=f.type;k==="n"?(w=!0,k="g"):__[k]||(b===void 0&&(b=12),S=!0,k="g"),(y||h==="0"&&p==="=")&&(y=!0,h="0",p="=");var _=g==="$"?r:g==="#"&&/[boxX]/.test(k)?"0"+k.toLowerCase():"",E=g==="$"?n:/[%p]/.test(k)?s:"",P=__[k],A=/[defgprs%]/.test(k);b=b===void 0?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function T(R){var D=_,L=E,z,X,Y;if(k==="c")L=P(R)+L,R="";else{R=+R;var q=R<0||1/R<0;if(R=isNaN(R)?c:P(Math.abs(R),b),S&&(R=Qz(R)),q&&+R==0&&x!=="+"&&(q=!1),D=(q?x==="("?x:o:x==="-"||x==="("?"":x)+D,L=(k==="s"?A_[8+x5/3]:"")+L+(q&&x==="("?")":""),A){for(z=-1,X=R.length;++z<X;)if(Y=R.charCodeAt(z),48>Y||Y>57){L=(Y===46?a+R.slice(z+1):R.slice(z))+L,R=R.slice(0,z);break}}}w&&!y&&(R=t(R,1/0));var ee=D.length+R.length+L.length,V=ee<v?new Array(v-ee+1).join(h):"";switch(w&&y&&(R=t(V+R,V.length?v-L.length:1/0),V=""),p){case"<":R=D+R+L+V;break;case"=":R=D+V+R+L;break;case"^":R=V.slice(0,ee=V.length>>1)+D+R+L+V.slice(ee);break;default:R=V+D+R+L;break}return i(R)}return T.toString=function(){return f+""},T}function d(f,h){var p=u((f=Qd(f),f.type="f",f)),x=Math.max(-8,Math.min(8,Math.floor(Vc(h)/3)))*3,g=Math.pow(10,-x),y=A_[8+x/3];return function(v){return p(g*v)+y}}return{format:u,formatPrefix:d}}var R0,iw,v5;tH({thousands:",",grouping:[3],currency:["$",""]});function tH(e){return R0=eH(e),iw=R0.format,v5=R0.formatPrefix,R0}function rH(e){return Math.max(0,-Vc(Math.abs(e)))}function nH(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Vc(t)/3)))*3-Vc(Math.abs(e)))}function aH(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Vc(t)-Vc(e))+1}function y5(e,t,r,n){var a=_y(e,t,r),i;switch(n=Qd(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=nH(a,s))&&(n.precision=i),v5(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=aH(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=rH(a))&&(n.precision=i-(n.type==="%")*2);break}}return iw(n)}function To(e){var t=e.domain;return e.ticks=function(r){var n=t();return Sy(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return y5(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,s=n[a],o=n[i],c,u,d=10;for(o<s&&(u=s,s=o,o=u,u=a,a=i,i=u);d-- >0;){if(u=ky(s,o,r),u===c)return n[a]=s,n[i]=o,t(n);if(u>0)s=Math.floor(s/u)*u,o=Math.ceil(o/u)*u;else if(u<0)s=Math.ceil(s*u)/u,o=Math.floor(o*u)/u;else break;c=u}return e},e}function b5(){var e=nw();return e.copy=function(){return Mf(e,b5())},fi.apply(e,arguments),To(e)}function w5(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,hh),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return w5(e).unknown(t)},e=arguments.length?Array.from(e,hh):[0,1],To(r)}function N5(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],s;return i<a&&(s=r,r=n,n=s,s=a,a=i,i=s),e[r]=t.floor(a),e[n]=t.ceil(i),e}function T_(e){return Math.log(e)}function P_(e){return Math.exp(e)}function iH(e){return-Math.log(-e)}function sH(e){return-Math.exp(-e)}function oH(e){return isFinite(e)?+("1e"+e):e<0?0:e}function lH(e){return e===10?oH:e===Math.E?Math.exp:t=>Math.pow(e,t)}function cH(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function O_(e){return(t,r)=>-e(-t,r)}function sw(e){const t=e(T_,P_),r=t.domain;let n=10,a,i;function s(){return a=cH(n),i=lH(n),r()[0]<0?(a=O_(a),i=O_(i),e(iH,sH)):e(T_,P_),t}return t.base=function(o){return arguments.length?(n=+o,s()):n},t.domain=function(o){return arguments.length?(r(o),s()):r()},t.ticks=o=>{const c=r();let u=c[0],d=c[c.length-1];const f=d<u;f&&([u,d]=[d,u]);let h=a(u),p=a(d),x,g;const y=o==null?10:+o;let v=[];if(!(n%1)&&p-h<y){if(h=Math.floor(h),p=Math.ceil(p),u>0){for(;h<=p;++h)for(x=1;x<n;++x)if(g=h<0?x/i(-h):x*i(h),!(g<u)){if(g>d)break;v.push(g)}}else for(;h<=p;++h)for(x=n-1;x>=1;--x)if(g=h>0?x/i(-h):x*i(h),!(g<u)){if(g>d)break;v.push(g)}v.length*2<y&&(v=Sy(u,d,y))}else v=Sy(h,p,Math.min(p-h,y)).map(i);return f?v.reverse():v},t.tickFormat=(o,c)=>{if(o==null&&(o=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=Qd(c)).precision==null&&(c.trim=!0),c=iw(c)),o===1/0)return c;const u=Math.max(1,n*o/t.ticks().length);return d=>{let f=d/i(Math.round(a(d)));return f*n<n-.5&&(f*=n),f<=u?c(d):""}},t.nice=()=>r(N5(r(),{floor:o=>i(Math.floor(a(o))),ceil:o=>i(Math.ceil(a(o)))})),t}function S5(){const e=sw(jp()).domain([1,10]);return e.copy=()=>Mf(e,S5()).base(e.base()),fi.apply(e,arguments),e}function D_(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function R_(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function ow(e){var t=1,r=e(D_(t),R_(t));return r.constant=function(n){return arguments.length?e(D_(t=+n),R_(t)):t},To(r)}function k5(){var e=ow(jp());return e.copy=function(){return Mf(e,k5()).constant(e.constant())},fi.apply(e,arguments)}function M_(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function uH(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function dH(e){return e<0?-e*e:e*e}function lw(e){var t=e(Hn,Hn),r=1;function n(){return r===1?e(Hn,Hn):r===.5?e(uH,dH):e(M_(r),M_(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},To(t)}function cw(){var e=lw(jp());return e.copy=function(){return Mf(e,cw()).exponent(e.exponent())},fi.apply(e,arguments),e}function fH(){return cw.apply(null,arguments).exponent(.5)}function I_(e){return Math.sign(e)*e*e}function mH(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function _5(){var e=nw(),t=[0,1],r=!1,n;function a(i){var s=mH(e(i));return isNaN(s)?n:r?Math.round(s):s}return a.invert=function(i){return e.invert(I_(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,hh)).map(I_)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return _5(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},fi.apply(a,arguments),To(a)}function E5(){var e=[],t=[],r=[],n;function a(){var s=0,o=Math.max(1,t.length);for(r=new Array(o-1);++s<o;)r[s-1]=xz(e,s/o);return i}function i(s){return s==null||isNaN(s=+s)?n:t[Df(r,s)]}return i.invertExtent=function(s){var o=t.indexOf(s);return o<0?[NaN,NaN]:[o>0?r[o-1]:e[0],o<r.length?r[o]:e[e.length-1]]},i.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let o of s)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(co),a()},i.range=function(s){return arguments.length?(t=Array.from(s),a()):t.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return E5().domain(e).range(t).unknown(n)},fi.apply(i,arguments)}function C5(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function s(c){return c!=null&&c<=c?a[Df(n,c,0,r)]:i}function o(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return s}return s.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,o()):[e,t]},s.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,o()):a.slice()},s.invertExtent=function(c){var u=a.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},s.unknown=function(c){return arguments.length&&(i=c),s},s.thresholds=function(){return n.slice()},s.copy=function(){return C5().domain([e,t]).range(a).unknown(i)},fi.apply(To(s),arguments)}function A5(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[Df(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var s=t.indexOf(i);return[e[s-1],e[s]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return A5().domain(e).range(t).unknown(r)},fi.apply(a,arguments)}const wx=new Date,Nx=new Date;function Gr(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const s=a(i),o=a.ceil(i);return i-s<o-i?s:o},a.offset=(i,s)=>(t(i=new Date(+i),s==null?1:Math.floor(s)),i),a.range=(i,s,o)=>{const c=[];if(i=a.ceil(i),o=o==null?1:Math.floor(o),!(i<s)||!(o>0))return c;let u;do c.push(u=new Date(+i)),t(i,o),e(i);while(u<i&&i<s);return c},a.filter=i=>Gr(s=>{if(s>=s)for(;e(s),!i(s);)s.setTime(s-1)},(s,o)=>{if(s>=s)if(o<0)for(;++o<=0;)for(;t(s,-1),!i(s););else for(;--o>=0;)for(;t(s,1),!i(s););}),r&&(a.count=(i,s)=>(wx.setTime(+i),Nx.setTime(+s),e(wx),e(Nx),Math.floor(r(wx,Nx))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?s=>n(s)%i===0:s=>a.count(0,s)%i===0):a)),a}const gh=Gr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);gh.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Gr(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):gh);gh.range;const cs=1e3,ni=cs*60,us=ni*60,Ss=us*24,uw=Ss*7,F_=Ss*30,Sx=Ss*365,Jo=Gr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*cs)},(e,t)=>(t-e)/cs,e=>e.getUTCSeconds());Jo.range;const dw=Gr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*cs)},(e,t)=>{e.setTime(+e+t*ni)},(e,t)=>(t-e)/ni,e=>e.getMinutes());dw.range;const fw=Gr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*ni)},(e,t)=>(t-e)/ni,e=>e.getUTCMinutes());fw.range;const mw=Gr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*cs-e.getMinutes()*ni)},(e,t)=>{e.setTime(+e+t*us)},(e,t)=>(t-e)/us,e=>e.getHours());mw.range;const hw=Gr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*us)},(e,t)=>(t-e)/us,e=>e.getUTCHours());hw.range;const If=Gr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*ni)/Ss,e=>e.getDate()-1);If.range;const $p=Gr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ss,e=>e.getUTCDate()-1);$p.range;const T5=Gr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ss,e=>Math.floor(e/Ss));T5.range;function Fl(e){return Gr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*ni)/uw)}const Up=Fl(0),xh=Fl(1),hH=Fl(2),pH=Fl(3),Kc=Fl(4),gH=Fl(5),xH=Fl(6);Up.range;xh.range;hH.range;pH.range;Kc.range;gH.range;xH.range;function Ll(e){return Gr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/uw)}const zp=Ll(0),vh=Ll(1),vH=Ll(2),yH=Ll(3),Xc=Ll(4),bH=Ll(5),wH=Ll(6);zp.range;vh.range;vH.range;yH.range;Xc.range;bH.range;wH.range;const pw=Gr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());pw.range;const gw=Gr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());gw.range;const ks=Gr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());ks.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Gr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});ks.range;const _s=Gr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());_s.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Gr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});_s.range;function P5(e,t,r,n,a,i){const s=[[Jo,1,cs],[Jo,5,5*cs],[Jo,15,15*cs],[Jo,30,30*cs],[i,1,ni],[i,5,5*ni],[i,15,15*ni],[i,30,30*ni],[a,1,us],[a,3,3*us],[a,6,6*us],[a,12,12*us],[n,1,Ss],[n,2,2*Ss],[r,1,uw],[t,1,F_],[t,3,3*F_],[e,1,Sx]];function o(u,d,f){const h=d<u;h&&([u,d]=[d,u]);const p=f&&typeof f.range=="function"?f:c(u,d,f),x=p?p.range(u,+d+1):[];return h?x.reverse():x}function c(u,d,f){const h=Math.abs(d-u)/f,p=Jb(([,,y])=>y).right(s,h);if(p===s.length)return e.every(_y(u/Sx,d/Sx,f));if(p===0)return gh.every(Math.max(_y(u,d,f),1));const[x,g]=s[h/s[p-1][2]<s[p][2]/h?p-1:p];return x.every(g)}return[o,c]}const[NH,SH]=P5(_s,gw,zp,T5,hw,fw),[kH,_H]=P5(ks,pw,Up,If,mw,dw);function kx(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function _x(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Wu(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function EH(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,s=e.shortDays,o=e.months,c=e.shortMonths,u=Gu(a),d=Vu(a),f=Gu(i),h=Vu(i),p=Gu(s),x=Vu(s),g=Gu(o),y=Vu(o),v=Gu(c),w=Vu(c),b={a:q,A:ee,b:V,B:ae,c:null,d:z_,e:z_,f:qH,g:iW,G:oW,H:VH,I:KH,j:XH,L:O5,m:YH,M:JH,p:oe,q:I,Q:G_,s:V_,S:QH,u:ZH,U:eW,V:tW,w:rW,W:nW,x:null,X:null,y:aW,Y:sW,Z:lW,"%":W_},S={a:W,A:U,b:G,B:ne,c:null,d:H_,e:H_,f:fW,g:NW,G:kW,H:cW,I:uW,j:dW,L:R5,m:mW,M:hW,p:K,q:le,Q:G_,s:V_,S:pW,u:gW,U:xW,V:vW,w:yW,W:bW,x:null,X:null,y:wW,Y:SW,Z:_W,"%":W_},k={a:T,A:R,b:D,B:L,c:z,d:$_,e:$_,f:zH,g:j_,G:B_,H:U_,I:U_,j:BH,L:UH,m:LH,M:jH,p:A,q:FH,Q:WH,s:GH,S:$H,u:OH,U:DH,V:RH,w:PH,W:MH,x:X,X:Y,y:j_,Y:B_,Z:IH,"%":HH};b.x=_(r,b),b.X=_(n,b),b.c=_(t,b),S.x=_(r,S),S.X=_(n,S),S.c=_(t,S);function _(Q,ce){return function(be){var j=[],$e=-1,Ee=0,Ae=Q.length,Be,we,de;for(be instanceof Date||(be=new Date(+be));++$e<Ae;)Q.charCodeAt($e)===37&&(j.push(Q.slice(Ee,$e)),(we=L_[Be=Q.charAt(++$e)])!=null?Be=Q.charAt(++$e):we=Be==="e"?" ":"0",(de=ce[Be])&&(Be=de(be,we)),j.push(Be),Ee=$e+1);return j.push(Q.slice(Ee,$e)),j.join("")}}function E(Q,ce){return function(be){var j=Wu(1900,void 0,1),$e=P(j,Q,be+="",0),Ee,Ae;if($e!=be.length)return null;if("Q"in j)return new Date(j.Q);if("s"in j)return new Date(j.s*1e3+("L"in j?j.L:0));if(ce&&!("Z"in j)&&(j.Z=0),"p"in j&&(j.H=j.H%12+j.p*12),j.m===void 0&&(j.m="q"in j?j.q:0),"V"in j){if(j.V<1||j.V>53)return null;"w"in j||(j.w=1),"Z"in j?(Ee=_x(Wu(j.y,0,1)),Ae=Ee.getUTCDay(),Ee=Ae>4||Ae===0?vh.ceil(Ee):vh(Ee),Ee=$p.offset(Ee,(j.V-1)*7),j.y=Ee.getUTCFullYear(),j.m=Ee.getUTCMonth(),j.d=Ee.getUTCDate()+(j.w+6)%7):(Ee=kx(Wu(j.y,0,1)),Ae=Ee.getDay(),Ee=Ae>4||Ae===0?xh.ceil(Ee):xh(Ee),Ee=If.offset(Ee,(j.V-1)*7),j.y=Ee.getFullYear(),j.m=Ee.getMonth(),j.d=Ee.getDate()+(j.w+6)%7)}else("W"in j||"U"in j)&&("w"in j||(j.w="u"in j?j.u%7:"W"in j?1:0),Ae="Z"in j?_x(Wu(j.y,0,1)).getUTCDay():kx(Wu(j.y,0,1)).getDay(),j.m=0,j.d="W"in j?(j.w+6)%7+j.W*7-(Ae+5)%7:j.w+j.U*7-(Ae+6)%7);return"Z"in j?(j.H+=j.Z/100|0,j.M+=j.Z%100,_x(j)):kx(j)}}function P(Q,ce,be,j){for(var $e=0,Ee=ce.length,Ae=be.length,Be,we;$e<Ee;){if(j>=Ae)return-1;if(Be=ce.charCodeAt($e++),Be===37){if(Be=ce.charAt($e++),we=k[Be in L_?ce.charAt($e++):Be],!we||(j=we(Q,be,j))<0)return-1}else if(Be!=be.charCodeAt(j++))return-1}return j}function A(Q,ce,be){var j=u.exec(ce.slice(be));return j?(Q.p=d.get(j[0].toLowerCase()),be+j[0].length):-1}function T(Q,ce,be){var j=p.exec(ce.slice(be));return j?(Q.w=x.get(j[0].toLowerCase()),be+j[0].length):-1}function R(Q,ce,be){var j=f.exec(ce.slice(be));return j?(Q.w=h.get(j[0].toLowerCase()),be+j[0].length):-1}function D(Q,ce,be){var j=v.exec(ce.slice(be));return j?(Q.m=w.get(j[0].toLowerCase()),be+j[0].length):-1}function L(Q,ce,be){var j=g.exec(ce.slice(be));return j?(Q.m=y.get(j[0].toLowerCase()),be+j[0].length):-1}function z(Q,ce,be){return P(Q,t,ce,be)}function X(Q,ce,be){return P(Q,r,ce,be)}function Y(Q,ce,be){return P(Q,n,ce,be)}function q(Q){return s[Q.getDay()]}function ee(Q){return i[Q.getDay()]}function V(Q){return c[Q.getMonth()]}function ae(Q){return o[Q.getMonth()]}function oe(Q){return a[+(Q.getHours()>=12)]}function I(Q){return 1+~~(Q.getMonth()/3)}function W(Q){return s[Q.getUTCDay()]}function U(Q){return i[Q.getUTCDay()]}function G(Q){return c[Q.getUTCMonth()]}function ne(Q){return o[Q.getUTCMonth()]}function K(Q){return a[+(Q.getUTCHours()>=12)]}function le(Q){return 1+~~(Q.getUTCMonth()/3)}return{format:function(Q){var ce=_(Q+="",b);return ce.toString=function(){return Q},ce},parse:function(Q){var ce=E(Q+="",!1);return ce.toString=function(){return Q},ce},utcFormat:function(Q){var ce=_(Q+="",S);return ce.toString=function(){return Q},ce},utcParse:function(Q){var ce=E(Q+="",!0);return ce.toString=function(){return Q},ce}}}var L_={"-":"",_:" ",0:"0"},sn=/^\s*\d+/,CH=/^%/,AH=/[\\^$*+?|[\]().{}]/g;function Ft(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function TH(e){return e.replace(AH,"\\$&")}function Gu(e){return new RegExp("^(?:"+e.map(TH).join("|")+")","i")}function Vu(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function PH(e,t,r){var n=sn.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function OH(e,t,r){var n=sn.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function DH(e,t,r){var n=sn.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function RH(e,t,r){var n=sn.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function MH(e,t,r){var n=sn.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function B_(e,t,r){var n=sn.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function j_(e,t,r){var n=sn.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function IH(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function FH(e,t,r){var n=sn.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function LH(e,t,r){var n=sn.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function $_(e,t,r){var n=sn.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function BH(e,t,r){var n=sn.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function U_(e,t,r){var n=sn.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function jH(e,t,r){var n=sn.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function $H(e,t,r){var n=sn.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function UH(e,t,r){var n=sn.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function zH(e,t,r){var n=sn.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function HH(e,t,r){var n=CH.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function WH(e,t,r){var n=sn.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function GH(e,t,r){var n=sn.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function z_(e,t){return Ft(e.getDate(),t,2)}function VH(e,t){return Ft(e.getHours(),t,2)}function KH(e,t){return Ft(e.getHours()%12||12,t,2)}function XH(e,t){return Ft(1+If.count(ks(e),e),t,3)}function O5(e,t){return Ft(e.getMilliseconds(),t,3)}function qH(e,t){return O5(e,t)+"000"}function YH(e,t){return Ft(e.getMonth()+1,t,2)}function JH(e,t){return Ft(e.getMinutes(),t,2)}function QH(e,t){return Ft(e.getSeconds(),t,2)}function ZH(e){var t=e.getDay();return t===0?7:t}function eW(e,t){return Ft(Up.count(ks(e)-1,e),t,2)}function D5(e){var t=e.getDay();return t>=4||t===0?Kc(e):Kc.ceil(e)}function tW(e,t){return e=D5(e),Ft(Kc.count(ks(e),e)+(ks(e).getDay()===4),t,2)}function rW(e){return e.getDay()}function nW(e,t){return Ft(xh.count(ks(e)-1,e),t,2)}function aW(e,t){return Ft(e.getFullYear()%100,t,2)}function iW(e,t){return e=D5(e),Ft(e.getFullYear()%100,t,2)}function sW(e,t){return Ft(e.getFullYear()%1e4,t,4)}function oW(e,t){var r=e.getDay();return e=r>=4||r===0?Kc(e):Kc.ceil(e),Ft(e.getFullYear()%1e4,t,4)}function lW(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ft(t/60|0,"0",2)+Ft(t%60,"0",2)}function H_(e,t){return Ft(e.getUTCDate(),t,2)}function cW(e,t){return Ft(e.getUTCHours(),t,2)}function uW(e,t){return Ft(e.getUTCHours()%12||12,t,2)}function dW(e,t){return Ft(1+$p.count(_s(e),e),t,3)}function R5(e,t){return Ft(e.getUTCMilliseconds(),t,3)}function fW(e,t){return R5(e,t)+"000"}function mW(e,t){return Ft(e.getUTCMonth()+1,t,2)}function hW(e,t){return Ft(e.getUTCMinutes(),t,2)}function pW(e,t){return Ft(e.getUTCSeconds(),t,2)}function gW(e){var t=e.getUTCDay();return t===0?7:t}function xW(e,t){return Ft(zp.count(_s(e)-1,e),t,2)}function M5(e){var t=e.getUTCDay();return t>=4||t===0?Xc(e):Xc.ceil(e)}function vW(e,t){return e=M5(e),Ft(Xc.count(_s(e),e)+(_s(e).getUTCDay()===4),t,2)}function yW(e){return e.getUTCDay()}function bW(e,t){return Ft(vh.count(_s(e)-1,e),t,2)}function wW(e,t){return Ft(e.getUTCFullYear()%100,t,2)}function NW(e,t){return e=M5(e),Ft(e.getUTCFullYear()%100,t,2)}function SW(e,t){return Ft(e.getUTCFullYear()%1e4,t,4)}function kW(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Xc(e):Xc.ceil(e),Ft(e.getUTCFullYear()%1e4,t,4)}function _W(){return"+0000"}function W_(){return"%"}function G_(e){return+e}function V_(e){return Math.floor(+e/1e3)}var Xl,I5,F5;EW({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function EW(e){return Xl=EH(e),I5=Xl.format,Xl.parse,F5=Xl.utcFormat,Xl.utcParse,Xl}function CW(e){return new Date(e)}function AW(e){return e instanceof Date?+e:+new Date(+e)}function xw(e,t,r,n,a,i,s,o,c,u){var d=nw(),f=d.invert,h=d.domain,p=u(".%L"),x=u(":%S"),g=u("%I:%M"),y=u("%I %p"),v=u("%a %d"),w=u("%b %d"),b=u("%B"),S=u("%Y");function k(_){return(c(_)<_?p:o(_)<_?x:s(_)<_?g:i(_)<_?y:n(_)<_?a(_)<_?v:w:r(_)<_?b:S)(_)}return d.invert=function(_){return new Date(f(_))},d.domain=function(_){return arguments.length?h(Array.from(_,AW)):h().map(CW)},d.ticks=function(_){var E=h();return e(E[0],E[E.length-1],_??10)},d.tickFormat=function(_,E){return E==null?k:u(E)},d.nice=function(_){var E=h();return(!_||typeof _.range!="function")&&(_=t(E[0],E[E.length-1],_??10)),_?h(N5(E,_)):d},d.copy=function(){return Mf(d,xw(e,t,r,n,a,i,s,o,c,u))},d}function TW(){return fi.apply(xw(kH,_H,ks,pw,Up,If,mw,dw,Jo,I5).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function PW(){return fi.apply(xw(NH,SH,_s,gw,zp,$p,hw,fw,Jo,F5).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Hp(){var e=0,t=1,r,n,a,i,s=Hn,o=!1,c;function u(f){return f==null||isNaN(f=+f)?c:s(a===0?.5:(f=(i(f)-r)*a,o?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(f){return arguments.length?(o=!!f,u):o},u.interpolator=function(f){return arguments.length?(s=f,u):s};function d(f){return function(h){var p,x;return arguments.length?([p,x]=h,s=f(p,x),u):[s(0),s(1)]}}return u.range=d(cu),u.rangeRound=d(rw),u.unknown=function(f){return arguments.length?(c=f,u):c},function(f){return i=f,r=f(e),n=f(t),a=r===n?0:1/(n-r),u}}function Po(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function L5(){var e=To(Hp()(Hn));return e.copy=function(){return Po(e,L5())},Ps.apply(e,arguments)}function B5(){var e=sw(Hp()).domain([1,10]);return e.copy=function(){return Po(e,B5()).base(e.base())},Ps.apply(e,arguments)}function j5(){var e=ow(Hp());return e.copy=function(){return Po(e,j5()).constant(e.constant())},Ps.apply(e,arguments)}function vw(){var e=lw(Hp());return e.copy=function(){return Po(e,vw()).exponent(e.exponent())},Ps.apply(e,arguments)}function OW(){return vw.apply(null,arguments).exponent(.5)}function $5(){var e=[],t=Hn;function r(n){if(n!=null&&!isNaN(n=+n))return t((Df(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(co),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>gz(e,i/n))},r.copy=function(){return $5(t).domain(e)},Ps.apply(r,arguments)}function Wp(){var e=0,t=.5,r=1,n=1,a,i,s,o,c,u=Hn,d,f=!1,h;function p(g){return isNaN(g=+g)?h:(g=.5+((g=+d(g))-i)*(n*g<n*i?o:c),u(f?Math.max(0,Math.min(1,g)):g))}p.domain=function(g){return arguments.length?([e,t,r]=g,a=d(e=+e),i=d(t=+t),s=d(r=+r),o=a===i?0:.5/(i-a),c=i===s?0:.5/(s-i),n=i<a?-1:1,p):[e,t,r]},p.clamp=function(g){return arguments.length?(f=!!g,p):f},p.interpolator=function(g){return arguments.length?(u=g,p):u};function x(g){return function(y){var v,w,b;return arguments.length?([v,w,b]=y,u=Hz(g,[v,w,b]),p):[u(0),u(.5),u(1)]}}return p.range=x(cu),p.rangeRound=x(rw),p.unknown=function(g){return arguments.length?(h=g,p):h},function(g){return d=g,a=g(e),i=g(t),s=g(r),o=a===i?0:.5/(i-a),c=i===s?0:.5/(s-i),n=i<a?-1:1,p}}function U5(){var e=To(Wp()(Hn));return e.copy=function(){return Po(e,U5())},Ps.apply(e,arguments)}function z5(){var e=sw(Wp()).domain([.1,1,10]);return e.copy=function(){return Po(e,z5()).base(e.base())},Ps.apply(e,arguments)}function H5(){var e=ow(Wp());return e.copy=function(){return Po(e,H5()).constant(e.constant())},Ps.apply(e,arguments)}function yw(){var e=lw(Wp());return e.copy=function(){return Po(e,yw()).exponent(e.exponent())},Ps.apply(e,arguments)}function DW(){return yw.apply(null,arguments).exponent(.5)}const ed=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Zb,scaleDiverging:U5,scaleDivergingLog:z5,scaleDivergingPow:yw,scaleDivergingSqrt:DW,scaleDivergingSymlog:H5,scaleIdentity:w5,scaleImplicit:Ey,scaleLinear:b5,scaleLog:S5,scaleOrdinal:Qb,scalePoint:yz,scalePow:cw,scaleQuantile:E5,scaleQuantize:C5,scaleRadial:_5,scaleSequential:L5,scaleSequentialLog:B5,scaleSequentialPow:vw,scaleSequentialQuantile:$5,scaleSequentialSqrt:OW,scaleSequentialSymlog:j5,scaleSqrt:fH,scaleSymlog:k5,scaleThreshold:A5,scaleTime:TW,scaleUtc:PW,tickFormat:y5},Symbol.toStringTag,{value:"Module"}));var Oo=e=>e.chartData,bw=me([Oo],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),Gp=(e,t,r,n)=>n?bw(e):Oo(e);function bl(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(Mn(t)&&Mn(r))return!0}return!1}function K_(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function W5(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,a,i;if(Mn(r))a=r;else if(typeof r=="function")return;if(Mn(n))i=n;else if(typeof n=="function")return;var s=[a,i];if(bl(s))return s}}function RW(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(bl(n))return K_(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[a,i]=e,s,o;if(a==="auto")t!=null&&(s=Math.min(...t));else if(Je(a))s=a;else if(typeof a=="function")try{t!=null&&(s=a(t==null?void 0:t[0]))}catch{}else if(typeof a=="string"&&Bk.test(a)){var c=Bk.exec(a);if(c==null||t==null)s=void 0;else{var u=+c[1];s=t[0]-u}}else s=t==null?void 0:t[0];if(i==="auto")t!=null&&(o=Math.max(...t));else if(Je(i))o=i;else if(typeof i=="function")try{t!=null&&(o=i(t==null?void 0:t[1]))}catch{}else if(typeof i=="string"&&jk.test(i)){var d=jk.exec(i);if(d==null||t==null)o=void 0;else{var f=+d[1];o=t[1]+f}}else o=t==null?void 0:t[1];var h=[s,o];if(bl(h))return t==null?h:K_(h,t,r)}}}var uu=1e9,MW={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Nw,sr=!0,di="[DecimalError] ",al=di+"Invalid argument: ",ww=di+"Exponent out of range: ",du=Math.floor,zo=Math.pow,IW=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ya,qr=1e7,Qt=7,G5=9007199254740991,yh=du(G5/Qt),We={};We.absoluteValue=We.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};We.comparedTo=We.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};We.decimalPlaces=We.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Qt;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};We.dividedBy=We.div=function(e){return hs(this,new this.constructor(e))};We.dividedToIntegerBy=We.idiv=function(e){var t=this,r=t.constructor;return Gt(hs(t,new r(e),0,1),r.precision)};We.equals=We.eq=function(e){return!this.cmp(e)};We.exponent=function(){return Fr(this)};We.greaterThan=We.gt=function(e){return this.cmp(e)>0};We.greaterThanOrEqualTo=We.gte=function(e){return this.cmp(e)>=0};We.isInteger=We.isint=function(){return this.e>this.d.length-2};We.isNegative=We.isneg=function(){return this.s<0};We.isPositive=We.ispos=function(){return this.s>0};We.isZero=function(){return this.s===0};We.lessThan=We.lt=function(e){return this.cmp(e)<0};We.lessThanOrEqualTo=We.lte=function(e){return this.cmp(e)<1};We.logarithm=We.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(ya))throw Error(di+"NaN");if(r.s<1)throw Error(di+(r.s?"NaN":"-Infinity"));return r.eq(ya)?new n(0):(sr=!1,t=hs(Zd(r,i),Zd(e,i),i),sr=!0,Gt(t,a))};We.minus=We.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?X5(t,e):V5(t,(e.s=-e.s,e))};We.modulo=We.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(di+"NaN");return r.s?(sr=!1,t=hs(r,e,0,1).times(e),sr=!0,r.minus(t)):Gt(new n(r),a)};We.naturalExponential=We.exp=function(){return K5(this)};We.naturalLogarithm=We.ln=function(){return Zd(this)};We.negated=We.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};We.plus=We.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?V5(t,e):X5(t,(e.s=-e.s,e))};We.precision=We.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(al+e);if(t=Fr(a)+1,n=a.d.length-1,r=n*Qt+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};We.squareRoot=We.sqrt=function(){var e,t,r,n,a,i,s,o=this,c=o.constructor;if(o.s<1){if(!o.s)return new c(0);throw Error(di+"NaN")}for(e=Fr(o),sr=!1,a=Math.sqrt(+o),a==0||a==1/0?(t=ji(o.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=du((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(a.toString()),r=c.precision,a=s=r+3;;)if(i=n,n=i.plus(hs(o,i,s+2)).times(.5),ji(i.d).slice(0,s)===(t=ji(n.d)).slice(0,s)){if(t=t.slice(s-3,s+1),a==s&&t=="4999"){if(Gt(i,r+1,0),i.times(i).eq(o)){n=i;break}}else if(t!="9999")break;s+=4}return sr=!0,Gt(n,r)};We.times=We.mul=function(e){var t,r,n,a,i,s,o,c,u,d=this,f=d.constructor,h=d.d,p=(e=new f(e)).d;if(!d.s||!e.s)return new f(0);for(e.s*=d.s,r=d.e+e.e,c=h.length,u=p.length,c<u&&(i=h,h=p,p=i,s=c,c=u,u=s),i=[],s=c+u,n=s;n--;)i.push(0);for(n=u;--n>=0;){for(t=0,a=c+n;a>n;)o=i[a]+p[n]*h[a-n-1]+t,i[a--]=o%qr|0,t=o/qr|0;i[a]=(i[a]+t)%qr|0}for(;!i[--s];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,sr?Gt(e,f.precision):e};We.toDecimalPlaces=We.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(qi(e,0,uu),t===void 0?t=n.rounding:qi(t,0,8),Gt(r,e+Fr(r)+1,t))};We.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=wl(n,!0):(qi(e,0,uu),t===void 0?t=a.rounding:qi(t,0,8),n=Gt(new a(n),e+1,t),r=wl(n,!0,e+1)),r};We.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?wl(a):(qi(e,0,uu),t===void 0?t=i.rounding:qi(t,0,8),n=Gt(new i(a),e+Fr(a)+1,t),r=wl(n.abs(),!1,e+Fr(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};We.toInteger=We.toint=function(){var e=this,t=e.constructor;return Gt(new t(e),Fr(e)+1,t.rounding)};We.toNumber=function(){return+this};We.toPower=We.pow=function(e){var t,r,n,a,i,s,o=this,c=o.constructor,u=12,d=+(e=new c(e));if(!e.s)return new c(ya);if(o=new c(o),!o.s){if(e.s<1)throw Error(di+"Infinity");return o}if(o.eq(ya))return o;if(n=c.precision,e.eq(ya))return Gt(o,n);if(t=e.e,r=e.d.length-1,s=t>=r,i=o.s,s){if((r=d<0?-d:d)<=G5){for(a=new c(ya),t=Math.ceil(n/Qt+4),sr=!1;r%2&&(a=a.times(o),q_(a.d,t)),r=du(r/2),r!==0;)o=o.times(o),q_(o.d,t);return sr=!0,e.s<0?new c(ya).div(a):Gt(a,n)}}else if(i<0)throw Error(di+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,o.s=1,sr=!1,a=e.times(Zd(o,n+u)),sr=!0,a=K5(a),a.s=i,a};We.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=Fr(a),n=wl(a,r<=i.toExpNeg||r>=i.toExpPos)):(qi(e,1,uu),t===void 0?t=i.rounding:qi(t,0,8),a=Gt(new i(a),e,t),r=Fr(a),n=wl(a,e<=r||r<=i.toExpNeg,e)),n};We.toSignificantDigits=We.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(qi(e,1,uu),t===void 0?t=n.rounding:qi(t,0,8)),Gt(new n(r),e,t)};We.toString=We.valueOf=We.val=We.toJSON=We[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Fr(e),r=e.constructor;return wl(e,t<=r.toExpNeg||t>=r.toExpPos)};function V5(e,t){var r,n,a,i,s,o,c,u,d=e.constructor,f=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),sr?Gt(t,f):t;if(c=e.d,u=t.d,s=e.e,a=t.e,c=c.slice(),i=s-a,i){for(i<0?(n=c,i=-i,o=u.length):(n=u,a=s,o=c.length),s=Math.ceil(f/Qt),o=s>o?s+1:o+1,i>o&&(i=o,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(o=c.length,i=u.length,o-i<0&&(i=o,n=u,u=c,c=n),r=0;i;)r=(c[--i]=c[i]+u[i]+r)/qr|0,c[i]%=qr;for(r&&(c.unshift(r),++a),o=c.length;c[--o]==0;)c.pop();return t.d=c,t.e=a,sr?Gt(t,f):t}function qi(e,t,r){if(e!==~~e||e<t||e>r)throw Error(al+e)}function ji(e){var t,r,n,a=e.length-1,i="",s=e[0];if(a>0){for(i+=s,t=1;t<a;t++)n=e[t]+"",r=Qt-n.length,r&&(i+=Us(r)),i+=n;s=e[t],n=s+"",r=Qt-n.length,r&&(i+=Us(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}var hs=function(){function e(n,a){var i,s=0,o=n.length;for(n=n.slice();o--;)i=n[o]*a+s,n[o]=i%qr|0,s=i/qr|0;return s&&n.unshift(s),n}function t(n,a,i,s){var o,c;if(i!=s)c=i>s?1:-1;else for(o=c=0;o<i;o++)if(n[o]!=a[o]){c=n[o]>a[o]?1:-1;break}return c}function r(n,a,i){for(var s=0;i--;)n[i]-=s,s=n[i]<a[i]?1:0,n[i]=s*qr+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,s){var o,c,u,d,f,h,p,x,g,y,v,w,b,S,k,_,E,P,A=n.constructor,T=n.s==a.s?1:-1,R=n.d,D=a.d;if(!n.s)return new A(n);if(!a.s)throw Error(di+"Division by zero");for(c=n.e-a.e,E=D.length,k=R.length,p=new A(T),x=p.d=[],u=0;D[u]==(R[u]||0);)++u;if(D[u]>(R[u]||0)&&--c,i==null?w=i=A.precision:s?w=i+(Fr(n)-Fr(a))+1:w=i,w<0)return new A(0);if(w=w/Qt+2|0,u=0,E==1)for(d=0,D=D[0],w++;(u<k||d)&&w--;u++)b=d*qr+(R[u]||0),x[u]=b/D|0,d=b%D|0;else{for(d=qr/(D[0]+1)|0,d>1&&(D=e(D,d),R=e(R,d),E=D.length,k=R.length),S=E,g=R.slice(0,E),y=g.length;y<E;)g[y++]=0;P=D.slice(),P.unshift(0),_=D[0],D[1]>=qr/2&&++_;do d=0,o=t(D,g,E,y),o<0?(v=g[0],E!=y&&(v=v*qr+(g[1]||0)),d=v/_|0,d>1?(d>=qr&&(d=qr-1),f=e(D,d),h=f.length,y=g.length,o=t(f,g,h,y),o==1&&(d--,r(f,E<h?P:D,h))):(d==0&&(o=d=1),f=D.slice()),h=f.length,h<y&&f.unshift(0),r(g,f,y),o==-1&&(y=g.length,o=t(D,g,E,y),o<1&&(d++,r(g,E<y?P:D,y))),y=g.length):o===0&&(d++,g=[0]),x[u++]=d,o&&g[0]?g[y++]=R[S]||0:(g=[R[S]],y=1);while((S++<k||g[0]!==void 0)&&w--)}return x[0]||x.shift(),p.e=c,Gt(p,s?i+Fr(p)+1:i)}}();function K5(e,t){var r,n,a,i,s,o,c=0,u=0,d=e.constructor,f=d.precision;if(Fr(e)>16)throw Error(ww+Fr(e));if(!e.s)return new d(ya);for(t==null?(sr=!1,o=f):o=t,s=new d(.03125);e.abs().gte(.1);)e=e.times(s),u+=5;for(n=Math.log(zo(2,u))/Math.LN10*2+5|0,o+=n,r=a=i=new d(ya),d.precision=o;;){if(a=Gt(a.times(e),o),r=r.times(++c),s=i.plus(hs(a,r,o)),ji(s.d).slice(0,o)===ji(i.d).slice(0,o)){for(;u--;)i=Gt(i.times(i),o);return d.precision=f,t==null?(sr=!0,Gt(i,f)):i}i=s}}function Fr(e){for(var t=e.e*Qt,r=e.d[0];r>=10;r/=10)t++;return t}function Ex(e,t,r){if(t>e.LN10.sd())throw sr=!0,r&&(e.precision=r),Error(di+"LN10 precision limit exceeded");return Gt(new e(e.LN10),t)}function Us(e){for(var t="";e--;)t+="0";return t}function Zd(e,t){var r,n,a,i,s,o,c,u,d,f=1,h=10,p=e,x=p.d,g=p.constructor,y=g.precision;if(p.s<1)throw Error(di+(p.s?"NaN":"-Infinity"));if(p.eq(ya))return new g(0);if(t==null?(sr=!1,u=y):u=t,p.eq(10))return t==null&&(sr=!0),Ex(g,u);if(u+=h,g.precision=u,r=ji(x),n=r.charAt(0),i=Fr(p),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)p=p.times(e),r=ji(p.d),n=r.charAt(0),f++;i=Fr(p),n>1?(p=new g("0."+r),i++):p=new g(n+"."+r.slice(1))}else return c=Ex(g,u+2,y).times(i+""),p=Zd(new g(n+"."+r.slice(1)),u-h).plus(c),g.precision=y,t==null?(sr=!0,Gt(p,y)):p;for(o=s=p=hs(p.minus(ya),p.plus(ya),u),d=Gt(p.times(p),u),a=3;;){if(s=Gt(s.times(d),u),c=o.plus(hs(s,new g(a),u)),ji(c.d).slice(0,u)===ji(o.d).slice(0,u))return o=o.times(2),i!==0&&(o=o.plus(Ex(g,u+2,y).times(i+""))),o=hs(o,new g(f),u),g.precision=y,t==null?(sr=!0,Gt(o,y)):o;o=c,a+=2}}function X_(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=du(r/Qt),e.d=[],n=(r+1)%Qt,r<0&&(n+=Qt),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=Qt;n<a;)e.d.push(+t.slice(n,n+=Qt));t=t.slice(n),n=Qt-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),sr&&(e.e>yh||e.e<-yh))throw Error(ww+r)}else e.s=0,e.e=0,e.d=[0];return e}function Gt(e,t,r){var n,a,i,s,o,c,u,d,f=e.d;for(s=1,i=f[0];i>=10;i/=10)s++;if(n=t-s,n<0)n+=Qt,a=t,u=f[d=0];else{if(d=Math.ceil((n+1)/Qt),i=f.length,d>=i)return e;for(u=i=f[d],s=1;i>=10;i/=10)s++;n%=Qt,a=n-Qt+s}if(r!==void 0&&(i=zo(10,s-a-1),o=u/i%10|0,c=t<0||f[d+1]!==void 0||u%i,c=r<4?(o||c)&&(r==0||r==(e.s<0?3:2)):o>5||o==5&&(r==4||c||r==6&&(n>0?a>0?u/zo(10,s-a):0:f[d-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(i=Fr(e),f.length=1,t=t-i-1,f[0]=zo(10,(Qt-t%Qt)%Qt),e.e=du(-t/Qt)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=d,i=1,d--):(f.length=d+1,i=zo(10,Qt-n),f[d]=a>0?(u/zo(10,s-a)%zo(10,a)|0)*i:0),c)for(;;)if(d==0){(f[0]+=i)==qr&&(f[0]=1,++e.e);break}else{if(f[d]+=i,f[d]!=qr)break;f[d--]=0,i=1}for(n=f.length;f[--n]===0;)f.pop();if(sr&&(e.e>yh||e.e<-yh))throw Error(ww+Fr(e));return e}function X5(e,t){var r,n,a,i,s,o,c,u,d,f,h=e.constructor,p=h.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new h(e),sr?Gt(t,p):t;if(c=e.d,f=t.d,n=t.e,u=e.e,c=c.slice(),s=u-n,s){for(d=s<0,d?(r=c,s=-s,o=f.length):(r=f,n=u,o=c.length),a=Math.max(Math.ceil(p/Qt),o)+2,s>a&&(s=a,r.length=1),r.reverse(),a=s;a--;)r.push(0);r.reverse()}else{for(a=c.length,o=f.length,d=a<o,d&&(o=a),a=0;a<o;a++)if(c[a]!=f[a]){d=c[a]<f[a];break}s=0}for(d&&(r=c,c=f,f=r,t.s=-t.s),o=c.length,a=f.length-o;a>0;--a)c[o++]=0;for(a=f.length;a>s;){if(c[--a]<f[a]){for(i=a;i&&c[--i]===0;)c[i]=qr-1;--c[i],c[a]+=qr}c[a]-=f[a]}for(;c[--o]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,sr?Gt(t,p):t):new h(0)}function wl(e,t,r){var n,a=Fr(e),i=ji(e.d),s=i.length;return t?(r&&(n=r-s)>0?i=i.charAt(0)+"."+i.slice(1)+Us(n):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+Us(-a-1)+i,r&&(n=r-s)>0&&(i+=Us(n))):a>=s?(i+=Us(a+1-s),r&&(n=r-a-1)>0&&(i=i+"."+Us(n))):((n=a+1)<s&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-s)>0&&(a+1===s&&(i+="."),i+=Us(n))),e.s<0?"-"+i:i}function q_(e,t){if(e.length>t)return e.length=t,!0}function q5(e){var t,r,n;function a(i){var s=this;if(!(s instanceof a))return new a(i);if(s.constructor=a,i instanceof a){s.s=i.s,s.e=i.e,s.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(al+i);if(i>0)s.s=1;else if(i<0)i=-i,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(i===~~i&&i<1e7){s.e=0,s.d=[i];return}return X_(s,i.toString())}else if(typeof i!="string")throw Error(al+i);if(i.charCodeAt(0)===45?(i=i.slice(1),s.s=-1):s.s=1,IW.test(i))X_(s,i);else throw Error(al+i)}if(a.prototype=We,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=q5,a.config=a.set=FW,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function FW(e){if(!e||typeof e!="object")throw Error(di+"Object expected");var t,r,n,a=["precision",1,uu,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(du(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(al+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(al+r+": "+n);return this}var Nw=q5(MW);ya=new Nw(1);const $t=Nw;var LW=e=>e,Y5={"@@functional/placeholder":!0},J5=e=>e===Y5,Y_=e=>function t(){return arguments.length===0||arguments.length===1&&J5(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},Q5=(e,t)=>e===1?t:Y_(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var i=n.filter(s=>s!==Y5).length;return i>=e?t(...n):Q5(e-i,Y_(function(){for(var s=arguments.length,o=new Array(s),c=0;c<s;c++)o[c]=arguments[c];var u=n.map(d=>J5(d)?o.shift():d);return t(...u,...o)}))}),Vp=e=>Q5(e.length,e),Py=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},BW=Vp((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),jW=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return LW;var a=r.reverse(),i=a[0],s=a.slice(1);return function(){return s.reduce((o,c)=>c(o),i(...arguments))}},Oy=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),Z5=e=>{var t=null,r=null;return function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return t&&a.every((s,o)=>{var c;return s===((c=t)===null||c===void 0?void 0:c[o])})||(t=a,r=e(...a)),r}};function eP(e){var t;return e===0?t=1:t=Math.floor(new $t(e).abs().log(10).toNumber())+1,t}function tP(e,t,r){for(var n=new $t(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}Vp((e,t,r)=>{var n=+e,a=+t;return n+r*(a-n)});Vp((e,t,r)=>{var n=t-+e;return n=n||1/0,(r-e)/n});Vp((e,t,r)=>{var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});var rP=e=>{var[t,r]=e,[n,a]=[t,r];return t>r&&([n,a]=[r,t]),[n,a]},nP=(e,t,r)=>{if(e.lte(0))return new $t(0);var n=eP(e.toNumber()),a=new $t(10).pow(n),i=e.div(a),s=n!==1?.05:.1,o=new $t(Math.ceil(i.div(s).toNumber())).add(r).mul(s),c=o.mul(a);return t?new $t(c.toNumber()):new $t(Math.ceil(c.toNumber()))},$W=(e,t,r)=>{var n=new $t(1),a=new $t(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new $t(10).pow(eP(e)-1),a=new $t(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new $t(Math.floor(e)))}else e===0?a=new $t(Math.floor((t-1)/2)):r||(a=new $t(Math.floor(e)));var s=Math.floor((t-1)/2),o=jW(BW(c=>a.add(new $t(c-s).mul(n)).toNumber()),Py);return o(0,t)},aP=function(t,r,n,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new $t(0),tickMin:new $t(0),tickMax:new $t(0)};var s=nP(new $t(r).sub(t).div(n-1),a,i),o;t<=0&&r>=0?o=new $t(0):(o=new $t(t).add(r).div(2),o=o.sub(new $t(o).mod(s)));var c=Math.ceil(o.sub(t).div(s).toNumber()),u=Math.ceil(new $t(r).sub(o).div(s).toNumber()),d=c+u+1;return d>n?aP(t,r,n,a,i+1):(d<n&&(u=r>0?u+(n-d):u,c=r>0?c:c+(n-d)),{step:s,tickMin:o.sub(new $t(c).mul(s)),tickMax:o.add(new $t(u).mul(s))})};function UW(e){var[t,r]=e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(n,2),[s,o]=rP([t,r]);if(s===-1/0||o===1/0){var c=o===1/0?[s,...Py(0,n-1).map(()=>1/0)]:[...Py(0,n-1).map(()=>-1/0),o];return t>r?Oy(c):c}if(s===o)return $W(s,n,a);var{step:u,tickMin:d,tickMax:f}=aP(s,o,i,a,0),h=tP(d,f.add(new $t(.1).mul(u)),u);return t>r?Oy(h):h}function zW(e,t){var[r,n]=e,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[i,s]=rP([r,n]);if(i===-1/0||s===1/0)return[r,n];if(i===s)return[i];var o=Math.max(t,2),c=nP(new $t(s).sub(i).div(o-1),a,0),u=[...tP(new $t(i),new $t(s),c),s];return a===!1&&(u=u.map(d=>Math.round(d))),r>n?Oy(u):u}var HW=Z5(UW),WW=Z5(zW),iP=e=>e.rootProps.maxBarSize,GW=e=>e.rootProps.barGap,sP=e=>e.rootProps.barCategoryGap,VW=e=>e.rootProps.barSize,Ff=e=>e.rootProps.stackOffset,Sw=e=>e.options.chartName,kw=e=>e.rootProps.syncId,oP=e=>e.rootProps.syncMethod,_w=e=>e.options.eventEmitter,as={allowDuplicatedCategory:!0,angleAxisId:0,axisLine:!0,cx:0,cy:0,orientation:"outer",reversed:!1,scale:"auto",tick:!0,tickLine:!0,tickSize:8,type:"category"},pa={allowDataOverflow:!1,allowDuplicatedCategory:!0,angle:0,axisLine:!0,cx:0,cy:0,orientation:"right",radiusAxisId:0,scale:"auto",stroke:"#ccc",tick:!0,tickCount:5,type:"number"},Kp=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},KW={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:as.angleAxisId,includeHidden:!1,name:void 0,reversed:as.reversed,scale:as.scale,tick:as.tick,tickCount:void 0,ticks:void 0,type:as.type,unit:void 0},XW={allowDataOverflow:pa.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:pa.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:pa.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:pa.scale,tick:pa.tick,tickCount:pa.tickCount,ticks:void 0,type:pa.type,unit:void 0},qW={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:as.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:as.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:as.scale,tick:as.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},YW={allowDataOverflow:pa.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:pa.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:pa.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:pa.scale,tick:pa.tick,tickCount:pa.tickCount,ticks:void 0,type:"category",unit:void 0},Ew=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?qW:KW,Cw=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?YW:XW,Xp=e=>e.polarOptions,Aw=me([As,Ts,Wr],M6),lP=me([Xp,Aw],(e,t)=>{if(e!=null)return Pn(e.innerRadius,t,0)}),cP=me([Xp,Aw],(e,t)=>{if(e!=null)return Pn(e.outerRadius,t,t*.8)}),JW=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},uP=me([Xp],JW);me([Ew,uP],Kp);var dP=me([Aw,lP,cP],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});me([Cw,dP],Kp);var fP=me([Ot,Xp,lP,cP,As,Ts],(e,t,r,n,a,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:s,cy:o,startAngle:c,endAngle:u}=t;return{cx:Pn(s,a,a/2),cy:Pn(o,i,i/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:u,clockWise:!1}}}),cr=(e,t)=>t,Lf=(e,t,r)=>r;function Tw(e){return e==null?void 0:e.id}var Vr=e=>{var t=Ot(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},fu=e=>e.tooltip.settings.axisId,Kr=e=>{var t=Vr(e),r=fu(e);return Bf(e,t,r)},mP=me([Kr],e=>e==null?void 0:e.dataKey);function hP(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:a,dataKey:i}=r,s=new Map;return e.forEach(o=>{var c,u=(c=o.data)!==null&&c!==void 0?c:n;if(!(u==null||u.length===0)){var d=Tw(o);u.forEach((f,h)=>{var p=i==null||a?h:String(Yt(f,i,null)),x=Yt(f,o.dataKey,0),g;s.has(p)?g=s.get(p):g={},Object.assign(g,{[d]:x}),s.set(p,g)})}}),Array.from(s.values())}function qp(e){return e.stackId!=null&&e.dataKey!=null}var Yp=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function Jp(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function J_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?J_(Object(r),!0).forEach(function(n){QW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QW(e,t,r){return(t=ZW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZW(e){var t=eG(e,"string");return typeof t=="symbol"?t:t+""}function eG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Dy=[0,"auto"],da={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},pP=(e,t)=>e.cartesianAxis.xAxis[t],Os=(e,t)=>{var r=pP(e,t);return r??da},fa={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:Dy,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Tf},gP=(e,t)=>e.cartesianAxis.yAxis[t],Ds=(e,t)=>{var r=gP(e,t);return r??fa},tG={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},Pw=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??tG},gr=(e,t,r)=>{switch(t){case"xAxis":return Os(e,r);case"yAxis":return Ds(e,r);case"zAxis":return Pw(e,r);case"angleAxis":return Ew(e,r);case"radiusAxis":return Cw(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},rG=(e,t,r)=>{switch(t){case"xAxis":return Os(e,r);case"yAxis":return Ds(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Bf=(e,t,r)=>{switch(t){case"xAxis":return Os(e,r);case"yAxis":return Ds(e,r);case"angleAxis":return Ew(e,r);case"radiusAxis":return Cw(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},xP=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function Ow(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var Qp=e=>e.graphicalItems.cartesianItems,nG=me([cr,Lf],Ow),Dw=(e,t,r)=>e.filter(r).filter(n=>(t==null?void 0:t.includeHidden)===!0?!0:!n.hide),jf=me([Qp,gr,nG],Dw,{memoizeOptions:{resultEqualityCheck:Jp}}),vP=me([jf],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(qp)),yP=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),aG=me([jf],yP),Rw=e=>e.map(t=>t.data).filter(Boolean).flat(1),iG=me([jf],Rw,{memoizeOptions:{resultEqualityCheck:Jp}}),Mw=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=t;return e.length>0?e:r.slice(n,a+1)},Iw=me([iG,Gp],Mw),Fw=(e,t,r)=>(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:Yt(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(a=>({value:Yt(a,n)}))):e.map(n=>({value:n})),Zp=me([Iw,gr,jf],Fw);function bP(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function mm(e){if(Xi(e)||e instanceof Date){var t=Number(e);if(Mn(t))return t}}function Q_(e){if(Array.isArray(e)){var t=[mm(e[0]),mm(e[1])];return bl(t)?t:void 0}var r=mm(e);if(r!=null)return[r,r]}function mu(e){return e.map(mm).filter(_U)}function sG(e,t,r){return!r||typeof t!="number"||ci(t)?[]:r.length?mu(r.flatMap(n=>{var a=Yt(e,n.dataKey),i,s;if(Array.isArray(a)?[i,s]=a:i=s=a,!(!Mn(i)||!Mn(s)))return[t-i,t+s]})):[]}var oG=me([vP,Gp,Kr],hP),wP=(e,t,r)=>{var n={},a=t.reduce((i,s)=>(s.stackId==null||(i[s.stackId]==null&&(i[s.stackId]=[]),i[s.stackId].push(s)),i),n);return Object.fromEntries(Object.entries(a).map(i=>{var[s,o]=i,c=o.map(Tw);return[s,{stackedData:Q9(e,c,r),graphicalItems:o}]}))},Ry=me([oG,vP,Ff],wP),NP=(e,t,r,n)=>{var{dataStartIndex:a,dataEndIndex:i}=t;if(n==null&&r!=="zAxis"){var s=n$(e,a,i);if(!(s!=null&&s[0]===0&&s[1]===0))return s}},lG=me([gr],e=>e.allowDataOverflow),Lw=e=>{var t;if(e==null||!("domain"in e))return Dy;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=mu(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e==null?void 0:e.domain)!==null&&t!==void 0?t:Dy},Bw=me([gr],Lw),jw=me([Bw,lG],W5),cG=me([Ry,Oo,cr,jw],NP,{memoizeOptions:{resultEqualityCheck:Yp}}),eg=e=>e.errorBars,uG=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>bP(r,n)),wh=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var i=a.flat(),s=Math.min(...i),o=Math.max(...i);return[s,o]}},$w=(e,t,r,n,a)=>{var i,s;if(r.length>0&&e.forEach(o=>{r.forEach(c=>{var u,d,f=(u=n[c.id])===null||u===void 0?void 0:u.filter(v=>bP(a,v)),h=Yt(o,(d=t.dataKey)!==null&&d!==void 0?d:c.dataKey),p=sG(o,h,f);if(p.length>=2){var x=Math.min(...p),g=Math.max(...p);(i==null||x<i)&&(i=x),(s==null||g>s)&&(s=g)}var y=Q_(h);y!=null&&(i=i==null?y[0]:Math.min(i,y[0]),s=s==null?y[1]:Math.max(s,y[1]))})}),(t==null?void 0:t.dataKey)!=null&&e.forEach(o=>{var c=Q_(Yt(o,t.dataKey));c!=null&&(i=i==null?c[0]:Math.min(i,c[0]),s=s==null?c[1]:Math.max(s,c[1]))}),Mn(i)&&Mn(s))return[i,s]},dG=me([Iw,gr,aG,eg,cr],$w,{memoizeOptions:{resultEqualityCheck:Yp}});function fG(e){var{value:t}=e;if(Xi(t)||t instanceof Date)return t}var mG=(e,t,r)=>{var n=e.map(fG).filter(a=>a!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&P3(n))?c5(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},SP=e=>e.referenceElements.dots,hu=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),hG=me([SP,cr,Lf],hu),kP=e=>e.referenceElements.areas,pG=me([kP,cr,Lf],hu),_P=e=>e.referenceElements.lines,gG=me([_P,cr,Lf],hu),EP=(e,t)=>{var r=mu(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},xG=me(hG,cr,EP),CP=(e,t)=>{var r=mu(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},vG=me([pG,cr],CP),AP=(e,t)=>{var r=mu(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},yG=me(gG,cr,AP),bG=me(xG,yG,vG,(e,t,r)=>wh(e,r,t)),Uw=(e,t,r,n,a,i,s,o)=>{if(r!=null)return r;var c=s==="vertical"&&o==="xAxis"||s==="horizontal"&&o==="yAxis",u=c?wh(n,i,a):wh(i,a);return RW(t,u,e.allowDataOverflow)},wG=me([gr,Bw,jw,cG,dG,bG,Ot,cr],Uw,{memoizeOptions:{resultEqualityCheck:Yp}}),NG=[0,1],zw=(e,t,r,n,a,i,s)=>{if(!((e==null||r==null||r.length===0)&&s===void 0)){var{dataKey:o,type:c}=e,u=Co(t,i);return u&&o==null?c5(0,r.length):c==="category"?mG(n,e,u):a==="expand"?NG:s}},Hw=me([gr,Ot,Iw,Zp,Ff,cr,wG],zw),TP=(e,t,r,n,a)=>{if(e!=null){var{scale:i,type:s}=e;if(i==="auto")return t==="radial"&&a==="radiusAxis"?"band":t==="radial"&&a==="angleAxis"?"linear":s==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":s==="category"?"band":"linear";if(typeof i=="string"){var o="scale".concat(_f(i));return o in ed?o:"point"}}},pu=me([gr,Ot,xP,Sw,cr],TP);function SG(e){if(e!=null){if(e in ed)return ed[e]();var t="scale".concat(_f(e));if(t in ed)return ed[t]()}}function Ww(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var a=SG(t);if(a!=null){var i=a.domain(r).range(n);return K9(i),i}}}var Gw=(e,t,r)=>{var n=Lw(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&bl(e))return HW(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&bl(e))return WW(e,t.tickCount,t.allowDecimals)}},Vw=me([Hw,Bf,pu],Gw),Kw=(e,t,r,n)=>{if(n!=="angleAxis"&&(e==null?void 0:e.type)==="number"&&bl(t)&&Array.isArray(r)&&r.length>0){var a=t[0],i=r[0],s=t[1],o=r[r.length-1];return[Math.min(a,i),Math.max(s,o)]}return t},kG=me([gr,Hw,Vw,cr],Kw),_G=me(Zp,gr,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(mu(e.map(o=>o.value))).sort((o,c)=>o-c);if(n.length<2)return 1/0;var a=n[n.length-1]-n[0];if(a===0)return 1/0;for(var i=0;i<n.length-1;i++){var s=n[i+1]-n[i];r=Math.min(r,s)}return r/a}}),PP=me(_G,Ot,sP,Wr,(e,t,r,n)=>n,(e,t,r,n,a)=>{if(!Mn(e))return 0;var i=t==="vertical"?n.height:n.width;if(a==="gap")return e*i/2;if(a==="no-gap"){var s=Pn(r,e*i),o=e*i/2;return o-s-(o-s)/i*s}return 0}),EG=(e,t)=>{var r=Os(e,t);return r==null||typeof r.padding!="string"?0:PP(e,"xAxis",t,r.padding)},CG=(e,t)=>{var r=Ds(e,t);return r==null||typeof r.padding!="string"?0:PP(e,"yAxis",t,r.padding)},AG=me(Os,EG,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:t,right:t}:{left:((r=a.left)!==null&&r!==void 0?r:0)+t,right:((n=a.right)!==null&&n!==void 0?n:0)+t}}),TG=me(Ds,CG,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:t,bottom:t}:{top:((r=a.top)!==null&&r!==void 0?r:0)+t,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+t}}),PG=me([Wr,AG,Ip,Mp,(e,t,r)=>r],(e,t,r,n,a)=>{var{padding:i}=n;return a?[i.left,r.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),OG=me([Wr,Ot,TG,Ip,Mp,(e,t,r)=>r],(e,t,r,n,a,i)=>{var{padding:s}=a;return i?[n.height-s.bottom,s.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),$f=(e,t,r,n)=>{var a;switch(t){case"xAxis":return PG(e,r,n);case"yAxis":return OG(e,r,n);case"zAxis":return(a=Pw(e,r))===null||a===void 0?void 0:a.range;case"angleAxis":return uP(e);case"radiusAxis":return dP(e,r);default:return}},OP=me([gr,$f],Kp),gu=me([gr,pu,kG,OP],Ww);me([jf,eg,cr],uG);function DP(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var tg=(e,t)=>t,rg=(e,t,r)=>r,DG=me(Dp,tg,rg,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(DP)),RG=me(Rp,tg,rg,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(DP)),RP=(e,t)=>({width:e.width,height:t.height}),MG=(e,t)=>{var r=typeof t.width=="number"?t.width:Tf;return{width:r,height:e.height}},MP=me(Wr,Os,RP),IG=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},FG=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},LG=me(Ts,Wr,DG,tg,rg,(e,t,r,n,a)=>{var i={},s;return r.forEach(o=>{var c=RP(t,o);s==null&&(s=IG(t,n,e));var u=n==="top"&&!a||n==="bottom"&&a;i[o.id]=s-Number(u)*c.height,s+=(u?-1:1)*c.height}),i}),BG=me(As,Wr,RG,tg,rg,(e,t,r,n,a)=>{var i={},s;return r.forEach(o=>{var c=MG(t,o);s==null&&(s=FG(t,n,e));var u=n==="left"&&!a||n==="right"&&a;i[o.id]=s-Number(u)*c.width,s+=(u?-1:1)*c.width}),i}),jG=(e,t)=>{var r=Os(e,t);if(r!=null)return LG(e,r.orientation,r.mirror)},$G=me([Wr,Os,jG,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r==null?void 0:r[n];return a==null?{x:e.left,y:0}:{x:e.left,y:a}}}),UG=(e,t)=>{var r=Ds(e,t);if(r!=null)return BG(e,r.orientation,r.mirror)},zG=me([Wr,Ds,UG,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r==null?void 0:r[n];return a==null?{x:0,y:e.top}:{x:a,y:e.top}}}),IP=me(Wr,Ds,(e,t)=>{var r=typeof t.width=="number"?t.width:Tf;return{width:r,height:e.height}}),Z_=(e,t,r)=>{switch(t){case"xAxis":return MP(e,r).width;case"yAxis":return IP(e,r).height;default:return}},FP=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:i,dataKey:s}=r,o=Co(e,n),c=t.map(u=>u.value);if(s&&o&&i==="category"&&a&&P3(c))return c}},Xw=me([Ot,Zp,gr,cr],FP),LP=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:i}=r,s=Co(e,n);if(s&&(a==="number"||i!=="auto"))return t.map(o=>o.value)}},qw=me([Ot,Zp,Bf,cr],LP),e4=me([Ot,rG,pu,gu,Xw,qw,$f,Vw,cr],(e,t,r,n,a,i,s,o,c)=>{if(t==null)return null;var u=Co(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:i,duplicateDomain:a,isCategorical:u,niceTicks:o,range:s,realScaleType:r,scale:n}}),HG=(e,t,r,n,a,i,s,o,c)=>{if(!(t==null||n==null)){var u=Co(e,c),{type:d,ticks:f,tickCount:h}=t,p=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,x=d==="category"&&n.bandwidth?n.bandwidth()/p:0;x=c==="angleAxis"&&i!=null&&i.length>=2?tn(i[0]-i[1])*2*x:x;var g=f||a;if(g){var y=g.map((v,w)=>{var b=s?s.indexOf(v):v;return{index:w,coordinate:n(b)+x,value:v,offset:x}});return y.filter(v=>!ci(v.coordinate))}return u&&o?o.map((v,w)=>({coordinate:n(v)+x,value:v,index:w,offset:x})):n.ticks?n.ticks(h).map(v=>({coordinate:n(v)+x,value:v,offset:x})):n.domain().map((v,w)=>({coordinate:n(v)+x,value:s?s[v]:v,index:w,offset:x}))}},BP=me([Ot,Bf,pu,gu,Vw,$f,Xw,qw,cr],HG),WG=(e,t,r,n,a,i,s)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var o=Co(e,s),{tickCount:c}=t,u=0;return u=s==="angleAxis"&&(n==null?void 0:n.length)>=2?tn(n[0]-n[1])*2*u:u,o&&i?i.map((d,f)=>({coordinate:r(d)+u,value:d,index:f,offset:u})):r.ticks?r.ticks(c).map(d=>({coordinate:r(d)+u,value:d,offset:u})):r.domain().map((d,f)=>({coordinate:r(d)+u,value:a?a[d]:d,index:f,offset:u}))}},po=me([Ot,Bf,gu,$f,Xw,qw,cr],WG),go=me(gr,gu,(e,t)=>{if(!(e==null||t==null))return bh(bh({},e),{},{scale:t})}),GG=me([gr,pu,Hw,OP],Ww);me((e,t,r)=>Pw(e,r),GG,(e,t)=>{if(!(e==null||t==null))return bh(bh({},e),{},{scale:t})});var VG=me([Ot,Dp,Rp],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),jP=e=>e.options.defaultTooltipEventType,$P=e=>e.options.validateTooltipEventTypes;function UP(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function Yw(e,t){var r=jP(e),n=$P(e);return UP(t,r,n)}function KG(e){return Ve(t=>Yw(t,e))}var zP=(e,t)=>{var r,n=Number(t);if(!(ci(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},XG=e=>e.tooltip.settings,Gs={active:!1,index:null,dataKey:void 0,coordinate:void 0},qG={itemInteraction:{click:Gs,hover:Gs},axisInteraction:{click:Gs,hover:Gs},keyboardInteraction:Gs,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},HP=ja({name:"tooltip",initialState:qG,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:Un()},removeTooltipEntrySettings:{reducer(e,t){var r=ms(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},prepare:Un()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:YG,removeTooltipEntrySettings:JG,setTooltipSettingsState:QG,setActiveMouseOverItemIndex:WP,mouseLeaveItem:ZG,mouseLeaveChart:GP,setActiveClickItemIndex:eV,setMouseOverAxisIndex:VP,setMouseClickAxisIndex:tV,setSyncInteraction:My,setKeyboardInteraction:Iy}=HP.actions,rV=HP.reducer;function t4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function M0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?t4(Object(r),!0).forEach(function(n){nV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nV(e,t,r){return(t=aV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aV(e){var t=iV(e,"string");return typeof t=="symbol"?t:t+""}function iV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sV(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function oV(e){return e.index!=null}var KP=(e,t,r,n)=>{if(t==null)return Gs;var a=sV(e,t,r);if(a==null)return Gs;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(oV(a)){if(i)return M0(M0({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return M0(M0({},Gs),{},{coordinate:a.coordinate})},Jw=(e,t)=>{var r=e==null?void 0:e.index;if(r==null)return null;var n=Number(r);if(!Mn(n))return r;var a=0,i=1/0;return t.length>0&&(i=t.length-1),String(Math.max(a,Math.min(n,i)))},XP=(e,t,r,n,a,i,s,o)=>{if(!(i==null||o==null)){var c=s[0],u=c==null?void 0:o(c.positions,i);if(u!=null)return u;var d=a==null?void 0:a[Number(i)];if(d)switch(r){case"horizontal":return{x:d.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:d.coordinate}}}},qP=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;return r==="hover"?a=e.itemInteraction.hover.dataKey:a=e.itemInteraction.click.dataKey,a==null&&n!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(i=>{var s;return((s=i.settings)===null||s===void 0?void 0:s.dataKey)===a})},Uf=e=>e.options.tooltipPayloadSearcher,xu=e=>e.tooltip;function r4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function n4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?r4(Object(r),!0).forEach(function(n){lV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):r4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lV(e,t,r){return(t=cV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cV(e){var t=uV(e,"string");return typeof t=="symbol"?t:t+""}function uV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dV(e,t){return e??t}var YP=(e,t,r,n,a,i,s)=>{if(!(t==null||i==null)){var{chartData:o,computedData:c,dataStartIndex:u,dataEndIndex:d}=r,f=[];return e.reduce((h,p)=>{var x,{dataDefinedOnItem:g,settings:y}=p,v=dV(g,o),w=Array.isArray(v)?I6(v,u,d):v,b=(x=y==null?void 0:y.dataKey)!==null&&x!==void 0?x:n,S=y==null?void 0:y.nameKey,k;if(n&&Array.isArray(w)&&!Array.isArray(w[0])&&s==="axis"?k=O3(w,n,a):k=i(w,t,c,S),Array.isArray(k))k.forEach(E=>{var P=n4(n4({},y),{},{name:E.name,unit:E.unit,color:void 0,fill:void 0});h.push($k({tooltipEntrySettings:P,dataKey:E.dataKey,payload:E.payload,value:Yt(E.payload,E.dataKey),name:E.name}))});else{var _;h.push($k({tooltipEntrySettings:y,dataKey:b,payload:k,value:Yt(k,b),name:(_=Yt(k,S))!==null&&_!==void 0?_:y==null?void 0:y.name}))}return h},f)}},Qw=me([Kr,Ot,xP,Sw,Vr],TP),fV=me([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),mV=me([Vr,fu],Ow),zf=me([fV,Kr,mV],Dw,{memoizeOptions:{resultEqualityCheck:Jp}}),hV=me([zf],e=>e.filter(qp)),pV=me([zf],Rw,{memoizeOptions:{resultEqualityCheck:Jp}}),vu=me([pV,Oo],Mw),gV=me([hV,Oo,Kr],hP),Zw=me([vu,Kr,zf],Fw),JP=me([Kr],Lw),xV=me([Kr],e=>e.allowDataOverflow),QP=me([JP,xV],W5),vV=me([zf],e=>e.filter(qp)),yV=me([gV,vV,Ff],wP),bV=me([yV,Oo,Vr,QP],NP),wV=me([zf],yP),NV=me([vu,Kr,wV,eg,Vr],$w,{memoizeOptions:{resultEqualityCheck:Yp}}),SV=me([SP,Vr,fu],hu),kV=me([SV,Vr],EP),_V=me([kP,Vr,fu],hu),EV=me([_V,Vr],CP),CV=me([_P,Vr,fu],hu),AV=me([CV,Vr],AP),TV=me([kV,AV,EV],wh),PV=me([Kr,JP,QP,bV,NV,TV,Ot,Vr],Uw),ZP=me([Kr,Ot,vu,Zw,Ff,Vr,PV],zw),OV=me([ZP,Kr,Qw],Gw),DV=me([Kr,ZP,OV,Vr],Kw),eO=e=>{var t=Vr(e),r=fu(e),n=!1;return $f(e,t,r,n)},tO=me([Kr,eO],Kp),rO=me([Kr,Qw,DV,tO],Ww),RV=me([Ot,Zw,Kr,Vr],FP),MV=me([Ot,Zw,Kr,Vr],LP),IV=(e,t,r,n,a,i,s,o)=>{if(t){var{type:c}=t,u=Co(e,o);if(n){var d=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,f=c==="category"&&n.bandwidth?n.bandwidth()/d:0;return f=o==="angleAxis"&&a!=null&&(a==null?void 0:a.length)>=2?tn(a[0]-a[1])*2*f:f,u&&s?s.map((h,p)=>({coordinate:n(h)+f,value:h,index:p,offset:f})):n.domain().map((h,p)=>({coordinate:n(h)+f,value:i?i[h]:h,index:p,offset:f}))}}},Rs=me([Ot,Kr,Qw,rO,eO,RV,MV,Vr],IV),e2=me([jP,$P,XG],(e,t,r)=>UP(r.shared,e,t)),nO=e=>e.tooltip.settings.trigger,t2=e=>e.tooltip.settings.defaultIndex,ng=me([xu,e2,nO,t2],KP),xo=me([ng,vu],Jw),aO=me([Rs,xo],zP),iO=me([ng],e=>{if(e)return e.dataKey}),sO=me([xu,e2,nO,t2],qP),FV=me([As,Ts,Ot,Wr,Rs,t2,sO,Uf],XP),LV=me([ng,FV],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),BV=me([ng],e=>e.active),jV=me([sO,xo,Oo,mP,aO,Uf,e2],YP),$V=me([jV],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function a4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function i4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?a4(Object(r),!0).forEach(function(n){UV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function UV(e,t,r){return(t=zV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zV(e){var t=HV(e,"string");return typeof t=="symbol"?t:t+""}function HV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var WV=()=>Ve(Kr),GV=()=>{var e=WV(),t=Ve(Rs),r=Ve(rO);return Kd(i4(i4({},e),{},{scale:r}),t)},VV=()=>Ve(Sw),r2=(e,t)=>t,oO=(e,t,r)=>r,n2=(e,t,r,n)=>n,KV=me(Rs,e=>Ep(e,t=>t.coordinate)),a2=me([xu,r2,oO,n2],KP),lO=me([a2,vu],Jw),XV=(e,t,r)=>{if(t!=null){var n=xu(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},cO=me([xu,r2,oO,n2],qP),Nh=me([As,Ts,Ot,Wr,Rs,n2,cO,Uf],XP),qV=me([a2,Nh],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),uO=me(Rs,lO,zP),YV=me([cO,lO,Oo,mP,uO,Uf,r2],YP),JV=me([a2],e=>({isActive:e.active,activeIndex:e.index})),QV=(e,t,r,n,a,i,s,o)=>{if(!(!e||!t||!n||!a||!i)){var c=a$(e.chartX,e.chartY,t,r,o);if(c){var u=s$(c,t),d=G9(u,s,i,n,a),f=i$(t,i,d,c);return{activeIndex:String(d),activeCoordinate:f}}}};function Fy(){return Fy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fy.apply(null,arguments)}function s4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function I0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s4(Object(r),!0).forEach(function(n){ZV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZV(e,t,r){return(t=eK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eK(e){var t=tK(e,"string");return typeof t=="symbol"?t:t+""}function tK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rK(e){var{coordinate:t,payload:r,index:n,offset:a,tooltipAxisBandSize:i,layout:s,cursor:o,tooltipEventType:c,chartName:u}=e,d=t,f=r,h=n;if(!o||!d||u!=="ScatterChart"&&c!=="axis")return null;var p,x;if(u==="ScatterChart")p=d,x=vU;else if(u==="BarChart")p=yU(s,d,a,i),x=r5;else if(s==="radial"){var{cx:g,cy:y,radius:v,startAngle:w,endAngle:b}=n5(d);p={cx:g,cy:y,startAngle:w,endAngle:b,innerRadius:v,outerRadius:v},x=i5}else p={points:rz(s,d,a)},x=Yb;var S=typeof o=="object"&&"className"in o?o.className:void 0,k=I0(I0(I0(I0({stroke:"#ccc",pointerEvents:"none"},a),p),gl(o)),{},{payload:f,payloadIndex:h,className:It("recharts-tooltip-cursor",S)});return N.isValidElement(o)?N.cloneElement(o,k):N.createElement(x,k)}function nK(e){var t=GV(),r=K6(),n=Lp(),a=VV();return N.createElement(rK,Fy({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:n,tooltipAxisBandSize:t,chartName:a}))}var dO=N.createContext(null),aK=()=>N.useContext(dO),fO={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function i(c,u,d,f,h){if(typeof d!="function")throw new TypeError("The listener must be a function");var p=new a(d,f||c,h),x=r?r+u:u;return c._events[x]?c._events[x].fn?c._events[x]=[c._events[x],p]:c._events[x].push(p):(c._events[x]=p,c._eventsCount++),c}function s(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)t.call(d,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},o.prototype.listeners=function(u){var d=r?r+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,p=f.length,x=new Array(p);h<p;h++)x[h]=f[h].fn;return x},o.prototype.listenerCount=function(u){var d=r?r+u:u,f=this._events[d];return f?f.fn?1:f.length:0},o.prototype.emit=function(u,d,f,h,p,x){var g=r?r+u:u;if(!this._events[g])return!1;var y=this._events[g],v=arguments.length,w,b;if(y.fn){switch(y.once&&this.removeListener(u,y.fn,void 0,!0),v){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,d),!0;case 3:return y.fn.call(y.context,d,f),!0;case 4:return y.fn.call(y.context,d,f,h),!0;case 5:return y.fn.call(y.context,d,f,h,p),!0;case 6:return y.fn.call(y.context,d,f,h,p,x),!0}for(b=1,w=new Array(v-1);b<v;b++)w[b-1]=arguments[b];y.fn.apply(y.context,w)}else{var S=y.length,k;for(b=0;b<S;b++)switch(y[b].once&&this.removeListener(u,y[b].fn,void 0,!0),v){case 1:y[b].fn.call(y[b].context);break;case 2:y[b].fn.call(y[b].context,d);break;case 3:y[b].fn.call(y[b].context,d,f);break;case 4:y[b].fn.call(y[b].context,d,f,h);break;default:if(!w)for(k=1,w=new Array(v-1);k<v;k++)w[k-1]=arguments[k];y[b].fn.apply(y[b].context,w)}}return!0},o.prototype.on=function(u,d,f){return i(this,u,d,f,!1)},o.prototype.once=function(u,d,f){return i(this,u,d,f,!0)},o.prototype.removeListener=function(u,d,f,h){var p=r?r+u:u;if(!this._events[p])return this;if(!d)return s(this,p),this;var x=this._events[p];if(x.fn)x.fn===d&&(!h||x.once)&&(!f||x.context===f)&&s(this,p);else{for(var g=0,y=[],v=x.length;g<v;g++)(x[g].fn!==d||h&&!x[g].once||f&&x[g].context!==f)&&y.push(x[g]);y.length?this._events[p]=y.length===1?y[0]:y:s(this,p)}return this},o.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&s(this,d)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o})(fO);var iK=fO.exports;const sK=Es(iK);var ef=new sK,Ly="recharts.syncEvent.tooltip",o4="recharts.syncEvent.brush";function i2(e,t){if(t){var r=Number.parseInt(t,10);if(!ci(r))return e==null?void 0:e[r]}}var oK={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},mO=ja({name:"options",initialState:oK,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),lK=mO.reducer,{createEventEmitter:cK}=mO.actions;function uK(e){return e.tooltip.syncInteraction}var dK={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},hO=ja({name:"chartData",initialState:dK,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:l4,setDataStartEndIndexes:fK,setComputedData:Ufe}=hO.actions,mK=hO.reducer,hK=["x","y"];function c4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ql(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c4(Object(r),!0).forEach(function(n){pK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pK(e,t,r){return(t=gK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gK(e){var t=xK(e,"string");return typeof t=="symbol"?t:t+""}function xK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vK(e,t){if(e==null)return{};var r,n,a=yK(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function yK(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var pO=()=>{};function bK(){var e=Ve(kw),t=Ve(_w),r=lr(),n=Ve(oP),a=Ve(Rs),i=Lp(),s=Fp(),o=Ve(c=>c.rootProps.className);N.useEffect(()=>{if(e==null)return pO;var c=(u,d,f)=>{if(t!==f&&e===u){if(n==="index"){var h;if(s&&d!==null&&d!==void 0&&(h=d.payload)!==null&&h!==void 0&&h.coordinate&&d.payload.sourceViewBox){var p=d.payload.coordinate,{x,y:g}=p,y=vK(p,hK),{x:v,y:w,width:b,height:S}=d.payload.sourceViewBox,k=ql(ql({},y),{},{x:s.x+(b?(x-v)/b:0)*s.width,y:s.y+(S?(g-w)/S:0)*s.height});r(ql(ql({},d),{},{payload:ql(ql({},d.payload),{},{coordinate:k})}))}else r(d);return}if(a!=null){var _;if(typeof n=="function"){var E={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},P=n(a,E);_=a[P]}else n==="value"&&(_=a.find(Y=>String(Y.value)===d.payload.label));var{coordinate:A}=d.payload;if(_==null||d.payload.active===!1||A==null||s==null){r(My({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0}));return}var{x:T,y:R}=A,D=Math.min(T,s.x+s.width),L=Math.min(R,s.y+s.height),z={x:i==="horizontal"?_.coordinate:D,y:i==="horizontal"?L:_.coordinate},X=My({active:d.payload.active,coordinate:z,dataKey:d.payload.dataKey,index:String(_.index),label:d.payload.label,sourceViewBox:d.payload.sourceViewBox});r(X)}}};return ef.on(Ly,c),()=>{ef.off(Ly,c)}},[o,r,t,e,n,a,i,s])}function wK(){var e=Ve(kw),t=Ve(_w),r=lr();N.useEffect(()=>{if(e==null)return pO;var n=(a,i,s)=>{t!==s&&e===a&&r(fK(i))};return ef.on(o4,n),()=>{ef.off(o4,n)}},[r,t,e])}function NK(){var e=lr();N.useEffect(()=>{e(cK())},[e]),bK(),wK()}function SK(e,t,r,n,a,i){var s=Ve(p=>XV(p,e,t)),o=Ve(_w),c=Ve(kw),u=Ve(oP),d=Ve(uK),f=d==null?void 0:d.active,h=Fp();N.useEffect(()=>{if(!f&&c!=null&&o!=null){var p=My({active:i,coordinate:r,dataKey:s,index:a,label:typeof n=="number"?String(n):n,sourceViewBox:h});ef.emit(Ly,c,p,o)}},[f,r,s,a,n,o,c,u,i,h])}function u4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function d4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?u4(Object(r),!0).forEach(function(n){kK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kK(e,t,r){return(t=_K(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _K(e){var t=EK(e,"string");return typeof t=="symbol"?t:t+""}function EK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CK(e){return e.dataKey}function AK(e,t){return N.isValidElement(e)?N.cloneElement(e,t):typeof e=="function"?N.createElement(e,t):N.createElement(Y$,t)}var f4=[],TK={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!Ao.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function Bn(e){var t=gn(e,TK),{active:r,allowEscapeViewBox:n,animationDuration:a,animationEasing:i,content:s,filterNull:o,isAnimationActive:c,offset:u,payloadUniqBy:d,position:f,reverseDirection:h,useTranslate3d:p,wrapperStyle:x,cursor:g,shared:y,trigger:v,defaultIndex:w,portal:b,axisId:S}=t,k=lr(),_=typeof w=="number"?String(w):w;N.useEffect(()=>{k(QG({shared:y,trigger:v,axisId:S,active:r,defaultIndex:_}))},[k,y,v,S,r,_]);var E=Fp(),P=J6(),A=KG(y),{activeIndex:T,isActive:R}=Ve(G=>JV(G,A,v,_)),D=Ve(G=>YV(G,A,v,_)),L=Ve(G=>uO(G,A,v,_)),z=Ve(G=>qV(G,A,v,_)),X=D,Y=aK(),q=r??R,[ee,V]=o6([X,q]),ae=A==="axis"?L:void 0;SK(A,v,z,ae,T,q);var oe=b??Y;if(oe==null)return null;var I=X??f4;q||(I=f4),o&&I.length&&(I=q3(X.filter(G=>G.value!=null&&(G.hide!==!0||t.includeHidden)),d,CK));var W=I.length>0,U=N.createElement(nU,{allowEscapeViewBox:n,animationDuration:a,animationEasing:i,isAnimationActive:c,active:q,coordinate:z,hasPayload:W,offset:u,position:f,reverseDirection:h,useTranslate3d:p,viewBox:E,wrapperStyle:x,lastBoundingBox:ee,innerRef:V,hasPortalFromProps:!!b},AK(s,d4(d4({},t),{},{payload:I,label:ae,active:q,coordinate:z,accessibilityLayer:P})));return N.createElement(N.Fragment,null,tb.createPortal(U,oe),q&&N.createElement(nK,{cursor:g,tooltipEventType:A,coordinate:z,payload:X,index:T}))}var il=e=>null;il.displayName="Cell";function PK(e,t,r){return(t=OK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OK(e){var t=DK(e,"string");return typeof t=="symbol"?t:t+""}function DK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class RK{constructor(t){PK(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function m4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function MK(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?m4(Object(r),!0).forEach(function(n){IK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IK(e,t,r){return(t=FK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FK(e){var t=LK(e,"string");return typeof t=="symbol"?t:t+""}function LK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BK={cacheSize:2e3,enableCache:!0},gO=MK({},BK),h4=new RK(gO.cacheSize),jK={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},p4="recharts_measurement_span";function $K(e,t){var r=t.fontSize||"",n=t.fontFamily||"",a=t.fontWeight||"",i=t.fontStyle||"",s=t.letterSpacing||"",o=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(i,"|").concat(s,"|").concat(o)}var g4=(e,t)=>{try{var r=document.getElementById(p4);r||(r=document.createElement("span"),r.setAttribute("id",p4),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,jK,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},gd=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Ao.isSsr)return{width:0,height:0};if(!gO.enableCache)return g4(t,r);var n=$K(t,r),a=h4.get(n);if(a)return a;var i=g4(t,r);return h4.set(n,i),i},x4=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,v4=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,UK=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,zK=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,xO={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},HK=Object.keys(xO),pc="NaN";function WK(e,t){return e*xO[t]}class Qn{static parse(t){var r,[,n,a]=(r=zK.exec(t))!==null&&r!==void 0?r:[];return new Qn(parseFloat(n),a??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,ci(t)&&(this.unit=""),r!==""&&!UK.test(r)&&(this.num=NaN,this.unit=""),HK.includes(r)&&(this.num=WK(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new Qn(NaN,""):new Qn(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new Qn(NaN,""):new Qn(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Qn(NaN,""):new Qn(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Qn(NaN,""):new Qn(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return ci(this.num)}}function vO(e){if(e.includes(pc))return pc;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,a,i]=(r=x4.exec(t))!==null&&r!==void 0?r:[],s=Qn.parse(n??""),o=Qn.parse(i??""),c=a==="*"?s.multiply(o):s.divide(o);if(c.isNaN())return pc;t=t.replace(x4,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var u,[,d,f,h]=(u=v4.exec(t))!==null&&u!==void 0?u:[],p=Qn.parse(d??""),x=Qn.parse(h??""),g=f==="+"?p.add(x):p.subtract(x);if(g.isNaN())return pc;t=t.replace(v4,g.toString())}return t}var y4=/\(([^()]*)\)/;function GK(e){for(var t=e,r;(r=y4.exec(t))!=null;){var[,n]=r;t=t.replace(y4,vO(n))}return t}function VK(e){var t=e.replace(/\s+/g,"");return t=GK(t),t=vO(t),t}function KK(e){try{return VK(e)}catch{return pc}}function Cx(e){var t=KK(e.slice(5,-1));return t===pc?"":t}var XK=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],qK=["dx","dy","angle","className","breakAll"];function By(){return By=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},By.apply(null,arguments)}function b4(e,t){if(e==null)return{};var r,n,a=YK(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function YK(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var yO=/[ \f\n\r\t\v\u2028\u2029]+/,bO=e=>{var{children:t,breakAll:r,style:n}=e;try{var a=[];or(t)||(r?a=t.toString().split(""):a=t.toString().split(yO));var i=a.map(o=>({word:o,width:gd(o,n).width})),s=r?0:gd("",n).width;return{wordsWithComputedWidth:i,spaceWidth:s}}catch{return null}},JK=(e,t,r,n,a)=>{var{maxLines:i,children:s,style:o,breakAll:c}=e,u=Je(i),d=s,f=function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return R.reduce((D,L)=>{var{word:z,width:X}=L,Y=D[D.length-1];if(Y&&(n==null||a||Y.width+X+r<Number(n)))Y.words.push(z),Y.width+=X+r;else{var q={words:[z],width:X};D.push(q)}return D},[])},h=f(t),p=T=>T.reduce((R,D)=>R.width>D.width?R:D);if(!u||a)return h;var x=h.length>i||p(h).width>Number(n);if(!x)return h;for(var g="",y=T=>{var R=d.slice(0,T),D=bO({breakAll:c,style:o,children:R+g}).wordsWithComputedWidth,L=f(D),z=L.length>i||p(L).width>Number(n);return[z,L]},v=0,w=d.length-1,b=0,S;v<=w&&b<=d.length-1;){var k=Math.floor((v+w)/2),_=k-1,[E,P]=y(_),[A]=y(k);if(!E&&!A&&(v=k+1),E&&A&&(w=k-1),!E&&A){S=P;break}b++}return S||h},w4=e=>{var t=or(e)?[]:e.toString().split(yO);return[{words:t}]},QK=e=>{var{width:t,scaleToFit:r,children:n,style:a,breakAll:i,maxLines:s}=e;if((t||r)&&!Ao.isSsr){var o,c,u=bO({breakAll:i,children:n,style:a});if(u){var{wordsWithComputedWidth:d,spaceWidth:f}=u;o=d,c=f}else return w4(n);return JK({breakAll:i,children:n,maxLines:s,style:a},o,c,t,r)}return w4(n)},N4="#808080",ag=N.forwardRef((e,t)=>{var{x:r=0,y:n=0,lineHeight:a="1em",capHeight:i="0.71em",scaleToFit:s=!1,textAnchor:o="start",verticalAnchor:c="end",fill:u=N4}=e,d=b4(e,XK),f=N.useMemo(()=>QK({breakAll:d.breakAll,children:d.children,maxLines:d.maxLines,scaleToFit:s,style:d.style,width:d.width}),[d.breakAll,d.children,d.maxLines,s,d.style,d.width]),{dx:h,dy:p,angle:x,className:g,breakAll:y}=d,v=b4(d,qK);if(!Xi(r)||!Xi(n)||f.length===0)return null;var w=r+(Je(h)?h:0),b=n+(Je(p)?p:0),S;switch(c){case"start":S=Cx("calc(".concat(i,")"));break;case"middle":S=Cx("calc(".concat((f.length-1)/2," * -").concat(a," + (").concat(i," / 2))"));break;default:S=Cx("calc(".concat(f.length-1," * -").concat(a,")"));break}var k=[];if(s){var _=f[0].width,{width:E}=d;k.push("scale(".concat(Je(E)?E/_:1,")"))}return x&&k.push("rotate(".concat(x,", ").concat(w,", ").concat(b,")")),k.length&&(v.transform=k.join(" ")),N.createElement("text",By({},Kn(v),{ref:t,x:w,y:b,className:It("recharts-text",g),textAnchor:o,fill:u.includes("url")?N4:u}),f.map((P,A)=>{var T=P.words.join(y?"":" ");return N.createElement("tspan",{x:w,dy:A===0?S:a,key:"".concat(T,"-").concat(A)},T)}))});ag.displayName="Text";var ZK=["labelRef"];function eX(e,t){if(e==null)return{};var r,n,a=tX(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function tX(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function S4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Cr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?S4(Object(r),!0).forEach(function(n){rX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rX(e,t,r){return(t=nX(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nX(e){var t=aX(e,"string");return typeof t=="symbol"?t:t+""}function aX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function is(){return is=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},is.apply(null,arguments)}var wO=N.createContext(null),iX=e=>{var{x:t,y:r,width:n,height:a,children:i}=e,s=N.useMemo(()=>({x:t,y:r,width:n,height:a}),[t,r,n,a]);return N.createElement(wO.Provider,{value:s},i)},NO=()=>{var e=N.useContext(wO),t=Fp();return e||t},sX=N.createContext(null),oX=()=>{var e=N.useContext(sX),t=Ve(fP);return e||t},lX=e=>{var{value:t,formatter:r}=e,n=or(e.children)?t:e.children;return typeof r=="function"?r(n):n},s2=e=>e!=null&&typeof e=="function",cX=(e,t)=>{var r=tn(t-e),n=Math.min(Math.abs(t-e),360);return r*n},uX=(e,t,r,n,a)=>{var{offset:i,className:s}=e,{cx:o,cy:c,innerRadius:u,outerRadius:d,startAngle:f,endAngle:h,clockWise:p}=a,x=(u+d)/2,g=cX(f,h),y=g>=0?1:-1,v,w;switch(t){case"insideStart":v=f+y*i,w=p;break;case"insideEnd":v=h-y*i,w=!p;break;case"end":v=h+y*i,w=p;break;default:throw new Error("Unsupported position ".concat(t))}w=g<=0?w:!w;var b=Ir(o,c,x,v),S=Ir(o,c,x,v+(w?1:-1)*359),k="M".concat(b.x,",").concat(b.y,`
    A`).concat(x,",").concat(x,",0,1,").concat(w?0:1,`,
    `).concat(S.x,",").concat(S.y),_=or(e.id)?Wd("recharts-radial-line-"):e.id;return N.createElement("text",is({},n,{dominantBaseline:"central",className:It("recharts-radial-bar-label",s)}),N.createElement("defs",null,N.createElement("path",{id:_,d:k})),N.createElement("textPath",{xlinkHref:"#".concat(_)},r))},dX=(e,t,r)=>{var{cx:n,cy:a,innerRadius:i,outerRadius:s,startAngle:o,endAngle:c}=e,u=(o+c)/2;if(r==="outside"){var{x:d,y:f}=Ir(n,a,s+t,u);return{x:d,y:f,textAnchor:d>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"end"};var h=(i+s)/2,{x:p,y:x}=Ir(n,a,h,u);return{x:p,y:x,textAnchor:"middle",verticalAnchor:"middle"}},SO=e=>"cx"in e&&Je(e.cx),fX=(e,t)=>{var{parentViewBox:r,offset:n,position:a}=e,i;r!=null&&!SO(r)&&(i=r);var{x:s,y:o,width:c,height:u}=t,d=u>=0?1:-1,f=d*n,h=d>0?"end":"start",p=d>0?"start":"end",x=c>=0?1:-1,g=x*n,y=x>0?"end":"start",v=x>0?"start":"end";if(a==="top"){var w={x:s+c/2,y:o-d*n,textAnchor:"middle",verticalAnchor:h};return Cr(Cr({},w),i?{height:Math.max(o-i.y,0),width:c}:{})}if(a==="bottom"){var b={x:s+c/2,y:o+u+f,textAnchor:"middle",verticalAnchor:p};return Cr(Cr({},b),i?{height:Math.max(i.y+i.height-(o+u),0),width:c}:{})}if(a==="left"){var S={x:s-g,y:o+u/2,textAnchor:y,verticalAnchor:"middle"};return Cr(Cr({},S),i?{width:Math.max(S.x-i.x,0),height:u}:{})}if(a==="right"){var k={x:s+c+g,y:o+u/2,textAnchor:v,verticalAnchor:"middle"};return Cr(Cr({},k),i?{width:Math.max(i.x+i.width-k.x,0),height:u}:{})}var _=i?{width:c,height:u}:{};return a==="insideLeft"?Cr({x:s+g,y:o+u/2,textAnchor:v,verticalAnchor:"middle"},_):a==="insideRight"?Cr({x:s+c-g,y:o+u/2,textAnchor:y,verticalAnchor:"middle"},_):a==="insideTop"?Cr({x:s+c/2,y:o+f,textAnchor:"middle",verticalAnchor:p},_):a==="insideBottom"?Cr({x:s+c/2,y:o+u-f,textAnchor:"middle",verticalAnchor:h},_):a==="insideTopLeft"?Cr({x:s+g,y:o+f,textAnchor:v,verticalAnchor:p},_):a==="insideTopRight"?Cr({x:s+c-g,y:o+f,textAnchor:y,verticalAnchor:p},_):a==="insideBottomLeft"?Cr({x:s+g,y:o+u-f,textAnchor:v,verticalAnchor:h},_):a==="insideBottomRight"?Cr({x:s+c-g,y:o+u-f,textAnchor:y,verticalAnchor:h},_):a&&typeof a=="object"&&(Je(a.x)||ws(a.x))&&(Je(a.y)||ws(a.y))?Cr({x:s+Pn(a.x,c),y:o+Pn(a.y,u),textAnchor:"end",verticalAnchor:"end"},_):Cr({x:s+c/2,y:o+u/2,textAnchor:"middle",verticalAnchor:"middle"},_)},mX={offset:5};function zs(e){var t=gn(e,mX),{viewBox:r,position:n,value:a,children:i,content:s,className:o="",textBreakAll:c,labelRef:u}=t,d=oX(),f=NO(),h=n==="center"?f:d??f,p=r||h;if(!p||or(a)&&or(i)&&!N.isValidElement(s)&&typeof s!="function")return null;var x=Cr(Cr({},t),{},{viewBox:p});if(N.isValidElement(s)){var g=eX(x,ZK);return N.cloneElement(s,g)}var y;if(typeof s=="function"){if(y=N.createElement(s,x),N.isValidElement(y))return y}else y=lX(t);var v=SO(p),w=Kn(t);if(v&&(n==="insideStart"||n==="insideEnd"||n==="end"))return uX(t,n,y,w,p);var b=v?dX(p,t.offset,t.position):fX(t,p);return N.createElement(ag,is({ref:u,className:It("recharts-label",o)},w,b,{breakAll:c}),y)}zs.displayName="Label";var hX=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?N.createElement(zs,is({key:"label-implicit"},n)):Xi(e)?N.createElement(zs,is({key:"label-implicit",value:e},n)):N.isValidElement(e)?e.type===zs?N.cloneElement(e,Cr({key:"label-implicit"},n)):N.createElement(zs,is({key:"label-implicit",content:e},n)):s2(e)?N.createElement(zs,is({key:"label-implicit",content:e},n)):e&&typeof e=="object"?N.createElement(zs,is({},e,{key:"label-implicit"},n)):null};function pX(e){var{label:t,labelRef:r}=e,n=NO();return hX(t,n,r)||null}var kO={},_O={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(_O);var EO={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(EO);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=_O,r=EO,n=kp;function a(i){if(n.isArrayLike(i))return t.last(r.toArray(i))}e.last=a})(kO);var gX=kO.last;const xX=Es(gX);var vX=["valueAccessor"],yX=["dataKey","clockWise","id","textBreakAll"];function Sh(){return Sh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Sh.apply(null,arguments)}function k4(e,t){if(e==null)return{};var r,n,a=bX(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function bX(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var wX=e=>Array.isArray(e.value)?xX(e.value):e.value,CO=N.createContext(void 0),AO=CO.Provider,TO=N.createContext(void 0),NX=TO.Provider;function SX(){return N.useContext(CO)}function kX(){return N.useContext(TO)}function hm(e){var{valueAccessor:t=wX}=e,r=k4(e,vX),{dataKey:n,clockWise:a,id:i,textBreakAll:s}=r,o=k4(r,yX),c=SX(),u=kX(),d=c||u;return!d||!d.length?null:N.createElement(pn,{className:"recharts-label-list"},d.map((f,h)=>{var p,x=or(n)?t(f,h):Yt(f&&f.payload,n),g=or(i)?{}:{id:"".concat(i,"-").concat(h)};return N.createElement(zs,Sh({key:"label-".concat(h)},Kn(f),o,g,{fill:(p=r.fill)!==null&&p!==void 0?p:f.fill,parentViewBox:f.parentViewBox,value:x,textBreakAll:s,viewBox:f.viewBox,index:h}))}))}hm.displayName="LabelList";function o2(e){var{label:t}=e;return t?t===!0?N.createElement(hm,{key:"labelList-implicit"}):N.isValidElement(t)||s2(t)?N.createElement(hm,{key:"labelList-implicit",content:t}):typeof t=="object"?N.createElement(hm,Sh({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function jy(){return jy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jy.apply(null,arguments)}var PO=e=>{var{cx:t,cy:r,r:n,className:a}=e,i=It("recharts-dot",a);return t===+t&&r===+r&&n===+n?N.createElement("circle",jy({},Ra(e),_b(e),{className:i,cx:t,cy:r,r:n})):null},OO=e=>e.graphicalItems.polarItems,_X=me([cr,Lf],Ow),ig=me([OO,gr,_X],Dw),EX=me([ig],Rw),sg=me([EX,bw],Mw),CX=me([sg,gr,ig],Fw);me([sg,gr,ig],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(a=>{var i,s=Yt(n,(i=t.dataKey)!==null&&i!==void 0?i:a.dataKey);return{value:s,errorDomain:[]}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:Yt(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]})));var _4=()=>{},AX=me([sg,gr,ig,eg,cr],$w),TX=me([gr,Bw,jw,_4,AX,_4,Ot,cr],Uw),DO=me([gr,Ot,sg,CX,Ff,cr,TX],zw),PX=me([DO,gr,pu],Gw);me([gr,DO,PX,cr],Kw);var OX={radiusAxis:{},angleAxis:{}},RO=ja({name:"polarAxis",initialState:OX,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}});RO.actions;var DX=RO.reducer;function E4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function C4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?E4(Object(r),!0).forEach(function(n){RX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RX(e,t,r){return(t=MX(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MX(e){var t=IX(e,"string");return typeof t=="symbol"?t:t+""}function IX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FX=(e,t)=>t,l2=me([OO,FX],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),LX=[],c2=(e,t,r)=>(r==null?void 0:r.length)===0?LX:r,MO=me([bw,l2,c2],(e,t,r)=>{var{chartData:n}=e;if(t!=null){var a;if((t==null?void 0:t.data)!=null&&t.data.length>0?a=t.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(i=>C4(C4({},t.presentationProps),i.props))),a!=null)return a}}),BX=me([MO,l2,c2],(e,t,r)=>{if(!(e==null||t==null))return e.map((n,a)=>{var i,s=Yt(n,t.nameKey,t.name),o;return r!=null&&(i=r[a])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?o=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?o=n.fill:o=t.fill,{value:lu(s,t.dataKey),color:o,payload:n,type:t.legendType}})}),jX=me([MO,l2,c2,Wr],(e,t,r,n)=>{if(!(t==null||e==null))return Lq({offset:n,pieSettings:t,displayedData:e,cells:r})}),IO={exports:{}},Kt={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u2=Symbol.for("react.transitional.element"),d2=Symbol.for("react.portal"),og=Symbol.for("react.fragment"),lg=Symbol.for("react.strict_mode"),cg=Symbol.for("react.profiler"),ug=Symbol.for("react.consumer"),dg=Symbol.for("react.context"),fg=Symbol.for("react.forward_ref"),mg=Symbol.for("react.suspense"),hg=Symbol.for("react.suspense_list"),pg=Symbol.for("react.memo"),gg=Symbol.for("react.lazy"),$X=Symbol.for("react.view_transition"),UX=Symbol.for("react.client.reference");function mi(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case u2:switch(e=e.type,e){case og:case cg:case lg:case mg:case hg:case $X:return e;default:switch(e=e&&e.$$typeof,e){case dg:case fg:case gg:case pg:return e;case ug:return e;default:return t}}case d2:return t}}}Kt.ContextConsumer=ug;Kt.ContextProvider=dg;Kt.Element=u2;Kt.ForwardRef=fg;Kt.Fragment=og;Kt.Lazy=gg;Kt.Memo=pg;Kt.Portal=d2;Kt.Profiler=cg;Kt.StrictMode=lg;Kt.Suspense=mg;Kt.SuspenseList=hg;Kt.isContextConsumer=function(e){return mi(e)===ug};Kt.isContextProvider=function(e){return mi(e)===dg};Kt.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===u2};Kt.isForwardRef=function(e){return mi(e)===fg};Kt.isFragment=function(e){return mi(e)===og};Kt.isLazy=function(e){return mi(e)===gg};Kt.isMemo=function(e){return mi(e)===pg};Kt.isPortal=function(e){return mi(e)===d2};Kt.isProfiler=function(e){return mi(e)===cg};Kt.isStrictMode=function(e){return mi(e)===lg};Kt.isSuspense=function(e){return mi(e)===mg};Kt.isSuspenseList=function(e){return mi(e)===hg};Kt.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===og||e===cg||e===lg||e===mg||e===hg||typeof e=="object"&&e!==null&&(e.$$typeof===gg||e.$$typeof===pg||e.$$typeof===dg||e.$$typeof===ug||e.$$typeof===fg||e.$$typeof===UX||e.getModuleId!==void 0)};Kt.typeOf=mi;IO.exports=Kt;var zX=IO.exports,A4=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",T4=null,Ax=null,FO=e=>{if(e===T4&&Array.isArray(Ax))return Ax;var t=[];return N.Children.forEach(e,r=>{or(r)||(zX.isFragment(r)?t=t.concat(FO(r.props.children)):t.push(r))}),Ax=t,T4=e,t};function f2(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(a=>A4(a)):n=[A4(t)],FO(e).forEach(a=>{var i=xl(a,"type.displayName")||xl(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}var LO=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,BO={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var a;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const i=r[Symbol.toStringTag];return i==null||!((a=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&a.writable)?!1:r.toString()===`[object ${i}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t})(BO);var HX=BO.isPlainObject;const WX=Es(HX);function P4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function O4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?P4(Object(r),!0).forEach(function(n){GX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GX(e,t,r){return(t=VX(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VX(e){var t=KX(e,"string");return typeof t=="symbol"?t:t+""}function KX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kh(){return kh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kh.apply(null,arguments)}var D4=(e,t,r,n,a)=>{var i=r-n,s;return s="M ".concat(e,",").concat(t),s+="L ".concat(e+r,",").concat(t),s+="L ".concat(e+r-i/2,",").concat(t+a),s+="L ".concat(e+r-i/2-n,",").concat(t+a),s+="L ".concat(e,",").concat(t," Z"),s},XX={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},qX=e=>{var t=gn(e,XX),{x:r,y:n,upperWidth:a,lowerWidth:i,height:s,className:o}=t,{animationEasing:c,animationDuration:u,animationBegin:d,isUpdateAnimationActive:f}=t,h=N.useRef(null),[p,x]=N.useState(-1),g=N.useRef(a),y=N.useRef(i),v=N.useRef(s),w=N.useRef(r),b=N.useRef(n),S=Of(e,"trapezoid-");if(N.useEffect(()=>{if(h.current&&h.current.getTotalLength)try{var z=h.current.getTotalLength();z&&x(z)}catch{}},[]),r!==+r||n!==+n||a!==+a||i!==+i||s!==+s||a===0&&i===0||s===0)return null;var k=It("recharts-trapezoid",o);if(!f)return N.createElement("g",null,N.createElement("path",kh({},Kn(t),{className:k,d:D4(r,n,a,i,s)})));var _=g.current,E=y.current,P=v.current,A=w.current,T=b.current,R="0px ".concat(p===-1?1:p,"px"),D="".concat(p,"px 0px"),L=Q6(["strokeDasharray"],u,c);return N.createElement(Pf,{animationId:S,key:S,canBegin:p>0,duration:u,easing:c,isActive:f,begin:d},z=>{var X=br(_,a,z),Y=br(E,i,z),q=br(P,s,z),ee=br(A,r,z),V=br(T,n,z);h.current&&(g.current=X,y.current=Y,v.current=q,w.current=ee,b.current=V);var ae=z>0?{transition:L,strokeDasharray:D}:{strokeDasharray:R};return N.createElement("path",kh({},Kn(t),{className:k,d:D4(ee,V,X,Y,q),ref:h,style:O4(O4({},ae),t.style)}))})},YX=["option","shapeType","propTransformer","activeClassName","isActive"];function JX(e,t){if(e==null)return{};var r,n,a=QX(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function QX(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function R4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _h(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?R4(Object(r),!0).forEach(function(n){ZX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZX(e,t,r){return(t=eq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eq(e){var t=tq(e,"string");return typeof t=="symbol"?t:t+""}function tq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rq(e,t){return _h(_h({},t),e)}function nq(e,t){return e==="symbols"}function M4(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return N.createElement(r5,r);case"trapezoid":return N.createElement(qX,r);case"sector":return N.createElement(i5,r);case"symbols":if(nq(t))return N.createElement(kb,r);break;default:return null}}function aq(e){return N.isValidElement(e)?e.props:e}function jO(e){var{option:t,shapeType:r,propTransformer:n=rq,activeClassName:a="recharts-active-shape",isActive:i}=e,s=JX(e,YX),o;if(N.isValidElement(t))o=N.cloneElement(t,_h(_h({},s),aq(t)));else if(typeof t=="function")o=t(s);else if(WX(t)&&typeof t!="boolean"){var c=n(t,s);o=N.createElement(M4,{shapeType:r,elementProps:c})}else{var u=s;o=N.createElement(M4,{shapeType:r,elementProps:u})}return i?N.createElement(pn,{className:a},o):o}var m2=(e,t)=>{var r=lr();return(n,a)=>i=>{e==null||e(n,a,i),r(WP({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}},h2=e=>{var t=lr();return(r,n)=>a=>{e==null||e(r,n,a),t(ZG())}},p2=(e,t)=>{var r=lr();return(n,a)=>i=>{e==null||e(n,a,i),r(eV({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}};function g2(e){var{fn:t,args:r}=e,n=lr(),a=Jn();return N.useLayoutEffect(()=>{if(!a){var i=t(r);return n(YG(i)),()=>{n(JG(i))}}},[t,r,n,a]),null}var $O=()=>{};function UO(e){var{legendPayload:t}=e,r=lr(),n=Jn();return N.useLayoutEffect(()=>n?$O:(r(q6(t)),()=>{r(Y6(t))}),[r,n,t]),null}function iq(e){var{legendPayload:t}=e,r=lr(),n=Ve(Ot);return N.useLayoutEffect(()=>n!=="centric"&&n!=="radial"?$O:(r(q6(t)),()=>{r(Y6(t))}),[r,n,t]),null}var Tx,sq=()=>{var[e]=N.useState(()=>Wd("uid-"));return e},oq=(Tx=nI["useId".toString()])!==null&&Tx!==void 0?Tx:sq;function lq(e,t){var r=oq();return t||(e?"".concat(e,"-").concat(r):r)}var cq=N.createContext(void 0),x2=e=>{var{id:t,type:r,children:n}=e,a=lq("recharts-".concat(r),t);return N.createElement(cq.Provider,{value:a},n(a))},uq={cartesianItems:[],polarItems:[]},zO=ja({name:"graphicalItems",initialState:uq,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:Un()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:r,next:n}=t.payload,a=ms(e).cartesianItems.indexOf(r);a>-1&&(e.cartesianItems[a]=n)},prepare:Un()},removeCartesianGraphicalItem:{reducer(e,t){var r=ms(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},prepare:Un()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:Un()},removePolarGraphicalItem:{reducer(e,t){var r=ms(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)},prepare:Un()}}}),{addCartesianGraphicalItem:dq,replaceCartesianGraphicalItem:fq,removeCartesianGraphicalItem:mq,addPolarGraphicalItem:hq,removePolarGraphicalItem:pq}=zO.actions,gq=zO.reducer;function HO(e){var t=lr(),r=N.useRef(null);return N.useLayoutEffect(()=>{r.current===null?t(dq(e)):r.current!==e&&t(fq({prev:r.current,next:e})),r.current=e},[t,e]),N.useLayoutEffect(()=>()=>{r.current&&(t(mq(r.current)),r.current=null)},[t]),null}function xq(e){var t=lr();return N.useLayoutEffect(()=>(t(hq(e)),()=>{t(pq(e))}),[t,e]),null}var vq=["onMouseEnter","onClick","onMouseLeave"],yq=["id"],bq=["id"];function v2(e,t){if(e==null)return{};var r,n,a=wq(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function wq(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function I4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ar(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?I4(Object(r),!0).forEach(function(n){Nq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Nq(e,t,r){return(t=Sq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Sq(e){var t=kq(e,"string");return typeof t=="symbol"?t:t+""}function kq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vo(){return vo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vo.apply(null,arguments)}function _q(e){var t=N.useMemo(()=>f2(e.children,il),[e.children]),r=Ve(n=>BX(n,e.id,t));return r==null?null:N.createElement(iq,{legendPayload:r})}function Eq(e){var{dataKey:t,nameKey:r,sectors:n,stroke:a,strokeWidth:i,fill:s,name:o,hide:c,tooltipType:u}=e;return{dataDefinedOnItem:n.map(d=>d.tooltipPayload),positions:n.map(d=>d.tooltipPosition),settings:{stroke:a,strokeWidth:i,fill:s,dataKey:t,nameKey:r,name:lu(o,t),hide:c,type:u,color:s,unit:""}}}var Cq=(e,t)=>e>t?"start":e<t?"end":"middle",Aq=(e,t,r)=>Pn(typeof t=="function"?t(e):t,r,r*.8),Tq=(e,t,r)=>{var{top:n,left:a,width:i,height:s}=t,o=M6(i,s),c=a+Pn(e.cx,i,i/2),u=n+Pn(e.cy,s,s/2),d=Pn(e.innerRadius,o,0),f=Aq(r,e.outerRadius,o),h=e.maxRadius||Math.sqrt(i*i+s*s)/2;return{cx:c,cy:u,innerRadius:d,outerRadius:f,maxRadius:h}},Pq=(e,t)=>{var r=tn(t-e),n=Math.min(Math.abs(t-e),360);return r*n};function Oq(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var Dq=(e,t)=>{if(N.isValidElement(e))return N.cloneElement(e,t);if(typeof e=="function")return e(t);var r=It("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return N.createElement(Yb,vo({},t,{type:"linear",className:r}))},Rq=(e,t,r)=>{if(N.isValidElement(e))return N.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),N.isValidElement(n)))return n;var a=It("recharts-pie-label-text",Oq(e));return N.createElement(ag,vo({},t,{alignmentBaseline:"middle",className:a}),n)};function Mq(e){var{sectors:t,props:r,showLabels:n}=e,{label:a,labelLine:i,dataKey:s}=r;if(!n||!a||!t)return null;var o=Ra(r),c=gl(a),u=gl(i),d=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,f=t.map((h,p)=>{var x=(h.startAngle+h.endAngle)/2,g=Ir(h.cx,h.cy,h.outerRadius+d,x),y=ar(ar(ar(ar({},o),h),{},{stroke:"none"},c),{},{index:p,textAnchor:Cq(g.x,h.cx)},g),v=ar(ar(ar(ar({},o),h),{},{fill:"none",stroke:h.fill},u),{},{index:p,points:[Ir(h.cx,h.cy,h.outerRadius,x),g],key:"line"});return N.createElement(pn,{key:"label-".concat(h.startAngle,"-").concat(h.endAngle,"-").concat(h.midAngle,"-").concat(p)},i&&Dq(i,v),Rq(a,y,Yt(h,s)))});return N.createElement(pn,{className:"recharts-pie-labels"},f)}function Iq(e){var{sectors:t,props:r,showLabels:n}=e,{label:a}=r;return typeof a=="object"&&a!=null&&"position"in a?N.createElement(o2,{label:a}):N.createElement(Mq,{sectors:t,props:r,showLabels:n})}function Fq(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:a}=e,i=Ve(xo),{onMouseEnter:s,onClick:o,onMouseLeave:c}=a,u=v2(a,vq),d=m2(s,a.dataKey),f=h2(c),h=p2(o,a.dataKey);return t==null||t.length===0?null:N.createElement(N.Fragment,null,t.map((p,x)=>{if((p==null?void 0:p.startAngle)===0&&(p==null?void 0:p.endAngle)===0&&t.length!==1)return null;var g=r&&String(x)===i,y=i?n:null,v=g?r:y,w=ar(ar({},p),{},{stroke:p.stroke,tabIndex:-1,[j6]:x,[$6]:a.dataKey});return N.createElement(pn,vo({key:"sector-".concat(p==null?void 0:p.startAngle,"-").concat(p==null?void 0:p.endAngle,"-").concat(p.midAngle,"-").concat(x),tabIndex:-1,className:"recharts-pie-sector"},Ef(u,p,x),{onMouseEnter:d(p,x),onMouseLeave:f(p,x),onClick:h(p,x)}),N.createElement(jO,vo({option:v,isActive:g,shapeType:"sector"},w)))}))}function Lq(e){var t,{pieSettings:r,displayedData:n,cells:a,offset:i}=e,{cornerRadius:s,startAngle:o,endAngle:c,dataKey:u,nameKey:d,tooltipType:f}=r,h=Math.abs(r.minAngle),p=Pq(o,c),x=Math.abs(p),g=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,y=n.filter(_=>Yt(_,u,0)!==0).length,v=(x>=360?y:y-1)*g,w=x-y*h-v,b=n.reduce((_,E)=>{var P=Yt(E,u,0);return _+(Je(P)?P:0)},0),S;if(b>0){var k;S=n.map((_,E)=>{var P=Yt(_,u,0),A=Yt(_,d,E),T=Tq(r,i,_),R=(Je(P)?P:0)/b,D,L=ar(ar({},_),a&&a[E]&&a[E].props);E?D=k.endAngle+tn(p)*g*(P!==0?1:0):D=o;var z=D+tn(p)*((P!==0?h:0)+R*w),X=(D+z)/2,Y=(T.innerRadius+T.outerRadius)/2,q=[{name:A,value:P,payload:L,dataKey:u,type:f}],ee=Ir(T.cx,T.cy,Y,X);return k=ar(ar(ar(ar({},r.presentationProps),{},{percent:R,cornerRadius:s,name:A,tooltipPayload:q,midAngle:X,middleRadius:Y,tooltipPosition:ee},L),T),{},{value:P,startAngle:D,endAngle:z,payload:L,paddingAngle:tn(p)*g}),k})}return S}function Bq(e){var{showLabels:t,sectors:r,children:n}=e,a=N.useMemo(()=>!t||!r?[]:r.map(i=>({value:i.value,payload:i.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:i.cx,cy:i.cy,innerRadius:i.innerRadius,outerRadius:i.outerRadius,startAngle:i.startAngle,endAngle:i.endAngle,clockWise:!1},fill:i.fill})),[r,t]);return N.createElement(NX,{value:t?a:void 0},n)}function jq(e){var{props:t,previousSectorsRef:r}=e,{sectors:n,isAnimationActive:a,animationBegin:i,animationDuration:s,animationEasing:o,activeShape:c,inactiveShape:u,onAnimationStart:d,onAnimationEnd:f}=t,h=Of(t,"recharts-pie-"),p=r.current,[x,g]=N.useState(!1),y=N.useCallback(()=>{typeof f=="function"&&f(),g(!1)},[f]),v=N.useCallback(()=>{typeof d=="function"&&d(),g(!0)},[d]);return N.createElement(Bq,{showLabels:!x,sectors:n},N.createElement(Pf,{animationId:h,begin:i,duration:s,isActive:a,easing:o,onAnimationStart:v,onAnimationEnd:y,key:h},w=>{var b=[],S=n&&n[0],k=S==null?void 0:S.startAngle;return n==null||n.forEach((_,E)=>{var P=p&&p[E],A=E>0?xl(_,"paddingAngle",0):0;if(P){var T=br(P.endAngle-P.startAngle,_.endAngle-_.startAngle,w),R=ar(ar({},_),{},{startAngle:k+A,endAngle:k+T+A});b.push(R),k=R.endAngle}else{var{endAngle:D,startAngle:L}=_,z=br(0,D-L,w),X=ar(ar({},_),{},{startAngle:k+A,endAngle:k+z+A});b.push(X),k=X.endAngle}}),r.current=b,N.createElement(pn,null,N.createElement(Fq,{sectors:b,activeShape:c,inactiveShape:u,allOtherPieProps:t}))}),N.createElement(Iq,{showLabels:!x,sectors:n,props:t}),t.children)}var $q={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!Ao.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function Uq(e){var{id:t}=e,r=v2(e,yq),{hide:n,className:a,rootTabIndex:i}=e,s=N.useMemo(()=>f2(e.children,il),[e.children]),o=Ve(d=>jX(d,t,s)),c=N.useRef(null),u=It("recharts-pie",a);return n||o==null?(c.current=null,N.createElement(pn,{tabIndex:i,className:u})):N.createElement(N.Fragment,null,N.createElement(g2,{fn:Eq,args:ar(ar({},e),{},{sectors:o})}),N.createElement(pn,{tabIndex:i,className:u},N.createElement(jq,{props:ar(ar({},r),{},{sectors:o}),previousSectorsRef:c})))}function pm(e){var t=gn(e,$q),{id:r}=t,n=v2(t,bq),a=Ra(n);return N.createElement(x2,{id:r,type:"pie"},i=>N.createElement(N.Fragment,null,N.createElement(xq,{type:"pie",id:i,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:a,maxRadius:t.maxRadius}),N.createElement(_q,vo({},n,{id:i})),N.createElement(Uq,vo({},n,{id:i}))))}pm.displayName="Pie";function F4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function L4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?F4(Object(r),!0).forEach(function(n){zq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zq(e,t,r){return(t=Hq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hq(e){var t=Wq(e,"string");return typeof t=="symbol"?t:t+""}function Wq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Gq={xAxis:{},yAxis:{},zAxis:{}},WO=ja({name:"cartesianAxis",initialState:Gq,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:Un()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:Un()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:Un()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:Un()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:Un()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:Un()},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload,a=e.yAxis[r];if(a){var i=a.widthHistory||[];if(i.length===3&&i[0]===i[2]&&n===i[1]&&n!==a.width&&Math.abs(n-i[0])<=1)return;var s=[...i,n].slice(-3);e.yAxis[r]=L4(L4({},e.yAxis[r]),{},{width:n,widthHistory:s})}}}}),{addXAxis:Vq,removeXAxis:Kq,addYAxis:Xq,removeYAxis:qq,addZAxis:zfe,removeZAxis:Hfe,updateYAxisWidth:Yq}=WO.actions,Jq=WO.reducer,Qq=me([Wr],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),Zq=me([Qq,As,Ts],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),y2=()=>Ve(Zq),eY=()=>Ve($V);function B4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function j4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?B4(Object(r),!0).forEach(function(n){tY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tY(e,t,r){return(t=rY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rY(e){var t=nY(e,"string");return typeof t=="symbol"?t:t+""}function nY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aY=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:a,dataKey:i}=e;if(a===!1||t.x==null||t.y==null)return null;var s=j4(j4({index:r,dataKey:i,cx:t.x,cy:t.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},gl(a)),_b(a)),o;return N.isValidElement(a)?o=N.cloneElement(a,s):typeof a=="function"?o=a(s):o=N.createElement(PO,s),N.createElement(pn,{className:"recharts-active-dot"},o)};function iY(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:a}=e,i=Ve(xo),s=eY();if(t==null||s==null)return null;var o=t.find(c=>s.includes(c.payload));return or(o)?null:aY({point:o,childIndex:Number(i),mainColor:r,dataKey:a,activeDot:n})}var sY=!0,Px="Invariant failed";function oY(e,t){if(!e){if(sY)throw new Error(Px);var r=typeof t=="function"?t():t,n=r?"".concat(Px,": ").concat(r):Px;throw new Error(n)}}var lY=["x","y"];function $y(){return $y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$y.apply(null,arguments)}function $4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ku(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$4(Object(r),!0).forEach(function(n){cY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cY(e,t,r){return(t=uY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uY(e){var t=dY(e,"string");return typeof t=="symbol"?t:t+""}function dY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fY(e,t){if(e==null)return{};var r,n,a=mY(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function mY(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function hY(e,t){var{x:r,y:n}=e,a=fY(e,lY),i="".concat(r),s=parseInt(i,10),o="".concat(n),c=parseInt(o,10),u="".concat(t.height||a.height),d=parseInt(u,10),f="".concat(t.width||a.width),h=parseInt(f,10);return Ku(Ku(Ku(Ku(Ku({},t),a),s?{x:s}:{}),c?{y:c}:{}),{},{height:d,width:h,name:t.name,radius:t.radius})}function b2(e){return N.createElement(jO,$y({shapeType:"rectangle",propTransformer:hY,activeClassName:"recharts-active-bar"},e))}var pY=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(Je(t))return t;var i=Je(n)||or(n);return i?t(n,a):(i||oY(!1),r)}},gY={},GO=ja({name:"errorBars",initialState:gY,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:a}=t.payload;e[r]&&(e[r]=e[r].map(i=>i.dataKey===n.dataKey&&i.direction===n.direction?a:i))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}});GO.actions;var xY=GO.reducer,vY=["children"];function yY(e,t){if(e==null)return{};var r,n,a=bY(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function bY(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var wY={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},NY=N.createContext(wY);function VO(e){var{children:t}=e,r=yY(e,vY);return N.createElement(NY.Provider,{value:r},t)}function w2(e,t){var r,n,a=Ve(u=>Os(u,e)),i=Ve(u=>Ds(u,t)),s=(r=a==null?void 0:a.allowDataOverflow)!==null&&r!==void 0?r:da.allowDataOverflow,o=(n=i==null?void 0:i.allowDataOverflow)!==null&&n!==void 0?n:fa.allowDataOverflow,c=s||o;return{needClip:c,needClipX:s,needClipY:o}}function KO(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,a=y2(),{needClipX:i,needClipY:s,needClip:o}=w2(t,r);if(!o)return null;var{x:c,y:u,width:d,height:f}=a;return N.createElement("clipPath",{id:"clipPath-".concat(n)},N.createElement("rect",{x:i?c:c-d/2,y:s?u:u-f/2,width:i?d:d*2,height:s?f:f*2}))}var SY=["onMouseEnter","onMouseLeave","onClick"],kY=["value","background","tooltipPosition"],_Y=["id"],EY=["onMouseEnter","onClick","onMouseLeave"];function yo(){return yo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yo.apply(null,arguments)}function U4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function zn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?U4(Object(r),!0).forEach(function(n){CY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CY(e,t,r){return(t=AY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AY(e){var t=TY(e,"string");return typeof t=="symbol"?t:t+""}function TY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Eh(e,t){if(e==null)return{};var r,n,a=PY(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function PY(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var OY=e=>{var{dataKey:t,name:r,fill:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:lu(r,t),payload:e}]};function DY(e){var{dataKey:t,stroke:r,strokeWidth:n,fill:a,name:i,hide:s,unit:o}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:t,nameKey:void 0,name:lu(i,t),hide:s,type:e.tooltipType,color:e.fill,unit:o}}}function RY(e){var t=Ve(xo),{data:r,dataKey:n,background:a,allOtherBarProps:i}=e,{onMouseEnter:s,onMouseLeave:o,onClick:c}=i,u=Eh(i,SY),d=m2(s,n),f=h2(o),h=p2(c,n);if(!a||r==null)return null;var p=gl(a);return N.createElement(N.Fragment,null,r.map((x,g)=>{var{value:y,background:v,tooltipPosition:w}=x,b=Eh(x,kY);if(!v)return null;var S=d(x,g),k=f(x,g),_=h(x,g),E=zn(zn(zn(zn(zn({option:a,isActive:String(g)===t},b),{},{fill:"#eee"},v),p),Ef(u,x,g)),{},{onMouseEnter:S,onMouseLeave:k,onClick:_,dataKey:n,index:g,className:"recharts-bar-background-rectangle"});return N.createElement(b2,yo({key:"background-bar-".concat(g)},E))}))}function MY(e){var{showLabels:t,children:r,rects:n}=e,a=n==null?void 0:n.map(i=>{var s={x:i.x,y:i.y,width:i.width,height:i.height};return zn(zn({},s),{},{value:i.value,payload:i.payload,parentViewBox:i.parentViewBox,viewBox:s,fill:i.fill})});return N.createElement(AO,{value:t?a:void 0},r)}function IY(e){var{shape:t,activeBar:r,baseProps:n,entry:a,index:i,dataKey:s}=e,o=Ve(xo),c=Ve(iO),u=r&&String(i)===o&&(c==null||s===c),d=u?r:t;return N.createElement(b2,yo({},n,{name:String(n.name)},a,{isActive:u,option:d,index:i,dataKey:s}))}function FY(e){var{shape:t,baseProps:r,entry:n,index:a,dataKey:i}=e;return N.createElement(b2,yo({},r,{name:String(r.name)},n,{isActive:!1,option:t,index:a,dataKey:i}))}function LY(e){var{data:t,props:r}=e,n=Ra(r),a=Eh(n,_Y),{shape:i,dataKey:s,activeBar:o}=r,{onMouseEnter:c,onClick:u,onMouseLeave:d}=r,f=Eh(r,EY),h=m2(c,s),p=h2(d),x=p2(u,s);return t?N.createElement(N.Fragment,null,t.map((g,y)=>N.createElement(pn,yo({key:"rectangle-".concat(g==null?void 0:g.x,"-").concat(g==null?void 0:g.y,"-").concat(g==null?void 0:g.value,"-").concat(y),className:"recharts-bar-rectangle"},Ef(f,g,y),{onMouseEnter:h(g,y),onMouseLeave:p(g,y),onClick:x(g,y)}),o?N.createElement(IY,{shape:i,activeBar:o,baseProps:a,entry:g,index:y,dataKey:s}):N.createElement(FY,{shape:i,baseProps:a,entry:g,index:y,dataKey:s})))):null}function BY(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:a,isAnimationActive:i,animationBegin:s,animationDuration:o,animationEasing:c,onAnimationEnd:u,onAnimationStart:d}=t,f=r.current,h=Of(t,"recharts-bar-"),[p,x]=N.useState(!1),g=!p,y=N.useCallback(()=>{typeof u=="function"&&u(),x(!1)},[u]),v=N.useCallback(()=>{typeof d=="function"&&d(),x(!0)},[d]);return N.createElement(MY,{showLabels:g,rects:n},N.createElement(Pf,{animationId:h,begin:s,duration:o,isActive:i,easing:c,onAnimationEnd:y,onAnimationStart:v,key:h},w=>{var b=w===1?n:n==null?void 0:n.map((S,k)=>{var _=f&&f[k];if(_)return zn(zn({},S),{},{x:br(_.x,S.x,w),y:br(_.y,S.y,w),width:br(_.width,S.width,w),height:br(_.height,S.height,w)});if(a==="horizontal"){var E=br(0,S.height,w);return zn(zn({},S),{},{y:S.y+S.height-E,height:E})}var P=br(0,S.width,w);return zn(zn({},S),{},{width:P})});return w>0&&(r.current=b??null),b==null?null:N.createElement(pn,null,N.createElement(LY,{props:t,data:b}))}),N.createElement(o2,{label:t.label}),t.children)}function jY(e){var t=N.useRef(null);return N.createElement(BY,{previousRectanglesRef:t,props:e})}var XO=0,$Y=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:Yt(e,t)}};class UY extends N.PureComponent{render(){var{hide:t,data:r,dataKey:n,className:a,xAxisId:i,yAxisId:s,needClip:o,background:c,id:u}=this.props;if(t||r==null)return null;var d=It("recharts-bar",a),f=u;return N.createElement(pn,{className:d,id:u},o&&N.createElement("defs",null,N.createElement(KO,{clipPathId:f,xAxisId:i,yAxisId:s})),N.createElement(pn,{className:"recharts-bar-rectangles",clipPath:o?"url(#clipPath-".concat(f,")"):void 0},N.createElement(RY,{data:r,dataKey:n,background:c,allOtherBarProps:this.props}),N.createElement(jY,this.props)))}}var zY={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!Ao.isSsr,legendType:"rect",minPointSize:XO,xAxisId:0,yAxisId:0};function HY(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:s,animationBegin:o,animationDuration:c,animationEasing:u,isAnimationActive:d}=e,{needClip:f}=w2(t,r),h=Lp(),p=Jn(),x=f2(e.children,il),g=Ve(w=>xJ(w,t,r,p,e.id,x));if(h!=="vertical"&&h!=="horizontal")return null;var y,v=g==null?void 0:g[0];return v==null||v.height==null||v.width==null?y=0:y=h==="vertical"?v.height/2:v.width/2,N.createElement(VO,{xAxisId:t,yAxisId:r,data:g,dataPointFormatter:$Y,errorBarOffset:y},N.createElement(UY,yo({},e,{layout:h,needClip:f,data:g,xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:s,animationBegin:o,animationDuration:c,animationEasing:u,isAnimationActive:d})))}function WY(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:i,xAxis:s,yAxis:o,xAxisTicks:c,yAxisTicks:u,stackedData:d,displayedData:f,offset:h,cells:p,parentViewBox:x}=e,g=t==="horizontal"?o:s,y=d?g.scale.domain():null,v=e$({numericAxis:g});return f.map((w,b)=>{var S,k,_,E,P,A;d?S=X9(d[b],y):(S=Yt(w,r),Array.isArray(S)||(S=[v,S]));var T=pY(n,XO)(S[1],b);if(t==="horizontal"){var R,[D,L]=[o.scale(S[0]),o.scale(S[1])];k=Lk({axis:s,ticks:c,bandSize:i,offset:a.offset,entry:w,index:b}),_=(R=L??D)!==null&&R!==void 0?R:void 0,E=a.size;var z=D-L;if(P=ci(z)?0:z,A={x:k,y:h.top,width:E,height:h.height},Math.abs(T)>0&&Math.abs(P)<Math.abs(T)){var X=tn(P||T)*(Math.abs(T)-Math.abs(P));_-=X,P+=X}}else{var[Y,q]=[s.scale(S[0]),s.scale(S[1])];if(k=Y,_=Lk({axis:o,ticks:u,bandSize:i,offset:a.offset,entry:w,index:b}),E=q-Y,P=a.size,A={x:h.left,y:_,width:h.width,height:P},Math.abs(T)>0&&Math.abs(E)<Math.abs(T)){var ee=tn(E||T)*(Math.abs(T)-Math.abs(E));E+=ee}}if(k==null||_==null||E==null||P==null)return null;var V=zn(zn({},w),{},{x:k,y:_,width:E,height:P,value:d?S:S[1],payload:w,background:A,tooltipPosition:{x:k+E/2,y:_+P/2},parentViewBox:x},p&&p[b]&&p[b].props);return V}).filter(Boolean)}function GY(e){var t=gn(e,zY),r=Jn();return N.createElement(x2,{id:t.id,type:"bar"},n=>N.createElement(N.Fragment,null,N.createElement(UO,{legendPayload:OY(t)}),N.createElement(g2,{fn:DY,args:t}),N.createElement(HO,{type:"bar",id:n,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:Z9(t.stackId),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:r}),N.createElement(HY,yo({},t,{id:n}))))}var Xs=N.memo(GY);Xs.displayName="Bar";function z4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function F0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?z4(Object(r),!0).forEach(function(n){VY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VY(e,t,r){return(t=KY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KY(e){var t=XY(e,"string");return typeof t=="symbol"?t:t+""}function XY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qY=(e,t)=>t,YY=(e,t,r)=>r,JY=(e,t,r,n)=>n,QY=(e,t,r,n,a)=>a,Hf=me([Qp,QY],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),ZY=me([Hf],e=>e==null?void 0:e.maxBarSize),eJ=(e,t,r,n,a,i)=>i,H4=(e,t,r)=>{var n=r??e;if(!or(n))return Pn(n,t,0)},tJ=me([Ot,Qp,qY,YY,JY],(e,t,r,n,a)=>t.filter(i=>e==="horizontal"?i.xAxisId===r:i.yAxisId===n).filter(i=>i.isPanorama===a).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),rJ=(e,t,r,n)=>{var a=Ot(e);return a==="horizontal"?Ry(e,"yAxis",r,n):Ry(e,"xAxis",t,n)},nJ=(e,t,r)=>{var n=Ot(e);return n==="horizontal"?Z_(e,"xAxis",t):Z_(e,"yAxis",r)},aJ=(e,t,r)=>{var n={},a=e.filter(qp),i=e.filter(u=>u.stackId==null),s=a.reduce((u,d)=>(u[d.stackId]||(u[d.stackId]=[]),u[d.stackId].push(d),u),n),o=Object.entries(s).map(u=>{var[d,f]=u,h=f.map(x=>x.dataKey),p=H4(t,r,f[0].barSize);return{stackId:d,dataKeys:h,barSize:p}}),c=i.map(u=>{var d=[u.dataKey].filter(h=>h!=null),f=H4(t,r,u.barSize);return{stackId:void 0,dataKeys:d,barSize:f}});return[...o,...c]},iJ=me([tJ,VW,nJ],aJ),sJ=(e,t,r,n,a)=>{var i,s,o=Hf(e,t,r,n,a);if(o!=null){var c=Ot(e),u=iP(e),{maxBarSize:d}=o,f=or(d)?u:d,h,p;return c==="horizontal"?(h=go(e,"xAxis",t,n),p=po(e,"xAxis",t,n)):(h=go(e,"yAxis",r,n),p=po(e,"yAxis",r,n)),(i=(s=Kd(h,p,!0))!==null&&s!==void 0?s:f)!==null&&i!==void 0?i:0}},qO=(e,t,r,n)=>{var a=Ot(e),i,s;return a==="horizontal"?(i=go(e,"xAxis",t,n),s=po(e,"xAxis",t,n)):(i=go(e,"yAxis",r,n),s=po(e,"yAxis",r,n)),Kd(i,s)};function oJ(e,t,r,n,a){var i=n.length;if(!(i<1)){var s=Pn(e,r,0,!0),o,c=[];if(Mn(n[0].barSize)){var u=!1,d=r/i,f=n.reduce((v,w)=>v+(w.barSize||0),0);f+=(i-1)*s,f>=r&&(f-=(i-1)*s,s=0),f>=r&&d>0&&(u=!0,d*=.9,f=i*d);var h=(r-f)/2>>0,p={offset:h-s,size:0};o=n.reduce((v,w)=>{var b,S={stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:p.offset+p.size+s,size:u?d:(b=w.barSize)!==null&&b!==void 0?b:0}},k=[...v,S];return p=k[k.length-1].position,k},c)}else{var x=Pn(t,r,0,!0);r-2*x-(i-1)*s<=0&&(s=0);var g=(r-2*x-(i-1)*s)/i;g>1&&(g>>=0);var y=Mn(a)?Math.min(g,a):g;o=n.reduce((v,w,b)=>[...v,{stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:x+(g+s)*b+(g-y)/2,size:y}}],c)}return o}}var lJ=(e,t,r,n,a,i,s)=>{var o=or(s)?t:s,c=oJ(r,n,a!==i?a:i,e,o);return a!==i&&c!=null&&(c=c.map(u=>F0(F0({},u),{},{position:F0(F0({},u.position),{},{offset:u.position.offset-a/2})}))),c},cJ=me([iJ,iP,GW,sP,sJ,qO,ZY],lJ),uJ=(e,t,r,n)=>go(e,"xAxis",t,n),dJ=(e,t,r,n)=>go(e,"yAxis",r,n),fJ=(e,t,r,n)=>po(e,"xAxis",t,n),mJ=(e,t,r,n)=>po(e,"yAxis",r,n),hJ=me([cJ,Hf],(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),pJ=(e,t)=>{var r=Tw(t);if(!(!e||r==null||t==null)){var{stackId:n}=t;if(n!=null){var a=e[n];if(a){var{stackedData:i}=a;if(i)return i.find(s=>s.key===r)}}}},gJ=me([rJ,Hf],pJ),xJ=me([Wr,Gb,uJ,dJ,fJ,mJ,hJ,Ot,Gp,qO,gJ,Hf,eJ],(e,t,r,n,a,i,s,o,c,u,d,f,h)=>{var{chartData:p,dataStartIndex:x,dataEndIndex:g}=c;if(!(f==null||s==null||t==null||o!=="horizontal"&&o!=="vertical"||r==null||n==null||a==null||i==null||u==null)){var{data:y}=f,v;if(y!=null&&y.length>0?v=y:v=p==null?void 0:p.slice(x,g+1),v!=null)return WY({layout:o,barSettings:f,pos:s,parentViewBox:t,bandSize:u,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,stackedData:d,displayedData:v,offset:e,cells:h})}}),YO=e=>{var{chartData:t}=e,r=lr(),n=Jn();return N.useEffect(()=>n?()=>{}:(r(l4(t)),()=>{r(l4(void 0))}),[t,r,n]),null},W4={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},JO=ja({name:"brush",initialState:W4,reducers:{setBrushSettings(e,t){return t.payload==null?W4:t.payload}}});JO.actions;var vJ=JO.reducer;function yJ(e,t,r){return(t=bJ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bJ(e){var t=wJ(e,"string");return typeof t=="symbol"?t:t+""}function wJ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class N2{static create(t){return new N2(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+a}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+s}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],a=r[r.length-1];return n<=a?t>=n&&t<=a:t>=a&&t<=n}}yJ(N2,"EPS",1e-4);function NJ(e){return(e%180+180)%180}var SJ=function(t){var{width:r,height:n}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=NJ(a),s=i*Math.PI/180,o=Math.atan(n/r),c=s>o&&s<Math.PI-o?n/Math.sin(s):r/Math.cos(s);return Math.abs(c)},kJ={dots:[],areas:[],lines:[]},QO=ja({name:"referenceElements",initialState:kJ,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=ms(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=ms(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=ms(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}});QO.actions;var _J=QO.reducer,EJ=N.createContext(void 0),CJ=e=>{var{children:t}=e,[r]=N.useState("".concat(Wd("recharts"),"-clip")),n=y2();if(n==null)return null;var{x:a,y:i,width:s,height:o}=n;return N.createElement(EJ.Provider,{value:r},N.createElement("defs",null,N.createElement("clipPath",{id:r},N.createElement("rect",{x:a,y:i,height:o,width:s}))),t)};function qc(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function ZO(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)if(r===void 0||r(e[a])===!0)n.push(e[a]);else return;return n}function AJ(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return SJ(n,r)}function TJ(e,t,r){var n=r==="width",{x:a,y:i,width:s,height:o}=e;return t===1?{start:n?a:i,end:n?a+s:i+o}:{start:n?a+s:i+o,end:n?a:i}}function Ch(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function PJ(e,t){return ZO(e,t+1)}function OJ(e,t,r,n,a){for(var i=(n||[]).slice(),{start:s,end:o}=t,c=0,u=1,d=s,f=function(){var x=n==null?void 0:n[c];if(x===void 0)return{v:ZO(n,u)};var g=c,y,v=()=>(y===void 0&&(y=r(x,g)),y),w=x.coordinate,b=c===0||Ch(e,w,v,d,o);b||(c=0,d=s,u+=1),b&&(d=w+e*(v()/2+a),c+=u)},h;u<=i.length;)if(h=f(),h)return h.v;return[]}function G4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function wn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?G4(Object(r),!0).forEach(function(n){DJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DJ(e,t,r){return(t=RJ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RJ(e){var t=MJ(e,"string");return typeof t=="symbol"?t:t+""}function MJ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function IJ(e,t,r,n,a){for(var i=(n||[]).slice(),s=i.length,{start:o}=t,{end:c}=t,u=function(h){var p=i[h],x,g=()=>(x===void 0&&(x=r(p,h)),x);if(h===s-1){var y=e*(p.coordinate+e*g()/2-c);i[h]=p=wn(wn({},p),{},{tickCoord:y>0?p.coordinate-y*e:p.coordinate})}else i[h]=p=wn(wn({},p),{},{tickCoord:p.coordinate});var v=Ch(e,p.tickCoord,g,o,c);v&&(c=p.tickCoord-e*(g()/2+a),i[h]=wn(wn({},p),{},{isShow:!0}))},d=s-1;d>=0;d--)u(d);return i}function FJ(e,t,r,n,a,i){var s=(n||[]).slice(),o=s.length,{start:c,end:u}=t;if(i){var d=n[o-1],f=r(d,o-1),h=e*(d.coordinate+e*f/2-u);s[o-1]=d=wn(wn({},d),{},{tickCoord:h>0?d.coordinate-h*e:d.coordinate});var p=Ch(e,d.tickCoord,()=>f,c,u);p&&(u=d.tickCoord-e*(f/2+a),s[o-1]=wn(wn({},d),{},{isShow:!0}))}for(var x=i?o-1:o,g=function(w){var b=s[w],S,k=()=>(S===void 0&&(S=r(b,w)),S);if(w===0){var _=e*(b.coordinate-e*k()/2-c);s[w]=b=wn(wn({},b),{},{tickCoord:_<0?b.coordinate-_*e:b.coordinate})}else s[w]=b=wn(wn({},b),{},{tickCoord:b.coordinate});var E=Ch(e,b.tickCoord,k,c,u);E&&(c=b.tickCoord+e*(k()/2+a),s[w]=wn(wn({},b),{},{isShow:!0}))},y=0;y<x;y++)g(y);return s}function S2(e,t,r){var{tick:n,ticks:a,viewBox:i,minTickGap:s,orientation:o,interval:c,tickFormatter:u,unit:d,angle:f}=e;if(!a||!a.length||!n)return[];if(Je(c)||Ao.isSsr){var h;return(h=PJ(a,Je(c)?c:0))!==null&&h!==void 0?h:[]}var p=[],x=o==="top"||o==="bottom"?"width":"height",g=d&&x==="width"?gd(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},y=(b,S)=>{var k=typeof u=="function"?u(b.value,S):b.value;return x==="width"?AJ(gd(k,{fontSize:t,letterSpacing:r}),g,f):gd(k,{fontSize:t,letterSpacing:r})[x]},v=a.length>=2?tn(a[1].coordinate-a[0].coordinate):1,w=TJ(i,v,x);return c==="equidistantPreserveStart"?OJ(v,w,y,a,s):(c==="preserveStart"||c==="preserveStartEnd"?p=FJ(v,w,y,a,s,c==="preserveStartEnd"):p=IJ(v,w,y,a,s),p.filter(b=>b.isShow))}var LJ=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:i=0}=e,s=0;if(t){Array.from(t).forEach(d=>{if(d){var f=d.getBoundingClientRect();f.width>s&&(s=f.width)}});var o=r?r.getBoundingClientRect().width:0,c=a+i,u=s+c+o+(r?n:0);return Math.round(u)}return 0},BJ=["axisLine","width","height","className","hide","ticks"],jJ=["viewBox"],$J=["viewBox"];function Uy(e,t){if(e==null)return{};var r,n,a=UJ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function UJ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Nl(){return Nl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Nl.apply(null,arguments)}function V4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function jr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?V4(Object(r),!0).forEach(function(n){zJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zJ(e,t,r){return(t=HJ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HJ(e){var t=WJ(e,"string");return typeof t=="symbol"?t:t+""}function WJ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var k2={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function GJ(e){var{x:t,y:r,width:n,height:a,orientation:i,mirror:s,axisLine:o,otherSvgProps:c}=e;if(!o)return null;var u=jr(jr(jr({},c),Ra(o)),{},{fill:"none"});if(i==="top"||i==="bottom"){var d=+(i==="top"&&!s||i==="bottom"&&s);u=jr(jr({},u),{},{x1:t,y1:r+d*a,x2:t+n,y2:r+d*a})}else{var f=+(i==="left"&&!s||i==="right"&&s);u=jr(jr({},u),{},{x1:t+f*n,y1:r,x2:t+f*n,y2:r+a})}return N.createElement("line",Nl({},u,{className:It("recharts-cartesian-axis-line",xl(o,"className"))}))}function VJ(e,t,r,n,a,i,s,o,c){var u,d,f,h,p,x,g=o?-1:1,y=e.tickSize||s,v=Je(e.tickCoord)?e.tickCoord:e.coordinate;switch(i){case"top":u=d=e.coordinate,h=r+ +!o*a,f=h-g*y,x=f-g*c,p=v;break;case"left":f=h=e.coordinate,d=t+ +!o*n,u=d-g*y,p=u-g*c,x=v;break;case"right":f=h=e.coordinate,d=t+ +o*n,u=d+g*y,p=u+g*c,x=v;break;default:u=d=e.coordinate,h=r+ +o*a,f=h+g*y,x=f+g*c,p=v;break}return{line:{x1:u,y1:f,x2:d,y2:h},tick:{x:p,y:x}}}function KJ(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function XJ(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function qJ(e){var{option:t,tickProps:r,value:n}=e,a,i=It(r.className,"recharts-cartesian-axis-tick-value");if(N.isValidElement(t))a=N.cloneElement(t,jr(jr({},r),{},{className:i}));else if(typeof t=="function")a=t(jr(jr({},r),{},{className:i}));else{var s="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(s=It(s,t==null?void 0:t.className)),a=N.createElement(ag,Nl({},r,{className:s}),n)}return a}function YJ(e){var{ticks:t=[],tick:r,tickLine:n,stroke:a,tickFormatter:i,unit:s,padding:o,tickTextProps:c,orientation:u,mirror:d,x:f,y:h,width:p,height:x,tickSize:g,tickMargin:y,fontSize:v,letterSpacing:w,getTicksConfig:b,events:S}=e,k=S2(jr(jr({},b),{},{ticks:t}),v,w),_=KJ(u,d),E=XJ(u,d),P=Ra(b),A=gl(r),T={};typeof n=="object"&&(T=n);var R=jr(jr({},P),{},{fill:"none"},T),D=k.map((L,z)=>{var{line:X,tick:Y}=VJ(L,f,h,p,x,u,g,d,y),q=jr(jr(jr(jr({textAnchor:_,verticalAnchor:E},P),{},{stroke:"none",fill:a},A),Y),{},{index:z,payload:L,visibleTicksCount:k.length,tickFormatter:i,padding:o},c);return N.createElement(pn,Nl({className:"recharts-cartesian-axis-tick",key:"tick-".concat(L.value,"-").concat(L.coordinate,"-").concat(L.tickCoord)},Ef(S,L,z)),n&&N.createElement("line",Nl({},R,X,{className:It("recharts-cartesian-axis-tick-line",xl(n,"className"))})),r&&N.createElement(qJ,{option:r,tickProps:q,value:"".concat(typeof i=="function"?i(L.value,z):L.value).concat(s||"")}))});return D.length>0?N.createElement("g",{className:"recharts-cartesian-axis-ticks"},D):null}var JJ=N.forwardRef((e,t)=>{var{axisLine:r,width:n,height:a,className:i,hide:s,ticks:o}=e,c=Uy(e,BJ),[u,d]=N.useState(""),[f,h]=N.useState(""),p=N.useRef(null);N.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var g;return LJ({ticks:p.current,label:(g=e.labelRef)===null||g===void 0?void 0:g.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var x=N.useCallback(g=>{if(g){var y=g.getElementsByClassName("recharts-cartesian-axis-tick-value");p.current=y;var v=y[0];if(v){var w=window.getComputedStyle(v),b=w.fontSize,S=w.letterSpacing;(b!==u||S!==f)&&(d(b),h(S))}}},[u,f]);return s||n!=null&&n<=0||a!=null&&a<=0?null:N.createElement(pn,{className:It("recharts-cartesian-axis",i),ref:x},N.createElement(GJ,{x:e.x,y:e.y,width:n,height:a,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:Ra(e)}),N.createElement(YJ,{ticks:o,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:u,letterSpacing:f,getTicksConfig:e,events:c}),N.createElement(iX,{x:e.x,y:e.y,width:e.width,height:e.height},N.createElement(pX,{label:e.label,labelRef:e.labelRef}),e.children))}),QJ=N.memo(JJ,(e,t)=>{var{viewBox:r}=e,n=Uy(e,jJ),{viewBox:a}=t,i=Uy(t,$J);return qc(r,a)&&qc(n,i)}),_2=N.forwardRef((e,t)=>{var r=gn(e,k2);return N.createElement(QJ,Nl({},r,{ref:t}))});_2.displayName="CartesianAxis";var ZJ=["x1","y1","x2","y2","key"],eQ=["offset"],tQ=["xAxisId","yAxisId"],rQ=["xAxisId","yAxisId"];function K4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _n(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?K4(Object(r),!0).forEach(function(n){nQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nQ(e,t,r){return(t=aQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aQ(e){var t=iQ(e,"string");return typeof t=="symbol"?t:t+""}function iQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qo(){return Qo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Qo.apply(null,arguments)}function Ah(e,t){if(e==null)return{};var r,n,a=sQ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function sQ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var oQ=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:a,width:i,height:s,ry:o}=e;return N.createElement("rect",{x:n,y:a,ry:o,width:i,height:s,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function eD(e,t){var r;if(N.isValidElement(e))r=N.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var{x1:n,y1:a,x2:i,y2:s,key:o}=t,c=Ah(t,ZJ),u=Ra(c),d=Ah(u,eQ);r=N.createElement("line",Qo({},d,{x1:n,y1:a,x2:i,y2:s,fill:"none",key:o}))}return r}function lQ(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:a}=e;if(!n||!a||!a.length)return null;var i=Ah(e,tQ),s=a.map((o,c)=>{var u=_n(_n({},i),{},{x1:t,y1:o,x2:t+r,y2:o,key:"line-".concat(c),index:c});return eD(n,u)});return N.createElement("g",{className:"recharts-cartesian-grid-horizontal"},s)}function cQ(e){var{y:t,height:r,vertical:n=!0,verticalPoints:a}=e;if(!n||!a||!a.length)return null;var i=Ah(e,rQ),s=a.map((o,c)=>{var u=_n(_n({},i),{},{x1:o,y1:t,x2:o,y2:t+r,key:"line-".concat(c),index:c});return eD(n,u)});return N.createElement("g",{className:"recharts-cartesian-grid-vertical"},s)}function uQ(e){var{horizontalFill:t,fillOpacity:r,x:n,y:a,width:i,height:s,horizontalPoints:o,horizontal:c=!0}=e;if(!c||!t||!t.length)return null;var u=o.map(f=>Math.round(f+a-a)).sort((f,h)=>f-h);a!==u[0]&&u.unshift(0);var d=u.map((f,h)=>{var p=!u[h+1],x=p?a+s-f:u[h+1]-f;if(x<=0)return null;var g=h%t.length;return N.createElement("rect",{key:"react-".concat(h),y:f,x:n,height:x,width:i,stroke:"none",fill:t[g],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return N.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function dQ(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:a,y:i,width:s,height:o,verticalPoints:c}=e;if(!t||!r||!r.length)return null;var u=c.map(f=>Math.round(f+a-a)).sort((f,h)=>f-h);a!==u[0]&&u.unshift(0);var d=u.map((f,h)=>{var p=!u[h+1],x=p?a+s-f:u[h+1]-f;if(x<=0)return null;var g=h%r.length;return N.createElement("rect",{key:"react-".concat(h),x:f,y:i,width:x,height:o,stroke:"none",fill:r[g],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return N.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var fQ=(e,t)=>{var{xAxis:r,width:n,height:a,offset:i}=e;return F6(S2(_n(_n(_n({},k2),r),{},{ticks:L6(r,!0),viewBox:{x:0,y:0,width:n,height:a}})),i.left,i.left+i.width,t)},mQ=(e,t)=>{var{yAxis:r,width:n,height:a,offset:i}=e;return F6(S2(_n(_n(_n({},k2),r),{},{ticks:L6(r,!0),viewBox:{x:0,y:0,width:n,height:a}})),i.top,i.top+i.height,t)},hQ={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function ba(e){var t=Kb(),r=Xb(),n=K6(),a=_n(_n({},gn(e,hQ)),{},{x:Je(e.x)?e.x:n.left,y:Je(e.y)?e.y:n.top,width:Je(e.width)?e.width:n.width,height:Je(e.height)?e.height:n.height}),{xAxisId:i,yAxisId:s,x:o,y:c,width:u,height:d,syncWithTicks:f,horizontalValues:h,verticalValues:p}=a,x=Jn(),g=Ve(A=>e4(A,"xAxis",i,x)),y=Ve(A=>e4(A,"yAxis",s,x));if(!Je(u)||u<=0||!Je(d)||d<=0||!Je(o)||o!==+o||!Je(c)||c!==+c)return null;var v=a.verticalCoordinatesGenerator||fQ,w=a.horizontalCoordinatesGenerator||mQ,{horizontalPoints:b,verticalPoints:S}=a;if((!b||!b.length)&&typeof w=="function"){var k=h&&h.length,_=w({yAxis:y?_n(_n({},y),{},{ticks:k?h:y.ticks}):void 0,width:t,height:r,offset:n},k?!0:f);sh(Array.isArray(_),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof _,"]")),Array.isArray(_)&&(b=_)}if((!S||!S.length)&&typeof v=="function"){var E=p&&p.length,P=v({xAxis:g?_n(_n({},g),{},{ticks:E?p:g.ticks}):void 0,width:t,height:r,offset:n},E?!0:f);sh(Array.isArray(P),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof P,"]")),Array.isArray(P)&&(S=P)}return N.createElement("g",{className:"recharts-cartesian-grid"},N.createElement(oQ,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),N.createElement(uQ,Qo({},a,{horizontalPoints:b})),N.createElement(dQ,Qo({},a,{verticalPoints:S})),N.createElement(lQ,Qo({},a,{offset:n,horizontalPoints:b,xAxis:g,yAxis:y})),N.createElement(cQ,Qo({},a,{offset:n,verticalPoints:S,xAxis:g,yAxis:y})))}ba.displayName="CartesianGrid";var tD=(e,t,r,n)=>go(e,"xAxis",t,n),rD=(e,t,r,n)=>po(e,"xAxis",t,n),nD=(e,t,r,n)=>go(e,"yAxis",r,n),aD=(e,t,r,n)=>po(e,"yAxis",r,n),pQ=me([Ot,tD,nD,rD,aD],(e,t,r,n,a)=>Co(e,"xAxis")?Kd(t,n,!1):Kd(r,a,!1)),gQ=(e,t,r,n,a)=>a;function xQ(e){return e.type==="line"}var vQ=me([Qp,gQ],(e,t)=>e.filter(xQ).find(r=>r.id===t)),yQ=me([Ot,tD,nD,rD,aD,vQ,pQ,Gp],(e,t,r,n,a,i,s,o)=>{var{chartData:c,dataStartIndex:u,dataEndIndex:d}=o;if(!(i==null||t==null||r==null||n==null||a==null||n.length===0||a.length===0||s==null)){var{dataKey:f,data:h}=i,p;if(h!=null&&h.length>0?p=h:p=c==null?void 0:c.slice(u,d+1),p!=null)return zQ({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:a,dataKey:f,bandSize:s,displayedData:p})}});function bQ(e){var t=gl(e),r=3,n=2;if(t!=null){var{r:a,strokeWidth:i}=t,s=Number(a),o=Number(i);return(Number.isNaN(s)||s<0)&&(s=r),(Number.isNaN(o)||o<0)&&(o=n),{r:s,strokeWidth:o}}return{r,strokeWidth:n}}var wQ=["id"],NQ=["type","layout","connectNulls","needClip"],SQ=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function X4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?X4(Object(r),!0).forEach(function(n){kQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kQ(e,t,r){return(t=_Q(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _Q(e){var t=EQ(e,"string");return typeof t=="symbol"?t:t+""}function EQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function E2(e,t){if(e==null)return{};var r,n,a=CQ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function CQ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Sl(){return Sl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Sl.apply(null,arguments)}var AQ=e=>{var{dataKey:t,name:r,stroke:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:lu(r,t),payload:e}]};function TQ(e){var{dataKey:t,data:r,stroke:n,strokeWidth:a,fill:i,name:s,hide:o,unit:c}=e;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:a,fill:i,dataKey:t,nameKey:void 0,name:lu(s,t),hide:o,type:e.tooltipType,color:e.stroke,unit:c}}}var iD=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function PQ(e,t){for(var r=e.length%2!==0?[...e,0]:e,n=[],a=0;a<t;++a)n=[...n,...r];return n}var OQ=(e,t,r)=>{var n=r.reduce((f,h)=>f+h);if(!n)return iD(t,e);for(var a=Math.floor(e/n),i=e%n,s=t-e,o=[],c=0,u=0;c<r.length;u+=r[c],++c)if(u+r[c]>i){o=[...r.slice(0,c),i-u];break}var d=o.length%2===0?[0,s]:[s];return[...PQ(r,a),...o,...d].map(f=>"".concat(f,"px")).join(", ")};function DQ(e,t){var r;if(N.isValidElement(e))r=N.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var n=It("recharts-line-dot",typeof e!="boolean"?e.className:"");r=N.createElement(PO,Sl({},t,{className:n}))}return r}function RQ(e,t){return e==null?!1:t?!0:e.length===1}function MQ(e){var{clipPathId:t,points:r,props:n}=e,{dot:a,dataKey:i,needClip:s}=n;if(!RQ(r,a))return null;var o=E2(n,wQ),c=LO(a),u=Ra(o),d=YB(a),f=r.map((p,x)=>{var g=xa(xa(xa({key:"dot-".concat(x),r:3},u),d),{},{index:x,cx:p.x,cy:p.y,dataKey:i,value:p.value,payload:p.payload,points:r});return DQ(a,g)}),h={clipPath:s?"url(#clipPath-".concat(c?"":"dots-").concat(t,")"):void 0};return N.createElement(pn,Sl({className:"recharts-line-dots",key:"dots"},h),f)}function IQ(e){var{showLabels:t,children:r,points:n}=e,a=N.useMemo(()=>n==null?void 0:n.map(i=>{var s={x:i.x,y:i.y,width:0,height:0};return xa(xa({},s),{},{value:i.value,payload:i.payload,viewBox:s,parentViewBox:void 0,fill:void 0})}),[n]);return N.createElement(AO,{value:t?a:null},r)}function q4(e){var{clipPathId:t,pathRef:r,points:n,strokeDasharray:a,props:i}=e,{type:s,layout:o,connectNulls:c,needClip:u}=i,d=E2(i,NQ),f=xa(xa({},Kn(d)),{},{fill:"none",className:"recharts-line-curve",clipPath:u?"url(#clipPath-".concat(t,")"):void 0,points:n,type:s,layout:o,connectNulls:c,strokeDasharray:a??i.strokeDasharray});return N.createElement(N.Fragment,null,(n==null?void 0:n.length)>1&&N.createElement(Yb,Sl({},f,{pathRef:r})),N.createElement(MQ,{points:n,clipPathId:t,props:i}))}function FQ(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function LQ(e){var{clipPathId:t,props:r,pathRef:n,previousPointsRef:a,longestAnimatedLengthRef:i}=e,{points:s,strokeDasharray:o,isAnimationActive:c,animationBegin:u,animationDuration:d,animationEasing:f,animateNewValues:h,width:p,height:x,onAnimationEnd:g,onAnimationStart:y}=r,v=a.current,w=Of(r,"recharts-line-"),[b,S]=N.useState(!1),k=!b,_=N.useCallback(()=>{typeof g=="function"&&g(),S(!1)},[g]),E=N.useCallback(()=>{typeof y=="function"&&y(),S(!0)},[y]),P=FQ(n.current),A=i.current;return N.createElement(IQ,{points:s,showLabels:k},r.children,N.createElement(Pf,{animationId:w,begin:u,duration:d,isActive:c,easing:f,onAnimationEnd:_,onAnimationStart:E,key:w},T=>{var R=br(A,P+A,T),D=Math.min(R,P),L;if(c)if(o){var z="".concat(o).split(/[,\s]+/gim).map(q=>parseFloat(q));L=OQ(D,P,z)}else L=iD(P,D);else L=o==null?void 0:String(o);if(v){var X=v.length/s.length,Y=T===1?s:s.map((q,ee)=>{var V=Math.floor(ee*X);if(v[V]){var ae=v[V];return xa(xa({},q),{},{x:br(ae.x,q.x,T),y:br(ae.y,q.y,T)})}return h?xa(xa({},q),{},{x:br(p*2,q.x,T),y:br(x/2,q.y,T)}):xa(xa({},q),{},{x:q.x,y:q.y})});return a.current=Y,N.createElement(q4,{props:r,points:Y,clipPathId:t,pathRef:n,strokeDasharray:L})}return T>0&&P>0&&(a.current=s,i.current=D),N.createElement(q4,{props:r,points:s,clipPathId:t,pathRef:n,strokeDasharray:L})}),N.createElement(o2,{label:r.label}))}function BQ(e){var{clipPathId:t,props:r}=e,n=N.useRef(null),a=N.useRef(0),i=N.useRef(null);return N.createElement(LQ,{props:r,clipPathId:t,previousPointsRef:n,longestAnimatedLengthRef:a,pathRef:i})}var jQ=(e,t)=>({x:e.x,y:e.y,value:e.value,errorVal:Yt(e.payload,t)});class $Q extends N.Component{render(){var{hide:t,dot:r,points:n,className:a,xAxisId:i,yAxisId:s,top:o,left:c,width:u,height:d,id:f,needClip:h}=this.props;if(t)return null;var p=It("recharts-line",a),x=f,{r:g,strokeWidth:y}=bQ(r),v=LO(r),w=g*2+y;return N.createElement(N.Fragment,null,N.createElement(pn,{className:p},h&&N.createElement("defs",null,N.createElement(KO,{clipPathId:x,xAxisId:i,yAxisId:s}),!v&&N.createElement("clipPath",{id:"clipPath-dots-".concat(x)},N.createElement("rect",{x:c-w/2,y:o-w/2,width:u+w,height:d+w}))),N.createElement(VO,{xAxisId:i,yAxisId:s,data:n,dataPointFormatter:jQ,errorBarOffset:0},N.createElement(BQ,{props:this.props,clipPathId:x}))),N.createElement(iY,{activeDot:this.props.activeDot,points:n,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var sD={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!Ao.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function UQ(e){var t=gn(e,sD),{activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:s,connectNulls:o,dot:c,hide:u,isAnimationActive:d,label:f,legendType:h,xAxisId:p,yAxisId:x,id:g}=t,y=E2(t,SQ),{needClip:v}=w2(p,x),w=y2(),b=Lp(),S=Jn(),k=Ve(T=>yQ(T,p,x,S,g));if(b!=="horizontal"&&b!=="vertical"||k==null||w==null)return null;var{height:_,width:E,x:P,y:A}=w;return N.createElement($Q,Sl({},y,{id:g,connectNulls:o,dot:c,activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:s,isAnimationActive:d,hide:u,label:f,legendType:h,xAxisId:p,yAxisId:x,points:k,layout:b,height:_,width:E,left:P,top:A,needClip:v}))}function zQ(e){var{layout:t,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,dataKey:s,bandSize:o,displayedData:c}=e;return c.map((u,d)=>{var f=Yt(u,s);if(t==="horizontal"){var h=Fk({axis:r,ticks:a,bandSize:o,entry:u,index:d}),p=or(f)?null:n.scale(f);return{x:h,y:p,value:f,payload:u}}var x=or(f)?null:r.scale(f),g=Fk({axis:n,ticks:i,bandSize:o,entry:u,index:d});return x==null||g==null?null:{x,y:g,value:f,payload:u}}).filter(Boolean)}function HQ(e){var t=gn(e,sD),r=Jn();return N.createElement(x2,{id:t.id,type:"line"},n=>N.createElement(N.Fragment,null,N.createElement(UO,{legendPayload:AQ(t)}),N.createElement(g2,{fn:TQ,args:t}),N.createElement(HO,{type:"line",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:r}),N.createElement(UQ,Sl({},t,{id:n}))))}var kl=N.memo(HQ);kl.displayName="Line";var WQ=["dangerouslySetInnerHTML","ticks"],GQ=["id"],VQ=["domain"],KQ=["domain"];function zy(){return zy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zy.apply(null,arguments)}function Th(e,t){if(e==null)return{};var r,n,a=XQ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function XQ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function qQ(e){var t=lr();return N.useLayoutEffect(()=>(t(Vq(e)),()=>{t(Kq(e))}),[e,t]),null}var YQ=e=>{var{xAxisId:t,className:r}=e,n=Ve(Gb),a=Jn(),i="xAxis",s=Ve(p=>gu(p,i,t,a)),o=Ve(p=>BP(p,i,t,a)),c=Ve(p=>MP(p,t)),u=Ve(p=>$G(p,t)),d=Ve(p=>pP(p,t));if(c==null||u==null||d==null)return null;var f=Th(e,WQ),h=Th(d,GQ);return N.createElement(_2,zy({},f,h,{scale:s,x:u.x,y:u.y,width:c.width,height:c.height,className:It("recharts-".concat(i," ").concat(i),r),viewBox:n,ticks:o}))},JQ={allowDataOverflow:da.allowDataOverflow,allowDecimals:da.allowDecimals,allowDuplicatedCategory:da.allowDuplicatedCategory,height:da.height,hide:!1,mirror:da.mirror,orientation:da.orientation,padding:da.padding,reversed:da.reversed,scale:da.scale,tickCount:da.tickCount,type:da.type,xAxisId:0},QQ=e=>{var t,r,n,a,i,s=gn(e,JQ);return N.createElement(N.Fragment,null,N.createElement(qQ,{interval:(t=s.interval)!==null&&t!==void 0?t:"preserveEnd",id:s.xAxisId,scale:s.scale,type:s.type,padding:s.padding,allowDataOverflow:s.allowDataOverflow,domain:s.domain,dataKey:s.dataKey,allowDuplicatedCategory:s.allowDuplicatedCategory,allowDecimals:s.allowDecimals,tickCount:s.tickCount,includeHidden:(r=s.includeHidden)!==null&&r!==void 0?r:!1,reversed:s.reversed,ticks:s.ticks,height:s.height,orientation:s.orientation,mirror:s.mirror,hide:s.hide,unit:s.unit,name:s.name,angle:(n=s.angle)!==null&&n!==void 0?n:0,minTickGap:(a=s.minTickGap)!==null&&a!==void 0?a:5,tick:(i=s.tick)!==null&&i!==void 0?i:!0,tickFormatter:s.tickFormatter}),N.createElement(YQ,s))},ZQ=(e,t)=>{var{domain:r}=e,n=Th(e,VQ),{domain:a}=t,i=Th(t,KQ);return qc(n,i)?Array.isArray(r)&&r.length===2&&Array.isArray(a)&&a.length===2?r[0]===a[0]&&r[1]===a[1]:qc({domain:r},{domain:a}):!1},wa=N.memo(QQ,ZQ);wa.displayName="XAxis";var eZ=["dangerouslySetInnerHTML","ticks"],tZ=["id"],rZ=["domain"],nZ=["domain"];function Hy(){return Hy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Hy.apply(null,arguments)}function Ph(e,t){if(e==null)return{};var r,n,a=aZ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function aZ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function iZ(e){var t=lr();return N.useLayoutEffect(()=>(t(Xq(e)),()=>{t(qq(e))}),[e,t]),null}var sZ=e=>{var{yAxisId:t,className:r,width:n,label:a}=e,i=N.useRef(null),s=N.useRef(null),o=Ve(Gb),c=Jn(),u=lr(),d="yAxis",f=Ve(w=>gu(w,d,t,c)),h=Ve(w=>IP(w,t)),p=Ve(w=>zG(w,t)),x=Ve(w=>BP(w,d,t,c)),g=Ve(w=>gP(w,t));if(N.useLayoutEffect(()=>{if(!(n!=="auto"||!h||s2(a)||N.isValidElement(a)||g==null)){var w=i.current;if(w){var b=w.getCalculatedWidth();Math.round(h.width)!==Math.round(b)&&u(Yq({id:t,width:b}))}}},[x,h,u,a,t,n,g]),h==null||p==null||g==null)return null;var y=Ph(e,eZ),v=Ph(g,tZ);return N.createElement(_2,Hy({},y,v,{ref:i,labelRef:s,scale:f,x:p.x,y:p.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:h.width,height:h.height,className:It("recharts-".concat(d," ").concat(d),r),viewBox:o,ticks:x}))},oZ={allowDataOverflow:fa.allowDataOverflow,allowDecimals:fa.allowDecimals,allowDuplicatedCategory:fa.allowDuplicatedCategory,hide:!1,mirror:fa.mirror,orientation:fa.orientation,padding:fa.padding,reversed:fa.reversed,scale:fa.scale,tickCount:fa.tickCount,type:fa.type,width:fa.width,yAxisId:0},lZ=e=>{var t,r,n,a,i,s=gn(e,oZ);return N.createElement(N.Fragment,null,N.createElement(iZ,{interval:(t=s.interval)!==null&&t!==void 0?t:"preserveEnd",id:s.yAxisId,scale:s.scale,type:s.type,domain:s.domain,allowDataOverflow:s.allowDataOverflow,dataKey:s.dataKey,allowDuplicatedCategory:s.allowDuplicatedCategory,allowDecimals:s.allowDecimals,tickCount:s.tickCount,padding:s.padding,includeHidden:(r=s.includeHidden)!==null&&r!==void 0?r:!1,reversed:s.reversed,ticks:s.ticks,width:s.width,orientation:s.orientation,mirror:s.mirror,hide:s.hide,unit:s.unit,name:s.name,angle:(n=s.angle)!==null&&n!==void 0?n:0,minTickGap:(a=s.minTickGap)!==null&&a!==void 0?a:5,tick:(i=s.tick)!==null&&i!==void 0?i:!0,tickFormatter:s.tickFormatter}),N.createElement(sZ,s))},cZ=(e,t)=>{var{domain:r}=e,n=Ph(e,rZ),{domain:a}=t,i=Ph(t,nZ);return qc(n,i)?Array.isArray(r)&&r.length===2&&Array.isArray(a)&&a.length===2?r[0]===a[0]&&r[1]===a[1]:qc({domain:r},{domain:a}):!1},Na=N.memo(lZ,cZ);Na.displayName="YAxis";var uZ={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wf=N;function dZ(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var fZ=typeof Object.is=="function"?Object.is:dZ,mZ=Wf.useSyncExternalStore,hZ=Wf.useRef,pZ=Wf.useEffect,gZ=Wf.useMemo,xZ=Wf.useDebugValue;uZ.useSyncExternalStoreWithSelector=function(e,t,r,n,a){var i=hZ(null);if(i.current===null){var s={hasValue:!1,value:null};i.current=s}else s=i.current;i=gZ(function(){function c(p){if(!u){if(u=!0,d=p,p=n(p),a!==void 0&&s.hasValue){var x=s.value;if(a(x,p))return f=x}return f=p}if(x=f,fZ(d,p))return x;var g=n(p);return a!==void 0&&a(x,g)?(d=p,x):(d=p,f=g)}var u=!1,d,f,h=r===void 0?null:r;return[function(){return c(t())},h===null?void 0:function(){return c(h())}]},[t,r,n,a]);var o=mZ(e,i[0],i[1]);return pZ(function(){s.hasValue=!0,s.value=o},[o]),xZ(o),o};function vZ(e){e()}function yZ(){let e=null,t=null;return{clear(){e=null,t=null},notify(){vZ(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=t={callback:r,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!n||e===null||(n=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var Y4={notify(){},get:()=>[]};function bZ(e,t){let r,n=Y4,a=0,i=!1;function s(g){d();const y=n.subscribe(g);let v=!1;return()=>{v||(v=!0,y(),f())}}function o(){n.notify()}function c(){x.onStateChange&&x.onStateChange()}function u(){return i}function d(){a++,r||(r=t?t.addNestedSub(c):e.subscribe(c),n=yZ())}function f(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=Y4)}function h(){i||(i=!0,d())}function p(){i&&(i=!1,f())}const x={addNestedSub:s,notifyNestedSubs:o,handleChangeWrapper:c,isSubscribed:u,trySubscribe:h,tryUnsubscribe:p,getListeners:()=>n};return x}var wZ=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",NZ=wZ(),SZ=()=>typeof navigator<"u"&&navigator.product==="ReactNative",kZ=SZ(),_Z=()=>NZ||kZ?N.useLayoutEffect:N.useEffect,EZ=_Z(),Ox=Symbol.for("react-redux-context"),Dx=typeof globalThis<"u"?globalThis:{};function CZ(){if(!N.createContext)return{};const e=Dx[Ox]??(Dx[Ox]=new Map);let t=e.get(N.createContext);return t||(t=N.createContext(null),e.set(N.createContext,t)),t}var AZ=CZ();function TZ(e){const{children:t,context:r,serverState:n,store:a}=e,i=N.useMemo(()=>{const c=bZ(a);return{store:a,subscription:c,getServerState:n?()=>n:void 0}},[a,n]),s=N.useMemo(()=>a.getState(),[a]);EZ(()=>{const{subscription:c}=i;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),s!==a.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[i,s]);const o=r||AZ;return N.createElement(o.Provider,{value:i},t)}var PZ=TZ,OZ=(e,t)=>t,C2=me([OZ,Ot,fP,Vr,tO,Rs,KV,Wr],QV),A2=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},oD=ui("mouseClick"),lD=Af();lD.startListening({actionCreator:oD,effect:(e,t)=>{var r=e.payload,n=C2(t.getState(),A2(r));(n==null?void 0:n.activeIndex)!=null&&t.dispatch(tV({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var Wy=ui("mouseMove"),cD=Af();cD.startListening({actionCreator:Wy,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=Yw(n,n.tooltip.settings.shared),i=C2(n,A2(r));a==="axis"&&((i==null?void 0:i.activeIndex)!=null?t.dispatch(VP({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate})):t.dispatch(GP()))}});var J4={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},uD=ja({name:"rootProps",initialState:J4,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:J4.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),DZ=uD.reducer,{updateOptions:RZ}=uD.actions,dD=ja({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:MZ}=dD.actions,IZ=dD.reducer,fD=ui("keyDown"),mD=ui("focus"),T2=Af();T2.startListening({actionCreator:fD,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var s=Number(Jw(a,vu(r))),o=Rs(r);if(i==="Enter"){var c=Nh(r,"axis","hover",String(a.index));t.dispatch(Iy({active:!a.active,activeIndex:a.index,activeDataKey:a.dataKey,activeCoordinate:c}));return}var u=VG(r),d=u==="left-to-right"?1:-1,f=i==="ArrowRight"?1:-1,h=s+f*d;if(!(o==null||h>=o.length||h<0)){var p=Nh(r,"axis","hover",String(h));t.dispatch(Iy({active:!0,activeIndex:h.toString(),activeDataKey:void 0,activeCoordinate:p}))}}}}});T2.startListening({actionCreator:mD,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var i="0",s=Nh(r,"axis","hover",String(i));t.dispatch(Iy({activeDataKey:void 0,active:!0,activeIndex:i,activeCoordinate:s}))}}}});var Wa=ui("externalEvent"),hD=Af();hD.startListening({actionCreator:Wa,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),n={activeCoordinate:LV(r),activeDataKey:iO(r),activeIndex:xo(r),activeLabel:aO(r),activeTooltipIndex:xo(r),isTooltipActive:BV(r)};e.payload.handler(n,e.payload.reactEvent)}}});var FZ=me([xu],e=>e.tooltipItemPayloads),LZ=me([FZ,Uf,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,n)=>{var a=e.find(o=>o.settings.dataKey===n);if(a!=null){var{positions:i}=a;if(i!=null){var s=t(i,r);return s}}}),pD=ui("touchMove"),gD=Af();gD.startListening({actionCreator:pD,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=Yw(n,n.tooltip.settings.shared);if(a==="axis"){var i=C2(n,A2({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));(i==null?void 0:i.activeIndex)!=null&&t.dispatch(VP({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if(a==="item"){var s,o=r.touches[0],c=document.elementFromPoint(o.clientX,o.clientY);if(!c||!c.getAttribute)return;var u=c.getAttribute(j6),d=(s=c.getAttribute($6))!==null&&s!==void 0?s:void 0,f=LZ(t.getState(),u,d);t.dispatch(WP({activeDataKey:d,activeIndex:u,activeCoordinate:f}))}}});var BZ=c6({brush:vJ,cartesianAxis:Jq,chartData:mK,errorBars:xY,graphicalItems:gq,layout:D9,legend:M$,options:lK,polarAxis:DX,polarOptions:IZ,referenceElements:_J,rootProps:DZ,tooltip:rV}),jZ=function(t){return n9({reducer:BZ,preloadedState:t,middleware:r=>r({serializableCheck:!1}).concat([lD.middleware,cD.middleware,T2.middleware,hD.middleware,gD.middleware]),enhancers:r=>{var n=r;return typeof r=="function"&&(n=r()),n.concat(w6({type:"raf"}))},devTools:Ao.devToolsEnabled})};function xD(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,a=Jn(),i=N.useRef(null);if(a)return r;i.current==null&&(i.current=jZ(t));var s=Lb;return N.createElement(PZ,{context:s,store:i.current},r)}function vD(e){var{layout:t,margin:r}=e,n=lr(),a=Jn();return N.useEffect(()=>{a||(n(T9(t)),n(A9(r)))},[n,a,t,r]),null}function yD(e){var t=lr();return N.useEffect(()=>{t(RZ(e))},[t,e]),null}var $Z=["children"];function UZ(e,t){if(e==null)return{};var r,n,a=zZ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function zZ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Oh(){return Oh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Oh.apply(null,arguments)}var HZ={width:"100%",height:"100%",display:"block"},WZ=N.forwardRef((e,t)=>{var r=Kb(),n=Xb(),a=J6();if(!Wc(r)||!Wc(n))return null;var{children:i,otherAttributes:s,title:o,desc:c}=e,u,d;return typeof s.tabIndex=="number"?u=s.tabIndex:u=a?0:void 0,typeof s.role=="string"?d=s.role:d=a?"application":void 0,N.createElement(yb,Oh({},s,{title:o,desc:c,role:d,tabIndex:u,width:r,height:n,style:HZ,ref:t}),i)}),GZ=e=>{var{children:t}=e,r=Ve(Ip);if(!r)return null;var{width:n,height:a,y:i,x:s}=r;return N.createElement(yb,{width:n,height:a,x:s,y:i},t)},Q4=N.forwardRef((e,t)=>{var{children:r}=e,n=UZ(e,$Z),a=Jn();return a?N.createElement(GZ,null,r):N.createElement(WZ,Oh({ref:t},n),r)});function VZ(){var e=lr(),[t,r]=N.useState(null),n=Ve(o$);return N.useEffect(()=>{if(t!=null){var a=t.getBoundingClientRect(),i=a.width/t.offsetWidth;Mn(i)&&i!==n&&e(O9(i))}},[t,e,n]),r}function Z4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function KZ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z4(Object(r),!0).forEach(function(n){XZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XZ(e,t,r){return(t=qZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qZ(e){var t=YZ(e,"string");return typeof t=="symbol"?t:t+""}function YZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _l(){return _l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_l.apply(null,arguments)}var JZ=()=>(NK(),null);function Dh(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var QZ=N.forwardRef((e,t)=>{var r,n,a=N.useRef(null),[i,s]=N.useState({containerWidth:Dh((r=e.style)===null||r===void 0?void 0:r.width),containerHeight:Dh((n=e.style)===null||n===void 0?void 0:n.height)}),o=N.useCallback((u,d)=>{s(f=>{var h=Math.round(u),p=Math.round(d);return f.containerWidth===h&&f.containerHeight===p?f:{containerWidth:h,containerHeight:p}})},[]),c=N.useCallback(u=>{if(typeof t=="function"&&t(u),u!=null){var{width:d,height:f}=u.getBoundingClientRect();o(d,f);var h=x=>{var{width:g,height:y}=x[0].contentRect;o(g,y)},p=new ResizeObserver(h);p.observe(u),a.current=p}},[t,o]);return N.useEffect(()=>()=>{var u=a.current;u!=null&&u.disconnect()},[o]),N.createElement(N.Fragment,null,N.createElement(Bp,{width:i.containerWidth,height:i.containerHeight}),N.createElement("div",_l({ref:c},e)))}),ZZ=N.forwardRef((e,t)=>{var{width:r,height:n}=e,[a,i]=N.useState({containerWidth:Dh(r),containerHeight:Dh(n)}),s=N.useCallback((c,u)=>{i(d=>{var f=Math.round(c),h=Math.round(u);return d.containerWidth===f&&d.containerHeight===h?d:{containerWidth:f,containerHeight:h}})},[]),o=N.useCallback(c=>{if(typeof t=="function"&&t(c),c!=null){var{width:u,height:d}=c.getBoundingClientRect();s(u,d)}},[t,s]);return N.createElement(N.Fragment,null,N.createElement(Bp,{width:a.containerWidth,height:a.containerHeight}),N.createElement("div",_l({ref:o},e)))}),eee=N.forwardRef((e,t)=>{var{width:r,height:n}=e;return N.createElement(N.Fragment,null,N.createElement(Bp,{width:r,height:n}),N.createElement("div",_l({ref:t},e)))}),tee=N.forwardRef((e,t)=>{var{width:r,height:n}=e;return ws(r)||ws(n)?N.createElement(ZZ,_l({},e,{ref:t})):N.createElement(eee,_l({},e,{ref:t}))});function ree(e){return e===!0?QZ:tee}var nee=N.forwardRef((e,t)=>{var{children:r,className:n,height:a,onClick:i,onContextMenu:s,onDoubleClick:o,onMouseDown:c,onMouseEnter:u,onMouseLeave:d,onMouseMove:f,onMouseUp:h,onTouchEnd:p,onTouchMove:x,onTouchStart:g,style:y,width:v,responsive:w,dispatchTouchEvents:b=!0}=e,S=N.useRef(null),k=lr(),[_,E]=N.useState(null),[P,A]=N.useState(null),T=VZ(),R=Vb(),D=(R==null?void 0:R.width)>0?R.width:v,L=(R==null?void 0:R.height)>0?R.height:a,z=N.useCallback(Q=>{T(Q),typeof t=="function"&&t(Q),E(Q),A(Q),Q!=null&&(S.current=Q)},[T,t,E,A]),X=N.useCallback(Q=>{k(oD(Q)),k(Wa({handler:i,reactEvent:Q}))},[k,i]),Y=N.useCallback(Q=>{k(Wy(Q)),k(Wa({handler:u,reactEvent:Q}))},[k,u]),q=N.useCallback(Q=>{k(GP()),k(Wa({handler:d,reactEvent:Q}))},[k,d]),ee=N.useCallback(Q=>{k(Wy(Q)),k(Wa({handler:f,reactEvent:Q}))},[k,f]),V=N.useCallback(()=>{k(mD())},[k]),ae=N.useCallback(Q=>{k(fD(Q.key))},[k]),oe=N.useCallback(Q=>{k(Wa({handler:s,reactEvent:Q}))},[k,s]),I=N.useCallback(Q=>{k(Wa({handler:o,reactEvent:Q}))},[k,o]),W=N.useCallback(Q=>{k(Wa({handler:c,reactEvent:Q}))},[k,c]),U=N.useCallback(Q=>{k(Wa({handler:h,reactEvent:Q}))},[k,h]),G=N.useCallback(Q=>{k(Wa({handler:g,reactEvent:Q}))},[k,g]),ne=N.useCallback(Q=>{b&&k(pD(Q)),k(Wa({handler:x,reactEvent:Q}))},[k,b,x]),K=N.useCallback(Q=>{k(Wa({handler:p,reactEvent:Q}))},[k,p]),le=ree(w);return N.createElement(dO.Provider,{value:_},N.createElement(d3.Provider,{value:P},N.createElement(le,{width:D??(y==null?void 0:y.width),height:L??(y==null?void 0:y.height),className:It("recharts-wrapper",n),style:KZ({position:"relative",cursor:"default",width:D,height:L},y),onClick:X,onContextMenu:oe,onDoubleClick:I,onFocus:V,onKeyDown:ae,onMouseDown:W,onMouseEnter:Y,onMouseLeave:q,onMouseMove:ee,onMouseUp:U,onTouchEnd:K,onTouchMove:ne,onTouchStart:G,ref:z},N.createElement(JZ,null),r)))}),aee=["width","height","responsive","children","className","style","compact","title","desc"];function iee(e,t){if(e==null)return{};var r,n,a=see(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function see(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var bD=N.forwardRef((e,t)=>{var{width:r,height:n,responsive:a,children:i,className:s,style:o,compact:c,title:u,desc:d}=e,f=iee(e,aee),h=Ra(f);return c?N.createElement(N.Fragment,null,N.createElement(Bp,{width:r,height:n}),N.createElement(Q4,{otherAttributes:h,title:u,desc:d},i)):N.createElement(nee,{className:s,style:o,width:r,height:n,responsive:a,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},N.createElement(Q4,{otherAttributes:h,title:u,desc:d,ref:t},N.createElement(CJ,null,i)))});function Gy(){return Gy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gy.apply(null,arguments)}var oee={top:5,right:5,bottom:5,left:5},lee={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:oee,reverseStackOrder:!1,syncMethod:"index",responsive:!1},wD=N.forwardRef(function(t,r){var n,a=gn(t.categoricalChartProps,lee),{chartName:i,defaultTooltipEventType:s,validateTooltipEventTypes:o,tooltipPayloadSearcher:c,categoricalChartProps:u}=t,d={chartName:i,defaultTooltipEventType:s,validateTooltipEventTypes:o,tooltipPayloadSearcher:c,eventEmitter:void 0};return N.createElement(xD,{preloadedState:{options:d},reduxStoreName:(n=u.id)!==null&&n!==void 0?n:i},N.createElement(YO,{chartData:u.data}),N.createElement(vD,{layout:a.layout,margin:a.margin}),N.createElement(yD,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),N.createElement(bD,Gy({},a,{ref:r})))}),cee=["axis"],Yc=N.forwardRef((e,t)=>N.createElement(wD,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:cee,tooltipPayloadSearcher:i2,categoricalChartProps:e,ref:t})),uee=["axis","item"],Ec=N.forwardRef((e,t)=>N.createElement(wD,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:uee,tooltipPayloadSearcher:i2,categoricalChartProps:e,ref:t}));function dee(e){var t=lr();return N.useEffect(()=>{t(MZ(e))},[t,e]),null}var fee=["layout"];function Vy(){return Vy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vy.apply(null,arguments)}function mee(e,t){if(e==null)return{};var r,n,a=hee(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function hee(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var pee={top:5,right:5,bottom:5,left:5},gee={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:pee,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1},xee=N.forwardRef(function(t,r){var n,a=gn(t.categoricalChartProps,gee),{layout:i}=a,s=mee(a,fee),{chartName:o,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d}=t,f={chartName:o,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d,eventEmitter:void 0};return N.createElement(xD,{preloadedState:{options:f},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:o},N.createElement(YO,{chartData:a.data}),N.createElement(vD,{layout:i,margin:a.margin}),N.createElement(yD,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),N.createElement(dee,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),N.createElement(bD,Vy({},s,{ref:r})))}),vee=["item"],yee={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},Rx=N.forwardRef((e,t)=>{var r=gn(e,yee);return N.createElement(xee,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:vee,tooltipPayloadSearcher:i2,categoricalChartProps:r,ref:t})});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var tf={};tf.version="0.18.5";var Oa=1200,El=1252,bee=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],P2={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},xg=function(e){bee.indexOf(e)!=-1&&(El=P2[0]=e)};function wee(){xg(1252)}var ai=function(e){Oa=e,xg(e)};function vg(){ai(1200),wee()}function Rh(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function Nee(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function ND(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var gc=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Nee(e.slice(2)):t==254&&r==255?ND(e.slice(2)):t==65279?e.slice(1):e},td=function(t){return String.fromCharCode(t)},Ky=function(t){return String.fromCharCode(t)},Pt;function See(e){Pt=e,ai=function(t){Oa=t,xg(t)},gc=function(t){return t.charCodeAt(0)===255&&t.charCodeAt(1)===254?Pt.utils.decode(1200,Rh(t.slice(2))):t},td=function(r){return Oa===1200?String.fromCharCode(r):Pt.utils.decode(Oa,[r&255,r>>8])[0]},Ky=function(r){return Pt.utils.decode(El,[r])[0]},QD()}var qs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function rf(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),i=r>>2,n=e.charCodeAt(u++),s=(r&3)<<4|n>>4,a=e.charCodeAt(u++),o=(n&15)<<2|a>>6,c=a&63,isNaN(n)?o=c=64:isNaN(a)&&(c=64),t+=qs.charAt(i)+qs.charAt(s)+qs.charAt(o)+qs.charAt(c);return t}function Ia(e){var t="",r=0,n=0,a=0,i=0,s=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)i=qs.indexOf(e.charAt(u++)),s=qs.indexOf(e.charAt(u++)),r=i<<2|s>>4,t+=String.fromCharCode(r),o=qs.indexOf(e.charAt(u++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=qs.indexOf(e.charAt(u++)),a=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(a));return t}var wt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ms=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function bo(e){return wt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function eE(e){return wt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Sa=function(t){return wt?Ms(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Gf(e){if(typeof ArrayBuffer>"u")return Sa(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Do(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function kee(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function O2(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return O2(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var en=wt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ms(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function _ee(e){for(var t=[],r=0,n=e.length+250,a=bo(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++i)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|o>>6&15|(s&3)<<4,a[r++]=128|o&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=bo(65535),n=65530)}return t.push(a.slice(0,r)),en(t)}var On=/\u0000/g,rd=/[\u0001-\u0006]/g;function Cc(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ni(e,t){var r=""+e;return r.length>=t?r:yr("0",t-r.length)+r}function D2(e,t){var r=""+e;return r.length>=t?r:yr(" ",t-r.length)+r}function Mh(e,t){var r=""+e;return r.length>=t?r:r+yr(" ",t-r.length)}function Eee(e,t){var r=""+Math.round(e);return r.length>=t?r:yr("0",t-r.length)+r}function Cee(e,t){var r=""+e;return r.length>=t?r:yr("0",t-r.length)+r}var tE=Math.pow(2,32);function Yl(e,t){if(e>tE||e<-tE)return Eee(e,t);var r=Math.round(e);return Cee(r,t)}function Ih(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var rE=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Mx=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Aee(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var nt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},nE={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Tee={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Fh(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,o=0,c=1,u=0,d=0,f=Math.floor(a);u<t&&(f=Math.floor(a),o=f*s+i,d=f*u+c,!(a-f<5e-8));)a=1/(a-f),i=s,s=o,c=u,u=d;if(d>t&&(u>t?(d=c,o=i):(d=u,o=s)),!r)return[0,n*o,d];var h=Math.floor(n*o/d);return[h,n*o-h*d,d]}function Ys(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=Iee(c,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var SD=new Date(1899,11,31,0,0,0),Pee=SD.getTime(),Oee=new Date(1900,2,1,0,0,0);function kD(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Oee&&(r+=24*60*60*1e3),(r-(Pee+(e.getTimezoneOffset()-SD.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function R2(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Dee(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Ree(e){var t=e<0?12:11,r=R2(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Mee(e){var t=R2(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function nf(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Ree(e):t===10?r=e.toFixed(10).substr(0,12):r=Mee(e),R2(Dee(r.toUpperCase()))}function Cl(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):nf(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Fa(14,kD(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Iee(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Fee(e,t,r,n){var a="",i=0,s=0,o=r.y,c,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return Mx[r.m-1][1];case 5:return Mx[r.m-1][0];default:return Mx[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return rE[r.q][0];default:return rE[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Ni(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=Ni(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var d=u>0?Ni(c,u):"";return d}function Js(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var _D=/%/g;function Lee(e,t,r){var n=t.replace(_D,""),a=t.length-n.length;return ps(e,n,r*Math.pow(10,2*a))+yr("%",a)}function Bee(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ps(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function ED(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+ED(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(a+i)%a)+"."+d.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var CD=/# (\?+)( ?)\/( ?)(\d+)/;function jee(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,o=n;return r+(i===0?"":""+i)+" "+(s===0?yr(" ",e[1].length+1+e[4].length):D2(s,e[1].length)+e[2]+"/"+e[3]+Ni(o,e[4].length))}function $ee(e,t,r){return r+(t===0?"":""+t)+yr(" ",e[1].length+2+e[4].length)}var AD=/^#*0*\.([0#]+)/,TD=/\).*[0#]/,PD=/\(###\) ###\\?-####/;function jn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function aE(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function iE(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Uee(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function zee(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ga(e,t,r){if(e.charCodeAt(0)===40&&!t.match(TD)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ga("n",n,r):"("+Ga("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Bee(e,t,r);if(t.indexOf("%")!==-1)return Lee(e,t,r);if(t.indexOf("E")!==-1)return ED(t,r);if(t.charCodeAt(0)===36)return"$"+Ga(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Yl(c,t.length);if(t.match(/^[#?]+$/))return a=Yl(r,0),a==="0"&&(a=""),a.length>t.length?a:jn(t.substr(0,t.length-a.length))+a;if(i=t.match(CD))return jee(i,c,u);if(t.match(/^#+0+$/))return u+Yl(c,t.length-t.indexOf("0"));if(i=t.match(AD))return a=aE(r,i[1].length).replace(/^([^\.]+)$/,"$1."+jn(i[1])).replace(/\.$/,"."+jn(i[1])).replace(/\.(\d*)$/,function(x,g){return"."+g+yr("0",jn(i[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+aE(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+Js(Yl(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ga(e,t,-r):Js(""+(Math.floor(r)+Uee(r,i[1].length)))+"."+Ni(iE(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Ga(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Cc(Ga(e,t.replace(/[\\-]/g,""),r)),s=0,Cc(Cc(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return s<a.length?a.charAt(s++):x==="0"?"0":""}));if(t.match(PD))return a=Ga(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Fh(c,Math.pow(10,s)-1,!1),a=""+u,d=ps("n",i[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+i[2]+"/"+i[3],d=Mh(o[2],s),d.length<i[4].length&&(d=jn(i[4].substr(i[4].length-d.length))+d),a+=d,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=Fh(c,Math.pow(10,s)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?D2(o[1],s)+i[2]+"/"+i[3]+Mh(o[2],s):yr(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Yl(r,0),t.length<=a.length?a:jn(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var f=t.indexOf(".")-s,h=t.length-a.length-f;return jn(t.substr(0,f)+a+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=iE(r,i[1].length),r<0?"-"+Ga(e,t,-r):Js(zee(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Ni(0,3-x.length):"")+x})+"."+Ni(s,i[1].length);switch(t){case"###,##0.00":return Ga(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Js(Yl(c,0));return p!=="0"?u+p:"";case"###,###.00":return Ga(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ga(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Hee(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ps(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Wee(e,t,r){var n=t.replace(_D,""),a=t.length-n.length;return ps(e,n,r*Math.pow(10,2*a))+yr("%",a)}function OD(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+OD(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(a+i)%a)+"."+d.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ii(e,t,r){if(e.charCodeAt(0)===40&&!t.match(TD)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ii("n",n,r):"("+Ii("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Hee(e,t,r);if(t.indexOf("%")!==-1)return Wee(e,t,r);if(t.indexOf("E")!==-1)return OD(t,r);if(t.charCodeAt(0)===36)return"$"+Ii(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Ni(c,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:jn(t.substr(0,t.length-a.length))+a;if(i=t.match(CD))return $ee(i,c,u);if(t.match(/^#+0+$/))return u+Ni(c,t.length-t.indexOf("0"));if(i=t.match(AD))return a=(""+r).replace(/^([^\.]+)$/,"$1."+jn(i[1])).replace(/\.$/,"."+jn(i[1])),a=a.replace(/\.(\d*)$/,function(x,g){return"."+g+yr("0",jn(i[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+Js(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ii(e,t,-r):Js(""+r)+"."+yr("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Ii(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Cc(Ii(e,t.replace(/[\\-]/g,""),r)),s=0,Cc(Cc(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return s<a.length?a.charAt(s++):x==="0"?"0":""}));if(t.match(PD))return a=Ii(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Fh(c,Math.pow(10,s)-1,!1),a=""+u,d=ps("n",i[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+i[2]+"/"+i[3],d=Mh(o[2],s),d.length<i[4].length&&(d=jn(i[4].substr(i[4].length-d.length))+d),a+=d,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=Fh(c,Math.pow(10,s)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?D2(o[1],s)+i[2]+"/"+i[3]+Mh(o[2],s):yr(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:jn(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var f=t.indexOf(".")-s,h=t.length-a.length-f;return jn(t.substr(0,f)+a+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ii(e,t,-r):Js(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Ni(0,3-x.length):"")+x})+"."+Ni(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Js(""+c);return p!=="0"?u+p:"";default:if(t.match(/\.[0#?]*$/))return Ii(e,t.slice(0,t.lastIndexOf(".")),r)+jn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ps(e,t,r){return(r|0)===r?Ii(e,t,r):Ga(e,t,r)}function Gee(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var DD=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Bl(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Ih(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(DD))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Vee(e,t,r,n){for(var a=[],i="",s=0,o="",c="t",u,d,f,h="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!Ih(e,s))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(f=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(f);a[a.length]={t:"t",v:i},++s;break;case"\\":var p=e.charAt(++s),x=p==="("||p===")"?p:"t";a[a.length]={t:x,v:p},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(u==null&&(u=Ys(t,r,e.charAt(s+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},c=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Ys(t,r),u==null))return"";for(i=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),a[a.length]={t:o,v:i},c=o;break;case"A":case"a":case"":var g={t:o,v:o};if(u==null&&(u=Ys(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",h="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",s+=5,h="h"):e.substr(s,5).toUpperCase()==="/"?(u!=null&&(g.v=u.H>=12?"":""),g.t="T",s+=5,h="h"):(g.t="t",++s),u==null&&g.t==="T")return"";a[a.length]=g,c=o;break;case"[":for(i=o;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(DD)){if(u==null&&(u=Ys(t,r),u==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Bl(e)||(a[a.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=o;++s<e.length&&(o=e.charAt(s))==="0";)i+=o;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)i+=o;a[a.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++s)===o;)i+=o;a[a.length]={t:o,v:i},c=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:o,v:o},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++s;break}var y=0,v=0,w;for(s=a.length-1,c="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=h,c="h",y<1&&(y=1);break;case"s":(w=a[s].v.match(/\.0+$/))&&(v=Math.max(v,w[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":c=a[s].t;break;case"m":c==="s"&&(a[s].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&a[s].v.match(/[Hh]/)&&(y=1),y<2&&a[s].v.match(/[Mm]/)&&(y=2),y<3&&a[s].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var b="",S;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=Fee(a[s].t.charCodeAt(0),a[s].v,u,v),a[s].t="t";break;case"n":case"?":for(S=s+1;a[S]!=null&&((o=a[S].t)==="?"||o==="D"||(o===" "||o==="t")&&a[S+1]!=null&&(a[S+1].t==="?"||a[S+1].t==="t"&&a[S+1].v==="/")||a[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[S].v==="/"||a[S].v===" "&&a[S+1]!=null&&a[S+1].t=="?"));)a[s].v+=a[S].v,a[S]={v:"",t:";"},++S;b+=a[s].v,s=S-1;break;case"G":a[s].t="t",a[s].v=Cl(t,r);break}var k="",_,E;if(b.length>0){b.charCodeAt(0)==40?(_=t<0&&b.charCodeAt(0)===45?-t:t,E=ps("n",b,_)):(_=t<0&&n>1?-t:t,E=ps("n",b,_),_<0&&a[0]&&a[0].t=="t"&&(E=E.substr(1),a[0].v="-"+a[0].v)),S=E.length-1;var P=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){P=s;break}var A=a.length;if(P===a.length&&E.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(S>=a[s].v.length-1?(S-=a[s].v.length,a[s].v=E.substr(S+1,a[s].v.length)):S<0?a[s].v="":(a[s].v=E.substr(0,S+1),S=-1),a[s].t="t",A=s);S>=0&&A<a.length&&(a[A].v=E.substr(0,S+1)+a[A].v)}else if(P!==a.length&&E.indexOf("E")===-1){for(S=E.indexOf(".")-1,s=P;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(d=a[s].v.indexOf(".")>-1&&s===P?a[s].v.indexOf(".")-1:a[s].v.length-1,k=a[s].v.substr(d+1);d>=0;--d)S>=0&&(a[s].v.charAt(d)==="0"||a[s].v.charAt(d)==="#")&&(k=E.charAt(S--)+k);a[s].v=k,a[s].t="t",A=s}for(S>=0&&A<a.length&&(a[A].v=E.substr(0,S+1)+a[A].v),S=E.indexOf(".")+1,s=P;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==P)){for(d=a[s].v.indexOf(".")>-1&&s===P?a[s].v.indexOf(".")+1:0,k=a[s].v.substr(0,d);d<a[s].v.length;++d)S<E.length&&(k+=E.charAt(S++));a[s].v=k,a[s].t="t",A=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(_=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=ps(a[s].t,a[s].v,_),a[s].t="t");var T="";for(s=0;s!==a.length;++s)a[s]!=null&&(T+=a[s].v);return T}var sE=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function oE(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Kee(e,t){var r=Gee(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(sE),o=r[1].match(sE);return oE(t,s)?[n,r[0]]:oE(t,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,i]}function Fa(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:nt)[e],n==null&&(n=r.table&&r.table[nE[e]]||nt[nE[e]]),n==null&&(n=Tee[e]||"General");break}if(Ih(n,0))return Cl(t,r);t instanceof Date&&(t=kD(t,r.date1904));var a=Kee(n,t);if(Ih(a[1]))return Cl(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Vee(a[1],t,r,a[0])}function Vi(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(nt[r]==null){t<0&&(t=r);continue}if(nt[r]==e){t=r;break}}t<0&&(t=391)}return nt[t]=e,t}function Vf(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Vi(e[t],t)}function yu(){nt=Aee()}var RD={format:Fa,load:Vi,_table:nt,load_table:Vf,parse_date_code:Ys,is_date:Bl,get_table:function(){return RD._table=nt}},Xee={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},MD=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function qee(e){var t=typeof e=="number"?nt[e]:e;return t=t.replace(MD,"(\\d+)"),new RegExp("^"+t+"$")}function Yee(e,t,r){var n=-1,a=-1,i=-1,s=-1,o=-1,c=-1;(t.match(MD)||[]).forEach(function(f,h){var p=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=p;break;case"d":i=p;break;case"h":s=p;break;case"s":c=p;break;case"m":s>=0?o=p:a=p;break}}),c>=0&&o==-1&&a>=0&&(o=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return s==-1&&o==-1&&c==-1?u:n==-1&&a==-1&&i==-1?d:u+"T"+d}var Jee=function(){var e={};e.version="1.2.0";function t(){for(var E=0,P=new Array(256),A=0;A!=256;++A)E=A,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,P[A]=E;return typeof Int32Array<"u"?new Int32Array(P):P}var r=t();function n(E){var P=0,A=0,T=0,R=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(T=0;T!=256;++T)R[T]=E[T];for(T=0;T!=256;++T)for(A=E[T],P=256+T;P<4096;P+=256)A=R[P]=A>>>8^E[A&255];var D=[];for(T=1;T!=16;++T)D[T-1]=typeof Int32Array<"u"?R.subarray(T*256,T*256+256):R.slice(T*256,T*256+256);return D}var a=n(r),i=a[0],s=a[1],o=a[2],c=a[3],u=a[4],d=a[5],f=a[6],h=a[7],p=a[8],x=a[9],g=a[10],y=a[11],v=a[12],w=a[13],b=a[14];function S(E,P){for(var A=P^-1,T=0,R=E.length;T<R;)A=A>>>8^r[(A^E.charCodeAt(T++))&255];return~A}function k(E,P){for(var A=P^-1,T=E.length-15,R=0;R<T;)A=b[E[R++]^A&255]^w[E[R++]^A>>8&255]^v[E[R++]^A>>16&255]^y[E[R++]^A>>>24]^g[E[R++]]^x[E[R++]]^p[E[R++]]^h[E[R++]]^f[E[R++]]^d[E[R++]]^u[E[R++]]^c[E[R++]]^o[E[R++]]^s[E[R++]]^i[E[R++]]^r[E[R++]];for(T+=15;R<T;)A=A>>>8^r[(A^E[R++])&255];return~A}function _(E,P){for(var A=P^-1,T=0,R=E.length,D=0,L=0;T<R;)D=E.charCodeAt(T++),D<128?A=A>>>8^r[(A^D)&255]:D<2048?(A=A>>>8^r[(A^(192|D>>6&31))&255],A=A>>>8^r[(A^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,L=E.charCodeAt(T++)&1023,A=A>>>8^r[(A^(240|D>>8&7))&255],A=A>>>8^r[(A^(128|D>>2&63))&255],A=A>>>8^r[(A^(128|L>>6&15|(D&3)<<4))&255],A=A>>>8^r[(A^(128|L&63))&255]):(A=A>>>8^r[(A^(224|D>>12&15))&255],A=A>>>8^r[(A^(128|D>>6&63))&255],A=A>>>8^r[(A^(128|D&63))&255]);return~A}return e.table=r,e.bstr=S,e.buf=k,e.str=_,e}(),rt=function(){var t={};t.version="1.2.1";function r(C,M){for(var B=C.split("/"),O=M.split("/"),F=0,H=0,Z=Math.min(B.length,O.length);F<Z;++F){if(H=B[F].length-O[F].length)return H;if(B[F]!=O[F])return B[F]<O[F]?-1:1}return B.length-O.length}function n(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:n(C.slice(0,-1));var M=C.lastIndexOf("/");return M===-1?C:C.slice(0,M+1)}function a(C){if(C.charAt(C.length-1)=="/")return a(C.slice(0,-1));var M=C.lastIndexOf("/");return M===-1?C:C.slice(M+1)}function i(C,M){typeof M=="string"&&(M=new Date(M));var B=M.getHours();B=B<<6|M.getMinutes(),B=B<<5|M.getSeconds()>>>1,C.write_shift(2,B);var O=M.getFullYear()-1980;O=O<<4|M.getMonth()+1,O=O<<5|M.getDate(),C.write_shift(2,O)}function s(C){var M=C.read_shift(2)&65535,B=C.read_shift(2)&65535,O=new Date,F=B&31;B>>>=5;var H=B&15;B>>>=4,O.setMilliseconds(0),O.setFullYear(B+1980),O.setMonth(H-1),O.setDate(F);var Z=M&31;M>>>=5;var se=M&63;return M>>>=6,O.setHours(M),O.setMinutes(se),O.setSeconds(Z<<1),O}function o(C){dn(C,0);for(var M={},B=0;C.l<=C.length-4;){var O=C.read_shift(2),F=C.read_shift(2),H=C.l+F,Z={};switch(O){case 21589:B=C.read_shift(1),B&1&&(Z.mtime=C.read_shift(4)),F>5&&(B&2&&(Z.atime=C.read_shift(4)),B&4&&(Z.ctime=C.read_shift(4))),Z.mtime&&(Z.mt=new Date(Z.mtime*1e3));break}C.l=H,M[O]=Z}return M}var c;function u(){return c||(c={})}function d(C,M){if(C[0]==80&&C[1]==75)return Ne(C,M);if((C[0]|32)==109&&(C[1]|32)==105)return ot(C,M);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var B=3,O=512,F=0,H=0,Z=0,se=0,ie=0,ue=[],fe=C.slice(0,512);dn(fe,0);var Se=f(fe);switch(B=Se[0],B){case 3:O=512;break;case 4:O=4096;break;case 0:if(Se[1]==0)return Ne(C,M);default:throw new Error("Major Version: Expected 3 or 4 saw "+B)}O!==512&&(fe=C.slice(0,O),dn(fe,28));var Te=C.slice(0,O);h(fe,B);var Ue=fe.read_shift(4,"i");if(B===3&&Ue!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ue);fe.l+=4,Z=fe.read_shift(4,"i"),fe.l+=4,fe.chk("00100000","Mini Stream Cutoff Size: "),se=fe.read_shift(4,"i"),F=fe.read_shift(4,"i"),ie=fe.read_shift(4,"i"),H=fe.read_shift(4,"i");for(var Ce=-1,Le=0;Le<109&&(Ce=fe.read_shift(4,"i"),!(Ce<0));++Le)ue[Le]=Ce;var dt=p(C,O);y(ie,H,dt,O,ue);var ur=w(dt,Z,ue,O);ur[Z].name="!Directory",F>0&&se!==L&&(ur[se].name="!MiniFAT"),ur[ue[0]].name="!FAT",ur.fat_addrs=ue,ur.ssz=O;var dr={},xn=[],Su=[],ku=[];b(Z,ur,dt,xn,F,dr,Su,se),x(Su,ku,xn),xn.shift();var _u={FileIndex:Su,FullPaths:ku};return M&&M.raw&&(_u.raw={header:Te,sectors:dt}),_u}function f(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(z,"Header Signature: "),C.l+=16;var M=C.read_shift(2,"u");return[C.read_shift(2,"u"),M]}function h(C,M){var B=9;switch(C.l+=2,B=C.read_shift(2)){case 9:if(M!=3)throw new Error("Sector Shift: Expected 9 saw "+B);break;case 12:if(M!=4)throw new Error("Sector Shift: Expected 12 saw "+B);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+B)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function p(C,M){for(var B=Math.ceil(C.length/M)-1,O=[],F=1;F<B;++F)O[F-1]=C.slice(F*M,(F+1)*M);return O[B-1]=C.slice(B*M),O}function x(C,M,B){for(var O=0,F=0,H=0,Z=0,se=0,ie=B.length,ue=[],fe=[];O<ie;++O)ue[O]=fe[O]=O,M[O]=B[O];for(;se<fe.length;++se)O=fe[se],F=C[O].L,H=C[O].R,Z=C[O].C,ue[O]===O&&(F!==-1&&ue[F]!==F&&(ue[O]=ue[F]),H!==-1&&ue[H]!==H&&(ue[O]=ue[H])),Z!==-1&&(ue[Z]=O),F!==-1&&O!=ue[O]&&(ue[F]=ue[O],fe.lastIndexOf(F)<se&&fe.push(F)),H!==-1&&O!=ue[O]&&(ue[H]=ue[O],fe.lastIndexOf(H)<se&&fe.push(H));for(O=1;O<ie;++O)ue[O]===O&&(H!==-1&&ue[H]!==H?ue[O]=ue[H]:F!==-1&&ue[F]!==F&&(ue[O]=ue[F]));for(O=1;O<ie;++O)if(C[O].type!==0){if(se=O,se!=ue[se])do se=ue[se],M[O]=M[se]+"/"+M[O];while(se!==0&&ue[se]!==-1&&se!=ue[se]);ue[O]=-1}for(M[0]+="/",O=1;O<ie;++O)C[O].type!==2&&(M[O]+="/")}function g(C,M,B){for(var O=C.start,F=C.size,H=[],Z=O;B&&F>0&&Z>=0;)H.push(M.slice(Z*D,Z*D+D)),F-=D,Z=Ho(B,Z*4);return H.length===0?ge(0):en(H).slice(0,C.size)}function y(C,M,B,O,F){var H=L;if(C===L){if(M!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var Z=B[C],se=(O>>>2)-1;if(!Z)return;for(var ie=0;ie<se&&(H=Ho(Z,ie*4))!==L;++ie)F.push(H);y(Ho(Z,O-4),M-1,B,O,F)}}function v(C,M,B,O,F){var H=[],Z=[];F||(F=[]);var se=O-1,ie=0,ue=0;for(ie=M;ie>=0;){F[ie]=!0,H[H.length]=ie,Z.push(C[ie]);var fe=B[Math.floor(ie*4/O)];if(ue=ie*4&se,O<4+ue)throw new Error("FAT boundary crossed: "+ie+" 4 "+O);if(!C[fe])break;ie=Ho(C[fe],ue)}return{nodes:H,data:yE([Z])}}function w(C,M,B,O){var F=C.length,H=[],Z=[],se=[],ie=[],ue=O-1,fe=0,Se=0,Te=0,Ue=0;for(fe=0;fe<F;++fe)if(se=[],Te=fe+M,Te>=F&&(Te-=F),!Z[Te]){ie=[];var Ce=[];for(Se=Te;Se>=0;){Ce[Se]=!0,Z[Se]=!0,se[se.length]=Se,ie.push(C[Se]);var Le=B[Math.floor(Se*4/O)];if(Ue=Se*4&ue,O<4+Ue)throw new Error("FAT boundary crossed: "+Se+" 4 "+O);if(!C[Le]||(Se=Ho(C[Le],Ue),Ce[Se]))break}H[Te]={nodes:se,data:yE([ie])}}return H}function b(C,M,B,O,F,H,Z,se){for(var ie=0,ue=O.length?2:0,fe=M[C].data,Se=0,Te=0,Ue;Se<fe.length;Se+=128){var Ce=fe.slice(Se,Se+128);dn(Ce,64),Te=Ce.read_shift(2),Ue=Ng(Ce,0,Te-ue),O.push(Ue);var Le={name:Ue,type:Ce.read_shift(1),color:Ce.read_shift(1),L:Ce.read_shift(4,"i"),R:Ce.read_shift(4,"i"),C:Ce.read_shift(4,"i"),clsid:Ce.read_shift(16),state:Ce.read_shift(4,"i"),start:0,size:0},dt=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);dt!==0&&(Le.ct=S(Ce,Ce.l-8));var ur=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);ur!==0&&(Le.mt=S(Ce,Ce.l-8)),Le.start=Ce.read_shift(4,"i"),Le.size=Ce.read_shift(4,"i"),Le.size<0&&Le.start<0&&(Le.size=Le.type=0,Le.start=L,Le.name=""),Le.type===5?(ie=Le.start,F>0&&ie!==L&&(M[ie].name="!StreamData")):Le.size>=4096?(Le.storage="fat",M[Le.start]===void 0&&(M[Le.start]=v(B,Le.start,M.fat_addrs,M.ssz)),M[Le.start].name=Le.name,Le.content=M[Le.start].data.slice(0,Le.size)):(Le.storage="minifat",Le.size<0?Le.size=0:ie!==L&&Le.start!==L&&M[ie]&&(Le.content=g(Le,M[ie].data,(M[se]||{}).data))),Le.content&&dn(Le.content,0),H[Ue]=Le,Z.push(Le)}}function S(C,M){return new Date((Zr(C,M+4)/1e7*Math.pow(2,32)+Zr(C,M)/1e7-11644473600)*1e3)}function k(C,M){return u(),d(c.readFileSync(C),M)}function _(C,M){var B=M&&M.type;switch(B||wt&&Buffer.isBuffer(C)&&(B="buffer"),B||"base64"){case"file":return k(C,M);case"base64":return d(Sa(Ia(C)),M);case"binary":return d(Sa(C),M)}return d(C,M)}function E(C,M){var B=M||{},O=B.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=O+"/",C.FileIndex[0]={name:O,type:5}),B.CLSID&&(C.FileIndex[0].clsid=B.CLSID),P(C)}function P(C){var M="Sh33tJ5";if(!rt.find(C,"/"+M)){var B=ge(4);B[0]=55,B[1]=B[3]=50,B[2]=54,C.FileIndex.push({name:M,type:2,content:B,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+M),A(C)}}function A(C,M){E(C);for(var B=!1,O=!1,F=C.FullPaths.length-1;F>=0;--F){var H=C.FileIndex[F];switch(H.type){case 0:O?B=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:O=!0,isNaN(H.R*H.L*H.C)&&(B=!0),H.R>-1&&H.L>-1&&H.R==H.L&&(B=!0);break;default:B=!0;break}}if(!(!B&&!M)){var Z=new Date(1987,1,19),se=0,ie=Object.create?Object.create(null):{},ue=[];for(F=0;F<C.FullPaths.length;++F)ie[C.FullPaths[F]]=!0,C.FileIndex[F].type!==0&&ue.push([C.FullPaths[F],C.FileIndex[F]]);for(F=0;F<ue.length;++F){var fe=n(ue[F][0]);O=ie[fe],O||(ue.push([fe,{name:a(fe).replace("/",""),type:1,clsid:Y,ct:Z,mt:Z,content:null}]),ie[fe]=!0)}for(ue.sort(function(Ue,Ce){return r(Ue[0],Ce[0])}),C.FullPaths=[],C.FileIndex=[],F=0;F<ue.length;++F)C.FullPaths[F]=ue[F][0],C.FileIndex[F]=ue[F][1];for(F=0;F<ue.length;++F){var Se=C.FileIndex[F],Te=C.FullPaths[F];if(Se.name=a(Te).replace("/",""),Se.L=Se.R=Se.C=-(Se.color=1),Se.size=Se.content?Se.content.length:0,Se.start=0,Se.clsid=Se.clsid||Y,F===0)Se.C=ue.length>1?1:-1,Se.size=0,Se.type=5;else if(Te.slice(-1)=="/"){for(se=F+1;se<ue.length&&n(C.FullPaths[se])!=Te;++se);for(Se.C=se>=ue.length?-1:se,se=F+1;se<ue.length&&n(C.FullPaths[se])!=n(Te);++se);Se.R=se>=ue.length?-1:se,Se.type=1}else n(C.FullPaths[F+1]||"")==n(Te)&&(Se.R=F+1),Se.type=2}}}function T(C,M){var B=M||{};if(B.fileType=="mad")return Tt(C,B);switch(A(C),B.fileType){case"zip":return at(C,B)}var O=function(Ue){for(var Ce=0,Le=0,dt=0;dt<Ue.FileIndex.length;++dt){var ur=Ue.FileIndex[dt];if(ur.content){var dr=ur.content.length;dr>0&&(dr<4096?Ce+=dr+63>>6:Le+=dr+511>>9)}}for(var xn=Ue.FullPaths.length+3>>2,Su=Ce+7>>3,ku=Ce+127>>7,_u=Su+Le+xn+ku,Io=_u+127>>7,Tg=Io<=109?0:Math.ceil((Io-109)/127);_u+Io+Tg+127>>7>Io;)Tg=++Io<=109?0:Math.ceil((Io-109)/127);var Zi=[1,Tg,Io,ku,xn,Le,Ce,0];return Ue.FileIndex[0].size=Ce<<6,Zi[7]=(Ue.FileIndex[0].start=Zi[0]+Zi[1]+Zi[2]+Zi[3]+Zi[4]+Zi[5])+(Zi[6]+7>>3),Zi}(C),F=ge(O[7]<<9),H=0,Z=0;{for(H=0;H<8;++H)F.write_shift(1,X[H]);for(H=0;H<8;++H)F.write_shift(2,0);for(F.write_shift(2,62),F.write_shift(2,3),F.write_shift(2,65534),F.write_shift(2,9),F.write_shift(2,6),H=0;H<3;++H)F.write_shift(2,0);for(F.write_shift(4,0),F.write_shift(4,O[2]),F.write_shift(4,O[0]+O[1]+O[2]+O[3]-1),F.write_shift(4,0),F.write_shift(4,4096),F.write_shift(4,O[3]?O[0]+O[1]+O[2]-1:L),F.write_shift(4,O[3]),F.write_shift(-4,O[1]?O[0]-1:L),F.write_shift(4,O[1]),H=0;H<109;++H)F.write_shift(-4,H<O[2]?O[1]+H:-1)}if(O[1])for(Z=0;Z<O[1];++Z){for(;H<236+Z*127;++H)F.write_shift(-4,H<O[2]?O[1]+H:-1);F.write_shift(-4,Z===O[1]-1?L:Z+1)}var se=function(Ue){for(Z+=Ue;H<Z-1;++H)F.write_shift(-4,H+1);Ue&&(++H,F.write_shift(-4,L))};for(Z=H=0,Z+=O[1];H<Z;++H)F.write_shift(-4,q.DIFSECT);for(Z+=O[2];H<Z;++H)F.write_shift(-4,q.FATSECT);se(O[3]),se(O[4]);for(var ie=0,ue=0,fe=C.FileIndex[0];ie<C.FileIndex.length;++ie)fe=C.FileIndex[ie],fe.content&&(ue=fe.content.length,!(ue<4096)&&(fe.start=Z,se(ue+511>>9)));for(se(O[6]+7>>3);F.l&511;)F.write_shift(-4,q.ENDOFCHAIN);for(Z=H=0,ie=0;ie<C.FileIndex.length;++ie)fe=C.FileIndex[ie],fe.content&&(ue=fe.content.length,!(!ue||ue>=4096)&&(fe.start=Z,se(ue+63>>6)));for(;F.l&511;)F.write_shift(-4,q.ENDOFCHAIN);for(H=0;H<O[4]<<2;++H){var Se=C.FullPaths[H];if(!Se||Se.length===0){for(ie=0;ie<17;++ie)F.write_shift(4,0);for(ie=0;ie<3;++ie)F.write_shift(4,-1);for(ie=0;ie<12;++ie)F.write_shift(4,0);continue}fe=C.FileIndex[H],H===0&&(fe.start=fe.size?fe.start-1:L);var Te=H===0&&B.root||fe.name;if(ue=2*(Te.length+1),F.write_shift(64,Te,"utf16le"),F.write_shift(2,ue),F.write_shift(1,fe.type),F.write_shift(1,fe.color),F.write_shift(-4,fe.L),F.write_shift(-4,fe.R),F.write_shift(-4,fe.C),fe.clsid)F.write_shift(16,fe.clsid,"hex");else for(ie=0;ie<4;++ie)F.write_shift(4,0);F.write_shift(4,fe.state||0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,fe.start),F.write_shift(4,fe.size),F.write_shift(4,0)}for(H=1;H<C.FileIndex.length;++H)if(fe=C.FileIndex[H],fe.size>=4096)if(F.l=fe.start+1<<9,wt&&Buffer.isBuffer(fe.content))fe.content.copy(F,F.l,0,fe.size),F.l+=fe.size+511&-512;else{for(ie=0;ie<fe.size;++ie)F.write_shift(1,fe.content[ie]);for(;ie&511;++ie)F.write_shift(1,0)}for(H=1;H<C.FileIndex.length;++H)if(fe=C.FileIndex[H],fe.size>0&&fe.size<4096)if(wt&&Buffer.isBuffer(fe.content))fe.content.copy(F,F.l,0,fe.size),F.l+=fe.size+63&-64;else{for(ie=0;ie<fe.size;++ie)F.write_shift(1,fe.content[ie]);for(;ie&63;++ie)F.write_shift(1,0)}if(wt)F.l=F.length;else for(;F.l<F.length;)F.write_shift(1,0);return F}function R(C,M){var B=C.FullPaths.map(function(ie){return ie.toUpperCase()}),O=B.map(function(ie){var ue=ie.split("/");return ue[ue.length-(ie.slice(-1)=="/"?2:1)]}),F=!1;M.charCodeAt(0)===47?(F=!0,M=B[0].slice(0,-1)+M):F=M.indexOf("/")!==-1;var H=M.toUpperCase(),Z=F===!0?B.indexOf(H):O.indexOf(H);if(Z!==-1)return C.FileIndex[Z];var se=!H.match(rd);for(H=H.replace(On,""),se&&(H=H.replace(rd,"!")),Z=0;Z<B.length;++Z)if((se?B[Z].replace(rd,"!"):B[Z]).replace(On,"")==H||(se?O[Z].replace(rd,"!"):O[Z]).replace(On,"")==H)return C.FileIndex[Z];return null}var D=64,L=-2,z="d0cf11e0a1b11ae1",X=[208,207,17,224,161,177,26,225],Y="00000000000000000000000000000000",q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:L,FREESECT:-1,HEADER_SIGNATURE:z,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ee(C,M,B){u();var O=T(C,B);c.writeFileSync(M,O)}function V(C){for(var M=new Array(C.length),B=0;B<C.length;++B)M[B]=String.fromCharCode(C[B]);return M.join("")}function ae(C,M){var B=T(C,M);switch(M&&M.type||"buffer"){case"file":return u(),c.writeFileSync(M.filename,B),B;case"binary":return typeof B=="string"?B:V(B);case"base64":return rf(typeof B=="string"?B:V(B));case"buffer":if(wt)return Buffer.isBuffer(B)?B:Ms(B);case"array":return typeof B=="string"?Sa(B):B}return B}var oe;function I(C){try{var M=C.InflateRaw,B=new M;if(B._processChunk(new Uint8Array([3,0]),B._finishFlushFlag),B.bytesRead)oe=C;else throw new Error("zlib does not expose bytesRead")}catch(O){console.error("cannot use native zlib: "+(O.message||O))}}function W(C,M){if(!oe)return _r(C,M);var B=oe.InflateRaw,O=new B,F=O._processChunk(C.slice(C.l),O._finishFlushFlag);return C.l+=O.bytesRead,F}function U(C){return oe?oe.deflateRawSync(C):tt(C)}var G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ne=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],K=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function le(C){var M=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(M>>16|M>>8|M)&255}for(var Q=typeof Uint8Array<"u",ce=Q?new Uint8Array(256):[],be=0;be<256;++be)ce[be]=le(be);function j(C,M){var B=ce[C&255];return M<=8?B>>>8-M:(B=B<<8|ce[C>>8&255],M<=16?B>>>16-M:(B=B<<8|ce[C>>16&255],B>>>24-M))}function $e(C,M){var B=M&7,O=M>>>3;return(C[O]|(B<=6?0:C[O+1]<<8))>>>B&3}function Ee(C,M){var B=M&7,O=M>>>3;return(C[O]|(B<=5?0:C[O+1]<<8))>>>B&7}function Ae(C,M){var B=M&7,O=M>>>3;return(C[O]|(B<=4?0:C[O+1]<<8))>>>B&15}function Be(C,M){var B=M&7,O=M>>>3;return(C[O]|(B<=3?0:C[O+1]<<8))>>>B&31}function we(C,M){var B=M&7,O=M>>>3;return(C[O]|(B<=1?0:C[O+1]<<8))>>>B&127}function de(C,M,B){var O=M&7,F=M>>>3,H=(1<<B)-1,Z=C[F]>>>O;return B<8-O||(Z|=C[F+1]<<8-O,B<16-O)||(Z|=C[F+2]<<16-O,B<24-O)||(Z|=C[F+3]<<24-O),Z&H}function Ge(C,M,B){var O=M&7,F=M>>>3;return O<=5?C[F]|=(B&7)<<O:(C[F]|=B<<O&255,C[F+1]=(B&7)>>8-O),M+3}function et(C,M,B){var O=M&7,F=M>>>3;return B=(B&1)<<O,C[F]|=B,M+1}function Qe(C,M,B){var O=M&7,F=M>>>3;return B<<=O,C[F]|=B&255,B>>>=8,C[F+1]=B,M+8}function te(C,M,B){var O=M&7,F=M>>>3;return B<<=O,C[F]|=B&255,B>>>=8,C[F+1]=B&255,C[F+2]=B>>>8,M+16}function De(C,M){var B=C.length,O=2*B>M?2*B:M+5,F=0;if(B>=M)return C;if(wt){var H=eE(O);if(C.copy)C.copy(H);else for(;F<C.length;++F)H[F]=C[F];return H}else if(Q){var Z=new Uint8Array(O);if(Z.set)Z.set(C);else for(;F<B;++F)Z[F]=C[F];return Z}return C.length=O,C}function ze(C){for(var M=new Array(C),B=0;B<C;++B)M[B]=0;return M}function ct(C,M,B){var O=1,F=0,H=0,Z=0,se=0,ie=C.length,ue=Q?new Uint16Array(32):ze(32);for(H=0;H<32;++H)ue[H]=0;for(H=ie;H<B;++H)C[H]=0;ie=C.length;var fe=Q?new Uint16Array(ie):ze(ie);for(H=0;H<ie;++H)ue[F=C[H]]++,O<F&&(O=F),fe[H]=0;for(ue[0]=0,H=1;H<=O;++H)ue[H+16]=se=se+ue[H-1]<<1;for(H=0;H<ie;++H)se=C[H],se!=0&&(fe[H]=ue[se+16]++);var Se=0;for(H=0;H<ie;++H)if(Se=C[H],Se!=0)for(se=j(fe[H],O)>>O-Se,Z=(1<<O+4-Se)-1;Z>=0;--Z)M[se|Z<<Se]=Se&15|H<<4;return O}var Ke=Q?new Uint16Array(512):ze(512),mt=Q?new Uint16Array(32):ze(32);if(!Q){for(var ht=0;ht<512;++ht)Ke[ht]=0;for(ht=0;ht<32;++ht)mt[ht]=0}(function(){for(var C=[],M=0;M<32;M++)C.push(5);ct(C,mt,32);var B=[];for(M=0;M<=143;M++)B.push(8);for(;M<=255;M++)B.push(9);for(;M<=279;M++)B.push(7);for(;M<=287;M++)B.push(8);ct(B,Ke,288)})();var Re=function(){for(var M=Q?new Uint8Array(32768):[],B=0,O=0;B<K.length-1;++B)for(;O<K[B+1];++O)M[O]=B;for(;O<32768;++O)M[O]=29;var F=Q?new Uint8Array(259):[];for(B=0,O=0;B<ne.length-1;++B)for(;O<ne[B+1];++O)F[O]=B;function H(se,ie){for(var ue=0;ue<se.length;){var fe=Math.min(65535,se.length-ue),Se=ue+fe==se.length;for(ie.write_shift(1,+Se),ie.write_shift(2,fe),ie.write_shift(2,~fe&65535);fe-- >0;)ie[ie.l++]=se[ue++]}return ie.l}function Z(se,ie){for(var ue=0,fe=0,Se=Q?new Uint16Array(32768):[];fe<se.length;){var Te=Math.min(65535,se.length-fe);if(Te<10){for(ue=Ge(ie,ue,+(fe+Te==se.length)),ue&7&&(ue+=8-(ue&7)),ie.l=ue/8|0,ie.write_shift(2,Te),ie.write_shift(2,~Te&65535);Te-- >0;)ie[ie.l++]=se[fe++];ue=ie.l*8;continue}ue=Ge(ie,ue,+(fe+Te==se.length)+2);for(var Ue=0;Te-- >0;){var Ce=se[fe];Ue=(Ue<<5^Ce)&32767;var Le=-1,dt=0;if((Le=Se[Ue])&&(Le|=fe&-32768,Le>fe&&(Le-=32768),Le<fe))for(;se[Le+dt]==se[fe+dt]&&dt<250;)++dt;if(dt>2){Ce=F[dt],Ce<=22?ue=Qe(ie,ue,ce[Ce+1]>>1)-1:(Qe(ie,ue,3),ue+=5,Qe(ie,ue,ce[Ce-23]>>5),ue+=3);var ur=Ce<8?0:Ce-4>>2;ur>0&&(te(ie,ue,dt-ne[Ce]),ue+=ur),Ce=M[fe-Le],ue=Qe(ie,ue,ce[Ce]>>3),ue-=3;var dr=Ce<4?0:Ce-2>>1;dr>0&&(te(ie,ue,fe-Le-K[Ce]),ue+=dr);for(var xn=0;xn<dt;++xn)Se[Ue]=fe&32767,Ue=(Ue<<5^se[fe])&32767,++fe;Te-=dt-1}else Ce<=143?Ce=Ce+48:ue=et(ie,ue,1),ue=Qe(ie,ue,ce[Ce]),Se[Ue]=fe&32767,++fe}ue=Qe(ie,ue,0)-1}return ie.l=(ue+7)/8|0,ie.l}return function(ie,ue){return ie.length<8?H(ie,ue):Z(ie,ue)}}();function tt(C){var M=ge(50+Math.floor(C.length*1.1)),B=Re(C,M);return M.slice(0,B)}var kt=Q?new Uint16Array(32768):ze(32768),Lt=Q?new Uint16Array(32768):ze(32768),xe=Q?new Uint16Array(128):ze(128),Ie=1,ut=1;function Ht(C,M){var B=Be(C,M)+257;M+=5;var O=Be(C,M)+1;M+=5;var F=Ae(C,M)+4;M+=4;for(var H=0,Z=Q?new Uint8Array(19):ze(19),se=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ie=1,ue=Q?new Uint8Array(8):ze(8),fe=Q?new Uint8Array(8):ze(8),Se=Z.length,Te=0;Te<F;++Te)Z[G[Te]]=H=Ee(C,M),ie<H&&(ie=H),ue[H]++,M+=3;var Ue=0;for(ue[0]=0,Te=1;Te<=ie;++Te)fe[Te]=Ue=Ue+ue[Te-1]<<1;for(Te=0;Te<Se;++Te)(Ue=Z[Te])!=0&&(se[Te]=fe[Ue]++);var Ce=0;for(Te=0;Te<Se;++Te)if(Ce=Z[Te],Ce!=0){Ue=ce[se[Te]]>>8-Ce;for(var Le=(1<<7-Ce)-1;Le>=0;--Le)xe[Ue|Le<<Ce]=Ce&7|Te<<3}var dt=[];for(ie=1;dt.length<B+O;)switch(Ue=xe[we(C,M)],M+=Ue&7,Ue>>>=3){case 16:for(H=3+$e(C,M),M+=2,Ue=dt[dt.length-1];H-- >0;)dt.push(Ue);break;case 17:for(H=3+Ee(C,M),M+=3;H-- >0;)dt.push(0);break;case 18:for(H=11+we(C,M),M+=7;H-- >0;)dt.push(0);break;default:dt.push(Ue),ie<Ue&&(ie=Ue);break}var ur=dt.slice(0,B),dr=dt.slice(B);for(Te=B;Te<286;++Te)ur[Te]=0;for(Te=O;Te<30;++Te)dr[Te]=0;return Ie=ct(ur,kt,286),ut=ct(dr,Lt,30),M}function kr(C,M){if(C[0]==3&&!(C[1]&3))return[bo(M),2];for(var B=0,O=0,F=eE(M||1<<18),H=0,Z=F.length>>>0,se=0,ie=0;!(O&1);){if(O=Ee(C,B),B+=3,O>>>1)O>>1==1?(se=9,ie=5):(B=Ht(C,B),se=Ie,ie=ut);else{B&7&&(B+=8-(B&7));var ue=C[B>>>3]|C[(B>>>3)+1]<<8;if(B+=32,ue>0)for(!M&&Z<H+ue&&(F=De(F,H+ue),Z=F.length);ue-- >0;)F[H++]=C[B>>>3],B+=8;continue}for(;;){!M&&Z<H+32767&&(F=De(F,H+32767),Z=F.length);var fe=de(C,B,se),Se=O>>>1==1?Ke[fe]:kt[fe];if(B+=Se&15,Se>>>=4,!(Se>>>8&255))F[H++]=Se;else{if(Se==256)break;Se-=257;var Te=Se<8?0:Se-4>>2;Te>5&&(Te=0);var Ue=H+ne[Se];Te>0&&(Ue+=de(C,B,Te),B+=Te),fe=de(C,B,ie),Se=O>>>1==1?mt[fe]:Lt[fe],B+=Se&15,Se>>>=4;var Ce=Se<4?0:Se-2>>1,Le=K[Se];for(Ce>0&&(Le+=de(C,B,Ce),B+=Ce),!M&&Z<Ue&&(F=De(F,Ue+100),Z=F.length);H<Ue;)F[H]=F[H-Le],++H}}}return M?[F,B+7>>>3]:[F.slice(0,H),B+7>>>3]}function _r(C,M){var B=C.slice(C.l||0),O=kr(B,M);return C.l+=O[1],O[0]}function re(C,M){if(C)typeof console<"u"&&console.error(M);else throw new Error(M)}function Ne(C,M){var B=C;dn(B,0);var O=[],F=[],H={FileIndex:O,FullPaths:F};E(H,{root:M.root});for(var Z=B.length-4;(B[Z]!=80||B[Z+1]!=75||B[Z+2]!=5||B[Z+3]!=6)&&Z>=0;)--Z;B.l=Z+4,B.l+=4;var se=B.read_shift(2);B.l+=6;var ie=B.read_shift(4);for(B.l=ie,Z=0;Z<se;++Z){B.l+=20;var ue=B.read_shift(4),fe=B.read_shift(4),Se=B.read_shift(2),Te=B.read_shift(2),Ue=B.read_shift(2);B.l+=8;var Ce=B.read_shift(4),Le=o(B.slice(B.l+Se,B.l+Se+Te));B.l+=Se+Te+Ue;var dt=B.l;B.l=Ce+4,je(B,ue,fe,H,Le),B.l=dt}return H}function je(C,M,B,O,F){C.l+=2;var H=C.read_shift(2),Z=C.read_shift(2),se=s(C);if(H&8257)throw new Error("Unsupported ZIP encryption");for(var ie=C.read_shift(4),ue=C.read_shift(4),fe=C.read_shift(4),Se=C.read_shift(2),Te=C.read_shift(2),Ue="",Ce=0;Ce<Se;++Ce)Ue+=String.fromCharCode(C[C.l++]);if(Te){var Le=o(C.slice(C.l,C.l+Te));(Le[21589]||{}).mt&&(se=Le[21589].mt),((F||{})[21589]||{}).mt&&(se=F[21589].mt)}C.l+=Te;var dt=C.slice(C.l,C.l+ue);switch(Z){case 8:dt=W(C,fe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Z)}var ur=!1;H&8&&(ie=C.read_shift(4),ie==134695760&&(ie=C.read_shift(4),ur=!0),ue=C.read_shift(4),fe=C.read_shift(4)),ue!=M&&re(ur,"Bad compressed size: "+M+" != "+ue),fe!=B&&re(ur,"Bad uncompressed size: "+B+" != "+fe),xr(O,Ue,dt,{unsafe:!0,mt:se})}function at(C,M){var B=M||{},O=[],F=[],H=ge(1),Z=B.compression?8:0,se=0,ie=0,ue=0,fe=0,Se=0,Te=C.FullPaths[0],Ue=Te,Ce=C.FileIndex[0],Le=[],dt=0;for(ie=1;ie<C.FullPaths.length;++ie)if(Ue=C.FullPaths[ie].slice(Te.length),Ce=C.FileIndex[ie],!(!Ce.size||!Ce.content||Ue=="Sh33tJ5")){var ur=fe,dr=ge(Ue.length);for(ue=0;ue<Ue.length;++ue)dr.write_shift(1,Ue.charCodeAt(ue)&127);dr=dr.slice(0,dr.l),Le[Se]=Jee.buf(Ce.content,0);var xn=Ce.content;Z==8&&(xn=U(xn)),H=ge(30),H.write_shift(4,67324752),H.write_shift(2,20),H.write_shift(2,se),H.write_shift(2,Z),Ce.mt?i(H,Ce.mt):H.write_shift(4,0),H.write_shift(-4,Le[Se]),H.write_shift(4,xn.length),H.write_shift(4,Ce.content.length),H.write_shift(2,dr.length),H.write_shift(2,0),fe+=H.length,O.push(H),fe+=dr.length,O.push(dr),fe+=xn.length,O.push(xn),H=ge(46),H.write_shift(4,33639248),H.write_shift(2,0),H.write_shift(2,20),H.write_shift(2,se),H.write_shift(2,Z),H.write_shift(4,0),H.write_shift(-4,Le[Se]),H.write_shift(4,xn.length),H.write_shift(4,Ce.content.length),H.write_shift(2,dr.length),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(4,0),H.write_shift(4,ur),dt+=H.l,F.push(H),dt+=dr.length,F.push(dr),++Se}return H=ge(22),H.write_shift(4,101010256),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(2,Se),H.write_shift(2,Se),H.write_shift(4,dt),H.write_shift(4,fe),H.write_shift(2,0),en([en(O),en(F),H])}var _e={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Xe(C,M){if(C.ctype)return C.ctype;var B=C.name||"",O=B.match(/\.([^\.]+)$/);return O&&_e[O[1]]||M&&(O=(B=M).match(/[\.\\]([^\.\\])+$/),O&&_e[O[1]])?_e[O[1]]:"application/octet-stream"}function Xr(C){for(var M=rf(C),B=[],O=0;O<M.length;O+=76)B.push(M.slice(O,O+76));return B.join(`\r
`)+`\r
`}function J(C){var M=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ue){var fe=ue.charCodeAt(0).toString(16).toUpperCase();return"="+(fe.length==1?"0"+fe:fe)});M=M.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),M.charAt(0)==`
`&&(M="=0D"+M.slice(1)),M=M.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var B=[],O=M.split(`\r
`),F=0;F<O.length;++F){var H=O[F];if(H.length==0){B.push("");continue}for(var Z=0;Z<H.length;){var se=76,ie=H.slice(Z,Z+se);ie.charAt(se-1)=="="?se--:ie.charAt(se-2)=="="?se-=2:ie.charAt(se-3)=="="&&(se-=3),ie=H.slice(Z,Z+se),Z+=se,Z<H.length&&(ie+="="),B.push(ie)}}return B.join(`\r
`)}function he(C){for(var M=[],B=0;B<C.length;++B){for(var O=C[B];B<=C.length&&O.charAt(O.length-1)=="=";)O=O.slice(0,O.length-1)+C[++B];M.push(O)}for(var F=0;F<M.length;++F)M[F]=M[F].replace(/[=][0-9A-Fa-f]{2}/g,function(H){return String.fromCharCode(parseInt(H.slice(1),16))});return Sa(M.join(`\r
`))}function Fe(C,M,B){for(var O="",F="",H="",Z,se=0;se<10;++se){var ie=M[se];if(!ie||ie.match(/^\s*$/))break;var ue=ie.match(/^(.*?):\s*([^\s].*)$/);if(ue)switch(ue[1].toLowerCase()){case"content-location":O=ue[2].trim();break;case"content-type":H=ue[2].trim();break;case"content-transfer-encoding":F=ue[2].trim();break}}switch(++se,F.toLowerCase()){case"base64":Z=Sa(Ia(M.slice(se).join("")));break;case"quoted-printable":Z=he(M.slice(se));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+F)}var fe=xr(C,O.slice(B.length),Z,{unsafe:!0});H&&(fe.ctype=H)}function ot(C,M){if(V(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var B=M&&M.root||"",O=(wt&&Buffer.isBuffer(C)?C.toString("binary"):V(C)).split(`\r
`),F=0,H="";for(F=0;F<O.length;++F)if(H=O[F],!!/^Content-Location:/i.test(H)&&(H=H.slice(H.indexOf("file")),B||(B=H.slice(0,H.lastIndexOf("/")+1)),H.slice(0,B.length)!=B))for(;B.length>0&&(B=B.slice(0,B.length-1),B=B.slice(0,B.lastIndexOf("/")+1),H.slice(0,B.length)!=B););var Z=(O[1]||"").match(/boundary="(.*?)"/);if(!Z)throw new Error("MAD cannot find boundary");var se="--"+(Z[1]||""),ie=[],ue=[],fe={FileIndex:ie,FullPaths:ue};E(fe);var Se,Te=0;for(F=0;F<O.length;++F){var Ue=O[F];Ue!==se&&Ue!==se+"--"||(Te++&&Fe(fe,O.slice(Se,F),B),Se=F)}return fe}function Tt(C,M){var B=M||{},O=B.boundary||"SheetJS";O="------="+O;for(var F=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+O.slice(2)+'"',"","",""],H=C.FullPaths[0],Z=H,se=C.FileIndex[0],ie=1;ie<C.FullPaths.length;++ie)if(Z=C.FullPaths[ie].slice(H.length),se=C.FileIndex[ie],!(!se.size||!se.content||Z=="Sh33tJ5")){Z=Z.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(dt){return"_x"+dt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(dt){return"_u"+dt.charCodeAt(0).toString(16)+"_"});for(var ue=se.content,fe=wt&&Buffer.isBuffer(ue)?ue.toString("binary"):V(ue),Se=0,Te=Math.min(1024,fe.length),Ue=0,Ce=0;Ce<=Te;++Ce)(Ue=fe.charCodeAt(Ce))>=32&&Ue<128&&++Se;var Le=Se>=Te*4/5;F.push(O),F.push("Content-Location: "+(B.root||"file:///C:/SheetJS/")+Z),F.push("Content-Transfer-Encoding: "+(Le?"quoted-printable":"base64")),F.push("Content-Type: "+Xe(se,Z)),F.push(""),F.push(Le?J(fe):Xr(fe))}return F.push(O+`--\r
`),F.join(`\r
`)}function Pr(C){var M={};return E(M,C),M}function xr(C,M,B,O){var F=O&&O.unsafe;F||E(C);var H=!F&&rt.find(C,M);if(!H){var Z=C.FullPaths[0];M.slice(0,Z.length)==Z?Z=M:(Z.slice(-1)!="/"&&(Z+="/"),Z=(Z+M).replace("//","/")),H={name:a(M),type:2},C.FileIndex.push(H),C.FullPaths.push(Z),F||rt.utils.cfb_gc(C)}return H.content=B,H.size=B?B.length:0,O&&(O.CLSID&&(H.clsid=O.CLSID),O.mt&&(H.mt=O.mt),O.ct&&(H.ct=O.ct)),H}function Nt(C,M){E(C);var B=rt.find(C,M);if(B){for(var O=0;O<C.FileIndex.length;++O)if(C.FileIndex[O]==B)return C.FileIndex.splice(O,1),C.FullPaths.splice(O,1),!0}return!1}function Ct(C,M,B){E(C);var O=rt.find(C,M);if(O){for(var F=0;F<C.FileIndex.length;++F)if(C.FileIndex[F]==O)return C.FileIndex[F].name=a(B),C.FullPaths[F]=B,!0}return!1}function _t(C){A(C,!0)}return t.find=R,t.read=_,t.parse=d,t.write=ae,t.writeFile=ee,t.utils={cfb_new:Pr,cfb_add:xr,cfb_del:Nt,cfb_mov:Ct,cfb_gc:_t,ReadShift:xd,CheckField:ZD,prep_blob:dn,bconcat:en,use_zlib:I,_deflateRaw:tt,_inflateRaw:_r,consts:q},t}();let Qs;function Qee(e){Qs=e}function Zee(e){return typeof e=="string"?Gf(e):Array.isArray(e)?kee(e):e}function Kf(e,t,r){if(typeof Qs<"u"&&Qs.writeFileSync)return r?Qs.writeFileSync(e,t,r):Qs.writeFileSync(e,t);if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Gf(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?$i(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([Zee(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Do(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function ete(e){if(typeof Qs<"u")return Qs.readFileSync(e);if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Sr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function lE(e,t){for(var r=[],n=Sr(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function yg(e){for(var t=[],r=Sr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function bg(e){for(var t=[],r=Sr(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function tte(e){for(var t=[],r=Sr(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Lh=new Date(1899,11,30,0,0,0);function Hr(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var n=Lh.getTime()+(e.getTimezoneOffset()-Lh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var ID=new Date,rte=Lh.getTime()+(ID.getTimezoneOffset()-Lh.getTimezoneOffset())*6e4,cE=ID.getTimezoneOffset();function wg(e){var t=new Date;return t.setTime(e*24*60*60*1e3+rte),t.getTimezoneOffset()!==cE&&t.setTime(t.getTime()+(t.getTimezoneOffset()-cE)*6e4),t}function nte(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var uE=new Date("2017-02-19T19:06:09.000Z"),FD=isNaN(uE.getFullYear())?new Date("2/19/17"):uE,ate=FD.getFullYear()==2017;function rr(e,t){var r=new Date(e);if(ate)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(FD.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Al(e,t){if(wt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return $i(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return $i(ND(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return $i(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return $i(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Vt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Vt(e[r]));return t}function yr(e,t){for(var r="";r.length<t;)r+=e;return r}function Ci(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var ite=["january","february","march","april","may","june","july","august","september","october","november","december"];function Jc(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&ite.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var ste=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),s=[i[0]],o=1;o<i.length;++o)s.push(a),s.push(i[o]);return s}}();function LD(e){return e?e.content&&e.type?Al(e.content,!0):e.data?gc(e.data):e.asNodeBuffer&&wt?gc(e.asNodeBuffer().toString("binary")):e.asBinary?gc(e.asBinary()):e._data&&e._data.getContent?gc(Al(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function BD(e){if(!e)return null;if(e.data)return Rh(e.data);if(e.asNodeBuffer&&wt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Rh(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function ote(e){return e&&e.name.slice(-4)===".bin"?BD(e):LD(e)}function Xa(e,t){for(var r=e.FullPaths||Sr(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var s=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function M2(e,t){var r=Xa(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Dr(e,t,r){if(!r)return ote(M2(e,t));if(!t)return null;try{return Dr(e,t)}catch{return null}}function ka(e,t,r){if(!r)return LD(M2(e,t));if(!t)return null;try{return ka(e,t)}catch{return null}}function jD(e,t,r){if(!r)return BD(M2(e,t));if(!t)return null;try{return jD(e,t)}catch{return null}}function dE(e){for(var t=e.FullPaths||Sr(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function vt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return wt?n=Ms(r):n=_ee(r),rt.utils.cfb_add(e,t,n)}rt.utils.cfb_add(e,t,r)}else e.file(t,r)}function I2(){return rt.utils.cfb_new()}function $D(e,t){switch(t.type){case"base64":return rt.read(e,{type:"base64"});case"binary":return rt.read(e,{type:"binary"});case"buffer":case"array":return rt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function nd(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Tr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,lte=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,fE=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,cte=/<[^>]*>/g,Fn=Tr.match(fE)?fE:cte,ute=/<\w*:/,dte=/<(\/?)\w+:/;function st(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var s=e.match(lte),o=0,c="",u=0,d="",f="",h=1;if(s)for(u=0;u!=s.length;++u){for(f=s[u],i=0;i!=f.length&&f.charCodeAt(i)!==61;++i);for(d=f.slice(0,i).trim();f.charCodeAt(i+1)==32;)++i;for(h=(a=f.charCodeAt(i+1))==34||a==39?1:0,c=f.slice(i+1+h,f.length-h),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=c,r||(n[d.toLowerCase()]=c);else{var p=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[p]&&d.slice(o-3,o)=="ext")continue;n[p]=c,r||(n[p.toLowerCase()]=c)}}return n}function Ji(e){return e.replace(dte,"<$1")}var UD={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},F2=yg(UD),Rt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(o,c){return UD[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var s=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,s)+r(a.slice(s+3))}}(),L2=/[&<>'"]/g,fte=/[\u0000-\u0008\u000b-\u001f]/g;function Ut(e){var t=e+"";return t.replace(L2,function(r){return F2[r]}).replace(fte,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function mE(e){return Ut(e).replace(/ /g,"_x0020_")}var zD=/[\u0000-\u001f]/g;function B2(e){var t=e+"";return t.replace(L2,function(r){return F2[r]}).replace(/\n/g,"<br/>").replace(zD,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function mte(e){var t=e+"";return t.replace(L2,function(r){return F2[r]}).replace(zD,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var hE=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function hte(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Zt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Ix(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function pE(e){var t=bo(2*e.length),r,n,a=1,i=0,s=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function gE(e){return Ms(e,"binary").toString("utf8")}var L0="foo bar baz",Wt=wt&&(gE(L0)==Ix(L0)&&gE||pE(L0)==Ix(L0)&&pE)||Ix,$i=wt?function(e){return Ms(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},af=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),HD=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),pte=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),gte=/<\/?(?:vt:)?variant>/g,xte=/<(?:vt:)([^>]*)>([\s\S]*)</;function xE(e,t){var r=st(e),n=e.match(pte(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var s=i.replace(gte,"").match(xte);s&&a.push({v:Wt(s[2]),t:s[1]})}),a}var WD=/(^\s|\s$|\n)/;function fn(e,t){return"<"+e+(t.match(WD)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function sf(e){return Sr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Pe(e,t,r){return"<"+e+(r!=null?sf(r):"")+(t!=null?(t.match(WD)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Xy(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function vte(e,t){switch(typeof e){case"string":var r=Pe("vt:lpwstr",Ut(e));return t&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return Pe((e|0)==e?"vt:i4":"vt:r8",Ut(String(e)));case"boolean":return Pe("vt:bool",e?"true":"false")}if(e instanceof Date)return Pe("vt:filetime",Xy(e));throw new Error("Unable to serialize "+e)}function j2(e){if(wt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Wt(Do(O2(e)));throw new Error("Bad input format: expected Buffer or string")}var of=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Ur={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},jl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],va={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function yte(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function bte(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var vE=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},yE=wt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ms(t)})):vE(e)}:vE,bE=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(ds(e,a)));return n.join("").replace(On,"")},Ng=wt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(On,""):bE(e,t,r)}:bE,wE=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},GD=wt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):wE(e,t,r)}:wE,NE=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(ec(e,a)));return n.join("")},bu=wt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):NE(t,r,n)}:NE,VD=function(e,t){var r=Zr(e,t);return r>0?bu(e,t+4,t+4+r-1):""},$2=VD,KD=function(e,t){var r=Zr(e,t);return r>0?bu(e,t+4,t+4+r-1):""},U2=KD,XD=function(e,t){var r=2*Zr(e,t);return r>0?bu(e,t+4,t+4+r-1):""},z2=XD,qD=function(t,r){var n=Zr(t,r);return n>0?Ng(t,r+4,r+4+n):""},H2=qD,YD=function(e,t){var r=Zr(e,t);return r>0?bu(e,t+4,t+4+r):""},W2=YD,JD=function(e,t){return yte(e,t)},Bh=JD,G2=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};wt&&($2=function(t,r){if(!Buffer.isBuffer(t))return VD(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},U2=function(t,r){if(!Buffer.isBuffer(t))return KD(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},z2=function(t,r){if(!Buffer.isBuffer(t))return XD(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},H2=function(t,r){if(!Buffer.isBuffer(t))return qD(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},W2=function(t,r){if(!Buffer.isBuffer(t))return YD(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Bh=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):JD(t,r)},G2=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});function QD(){Ng=function(e,t,r){return Pt.utils.decode(1200,e.slice(t,r)).replace(On,"")},bu=function(e,t,r){return Pt.utils.decode(65001,e.slice(t,r))},$2=function(e,t){var r=Zr(e,t);return r>0?Pt.utils.decode(El,e.slice(t+4,t+4+r-1)):""},U2=function(e,t){var r=Zr(e,t);return r>0?Pt.utils.decode(Oa,e.slice(t+4,t+4+r-1)):""},z2=function(e,t){var r=2*Zr(e,t);return r>0?Pt.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},H2=function(e,t){var r=Zr(e,t);return r>0?Pt.utils.decode(1200,e.slice(t+4,t+4+r)):""},W2=function(e,t){var r=Zr(e,t);return r>0?Pt.utils.decode(65001,e.slice(t+4,t+4+r)):""}}typeof Pt<"u"&&QD();var ec=function(e,t){return e[t]},ds=function(e,t){return e[t+1]*256+e[t]},wte=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Zr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ho=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Nte=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function xd(e,t){var r="",n,a,i=[],s,o,c,u;switch(t){case"dbcs":if(u=this.l,wt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(ds(this,u)),u+=2;e*=2;break;case"utf8":r=bu(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Ng(this,this.l,this.l+e);break;case"wstr":if(typeof Pt<"u")r=Pt.utils.decode(Oa,this.slice(this.l,this.l+2*e));else return xd.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":r=$2(this,this.l),e=4+Zr(this,this.l);break;case"lpstr-cp":r=U2(this,this.l),e=4+Zr(this,this.l);break;case"lpwstr":r=z2(this,this.l),e=4+2*Zr(this,this.l);break;case"lpp4":e=4+Zr(this,this.l),r=H2(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Zr(this,this.l),r=W2(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=ec(this,this.l+e++))!==0;)i.push(td(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=ds(this,this.l+e))!==0;)i.push(td(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return s=ec(this,u),this.l=u+1,o=xd.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(td(ds(this,u))),u+=2}r=i.join(""),e*=2;break;case"cpstr":if(typeof Pt<"u"){r=Pt.utils.decode(Oa,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return s=ec(this,u),this.l=u+1,o=xd.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(td(ec(this,u))),u+=1}r=i.join("");break;default:switch(e){case 1:return n=ec(this,this.l),this.l++,n;case 2:return n=(t==="i"?wte:ds)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Ho:Nte)(this,this.l),this.l+=4,n):(a=Zr(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=Bh(this,this.l):a=Bh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=GD(this,this.l,e);break}}return this.l+=e,r}var Ste=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},kte=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},_te=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Ete(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)_te(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){if(typeof Pt<"u"&&El==874)for(a=0;a!=t.length;++a){var i=Pt.utils.encode(El,t.charAt(a));this[this.l+a]=i[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,Ste(this,t,this.l);break;case 8:if(n=8,r==="f"){bte(this,t,this.l);break}case 16:break;case-4:n=4,kte(this,t,this.l);break}return this.l+=n,this}function ZD(e,t){var r=GD(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function dn(e,t){e.l=t,e.read_shift=xd,e.chk=ZD,e.write_shift=Ete}function In(e,t){e.l+=t}function ge(e){var t=bo(e);return dn(t,0),t}function Is(e,t,r){if(e){var n,a,i;dn(e,e.l||0);for(var s=e.length,o=0,c=0;e.l<s;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=mf[o]||mf[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;c=e.l+i;var d=u.f&&u.f(e,i,r);if(e.l=c,t(d,u,o))return}}}function ca(){var e=[],t=wt?256:2048,r=function(u){var d=ge(u);return dn(d,0),d},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,t)))},s=function(){return a(),en(e)},o=function(u){a(),n=u,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:o,end:s,_bufs:e}}function ye(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=mf[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=e.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,(a&127)+128),s.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&G2(r)&&e.push(r)}}function vd(e,t,r){var n=Vt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function SE(e,t,r){var n=Vt(e);return n.s=vd(n.s,t.s,r),n.e=vd(n.e,t.s,r),n}function yd(e,t){if(e.cRel&&e.c<0)for(e=Vt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Vt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=it(e);return!e.cRel&&e.cRel!=null&&(r=Tte(r)),!e.rRel&&e.rRel!=null&&(r=Cte(r)),r}function Fx(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+tr(e.s.c)+":"+(e.e.cRel?"":"$")+tr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+wr(e.s.r)+":"+(e.e.rRel?"":"$")+wr(e.e.r):yd(e.s,t.biff)+":"+yd(e.e,t.biff)}function V2(e){return parseInt(Ate(e),10)-1}function wr(e){return""+(e+1)}function Cte(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Ate(e){return e.replace(/\$(\d+)$/,"$1")}function K2(e){for(var t=Pte(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function tr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Tte(e){return e.replace(/^([A-Z])/,"$$$1")}function Pte(e){return e.replace(/^\$([A-Z])/,"$1")}function Ote(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function mr(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function it(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Xn(e){var t=e.indexOf(":");return t==-1?{s:mr(e),e:mr(e)}:{s:mr(e.slice(0,t)),e:mr(e.slice(t+1))}}function xt(e,t){return typeof t>"u"||typeof t=="number"?xt(e.s,e.e):(typeof e!="string"&&(e=it(e)),typeof t!="string"&&(t=it(t)),e==t?e:e+":"+t)}function At(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function kE(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Fa(e.z,r?Hr(t):t)}catch{}try{return e.w=Fa((e.XF||{}).numFmtId||(r?14:0),r?Hr(t):t)}catch{return""+t}}function Yi(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Fs[e.v]||e.v:t==null?kE(e,e.v):kE(e,t))}function Ro(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function eR(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),s=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?mr(n.origin):n.origin;s=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=At(i["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),s==-1&&(u.e.r=s=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var p={v:t[f][h]},x=s+f,g=o+h;if(u.s.r>x&&(u.s.r=x),u.s.c>g&&(u.s.c=g),u.e.r<x&&(u.e.r=x),u.e.c<g&&(u.e.c=g),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))p=t[f][h];else if(Array.isArray(p.v)&&(p.f=t[f][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||nt[14],n.cellDates?(p.t="d",p.w=Fa(p.z,Hr(p.v))):(p.t="n",p.v=Hr(p.v),p.w=Fa(p.z,p.v))):p.t="s";if(a)i[x]||(i[x]=[]),i[x][g]&&i[x][g].z&&(p.z=i[x][g].z),i[x][g]=p;else{var y=it({c:g,r:x});i[y]&&i[y].z&&(p.z=i[y].z),i[y]=p}}}return u.s.c<1e7&&(i["!ref"]=xt(u)),i}function wu(e,t){return eR(null,e,t)}function Dte(e){return e.read_shift(4,"i")}function Ai(e,t){return t||(t=ge(4)),t.write_shift(4,e),t}function Dn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function rn(e,t){var r=!1;return t==null&&(r=!0,t=ge(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Rte(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Mte(e,t){return t||(t=ge(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0),t}function X2(e,t){var r=e.l,n=e.read_shift(1),a=Dn(e),i=[],s={t:a,h:a};if(n&1){for(var o=e.read_shift(4),c=0;c!=o;++c)i.push(Rte(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function Ite(e,t){var r=!1;return t==null&&(r=!0,t=ge(15+4*e.t.length)),t.write_shift(1,0),rn(e.t,t),r?t.slice(0,t.l):t}var Fte=X2;function Lte(e,t){var r=!1;return t==null&&(r=!0,t=ge(23+4*e.t.length)),t.write_shift(1,1),rn(e.t,t),t.write_shift(4,1),Mte({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function hi(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function $l(e,t){return t==null&&(t=ge(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Ul(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function zl(e,t){return t==null&&(t=ge(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Bte=Dn,tR=rn;function q2(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function jh(e,t){var r=!1;return t==null&&(r=!0,t=ge(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var jte=Dn,qy=q2,Y2=jh;function J2(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?Bh([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ho(t,0)>>2;return r?a/100:a}function rR(e,t){t==null&&(t=ge(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?n=1:a==(a|0)&&a>=-(1<<29)&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function nR(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function $te(e,t){return t||(t=ge(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Hl=nR,Nu=$te;function Tn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Tl(e,t){return(t||ge(8)).write_shift(8,e,"f")}function Ute(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var u=sl[a];u&&(t.rgb=cf(u));break;case 2:t.rgb=cf([s,o,c]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function $h(e,t){if(t||(t=ge(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function zte(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Hte(e,t){t||(t=ge(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function aR(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function Wte(e){return aR(e,1)}function Gte(e){return aR(e,2)}var Q2=2,Zn=3,B0=11,_E=12,Uh=19,j0=64,Vte=65,Kte=71,Xte=4108,qte=4126,Yr=80,iR=81,Yte=[Yr,iR],Yy={1:{n:"CodePage",t:Q2},2:{n:"Category",t:Yr},3:{n:"PresentationFormat",t:Yr},4:{n:"ByteCount",t:Zn},5:{n:"LineCount",t:Zn},6:{n:"ParagraphCount",t:Zn},7:{n:"SlideCount",t:Zn},8:{n:"NoteCount",t:Zn},9:{n:"HiddenCount",t:Zn},10:{n:"MultimediaClipCount",t:Zn},11:{n:"ScaleCrop",t:B0},12:{n:"HeadingPairs",t:Xte},13:{n:"TitlesOfParts",t:qte},14:{n:"Manager",t:Yr},15:{n:"Company",t:Yr},16:{n:"LinksUpToDate",t:B0},17:{n:"CharacterCount",t:Zn},19:{n:"SharedDoc",t:B0},22:{n:"HyperlinksChanged",t:B0},23:{n:"AppVersion",t:Zn,p:"version"},24:{n:"DigSig",t:Vte},26:{n:"ContentType",t:Yr},27:{n:"ContentStatus",t:Yr},28:{n:"Language",t:Yr},29:{n:"Version",t:Yr},255:{},2147483648:{n:"Locale",t:Uh},2147483651:{n:"Behavior",t:Uh},1919054434:{}},Jy={1:{n:"CodePage",t:Q2},2:{n:"Title",t:Yr},3:{n:"Subject",t:Yr},4:{n:"Author",t:Yr},5:{n:"Keywords",t:Yr},6:{n:"Comments",t:Yr},7:{n:"Template",t:Yr},8:{n:"LastAuthor",t:Yr},9:{n:"RevNumber",t:Yr},10:{n:"EditTime",t:j0},11:{n:"LastPrinted",t:j0},12:{n:"CreatedDate",t:j0},13:{n:"ModifiedDate",t:j0},14:{n:"PageCount",t:Zn},15:{n:"WordCount",t:Zn},16:{n:"CharCount",t:Zn},17:{n:"Thumbnail",t:Kte},18:{n:"Application",t:Yr},19:{n:"DocSecurity",t:Zn},255:{},2147483648:{n:"Locale",t:Uh},2147483651:{n:"Behavior",t:Uh},1919054434:{}},EE={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Jte=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Qte(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Zte=Qte([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),sl=Vt(Zte),Fs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},sR={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Qy={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},$0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Z2(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function ere(e){var t=Z2();if(!e||!e.match)return t;var r={};if((e.match(Fn)||[]).forEach(function(n){var a=st(n);switch(a[0].replace(ute,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[Qy[a.ContentType]]!==void 0&&t[Qy[a.ContentType]].push(a.PartName);break}}),t.xmlns!==Ur.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function oR(e,t){var r=tte(Qy),n=[],a;n[n.length]=Tr,n[n.length]=Pe("Types",null,{xmlns:Ur.CT,"xmlns:xsd":Ur.xsd,"xmlns:xsi":Ur.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Pe("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(a=e[c][0],n[n.length]=Pe("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:$0[c][t.bookType]||$0[c].xlsx}))},s=function(c){(e[c]||[]).forEach(function(u){n[n.length]=Pe("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:$0[c][t.bookType]||$0[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=Pe("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return i("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var St={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function lf(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function bd(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Fn)||[]).forEach(function(a){var i=st(a);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:nd(i.Target,t);r[o]=s,n[i.Id]=s}}),r["!id"]=n,r}function Ac(e){var t=[Tr,Pe("Relationships",null,{xmlns:Ur.RELS})];return Sr(e["!id"]).forEach(function(r){t[t.length]=Pe("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function jt(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,i?a.TargetMode=i:[St.HLINK,St.XPATH,St.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var tre="application/vnd.oasis.opendocument.spreadsheet";function rre(e,t){for(var r=j2(e),n,a;n=of.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=st(n[0],!1),a.path=="/"&&a.type!==tre)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function nre(e){var t=[Tr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function CE(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function are(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function ire(e){var t=[Tr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(CE(e[r][0],e[r][1])),t.push(are("",e[r][0]));return t.push(CE("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function lR(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+tf.version+"</meta:generator></office:meta></office:document-meta>"}var si=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],sre=function(){for(var e=new Array(si.length),t=0;t<si.length;++t){var r=si[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function cR(e){var t={};e=Wt(e);for(var r=0;r<si.length;++r){var n=si[r],a=e.match(sre[r]);a!=null&&a.length>0&&(t[n[1]]=Rt(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=rr(t[n[1]]))}return t}function Lx(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=Ut(t),n[n.length]=r?Pe(e,t,r):fn(e,t))}function uR(e,t){var r=t||{},n=[Tr,Pe("cp:coreProperties",null,{"xmlns:cp":Ur.CORE_PROPS,"xmlns:dc":Ur.dc,"xmlns:dcterms":Ur.dcterms,"xmlns:dcmitype":Ur.dcmitype,"xmlns:xsi":Ur.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Lx("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Xy(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Lx("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Xy(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=si.length;++i){var s=si[i],o=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Lx(s[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var ol=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],dR=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function fR(e,t,r,n){var a=[];if(typeof e=="string")a=xE(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(d){return{v:d}}));var s=typeof t=="string"?xE(t,n).map(function(d){return d.v}):t,o=0,c=0;if(s.length>0)for(var u=0;u!==a.length;u+=2){switch(c=+a[u+1].v,a[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=s.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=s.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=s.slice(o,o+c);break}o+=c}}function ore(e,t,r){var n={};return t||(t={}),e=Wt(e),ol.forEach(function(a){var i=(e.match(af(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=Rt(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var s=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));s&&s.length>0&&(n[a[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&fR(n.HeadingPairs,n.TitlesOfParts,t,r),t}function mR(e){var t=[],r=Pe;return e||(e={}),e.Application="SheetJS",t[t.length]=Tr,t[t.length]=Pe("Properties",null,{xmlns:Ur.EXT_PROPS,"xmlns:vt":Ur.vt}),ol.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Ut(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Ut(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var lre=/<[^>]+>[^<]*/g;function cre(e,t){var r={},n="",a=e.match(lre);if(a)for(var i=0;i!=a.length;++i){var s=a[i],o=st(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Rt(o.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var c=s.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=Rt(d);break;case"bool":r[n]=Zt(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=rr(d);break;case"cy":case"error":r[n]=Rt(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,u,c)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return r}function hR(e){var t=[Tr,Pe("Properties",null,{xmlns:Ur.CUST_PROPS,"xmlns:vt":Ur.vt})];if(!e)return t.join("");var r=1;return Sr(e).forEach(function(a){++r,t[t.length]=Pe("property",vte(e[a],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ut(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Zy={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Bx;function ure(e,t,r){Bx||(Bx=yg(Zy)),t=Bx[t]||t,e[t]=r}function dre(e,t){var r=[];return Sr(Zy).map(function(n){for(var a=0;a<si.length;++a)if(si[a][1]==n)return si[a];for(a=0;a<ol.length;++a)if(ol[a][1]==n)return ol[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(fn(Zy[n[1]]||n[1],a))}}),Pe("DocumentProperties",r.join(""),{xmlns:va.o})}function fre(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Sr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<si.length;++s)if(i==si[s][1])return;for(s=0;s<ol.length;++s)if(i==ol[s][1])return;for(s=0;s<r.length;++s)if(i==r[s])return;var o=e[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),a.push(Pe(mE(i),o,{"dt:dt":c}))}}),t&&Sr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=t[i],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),a.push(Pe(mE(i),s,{"dt:dt":o}))}}),"<"+n+' xmlns="'+va.o+'">'+a.join("")+"</"+n+">"}function eN(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function mre(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var s=ge(8);return s.write_shift(4,n),s.write_shift(4,a),s}function pR(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function gR(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function xR(e,t,r){return t===31?gR(e):pR(e,t,r)}function e1(e,t,r){return xR(e,t,r===!1?0:4)}function hre(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return xR(e,t,0)}function pre(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(On,""),e.l-a&2&&(e.l+=2)}return r}function gre(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(On,"");return r}function xre(e){var t=e.l,r=zh(e,iR);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=zh(e,Zn);return[r,n]}function vre(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(xre(e));return r}function AE(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),s=e.read_shift(4);n[i]=e.read_shift(s,t===1200?"utf16le":"utf8").replace(On,"").replace(rd,"!"),t===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),n}function vR(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function yre(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function zh(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==_E&&n!==t&&Yte.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===_E?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return pR(e,n,4).replace(On,"");case 31:return gR(e);case 64:return eN(e);case 65:return vR(e);case 71:return yre(e);case 80:return e1(e,n,!i.raw).replace(On,"");case 81:return hre(e,n).replace(On,"");case 4108:return vre(e);case 4126:case 4127:return n==4127?pre(e):gre(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function TE(e,t){var r=ge(4),n=ge(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=ge(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=mre(t);break;case 31:case 80:for(n=ge(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return en([r,n])}function PE(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0,o=0,c=-1,u={};for(s=0;s!=a;++s){var d=e.read_shift(4),f=e.read_shift(4);i[s]=[d,f+r]}i.sort(function(w,b){return w[1]-b[1]});var h={};for(s=0;s!=a;++s){if(e.l!==i[s][1]){var p=!0;if(s>0&&t)switch(t[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,p=!1);break;case 80:e.l<=i[s][1]&&(e.l=i[s][1],p=!1);break;case 4108:e.l<=i[s][1]&&(e.l=i[s][1],p=!1);break}if((!t||s==0)&&e.l<=i[s][1]&&(p=!1,e.l=i[s][1]),p)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(t){var x=t[i[s][0]];if(h[x.n]=zh(e,x.t,{raw:!0}),x.p==="version"&&(h[x.n]=String(h[x.n]>>16)+"."+("0000"+String(h[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(h[x.n]){case 0:h[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ai(o=h[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[x.n])}}else if(i[s][0]===1){if(o=h.CodePage=zh(e,Q2),ai(o),c!==-1){var g=e.l;e.l=i[c][1],u=AE(e,o),e.l=g}}else if(i[s][0]===0){if(o===0){c=s,e.l=i[s+1][1];continue}u=AE(e,o)}else{var y=u[i[s][0]],v;switch(e[e.l]){case 65:e.l+=4,v=vR(e);break;case 30:e.l+=4,v=e1(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=e1(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=Er(e,4);break;case 64:e.l+=4,v=rr(eN(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[y]=v}}return e.l=r+n,h}var yR=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function bre(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function OE(e,t,r){var n=ge(8),a=[],i=[],s=8,o=0,c=ge(8),u=ge(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),i.push(c),a.push(u),s+=8+c.length,!t){u=ge(8),u.write_shift(4,0),a.unshift(u);var d=[ge(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(c=ge(4+4+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=en(d),i.unshift(c),s+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(yR.indexOf(e[o][0])>-1||dR.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],p=0;if(t){p=+t[e[o][0]];var x=r[p];if(x.p=="version"&&typeof h=="string"){var g=h.split(".");h=(+g[0]<<16)+(+g[1]||0)}c=TE(x.t,h)}else{var y=bre(h);y==-1&&(y=31,h=String(h)),c=TE(y,h)}i.push(c),u=ge(8),u.write_shift(4,t?p:2+o),a.push(u),s+=8+c.length}var v=8*(i.length+1);for(o=0;o<i.length;++o)a[o].write_shift(4,v),v+=i[o].length;return n.write_shift(4,s),n.write_shift(4,i.length),en([n].concat(a).concat(i))}function DE(e,t,r){var n=e.content;if(!n)return{};dn(n,0);var a,i,s,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==rt.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(s=n.read_shift(16),c=n.read_shift(4));var f=PE(n,t),h={SystemIdentifier:u};for(var p in f)h[p]=f[p];if(h.FMTID=i,a===1)return h;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var x;try{x=PE(n,null)}catch{}for(p in x)h[p]=x[p];return h.FMTID=[i,s],h}function RE(e,t,r,n,a,i){var s=ge(a?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,rt.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var c=OE(e,r,n);if(o.push(c),a){var u=OE(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+c.length),o.push(u)}return en(o)}function Bs(e,t){return e.read_shift(t),null}function wre(e,t){t||(t=ge(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function Nre(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Er(e,t){return e.read_shift(t)===1}function $n(e,t){return t||(t=ge(2)),t.write_shift(2,+!!e),t}function Rr(e){return e.read_shift(2,"u")}function Ya(e,t){return t||(t=ge(2)),t.write_shift(2,e),t}function bR(e,t){return Nre(e,t,Rr)}function Sre(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function wR(e,t,r){return r||(r=ge(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Xf(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont",i=Oa;if(r&&r.biff>=8&&(Oa=1200),!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?e.read_shift(n,a):"";return Oa=i,o}function kre(e){var t=Oa;Oa=1200;var r=e.read_shift(2),n=e.read_shift(1),a=n&4,i=n&8,s=1+(n&1),o=0,c,u={};i&&(o=e.read_shift(2)),a&&(c=e.read_shift(4));var d=s==2?"dbcs-cont":"sbcs-cont",f=r===0?"":e.read_shift(r,d);return i&&(e.l+=4*o),a&&(e.l+=c),u.t=f,i||(u.raw="<t>"+u.t+"</t>",u.r=u.t),Oa=t,u}function _re(e){var t=e.t||"",r=ge(3+0);r.write_shift(2,t.length),r.write_shift(1,1);var n=ge(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return en(a)}function Pl(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function qf(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Pl(e,n,r)}function Wl(e,t,r){if(r.biff>5)return qf(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function NR(e,t,r){return r||(r=ge(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Ere(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function Cre(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(On,"");return n&&(e.l+=24),a}function Are(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(i>>1,"utf16le").replace(On,"");return r+s}function Tre(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return Cre(e);case"0303000000000000c000000000000046":return Are(e);default:throw new Error("Unsupported Moniker "+r)}}function U0(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(On,""):"";return r}function ME(e,t){t||(t=ge(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function Pre(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,s,o,c,u="",d,f;a&16&&(i=U0(e,r-e.l)),a&128&&(s=U0(e,r-e.l)),(a&257)===257&&(o=U0(e,r-e.l)),(a&257)===1&&(c=Tre(e,r-e.l)),a&8&&(u=U0(e,r-e.l)),a&32&&(d=e.read_shift(16)),a&64&&(f=eN(e)),e.l=r;var h=s||o||c||"";h&&u&&(h+="#"+u),h||(h="#"+u),a&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var p={Target:h};return d&&(p.guid=d),f&&(p.time=f),i&&(p.Tooltip=i),p}function Ore(e){var t=ge(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(i==28)n=n.slice(1),ME(n,t);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),i&8&&ME(a>-1?n.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function SR(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function kR(e,t){var r=SR(e);return r[3]=0,r}function Qi(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Ol(e,t,r,n){return n||(n=ge(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function Dre(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function Rre(e,t,r){return t===0?"":Wl(e,t,r)}function Mre(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function _R(e){var t=e.read_shift(2),r=J2(e);return[t,r]}function Ire(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=Xf(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function Sg(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function ER(e,t){return t||(t=ge(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function CR(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var Fre=CR;function AR(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function Lre(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function Bre(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function bn(e){e.l+=2,e.l+=e.read_shift(2)}var jre={0:bn,4:bn,5:bn,6:bn,7:Bre,8:bn,9:bn,10:bn,11:bn,12:bn,13:Lre,14:bn,15:bn,16:bn,17:bn,18:bn,19:bn,20:bn,21:AR};function $re(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(jre[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function z0(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function tN(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=ge(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function Ure(e,t){return t===0||e.read_shift(2),1200}function zre(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Wl(e,0,r);return e.read_shift(t+n-e.l),a}function Hre(e,t){var r=!t||t.biff==8,n=ge(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function Wre(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function Gre(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var s=Xf(e,0,r);return s.length===0&&(s="Sheet1"),{pos:n,hs:a,dt:i,name:s}}function Vre(e,t){var r=!t||t.biff>=8?2:1,n=ge(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function Kre(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0;s!=a&&e.l<r;++s)i.push(kre(e));return i.Count=n,i.Unique=a,i}function Xre(e,t){var r=ge(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=_re(e[a]);var i=en([r].concat(n));return i.parts=[r.length].concat(n.map(function(s){return s.length})),i}function qre(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function Yre(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function Jre(e){var t=Dre(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function Qre(e){return e.read_shift(2),e.read_shift(4)}function IE(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function Zre(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:s,FirstTab:o,Selected:c,TabRatio:u}}function ene(){var e=ge(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function tne(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function rne(e){var t=ge(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function nne(){}function ane(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Xf(e,0,r),n}function ine(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=ge(a);return i.write_shift(2,(e.sz||12)*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function sne(e){var t=Qi(e);return t.isst=e.read_shift(4),t}function one(e,t,r,n){var a=ge(10);return Ol(e,t,n,a),a.write_shift(4,r),a}function lne(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Qi(e);r.biff==2&&e.l++;var i=qf(e,n-e.l,r);return a.val=i,a}function cne(e,t,r,n,a){var i=!a||a.biff==8,s=ge(6+2+ +i+(1+i)*r.length);return Ol(e,t,n,s),s.write_shift(2,r.length),i&&s.write_shift(1,1),s.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),s}function une(e,t,r){var n=e.read_shift(2),a=Wl(e,0,r);return[n,a]}function dne(e,t,r,n){var a=r&&r.biff==5;n||(n=ge(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var fne=Wl;function FE(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:i,c:o},e:{r:s,c}}}function mne(e,t){var r=t.biff==8||!t.biff?4:2,n=ge(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function hne(e){var t=e.read_shift(2),r=e.read_shift(2),n=_R(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function pne(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(_R(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:i}}function gne(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:i}}function xne(e,t,r,n){var a={},i=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return a.patternType=Jte[o>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=s&15,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function vne(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=xne(e,t,n.fStyle,r),n}function LE(e,t,r,n){var a=r&&r.biff==5;n||(n=ge(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function yne(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function bne(e){var t=ge(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}function BE(e,t,r){var n=Qi(e);(r.biff==2||t==9)&&++e.l;var a=Sre(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function wne(e,t,r,n,a,i){var s=ge(8);return Ol(e,t,n,s),wR(r,i,s),s}function Nne(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Qi(e),a=Tn(e);return n.val=a,n}function Sne(e,t,r,n){var a=ge(14);return Ol(e,t,n,a),Tl(r,a),a}var jE=Rre;function kne(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=Pl(e,i),o=[];n>e.l;)o.push(qf(e));return[i,a,s,o]}function $E(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=Ire(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var _ne=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function UE(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=Pl(e,s,r);a&32&&(u=_ne[u.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var f=n==e.l||o===0||!(d>0)?[]:$oe(e,d,r,o);return{chKey:i,Name:u,itab:c,rgce:f}}function TR(e,t,r){if(r.biff<8)return Ene(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(Mre(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function Ene(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Xf(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Cne(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=Pl(e,n,r),s=Pl(e,a,r);return[i,s]}function Ane(e,t,r){var n=CR(e);e.l++;var a=e.read_shift(1);return t-=8,[Uoe(e,t,r),a,n]}function zE(e,t,r){var n=Fre(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Boe(e,t,r)]}function Tne(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function Pne(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=Wl(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,s,i]}}function One(e,t,r){return Pne(e,t,r)}function Dne(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Sg(e));return r}function Rne(e){var t=ge(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)ER(e[r],t);return t}function Mne(e,t,r){if(r&&r.biff<8)return Fne(e,t,r);var n=AR(e),a=$re(e,t-22,n[1]);return{cmo:n,ft:a}}var Ine={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function Fne(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((Ine[n]||In)(e,t,r)),{cmo:[a,n,i],ft:s}}function Lne(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:s=Ere(e,6,r);var o=e.read_shift(2);e.read_shift(2),Rr(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=Pl(e,e.lens[u+1]-e.lens[u]-1);if(a+=f,a.length>=(d?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function Bne(e,t){var r=Sg(e);e.l+=16;var n=Pre(e,t-24);return[r,n]}function jne(e){var t=ge(24),r=mr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return en([t,Ore(e[1])])}function $ne(e,t){e.read_shift(2);var r=Sg(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(On,""),[r,n]}function Une(e){var t=e[1].Tooltip,r=ge(10+2*(t.length+1));r.write_shift(2,2048);var n=mr(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function zne(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=EE[r]||r,r=e.read_shift(2),t[1]=EE[r]||r,t}function Hne(e){return e||(e=ge(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Wne(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(kR(e));return r}function Gne(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(kR(e));return r}function Vne(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function PR(e,t,r){if(!r.cellStyles)return In(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:i,w:s,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function Kne(e,t){var r=ge(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Xne(e,t){var r={};return t<32||(e.l+=16,r.header=Tn(e),r.footer=Tn(e),e.l+=2),r}function qne(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function Yne(e){for(var t=ge(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var Jne=Qi,Qne=bR,Zne=qf;function eae(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function tae(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Qi(e);++e.l;var a=Wl(e,t-7,r);return n.t="str",n.val=a,n}function rae(e){var t=Qi(e);++e.l;var r=Tn(e);return t.t="n",t.val=r,t}function nae(e,t,r){var n=ge(15);return Zf(n,e,t),n.write_shift(8,r,"f"),n}function aae(e){var t=Qi(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function iae(e,t,r){var n=ge(9);return Zf(n,e,t),n.write_shift(2,r),n}function sae(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function oae(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function lae(e,t,r){var n=e.l+t,a=Qi(e),i=e.read_shift(2),s=Pl(e,i,r);return e.l=n,a.t="str",a.val=s,a}var cae=[2,3,48,49,131,139,140,245],t1=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=yg({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],d=bo(1);switch(c.type){case"base64":d=Sa(Ia(o));break;case"binary":d=Sa(o);break;case"buffer":case"array":d=o;break}dn(d,0);var f=d.read_shift(1),h=!!(f&136),p=!1,x=!1;switch(f){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var g=0,y=521;f==2&&(g=d.read_shift(2)),d.l+=3,f!=2&&(g=d.read_shift(4)),g>1048576&&(g=1e6),f!=2&&(y=d.read_shift(2));var v=d.read_shift(2),w=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(w=e[d[d.l]]),d.l+=1,d.l+=2),x&&(d.l+=36);for(var b=[],S={},k=Math.min(d.length,f==2?521:y-10-(p?264:0)),_=x?32:11;d.l<k&&d[d.l]!=13;)switch(S={},S.name=Pt.utils.decode(w,d.slice(d.l,d.l+_)).replace(/[\u0000\r\n].*$/g,""),d.l+=_,S.type=String.fromCharCode(d.read_shift(1)),f!=2&&!x&&(S.offset=d.read_shift(4)),S.len=d.read_shift(1),f==2&&(S.offset=d.read_shift(2)),S.dec=d.read_shift(1),S.name.length&&b.push(S),f!=2&&(d.l+=x?13:14),S.type){case"B":(!p||S.len!=8)&&c.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(d[d.l]!==13&&(d.l=y-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=y;var E=0,P=0;for(u[0]=[],P=0;P!=b.length;++P)u[0][P]=b[P].name;for(;g-- >0;){if(d[d.l]===42){d.l+=v;continue}for(++d.l,u[++E]=[],P=0,P=0;P!=b.length;++P){var A=d.slice(d.l,d.l+b[P].len);d.l+=b[P].len,dn(A,0);var T=Pt.utils.decode(w,A);switch(b[P].type){case"C":T.trim().length&&(u[E][P]=T.replace(/\s+$/,""));break;case"D":T.length===8?u[E][P]=new Date(+T.slice(0,4),+T.slice(4,6)-1,+T.slice(6,8)):u[E][P]=T;break;case"F":u[E][P]=parseFloat(T.trim());break;case"+":case"I":u[E][P]=x?A.read_shift(-4,"i")^2147483648:A.read_shift(4,"i");break;case"L":switch(T.trim().toUpperCase()){case"Y":case"T":u[E][P]=!0;break;case"N":case"F":u[E][P]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+T+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[E][P]="##MEMO##"+(x?parseInt(T.trim(),10):A.read_shift(4));break;case"N":T=T.replace(/\u0000/g,"").trim(),T&&T!="."&&(u[E][P]=+T||0);break;case"@":u[E][P]=new Date(A.read_shift(-8,"f")-621356832e5);break;case"T":u[E][P]=new Date((A.read_shift(4)-2440588)*864e5+A.read_shift(4));break;case"Y":u[E][P]=A.read_shift(4,"i")/1e4+A.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[E][P]=-A.read_shift(-8,"f");break;case"B":if(p&&b[P].len==8){u[E][P]=A.read_shift(8,"f");break}case"G":case"P":A.l+=b[P].len;break;case"0":if(b[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[P].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=b,u}function n(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=wu(r(o,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function a(o,c){try{return Ro(n(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,c){var u=c||{};if(+u.codepage>=0&&ai(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=ca(),f=Vh(o,{header:1,raw:!0,cellDates:!0}),h=f[0],p=f.slice(1),x=o["!cols"]||[],g=0,y=0,v=0,w=1;for(g=0;g<h.length;++g){if(((x[g]||{}).DBF||{}).name){h[g]=x[g].DBF.name,++v;continue}if(h[g]!=null){if(++v,typeof h[g]=="number"&&(h[g]=h[g].toString(10)),typeof h[g]!="string")throw new Error("DBF Invalid column name "+h[g]+" |"+typeof h[g]+"|");if(h.indexOf(h[g])!==g){for(y=0;y<1024;++y)if(h.indexOf(h[g]+"_"+y)==-1){h[g]+="_"+y;break}}}}var b=At(o["!ref"]),S=[],k=[],_=[];for(g=0;g<=b.e.c-b.s.c;++g){var E="",P="",A=0,T=[];for(y=0;y<p.length;++y)p[y][g]!=null&&T.push(p[y][g]);if(T.length==0||h[g]==null){S[g]="?";continue}for(y=0;y<T.length;++y){switch(typeof T[y]){case"number":P="B";break;case"string":P="C";break;case"boolean":P="L";break;case"object":P=T[y]instanceof Date?"D":"C";break;default:P="C"}A=Math.max(A,String(T[y]).length),E=E&&E!=P?"C":P}A>250&&(A=250),P=((x[g]||{}).DBF||{}).type,P=="C"&&x[g].DBF.len>A&&(A=x[g].DBF.len),E=="B"&&P=="N"&&(E="N",_[g]=x[g].DBF.dec,A=x[g].DBF.len),k[g]=E=="C"||P=="N"?A:i[E]||0,w+=k[g],S[g]=E}var R=d.next(32);for(R.write_shift(4,318902576),R.write_shift(4,p.length),R.write_shift(2,296+32*v),R.write_shift(2,w),g=0;g<4;++g)R.write_shift(4,0);for(R.write_shift(4,0|(+t[El]||3)<<8),g=0,y=0;g<h.length;++g)if(h[g]!=null){var D=d.next(32),L=(h[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,L,"sbcs"),D.write_shift(1,S[g]=="?"?"C":S[g],"sbcs"),D.write_shift(4,y),D.write_shift(1,k[g]||i[S[g]]||0),D.write_shift(1,_[g]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),y+=k[g]||i[S[g]]||0}var z=d.next(264);for(z.write_shift(4,13),g=0;g<65;++g)z.write_shift(4,0);for(g=0;g<p.length;++g){var X=d.next(w);for(X.write_shift(1,0),y=0;y<h.length;++y)if(h[y]!=null)switch(S[y]){case"L":X.write_shift(1,p[g][y]==null?63:p[g][y]?84:70);break;case"B":X.write_shift(8,p[g][y]||0,"f");break;case"N":var Y="0";for(typeof p[g][y]=="number"&&(Y=p[g][y].toFixed(_[y]||0)),v=0;v<k[y]-Y.length;++v)X.write_shift(1,32);X.write_shift(1,Y,"sbcs");break;case"D":p[g][y]?(X.write_shift(4,("0000"+p[g][y].getFullYear()).slice(-4),"sbcs"),X.write_shift(2,("00"+(p[g][y].getMonth()+1)).slice(-2),"sbcs"),X.write_shift(2,("00"+p[g][y].getDate()).slice(-2),"sbcs")):X.write_shift(8,"00000000","sbcs");break;case"C":var q=String(p[g][y]!=null?p[g][y]:"").slice(0,k[y]);for(X.write_shift(1,q,"sbcs"),v=0;v<k[y]-q.length;++v)X.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}}(),OR=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Sr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,p){var x=e[p];return typeof x=="number"?Ky(x):x},n=function(h,p,x){var g=p.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return g==59?h:Ky(g)};e["|"]=254;function a(h,p){switch(p.type){case"base64":return i(Ia(h),p);case"binary":return i(h,p);case"buffer":return i(wt&&Buffer.isBuffer(h)?h.toString("binary"):Do(h),p);case"array":return i(Al(h),p)}throw new Error("Unrecognized type "+p.type)}function i(h,p){var x=h.split(/[\n\r]+/),g=-1,y=-1,v=0,w=0,b=[],S=[],k=null,_={},E=[],P=[],A=[],T=0,R;for(+p.codepage>=0&&ai(+p.codepage);v!==x.length;++v){T=0;var D=x[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),L=D.replace(/;;/g,"\0").split(";").map(function(G){return G.replace(/\u0000/g,";")}),z=L[0],X;if(D.length>0)switch(z){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":L[1].charAt(0)=="P"&&S.push(D.slice(3).replace(/;;/g,";"));break;case"C":var Y=!1,q=!1,ee=!1,V=!1,ae=-1,oe=-1;for(w=1;w<L.length;++w)switch(L[w].charAt(0)){case"A":break;case"X":y=parseInt(L[w].slice(1))-1,q=!0;break;case"Y":for(g=parseInt(L[w].slice(1))-1,q||(y=0),R=b.length;R<=g;++R)b[R]=[];break;case"K":X=L[w].slice(1),X.charAt(0)==='"'?X=X.slice(1,X.length-1):X==="TRUE"?X=!0:X==="FALSE"?X=!1:isNaN(Ci(X))?isNaN(Jc(X).getDate())||(X=rr(X)):(X=Ci(X),k!==null&&Bl(k)&&(X=wg(X))),typeof Pt<"u"&&typeof X=="string"&&(p||{}).type!="string"&&(p||{}).codepage&&(X=Pt.utils.decode(p.codepage,X)),Y=!0;break;case"E":V=!0;var I=Tc(L[w].slice(1),{r:g,c:y});b[g][y]=[b[g][y],I];break;case"S":ee=!0,b[g][y]=[b[g][y],"S5S"];break;case"G":break;case"R":ae=parseInt(L[w].slice(1))-1;break;case"C":oe=parseInt(L[w].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+D)}if(Y&&(b[g][y]&&b[g][y].length==2?b[g][y][0]=X:b[g][y]=X,k=null),ee){if(V)throw new Error("SYLK shared formula cannot have own formula");var W=ae>-1&&b[ae][oe];if(!W||!W[1])throw new Error("SYLK shared formula cannot find base");b[g][y][1]=qR(W[1],{r:g-ae,c:y-oe})}break;case"F":var U=0;for(w=1;w<L.length;++w)switch(L[w].charAt(0)){case"X":y=parseInt(L[w].slice(1))-1,++U;break;case"Y":for(g=parseInt(L[w].slice(1))-1,R=b.length;R<=g;++R)b[R]=[];break;case"M":T=parseInt(L[w].slice(1))/20;break;case"F":break;case"G":break;case"P":k=S[parseInt(L[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(A=L[w].slice(1).split(" "),R=parseInt(A[0],10);R<=parseInt(A[1],10);++R)T=parseInt(A[2],10),P[R-1]=T===0?{hidden:!0}:{wch:T},wo(P[R-1]);break;case"C":y=parseInt(L[w].slice(1))-1,P[y]||(P[y]={});break;case"R":g=parseInt(L[w].slice(1))-1,E[g]||(E[g]={}),T>0?(E[g].hpt=T,E[g].hpx=Zc(T)):T===0&&(E[g].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+D)}U<1&&(k=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+D)}}return E.length>0&&(_["!rows"]=E),P.length>0&&(_["!cols"]=P),p&&p.sheetRows&&(b=b.slice(0,p.sheetRows)),[b,_]}function s(h,p){var x=a(h,p),g=x[0],y=x[1],v=wu(g,p);return Sr(y).forEach(function(w){v[w]=y[w]}),v}function o(h,p){return Ro(s(h,p),p)}function c(h,p,x,g){var y="C;Y"+(x+1)+";X"+(g+1)+";K";switch(h.t){case"n":y+=h.v||0,h.f&&!h.F&&(y+=";E"+oN(h.f,{r:x,c:g}));break;case"b":y+=h.v?"TRUE":"FALSE";break;case"e":y+=h.w||h.v;break;case"d":y+='"'+(h.w||h.v)+'"';break;case"s":y+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function u(h,p){p.forEach(function(x,g){var y="F;W"+(g+1)+" "+(g+1)+" ";x.hidden?y+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=uf(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=df(x.wpx)),typeof x.wch=="number"&&(y+=Math.round(x.wch))),y.charAt(y.length-1)!=" "&&h.push(y)})}function d(h,p){p.forEach(function(x,g){var y="F;";x.hidden?y+="M0;":x.hpt?y+="M"+20*x.hpt+";":x.hpx&&(y+="M"+20*ff(x.hpx)+";"),y.length>2&&h.push(y+"R"+(g+1))})}function f(h,p){var x=["ID;PWXL;N;E"],g=[],y=At(h["!ref"]),v,w=Array.isArray(h),b=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),h["!cols"]&&u(x,h["!cols"]),h["!rows"]&&d(x,h["!rows"]),x.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var S=y.s.r;S<=y.e.r;++S)for(var k=y.s.c;k<=y.e.c;++k){var _=it({r:S,c:k});v=w?(h[S]||[])[k]:h[_],!(!v||v.v==null&&(!v.f||v.F))&&g.push(c(v,h,S,k))}return x.join(b)+b+g.join(b)+b+"E"+b}return{to_workbook:o,to_sheet:s,from_sheet:f}}(),DR=function(){function e(i,s){switch(s.type){case"base64":return t(Ia(i),s);case"binary":return t(i,s);case"buffer":return t(wt&&Buffer.isBuffer(i)?i.toString("binary"):Do(i),s);case"array":return t(Al(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){for(var o=i.split(`
`),c=-1,u=-1,d=0,f=[];d!==o.length;++d){if(o[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var h=o[d].trim().split(","),p=h[0],x=h[1];++d;for(var g=o[d]||"";(g.match(/["]/g)||[]).length&1&&d<o.length-1;)g+=`
`+o[++d];switch(g=g.trim(),+p){case-1:if(g==="BOT"){f[++c]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?f[c][u]=!0:g==="FALSE"?f[c][u]=!1:isNaN(Ci(x))?isNaN(Jc(x).getDate())?f[c][u]=x:f[c][u]=rr(x):f[c][u]=Ci(x),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),f[c][u++]=g!==""?g:null;break}if(g==="EOD")break}}return s&&s.sheetRows&&(f=f.slice(0,s.sheetRows)),f}function r(i,s){return wu(e(i,s),s)}function n(i,s){return Ro(r(i,s),s)}var a=function(){var i=function(c,u,d,f,h){c.push(u),c.push(d+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},s=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=At(c["!ref"]),f,h=Array.isArray(c);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,d.e.r-d.s.r+1,""),i(u,"TUPLES",0,d.e.c-d.s.c+1,""),i(u,"DATA",0,0,"");for(var p=d.s.r;p<=d.e.r;++p){s(u,-1,0,"BOT");for(var x=d.s.c;x<=d.e.c;++x){var g=it({r:p,c:x});if(f=h?(c[p]||[])[x]:c[g],!f){s(u,1,0,"");continue}switch(f.t){case"n":var y=f.w;!y&&f.v!=null&&(y=f.v),y==null?f.f&&!f.F?s(u,1,0,"="+f.f):s(u,1,0,""):s(u,0,y,"V");break;case"b":s(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":s(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Fa(f.z||nt[14],Hr(rr(f.v)))),s(u,0,f.w,"V");break;default:s(u,1,0,"")}}}s(u,-1,0,"EOD");var v=`\r
`,w=u.join(v);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),RR=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var p=f.split(`
`),x=-1,g=-1,y=0,v=[];y!==p.length;++y){var w=p[y].trim().split(":");if(w[0]==="cell"){var b=mr(w[1]);if(v.length<=b.r)for(x=v.length;x<=b.r;++x)v[x]||(v[x]=[]);switch(x=b.r,g=b.c,w[2]){case"t":v[x][g]=e(w[3]);break;case"v":v[x][g]=+w[3];break;case"vtf":var S=w[w.length-1];case"vtc":switch(w[3]){case"nl":v[x][g]=!!+w[4];break;default:v[x][g]=+w[4];break}w[2]=="vtf"&&(v[x][g]=[v[x][g],S])}}}return h&&h.sheetRows&&(v=v.slice(0,h.sheetRows)),v}function n(f,h){return wu(r(f,h),h)}function a(f,h){return Ro(n(f,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var h=[],p=[],x,g="",y=Xn(f["!ref"]),v=Array.isArray(f),w=y.s.r;w<=y.e.r;++w)for(var b=y.s.c;b<=y.e.c;++b)if(g=it({r:w,c:b}),x=v?(f[w]||[])[b]:f[g],!(!x||x.v==null||x.t==="z")){switch(p=["cell",g,"t"],x.t){case"s":case"str":p.push(t(x.v));break;case"n":x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=t(x.f)):(p[2]="v",p[3]=x.v);break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var S=Hr(rr(x.v));p[2]="vtc",p[3]="nd",p[4]=""+S,p[5]=x.w||Fa(x.z||nt[14],S);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[i,s,o,s,u(f),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:d}}(),Qc=function(){function e(d,f,h,p,x){x.raw?f[h][p]=d:d===""||(d==="TRUE"?f[h][p]=!0:d==="FALSE"?f[h][p]=!1:isNaN(Ci(d))?isNaN(Jc(d).getDate())?f[h][p]=d:f[h][p]=rr(d):f[h][p]=Ci(d))}function t(d,f){var h=f||{},p=[];if(!d||d.length===0)return p;for(var x=d.split(/[\r\n]/),g=x.length-1;g>=0&&x[g].length===0;)--g;for(var y=10,v=0,w=0;w<=g;++w)v=x[w].indexOf(" "),v==-1?v=x[w].length:v++,y=Math.max(y,v);for(w=0;w<=g;++w){p[w]=[];var b=0;for(e(x[w].slice(0,y).trim(),p,w,b,h),b=1;b<=(x[w].length-y)/10+1;++b)e(x[w].slice(y+(b-1)*10,y+b*10).trim(),p,w,b,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(d){for(var f={},h=!1,p=0,x=0;p<d.length;++p)(x=d.charCodeAt(p))==34?h=!h:!h&&x in r&&(f[x]=(f[x]||0)+1);x=[];for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&x.push([f[p],p]);if(!x.length){f=n;for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&x.push([f[p],p])}return x.sort(function(g,y){return g[0]-y[0]||n[g[1]]-n[y[1]]}),r[x.pop()[1]]||44}function i(d,f){var h=f||{},p="",x=h.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(p=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(p=d.charAt(4),d=d.slice(6)):p=a(d.slice(0,1024)):h&&h.FS?p=h.FS:p=a(d.slice(0,1024));var y=0,v=0,w=0,b=0,S=0,k=p.charCodeAt(0),_=!1,E=0,P=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var A=h.dateNF!=null?qee(h.dateNF):null;function T(){var R=d.slice(b,S),D={};if(R.charAt(0)=='"'&&R.charAt(R.length-1)=='"'&&(R=R.slice(1,-1).replace(/""/g,'"')),R.length===0)D.t="z";else if(h.raw)D.t="s",D.v=R;else if(R.trim().length===0)D.t="s",D.v=R;else if(R.charCodeAt(0)==61)R.charCodeAt(1)==34&&R.charCodeAt(R.length-1)==34?(D.t="s",D.v=R.slice(2,-1).replace(/""/g,'"')):kse(R)?(D.t="n",D.f=R.slice(1)):(D.t="s",D.v=R);else if(R=="TRUE")D.t="b",D.v=!0;else if(R=="FALSE")D.t="b",D.v=!1;else if(!isNaN(w=Ci(R)))D.t="n",h.cellText!==!1&&(D.w=R),D.v=w;else if(!isNaN(Jc(R).getDate())||A&&R.match(A)){D.z=h.dateNF||nt[14];var L=0;A&&R.match(A)&&(R=Yee(R,h.dateNF,R.match(A)||[]),L=1),h.cellDates?(D.t="d",D.v=rr(R,L)):(D.t="n",D.v=Hr(rr(R,L))),h.cellText!==!1&&(D.w=Fa(D.z,D.v instanceof Date?Hr(D.v):D.v)),h.cellNF||delete D.z}else D.t="s",D.v=R;if(D.t=="z"||(h.dense?(x[y]||(x[y]=[]),x[y][v]=D):x[it({c:v,r:y})]=D),b=S+1,P=d.charCodeAt(b),g.e.c<v&&(g.e.c=v),g.e.r<y&&(g.e.r=y),E==k)++v;else if(v=0,++y,h.sheetRows&&h.sheetRows<=y)return!0}e:for(;S<d.length;++S)switch(E=d.charCodeAt(S)){case 34:P===34&&(_=!_);break;case k:case 10:case 13:if(!_&&T())break e;break}return S-b>0&&T(),x["!ref"]=xt(g),x}function s(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,f):wu(t(d,f),f)}function o(d,f){var h="",p=f.type=="string"?[0,0,0,0]:gN(d,f);switch(f.type){case"base64":h=Ia(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):f.codepage&&typeof Pt<"u"?h=Pt.utils.decode(f.codepage,d):h=wt&&Buffer.isBuffer(d)?d.toString("binary"):Do(d);break;case"array":h=Al(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=Wt(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=Wt(h):f.type=="binary"&&typeof Pt<"u"&&f.codepage&&(h=Pt.utils.decode(f.codepage,Pt.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?RR.to_sheet(f.type=="string"?h:Wt(h),f):s(h,f)}function c(d,f){return Ro(o(d,f),f)}function u(d){for(var f=[],h=At(d["!ref"]),p,x=Array.isArray(d),g=h.s.r;g<=h.e.r;++g){for(var y=[],v=h.s.c;v<=h.e.c;++v){var w=it({r:g,c:v});if(p=x?(d[g]||[])[v]:d[w],!p||p.v==null){y.push("          ");continue}for(var b=(p.w||(Yi(p),p.w)||"").slice(0,10);b.length<10;)b+=" ";y.push(b+(v===0?" ":""))}f.push(y.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}}();function uae(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=OR.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Qc.to_workbook(e,t)}}var ll=function(){function e(I,W,U){if(I){dn(I,I.l||0);for(var G=U.Enum||ae;I.l<I.length;){var ne=I.read_shift(2),K=G[ne]||G[65535],le=I.read_shift(2),Q=I.l+le,ce=K.f&&K.f(I,le,U);if(I.l=Q,W(ce,K,ne))return}}}function t(I,W){switch(W.type){case"base64":return r(Sa(Ia(I)),W);case"binary":return r(Sa(I),W);case"buffer":case"array":return r(I,W)}throw"Unsupported type "+W.type}function r(I,W){if(!I)return I;var U=W||{},G=U.dense?[]:{},ne="Sheet1",K="",le=0,Q={},ce=[],be=[],j={s:{r:0,c:0},e:{r:0,c:0}},$e=U.sheetRows||0;if(I[2]==0&&(I[3]==8||I[3]==9)&&I.length>=16&&I[14]==5&&I[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(I[2]==2)U.Enum=ae,e(I,function(we,de,Ge){switch(Ge){case 0:U.vers=we,we>=4096&&(U.qpro=!0);break;case 6:j=we;break;case 204:we&&(K=we);break;case 222:K=we;break;case 15:case 51:U.qpro||(we[1].v=we[1].v.slice(1));case 13:case 14:case 16:Ge==14&&(we[2]&112)==112&&(we[2]&15)>1&&(we[2]&15)<15&&(we[1].z=U.dateNF||nt[14],U.cellDates&&(we[1].t="d",we[1].v=wg(we[1].v))),U.qpro&&we[3]>le&&(G["!ref"]=xt(j),Q[ne]=G,ce.push(ne),G=U.dense?[]:{},j={s:{r:0,c:0},e:{r:0,c:0}},le=we[3],ne=K||"Sheet"+(le+1),K="");var et=U.dense?(G[we[0].r]||[])[we[0].c]:G[it(we[0])];if(et){et.t=we[1].t,et.v=we[1].v,we[1].z!=null&&(et.z=we[1].z),we[1].f!=null&&(et.f=we[1].f);break}U.dense?(G[we[0].r]||(G[we[0].r]=[]),G[we[0].r][we[0].c]=we[1]):G[it(we[0])]=we[1];break}},U);else if(I[2]==26||I[2]==14)U.Enum=oe,I[2]==14&&(U.qpro=!0,I.l=0),e(I,function(we,de,Ge){switch(Ge){case 204:ne=we;break;case 22:we[1].v=we[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(we[3]>le&&(G["!ref"]=xt(j),Q[ne]=G,ce.push(ne),G=U.dense?[]:{},j={s:{r:0,c:0},e:{r:0,c:0}},le=we[3],ne="Sheet"+(le+1)),$e>0&&we[0].r>=$e)break;U.dense?(G[we[0].r]||(G[we[0].r]=[]),G[we[0].r][we[0].c]=we[1]):G[it(we[0])]=we[1],j.e.c<we[0].c&&(j.e.c=we[0].c),j.e.r<we[0].r&&(j.e.r=we[0].r);break;case 27:we[14e3]&&(be[we[14e3][0]]=we[14e3][1]);break;case 1537:be[we[0]]=we[1],we[0]==le&&(ne=we[1]);break}},U);else throw new Error("Unrecognized LOTUS BOF "+I[2]);if(G["!ref"]=xt(j),Q[K||ne]=G,ce.push(K||ne),!be.length)return{SheetNames:ce,Sheets:Q};for(var Ee={},Ae=[],Be=0;Be<be.length;++Be)Q[ce[Be]]?(Ae.push(be[Be]||ce[Be]),Ee[be[Be]]=Q[be[Be]]||Q[ce[Be]]):(Ae.push(be[Be]),Ee[be[Be]]={"!ref":"A1"});return{SheetNames:Ae,Sheets:Ee}}function n(I,W){var U=W||{};if(+U.codepage>=0&&ai(+U.codepage),U.type=="string")throw new Error("Cannot write WK1 to JS string");var G=ca(),ne=At(I["!ref"]),K=Array.isArray(I),le=[];Oe(G,0,i(1030)),Oe(G,6,c(ne));for(var Q=Math.min(ne.e.r,8191),ce=ne.s.r;ce<=Q;++ce)for(var be=wr(ce),j=ne.s.c;j<=ne.e.c;++j){ce===ne.s.r&&(le[j]=tr(j));var $e=le[j]+be,Ee=K?(I[ce]||[])[j]:I[$e];if(!(!Ee||Ee.t=="z"))if(Ee.t=="n")(Ee.v|0)==Ee.v&&Ee.v>=-32768&&Ee.v<=32767?Oe(G,13,p(ce,j,Ee.v)):Oe(G,14,g(ce,j,Ee.v));else{var Ae=Yi(Ee);Oe(G,15,f(ce,j,Ae.slice(0,239)))}}return Oe(G,1),G.end()}function a(I,W){var U=W||{};if(+U.codepage>=0&&ai(+U.codepage),U.type=="string")throw new Error("Cannot write WK3 to JS string");var G=ca();Oe(G,0,s(I));for(var ne=0,K=0;ne<I.SheetNames.length;++ne)(I.Sheets[I.SheetNames[ne]]||{})["!ref"]&&Oe(G,27,V(I.SheetNames[ne],K++));var le=0;for(ne=0;ne<I.SheetNames.length;++ne){var Q=I.Sheets[I.SheetNames[ne]];if(!(!Q||!Q["!ref"])){for(var ce=At(Q["!ref"]),be=Array.isArray(Q),j=[],$e=Math.min(ce.e.r,8191),Ee=ce.s.r;Ee<=$e;++Ee)for(var Ae=wr(Ee),Be=ce.s.c;Be<=ce.e.c;++Be){Ee===ce.s.r&&(j[Be]=tr(Be));var we=j[Be]+Ae,de=be?(Q[Ee]||[])[Be]:Q[we];if(!(!de||de.t=="z"))if(de.t=="n")Oe(G,23,T(Ee,Be,le,de.v));else{var Ge=Yi(de);Oe(G,22,E(Ee,Be,le,Ge.slice(0,239)))}}++le}}return Oe(G,1),G.end()}function i(I){var W=ge(2);return W.write_shift(2,I),W}function s(I){var W=ge(26);W.write_shift(2,4096),W.write_shift(2,4),W.write_shift(4,0);for(var U=0,G=0,ne=0,K=0;K<I.SheetNames.length;++K){var le=I.SheetNames[K],Q=I.Sheets[le];if(!(!Q||!Q["!ref"])){++ne;var ce=Xn(Q["!ref"]);U<ce.e.r&&(U=ce.e.r),G<ce.e.c&&(G=ce.e.c)}}return U>8191&&(U=8191),W.write_shift(2,U),W.write_shift(1,ne),W.write_shift(1,G),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(1,1),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(4,0),W}function o(I,W,U){var G={s:{c:0,r:0},e:{c:0,r:0}};return W==8&&U.qpro?(G.s.c=I.read_shift(1),I.l++,G.s.r=I.read_shift(2),G.e.c=I.read_shift(1),I.l++,G.e.r=I.read_shift(2),G):(G.s.c=I.read_shift(2),G.s.r=I.read_shift(2),W==12&&U.qpro&&(I.l+=2),G.e.c=I.read_shift(2),G.e.r=I.read_shift(2),W==12&&U.qpro&&(I.l+=2),G.s.c==65535&&(G.s.c=G.e.c=G.s.r=G.e.r=0),G)}function c(I){var W=ge(8);return W.write_shift(2,I.s.c),W.write_shift(2,I.s.r),W.write_shift(2,I.e.c),W.write_shift(2,I.e.r),W}function u(I,W,U){var G=[{c:0,r:0},{t:"n",v:0},0,0];return U.qpro&&U.vers!=20768?(G[0].c=I.read_shift(1),G[3]=I.read_shift(1),G[0].r=I.read_shift(2),I.l+=2):(G[2]=I.read_shift(1),G[0].c=I.read_shift(2),G[0].r=I.read_shift(2)),G}function d(I,W,U){var G=I.l+W,ne=u(I,W,U);if(ne[1].t="s",U.vers==20768){I.l++;var K=I.read_shift(1);return ne[1].v=I.read_shift(K,"utf8"),ne}return U.qpro&&I.l++,ne[1].v=I.read_shift(G-I.l,"cstr"),ne}function f(I,W,U){var G=ge(7+U.length);G.write_shift(1,255),G.write_shift(2,W),G.write_shift(2,I),G.write_shift(1,39);for(var ne=0;ne<G.length;++ne){var K=U.charCodeAt(ne);G.write_shift(1,K>=128?95:K)}return G.write_shift(1,0),G}function h(I,W,U){var G=u(I,W,U);return G[1].v=I.read_shift(2,"i"),G}function p(I,W,U){var G=ge(7);return G.write_shift(1,255),G.write_shift(2,W),G.write_shift(2,I),G.write_shift(2,U,"i"),G}function x(I,W,U){var G=u(I,W,U);return G[1].v=I.read_shift(8,"f"),G}function g(I,W,U){var G=ge(13);return G.write_shift(1,255),G.write_shift(2,W),G.write_shift(2,I),G.write_shift(8,U,"f"),G}function y(I,W,U){var G=I.l+W,ne=u(I,W,U);if(ne[1].v=I.read_shift(8,"f"),U.qpro)I.l=G;else{var K=I.read_shift(2);S(I.slice(I.l,I.l+K),ne),I.l+=K}return ne}function v(I,W,U){var G=W&32768;return W&=-32769,W=(G?I:0)+(W>=8192?W-16384:W),(G?"":"$")+(U?tr(W):wr(W))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(I,W){dn(I,0);for(var U=[],G=0,ne="",K="",le="",Q="";I.l<I.length;){var ce=I[I.l++];switch(ce){case 0:U.push(I.read_shift(8,"f"));break;case 1:K=v(W[0].c,I.read_shift(2),!0),ne=v(W[0].r,I.read_shift(2),!1),U.push(K+ne);break;case 2:{var be=v(W[0].c,I.read_shift(2),!0),j=v(W[0].r,I.read_shift(2),!1);K=v(W[0].c,I.read_shift(2),!0),ne=v(W[0].r,I.read_shift(2),!1),U.push(be+j+":"+K+ne)}break;case 3:if(I.l<I.length){console.error("WK1 premature formula end");return}break;case 4:U.push("("+U.pop()+")");break;case 5:U.push(I.read_shift(2));break;case 6:{for(var $e="";ce=I[I.l++];)$e+=String.fromCharCode(ce);U.push('"'+$e.replace(/"/g,'""')+'"')}break;case 8:U.push("-"+U.pop());break;case 23:U.push("+"+U.pop());break;case 22:U.push("NOT("+U.pop()+")");break;case 20:case 21:Q=U.pop(),le=U.pop(),U.push(["AND","OR"][ce-20]+"("+le+","+Q+")");break;default:if(ce<32&&b[ce])Q=U.pop(),le=U.pop(),U.push(le+b[ce]+Q);else if(w[ce]){if(G=w[ce][1],G==69&&(G=I[I.l++]),G>U.length){console.error("WK1 bad formula parse 0x"+ce.toString(16)+":|"+U.join("|")+"|");return}var Ee=U.slice(-G);U.length-=G,U.push(w[ce][0]+"("+Ee.join(",")+")")}else return ce<=7?console.error("WK1 invalid opcode "+ce.toString(16)):ce<=24?console.error("WK1 unsupported op "+ce.toString(16)):ce<=30?console.error("WK1 invalid opcode "+ce.toString(16)):ce<=115?console.error("WK1 unsupported function opcode "+ce.toString(16)):console.error("WK1 unrecognized opcode "+ce.toString(16))}}U.length==1?W[1].f=""+U[0]:console.error("WK1 bad formula parse |"+U.join("|")+"|")}function k(I){var W=[{c:0,r:0},{t:"n",v:0},0];return W[0].r=I.read_shift(2),W[3]=I[I.l++],W[0].c=I[I.l++],W}function _(I,W){var U=k(I);return U[1].t="s",U[1].v=I.read_shift(W-4,"cstr"),U}function E(I,W,U,G){var ne=ge(6+G.length);ne.write_shift(2,I),ne.write_shift(1,U),ne.write_shift(1,W),ne.write_shift(1,39);for(var K=0;K<G.length;++K){var le=G.charCodeAt(K);ne.write_shift(1,le>=128?95:le)}return ne.write_shift(1,0),ne}function P(I,W){var U=k(I);U[1].v=I.read_shift(2);var G=U[1].v>>1;if(U[1].v&1)switch(G&7){case 0:G=(G>>3)*5e3;break;case 1:G=(G>>3)*500;break;case 2:G=(G>>3)/20;break;case 3:G=(G>>3)/200;break;case 4:G=(G>>3)/2e3;break;case 5:G=(G>>3)/2e4;break;case 6:G=(G>>3)/16;break;case 7:G=(G>>3)/64;break}return U[1].v=G,U}function A(I,W){var U=k(I),G=I.read_shift(4),ne=I.read_shift(4),K=I.read_shift(2);if(K==65535)return G===0&&ne===3221225472?(U[1].t="e",U[1].v=15):G===0&&ne===3489660928?(U[1].t="e",U[1].v=42):U[1].v=0,U;var le=K&32768;return K=(K&32767)-16446,U[1].v=(1-le*2)*(ne*Math.pow(2,K+32)+G*Math.pow(2,K)),U}function T(I,W,U,G){var ne=ge(14);if(ne.write_shift(2,I),ne.write_shift(1,U),ne.write_shift(1,W),G==0)return ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(2,65535),ne;var K=0,le=0,Q=0,ce=0;return G<0&&(K=1,G=-G),le=Math.log2(G)|0,G/=Math.pow(2,le-31),ce=G>>>0,ce&2147483648||(G/=2,++le,ce=G>>>0),G-=ce,ce|=2147483648,ce>>>=0,G*=Math.pow(2,32),Q=G>>>0,ne.write_shift(4,Q),ne.write_shift(4,ce),le+=16383+(K?32768:0),ne.write_shift(2,le),ne}function R(I,W){var U=A(I);return I.l+=W-14,U}function D(I,W){var U=k(I),G=I.read_shift(4);return U[1].v=G>>6,U}function L(I,W){var U=k(I),G=I.read_shift(8,"f");return U[1].v=G,U}function z(I,W){var U=L(I);return I.l+=W-10,U}function X(I,W){return I[I.l+W-1]==0?I.read_shift(W,"cstr"):""}function Y(I,W){var U=I[I.l++];U>W-1&&(U=W-1);for(var G="";G.length<U;)G+=String.fromCharCode(I[I.l++]);return G}function q(I,W,U){if(!(!U.qpro||W<21)){var G=I.read_shift(1);I.l+=17,I.l+=1,I.l+=2;var ne=I.read_shift(W-21,"cstr");return[G,ne]}}function ee(I,W){for(var U={},G=I.l+W;I.l<G;){var ne=I.read_shift(2);if(ne==14e3){for(U[ne]=[0,""],U[ne][0]=I.read_shift(2);I[I.l];)U[ne][1]+=String.fromCharCode(I[I.l]),I.l++;I.l++}}return U}function V(I,W){var U=ge(5+I.length);U.write_shift(2,14e3),U.write_shift(2,W);for(var G=0;G<I.length;++G){var ne=I.charCodeAt(G);U[U.l++]=ne>127?95:ne}return U[U.l++]=0,U}var ae={0:{n:"BOF",f:Rr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:X},222:{n:"SHEETNAMELP",f:Y},65535:{n:""}},oe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:_},23:{n:"NUMBER17",f:A},24:{n:"NUMBER18",f:P},25:{n:"FORMULA19",f:R},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ee},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:L},40:{n:"FORMULA28",f:z},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:X},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function dae(e){var t={},r=e.match(Fn),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=st(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=P2[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var fae=function(){var e=af("t"),t=af("rPr");function r(i){var s=i.match(e);if(!s)return{t:"s",v:""};var o={t:"s",v:Rt(s[1])},c=i.match(t);return c&&(o.s=dae(c[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(a).map(r).filter(function(o){return o.v})}}(),mae=function(){var t=/(\r\n|\n)/g;function r(a,i,s){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),a.b&&(i.push("<b>"),s.push("</b>")),a.i&&(i.push("<i>"),s.push("</i>")),a.strike&&(i.push("<s>"),s.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),s.push("</"+c+">")),s.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),hae=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,pae=/<(?:\w+:)?r>/,gae=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function rN(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Rt(Wt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Wt(e),r&&(n.h=B2(n.t))):e.match(pae)&&(n.r=Wt(e),n.t=Rt(Wt((e.replace(gae,"").match(hae)||[]).join("").replace(Fn,""))),r&&(n.h=mae(fae(n.r)))),n):{t:""}}var xae=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,vae=/<(?:\w+:)?(?:si|sstItem)>/g,yae=/<\/(?:\w+:)?(?:si|sstItem)>/;function bae(e,t){var r=[],n="";if(!e)return r;var a=e.match(xae);if(a){n=a[2].replace(vae,"").split(yae);for(var i=0;i!=n.length;++i){var s=rN(n[i].trim(),t);s!=null&&(r[r.length]=s)}a=st(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var wae=/^\s|\s$|[\t\n\r]/;function MR(e,t){if(!t.bookSST)return"";var r=[Tr];r[r.length]=Pe("sst",null,{xmlns:jl[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(wae)&&(i+=' xml:space="preserve"'),i+=">"+Ut(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Nae(e){return[e.read_shift(4),e.read_shift(4)]}function Sae(e,t){var r=[],n=!1;return Is(e,function(i,s,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function kae(e,t){return t||(t=ge(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var _ae=Ite;function Eae(e){var t=ca();ye(t,159,kae(e));for(var r=0;r<e.length;++r)ye(t,19,_ae(e[r]));return ye(t,160),t.end()}function IR(e){if(typeof Pt<"u")return Pt.utils.encode(El,e);for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function gs(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Cae(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=gs(e,4),t.U=gs(e,4),t.W=gs(e,4),t}function Aae(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function Tae(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Aae(e));return t}function Pae(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function Oae(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=gs(e,4),t.U=gs(e,4),t.W=gs(e,4),t}function Dae(e){var t=Oae(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function FR(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function LR(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function Rae(e){var t=gs(e);switch(t.Minor){case 2:return[t.Minor,Mae(e)];case 3:return[t.Minor,Iae()];case 4:return[t.Minor,Fae(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Mae(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=FR(e,r),a=LR(e,e.length-e.l);return{t:"Std",h:n,v:a}}function Iae(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Fae(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Fn,function(i){var s=st(i);switch(Ji(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=s[o]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function Lae(e,t){var r={},n=r.EncryptionVersionInfo=gs(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=FR(e,a),t-=a,r.EncryptionVerifier=LR(e,t),r}function Bae(e){var t={},r=t.EncryptionVersionInfo=gs(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function nN(e){var t=0,r,n=IR(e),a=n.length+1,i,s,o,c,u;for(r=bo(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)s=r[i],o=t&16384?1:0,c=t<<1&32767,u=o|c,t=u^s;return t^52811}var BR=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},a=function(s,o){return n(s^o)},i=function(s){for(var o=t[s.length-1],c=104,u=s.length-1;u>=0;--u)for(var d=s[u],f=0;f!=7;++f)d&64&&(o^=r[c]),d*=2,--c;return o};return function(s){for(var o=IR(s),c=i(o),u=o.length,d=bo(16),f=0;f!=16;++f)d[f]=0;var h,p,x;for((u&1)===1&&(h=c>>8,d[u]=a(e[0],h),--u,h=c&255,p=o[o.length-1],d[u]=a(p,h));u>0;)--u,h=c>>8,d[u]=a(o[u],h),--u,h=c&255,d[u]=a(o[u],h);for(u=15,x=15-o.length;x>0;)h=c>>8,d[u]=a(e[x],h),--u,--x,h=c&255,d[u]=a(o[u],h),--u,--x;return d}}(),jae=function(e,t,r,n,a){a||(a=t),n||(n=BR(e));var i,s;for(i=0;i!=t.length;++i)s=t[i],s^=n[r],s=(s>>5|s<<3)&255,a[i]=s,++r;return[a,r,n]},$ae=function(e){var t=0,r=BR(e);return function(n){var a=jae("",n,t,r);return t=a[1],a[0]}};function Uae(e,t,r,n){var a={key:Rr(e),verificationBytes:Rr(e)};return r.password&&(a.verifier=nN(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=$ae(r.password)),a}function zae(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Bae(e):n.Data=Lae(e,t),n}function Hae(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?zae(e,t-2,n):Uae(e,r.biff>=8?t:t-2,r,n),n}var jR=function(){function e(a,i){switch(i.type){case"base64":return t(Ia(a),i);case"binary":return t(a,i);case"buffer":return t(wt&&Buffer.isBuffer(a)?a.toString("binary"):Do(a),i);case"array":return t(Al(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var s=i||{},o=s.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,p=0,x,g=-1;x=h.exec(d);){switch(x[0]){case"\\cell":var y=d.slice(p,h.lastIndex-x[0].length);if(y[0]==" "&&(y=y.slice(1)),++g,y.length){var v={v:y,t:"s"};Array.isArray(o)?o[f][g]=v:o[it({r:f,c:g})]=v}break}p=h.lastIndex}g>u.e.c&&(u.e.c=g)}),o["!ref"]=xt(u),o}function r(a,i){return Ro(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=At(a["!ref"]),o,c=Array.isArray(a),u=s.s.r;u<=s.e.r;++u){i.push("\\trowd\\trautofit1");for(var d=s.s.c;d<=s.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=s.s.c;d<=s.e.c;++d){var f=it({r:u,c:d});o=c?(a[u]||[])[d]:a[f],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Yi(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Wae(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function cf(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function Gae(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),s=a-i;if(s===0)return[0,0,t];var o=0,c=0,u=a+i;switch(c=s/(u>1?2-u:u),a){case t:o=((r-n)/s+6)%6;break;case r:o=(n-t)/s+2;break;case n:o=(t-r)/s+4;break}return[o/6,c,u/2]}function Vae(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,s=[i,i,i],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=a*o,s[0]+=a,s[1]+=c;break;case 1:c=a*(2-o),s[0]+=c,s[1]+=a;break;case 2:c=a*(o-2),s[1]+=a,s[2]+=c;break;case 3:c=a*(4-o),s[1]+=c,s[2]+=a;break;case 4:c=a*(o-4),s[2]+=a,s[0]+=c;break;case 5:c=a*(6-o),s[2]+=c,s[0]+=a;break}for(var u=0;u!=3;++u)s[u]=Math.round(s[u]*255);return s}function Hh(e,t){if(t===0)return e;var r=Gae(Wae(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),cf(Vae(r))}var $R=6,Kae=15,Xae=1,En=$R;function uf(e){return Math.floor((e+Math.round(128/En)/256)*En)}function df(e){return Math.floor((e-5)/En*100+.5)/100}function Wh(e){return Math.round((e*En+5)/En*256)/256}function jx(e){return Wh(df(uf(e)))}function aN(e){var t=Math.abs(e-jx(e)),r=En;if(t>.005)for(En=Xae;En<Kae;++En)Math.abs(e-jx(e))<=t&&(t=Math.abs(e-jx(e)),r=En);En=r}function wo(e){e.width?(e.wpx=uf(e.width),e.wch=df(e.wpx),e.MDW=En):e.wpx?(e.wch=df(e.wpx),e.width=Wh(e.wch),e.MDW=En):typeof e.wch=="number"&&(e.width=Wh(e.wch),e.wpx=uf(e.width),e.MDW=En),e.customWidth&&delete e.customWidth}var qae=96,UR=qae;function ff(e){return e*96/UR}function Zc(e){return e*UR/96}var Yae={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Jae(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(Fn)||[]).forEach(function(s){var o=st(s);switch(Ji(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=Zt(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=Zt(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function Qae(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(Fn)||[]).forEach(function(s){var o=st(s);switch(Ji(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function Zae(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(Fn)||[]).forEach(function(s){var o=st(s);switch(Ji(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=Wt(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?Zt(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?Zt(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?Zt(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?Zt(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?Zt(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?Zt(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?Zt(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=P2[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=Zt(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var c=sl[a.color.index];a.color.index==81&&(c=sl[1]),c||(c=sl[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Hh(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function eie(e,t,r){t.NumberFmt=[];for(var n=Sr(nt),a=0;a<n.length;++a)t.NumberFmt[n[a]]=nt[n[a]];var i=e[0].match(Fn);if(i)for(a=0;a<i.length;++a){var s=st(i[a]);switch(Ji(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Rt(Wt(s.formatCode)),c=parseInt(s.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}Vi(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function tie(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Pe("numFmt",null,{numFmtId:n,formatCode:Ut(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Pe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var H0=["numFmtId","fillId","fontId","borderId","xfId"],W0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function rie(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Fn)||[]).forEach(function(i){var s=st(i),o=0;switch(Ji(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],o=0;o<H0.length;++o)n[H0[o]]&&(n[H0[o]]=parseInt(n[H0[o]],10));for(o=0;o<W0.length;++o)n[W0[o]]&&(n[W0[o]]=Zt(n[W0[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};s.vertical&&(c.vertical=s.vertical),s.horizontal&&(c.horizontal=s.horizontal),s.textRotation!=null&&(c.textRotation=s.textRotation),s.indent&&(c.indent=s.indent),s.wrapText&&(c.wrapText=Zt(s.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}function nie(e){var t=[];return t[t.length]=Pe("cellXfs",null),e.forEach(function(r){t[t.length]=Pe("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Pe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var aie=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,u){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&eie(f,d,u),(f=o.match(a))&&Zae(f,d,c,u),(f=o.match(n))&&Qae(f,d,c,u),(f=o.match(i))&&Jae(f,d,c,u),(f=o.match(r))&&rie(f,d,u),d}}();function zR(e,t){var r=[Tr,Pe("styleSheet",null,{xmlns:jl[0],"xmlns:vt":Ur.vt})],n;return e.SSF&&(n=tie(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=nie(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function iie(e,t){var r=e.read_shift(2),n=Dn(e);return[r,n]}function sie(e,t,r){r||(r=ge(6+4*t.length)),r.write_shift(2,e),rn(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function oie(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=zte(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=Ute(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Dn(e),n}function lie(e,t){t||(t=ge(25+4*32)),t.write_shift(2,e.sz*20),Hte(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),$h(e.color,t);var n=0;return e.scheme=="major"&&(n=1),e.scheme=="minor"&&(n=2),t.write_shift(1,n),rn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var cie=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],$x,uie=In;function HE(e,t){t||(t=ge(4*3+8*7+16*1)),$x||($x=yg(cie));var r=$x[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for($h({auto:1},t),$h({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function die(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function HR(e,t,r){r||(r=ge(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Xu(e,t){return t||(t=ge(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var fie=In;function mie(e,t){return t||(t=ge(51)),t.write_shift(1,0),Xu(null,t),Xu(null,t),Xu(null,t),Xu(null,t),Xu(null,t),t.length>t.l?t.slice(0,t.l):t}function hie(e,t){return t||(t=ge(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),jh(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function pie(e,t,r){var n=ge(2052);return n.write_shift(4,e),jh(t,n),jh(r,n),n.length>n.l?n.slice(0,n.l):n}function gie(e,t,r){var n={};n.NumberFmt=[];for(var a in nt)n.NumberFmt[a]=nt[a];n.CellXf=[],n.Fonts=[];var i=[],s=!1;return Is(e,function(c,u,d){switch(d){case 44:n.NumberFmt[c[0]]=c[1],Vi(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=Hh(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(d),s=!0;break;case 38:i.pop(),s=!1;break;default:if(u.T>0)i.push(d);else if(u.T<0)i.pop();else if(!s||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function xie(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(ye(e,615,Ai(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&ye(e,44,sie(a,t[a]))}),ye(e,616))}}function vie(e){var t=1;ye(e,611,Ai(t)),ye(e,43,lie({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),ye(e,612)}function yie(e){var t=2;ye(e,603,Ai(t)),ye(e,45,HE({patternType:"none"})),ye(e,45,HE({patternType:"gray125"})),ye(e,604)}function bie(e){var t=1;ye(e,613,Ai(t)),ye(e,46,mie()),ye(e,614)}function wie(e){var t=1;ye(e,626,Ai(t)),ye(e,47,HR({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),ye(e,627)}function Nie(e,t){ye(e,617,Ai(t.length)),t.forEach(function(r){ye(e,47,HR(r,0))}),ye(e,618)}function Sie(e){var t=1;ye(e,619,Ai(t)),ye(e,48,hie({xfId:0,builtinId:0,name:"Normal"})),ye(e,620)}function kie(e){var t=0;ye(e,505,Ai(t)),ye(e,506)}function _ie(e){var t=0;ye(e,508,pie(t,"TableStyleMedium9","PivotStyleMedium4")),ye(e,509)}function Eie(e,t){var r=ca();return ye(r,278),xie(r,e.SSF),vie(r),yie(r),bie(r),wie(r),Nie(r,t.cellXfs),Sie(r),kie(r),_ie(r),ye(r,279),r.end()}var Cie=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Aie(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Fn)||[]).forEach(function(a){var i=st(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[Cie.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function Tie(){}function Pie(){}var Oie=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Die=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Rie=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Mie(e,t,r){t.themeElements={};var n;[["clrScheme",Oie,Aie],["fontScheme",Die,Tie],["fmtScheme",Rie,Pie]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var Iie=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function WR(e,t){(!e||e.length===0)&&(e=iN());var r,n={};if(!(r=e.match(Iie)))throw new Error("themeElements not found in theme");return Mie(r[0],n,t),n.raw=e,n}function iN(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Tr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Fie(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var s;try{s=$D(i,{type:"array"})}catch{return}var o=ka(s,"theme/theme/theme1.xml",!0);if(o)return WR(o,r)}}function Lie(e){return e.read_shift(4)}function Bie(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=jie(e,4);break;case 2:t.xclrValue=SR(e);break;case 3:t.xclrValue=Lie(e);break;case 4:e.l+=4;break}return e.l+=8,t}function jie(e,t){return In(e,t)}function $ie(e,t){return In(e,t)}function Uie(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Bie(e);break;case 6:n[1]=$ie(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function zie(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(Uie(e,r-e.l));return{ixfe:n,ext:i}}function Hie(e,t){t.forEach(function(r){switch(r[0]){}})}function Wie(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Dn(e)}}function Gie(e){var t=ge(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),rn(e.name,t),t.slice(0,t.l)}function Vie(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Kie(e){var t=ge(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Xie(e,t){var r=ge(8+2*t.length);return r.write_shift(4,e),rn(t,r),r.slice(0,r.l)}function qie(e){return e.l+=4,e.read_shift(4)!=0}function Yie(e,t){var r=ge(8);return r.write_shift(4,e),r.write_shift(4,t?1:0),r}function Jie(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],s=!1,o=2;return Is(e,function(c,u,d){switch(d){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:i.push(d),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!u.T){if(!s||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function Qie(){var e=ca();return ye(e,332),ye(e,334,Ai(1)),ye(e,335,Gie({name:"XLDAPR",version:12e4,flags:3496657072})),ye(e,336),ye(e,339,Xie(1,"XLDAPR")),ye(e,52),ye(e,35,Ai(514)),ye(e,4096,Ai(0)),ye(e,4097,Ya(1)),ye(e,36),ye(e,53),ye(e,340),ye(e,337,Yie(1,!0)),ye(e,51,Kie([[1,0]])),ye(e,338),ye(e,333),e.end()}function Zie(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,s;return e.replace(Fn,function(o){var c=st(o);switch(Ji(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(s=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):i==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+c.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function GR(){var e=[Tr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function ese(e){var t=[];if(!e)return t;var r=1;return(e.match(Fn)||[]).forEach(function(n){var a=st(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function tse(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=it(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function rse(e,t,r){var n=[];return Is(e,function(i,s,o){switch(o){case 63:n.push(i);break;default:if(!s.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function nse(e,t,r,n){if(!e)return e;var a=n||{},i=!1;Is(e,function(o,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},a)}function ase(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var xc=1024;function VR(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Pe("xml",null,{"xmlns:v":va.v,"xmlns:o":va.o,"xmlns:x":va.x,"xmlns:mv":va.mv}).replace(/\/>/,">"),Pe("o:shapelayout",Pe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Pe("v:shapetype",[Pe("v:stroke",null,{joinstyle:"miter"}),Pe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];xc<e*1e3;)xc+=1e3;return t.forEach(function(i){var s=mr(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?Pe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Pe("v:fill",c,o),d={on:"t",obscured:"t"};++xc,a=a.concat(["<v:shape"+sf({id:"_x0000_s"+xc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Pe("v:shadow",null,d),Pe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",fn("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),fn("x:AutoFill","False"),fn("x:Row",String(s.r)),fn("x:Column",String(s.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function WE(e,t,r,n){var a=Array.isArray(e),i;t.forEach(function(s){var o=mr(s.ref);if(a?(e[o.r]||(e[o.r]=[]),i=e[o.r][o.c]):i=e[s.ref],!i){i={t:"z"},a?e[o.r][o.c]=i:e[s.ref]=i;var c=At(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var u=xt(c);u!==e["!ref"]&&(e["!ref"]=u)}i.c||(i.c=[]);var d={a:s.author,t:s.t,r:s.r,T:r};s.h&&(d.h=s.h);for(var f=i.c.length-1;f>=0;--f){if(!r&&i.c[f].T)return;r&&!i.c[f].T&&i.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}i.c.push(d)})}function ise(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=st(o[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=mr(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&rN(f[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),n.push(u)}}}}),n}function KR(e){var t=[Tr,Pe("comments",null,{xmlns:jl[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=Ut(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=r.indexOf(Ut(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)t.push(fn("t",Ut(i[0]||"")));else{for(var s=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)s+=`Reply:
    `+i[o]+`
`;t.push(fn("t",Ut(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function sse(e,t){var r=[],n=!1,a={},i=0;return e.replace(Fn,function(o,c){var u=st(o);switch(Ji(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=c+o.length;break;case"</text>":a.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function ose(e,t,r){var n=[Tr,Pe("ThreadedComments",null,{xmlns:Ur.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=c.id:c.parentId=i,s.ID=c.id,s.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(Pe("threadedComment",fn("text",s.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function lse(e,t){var r=[],n=!1;return e.replace(Fn,function(i){var s=st(i);switch(Ji(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),r}function cse(e){var t=[Tr,Pe("personList",null,{xmlns:Ur.TCMNT,"xmlns:x":jl[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Pe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function use(e){var t={};t.iauthor=e.read_shift(4);var r=Hl(e);return t.rfx=r.s,t.ref=it(r.s),e.l+=16,t}function dse(e,t){return t==null&&(t=ge(36)),t.write_shift(4,e[1].iauthor),Nu(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var fse=Dn;function mse(e){return rn(e.slice(0,54))}function hse(e,t){var r=[],n=[],a={},i=!1;return Is(e,function(o,c,u){switch(u){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function pse(e){var t=ca(),r=[];return ye(t,628),ye(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),ye(t,632,mse(a.a)))})}),ye(t,631),ye(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:mr(n[0]),e:mr(n[0])};ye(t,635,dse([i,a])),a.t&&a.t.length>0&&ye(t,637,Lte(a)),ye(t,636),delete a.iauthor})}),ye(t,634),ye(t,629),t.end()}var gse="application/vnd.ms-office.vbaProject";function xse(e){var t=rt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");rt.utils.cfb_add(t,a,e.FileIndex[n].content)}}),rt.write(t)}function vse(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&rt.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var XR=["xlsb","xlsm","xlam","biff8","xla"];function yse(){return{"!type":"dialog"}}function bse(){return{"!type":"dialog"}}function wse(){return{"!type":"macro"}}function Nse(){return{"!type":"macro"}}var Tc=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,s){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,d=s.length>0?parseInt(s,10)|0:0;return o?d+=t.c:--d,c?u+=t.r:--u,a+(o?"":"$")+tr(d)+(c?"":"$")+wr(u)}return function(a,i){return t=i,a.replace(e,r)}}(),sN=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,oN=function(){return function(t,r){return t.replace(sN,function(n,a,i,s,o,c){var u=K2(s)-(i?0:r.c),d=V2(c)-(o?0:r.r),f=d==0?"":o?d+1:"["+d+"]",h=u==0?"":i?u+1:"["+u+"]";return a+"R"+f+"C"+h})}}();function qR(e,t){return e.replace(sN,function(r,n,a,i,s,o){return n+(a=="$"?a+i:tr(K2(i)+t.c))+(s=="$"?s+o:wr(V2(o)+t.r))})}function Sse(e,t,r){var n=Xn(t),a=n.s,i=mr(r),s={r:i.r-a.r,c:i.c-a.c};return qR(e,s)}function kse(e){return e.length!=1}function GE(e){return e.replace(/_xlfn\./g,"")}function Or(e){e.l+=1}function No(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function YR(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return JR(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=No(e,2),o=No(e,2);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function JR(e){var t=No(e,2),r=No(e,2),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function _se(e,t,r){if(r.biff<8)return JR(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=No(e,2),s=No(e,2);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function QR(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Ese(e);var n=e.read_shift(r&&r.biff==12?4:2),a=No(e,2);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function Ese(e){var t=No(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Cse(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Ase(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Tse(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:o}}function Tse(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function Pse(e,t,r){var n=(e[e.l++]&96)>>5,a=YR(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function Ose(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=YR(e,i,r);return[n,a,s]}function Dse(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Rse(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function Mse(e,t,r){var n=(e[e.l++]&96)>>5,a=_se(e,t-1,r);return[n,a]}function Ise(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function VE(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Fse(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function Lse(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Bse(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function jse(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function $se(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function ZR(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Use(e){return e.read_shift(2),ZR(e)}function zse(e){return e.read_shift(2),ZR(e)}function Hse(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=QR(e,0,r);return[n,a]}function Wse(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=Ase(e,0,r);return[n,a]}function Gse(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=QR(e,0,r);return[n,a,i]}function Vse(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[qoe[a],rM[a],n]}function Kse(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Xse(e);return[a,(i[0]===0?rM:Xoe)[i[1]]]}function Xse(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function qse(e,t,r){e.l+=r&&r.biff==2?3:4}function Yse(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Jse(e){return e.l++,Fs[e.read_shift(1)]}function Qse(e){return e.l++,e.read_shift(2)}function Zse(e){return e.l++,e.read_shift(1)!==0}function eoe(e){return e.l++,Tn(e)}function toe(e,t,r){return e.l++,Xf(e,t-1,r)}function roe(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Er(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Fs[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Tn(e);break;case 2:r[1]=Wl(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function noe(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?Hl:Sg)(e));return a}function aoe(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=roe(e,r.biff);return s}function ioe(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function soe(e,t,r){if(r.biff==5)return ooe(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function ooe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function loe(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function coe(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function uoe(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function doe(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var foe=In,moe=In,hoe=In;function Yf(e,t,r){return e.l+=2,[Cse(e)]}function lN(e){return e.l+=6,[]}var poe=Yf,goe=lN,xoe=lN,voe=Yf;function eM(e){return e.l+=2,[Rr(e),e.read_shift(2)&1]}var yoe=Yf,boe=eM,woe=lN,Noe=Yf,Soe=Yf,koe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function _oe(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=koe[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:i}}function Eoe(e){return e.l+=2,[e.read_shift(4)]}function Coe(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Aoe(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Toe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Poe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Ooe(e){return e.l+=4,[0,0]}var KE={1:{n:"PtgExp",f:Yse},2:{n:"PtgTbl",f:hoe},3:{n:"PtgAdd",f:Or},4:{n:"PtgSub",f:Or},5:{n:"PtgMul",f:Or},6:{n:"PtgDiv",f:Or},7:{n:"PtgPower",f:Or},8:{n:"PtgConcat",f:Or},9:{n:"PtgLt",f:Or},10:{n:"PtgLe",f:Or},11:{n:"PtgEq",f:Or},12:{n:"PtgGe",f:Or},13:{n:"PtgGt",f:Or},14:{n:"PtgNe",f:Or},15:{n:"PtgIsect",f:Or},16:{n:"PtgUnion",f:Or},17:{n:"PtgRange",f:Or},18:{n:"PtgUplus",f:Or},19:{n:"PtgUminus",f:Or},20:{n:"PtgPercent",f:Or},21:{n:"PtgParen",f:Or},22:{n:"PtgMissArg",f:Or},23:{n:"PtgStr",f:toe},26:{n:"PtgSheet",f:Coe},27:{n:"PtgEndSheet",f:Aoe},28:{n:"PtgErr",f:Jse},29:{n:"PtgBool",f:Zse},30:{n:"PtgInt",f:Qse},31:{n:"PtgNum",f:eoe},32:{n:"PtgArray",f:Ise},33:{n:"PtgFunc",f:Vse},34:{n:"PtgFuncVar",f:Kse},35:{n:"PtgName",f:ioe},36:{n:"PtgRef",f:Hse},37:{n:"PtgArea",f:Pse},38:{n:"PtgMemArea",f:loe},39:{n:"PtgMemErr",f:foe},40:{n:"PtgMemNoMem",f:moe},41:{n:"PtgMemFunc",f:coe},42:{n:"PtgRefErr",f:uoe},43:{n:"PtgAreaErr",f:Dse},44:{n:"PtgRefN",f:Wse},45:{n:"PtgAreaN",f:Mse},46:{n:"PtgMemAreaN",f:Toe},47:{n:"PtgMemNoMemN",f:Poe},57:{n:"PtgNameX",f:soe},58:{n:"PtgRef3d",f:Gse},59:{n:"PtgArea3d",f:Ose},60:{n:"PtgRefErr3d",f:doe},61:{n:"PtgAreaErr3d",f:Rse},255:{}},Doe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Roe={1:{n:"PtgElfLel",f:eM},2:{n:"PtgElfRw",f:Noe},3:{n:"PtgElfCol",f:poe},6:{n:"PtgElfRwV",f:Soe},7:{n:"PtgElfColV",f:voe},10:{n:"PtgElfRadical",f:yoe},11:{n:"PtgElfRadicalS",f:woe},13:{n:"PtgElfColS",f:goe},15:{n:"PtgElfColSV",f:xoe},16:{n:"PtgElfRadicalLel",f:boe},25:{n:"PtgList",f:_oe},29:{n:"PtgSxName",f:Eoe},255:{}},Moe={0:{n:"PtgAttrNoop",f:Ooe},1:{n:"PtgAttrSemi",f:$se},2:{n:"PtgAttrIf",f:Bse},4:{n:"PtgAttrChoose",f:Fse},8:{n:"PtgAttrGoto",f:Lse},16:{n:"PtgAttrSum",f:qse},32:{n:"PtgAttrBaxcel",f:VE},33:{n:"PtgAttrBaxcel",f:VE},64:{n:"PtgAttrSpace",f:Use},65:{n:"PtgAttrSpaceSemi",f:zse},128:{n:"PtgAttrIfError",f:jse},255:{}};function Jf(e,t,r,n){if(n.biff<8)return In(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=aoe(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=noe(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&i.push(In(e,t)),i}function Qf(e,t,r){for(var n=e.l+t,a,i,s=[];n!=e.l;)t=n-e.l,i=e[e.l],a=KE[i]||KE[Doe[i]],(i===24||i===25)&&(a=(i===24?Roe:Moe)[e[e.l+1]]),!a||!a.f?In(e,t):s.push([a.n,a.f(e,t,r)]);return s}function Ioe(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var Foe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Loe(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function tM(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function XE(e,t,r){var n=tM(e,t,r);return n=="#REF"?n:Loe(n,r)}function Sn(e,t,r,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},o=[],c,u,d,f=0,h=0,p,x="";if(!e[0]||!e[0][0])return"";for(var g=-1,y="",v=0,w=e[0].length;v<w;++v){var b=e[0][v];switch(b[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),g>=0){switch(e[0][g][1][0]){case 0:y=yr(" ",e[0][g][1][1]);break;case 1:y=yr("\r",e[0][g][1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}u=u+y,g=-1}o.push(u+Foe[b[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=vd(b[1][1],s,a),o.push(yd(d,i));break;case"PtgRefN":d=r?vd(b[1][1],r,a):b[1][1],o.push(yd(d,i));break;case"PtgRef3d":f=b[1][1],d=vd(b[1][2],s,a),x=XE(n,f,a),o.push(x+"!"+yd(d,i));break;case"PtgFunc":case"PtgFuncVar":var S=b[1][0],k=b[1][1];S||(S=0),S&=127;var _=S==0?[]:o.slice(-S);o.length-=S,k==="User"&&(k=_.shift()),o.push(k+"("+_.join(",")+")");break;case"PtgBool":o.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(b[1]);break;case"PtgNum":o.push(String(b[1]));break;case"PtgStr":o.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(b[1]);break;case"PtgAreaN":p=SE(b[1][1],r?{s:r}:s,a),o.push(Fx(p,a));break;case"PtgArea":p=SE(b[1][1],s,a),o.push(Fx(p,a));break;case"PtgArea3d":f=b[1][1],p=b[1][2],x=XE(n,f,a),o.push(x+"!"+Fx(p,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=b[1][2];var E=(n.names||[])[h-1]||(n[0]||[])[h],P=E?E.Name:"SH33TJSNAME"+String(h);P&&P.slice(0,6)=="_xlfn."&&!a.xlfn&&(P=P.slice(6)),o.push(P);break;case"PtgNameX":var A=b[1][1];h=b[1][2];var T;if(a.biff<=5)A<0&&(A=-A),n[A]&&(T=n[A][h]);else{var R="";if(((n[A]||[])[0]||[])[0]==14849||(((n[A]||[])[0]||[])[0]==1025?n[A][h]&&n[A][h].itab>0&&(R=n.SheetNames[n[A][h].itab-1]+"!"):R=n.SheetNames[h-1]+"!"),n[A]&&n[A][h])R+=n[A][h].Name;else if(n[0]&&n[0][h])R+=n[0][h].Name;else{var D=(tM(n,A,a)||"").split(";;");D[h-1]?R=D[h-1]:R+="SH33TJSERRX"}o.push(R);break}T||(T={Name:"SH33TJSERRY"}),o.push(T.Name);break;case"PtgParen":var L="(",z=")";if(g>=0){switch(y="",e[0][g][1][0]){case 2:L=yr(" ",e[0][g][1][1])+L;break;case 3:L=yr("\r",e[0][g][1][1])+L;break;case 4:z=yr(" ",e[0][g][1][1])+z;break;case 5:z=yr("\r",e[0][g][1][1])+z;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}o.push(L+o.pop()+z);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:b[1][1],r:b[1][0]};var X={c:r.c,r:r.r};if(n.sharedf[it(d)]){var Y=n.sharedf[it(d)];o.push(Sn(Y,s,X,n,a))}else{var q=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push(Sn(u[1],s,X,n,a)),q=!0;break}q||o.push(b[1])}break;case"PtgArray":o.push("{"+Ioe(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var ee=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&g>=0&&ee.indexOf(e[0][v][0])==-1){b=e[0][g];var V=!0;switch(b[1][0]){case 4:V=!1;case 0:y=yr(" ",b[1][1]);break;case 5:V=!1;case 1:y=yr("\r",b[1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}o.push((V?y:"")+o.pop()+(V?"":y)),g=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function Boe(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],In(e,t-2)];var o=Qf(e,s,r);return t!==s+a&&(i=Jf(e,t-s-a,o,r)),e.l=n,[o,i]}function joe(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],In(e,t-2)];var o=Qf(e,s,r);return t!==s+a&&(i=Jf(e,t-s-a,o,r)),e.l=n,[o,i]}function $oe(e,t,r,n){var a=e.l+t,i=Qf(e,n,r),s;return a!==e.l&&(s=Jf(e,a-e.l,i,r)),[i,s]}function Uoe(e,t,r){var n=e.l+t,a,i=e.read_shift(2),s=Qf(e,i,r);return i==65535?[[],In(e,t-2)]:(t!==i+2&&(a=Jf(e,n-i-2,s,r)),[s,a])}function zoe(e){var t;if(ds(e,e.l+6)!==65535)return[Tn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Hoe(e){if(e==null){var t=ge(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Tl(e);return Tl(0)}function Ux(e,t,r){var n=e.l+t,a=Qi(e);r.biff==2&&++e.l;var i=zoe(e),s=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=joe(e,n-e.l,r);return{cell:a,val:i[0],formula:o,shared:s>>3&1,tt:i[1]}}function Woe(e,t,r,n,a){var i=Ol(t,r,a),s=Hoe(e.v),o=ge(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=ge(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=en([i,s,o,u]);return f}function kg(e,t,r){var n=e.read_shift(4),a=Qf(e,n,r),i=e.read_shift(4),s=i>0?Jf(e,i,a,r):null;return[a,s]}var Goe=kg,_g=kg,Voe=kg,Koe=kg,Xoe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},rM={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},qoe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function qE(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Yoe(e){var t="of:="+e.replace(sN,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function zx(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Joe(e){return e.replace(/\./,"!")}var wd={},Pc={},Nd=typeof Map<"u";function cN(e,t,r){var n=0,a=e.length;if(r){if(Nd?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Nd?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Nd?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function Eg(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(En=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=df(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Wh(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function cl(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Mo(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){Vi(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function nM(e,t,r,n,a,i){try{n.cellNF&&(e.z=nt[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=rr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(nt[t]==null&&Vi(Xee[t]||"General",t),e.t==="e")e.w=e.w||Fs[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=nf(e.v);else if(e.t==="d"){var s=Hr(e.v);(s|0)===s?e.w=s.toString(10):e.w=nf(s)}else{if(e.v===void 0)return"";e.w=Cl(e.v,Pc)}else e.t==="d"?e.w=Fa(t,Hr(e.v),Pc):e.w=Fa(t,e.v,Pc)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Hh(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Hh(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function Qoe(e,t,r){if(e&&e["!ref"]){var n=At(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Zoe(e,t){var r=At(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=xt(r))}var ele=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,tle=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,rle=/<(?:\w:)?hyperlink [^>]*>/mg,nle=/"(\w*:\w*)"/,ale=/<(?:\w:)?col\b[^>]*[\/]?>/g,ile=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,sle=/<(?:\w:)?pageMargins[^>]*\/>/g,aM=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,ole=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,lle=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function cle(e,t,r,n,a,i,s){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(tle);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var h=u.match(aM);h?uN(h[0],o,a,r):(h=u.match(ole))&&dle(h[0],h[1]||"",o,a,r);var p=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var x=u.slice(p,p+50).match(nle);x&&Zoe(o,x[1])}var g=u.match(lle);g&&g[1]&&kle(g[1],a);var y=[];if(t.cellStyles){var v=u.match(ale);v&&yle(y,v)}f&&Cle(f[1],o,t,c,i,s);var w=d.match(ile);w&&(o["!autofilter"]=wle(w[0]));var b=[],S=d.match(ele);if(S)for(p=0;p!=S.length;++p)b[p]=At(S[p].slice(S[p].indexOf('"')+1));var k=d.match(rle);k&&gle(o,k,n);var _=d.match(sle);if(_&&(o["!margins"]=xle(st(_[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=xt(c)),t.sheetRows>0&&o["!ref"]){var E=At(o["!ref"]);t.sheetRows<=+E.e.r&&(E.e.r=t.sheetRows-1,E.e.r>c.e.r&&(E.e.r=c.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>c.e.c&&(E.e.c=c.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),o["!fullref"]=o["!ref"],o["!ref"]=xt(E))}return y.length>0&&(o["!cols"]=y),b.length>0&&(o["!merges"]=b),o}function ule(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+xt(e[r])+'"/>';return t+"</mergeCells>"}function uN(e,t,r,n){var a=st(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Rt(Wt(a.codeName)))}function dle(e,t,r,n,a){uN(e.slice(0,e.indexOf(">")),r,n,a)}function fle(e,t,r,n,a){var i=!1,s={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,s.codeName=$i(Ut(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+Pe("outlinePr",null,u)}!i&&!o||(a[a.length]=Pe("sheetPr",o,s))}var mle=["objects","scenarios","selectLockedCells","selectUnlockedCells"],hle=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function ple(e){var t={sheet:1};return mle.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),hle.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=nN(e.password).toString(16).toUpperCase()),Pe("sheetProtection",null,t)}function gle(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=st(Wt(t[a]),!0);if(!i.ref)return;var s=((r||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+Rt(i.location))):(i.Target="#"+Rt(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=At(i.ref),c=o.s.r;c<=o.e.r;++c)for(var u=o.s.c;u<=o.e.c;++u){var d=it({c:u,r:c});n?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=i):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=i)}}}function xle(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function vle(e){return cl(e),Pe("pageMargins",null,e)}function yle(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=st(t[n],!0);a.hidden&&(a.hidden=Zt(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,aN(a.width)),wo(a);i<=s;)e[i++]=Vt(a)}}function ble(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Pe("col",null,Eg(a,n)));return r[r.length]="</cols>",r.join("")}function wle(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function Nle(e,t,r,n){var a=typeof e.ref=="string"?e.ref:xt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,s=Xn(a);s.s.r==s.e.r&&(s.e.r=Xn(t["!ref"]).e.r,a=xt(s));for(var o=0;o<i.length;++o){var c=i[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Pe("autoFilter",null,{ref:a})}var Sle=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function kle(e,t){t.Views||(t.Views=[{}]),(e.match(Sle)||[]).forEach(function(r,n){var a=st(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),Zt(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function _le(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Pe("sheetViews",Pe("sheetView",null,a),{})}function Ele(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",i=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=Fs[e.v];break;case"d":n&&n.cellDates?a=rr(e.v,-1).toISOString():(e=Vt(e),e.t="n",a=""+(e.v=Hr(rr(e.v)))),typeof e.z>"u"&&(e.z=nt[14]);break;default:a=e.v;break}var o=fn("v",Ut(a)),c={r:t},u=Mo(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=fn("v",""+cN(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=s),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Pe("f",Ut(e.f),d)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Pe("c",o,c)}var Cle=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=af("v"),s=af("f");return function(c,u,d,f,h,p){for(var x=0,g="",y=[],v=[],w=0,b=0,S=0,k="",_,E,P=0,A=0,T,R,D=0,L=0,z=Array.isArray(p.CellXf),X,Y=[],q=[],ee=Array.isArray(u),V=[],ae={},oe=!1,I=!!d.sheetStubs,W=c.split(t),U=0,G=W.length;U!=G;++U){g=W[U].trim();var ne=g.length;if(ne!==0){var K=0;e:for(x=0;x<ne;++x)switch(g[x]){case">":if(g[x-1]!="/"){++x;break e}if(d&&d.cellStyles){if(E=st(g.slice(K,x),!0),P=E.r!=null?parseInt(E.r,10):P+1,A=-1,d.sheetRows&&d.sheetRows<P)continue;ae={},oe=!1,E.ht&&(oe=!0,ae.hpt=parseFloat(E.ht),ae.hpx=Zc(ae.hpt)),E.hidden=="1"&&(oe=!0,ae.hidden=!0),E.outlineLevel!=null&&(oe=!0,ae.level=+E.outlineLevel),oe&&(V[P-1]=ae)}break;case"<":K=x;break}if(K>=x)break;if(E=st(g.slice(K,x),!0),P=E.r!=null?parseInt(E.r,10):P+1,A=-1,!(d.sheetRows&&d.sheetRows<P)){f.s.r>P-1&&(f.s.r=P-1),f.e.r<P-1&&(f.e.r=P-1),d&&d.cellStyles&&(ae={},oe=!1,E.ht&&(oe=!0,ae.hpt=parseFloat(E.ht),ae.hpx=Zc(ae.hpt)),E.hidden=="1"&&(oe=!0,ae.hidden=!0),E.outlineLevel!=null&&(oe=!0,ae.level=+E.outlineLevel),oe&&(V[P-1]=ae)),y=g.slice(x).split(e);for(var le=0;le!=y.length&&y[le].trim().charAt(0)=="<";++le);for(y=y.slice(le),x=0;x!=y.length;++x)if(g=y[x].trim(),g.length!==0){if(v=g.match(r),w=x,b=0,S=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,v!=null&&v.length===2){for(w=0,k=v[1],b=0;b!=k.length&&!((S=k.charCodeAt(b)-64)<1||S>26);++b)w=26*w+S;--w,A=w}else++A;for(b=0;b!=g.length&&g.charCodeAt(b)!==62;++b);if(++b,E=st(g.slice(0,b),!0),E.r||(E.r=it({r:P-1,c:A})),k=g.slice(b),_={t:""},(v=k.match(i))!=null&&v[1]!==""&&(_.v=Rt(v[1])),d.cellFormula){if((v=k.match(s))!=null&&v[1]!==""){if(_.f=Rt(Wt(v[1])).replace(/\r\n/g,`
`),d.xlfn||(_.f=GE(_.f)),v[0].indexOf('t="array"')>-1)_.F=(k.match(a)||[])[1],_.F.indexOf(":")>-1&&Y.push([At(_.F),_.F]);else if(v[0].indexOf('t="shared"')>-1){R=st(v[0]);var Q=Rt(Wt(v[1]));d.xlfn||(Q=GE(Q)),q[parseInt(R.si,10)]=[R,Q,E.r]}}else(v=k.match(/<f[^>]*\/>/))&&(R=st(v[0]),q[R.si]&&(_.f=Sse(q[R.si][1],q[R.si][2],E.r)));var ce=mr(E.r);for(b=0;b<Y.length;++b)ce.r>=Y[b][0].s.r&&ce.r<=Y[b][0].e.r&&ce.c>=Y[b][0].s.c&&ce.c<=Y[b][0].e.c&&(_.F=Y[b][1])}if(E.t==null&&_.v===void 0)if(_.f||_.F)_.v=0,_.t="n";else if(I)_.t="z";else continue;else _.t=E.t||"n";switch(f.s.c>A&&(f.s.c=A),f.e.c<A&&(f.e.c=A),_.t){case"n":if(_.v==""||_.v==null){if(!I)continue;_.t="z"}else _.v=parseFloat(_.v);break;case"s":if(typeof _.v>"u"){if(!I)continue;_.t="z"}else T=wd[parseInt(_.v,10)],_.v=T.t,_.r=T.r,d.cellHTML&&(_.h=T.h);break;case"str":_.t="s",_.v=_.v!=null?Wt(_.v):"",d.cellHTML&&(_.h=B2(_.v));break;case"inlineStr":v=k.match(n),_.t="s",v!=null&&(T=rN(v[1]))?(_.v=T.t,d.cellHTML&&(_.h=T.h)):_.v="";break;case"b":_.v=Zt(_.v);break;case"d":d.cellDates?_.v=rr(_.v,1):(_.v=Hr(rr(_.v,1)),_.t="n");break;case"e":(!d||d.cellText!==!1)&&(_.w=_.v),_.v=sR[_.v];break}if(D=L=0,X=null,z&&E.s!==void 0&&(X=p.CellXf[E.s],X!=null&&(X.numFmtId!=null&&(D=X.numFmtId),d.cellStyles&&X.fillId!=null&&(L=X.fillId))),nM(_,D,L,d,h,p),d.cellDates&&z&&_.t=="n"&&Bl(nt[D])&&(_.t="d",_.v=wg(_.v)),E.cm&&d.xlmeta){var be=(d.xlmeta.Cell||[])[+E.cm-1];be&&be.type=="XLDAPR"&&(_.D=!0)}if(ee){var j=mr(E.r);u[j.r]||(u[j.r]=[]),u[j.r][j.c]=_}else u[E.r]=_}}}}V.length>0&&(u["!rows"]=V)}}();function Ale(e,t,r,n){var a=[],i=[],s=At(e["!ref"]),o="",c,u="",d=[],f=0,h=0,p=e["!rows"],x=Array.isArray(e),g={r:u},y,v=-1;for(h=s.s.c;h<=s.e.c;++h)d[h]=tr(h);for(f=s.s.r;f<=s.e.r;++f){for(i=[],u=wr(f),h=s.s.c;h<=s.e.c;++h){c=d[h]+u;var w=x?(e[f]||[])[h]:e[c];w!==void 0&&(o=Ele(w,c,e,t))!=null&&i.push(o)}(i.length>0||p&&p[f])&&(g={r:u},p&&p[f]&&(y=p[f],y.hidden&&(g.hidden=1),v=-1,y.hpx?v=ff(y.hpx):y.hpt&&(v=y.hpt),v>-1&&(g.ht=v,g.customHeight=1),y.level&&(g.outlineLevel=y.level)),a[a.length]=Pe("row",i.join(""),g))}if(p)for(;f<p.length;++f)p&&p[f]&&(g={r:f+1},y=p[f],y.hidden&&(g.hidden=1),v=-1,y.hpx?v=ff(y.hpx):y.hpt&&(v=y.hpt),v>-1&&(g.ht=v,g.customHeight=1),y.level&&(g.outlineLevel=y.level),a[a.length]=Pe("row","",g));return a.join("")}function iM(e,t,r,n){var a=[Tr,Pe("worksheet",null,{xmlns:jl[0],"xmlns:r":Ur.r})],i=r.SheetNames[e],s=0,o="",c=r.Sheets[i];c==null&&(c={});var u=c["!ref"]||"A1",d=At(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=xt(d)}n||(n={}),c["!comments"]=[];var f=[];fle(c,r,e,t,a),a[a.length]=Pe("dimension",null,{ref:u}),a[a.length]=_le(c,t,e,r),t.sheetFormat&&(a[a.length]=Pe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=ble(c,c["!cols"])),a[s=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=Ale(c,t),o.length>0&&(a[a.length]=o)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),c["!protect"]&&(a[a.length]=ple(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=Nle(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=ule(c["!merges"]));var h=-1,p,x=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(g){g[1].Target&&(p={ref:g[0]},g[1].Target.charAt(0)!="#"&&(x=jt(n,-1,Ut(g[1].Target).replace(/#.*$/,""),St.HLINK),p["r:id"]="rId"+x),(h=g[1].Target.indexOf("#"))>-1&&(p.location=Ut(g[1].Target.slice(h+1))),g[1].Tooltip&&(p.tooltip=Ut(g[1].Tooltip)),a[a.length]=Pe("hyperlink",null,p))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=vle(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=fn("ignoredErrors",Pe("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(x=jt(n,-1,"../drawings/drawing"+(e+1)+".xml",St.DRAW),a[a.length]=Pe("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=f),c["!comments"].length>0&&(x=jt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",St.VML),a[a.length]=Pe("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function Tle(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function Ple(e,t,r){var n=ge(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=ff(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,h=-1,p=d<<10;p<d+1<<10;++p){u.c=p;var x=Array.isArray(r)?(r[u.r]||[])[u.c]:r[it(u)];x&&(f<0&&(f=p),h=p)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,h))}var g=n.l;return n.l=c,n.write_shift(4,o),n.l=g,n.length>n.l?n.slice(0,n.l):n}function Ole(e,t,r,n){var a=Ple(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&ye(e,0,a)}var Dle=Hl,Rle=Nu;function Mle(){}function Ile(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Bte(e),r}function Fle(e,t,r){r==null&&(r=ge(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return $h({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),tR(e,r),r.slice(0,r.l)}function Lle(e){var t=hi(e);return[t]}function Ble(e,t,r){return r==null&&(r=ge(8)),$l(t,r)}function jle(e){var t=Ul(e);return[t]}function $le(e,t,r){return r==null&&(r=ge(4)),zl(t,r)}function Ule(e){var t=hi(e),r=e.read_shift(1);return[t,r,"b"]}function zle(e,t,r){return r==null&&(r=ge(9)),$l(t,r),r.write_shift(1,e.v?1:0),r}function Hle(e){var t=Ul(e),r=e.read_shift(1);return[t,r,"b"]}function Wle(e,t,r){return r==null&&(r=ge(5)),zl(t,r),r.write_shift(1,e.v?1:0),r}function Gle(e){var t=hi(e),r=e.read_shift(1);return[t,r,"e"]}function Vle(e,t,r){return r==null&&(r=ge(9)),$l(t,r),r.write_shift(1,e.v),r}function Kle(e){var t=Ul(e),r=e.read_shift(1);return[t,r,"e"]}function Xle(e,t,r){return r==null&&(r=ge(8)),zl(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function qle(e){var t=hi(e),r=e.read_shift(4);return[t,r,"s"]}function Yle(e,t,r){return r==null&&(r=ge(12)),$l(t,r),r.write_shift(4,t.v),r}function Jle(e){var t=Ul(e),r=e.read_shift(4);return[t,r,"s"]}function Qle(e,t,r){return r==null&&(r=ge(8)),zl(t,r),r.write_shift(4,t.v),r}function Zle(e){var t=hi(e),r=Tn(e);return[t,r,"n"]}function ece(e,t,r){return r==null&&(r=ge(16)),$l(t,r),Tl(e.v,r),r}function sM(e){var t=Ul(e),r=Tn(e);return[t,r,"n"]}function tce(e,t,r){return r==null&&(r=ge(12)),zl(t,r),Tl(e.v,r),r}function rce(e){var t=hi(e),r=J2(e);return[t,r,"n"]}function nce(e,t,r){return r==null&&(r=ge(12)),$l(t,r),rR(e.v,r),r}function ace(e){var t=Ul(e),r=J2(e);return[t,r,"n"]}function ice(e,t,r){return r==null&&(r=ge(8)),zl(t,r),rR(e.v,r),r}function sce(e){var t=hi(e),r=X2(e);return[t,r,"is"]}function oce(e){var t=hi(e),r=Dn(e);return[t,r,"str"]}function lce(e,t,r){return r==null&&(r=ge(12+4*e.v.length)),$l(t,r),rn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function cce(e){var t=Ul(e),r=Dn(e);return[t,r,"str"]}function uce(e,t,r){return r==null&&(r=ge(8+4*e.v.length)),zl(t,r),rn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function dce(e,t,r){var n=e.l+t,a=hi(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(r.cellFormula){e.l+=2;var o=_g(e,n-e.l,r);s[3]=Sn(o,null,a,r.supbooks,r)}else e.l=n;return s}function fce(e,t,r){var n=e.l+t,a=hi(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(r.cellFormula){e.l+=2;var o=_g(e,n-e.l,r);s[3]=Sn(o,null,a,r.supbooks,r)}else e.l=n;return s}function mce(e,t,r){var n=e.l+t,a=hi(e);a.r=r["!row"];var i=Tn(e),s=[a,i,"n"];if(r.cellFormula){e.l+=2;var o=_g(e,n-e.l,r);s[3]=Sn(o,null,a,r.supbooks,r)}else e.l=n;return s}function hce(e,t,r){var n=e.l+t,a=hi(e);a.r=r["!row"];var i=Dn(e),s=[a,i,"str"];if(r.cellFormula){e.l+=2;var o=_g(e,n-e.l,r);s[3]=Sn(o,null,a,r.supbooks,r)}else e.l=n;return s}var pce=Hl,gce=Nu;function xce(e,t){return t==null&&(t=ge(4)),t.write_shift(4,e),t}function vce(e,t){var r=e.l+t,n=Hl(e),a=q2(e),i=Dn(e),s=Dn(e),o=Dn(e);e.l=r;var c={rfx:n,relId:a,loc:i,display:o};return s&&(c.Tooltip=s),c}function yce(e,t){var r=ge(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Nu({s:mr(e[0]),e:mr(e[0])},r),Y2("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return rn(a||"",r),rn(e[1].Tooltip||"",r),rn("",r),r.slice(0,r.l)}function bce(){}function wce(e,t,r){var n=e.l+t,a=nR(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var o=Goe(e,n-e.l,r);s[1]=o}else e.l=n;return s}function Nce(e,t,r){var n=e.l+t,a=Hl(e),i=[a];if(r.cellFormula){var s=Koe(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}function Sce(e,t,r){r==null&&(r=ge(18));var n=Eg(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var oM=["left","right","top","bottom","header","footer"];function kce(e){var t={};return oM.forEach(function(r){t[r]=Tn(e)}),t}function _ce(e,t){return t==null&&(t=ge(6*8)),cl(e),oM.forEach(function(r){Tl(e[r],t)}),t}function Ece(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Cce(e,t,r){r==null&&(r=ge(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Ace(e){var t=ge(24);return t.write_shift(4,4),t.write_shift(4,1),Nu(e,t),t}function Tce(e,t){return t==null&&(t=ge(16*4+2)),t.write_shift(2,e.password?nN(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Pce(){}function Oce(){}function Dce(e,t,r,n,a,i,s){if(!e)return e;var o=t||{};n||(n={"!id":{}});var c=o.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,p,x,g,y,v,w,b,S,k,_=[];o.biff=12,o["!row"]=0;var E=0,P=!1,A=[],T={},R=o.supbooks||a.supbooks||[[]];if(R.sharedf=T,R.arrayf=A,R.SheetNames=a.SheetNames||a.Sheets.map(function(ee){return ee.name}),!o.supbooks&&(o.supbooks=R,a.Names))for(var D=0;D<a.Names.length;++D)R[0][D+1]=a.Names[D];var L=[],z=[],X=!1;mf[16]={n:"BrtShortReal",f:sM};var Y;if(Is(e,function(V,ae,oe){if(!h)switch(oe){case 148:u=V;break;case 0:p=V,o.sheetRows&&o.sheetRows<=p.r&&(h=!0),S=wr(y=p.r),o["!row"]=p.r,(V.hidden||V.hpt||V.level!=null)&&(V.hpt&&(V.hpx=Zc(V.hpt)),z[V.r]=V);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:V[2]},V[2]){case"n":x.v=V[1];break;case"s":b=wd[V[1]],x.v=b.t,x.r=b.r;break;case"b":x.v=!!V[1];break;case"e":x.v=V[1],o.cellText!==!1&&(x.w=Fs[x.v]);break;case"str":x.t="s",x.v=V[1];break;case"is":x.t="s",x.v=V[1].t;break}if((g=s.CellXf[V[0].iStyleRef])&&nM(x,g.numFmtId,null,o,i,s),v=V[0].c==-1?v+1:V[0].c,o.dense?(c[y]||(c[y]=[]),c[y][v]=x):c[tr(v)+S]=x,o.cellFormula){for(P=!1,E=0;E<A.length;++E){var I=A[E];p.r>=I[0].s.r&&p.r<=I[0].e.r&&v>=I[0].s.c&&v<=I[0].e.c&&(x.F=xt(I[0]),P=!0)}!P&&V.length>3&&(x.f=V[3])}if(d.s.r>p.r&&(d.s.r=p.r),d.s.c>v&&(d.s.c=v),d.e.r<p.r&&(d.e.r=p.r),d.e.c<v&&(d.e.c=v),o.cellDates&&g&&x.t=="n"&&Bl(nt[g.numFmtId])){var W=Ys(x.v);W&&(x.t="d",x.v=new Date(W.y,W.m-1,W.d,W.H,W.M,W.S,W.u))}Y&&(Y.type=="XLDAPR"&&(x.D=!0),Y=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;x={t:"z",v:void 0},v=V[0].c==-1?v+1:V[0].c,o.dense?(c[y]||(c[y]=[]),c[y][v]=x):c[tr(v)+S]=x,d.s.r>p.r&&(d.s.r=p.r),d.s.c>v&&(d.s.c=v),d.e.r<p.r&&(d.e.r=p.r),d.e.c<v&&(d.e.c=v),Y&&(Y.type=="XLDAPR"&&(x.D=!0),Y=void 0);break;case 176:_.push(V);break;case 49:Y=((o.xlmeta||{}).Cell||[])[V-1];break;case 494:var U=n["!id"][V.relId];for(U?(V.Target=U.Target,V.loc&&(V.Target+="#"+V.loc),V.Rel=U):V.relId==""&&(V.Target="#"+V.loc),y=V.rfx.s.r;y<=V.rfx.e.r;++y)for(v=V.rfx.s.c;v<=V.rfx.e.c;++v)o.dense?(c[y]||(c[y]=[]),c[y][v]||(c[y][v]={t:"z",v:void 0}),c[y][v].l=V):(w=it({c:v,r:y}),c[w]||(c[w]={t:"z",v:void 0}),c[w].l=V);break;case 426:if(!o.cellFormula)break;A.push(V),k=o.dense?c[y][v]:c[tr(v)+S],k.f=Sn(V[1],d,{r:p.r,c:v},R,o),k.F=xt(V[0]);break;case 427:if(!o.cellFormula)break;T[it(V[0].s)]=V[1],k=o.dense?c[y][v]:c[tr(v)+S],k.f=Sn(V[1],d,{r:p.r,c:v},R,o);break;case 60:if(!o.cellStyles)break;for(;V.e>=V.s;)L[V.e--]={width:V.w/256,hidden:!!(V.flags&1),level:V.level},X||(X=!0,aN(V.w/256)),wo(L[V.e+1]);break;case 161:c["!autofilter"]={ref:xt(V)};break;case 476:c["!margins"]=V;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),V.name&&(a.Sheets[r].CodeName=V.name),(V.above||V.left)&&(c["!outline"]={above:V.above,left:V.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),V.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!ae.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+oe.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=xt(u||d)),o.sheetRows&&c["!ref"]){var q=At(c["!ref"]);o.sheetRows<=+q.e.r&&(q.e.r=o.sheetRows-1,q.e.r>d.e.r&&(q.e.r=d.e.r),q.e.r<q.s.r&&(q.s.r=q.e.r),q.e.c>d.e.c&&(q.e.c=d.e.c),q.e.c<q.s.c&&(q.s.c=q.e.c),c["!fullref"]=c["!ref"],c["!ref"]=xt(q))}return _.length>0&&(c["!merges"]=_),L.length>0&&(c["!cols"]=L),z.length>0&&(c["!rows"]=z),c}function Rce(e,t,r,n,a,i,s){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Vt(t),t.z=t.z||nt[14],t.v=Hr(rr(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:n};switch(c.s=Mo(a.cellXfs,t,a),t.l&&i["!links"].push([it(c),t.l]),t.c&&i["!comments"].push([it(c),t.c]),t.t){case"s":case"str":return a.bookSST?(o=cN(a.Strings,t.v,a.revStrings),c.t="s",c.v=o,s?ye(e,18,Qle(t,c)):ye(e,7,Yle(t,c))):(c.t="str",s?ye(e,17,uce(t,c)):ye(e,6,lce(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?ye(e,13,ice(t,c)):ye(e,2,nce(t,c)):s?ye(e,16,tce(t,c)):ye(e,5,ece(t,c)),!0;case"b":return c.t="b",s?ye(e,15,Wle(t,c)):ye(e,4,zle(t,c)),!0;case"e":return c.t="e",s?ye(e,14,Xle(t,c)):ye(e,3,Vle(t,c)),!0}return s?ye(e,12,$le(t,c)):ye(e,1,Ble(t,c)),!0}function Mce(e,t,r,n){var a=At(t["!ref"]||"A1"),i,s="",o=[];ye(e,145);var c=Array.isArray(t),u=a.e.r;t["!rows"]&&(u=Math.max(a.e.r,t["!rows"].length-1));for(var d=a.s.r;d<=u;++d){s=wr(d),Ole(e,t,a,d);var f=!1;if(d<=a.e.r)for(var h=a.s.c;h<=a.e.c;++h){d===a.s.r&&(o[h]=tr(h)),i=o[h]+s;var p=c?(t[d]||[])[h]:t[i];if(!p){f=!1;continue}f=Rce(e,p,d,h,n,t,f)}}ye(e,146)}function Ice(e,t){!t||!t["!merges"]||(ye(e,177,xce(t["!merges"].length)),t["!merges"].forEach(function(r){ye(e,176,gce(r))}),ye(e,178))}function Fce(e,t){!t||!t["!cols"]||(ye(e,390),t["!cols"].forEach(function(r,n){r&&ye(e,60,Sce(n,r))}),ye(e,391))}function Lce(e,t){!t||!t["!ref"]||(ye(e,648),ye(e,649,Ace(At(t["!ref"]))),ye(e,650))}function Bce(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=jt(r,-1,n[1].Target.replace(/#.*$/,""),St.HLINK);ye(e,494,yce(n,a))}}),delete t["!links"]}function jce(e,t,r,n){if(t["!comments"].length>0){var a=jt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",St.VML);ye(e,551,Y2("rId"+a)),t["!legacy"]=a}}function $ce(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:xt(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=Xn(i);o.s.r==o.e.r&&(o.e.r=Xn(t["!ref"]).e.r,i=xt(o));for(var c=0;c<s.length;++c){var u=s[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+i;break}}c==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),ye(e,161,Nu(At(i))),ye(e,162)}}function Uce(e,t,r){ye(e,133),ye(e,137,Cce(t,r)),ye(e,138),ye(e,134)}function zce(e,t){t["!protect"]&&ye(e,535,Tce(t["!protect"]))}function Hce(e,t,r,n){var a=ca(),i=r.SheetNames[e],s=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=At(s["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],ye(a,129),(r.vbaraw||s["!outline"])&&ye(a,147,Fle(o,s["!outline"])),ye(a,148,Rle(c)),Uce(a,s,r.Workbook),Fce(a,s),Mce(a,s,e,t),zce(a,s),$ce(a,s,r,e),Ice(a,s),Bce(a,s,n),s["!margins"]&&ye(a,476,_ce(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Lce(a,s),jce(a,s,e,n),ye(a,130),a.end()}function Wce(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=r?+s[2]:s[2])});var a=Rt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function Gce(e,t,r,n,a,i){var s=i||{"!type":"chart"};if(!e)return i;var o=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=Wce(f);d.s.r=d.s.c=0,d.e.c=o,u=tr(o),h[0].forEach(function(p,x){s[u+wr(x)]={t:"n",v:p,z:h[1]},c=x}),d.e.r<c&&(d.e.r=c),++o}),o>0&&(s["!ref"]=xt(d)),s}function Vce(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,o=e.match(aM);return o&&uN(o[0],i,a,r),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function Kce(e,t){e.l+=10;var r=Dn(e);return{name:r}}function Xce(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=!1;return Is(e,function(c,u,d){switch(d){case 550:i["!rel"]=c;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),c.name&&(a.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var dN=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],qce=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Yce=[],Jce=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function YE(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Zt(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function JE(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Zt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function lM(e){JE(e.WBProps,dN),JE(e.CalcPr,Jce),YE(e.WBView,qce),YE(e.Sheets,Yce),Pc.date1904=Zt(e.WBProps.date1904)}function Qce(e){return!e.Workbook||!e.Workbook.WBProps?"false":Zt(e.Workbook.WBProps.date1904)?"true":"false"}var Zce="][*?/\\".split("");function cM(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return Zce.forEach(function(n){if(e.indexOf(n)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}function eue(e,t,r){e.forEach(function(n,a){cM(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[a]&&t[a].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function uM(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];eue(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Qoe(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var tue=/<\w+:workbook/;function rue(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},s=0;if(e.replace(Fn,function(c,u){var d=st(c);switch(Ji(d[0])){case"<?xml":break;case"<workbook":c.match(tue)&&(a="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[a];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":dN.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Zt(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=Wt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Rt(Wt(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Wt(d.name),d.comment&&(i.Comment=d.comment),d.localSheetId&&(i.Sheet=+d.localSheetId),Zt(d.hidden||"0")&&(i.Hidden=!0),s=u+c.length;break;case"</definedName>":i.Ref=Rt(Wt(e.slice(s,u))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),jl.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return lM(r),r}function dM(e){var t=[Tr];t[t.length]=Pe("workbook",null,{xmlns:jl[0],"xmlns:r":Ur.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(dN.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Pe("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:Ut(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=Pe("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=Pe("definedName",Ut(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function nue(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=qy(e),r.name=Dn(e),r}function aue(e,t){return t||(t=ge(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Y2(e.strRelID,t),rn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function iue(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Dn(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function sue(e,t){t||(t=ge(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),tR(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function oue(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function lue(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=jte(e),s=Voe(e,0,r),o=q2(e);e.l=n;var c={Name:i,Ptg:s};return a<268435455&&(c.Sheet=a),o&&(c.Comment=o),c}function cue(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],mf[16]={n:"BrtFRTArchID$",f:oue},Is(e,function(c,u,d){switch(d){case 156:s.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Sn(c.Ptg,null,null,s,t),delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([d,c]):s[0]=[d,c],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(c),s.XTI=s.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(d),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!u.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),lM(r),r.Names=i,r.supbooks=s,r}function uue(e,t){ye(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ye(e,156,aue(a))}ye(e,144)}function due(e,t){t||(t=ge(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return rn("SheetJS",t),rn(tf.version,t),rn(tf.version,t),rn("7262",t),t.length>t.l?t.slice(0,t.l):t}function fue(e,t){t||(t=ge(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function mue(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(ye(e,135),ye(e,158,fue(a)),ye(e,136))}}function hue(e,t){var r=ca();return ye(r,131),ye(r,128,due()),ye(r,153,sue(e.Workbook&&e.Workbook.WBProps||null)),mue(r,e),uue(r,e),ye(r,132),r.end()}function pue(e,t,r){return t.slice(-4)===".bin"?cue(e,r):rue(e,r)}function gue(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?Dce(e,n,r,a,i,s,o):cle(e,n,r,a,i,s,o)}function xue(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?Xce(e,n,r,a,i):Vce(e,n,r,a,i)}function vue(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?wse():Nse()}function yue(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?yse():bse()}function bue(e,t,r,n){return t.slice(-4)===".bin"?gie(e,r,n):aie(e,r,n)}function wue(e,t,r){return WR(e,r)}function Nue(e,t,r){return t.slice(-4)===".bin"?Sae(e,r):bae(e,r)}function Sue(e,t,r){return t.slice(-4)===".bin"?hse(e,r):ise(e,r)}function kue(e,t,r){return t.slice(-4)===".bin"?rse(e):ese(e)}function _ue(e,t,r,n){return r.slice(-4)===".bin"?nse(e,t,r,n):void 0}function Eue(e,t,r){return t.slice(-4)===".bin"?Jie(e,t,r):Zie(e,t,r)}function Cue(e,t,r){return(t.slice(-4)===".bin"?hue:dM)(e)}function Aue(e,t,r,n,a){return(t.slice(-4)===".bin"?Hce:iM)(e,r,n,a)}function Tue(e,t,r){return(t.slice(-4)===".bin"?Eie:zR)(e,r)}function Pue(e,t,r){return(t.slice(-4)===".bin"?Eae:MR)(e,r)}function Oue(e,t,r){return(t.slice(-4)===".bin"?pse:KR)(e)}function Due(e){return(e.slice(-4)===".bin"?Qie:GR)()}var fM=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,mM=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function gi(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),r.length===1)return n;var a=e.match(fM),i,s,o,c;if(a)for(c=0;c!=a.length;++c)i=a[c].match(mM),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),n[o]=i[2].slice(1,i[2].length-1));return n}function Rue(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(fM),a,i,s,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(mM),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(i+1),r[s]=a[2].slice(1,a[2].length-1));return r}var Sd;function Mue(e,t){var r=Sd[e]||Rt(e);return r==="General"?Cl(t):Fa(r,t)}function Iue(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Zt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=rr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Rt(t)]=a}function Fue(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Fs[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=nf(e.v):e.w=Cl(e.v):e.w=Mue(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=Sd[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Bl(n)){var a=Ys(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function Lue(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=Yae[n.Pattern]||n.Pattern)}e[t.ID]=t}function Bue(e,t,r,n,a,i,s,o,c,u){var d="General",f=n.StyleID,h={};u=u||{};var p=[],x=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&s&&(f=s.StyleID);i[f]!==void 0&&(i[f].nf&&(d=i[f].nf),i[f].Interior&&p.push(i[f].Interior),!!i[f].Parent);)f=i[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Zt(e);break;case"String":n.t="s",n.r=hE(Rt(e)),n.v=e.indexOf("<")>-1?Rt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(rr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Rt(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=sR[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=hE(t||e));break}if(Fue(n,d,u),u.cellFormula!==!1)if(n.Formula){var g=Rt(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=Tc(g,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Tc("RC:RC",a):n.ArrayRange&&(n.F=Tc(n.ArrayRange,a),c.push([At(n.F),n.F]))}else for(x=0;x<c.length;++x)a.r>=c[x][0].s.r&&a.r<=c[x][0].e.r&&a.c>=c[x][0].s.c&&a.c<=c[x][0].e.c&&(n.F=c[x][1]);u.cellStyles&&(p.forEach(function(y){!h.patternType&&y.patternType&&(h.patternType=y.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function jue(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Hx(e,t){var r=t||{};yu();var n=gc(j2(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(typeof Pt<"u"?n=Pt.utils.decode(65001,Rh(n)):n=Wt(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var s=Vt(r);return s.type="string",Qc.to_workbook(n,s)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(de){a.indexOf("<"+de)>=0&&(i=!0)}),i)return wde(n,r);Sd={"General Number":"General","General Date":nt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":nt[15],"Short Date":nt[14],"Long Time":nt[19],"Medium Time":nt[18],"Short Time":nt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:nt[2],Standard:nt[4],Percent:nt[10],Scientific:nt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],u,d={},f=[],h=r.dense?[]:{},p="",x={},g={},y=gi('<Data ss:Type="String">'),v=0,w=0,b=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},k={},_={},E="",P=0,A=[],T={},R={},D=0,L=[],z=[],X={},Y=[],q,ee=!1,V=[],ae=[],oe={},I=0,W=0,U={Sheets:[],WBProps:{date1904:!1}},G={};of.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ne="";o=of.exec(n);)switch(o[3]=(ne=o[3]).toLowerCase()){case"data":if(ne=="data"){if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?Bue(n.slice(v,o.index),E,y,c[c.length-1][0]=="comment"?X:x,{c:w,r:b},k,Y[w],g,V,r):(E="",y=gi(o[0]),v=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(z.length>0&&(x.c=z),(!r.sheetRows||r.sheetRows>b)&&x.v!==void 0&&(r.dense?(h[b]||(h[b]=[]),h[b][w]=x):h[tr(w)+wr(b)]=x),x.HRef&&(x.l={Target:Rt(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(I=w+(parseInt(x.MergeAcross,10)|0),W=b+(parseInt(x.MergeDown,10)|0),A.push({s:{c:w,r:b},e:{c:I,r:W}})),!r.sheetStubs)x.MergeAcross?w=I+1:++w;else if(x.MergeAcross||x.MergeDown){for(var K=w;K<=I;++K)for(var le=b;le<=W;++le)(K>w||le>b)&&(r.dense?(h[le]||(h[le]=[]),h[le][K]={t:"z"}):h[tr(K)+wr(le)]={t:"z"});w=I+1}else++w;else x=Rue(o[0]),x.Index&&(w=+x.Index-1),w<S.s.c&&(S.s.c=w),w>S.e.c&&(S.e.c=w),o[0].slice(-2)==="/>"&&++w,z=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(b<S.s.r&&(S.s.r=b),b>S.e.r&&(S.e.r=b),o[0].slice(-2)==="/>"&&(g=gi(o[0]),g.Index&&(b=+g.Index-1)),w=0,++b):(g=gi(o[0]),g.Index&&(b=+g.Index-1),oe={},(g.AutoFitHeight=="0"||g.Height)&&(oe.hpx=parseInt(g.Height,10),oe.hpt=ff(oe.hpx),ae[b]=oe),g.Hidden=="1"&&(oe.hidden=!0,ae[b]=oe));break;case"worksheet":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));f.push(p),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(h["!ref"]=xt(S),r.sheetRows&&r.sheetRows<=S.e.r&&(h["!fullref"]=h["!ref"],S.e.r=r.sheetRows-1,h["!ref"]=xt(S))),A.length&&(h["!merges"]=A),Y.length>0&&(h["!cols"]=Y),ae.length>0&&(h["!rows"]=ae),d[p]=h}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=w=0,c.push([o[3],!1]),u=gi(o[0]),p=Rt(u.Name),h=r.dense?[]:{},A=[],V=[],ae=[],G={name:p,Hidden:0},U.Sheets.push(G);break;case"table":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),Y=[],ee=!1}break;case"style":o[1]==="/"?Lue(k,_,r):_=gi(o[0]);break;case"numberformat":_.nf=Rt(gi(o[0]).Format||"General"),Sd[_.nf]&&(_.nf=Sd[_.nf]);for(var Q=0;Q!=392&&nt[Q]!=_.nf;++Q);if(Q==392){for(Q=57;Q!=392;++Q)if(nt[Q]==null){Vi(_.nf,Q);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(q=gi(o[0]),q.Hidden&&(q.hidden=!0,delete q.Hidden),q.Width&&(q.wpx=parseInt(q.Width,10)),!ee&&q.wpx>10){ee=!0,En=$R;for(var ce=0;ce<Y.length;++ce)Y[ce]&&wo(Y[ce])}ee&&wo(q),Y[q.Index-1||Y.length]=q;for(var be=0;be<+q.Span;++be)Y[Y.length]=Vt(q);break;case"namedrange":if(o[1]==="/")break;U.Names||(U.Names=[]);var j=st(o[0]),$e={Name:j.Name,Ref:Tc(j.RefersTo.slice(1),{r:0,c:0})};U.Sheets.length>0&&($e.Sheet=U.Sheets.length-1),U.Names.push($e);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?E+=n.slice(P,o.index):P=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;_.Interior=gi(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?ure(T,ne,n.slice(D,o.index)):D=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));jue(X),z.push(X)}else c.push([o[3],!1]),u=gi(o[0]),X={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ee=gi(o[0]);h["!autofilter"]={ref:Tc(Ee.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return rC(n,r);var Ae=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ae=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ae=!1}break;case"excelworkbook":switch(o[3]){case"date1904":U.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ae=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ae=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(D,o.index)){case"SheetHidden":G.Hidden=1;break;case"SheetVeryHidden":G.Hidden=2;break}else D=o.index+o[0].length;break;case"header":h["!margins"]||cl(h["!margins"]={},"xlml"),isNaN(+st(o[0]).Margin)||(h["!margins"].header=+st(o[0]).Margin);break;case"footer":h["!margins"]||cl(h["!margins"]={},"xlml"),isNaN(+st(o[0]).Margin)||(h["!margins"].footer=+st(o[0]).Margin);break;case"pagemargins":var Be=st(o[0]);h["!margins"]||cl(h["!margins"]={},"xlml"),isNaN(+Be.Top)||(h["!margins"].top=+Be.Top),isNaN(+Be.Left)||(h["!margins"].left=+Be.Left),isNaN(+Be.Right)||(h["!margins"].right=+Be.Right),isNaN(+Be.Bottom)||(h["!margins"].bottom=+Be.Bottom);break;case"displayrighttoleft":U.Views||(U.Views=[]),U.Views[0]||(U.Views[0]={}),U.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ae=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ae=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ae=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ae=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ae=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ae=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ae=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ae=!1}break;case"smarttags":break;default:Ae=!1;break}if(Ae||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?Iue(R,ne,L,n.slice(D,o.index)):(L=o,D=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var we={};return!r.bookSheets&&!r.bookProps&&(we.Sheets=d),we.SheetNames=f,we.Workbook=U,we.SSF=Vt(nt),we.Props=T,we.Custprops=R,we}function r1(e,t){switch(hN(t=t||{}),t.type||"base64"){case"base64":return Hx(Ia(e),t);case"binary":case"buffer":case"file":return Hx(e,t);case"array":return Hx(Do(e),t)}}function $ue(e,t){var r=[];return e.Props&&r.push(dre(e.Props,t)),e.Custprops&&r.push(fre(e.Props,e.Custprops)),r.join("")}function Uue(){return""}function zue(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(Pe("NumberFormat",null,{"ss:Format":Ut(nt[n.numFmtId])}));var s={"ss:ID":"s"+(21+a)};r.push(Pe("Style",i.join(""),s))}),Pe("Styles",r.join(""))}function hM(e){return Pe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+oN(e.Ref,{r:0,c:0})})}function Hue(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(hM(a)))}return Pe("Names",r.join(""))}function Wue(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],s=0;s<a.length;++s){var o=a[s];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(hM(o)))}return i.join("")}function Gue(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Pe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Pe("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Pe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Pe("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(fn("ProtectContents","True")),e["!protect"].objects&&a.push(fn("ProtectObjects","True")),e["!protect"].scenarios&&a.push(fn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(fn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(fn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&a.push("<"+s[1]+"/>")})),a.length==0?"":Pe("WorksheetOptions",a.join(""),{xmlns:va.x})}function Vue(e){return e.map(function(t){var r=hte(t.t||""),n=Pe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Pe("Comment",n,{"ss:Author":t.a})}).join("")}function Kue(e,t,r,n,a,i,s){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Ut(oN(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var c=mr(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==s.r?"":"["+(c.r-s.r)+"]")+"C"+(c.c==s.c?"":"["+(c.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Ut(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Ut(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=s.c||u[d].s.r!=s.r||(u[d].e.c>u[d].s.c&&(o["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(o["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=Fs[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||nt[14]);break;case"s":f="String",h=mte(e.v||"");break}var p=Mo(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=s.c+1;var x=e.v!=null?h:"",g=e.t=="z"?"":'<Data ss:Type="'+f+'">'+x+"</Data>";return(e.c||[]).length>0&&(g+=Vue(e.c)),Pe("Cell",g,o)}function Xue(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Zc(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function que(e,t,r,n){if(!e["!ref"])return"";var a=At(e["!ref"]),i=e["!merges"]||[],s=0,o=[];e["!cols"]&&e["!cols"].forEach(function(y,v){wo(y);var w=!!y.width,b=Eg(v,y),S={"ss:Index":v+1};w&&(S["ss:Width"]=uf(b.width)),y.hidden&&(S["ss:Hidden"]="1"),o.push(Pe("Column",null,S))});for(var c=Array.isArray(e),u=a.s.r;u<=a.e.r;++u){for(var d=[Xue(u,(e["!rows"]||[])[u])],f=a.s.c;f<=a.e.c;++f){var h=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>f)&&!(i[s].s.r>u)&&!(i[s].e.c<f)&&!(i[s].e.r<u)){(i[s].s.c!=f||i[s].s.r!=u)&&(h=!0);break}if(!h){var p={r:u,c:f},x=it(p),g=c?(e[u]||[])[f]:e[x];d.push(Kue(g,x,e,t,r,n,p))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function Yue(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],s=i?Wue(i,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=i?que(i,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(Gue(i,t,e,r)),n.join("")}function Jue(e,t){t||(t={}),e.SSF||(e.SSF=Vt(nt)),e.SSF&&(yu(),Vf(e.SSF),t.revssf=bg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Mo(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push($ue(e,t)),r.push(Uue()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Pe("Worksheet",Yue(n,t,e),{"ss:Name":Ut(e.SheetNames[n])}));return r[2]=zue(e,t),r[3]=Hue(e),Tr+Pe("Workbook",r.join(""),{xmlns:va.ss,"xmlns:o":va.o,"xmlns:x":va.x,"xmlns:ss":va.ss,"xmlns:dt":va.dt,"xmlns:html":va.html})}function Que(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Wte(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=Gte(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Zue=[60,1084,2066,2165,2175];function ede(e,t,r,n,a){var i=n,s=[],o=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}s.push(o),r.l+=i;for(var c=ds(r,r.l),u=n1[c],d=0;u!=null&&Zue.indexOf(c)>-1;)i=ds(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),o=r.slice(d,r.l+4+i),s.push(o),r.l+=4+i,u=n1[c=ds(r,r.l)];var f=en(s);dn(f,0);var h=0;f.lens=[];for(var p=0;p<s.length;++p)f.lens.push(h),h+=s[p].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,a)}function Mi(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=nt[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Fs[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=nf(e.v):e.w=Cl(e.v):e.w=Fa(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&Bl(nt[n]||String(n))){var a=Ys(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function G0(e,t,r){return{v:e,ixfe:t,t:r}}function tde(e,t){var r={opts:{}},n={},a=t.dense?[]:{},i={},s={},o=null,c=[],u="",d={},f,h="",p,x,g,y,v={},w=[],b,S,k=[],_=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},P={},A=function(tt){return tt<8?sl[tt]:tt<64&&_[tt-8]||sl[tt]},T=function(tt,kt,Lt){var xe=kt.XF.data;if(!(!xe||!xe.patternType||!Lt||!Lt.cellStyles)){kt.s={},kt.s.patternType=xe.patternType;var Ie;(Ie=cf(A(xe.icvFore)))&&(kt.s.fgColor={rgb:Ie}),(Ie=cf(A(xe.icvBack)))&&(kt.s.bgColor={rgb:Ie})}},R=function(tt,kt,Lt){if(!(oe>1)&&!(Lt.sheetRows&&tt.r>=Lt.sheetRows)){if(Lt.cellStyles&&kt.XF&&kt.XF.data&&T(tt,kt,Lt),delete kt.ixfe,delete kt.XF,f=tt,h=it(tt),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),tt.r<s.s.r&&(s.s.r=tt.r),tt.c<s.s.c&&(s.s.c=tt.c),tt.r+1>s.e.r&&(s.e.r=tt.r+1),tt.c+1>s.e.c&&(s.e.c=tt.c+1),Lt.cellFormula&&kt.f){for(var xe=0;xe<w.length;++xe)if(!(w[xe][0].s.c>tt.c||w[xe][0].s.r>tt.r)&&!(w[xe][0].e.c<tt.c||w[xe][0].e.r<tt.r)){kt.F=xt(w[xe][0]),(w[xe][0].s.c!=tt.c||w[xe][0].s.r!=tt.r)&&delete kt.f,kt.f&&(kt.f=""+Sn(w[xe][1],s,tt,V,D));break}}Lt.dense?(a[tt.r]||(a[tt.r]=[]),a[tt.r][tt.c]=kt):a[h]=kt}},D={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(D.password=t.password);var L,z=[],X=[],Y=[],q=[],ee=!1,V=[];V.SheetNames=D.snames,V.sharedf=D.sharedf,V.arrayf=D.arrayf,V.names=[],V.XTI=[];var ae=0,oe=0,I=0,W=[],U=[],G;D.codepage=1200,ai(1200);for(var ne=!1;e.l<e.length-1;){var K=e.l,le=e.read_shift(2);if(le===0&&ae===10)break;var Q=e.l===e.length?0:e.read_shift(2),ce=n1[le];if(ce&&ce.f){if(t.bookSheets&&ae===133&&le!==133)break;if(ae=le,ce.r===2||ce.r==12){var be=e.read_shift(2);if(Q-=2,!D.enc&&be!==le&&((be&255)<<8|be>>8)!==le)throw new Error("rt mismatch: "+be+"!="+le);ce.r==12&&(e.l+=10,Q-=10)}var j={};if(le===10?j=ce.f(e,Q,D):j=ede(le,ce,e,Q,D),oe==0&&[9,521,1033,2057].indexOf(ae)===-1)continue;switch(le){case 34:r.opts.Date1904=E.WBProps.date1904=j;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(e.l=0),D.enc=j,!t.password)throw new Error("File is password-protected");if(j.valid==null)throw new Error("Encryption scheme unsupported");if(!j.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=j;break;case 66:var $e=Number(j);switch($e){case 21010:$e=1200;break;case 32768:$e=1e4;break;case 32769:$e=1252;break}ai(D.codepage=$e),ne=!0;break;case 317:D.rrtabid=j;break;case 25:D.winlocked=j;break;case 439:r.opts.RefreshAll=j;break;case 12:r.opts.CalcCount=j;break;case 16:r.opts.CalcDelta=j;break;case 17:r.opts.CalcIter=j;break;case 13:r.opts.CalcMode=j;break;case 14:r.opts.CalcPrecision=j;break;case 95:r.opts.CalcSaveRecalc=j;break;case 15:D.CalcRefMode=j;break;case 2211:r.opts.FullCalc=j;break;case 129:j.fDialog&&(a["!type"]="dialog"),j.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),j.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:k.push(j);break;case 430:V.push([j]),V[V.length-1].XTI=[];break;case 35:case 547:V[V.length-1].push(j);break;case 24:case 536:G={Name:j.Name,Ref:Sn(j.rgce,s,null,V,D)},j.itab>0&&(G.Sheet=j.itab-1),V.names.push(G),V[0]||(V[0]=[],V[0].XTI=[]),V[V.length-1].push(j),j.Name=="_xlnm._FilterDatabase"&&j.itab>0&&j.rgce&&j.rgce[0]&&j.rgce[0][0]&&j.rgce[0][0][0]=="PtgArea3d"&&(U[j.itab-1]={ref:xt(j.rgce[0][0][1][2])});break;case 22:D.ExternCount=j;break;case 23:V.length==0&&(V[0]=[],V[0].XTI=[]),V[V.length-1].XTI=V[V.length-1].XTI.concat(j),V.XTI=V.XTI.concat(j);break;case 2196:if(D.biff<8)break;G!=null&&(G.Comment=j[1]);break;case 18:a["!protect"]=j;break;case 19:j!==0&&D.WTF&&console.error("Password verifier: "+j);break;case 133:i[j.pos]=j,D.snames.push(j.name);break;case 10:{if(--oe)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=xt(s),t.sheetRows&&t.sheetRows<=s.e.r){var Ee=s.e.r;s.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=xt(s),s.e.r=Ee}s.e.r++,s.e.c++}z.length>0&&(a["!merges"]=z),X.length>0&&(a["!objects"]=X),Y.length>0&&(a["!cols"]=Y),q.length>0&&(a["!rows"]=q),E.Sheets.push(P)}u===""?d=a:n[u]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[le]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[j.BIFFVer]||8),D.biffguess=j.BIFFVer==0,j.BIFFVer==0&&j.dt==4096&&(D.biff=5,ne=!0,ai(D.codepage=28591)),D.biff==8&&j.BIFFVer==0&&j.dt==16&&(D.biff=2),oe++)break;if(a=t.dense?[]:{},D.biff<8&&!ne&&(ne=!0,ai(D.codepage=t.codepage||1252)),D.biff<5||j.BIFFVer==0&&j.dt==4096){u===""&&(u="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var Ae={pos:e.l-Q,name:u};i[Ae.pos]=Ae,D.snames.push(u)}else u=(i[K]||{name:""}).name;j.dt==32&&(a["!type"]="chart"),j.dt==64&&(a["!type"]="macro"),z=[],X=[],D.arrayf=w=[],Y=[],q=[],ee=!1,P={Hidden:(i[K]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[j.r]||[])[j.c]:a[it({c:j.c,r:j.r})])&&++j.c,b={ixfe:j.ixfe,XF:k[j.ixfe]||{},v:j.val,t:"n"},I>0&&(b.z=W[b.ixfe>>8&63]),Mi(b,t,r.opts.Date1904),R({c:j.c,r:j.r},b,t);break;case 5:case 517:b={ixfe:j.ixfe,XF:k[j.ixfe],v:j.val,t:j.t},I>0&&(b.z=W[b.ixfe>>8&63]),Mi(b,t,r.opts.Date1904),R({c:j.c,r:j.r},b,t);break;case 638:b={ixfe:j.ixfe,XF:k[j.ixfe],v:j.rknum,t:"n"},I>0&&(b.z=W[b.ixfe>>8&63]),Mi(b,t,r.opts.Date1904),R({c:j.c,r:j.r},b,t);break;case 189:for(var Be=j.c;Be<=j.C;++Be){var we=j.rkrec[Be-j.c][0];b={ixfe:we,XF:k[we],v:j.rkrec[Be-j.c][1],t:"n"},I>0&&(b.z=W[b.ixfe>>8&63]),Mi(b,t,r.opts.Date1904),R({c:Be,r:j.r},b,t)}break;case 6:case 518:case 1030:{if(j.val=="String"){o=j;break}if(b=G0(j.val,j.cell.ixfe,j.tt),b.XF=k[b.ixfe],t.cellFormula){var de=j.formula;if(de&&de[0]&&de[0][0]&&de[0][0][0]=="PtgExp"){var Ge=de[0][0][1][0],et=de[0][0][1][1],Qe=it({r:Ge,c:et});v[Qe]?b.f=""+Sn(j.formula,s,j.cell,V,D):b.F=((t.dense?(a[Ge]||[])[et]:a[Qe])||{}).F}else b.f=""+Sn(j.formula,s,j.cell,V,D)}I>0&&(b.z=W[b.ixfe>>8&63]),Mi(b,t,r.opts.Date1904),R(j.cell,b,t),o=j}break;case 7:case 519:if(o)o.val=j,b=G0(j,o.cell.ixfe,"s"),b.XF=k[b.ixfe],t.cellFormula&&(b.f=""+Sn(o.formula,s,o.cell,V,D)),I>0&&(b.z=W[b.ixfe>>8&63]),Mi(b,t,r.opts.Date1904),R(o.cell,b,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(j);var te=it(j[0].s);if(p=t.dense?(a[j[0].s.r]||[])[j[0].s.c]:a[te],t.cellFormula&&p){if(!o||!te||!p)break;p.f=""+Sn(j[1],s,j[0],V,D),p.F=xt(j[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;v[it(o.cell)]=j[0],p=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[it(o.cell)],(p||{}).f=""+Sn(j[0],s,f,V,D)}}break;case 253:b=G0(c[j.isst].t,j.ixfe,"s"),c[j.isst].h&&(b.h=c[j.isst].h),b.XF=k[b.ixfe],I>0&&(b.z=W[b.ixfe>>8&63]),Mi(b,t,r.opts.Date1904),R({c:j.c,r:j.r},b,t);break;case 513:t.sheetStubs&&(b={ixfe:j.ixfe,XF:k[j.ixfe],t:"z"},I>0&&(b.z=W[b.ixfe>>8&63]),Mi(b,t,r.opts.Date1904),R({c:j.c,r:j.r},b,t));break;case 190:if(t.sheetStubs)for(var De=j.c;De<=j.C;++De){var ze=j.ixfe[De-j.c];b={ixfe:ze,XF:k[ze],t:"z"},I>0&&(b.z=W[b.ixfe>>8&63]),Mi(b,t,r.opts.Date1904),R({c:De,r:j.r},b,t)}break;case 214:case 516:case 4:b=G0(j.val,j.ixfe,"s"),b.XF=k[b.ixfe],I>0&&(b.z=W[b.ixfe>>8&63]),Mi(b,t,r.opts.Date1904),R({c:j.c,r:j.r},b,t);break;case 0:case 512:oe===1&&(s=j);break;case 252:c=j;break;case 1054:if(D.biff==4){W[I++]=j[1];for(var ct=0;ct<I+163&&nt[ct]!=j[1];++ct);ct>=163&&Vi(j[1],I+163)}else Vi(j[1],j[0]);break;case 30:{W[I++]=j;for(var Ke=0;Ke<I+163&&nt[Ke]!=j;++Ke);Ke>=163&&Vi(j,I+163)}break;case 229:z=z.concat(j);break;case 93:X[j.cmo[0]]=D.lastobj=j;break;case 438:D.lastobj.TxO=j;break;case 127:D.lastobj.ImData=j;break;case 440:for(y=j[0].s.r;y<=j[0].e.r;++y)for(g=j[0].s.c;g<=j[0].e.c;++g)p=t.dense?(a[y]||[])[g]:a[it({c:g,r:y})],p&&(p.l=j[1]);break;case 2048:for(y=j[0].s.r;y<=j[0].e.r;++y)for(g=j[0].s.c;g<=j[0].e.c;++g)p=t.dense?(a[y]||[])[g]:a[it({c:g,r:y})],p&&p.l&&(p.l.Tooltip=j[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;p=t.dense?(a[j[0].r]||[])[j[0].c]:a[it(j[0])];var mt=X[j[2]];p||(t.dense?(a[j[0].r]||(a[j[0].r]=[]),p=a[j[0].r][j[0].c]={t:"z"}):p=a[it(j[0])]={t:"z"},s.e.r=Math.max(s.e.r,j[0].r),s.s.r=Math.min(s.s.r,j[0].r),s.e.c=Math.max(s.e.c,j[0].c),s.s.c=Math.min(s.s.c,j[0].c)),p.c||(p.c=[]),x={a:j[1],t:mt.TxO.t},p.c.push(x)}break;case 2173:Hie(k[j.ixfe],j.ext);break;case 125:{if(!D.cellStyles)break;for(;j.e>=j.s;)Y[j.e--]={width:j.w/256,level:j.level||0,hidden:!!(j.flags&1)},ee||(ee=!0,aN(j.w/256)),wo(Y[j.e+1])}break;case 520:{var ht={};j.level!=null&&(q[j.r]=ht,ht.level=j.level),j.hidden&&(q[j.r]=ht,ht.hidden=!0),j.hpt&&(q[j.r]=ht,ht.hpt=j.hpt,ht.hpx=Zc(j.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||cl(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[le]]=j;break;case 161:a["!margins"]||cl(a["!margins"]={}),a["!margins"].header=j.header,a["!margins"].footer=j.footer;break;case 574:j.RTL&&(E.Views[0].RTL=!0);break;case 146:_=j;break;case 2198:L=j;break;case 140:S=j;break;case 442:u?P.CodeName=j||P.name:E.WBProps.CodeName=j||"ThisWorkbook";break}}else ce||console.error("Missing Info for XLS Record 0x"+le.toString(16)),e.l+=Q}return r.SheetNames=Sr(i).sort(function(Re,tt){return Number(Re)-Number(tt)}).map(function(Re){return i[Re].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&U.forEach(function(Re,tt){r.Sheets[r.SheetNames[tt]]["!autofilter"]=Re}),r.Strings=c,r.SSF=Vt(nt),D.enc&&(r.Encryption=D.enc),L&&(r.Themes=L),r.Metadata={},S!==void 0&&(r.Metadata.Country=S),V.names.length>0&&(E.Names=V.names),r.Workbook=E,r}var kd={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function rde(e,t,r){var n=rt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=DE(n,Yy,kd.DSI);for(var i in a)t[i]=a[i]}catch(u){if(r.WTF)throw u}var s=rt.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=DE(s,Jy,kd.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(fR(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function nde(e,t){var r=[],n=[],a=[],i=0,s,o=lE(Yy,"n"),c=lE(Jy,"n");if(e.Props)for(s=Sr(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(c,s[i])?n:a).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=Sr(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(c,s[i])?n:a).push([s[i],e.Custprops[s[i]]]);var u=[];for(i=0;i<a.length;++i)yR.indexOf(a[i][0])>-1||dR.indexOf(a[i][0])>-1||a[i][1]!=null&&u.push(a[i]);n.length&&rt.utils.cfb_add(t,"/SummaryInformation",RE(n,kd.SI,c,Jy)),(r.length||u.length)&&rt.utils.cfb_add(t,"/DocumentSummaryInformation",RE(r,kd.DSI,o,Yy,u.length?u:null,kd.UDI))}function fN(e,t){t||(t={}),hN(t),vg(),t.codepage&&xg(t.codepage);var r,n;if(e.FullPaths){if(rt.find(e,"/encryption"))throw new Error("File is password-protected");r=rt.find(e,"!CompObj"),n=rt.find(e,"/Workbook")||rt.find(e,"/Book")}else{switch(t.type){case"base64":e=Sa(Ia(e));break;case"binary":e=Sa(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}dn(e,0),n={content:e}}var a,i;if(r&&Que(r),t.bookProps&&!t.bookSheets)a={};else{var s=wt?"buffer":"array";if(n&&n.content)a=tde(n.content,t);else if((i=rt.find(e,"PerfectOffice_MAIN"))&&i.content)a=ll.to_workbook(i.content,(t.type=s,t));else if((i=rt.find(e,"NativeContent_MAIN"))&&i.content)a=ll.to_workbook(i.content,(t.type=s,t));else throw(i=rt.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&rt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=xse(e))}var o={};return e.FullPaths&&rde(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}function ade(e,t){var r=t||{},n=rt.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return rt.utils.cfb_add(n,a,pM(e,r)),r.biff==8&&(e.Props||e.Custprops)&&nde(e,n),r.biff==8&&e.vbaraw&&vse(n,rt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var mf={0:{f:Tle},1:{f:Lle},2:{f:rce},3:{f:Gle},4:{f:Ule},5:{f:Zle},6:{f:oce},7:{f:qle},8:{f:hce},9:{f:mce},10:{f:dce},11:{f:fce},12:{f:jle},13:{f:ace},14:{f:Kle},15:{f:Hle},16:{f:sM},17:{f:cce},18:{f:Jle},19:{f:X2},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:lue},40:{},42:{},43:{f:oie},44:{f:iie},45:{f:uie},46:{f:fie},47:{f:die},48:{},49:{f:Dte},50:{},51:{f:Vie},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:PR},62:{f:sce},63:{f:tse},64:{f:Pce},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:In,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Ece},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Ile},148:{f:Dle,p:16},151:{f:bce},152:{},153:{f:iue},154:{},155:{},156:{f:nue},157:{},158:{},159:{T:1,f:Nae},160:{T:-1},161:{T:1,f:Hl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:pce},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Wie},336:{T:-1},337:{f:qie,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:qy},357:{},358:{},359:{},360:{T:1},361:{},362:{f:TR},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:wce},427:{f:Nce},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:kce},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Mle},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:vce},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:qy},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:fse},633:{T:1},634:{T:-1},635:{T:1,f:use},636:{T:-1},637:{f:Fte},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Kce},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Oce},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},n1={6:{f:Ux},10:{f:Bs},12:{f:Rr},13:{f:Rr},14:{f:Er},15:{f:Er},16:{f:Tn},17:{f:Er},18:{f:Er},19:{f:Rr},20:{f:jE},21:{f:jE},23:{f:TR},24:{f:UE},25:{f:Er},26:{},27:{},28:{f:One},29:{},34:{f:Er},35:{f:$E},38:{f:Tn},39:{f:Tn},40:{f:Tn},41:{f:Tn},42:{f:Er},43:{f:Er},47:{f:Hae},49:{f:ane},51:{f:Rr},60:{},61:{f:Zre},64:{f:Er},65:{f:nne},66:{f:Rr},77:{},80:{},81:{},82:{},85:{f:Rr},89:{},90:{},91:{},92:{f:zre},93:{f:Mne},94:{},95:{f:Er},96:{},97:{},99:{f:Er},125:{f:PR},128:{f:yne},129:{f:Wre},130:{f:Rr},131:{f:Er},132:{f:Er},133:{f:Gre},134:{},140:{f:zne},141:{f:Rr},144:{},146:{f:Gne},151:{},152:{},153:{},154:{},155:{},156:{f:Rr},157:{},158:{},160:{f:Qne},161:{f:Xne},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:pne},190:{f:gne},193:{f:Bs},197:{},198:{},199:{},200:{},201:{},202:{f:Er},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Rr},220:{},221:{f:Er},222:{},224:{f:vne},225:{f:Ure},226:{f:Bs},227:{},229:{f:Dne},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Kre},253:{f:sne},255:{f:qre},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:bR},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Er},353:{f:Bs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:kne},431:{f:Er},432:{},433:{},434:{},437:{},438:{f:Lne},439:{f:Er},440:{f:Bne},441:{},442:{f:qf},443:{},444:{f:Rr},445:{},446:{},448:{f:Bs},449:{f:Qre,r:2},450:{f:Bs},512:{f:FE},513:{f:Jne},515:{f:Nne},516:{f:lne},517:{f:BE},519:{f:Zne},520:{f:Yre},523:{},545:{f:zE},549:{f:IE},566:{},574:{f:tne},638:{f:hne},659:{},1048:{},1054:{f:une},1084:{},1212:{f:Ane},2048:{f:$ne},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:z0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Bs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Vne,r:12},2173:{f:zie,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Er,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Cne,r:12},2197:{},2198:{f:Fie,r:12},2199:{},2200:{},2201:{},2202:{f:Tne,r:12},2203:{f:Bs},2204:{},2205:{},2206:{},2207:{},2211:{f:Jre},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Rr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:qne},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Wne},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:FE},1:{},2:{f:aae},3:{f:rae},4:{f:tae},5:{f:BE},7:{f:sae},8:{},9:{f:z0},11:{},22:{f:Rr},30:{f:fne},31:{},32:{},33:{f:zE},36:{},37:{f:IE},50:{f:oae},62:{},52:{},67:{},68:{f:Rr},69:{},86:{},126:{},127:{f:eae},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:lae},223:{},234:{},354:{},421:{},518:{f:Ux},521:{f:z0},536:{f:UE},547:{f:$E},561:{},579:{},1030:{f:Ux},1033:{f:z0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Oe(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&G2(r)&&e.push(r)}}function ide(e,t,r,n){var a=n||(r||[]).length||0;if(a<=8224)return Oe(e,t,r,a);var i=t;if(!isNaN(i)){for(var s=r.parts||[],o=0,c=0,u=0;u+(s[o]||8224)<=8224;)u+=s[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,i),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<a;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(s[o]||8224)<=8224;)u+=s[o]||8224,o++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function Zf(e,t,r){return e||(e=ge(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function sde(e,t,r,n){var a=ge(9);return Zf(a,e,t),wR(r,n||"b",a),a}function ode(e,t,r){var n=ge(8+2*r.length);return Zf(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function lde(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?Hr(rr(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?Oe(e,2,iae(r,n,a)):Oe(e,3,nae(r,n,a));return;case"b":case"e":Oe(e,5,sde(r,n,t.v,t.t));return;case"s":case"str":Oe(e,4,ode(r,n,(t.v||"").slice(0,255)));return}Oe(e,1,Zf(null,r,n))}function cde(e,t,r,n){var a=Array.isArray(t),i=At(t["!ref"]||"A1"),s,o="",c=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=xt(i)}for(var u=i.s.r;u<=i.e.r;++u){o=wr(u);for(var d=i.s.c;d<=i.e.c;++d){u===i.s.r&&(c[d]=tr(d)),s=c[d]+o;var f=a?(t[u]||[])[d]:t[s];f&&lde(e,f,u,d)}}}function ude(e,t){for(var r=t||{},n=ca(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Oe(n,r.biff==4?1033:r.biff==3?521:9,tN(e,16,r)),cde(n,e.Sheets[e.SheetNames[a]],a,r),Oe(n,10),n.end()}function dde(e,t,r){Oe(e,49,ine({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function fde(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Oe(e,1054,dne(a,t[a],r))})}function mde(e,t){var r=ge(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Oe(e,2151,r),r=ge(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),ER(At(t["!ref"]||"A1"),r),r.write_shift(4,4),Oe(e,2152,r)}function hde(e,t){for(var r=0;r<16;++r)Oe(e,224,LE({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Oe(e,224,LE(n,0,t))})}function pde(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Oe(e,440,jne(n)),n[1].Tooltip&&Oe(e,2048,Une(n))}delete t["!links"]}function gde(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&Oe(e,125,Kne(Eg(a,n),a))})}}function xde(e,t,r,n,a){var i=16+Mo(a.cellXfs,t,a);if(t.v==null&&!t.bf){Oe(e,513,Ol(r,n,i));return}if(t.bf)Oe(e,6,Woe(t,r,n,a,i));else switch(t.t){case"d":case"n":var s=t.t=="d"?Hr(rr(t.v)):t.v;Oe(e,515,Sne(r,n,s,i));break;case"b":case"e":Oe(e,517,wne(r,n,t.v,i,a,t.t));break;case"s":case"str":if(a.bookSST){var o=cN(a.Strings,t.v,a.revStrings);Oe(e,253,one(r,n,o,i))}else Oe(e,516,cne(r,n,(t.v||"").slice(0,255),i,a));break;default:Oe(e,513,Ol(r,n,i))}}function vde(e,t,r){var n=ca(),a=r.SheetNames[e],i=r.Sheets[a]||{},s=(r||{}).Workbook||{},o=(s.Sheets||[])[e]||{},c=Array.isArray(i),u=t.biff==8,d,f="",h=[],p=At(i["!ref"]||"A1"),x=u?65536:16384;if(p.e.c>255||p.e.r>=x){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,x-1)}Oe(n,2057,tN(r,16,t)),Oe(n,13,Ya(1)),Oe(n,12,Ya(100)),Oe(n,15,$n(!0)),Oe(n,17,$n(!1)),Oe(n,16,Tl(.001)),Oe(n,95,$n(!0)),Oe(n,42,$n(!1)),Oe(n,43,$n(!1)),Oe(n,130,Ya(1)),Oe(n,128,bne([0,0])),Oe(n,131,$n(!1)),Oe(n,132,$n(!1)),u&&gde(n,i["!cols"]),Oe(n,512,mne(p,t)),u&&(i["!links"]=[]);for(var g=p.s.r;g<=p.e.r;++g){f=wr(g);for(var y=p.s.c;y<=p.e.c;++y){g===p.s.r&&(h[y]=tr(y)),d=h[y]+f;var v=c?(i[g]||[])[y]:i[d];v&&(xde(n,v,g,y,t),u&&v.l&&i["!links"].push([d,v.l]))}}var w=o.CodeName||o.name||a;return u&&Oe(n,574,rne((s.Views||[])[0])),u&&(i["!merges"]||[]).length&&Oe(n,229,Rne(i["!merges"])),u&&pde(n,i),Oe(n,442,NR(w)),u&&mde(n,i),Oe(n,10),n.end()}function yde(e,t,r){var n=ca(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},o=r.biff==8,c=r.biff==5;if(Oe(n,2057,tN(e,5,r)),r.bookType=="xla"&&Oe(n,135),Oe(n,225,o?Ya(1200):null),Oe(n,193,wre(2)),c&&Oe(n,191),c&&Oe(n,192),Oe(n,226),Oe(n,92,Hre("SheetJS",r)),Oe(n,66,Ya(o?1200:1252)),o&&Oe(n,353,Ya(0)),o&&Oe(n,448),Oe(n,317,Yne(e.SheetNames.length)),o&&e.vbaraw&&Oe(n,211),o&&e.vbaraw){var u=s.CodeName||"ThisWorkbook";Oe(n,442,NR(u))}Oe(n,156,Ya(17)),Oe(n,25,$n(!1)),Oe(n,18,$n(!1)),Oe(n,19,Ya(0)),o&&Oe(n,431,$n(!1)),o&&Oe(n,444,Ya(0)),Oe(n,61,ene()),Oe(n,64,$n(!1)),Oe(n,141,Ya(0)),Oe(n,34,$n(Qce(e)=="true")),Oe(n,14,$n(!0)),o&&Oe(n,439,$n(!1)),Oe(n,218,Ya(0)),dde(n,e,r),fde(n,e.SSF,r),hde(n,r),o&&Oe(n,352,$n(!1));var d=n.end(),f=ca();o&&Oe(f,140,Hne()),o&&r.Strings&&ide(f,252,Xre(r.Strings)),Oe(f,10);var h=f.end(),p=ca(),x=0,g=0;for(g=0;g<e.SheetNames.length;++g)x+=(o?12:11)+(o?2:1)*e.SheetNames[g].length;var y=d.length+x+h.length;for(g=0;g<e.SheetNames.length;++g){var v=i[g]||{};Oe(p,133,Vre({pos:y,hs:v.Hidden||0,dt:0,name:e.SheetNames[g]},r)),y+=t[g].length}var w=p.end();if(x!=w.length)throw new Error("BS8 "+x+" != "+w.length);var b=[];return d.length&&b.push(d),w.length&&b.push(w),h.length&&b.push(h),en(b)}function bde(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Vt(nt)),e&&e.SSF&&(yu(),Vf(e.SSF),r.revssf=bg(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,pN(r),r.cellXfs=[],Mo(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=vde(a,r,e);return n.unshift(yde(e,n,r)),en(n)}function pM(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Xn(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return bde(e,t);case 4:case 3:case 2:return ude(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function QE(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=a.index,o=i&&i.index||e.length,c=ste(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,h=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(s=0;s<c.length;++s){var g=c[s].trim(),y=g.slice(0,3).toLowerCase();if(y=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(y!="<td"&&y!="<th")){var v=g.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var w=v[o].trim();if(w.match(/<t[dh]/i)){for(var b=w,S=0;b.charAt(0)=="<"&&(S=b.indexOf(">"))>-1;)b=b.slice(S+1);for(var k=0;k<x.length;++k){var _=x[k];_.s.c==d&&_.s.r<u&&u<=_.e.r&&(d=_.e.c+1,k=-1)}var E=st(w.slice(0,w.indexOf(">")));h=E.colspan?+E.colspan:1,((f=+E.rowspan)>1||h>1)&&x.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+h-1}});var P=E.t||E["data-t"]||"";if(!b.length){d+=h;continue}if(b=HD(b),p.s.r>u&&(p.s.r=u),p.e.r<u&&(p.e.r=u),p.s.c>d&&(p.s.c=d),p.e.c<d&&(p.e.c=d),!b.length){d+=h;continue}var A={t:"s",v:b};r.raw||!b.trim().length||P=="s"||(b==="TRUE"?A={t:"b",v:!0}:b==="FALSE"?A={t:"b",v:!1}:isNaN(Ci(b))?isNaN(Jc(b).getDate())||(A={t:"d",v:rr(b)},r.cellDates||(A={t:"n",v:Hr(A.v)}),A.z=r.dateNF||nt[14]):A={t:"n",v:Ci(b)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=A):n[it({r:u,c:d})]=A,d+=h}}}}return n["!ref"]=xt(p),x.length&&(n["!merges"]=x),n}function gM(e,t,r,n){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,c=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>s)&&!(a[u].e.r<r||a[u].e.c<s)){if(a[u].s.r<r||a[u].s.c<s){o=-1;break}o=a[u].e.r-a[u].s.r+1,c=a[u].e.c-a[u].s.c+1;break}if(!(o<0)){var d=it({r,c:s}),f=n.dense?(e[r]||[])[s]:e[d],h=f&&f.v!=null&&(f.h||B2(f.w||(Yi(f),f.w)||""))||"",p={};o>1&&(p.rowspan=o),c>1&&(p.colspan=c),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(p["data-t"]=f&&f.t||"z",f.v!=null&&(p["data-v"]=f.v),f.z!=null&&(p["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),p.id=(n.id||"sjs")+"-"+d,i.push(Pe("td",h,p))}}var x="<tr>";return x+i.join("")+"</tr>"}var xM='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',vM="</body></html>";function wde(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ro(QE(r[0],t),t);var n=bN();return r.forEach(function(a,i){wN(n,QE(a,t),"Sheet"+(i+1))}),n}function yM(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function bM(e,t){var r=t||{},n=r.header!=null?r.header:xM,a=r.footer!=null?r.footer:vM,i=[n],s=Xn(e["!ref"]);r.dense=Array.isArray(e),i.push(yM(e,s,r));for(var o=s.s.r;o<=s.e.r;++o)i.push(gM(e,s,o,r));return i.push("</table>"+a),i.join("")}function wM(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?mr(n.origin):n.origin;a=s.r,i=s.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var d=Xn(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),a==-1&&(u.e.r=a=d.e.r+1)}var f=[],h=0,p=e["!rows"]||(e["!rows"]=[]),x=0,g=0,y=0,v=0,w=0,b=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&g<c;++x){var S=o[x];if(ZE(S)){if(n.display)continue;p[g]={hidden:!0}}var k=S.children;for(y=v=0;y<k.length;++y){var _=k[y];if(!(n.display&&ZE(_))){var E=_.hasAttribute("data-v")?_.getAttribute("data-v"):_.hasAttribute("v")?_.getAttribute("v"):HD(_.innerHTML),P=_.getAttribute("data-z")||_.getAttribute("z");for(h=0;h<f.length;++h){var A=f[h];A.s.c==v+i&&A.s.r<g+a&&g+a<=A.e.r&&(v=A.e.c+1-i,h=-1)}b=+_.getAttribute("colspan")||1,((w=+_.getAttribute("rowspan")||1)>1||b>1)&&f.push({s:{r:g+a,c:v+i},e:{r:g+a+(w||1)-1,c:v+i+(b||1)-1}});var T={t:"s",v:E},R=_.getAttribute("data-t")||_.getAttribute("t")||"";E!=null&&(E.length==0?T.t=R||"z":n.raw||E.trim().length==0||R=="s"||(E==="TRUE"?T={t:"b",v:!0}:E==="FALSE"?T={t:"b",v:!1}:isNaN(Ci(E))?isNaN(Jc(E).getDate())||(T={t:"d",v:rr(E)},n.cellDates||(T={t:"n",v:Hr(T.v)}),T.z=n.dateNF||nt[14]):T={t:"n",v:Ci(E)})),T.z===void 0&&P!=null&&(T.z=P);var D="",L=_.getElementsByTagName("A");if(L&&L.length)for(var z=0;z<L.length&&!(L[z].hasAttribute("href")&&(D=L[z].getAttribute("href"),D.charAt(0)!="#"));++z);D&&D.charAt(0)!="#"&&(T.l={Target:D}),n.dense?(e[g+a]||(e[g+a]=[]),e[g+a][v+i]=T):e[it({c:v+i,r:g+a})]=T,u.e.c<v+i&&(u.e.c=v+i),v+=b}}++g}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,g-1+a),e["!ref"]=xt(u),g>=c&&(e["!fullref"]=xt((u.e.r=o.length-x+g-1+a,u))),e}function NM(e,t){var r=t||{},n=r.dense?[]:{};return wM(n,e,t)}function Nde(e,t){return Ro(NM(e,t),t)}function ZE(e){var t="",r=Sde(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Sde(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function kde(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Rt(t.replace(/<[^>]*>/g,""));return[r]}var eC={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function SM(e,t){var r=t||{},n=j2(e),a=[],i,s,o={name:""},c="",u=0,d,f,h={},p=[],x=r.dense?[]:{},g,y,v={value:""},w="",b=0,S=[],k=-1,_=-1,E={s:{r:1e6,c:1e7},e:{r:0,c:0}},P=0,A={},T=[],R={},D=0,L=0,z=[],X=1,Y=1,q=[],ee={Names:[]},V={},ae=["",""],oe=[],I={},W="",U=0,G=!1,ne=!1,K=0;for(of.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=of.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(E.e.c>=E.s.c&&E.e.r>=E.s.r?x["!ref"]=xt(E):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=E.e.r&&(x["!fullref"]=x["!ref"],E.e.r=r.sheetRows-1,x["!ref"]=xt(E)),T.length&&(x["!merges"]=T),z.length&&(x["!rows"]=z),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),p.push(d.name),h[d.name]=x,ne=!1):g[0].charAt(g[0].length-2)!=="/"&&(d=st(g[0],!1),k=_=-1,E.s.r=E.s.c=1e7,E.e.r=E.e.c=0,x=r.dense?[]:{},T=[],z=[],ne=!0);break;case"table-row-group":g[1]==="/"?--P:++P;break;case"table-row":case"":if(g[1]==="/"){k+=X,X=1;break}if(f=st(g[0],!1),f.?k=f.-1:k==-1&&(k=0),X=+f["number-rows-repeated"]||1,X<10)for(K=0;K<X;++K)P>0&&(z[k+K]={level:P});_=-1;break;case"covered-table-cell":g[1]!=="/"&&++_,r.sheetStubs&&(r.dense?(x[k]||(x[k]=[]),x[k][_]={t:"z"}):x[it({r:k,c:_})]={t:"z"}),w="",S=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++_,v=st(g[0],!1),Y=parseInt(v["number-columns-repeated"]||"1",10),y={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(y.f=qE(Rt(v.formula))),(v.||v["value-type"])=="string"&&(y.t="s",y.v=Rt(v["string-value"]||""),r.dense?(x[k]||(x[k]=[]),x[k][_]=y):x[it({r:k,c:_})]=y),_+=Y-1;else if(g[1]!=="/"){++_,w="",b=0,S=[],Y=1;var le=X?k+X-1:k;if(_>E.e.c&&(E.e.c=_),_<E.s.c&&(E.s.c=_),k<E.s.r&&(E.s.r=k),le>E.e.r&&(E.e.r=le),v=st(g[0],!1),oe=[],I={},y={t:v.||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=Rt(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(D=parseInt(v["number-matrix-rows-spanned"],10)||0,L=parseInt(v["number-matrix-columns-spanned"],10)||0,R={s:{r:k,c:_},e:{r:k+D-1,c:_+L-1}},y.F=xt(R),q.push([R,y.F])),v.formula)y.f=qE(v.formula);else for(K=0;K<q.length;++K)k>=q[K][0].s.r&&k<=q[K][0].e.r&&_>=q[K][0].s.c&&_<=q[K][0].e.c&&(y.F=q[K][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(D=parseInt(v["number-rows-spanned"],10)||0,L=parseInt(v["number-columns-spanned"],10)||0,R={s:{r:k,c:_},e:{r:k+D-1,c:_+L-1}},T.push(R)),v["number-columns-repeated"]&&(Y=parseInt(v["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=Zt(v["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(v.value);break;case"percentage":y.t="n",y.v=parseFloat(v.value);break;case"currency":y.t="n",y.v=parseFloat(v.value);break;case"date":y.t="d",y.v=rr(v["date-value"]),r.cellDates||(y.t="n",y.v=Hr(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=nte(v["time-value"])/86400,r.cellDates&&(y.t="d",y.v=wg(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(v.);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",v["string-value"]!=null&&(w=Rt(v["string-value"]),S=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(G=!1,y.t==="s"&&(y.v=w||"",S.length&&(y.R=S),G=b==0),V.Target&&(y.l=V),oe.length>0&&(y.c=oe,oe=[]),w&&r.cellText!==!1&&(y.w=w),G&&(y.t="z",delete y.v),(!G||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=k))for(var Q=0;Q<X;++Q){if(Y=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(x[k+Q]||(x[k+Q]=[]),x[k+Q][_]=Q==0?y:Vt(y);--Y>0;)x[k+Q][_+Y]=Vt(y);else for(x[it({r:k+Q,c:_})]=y;--Y>0;)x[it({r:k+Q,c:_+Y})]=Vt(y);E.e.c<=_&&(E.e.c=_)}Y=parseInt(v["number-columns-repeated"]||"1",10),_+=Y-1,Y=0,y={},w="",S=[]}V={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((i=a.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((i=a.pop())[0]!==g[3])throw"Bad state: "+i;I.t=w,S.length&&(I.R=S),I.a=W,oe.push(I)}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!1]);W="",U=0,w="",b=0,S=[];break;case"creator":g[1]==="/"?W=n.slice(U,g.index):U=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((i=a.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!1]);w="",b=0,S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(A[o.name]=c,(i=a.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&(c="",o=st(g[0],!1),a.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":s=st(g[0],!1),c+=eC[g[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":s=st(g[0],!1),c+=eC[g[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,g.index);break}else u=g.index+g[0].length;break;case"named-range":s=st(g[0],!1),ae=zx(s["cell-range-address"]);var ce={Name:s.name,Ref:ae[0]+"!"+ae[1]};ne&&(ce.Sheet=p.length),ee.Names.push(ce);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(g[1]==="/"&&(!v||!v["string-value"])){var be=kde(n.slice(b,g.index));w=(w.length>0?w+`
`:"")+be[0]}else st(g[0],!1),b=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{ae=zx(st(g[0])["target-range-address"]),h[ae[0]]["!autofilter"]={ref:ae[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(V=st(g[0],!1),!V.href)break;V.Target=Rt(V.href),delete V.href,V.Target.charAt(0)=="#"&&V.Target.indexOf(".")>-1?(ae=zx(V.Target.slice(1)),V.Target="#"+ae[0]+"!"+ae[1]):V.Target.match(/^\.\.[\\\/]/)&&(V.Target=V.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(g)}}var j={Sheets:h,SheetNames:p,Workbook:ee};return r.bookSheets&&delete j.Sheets,j}function tC(e,t){t=t||{},Xa(e,"META-INF/manifest.xml")&&rre(Dr(e,"META-INF/manifest.xml"),t);var r=ka(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=SM(Wt(r),t);return Xa(e,"meta.xml")&&(n.Props=cR(Dr(e,"meta.xml"))),n}function rC(e,t){return SM(e,t)}var _de=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+sf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Tr+t}}(),nC=function(){var e=function(i){return Ut(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,s,o){var c=[];c.push('      <table:table table:name="'+Ut(s.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,d=0,f=Xn(i["!ref"]||"A1"),h=i["!merges"]||[],p=0,x=Array.isArray(i);if(i["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(i["!cols"][d]?' table:style-name="co'+i["!cols"][d].ods+'"':"")+`></table:table-column>
`);var g="",y=i["!rows"]||[];for(u=0;u<f.s.r;++u)g=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+g+`></table:table-row>
`);for(;u<=f.e.r;++u){for(g=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+g+`>
`),d=0;d<f.s.c;++d)c.push(t);for(;d<=f.e.c;++d){var v=!1,w={},b="";for(p=0;p!=h.length;++p)if(!(h[p].s.c>d)&&!(h[p].s.r>u)&&!(h[p].e.c<d)&&!(h[p].e.r<u)){(h[p].s.c!=d||h[p].s.r!=u)&&(v=!0),w["table:number-columns-spanned"]=h[p].e.c-h[p].s.c+1,w["table:number-rows-spanned"]=h[p].e.r-h[p].s.r+1;break}if(v){c.push(r);continue}var S=it({r:u,c:d}),k=x?(i[u]||[])[d]:i[S];if(k&&k.f&&(w["table:formula"]=Ut(Yoe(k.f)),k.F&&k.F.slice(0,S.length)==S)){var _=Xn(k.F);w["table:number-matrix-columns-spanned"]=_.e.c-_.s.c+1,w["table:number-matrix-rows-spanned"]=_.e.r-_.s.r+1}if(!k){c.push(t);continue}switch(k.t){case"b":b=k.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=k.v?"true":"false";break;case"n":b=k.w||String(k.v||0),w["office:value-type"]="float",w["office:value"]=k.v||0;break;case"s":case"str":b=k.v==null?"":k.v,w["office:value-type"]="string";break;case"d":b=k.w||rr(k.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=rr(k.v).toISOString(),w["table:style-name"]="ce1";break;default:c.push(t);continue}var E=e(b);if(k.l&&k.l.Target){var P=k.l.Target;P=P.charAt(0)=="#"?"#"+Joe(P.slice(1)):P,P.charAt(0)!="#"&&!P.match(/^\w+:/)&&(P="../"+P),E=Pe("text:a",E,{"xlink:href":P.replace(/&/g,"&amp;")})}c.push("          "+Pe("table:table-cell",Pe("text:p",E,{}),w)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(i,s){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;wo(f),f.ods=o;var h=u["!cols"][d].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),i.push(`  </style:style>
`),++o}}});var c=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(s,o){var c=[Tr],u=sf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=sf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(lR().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),a(c,s),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=s.SheetNames.length;++f)c.push(n(s.Sheets[s.SheetNames[f]],s,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function kM(e,t){if(t.bookType=="fods")return nC(e,t);var r=I2(),n="",a=[],i=[];return n="mimetype",vt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",vt(r,n,nC(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",vt(r,n,_de(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",vt(r,n,Tr+lR()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",vt(r,n,ire(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",vt(r,n,nre(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Dl(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function a1(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Wt(Do(e))}function Ede(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Sa($i(e))}function Cde(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function So(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function aC(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Ade(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Tde(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function hf(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Bt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Nr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Mt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=hf(e,r),i=a&7;a=Math.floor(a/8);var s=0,o;if(a==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:s=4,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=hf(e,r),o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var u={data:o,type:i};t[a]==null?t[a]=[u]:t[a].push(u)}return t}function on(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(Bt(n*8+a.type)),a.type==2&&t.push(Bt(a.data.length)),t.push(a.data))})}),So(t)}function mN(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Va(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=hf(e,n),i=Mt(e.slice(n[0],n[0]+a));n[0]+=a;var s={id:Nr(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=Mt(o.data),u=Nr(c[3][0].data);s.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=i[3])!=null&&t[0]&&(s.merge=Nr(i[3][0].data)>>>0>0),r.push(s)}return r}function Jl(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Bt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Bt(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(s){a.push(s.data),s.meta[3]=[{type:0,data:Bt(s.data.length)}],n[2].push({data:on(s.meta),type:2})});var i=on(n);t.push(Bt(i.length)),t.push(i),a.forEach(function(s){return t.push(s)})}),So(t)}function Pde(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=hf(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[r[0]],o>1&&(s|=t[r[0]+1]<<8),o>2&&(s|=t[r[0]+2]<<16),o>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}a.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var c=0,u=0;if(i==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[So(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(a.push(a[0].slice(-c)),u-=c;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-c,-c+u))}}var d=So(a);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Ka(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Pde(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return So(t)}function Ql(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=Bt(n),s=i.length;t.push(i),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),s+=n,a[0]=0,a[1]=s&255,a[2]=s>>8&255,a[3]=s>>16&255,r+=n}return So(t)}function Ode(e,t,r,n){var a=Dl(e),i=a.getUint32(4,!0),s=(n>1?12:8)+aC(i&(n>1?3470:398))*4,o=-1,c=-1,u=NaN,d=new Date(2001,0,1);i&512&&(o=a.getUint32(s,!0),s+=4),s+=aC(i&(n>1?12288:4096))*4,i&16&&(c=a.getUint32(s,!0),s+=4),i&32&&(u=a.getFloat64(s,!0),s+=8),i&64&&(d.setTime(d.getTime()+a.getFloat64(s,!0)*1e3),s+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function Dde(e,t,r){var n=Dl(e),a=n.getUint32(8,!0),i=12,s=-1,o=-1,c=NaN,u=NaN,d=new Date(2001,0,1);a&1&&(c=Ade(e,i),i+=16),a&2&&(u=n.getFloat64(i,!0),i+=8),a&4&&(d.setTime(d.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(o=n.getUint32(i,!0),i+=4),a&16&&(s=n.getUint32(i,!0),i+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(s>-1)f={t:"s",v:r[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return f}function Wx(e,t){var r=new Uint8Array(32),n=Dl(r),a=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,Tde(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,a)}function Gx(e,t){var r=new Uint8Array(32),n=Dl(r),a=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,a)}function Rde(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Ode(e,t,r,e[0]);case 5:return Dde(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Nn(e){var t=Mt(e);return hf(t[1][0].data)}function iC(e,t){var r=Mt(t.data),n=Nr(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(s){var o=Mt(s.data),c=Nr(o[1][0].data)>>>0;switch(n){case 1:i[c]=a1(o[3][0].data);break;case 8:{var u=e[Nn(o[9][0].data)][0],d=Mt(u.data),f=e[Nn(d[1][0].data)][0],h=Nr(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var p=Mt(f.data);i[c]=p[3].map(function(x){return a1(x.data)}).join("")}break}}),i}function Mde(e,t){var r,n,a,i,s,o,c,u,d,f,h,p,x,g,y=Mt(e),v=Nr(y[1][0].data)>>>0,w=Nr(y[2][0].data)>>>0,b=((n=(r=y[8])==null?void 0:r[0])==null?void 0:n.data)&&Nr(y[8][0].data)>0||!1,S,k;if((i=(a=y[7])==null?void 0:a[0])!=null&&i.data&&t!=0)S=(o=(s=y[7])==null?void 0:s[0])==null?void 0:o.data,k=(u=(c=y[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=y[4])==null?void 0:d[0])!=null&&f.data&&t!=1)S=(p=(h=y[4])==null?void 0:h[0])==null?void 0:p.data,k=(g=(x=y[3])==null?void 0:x[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var _=b?4:1,E=Dl(S),P=[],A=0;A<S.length/2;++A){var T=E.getUint16(A*2,!0);T<65535&&P.push([A,T])}if(P.length!=w)throw"Expected ".concat(w," cells, found ").concat(P.length);var R=[];for(A=0;A<P.length-1;++A)R[P[A][0]]=k.subarray(P[A][1]*_,P[A+1][1]*_);return P.length>=1&&(R[P[P.length-1][0]]=k.subarray(P[P.length-1][1]*_)),{R:v,cells:R}}function Ide(e,t){var r,n=Mt(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Nr(n[7][0].data)>>>0>0?1:0:-1,i=mN(n[5],function(s){return Mde(s,a)});return{nrows:Nr(n[4][0].data)>>>0,data:i.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(c,u){if(s[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));s[o.R][u]=c}),s},[])}}function Fde(e,t,r){var n,a=Mt(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Nr(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(Nr(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=xt(i);var s=Mt(a[4][0].data),o=iC(e,e[Nn(s[4][0].data)][0]),c=(n=s[17])!=null&&n[0]?iC(e,e[Nn(s[17][0].data)][0]):[],u=Mt(s[3][0].data),d=0;u[1].forEach(function(f){var h=Mt(f.data),p=e[Nn(h[2][0].data)][0],x=Nr(p.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var g=Ide(e,p);g.data.forEach(function(y,v){y.forEach(function(w,b){var S=it({r:d+v,c:b}),k=Rde(w,o,c);k&&(r[S]=k)})}),d+=g.nrows})}function Lde(e,t){var r=Mt(t.data),n={"!ref":"A1"},a=e[Nn(r[2][0].data)],i=Nr(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return Fde(e,a[0],n),n}function Bde(e,t){var r,n=Mt(t.data),a={name:(r=n[1])!=null&&r[0]?a1(n[1][0].data):"",sheets:[]},i=mN(n[2],Nn);return i.forEach(function(s){e[s].forEach(function(o){var c=Nr(o.meta[1][0].data);c==6e3&&a.sheets.push(Lde(e,o))})}),a}function jde(e,t){var r=bN(),n=Mt(t.data),a=mN(n[1],Nn);if(a.forEach(function(i){e[i].forEach(function(s){var o=Nr(s.meta[1][0].data);if(o==2){var c=Bde(e,s);c.sheets.forEach(function(u,d){wN(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Vx(e){var t,r,n,a,i={},s=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=Ka(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=Va(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){i[f.id]=f.messages,s.push(f.id)})}}),!s.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Nr(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||s.forEach(function(c){i[c].forEach(function(u){var d=Nr(u.meta[1][0].data)>>>0;if(d==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return jde(i,o)}function $de(e,t,r){var n,a,i,s;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(i=e[8])==null?void 0:i[0])==null?void 0:s.data)&&Nr(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,u=Dl(e[7][0].data),d=0,f=[],h=Dl(e[4][0].data),p=0,x=[],g=0;g<t.length;++g){if(t[g]==null){u.setUint16(g*2,65535,!0),h.setUint16(g*2,65535);continue}u.setUint16(g*2,d,!0),h.setUint16(g*2,p,!0);var y,v;switch(typeof t[g]){case"string":y=Wx({t:"s",v:t[g]},r),v=Gx({t:"s",v:t[g]},r);break;case"number":y=Wx({t:"n",v:t[g]},r),v=Gx({t:"n",v:t[g]},r);break;case"boolean":y=Wx({t:"b",v:t[g]},r),v=Gx({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}f.push(y),d+=y.length,x.push(v),p+=v.length,++c}for(e[2][0].data=Bt(c);g<e[7][0].data.length/2;++g)u.setUint16(g*2,65535,!0),h.setUint16(g*2,65535,!0);return e[6][0].data=So(f),e[3][0].data=So(x),c}function Ude(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Xn(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(xt(n)));var i=Vh(r,{range:n,header:1}),s=["~Sh33tJ5~"];i.forEach(function(W){return W.forEach(function(U){typeof U=="string"&&s.push(U)})});var o={},c=[],u=rt.read(t.numbers,{type:"base64"});u.FileIndex.map(function(W,U){return[W,u.FullPaths[U]]}).forEach(function(W){var U=W[0],G=W[1];if(U.type==2&&U.name.match(/\.iwa/)){var ne=U.content,K=Ka(ne),le=Va(K);le.forEach(function(Q){c.push(Q.id),o[Q.id]={deps:[],location:G,type:Nr(Q.messages[0].meta[1][0].data)}})}}),c.sort(function(W,U){return W-U});var d=c.filter(function(W){return W>1}).map(function(W){return[W,Bt(W)]});u.FileIndex.map(function(W,U){return[W,u.FullPaths[U]]}).forEach(function(W){var U=W[0];if(W[1],!!U.name.match(/\.iwa/)){var G=Va(Ka(U.content));G.forEach(function(ne){ne.messages.forEach(function(K){d.forEach(function(le){ne.messages.some(function(Q){return Nr(Q.meta[1][0].data)!=11006&&Cde(Q.data,le[1])})&&o[le[0]].deps.push(ne.id)})})})}});for(var f=rt.find(u,o[1].location),h=Va(Ka(f.content)),p,x=0;x<h.length;++x){var g=h[x];g.id==1&&(p=g)}var y=Nn(Mt(p.messages[0].data)[1][0].data);for(f=rt.find(u,o[y].location),h=Va(Ka(f.content)),x=0;x<h.length;++x)g=h[x],g.id==y&&(p=g);for(y=Nn(Mt(p.messages[0].data)[2][0].data),f=rt.find(u,o[y].location),h=Va(Ka(f.content)),x=0;x<h.length;++x)g=h[x],g.id==y&&(p=g);for(y=Nn(Mt(p.messages[0].data)[2][0].data),f=rt.find(u,o[y].location),h=Va(Ka(f.content)),x=0;x<h.length;++x)g=h[x],g.id==y&&(p=g);var v=Mt(p.messages[0].data);{v[6][0].data=Bt(n.e.r+1),v[7][0].data=Bt(n.e.c+1);var w=Nn(v[46][0].data),b=rt.find(u,o[w].location),S=Va(Ka(b.content));{for(var k=0;k<S.length&&S[k].id!=w;++k);if(S[k].id!=w)throw"Bad ColumnRowUIDMapArchive";var _=Mt(S[k].messages[0].data);_[1]=[],_[2]=[],_[3]=[];for(var E=0;E<=n.e.c;++E){var P=[];P[1]=P[2]=[{type:0,data:Bt(E+420690)}],_[1].push({type:2,data:on(P)}),_[2].push({type:0,data:Bt(E)}),_[3].push({type:0,data:Bt(E)})}_[4]=[],_[5]=[],_[6]=[];for(var A=0;A<=n.e.r;++A)P=[],P[1]=P[2]=[{type:0,data:Bt(A+726270)}],_[4].push({type:2,data:on(P)}),_[5].push({type:0,data:Bt(A)}),_[6].push({type:0,data:Bt(A)});S[k].messages[0].data=on(_)}b.content=Ql(Jl(S)),b.size=b.content.length,delete v[46];var T=Mt(v[4][0].data);{T[7][0].data=Bt(n.e.r+1);var R=Mt(T[1][0].data),D=Nn(R[2][0].data);b=rt.find(u,o[D].location),S=Va(Ka(b.content));{if(S[0].id!=D)throw"Bad HeaderStorageBucket";var L=Mt(S[0].messages[0].data);for(A=0;A<i.length;++A){var z=Mt(L[2][0].data);z[1][0].data=Bt(A),z[4][0].data=Bt(i[A].length),L[2][A]={type:L[2][0].type,data:on(z)}}S[0].messages[0].data=on(L)}b.content=Ql(Jl(S)),b.size=b.content.length;var X=Nn(T[2][0].data);b=rt.find(u,o[X].location),S=Va(Ka(b.content));{if(S[0].id!=X)throw"Bad HeaderStorageBucket";for(L=Mt(S[0].messages[0].data),E=0;E<=n.e.c;++E)z=Mt(L[2][0].data),z[1][0].data=Bt(E),z[4][0].data=Bt(n.e.r+1),L[2][E]={type:L[2][0].type,data:on(z)};S[0].messages[0].data=on(L)}b.content=Ql(Jl(S)),b.size=b.content.length;var Y=Nn(T[4][0].data);(function(){for(var W=rt.find(u,o[Y].location),U=Va(Ka(W.content)),G,ne=0;ne<U.length;++ne){var K=U[ne];K.id==Y&&(G=K)}var le=Mt(G.messages[0].data);{le[3]=[];var Q=[];s.forEach(function(j,$e){Q[1]=[{type:0,data:Bt($e)}],Q[2]=[{type:0,data:Bt(1)}],Q[3]=[{type:2,data:Ede(j)}],le[3].push({type:2,data:on(Q)})})}G.messages[0].data=on(le);var ce=Jl(U),be=Ql(ce);W.content=be,W.size=W.content.length})();var q=Mt(T[3][0].data);{var ee=q[1][0];delete q[2];var V=Mt(ee.data);{var ae=Nn(V[2][0].data);(function(){for(var W=rt.find(u,o[ae].location),U=Va(Ka(W.content)),G,ne=0;ne<U.length;++ne){var K=U[ne];K.id==ae&&(G=K)}var le=Mt(G.messages[0].data);{delete le[6],delete q[7];var Q=new Uint8Array(le[5][0].data);le[5]=[];for(var ce=0,be=0;be<=n.e.r;++be){var j=Mt(Q);ce+=$de(j,i[be],s),j[1][0].data=Bt(be),le[5].push({data:on(j),type:2})}le[1]=[{type:0,data:Bt(n.e.c+1)}],le[2]=[{type:0,data:Bt(n.e.r+1)}],le[3]=[{type:0,data:Bt(ce)}],le[4]=[{type:0,data:Bt(n.e.r+1)}]}G.messages[0].data=on(le);var $e=Jl(U),Ee=Ql($e);W.content=Ee,W.size=W.content.length})()}ee.data=on(V)}T[3][0].data=on(q)}v[4][0].data=on(T)}p.messages[0].data=on(v);var oe=Jl(h),I=Ql(oe);return f.content=I,f.size=f.content.length,u}function _M(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function hN(e){_M([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function pN(e){_M([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function zde(e){return St.WS.indexOf(e)>-1?"sheet":e==St.CS?"chart":e==St.DS?"dialog":e==St.MS?"macro":e&&e.length?e:"sheet"}function Hde(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,zde(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Wde(e,t,r,n,a,i,s,o,c,u,d,f){try{i[n]=bd(ka(e,r,!0),t);var h=Dr(e,t),p;switch(o){case"sheet":p=gue(h,t,a,c,i[n],u,d,f);break;case"chart":if(p=xue(h,t,a,c,i[n],u,d,f),!p||!p["!drawel"])break;var x=nd(p["!drawel"].Target,t),g=lf(x),y=ase(ka(e,x,!0),bd(ka(e,g,!0),x)),v=nd(y,x),w=lf(v);p=Gce(ka(e,v,!0),v,c,bd(ka(e,w,!0),v),u,p);break;case"macro":p=vue(h,t,a,c,i[n],u,d,f);break;case"dialog":p=yue(h,t,a,c,i[n],u,d,f);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=p;var b=[];i&&i[n]&&Sr(i[n]).forEach(function(S){var k="";if(i[n][S].Type==St.CMNT){k=nd(i[n][S].Target,t);var _=Sue(Dr(e,k,!0),k,c);if(!_||!_.length)return;WE(p,_,!1)}i[n][S].Type==St.TCMNT&&(k=nd(i[n][S].Target,t),b=b.concat(sse(Dr(e,k,!0),c)))}),b&&b.length&&WE(p,b,!0,c.people||[])}catch(S){if(c.WTF)throw S}}function Ha(e){return e.charAt(0)=="/"?e.slice(1):e}function EM(e,t){if(yu(),t=t||{},hN(t),Xa(e,"META-INF/manifest.xml")||Xa(e,"objectdata.xml"))return tC(e,t);if(Xa(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Vx<"u"){if(e.FileIndex)return Vx(e);var r=rt.utils.cfb_new();return dE(e).forEach(function(z){vt(r,z,jD(e,z))}),Vx(r)}throw new Error("Unsupported NUMBERS file")}if(!Xa(e,"[Content_Types].xml"))throw Xa(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Xa(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=dE(e),a=ere(ka(e,"[Content_Types].xml")),i=!1,s,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",Dr(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!Dr(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(wd=[],a.sst)try{wd=Nue(Dr(e,Ha(a.sst)),a.sst,t)}catch(z){if(t.WTF)throw z}t.cellStyles&&a.themes.length&&(c=wue(ka(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(u=bue(Dr(e,Ha(a.style)),a.style,c,t))}a.links.map(function(z){try{var X=bd(ka(e,lf(Ha(z))),z);return _ue(Dr(e,Ha(z)),X,z,t)}catch{}});var d=pue(Dr(e,Ha(a.workbooks[0])),a.workbooks[0],t),f={},h="";a.coreprops.length&&(h=Dr(e,Ha(a.coreprops[0]),!0),h&&(f=cR(h)),a.extprops.length!==0&&(h=Dr(e,Ha(a.extprops[0]),!0),h&&ore(h,f,t)));var p={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(h=ka(e,Ha(a.custprops[0]),!0),h&&(p=cre(h,t)));var x={};if((t.bookSheets||t.bookProps)&&(d.Sheets?s=d.Sheets.map(function(X){return X.name}):f.Worksheets&&f.SheetNames.length>0&&(s=f.SheetNames),t.bookProps&&(x.Props=f,x.Custprops=p),t.bookSheets&&typeof s<"u"&&(x.SheetNames=s),t.bookSheets?x.SheetNames:t.bookProps))return x;s={};var g={};t.bookDeps&&a.calcchain&&(g=kue(Dr(e,Ha(a.calcchain)),a.calcchain));var y=0,v={},w,b;{var S=d.Sheets;f.Worksheets=S.length,f.SheetNames=[];for(var k=0;k!=S.length;++k)f.SheetNames[k]=S[k].name}var _=i?"bin":"xml",E=a.workbooks[0].lastIndexOf("/"),P=(a.workbooks[0].slice(0,E+1)+"_rels/"+a.workbooks[0].slice(E+1)+".rels").replace(/^\//,"");Xa(e,P)||(P="xl/_rels/workbook."+_+".rels");var A=bd(ka(e,P,!0),P.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=Eue(Dr(e,Ha(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=lse(Dr(e,Ha(a.people[0])),t)),A&&(A=Hde(A,d.Sheets));var T=Dr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=f.Worksheets;++y){var R="sheet";if(A&&A[y]?(w="xl/"+A[y][1].replace(/[\/]?xl\//,""),Xa(e,w)||(w=A[y][1]),Xa(e,w)||(w=P.replace(/_rels\/.*$/,"")+A[y][1]),R=A[y][2]):(w="xl/worksheets/sheet"+(y+1-T)+"."+_,w=w.replace(/sheet0\./,"sheet.")),b=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(f.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var D=!1,L=0;L!=t.sheets.length;++L)typeof t.sheets[L]=="number"&&t.sheets[L]==y&&(D=1),typeof t.sheets[L]=="string"&&t.sheets[L].toLowerCase()==f.SheetNames[y].toLowerCase()&&(D=1);if(!D)continue e}}Wde(e,w,b,f.SheetNames[y],y,v,s,R,t,d,c,u)}return x={Directory:a,Workbook:d,Props:f,Custprops:p,Deps:g,Sheets:s,SheetNames:f.SheetNames,Strings:wd,Styles:u,Themes:c,SSF:Vt(nt)},t&&t.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(z,X){z=z.replace(/^Root Entry[\/]/,""),x.keys.push(z),x.files[z]=e.FileIndex[X]}))),t&&t.bookVBA&&(a.vba.length>0?x.vbaraw=Dr(e,Ha(a.vba[0]),!0):a.defaults&&a.defaults.bin===gse&&(x.vbaraw=Dr(e,"xl/vbaProject.bin",!0))),x}function Gde(e,t){var r=t||{},n="Workbook",a=rt.find(e,n);try{if(n="/!DataSpaces/Version",a=rt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Cae(a.content),n="/!DataSpaces/DataSpaceMap",a=rt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=Tae(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=rt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=Pae(a.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=rt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);Dae(a.content)}catch{}if(n="/EncryptionInfo",a=rt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Rae(a.content);if(n="/EncryptedPackage",a=rt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function Vde(e,t){return t.bookType=="ods"?kM(e,t):t.bookType=="numbers"?Ude(e,t):t.bookType=="xlsb"?Kde(e,t):CM(e,t)}function Kde(e,t){xc=1024,e&&!e.SSF&&(e.SSF=Vt(nt)),e&&e.SSF&&(yu(),Vf(e.SSF),t.revssf=bg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Nd?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=XR.indexOf(t.bookType)>-1,a=Z2();pN(t=t||{});var i=I2(),s="",o=0;if(t.cellXfs=[],Mo(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",vt(i,s,uR(e.Props,t)),a.coreprops.push(s),jt(t.rels,2,s,St.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,vt(i,s,mR(e.Props)),a.extprops.push(s),jt(t.rels,3,s,St.EXT_PROPS),e.Custprops!==e.Props&&Sr(e.Custprops||{}).length>0&&(s="docProps/custom.xml",vt(i,s,hR(e.Custprops)),a.custprops.push(s),jt(t.rels,4,s,St.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,vt(i,s,Aue(o-1,s,t,e,d)),a.sheets.push(s),jt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,St.WS[0])}if(f){var p=f["!comments"],x=!1,g="";p&&p.length>0&&(g="xl/comments"+o+"."+r,vt(i,g,Oue(p,g)),a.comments.push(g),jt(d,-1,"../comments"+o+"."+r,St.CMNT),x=!0),f["!legacy"]&&x&&vt(i,"xl/drawings/vmlDrawing"+o+".vml",VR(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&vt(i,lf(s),Ac(d))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,vt(i,s,Pue(t.Strings,s,t)),a.strs.push(s),jt(t.wbrels,-1,"sharedStrings."+r,St.SST)),s="xl/workbook."+r,vt(i,s,Cue(e,s)),a.workbooks.push(s),jt(t.rels,1,s,St.WB),s="xl/theme/theme1.xml",vt(i,s,iN(e.Themes,t)),a.themes.push(s),jt(t.wbrels,-1,"theme/theme1.xml",St.THEME),s="xl/styles."+r,vt(i,s,Tue(e,s,t)),a.styles.push(s),jt(t.wbrels,-1,"styles."+r,St.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",vt(i,s,e.vbaraw),a.vba.push(s),jt(t.wbrels,-1,"vbaProject.bin",St.VBA)),s="xl/metadata."+r,vt(i,s,Due(s)),a.metadata.push(s),jt(t.wbrels,-1,"metadata."+r,St.XLMETA),vt(i,"[Content_Types].xml",oR(a,t)),vt(i,"_rels/.rels",Ac(t.rels)),vt(i,"xl/_rels/workbook."+r+".rels",Ac(t.wbrels)),delete t.revssf,delete t.ssf,i}function CM(e,t){xc=1024,e&&!e.SSF&&(e.SSF=Vt(nt)),e&&e.SSF&&(yu(),Vf(e.SSF),t.revssf=bg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Nd?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=XR.indexOf(t.bookType)>-1,a=Z2();pN(t=t||{});var i=I2(),s="",o=0;if(t.cellXfs=[],Mo(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",vt(i,s,uR(e.Props,t)),a.coreprops.push(s),jt(t.rels,2,s,St.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,vt(i,s,mR(e.Props)),a.extprops.push(s),jt(t.rels,3,s,St.EXT_PROPS),e.Custprops!==e.Props&&Sr(e.Custprops||{}).length>0&&(s="docProps/custom.xml",vt(i,s,hR(e.Custprops)),a.custprops.push(s),jt(t.rels,4,s,St.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,vt(i,s,iM(o-1,t,e,f)),a.sheets.push(s),jt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,St.WS[0])}if(h){var x=h["!comments"],g=!1,y="";if(x&&x.length>0){var v=!1;x.forEach(function(w){w[1].forEach(function(b){b.T==!0&&(v=!0)})}),v&&(y="xl/threadedComments/threadedComment"+o+"."+r,vt(i,y,ose(x,d,t)),a.threadedcomments.push(y),jt(f,-1,"../threadedComments/threadedComment"+o+"."+r,St.TCMNT)),y="xl/comments"+o+"."+r,vt(i,y,KR(x)),a.comments.push(y),jt(f,-1,"../comments"+o+"."+r,St.CMNT),g=!0}h["!legacy"]&&g&&vt(i,"xl/drawings/vmlDrawing"+o+".vml",VR(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&vt(i,lf(s),Ac(f))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,vt(i,s,MR(t.Strings,t)),a.strs.push(s),jt(t.wbrels,-1,"sharedStrings."+r,St.SST)),s="xl/workbook."+r,vt(i,s,dM(e)),a.workbooks.push(s),jt(t.rels,1,s,St.WB),s="xl/theme/theme1.xml",vt(i,s,iN(e.Themes,t)),a.themes.push(s),jt(t.wbrels,-1,"theme/theme1.xml",St.THEME),s="xl/styles."+r,vt(i,s,zR(e,t)),a.styles.push(s),jt(t.wbrels,-1,"styles."+r,St.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",vt(i,s,e.vbaraw),a.vba.push(s),jt(t.wbrels,-1,"vbaProject.bin",St.VBA)),s="xl/metadata."+r,vt(i,s,GR()),a.metadata.push(s),jt(t.wbrels,-1,"metadata."+r,St.XLMETA),d.length>1&&(s="xl/persons/person.xml",vt(i,s,cse(d)),a.people.push(s),jt(t.wbrels,-1,"persons/person.xml",St.PEOPLE)),vt(i,"[Content_Types].xml",oR(a,t)),vt(i,"_rels/.rels",Ac(t.rels)),vt(i,"xl/_rels/workbook."+r+".rels",Ac(t.wbrels)),delete t.revssf,delete t.ssf,i}function gN(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Ia(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Xde(e,t){return rt.find(e,"EncryptedPackage")?Gde(e,t):fN(e,t)}function qde(e,t){var r,n=e,a=t||{};return a.type||(a.type=wt&&Buffer.isBuffer(e)?"buffer":"base64"),r=$D(n,a),EM(r,a)}function AM(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return r1(e.slice(r),t);default:break e}return Qc.to_workbook(e,t)}function Yde(e,t){var r="",n=gN(e,t);switch(t.type){case"base64":r=Ia(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Al(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Wt(r)),t.type="binary",AM(r,t)}function Jde(e,t){var r=e;return t.type=="base64"&&(r=Ia(r)),r=Pt.utils.decode(1200,r.slice(2),"str"),t.type="binary",AM(r,t)}function Qde(e){return e.match(/[^\x00-\x7F]/)?$i(e):e}function Kx(e,t,r,n){return n?(r.type="string",Qc.to_workbook(e,r)):Qc.to_workbook(t,r)}function Gh(e,t){vg();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Gh(new Uint8Array(e),(r=Vt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Pc={},r.dateNF&&(Pc.dateNF=r.dateNF),r.type||(r.type=wt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=wt?"buffer":"binary",n=ete(e),typeof Uint8Array<"u"&&!wt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=Qde(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return r=Vt(r),r.type="array",Gh(O2(n),r)}switch((a=gN(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return Xde(rt.read(n,r),r);break;case 9:if(a[1]<=8)return fN(n,r);break;case 60:return r1(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return uae(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return DR.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?qde(n,r):Kx(e,n,r,i);case 239:return a[3]===60?r1(n,r):Kx(e,n,r,i);case 255:if(a[1]===254)return Jde(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return ll.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return ll.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return t1.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return jR.to_workbook(n,r);break;case 10:case 13:case 32:return Yde(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return cae.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?t1.to_workbook(n,r):Kx(e,n,r,i)}function sC(e,t){var r=t||{};return r.type="file",Gh(e,r)}function TM(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Kf(t.file,rt.write(e,{type:wt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return rt.write(e,t)}function Zde(e,t){var r=Vt(t||{}),n=Vde(e,r);return PM(n,r)}function efe(e,t){var r=Vt(t||{}),n=CM(e,r);return PM(n,r)}function PM(e,t){var r={},n=wt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?rt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(Gf(a))}return t.password&&typeof encrypt_agile<"u"?TM(encrypt_agile(a,t.password),t):t.type==="file"?Kf(t.file,a):t.type=="string"?Wt(a):a}function tfe(e,t){var r=t||{},n=ade(e,r);return TM(n,r)}function Fi(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return rf($i(n));case"binary":return $i(n);case"string":return e;case"file":return Kf(t.file,n,"utf8");case"buffer":return wt?Ms(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Fi(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function rfe(e,t){switch(t.type){case"base64":return rf(e);case"binary":return e;case"string":return e;case"file":return Kf(t.file,e,"binary");case"buffer":return wt?Ms(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function V0(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?rf(r):t.type=="string"?Wt(r):r;case"file":return Kf(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function xN(e,t){vg(),uM(e);var r=Vt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=xN(e,r);return r.type="array",Gf(n)}return efe(e,r)}function Cg(e,t){vg(),uM(e);var r=Vt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Cg(e,r);return r.type="array",Gf(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Fi(Jue(e,r),r);case"slk":case"sylk":return Fi(OR.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return Fi(bM(e.Sheets[e.SheetNames[a]],r),r);case"txt":return rfe(RM(e.Sheets[e.SheetNames[a]],r),r);case"csv":return Fi(yN(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return Fi(DR.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return V0(t1.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return Fi(Qc.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return Fi(jR.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return Fi(RR.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return Fi(kM(e,r),r);case"wk1":return V0(ll.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return V0(ll.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),V0(pM(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),tfe(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Zde(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function vN(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function i1(e,t,r){var n=r||{};return n.type="file",n.file=t,vN(n),Cg(e,n)}function nfe(e,t,r){var n=r||{};return n.type="file",n.file=t,vN(n),xN(e,n)}function afe(e,t,r,n){var a=r||{};a.type="file",a.file=e,vN(a),a.type="buffer";var i=n;return i instanceof Function||(i=r),Qs.writeFile(e,Cg(t,a),i)}function OM(e,t,r,n,a,i,s,o){var c=wr(r),u=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!s||e[r])for(var p=t.s.c;p<=t.e.c;++p){var x=s?e[r][p]:e[n[p]+c];if(x===void 0||x.t===void 0){if(u===void 0)continue;i[p]!=null&&(h[i[p]]=u);continue}var g=x.v;switch(x.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(i[p]!=null){if(g==null)if(x.t=="e"&&g===null)h[i[p]]=null;else if(u!==void 0)h[i[p]]=u;else if(d&&g===null)h[i[p]]=null;else continue;else h[i[p]]=d&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?g:Yi(x,g,o);g!=null&&(f=!1)}}return{row:h,isempty:f}}function Vh(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=At(d);break;case"number":c=At(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(a=0);var f=wr(c.s.r),h=[],p=[],x=0,g=0,y=Array.isArray(e),v=c.s.r,w=0,b={};y&&!e[v]&&(e[v]=[]);var S=u.skipHidden&&e["!cols"]||[],k=u.skipHidden&&e["!rows"]||[];for(w=c.s.c;w<=c.e.c;++w)if(!(S[w]||{}).hidden)switch(h[w]=tr(w),r=y?e[v][w]:e[h[w]+f],n){case 1:i[w]=w-c.s.c;break;case 2:i[w]=h[w];break;case 3:i[w]=u.header[w-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=Yi(r,null,u),g=b[s]||0,!g)b[s]=1;else{do o=s+"_"+g++;while(b[o]);b[s]=g,b[o]=1}i[w]=o}for(v=c.s.r+a;v<=c.e.r;++v)if(!(k[v]||{}).hidden){var _=OM(e,c,v,h,n,i,y,u);(_.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(p[x++]=_.row)}return p.length=x,p}var oC=/"/g;function DM(e,t,r,n,a,i,s,o){for(var c=!0,u=[],d="",f=wr(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var p=o.dense?(e[r]||[])[h]:e[n[h]+f];if(p==null)d="";else if(p.v!=null){c=!1,d=""+(o.rawNumbers&&p.t=="n"?p.v:Yi(p,null,o));for(var x=0,g=0;x!==d.length;++x)if((g=d.charCodeAt(x))===a||g===i||g===34||o.forceQuotes){d='"'+d.replace(oC,'""')+'"';break}d=="ID"&&(d='"ID"')}else p.f!=null&&!p.F?(c=!1,d="="+p.f,d.indexOf(",")>=0&&(d='"'+d.replace(oC,'""')+'"')):d="";u.push(d)}return o.blankrows===!1&&c?null:u.join(s)}function yN(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=At(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],x=a.s.c;x<=a.e.c;++x)(h[x]||{}).hidden||(f[x]=tr(x));for(var g=0,y=a.s.r;y<=a.e.r;++y)(p[y]||{}).hidden||(d=DM(e,a,y,f,s,c,i,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((g++?o:"")+d)));return delete n.dense,r.join("")}function RM(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=yN(e,t);if(typeof Pt>"u"||t.type=="string")return r;var n=Pt.utils.encode(1200,r,"str");return String.fromCharCode(255)+String.fromCharCode(254)+n}function ife(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=At(e["!ref"]),i="",s=[],o,c=[],u=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)s[o]=tr(o);for(var d=a.s.r;d<=a.e.r;++d)for(i=wr(d),o=a.s.c;o<=a.e.c;++o)if(t=s[o]+i,r=u?(e[d]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function MM(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},s=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?mr(n.origin):n.origin;s=c.r,o=c.c}var u,d={s:{c:0,r:0},e:{c:o,r:s+t.length-1+a}};if(i["!ref"]){var f=At(i["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),s==-1&&(s=f.e.r+1,d.e.r=s+t.length-1+a)}else s==-1&&(s=0,d.e.r=t.length-1+a);var h=n.header||[],p=0;t.forEach(function(g,y){Sr(g).forEach(function(v){(p=h.indexOf(v))==-1&&(h[p=h.length]=v);var w=g[v],b="z",S="",k=it({c:o+p,r:s+y+a});u=pf(i,k),w&&typeof w=="object"&&!(w instanceof Date)?i[k]=w:(typeof w=="number"?b="n":typeof w=="boolean"?b="b":typeof w=="string"?b="s":w instanceof Date?(b="d",n.cellDates||(b="n",w=Hr(w)),S=n.dateNF||nt[14]):w===null&&n.nullError&&(b="e",w=0),u?(u.t=b,u.v=w,delete u.w,delete u.R,S&&(u.z=S)):i[k]=u={t:b,v:w},S&&(u.z=S))})}),d.e.c=Math.max(d.e.c,o+h.length-1);var x=wr(s);if(a)for(p=0;p<h.length;++p)i[tr(p+o)+x]={t:"s",v:h[p]};return i["!ref"]=xt(d),i}function sfe(e,t){return MM(null,e,t)}function pf(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=mr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?pf(e,it(t)):pf(e,it({r:t,c:r||0}))}function ofe(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function bN(){return{SheetNames:[],Sheets:{}}}function wN(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if(cM(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function lfe(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=ofe(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function cfe(e,t){return e.z=t,e}function IM(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function ufe(e,t,r){return IM(e,"#"+t,r)}function dfe(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function ffe(e,t,r,n){for(var a=typeof t!="string"?t:At(t),i=typeof t=="string"?t:xt(t),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var c=pf(e,s,o);c.t="n",c.F=i,delete c.v,s==a.s.r&&o==a.s.c&&(c.f=r,n&&(c.D=!0))}return e}var gm={encode_col:tr,encode_row:wr,encode_cell:it,encode_range:xt,decode_col:K2,decode_row:V2,split_cell:Ote,decode_cell:mr,decode_range:Xn,format_cell:Yi,sheet_add_aoa:eR,sheet_add_json:MM,sheet_add_dom:wM,aoa_to_sheet:wu,json_to_sheet:sfe,table_to_sheet:NM,table_to_book:Nde,sheet_to_csv:yN,sheet_to_txt:RM,sheet_to_json:Vh,sheet_to_html:bM,sheet_to_formulae:ife,sheet_to_row_object_array:Vh,sheet_get_cell:pf,book_new:bN,book_append_sheet:wN,book_set_sheet_visibility:lfe,cell_set_number_format:cfe,cell_set_hyperlink:IM,cell_set_internal_link:ufe,cell_add_comment:dfe,sheet_set_array_formula:ffe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},Ag;function mfe(e){Ag=e}function hfe(e,t){var r=Ag(),n=t??{};if(e==null||e["!ref"]==null)return r.push(null),r;var a=At(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],x=a.s.c;x<=a.e.c;++x)(h[x]||{}).hidden||(f[x]=tr(x));var g=a.s.r,y=!1,v=0;return r._read=function(){if(!y)return y=!0,r.push("\uFEFF");for(;g<=a.e.r;)if(++g,!(p[g-1]||{}).hidden&&(d=DM(e,a,g-1,f,s,c,i,n),d!=null&&(n.strip&&(d=d.replace(u,"")),d||n.blankrows!==!1)))return r.push((v++?o:"")+d);return r.push(null)},r}function pfe(e,t){var r=Ag(),n=t||{},a=n.header!=null?n.header:xM,i=n.footer!=null?n.footer:vM;r.push(a);var s=Xn(e["!ref"]);n.dense=Array.isArray(e),r.push(yM(e,s,n));var o=s.s.r,c=!1;return r._read=function(){if(o>s.e.r)return c||(c=!0,r.push("</table>"+i)),r.push(null);for(;o<=s.e.r;){r.push(gM(e,s,o,n)),++o;break}},r}function gfe(e,t){var r=Ag({objectMode:!0});if(e==null||e["!ref"]==null)return r.push(null),r;var n={t:"n",v:0},a=0,i=1,s=[],o=0,c="",u={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},f=d.range!=null?d.range:e["!ref"];switch(d.header===1?a=1:d.header==="A"?a=2:Array.isArray(d.header)&&(a=3),typeof f){case"string":u=At(f);break;case"number":u=At(e["!ref"]),u.s.r=f;break;default:u=f}a>0&&(i=0);var h=wr(u.s.r),p=[],x=0,g=Array.isArray(e),y=u.s.r,v=0,w={};g&&!e[y]&&(e[y]=[]);var b=d.skipHidden&&e["!cols"]||[],S=d.skipHidden&&e["!rows"]||[];for(v=u.s.c;v<=u.e.c;++v)if(!(b[v]||{}).hidden)switch(p[v]=tr(v),n=g?e[y][v]:e[p[v]+h],a){case 1:s[v]=v-u.s.c;break;case 2:s[v]=p[v];break;case 3:s[v]=d.header[v-u.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),c=o=Yi(n,null,d),x=w[o]||0,!x)w[o]=1;else{do c=o+"_"+x++;while(w[c]);w[o]=x,w[c]=1}s[v]=c}return y=u.s.r+i,r._read=function(){for(;y<=u.e.r;)if(!(S[y-1]||{}).hidden){var k=OM(e,u,y,p,a,s,g,d);if(++y,k.isempty===!1||(a===1?d.blankrows!==!1:d.blankrows)){r.push(k.row);return}}return r.push(null)},r}var xfe={to_json:gfe,to_html:pfe,to_csv:hfe,set_readable:mfe};const vfe=tf.version,yfe=Object.freeze(Object.defineProperty({__proto__:null,CFB:rt,SSF:RD,parse_xlscfb:fN,parse_zip:EM,read:Gh,readFile:sC,readFileSync:sC,set_cptable:See,set_fs:Qee,stream:xfe,utils:gm,version:vfe,write:Cg,writeFile:i1,writeFileAsync:afe,writeFileSync:i1,writeFileXLSX:nfe,writeXLSX:xN},Symbol.toStringTag,{value:"Module"})),bfe=(e,t=[])=>{if(!e||e.length===0)return"";const r=c=>{const u=t.find(d=>d.id===Number(c));return u?u.name:c},n=c=>{const u=t.find(f=>f.id===Number(c.category_id));if(!u)return"Unknown";const d={CPU:["CPU","Procie Only","Pro & Mobo - Amd","Pro & Mobo - Intel"],Motherboard:["Motherboard","Mobo","Pro & Mobo - Amd","Pro & Mobo - Intel"],GPU:["GPU"],RAM:["RAM","Ram 3200mhz"],Storage:["Storage","Ssd Nvme"],PSU:["PSU","Psu - Tr"],Case:["Case","Case Gaming"],Cooler:["Cooler","Aio"]};for(const[f,h]of Object.entries(d))if(h.includes(u.name))return f;return u.name},a=c=>{const u=c.stock_quantity??c.stock,d=Number(c.price);return u===0?"Out of Stock":d===0?"No Price":u>0&&u<=5?"Low Stock":"In Stock"},i=["ID","Name","Category","Main Category","Brand","Price","Stock Quantity","Stock Status","Description","Image URL","Created At","Updated At"],s=e.map(c=>[c.id||"",`"${(c.name||"").replace(/"/g,'""')}"`,`"${r(c.category_id)}"`,`"${n(c)}"`,`"${(c.brand||"").replace(/"/g,'""')}"`,c.price||"0",c.stock_quantity??c.stock??"0",`"${a(c)}"`,`"${(c.description||"").replace(/"/g,'""')}"`,`"${c.image_url||""}"`,`"${c.created_at||""}"`,`"${c.updated_at||""}"`]);return[i.join(","),...s.map(c=>c.join(","))].join(`
`)},FM=(e,t=[],r="inventory-export.csv")=>{if(typeof window>"u"){console.error("CSV export requires browser environment.");return}const n=bfe(e,t);if(!n){alert("No data to export");return}const a=new Blob([n],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a");if(i.download!==void 0){const s=URL.createObjectURL(a);i.setAttribute("href",s),i.setAttribute("download",r),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(s)}},wfe=(e,t=[],r="inventory-export.xlsx")=>{if(typeof yfe>"u"){console.error("SheetJS library not loaded. Please include xlsx library for Excel export."),alert("Excel export requires SheetJS library. Falling back to CSV export."),FM(e,t,r.replace(".xlsx",".csv"));return}if(typeof window>"u"){console.error("Excel export requires browser environment.");return}if(!e||e.length===0){alert("No data to export");return}const n=d=>{const f=t.find(h=>h.id===Number(d));return f?f.name:d},a=d=>{const f=t.find(p=>p.id===Number(d.category_id));if(!f)return"Unknown";const h={CPU:["CPU","Procie Only","Pro & Mobo - Amd","Pro & Mobo - Intel"],Motherboard:["Motherboard","Mobo","Pro & Mobo - Amd","Pro & Mobo - Intel"],GPU:["GPU"],RAM:["RAM","Ram 3200mhz"],Storage:["Storage","Ssd Nvme"],PSU:["PSU","Psu - Tr"],Case:["Case","Case Gaming"],Cooler:["Cooler","Aio"]};for(const[p,x]of Object.entries(h))if(x.includes(f.name))return p;return f.name},i=d=>{const f=d.stock_quantity??d.stock,h=Number(d.price);return f===0?"Out of Stock":h===0?"No Price":f>0&&f<=5?"Low Stock":"In Stock"},s=e.map(d=>({ID:d.id||"",Name:d.name||"",Category:n(d.category_id),"Main Category":a(d),Brand:d.brand||"",Price:Number(d.price)||0,"Stock Quantity":Number(d.stock_quantity??d.stock)||0,"Stock Status":i(d),Description:d.description||"","Image URL":d.image_url||"","Created At":d.created_at||"","Updated At":d.updated_at||""})),o=gm.book_new(),c=gm.json_to_sheet(s),u=[{wch:8},{wch:30},{wch:15},{wch:15},{wch:12},{wch:10},{wch:12},{wch:12},{wch:40},{wch:30},{wch:20},{wch:20}];c["!cols"]=u,gm.book_append_sheet(o,c,"Inventory"),i1(o,r)},LM=(e,t,r,n,a,i="csv",s=null)=>{const o=[{key:"CPU",names:["CPU","Procie Only","Pro & Mobo - Amd","Pro & Mobo - Intel"]},{key:"Motherboard",names:["Motherboard","Mobo","Pro & Mobo - Amd","Pro & Mobo - Intel"]},{key:"GPU",names:["GPU"]},{key:"RAM",names:["RAM","Ram 3200mhz"]},{key:"Storage",names:["Storage","Ssd Nvme"]},{key:"PSU",names:["PSU","Psu - Tr"]},{key:"Case",names:["Case","Case Gaming"]},{key:"Cooler",names:["Cooler","Aio"]}],c=p=>{const x=a.find(g=>g.id===Number(p.category_id));if(!x)return null;for(const g of o)if(g.names.includes(x.name))return g.key;return null};let u=e.filter(p=>{const x=c(p);if(!x||r!=="all"&&x!==r)return!1;if(n!=="all"){if(!p.brand)return!1;if(n.toLowerCase()==="amd"||n.toLowerCase()==="intel"){if(p.brand.toLowerCase()!==n.toLowerCase())return!1}else if(p.brand.toLowerCase()!==n.toLowerCase())return!1}return!0});t.trim()!==""&&(u=u.filter(p=>p.name.toLowerCase().includes(t.toLowerCase())||p.brand&&p.brand.toLowerCase().includes(t.toLowerCase())));const f=`inventory-export-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.${i==="excel"?"xlsx":"csv"}`,h=s||f;return i==="excel"?wfe(u,a,h):FM(u,a,h),u.length},NN=({user:e})=>{const[t,r]=N.useState([]),[n,a]=N.useState(!0),[i,s]=N.useState(!1),[o,c]=N.useState(null),[u,d]=N.useState(""),[f,h]=N.useState("all"),[p,x]=N.useState([]),[g,y]=N.useState([]),[v,w]=N.useState("prebuilts"),[b,S]=N.useState([]),[k,_]=N.useState(!1),[E,P]=N.useState(1),[A,T]=N.useState(1),[R,D]=N.useState([]),[L,z]=N.useState({pending:0,approved:0,rejected:0}),[X,Y]=N.useState(!1),[q,ee]=N.useState(null),[V,ae]=N.useState(""),[oe,I]=N.useState(!1),[W,U]=N.useState("pending"),[G,ne]=N.useState(1),[K,le]=N.useState(1),[Q,ce]=N.useState([]);N.useEffect(()=>{const re=Ne=>Ne?Array.isArray(Ne)?Ne:typeof Ne=="string"?Ne.split(",").map(je=>je.trim()).filter(Boolean):[]:[];try{let Ne=re(e==null?void 0:e.roles);if(Ne.length===0){const je=localStorage.getItem("user");if(je)try{const at=JSON.parse(je);Ne=re(at==null?void 0:at.roles)}catch{}}if(Ne.length===0){const je=localStorage.getItem("token");if(je&&je.split(".").length===3){let _e=je.split(".")[1].replace(/-/g,"+").replace(/_/g,"/");for(;_e.length%4;)_e+="=";try{const Xe=JSON.parse(atob(_e));Ne=re(Xe==null?void 0:Xe.roles)}catch{}}}ce(Ne)}catch{ce([])}},[e]);const be=Q.includes("Admin")||Q.includes("Super Admin"),[j,$e]=N.useState({name:"",category:"gaming",description:"",price:"",performance:{gaming:"",streaming:""},features:[""],component_ids:{cpu:"",motherboard:"",gpu:"",ram:"",storage:"",psu:"",case:"",cooler:""},in_stock:!0,is_hidden:!1}),Ee=async()=>{try{if(!await nr(!1)){console.log("No valid token for fetchPrebuilts"),a(!1);return}console.log("Fetching prebuilts...");const Ne=await qe(ha("prebuilts")+"?all=1");if(Ne.status===401){console.log("Authentication failed for prebuilts"),a(!1);return}const je=await Ne.json();Array.isArray(je)?(r(je),console.log("Prebuilts loaded successfully")):console.error("Invalid prebuilts data:",je)}catch(re){console.error("Error fetching prebuilts:",re)}finally{a(!1)}},Ae=(re,Ne)=>{try{if(re==null)return Ne;if(typeof re=="string"){const je=re.trim();return je===""?Ne:JSON.parse(je)}return typeof re=="object"?re:Ne}catch{return Ne}},Be=async()=>{try{const Ne=await(await fetch(ha("get_all_components"))).json();Ne.success&&x(Ne.data)}catch(re){console.error("Error fetching components:",re)}},we=async()=>{try{const Ne=await(await fetch(ha("get_all_categories"))).json();Ne.success&&y(Ne.data)}catch(re){console.error("Error fetching categories:",re)}};N.useEffect(()=>{Ee(),Be(),we()},[]);const de=()=>{$e({name:"",category:"gaming",description:"",price:"",performance:{gaming:"",streaming:""},features:[""],component_ids:{cpu:"",motherboard:"",gpu:"",ram:"",storage:"",psu:"",case:"",cooler:""},in_stock:!0,is_hidden:!1}),c(null)},Ge=(re=null)=>{re?($e({name:re.name,category:re.category,description:re.description||"",price:re.price,performance:Ae(re.performance,{gaming:"",streaming:""}),features:Ae(re.features,[""]),component_ids:Ae(re.component_ids,{cpu:"",motherboard:"",gpu:"",ram:"",storage:"",psu:"",case:"",cooler:""}),in_stock:re.in_stock==="1",is_hidden:re.is_hidden==="1"}),c(re)):de(),s(!0)},et=()=>{s(!1),de()},Qe=async re=>{re.preventDefault();const Ne=Object.fromEntries(Object.entries(j.component_ids||{}).map(([_e,Xe])=>[String(_e).toLowerCase(),Xe])),at=["cpu","motherboard","gpu","ram","storage","psu","case"].filter(_e=>!Ne[_e]);if(at.length>0){alert("Please select all required components before saving this prebuilt. Missing: "+at.join(", "));return}try{if(!await nr(!1)){alert("Session expired. Please log in again.");return}const Xe=o?ha("prebuilts")+`?id=${o.id}`:ha("prebuilts"),he=await(await qe(Xe,{method:o?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(j)})).json();he.success?(et(),Ee(),alert(o?"Prebuilt updated successfully!":"Prebuilt created successfully!")):alert(he.error||"An error occurred")}catch(_e){console.error("Error saving prebuilt:",_e),alert("An error occurred while saving")}},te=async re=>{if(window.confirm("Are you sure you want to delete this prebuilt?"))try{if(!await nr(!1)){alert("Session expired. Please log in again.");return}const at=await(await qe(ha("prebuilts")+`?id=${re}`,{method:"DELETE"})).json();at.success?(Ee(),alert("Prebuilt deleted successfully!")):alert(at.error||"An error occurred")}catch(Ne){console.error("Error deleting prebuilt:",Ne),alert("An error occurred while deleting")}},De=(re,Ne)=>{$e(je=>({...je,[re]:Ne}))},ze=(re,Ne,je)=>{$e(at=>({...at,[re]:{...at[re],[Ne]:je}}))},ct=()=>{$e(re=>({...re,features:[...re.features,""]}))},Ke=re=>{$e(Ne=>({...Ne,features:Ne.features.filter((je,at)=>at!==re)}))},mt=(re,Ne)=>{$e(je=>({...je,features:je.features.map((at,_e)=>_e===re?Ne:at)}))},ht=t.filter(re=>{const Ne=re.name.toLowerCase().includes(u.toLowerCase()),je=f==="all"||re.category===f;return Ne&&je}),Re=re=>{if(!re)return"";const Ne=p.find(je=>je.id==re);return Ne?Ne.name:`Component ${re}`},tt=re=>{switch(re){case"gaming":return l(Ta,{className:"w-5 h-5"});case"workstation":return l(sb,{className:"w-5 h-5"});case"cooling":return l(ta,{className:"w-5 h-5"});default:return l(Ye,{className:"w-5 h-5"})}},kt=re=>{try{return new Date(re).toLocaleString()}catch{return String(re||"")}},Lt=re=>{const Ne=Number(re)||0;return Ne>=90?{label:"Excellent",color:"text-green-600",bg:"bg-green-100",icon:l(yt,{className:"w-4 h-4"})}:Ne>=70?{label:"Good",color:"text-yellow-600",bg:"bg-yellow-100",icon:l(mo,{className:"w-4 h-4"})}:{label:"Issues",color:"text-red-600",bg:"bg-red-100",icon:l(mo,{className:"w-4 h-4"})}},xe=async()=>{try{if(!await nr(!1))return;const je=await(await qe(`${API_BASE}/index.php?endpoint=community_management&action=stats`)).json();if(je&&je.success){const at={pending:0,approved:0,rejected:0};(je.data||[]).forEach(_e=>{at[_e.status]=Number(_e.count)||0}),z(at)}}catch(re){console.error("Error fetching submission stats:",re)}},Ie=async(re=1)=>{try{if(!await nr(!1))return;_(!0);const at=await(await qe(`${API_BASE}/index.php?endpoint=builds&public=1&page=${re}`)).json();if(at&&at.success){S(Array.isArray(at.data)?at.data:[]);const _e=at.pagination||{};T(Number(_e.pages)||1)}else S([]),T(1)}catch(Ne){console.error("Error fetching public builds:",Ne),S([]),T(1)}finally{_(!1)}},ut=async(re="pending",Ne=1)=>{try{if(!await nr(!1))return;Y(!0);const at=new URLSearchParams;re&&at.append("status",re),at.append("page",String(Ne));const Xe=await(await qe(`${API_BASE}/index.php?endpoint=community_management&action=submissions&${at.toString()}`)).json();if(Xe&&Xe.success){D(Array.isArray(Xe.data)?Xe.data:[]);const Xr=Xe.pagination||{};le(Number(Xr.pages)||1)}else D([]),le(1)}catch(je){console.error("Error fetching community submissions:",je),D([]),le(1)}finally{Y(!1)}};N.useEffect(()=>{xe()},[]),N.useEffect(()=>{ut(W,G)},[W,G]),N.useEffect(()=>{v==="community"&&Ie(E)},[v,E]);const Ht=async(re,Ne)=>{I(!0);try{if(!await nr(!1)){alert("You must be logged in to review submissions.");return}const _e=await(await qe(`${API_BASE}/index.php?endpoint=community_management&action=review`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({submission_id:re,status:Ne,admin_notes:V})})).json();_e&&_e.success?(alert(`Submission ${Ne} successfully!`),ee(null),ae(""),ut(W,G),xe()):alert("Error reviewing submission: "+(_e&&_e.error?_e.error:"Unknown error"))}catch(je){console.error("Error reviewing submission:",je),alert("Error reviewing submission. Please try again.")}finally{I(!1)}},kr=async(re,Ne)=>{if(confirm(`Are you sure you want to delete the submission "${Ne}"? This action cannot be undone.`))try{if(!await nr(!1)){alert("You must be logged in to delete submissions.");return}const _e=await(await qe(ha("delete_submission"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({submission_id:re})})).json();_e&&_e.success?(alert("Submission deleted successfully!"),ut(W,G),xe()):alert("Error deleting submission: "+(_e&&_e.error?_e.error:"Unknown error"))}catch(je){console.error("Error deleting submission:",je),alert("Error deleting submission. Please try again.")}},_r=async re=>{if(window.confirm("Are you sure you want to delete this community build? This action cannot be undone."))try{if(!await nr(!1)){alert("Session expired. Please log in again.");return}const at=await(await qe(`${API_BASE}/index.php?endpoint=builds&id=${re}`,{method:"DELETE"})).json();at.success?(Ie(E),alert("Community build deleted successfully!")):alert(at.error||"An error occurred while deleting the build")}catch(Ne){console.error("Error deleting community build:",Ne),alert("An error occurred while deleting the build")}};return n?l("div",{className:"flex items-center justify-center h-64",children:m("div",{className:"text-center",children:[l("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),l("p",{children:"Loading prebuilts..."})]})}):m("div",{className:"page-container space-y-6",children:[m("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l("h2",{className:"page-title",children:"Prebuilt PC"}),be&&v==="prebuilts"&&l("div",{className:"flex gap-2",children:m("button",{onClick:()=>Ge(),className:"btn btn-primary shadow",children:[l(Vn,{className:"h-4 w-4"}),"Add Prebuilt"]})})]}),m("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg",children:[l("button",{onClick:()=>w("prebuilts"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${v==="prebuilts"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Prebuilt PCs"}),l("button",{onClick:()=>w("community"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${v==="community"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Community Builds"}),be&&l("button",{onClick:()=>w("management"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${v==="management"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Community Management"})]}),!be&&l("div",{className:"text-sm text-gray-600",children:"Note: Curated Prebuilt actions are limited to Admins. You can still view Community builds and manage Community submissions below."}),v==="prebuilts"&&m(lt,{children:[l("div",{className:"card",children:m("div",{className:"flex flex-col md:flex-row gap-4",children:[m("div",{className:"flex-1 relative",children:[l(Wi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),l("input",{type:"text",placeholder:"Search prebuilts...",value:u,onChange:re=>d(re.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),m("select",{value:f,onChange:re=>h(re.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[l("option",{value:"all",children:"All Categories"}),l("option",{value:"gaming",children:"Gaming"}),l("option",{value:"workstation",children:"Workstation"}),l("option",{value:"cooling",children:"Cooling"})]})]})}),l("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:ht.map(re=>m("div",{className:"card overflow-hidden",children:[l("div",{className:"relative",children:m("div",{className:"absolute top-2 left-2 flex gap-2",children:[re.is_hidden==="1"&&l("span",{className:"chip chip-gray",children:"HIDDEN"}),re.in_stock==="0"&&l("span",{className:"chip chip-red",children:"OUT OF STOCK"})]})}),m("div",{className:"p-6",children:[m("div",{className:"flex items-start justify-between mb-2",children:[l("h3",{className:"text-lg font-semibold text-gray-900",children:re.name}),be&&m("div",{className:"flex gap-1",children:[l("button",{onClick:()=>Ge(re),className:"btn btn-outline px-2 py-1",title:"Edit",children:l(_i,{className:"w-4 h-4"})}),l("button",{onClick:()=>te(re.id),className:"btn btn-outline px-2 py-1 text-red-600 border-red-200 hover:bg-red-50",title:"Delete",children:l(an,{className:"w-4 h-4"})})]})]}),m("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-2",children:[tt(re.category),l("span",{className:"capitalize",children:re.category})]}),l("div",{className:"text-lg font-bold text-green-600 mb-2",children:gt(re.price)}),re.description&&l("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:re.description}),l("div",{className:"text-xs text-gray-500 space-y-1",children:(()=>{const Ne=Ae(re.component_ids,{});return m(lt,{children:[m("div",{children:["CPU: ",Re(Ne.cpu)]}),m("div",{children:["GPU: ",Re(Ne.gpu)]}),m("div",{children:["RAM: ",Re(Ne.ram)]})]})})()})]})]},re.id))}),ht.length===0&&m("div",{className:"card empty-state",children:[l(Ye,{className:"w-10 h-10 text-gray-400 mx-auto mb-2"}),l("p",{children:"No prebuilts found"})]})]}),v==="community"&&l(lt,{children:m("div",{className:"card",children:[m("div",{className:"flex items-center justify-between mb-4",children:[l("h3",{className:"text-lg font-semibold text-gray-900",children:"Community Builds"}),l("div",{className:"text-sm text-gray-600",children:k?"Loading...":`${b.length} build(s) found`})]}),b.length===0&&!k&&m("div",{className:"text-center py-8 text-gray-500",children:[l(Ye,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),l("p",{children:"No community builds found."})]}),b.length>0&&l("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:b.map(re=>l("div",{className:"card overflow-hidden",children:m("div",{className:"p-6",children:[m("div",{className:"flex items-start justify-between mb-2",children:[l("h4",{className:"text-lg font-semibold text-gray-900",children:re.build_name||re.name}),be&&l("button",{onClick:()=>_r(re.id),className:"btn btn-outline px-2 py-1 text-red-600 border-red-200 hover:bg-red-50",title:"Delete Build",children:l(an,{className:"w-4 h-4"})})]}),l("div",{className:"text-lg font-bold text-green-600 mb-2",children:gt(re.total_price)}),re.build_description&&l("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:re.build_description}),m("div",{className:"text-xs text-gray-500 space-y-1",children:[m("div",{children:["By: ",re.submitter_name||re.creator_name||"Anonymous"]}),m("div",{children:["Compatibility: ",re.compatibility,"%"]}),m("div",{children:["Submitted: ",kt(re.submitted_at||re.createdAt||re.created_at)]})]})]})},re.id))}),A>1&&m("div",{className:"flex items-center justify-between mt-6 pt-4 border-t border-gray-200",children:[l("button",{onClick:()=>P(re=>Math.max(1,re-1)),disabled:E<=1,className:`px-4 py-2 rounded-md border ${E<=1?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"}`,children:"Previous"}),m("span",{className:"text-sm text-gray-600",children:["Page ",E," of ",A]}),l("button",{onClick:()=>P(re=>Math.min(A,re+1)),disabled:E>=A,className:`px-4 py-2 rounded-md border ${E>=A?"opacity-50 cursor-not-allowed":"hover:bg-gray-50"}`,children:"Next"})]})]})}),v==="management"&&m("div",{className:"card",children:[m("div",{className:"flex items-center justify-between mb-4",children:[m("div",{className:"flex items-center gap-2",children:[l(md,{className:"w-5 h-5 text-green-600"}),l("h3",{className:"text-lg font-semibold text-gray-900",children:"Community Management"})]}),m("div",{className:"flex gap-2 text-sm",children:[m("span",{className:"px-2 py-1 rounded-full bg-gray-100 text-gray-700",children:["Pending: ",L.pending||0]}),m("span",{className:"px-2 py-1 rounded-full bg-green-100 text-green-700",children:["Approved: ",L.approved||0]}),m("span",{className:"px-2 py-1 rounded-full bg-red-100 text-red-700",children:["Rejected: ",L.rejected||0]})]})]}),l("div",{className:"flex items-center gap-2 mb-4",children:["pending","approved","rejected"].map(re=>m("button",{onClick:()=>{U(re),ne(1)},className:`px-4 py-2 rounded-md border ${W===re?"bg-white text-green-600 border-green-300":"text-gray-600 hover:text-gray-900 border-gray-200"}`,children:[re.charAt(0).toUpperCase()+re.slice(1),re==="pending"&&(L.pending||0)>0&&l("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:L.pending})]},re))}),m("div",{className:"border rounded-lg overflow-hidden",children:[m("div",{className:"bg-gray-50 px-4 py-2 text-sm text-gray-600 flex items-center gap-2",children:[l(ho,{className:"w-4 h-4"}),X?"Loading submissions...":`${R.length} ${W} submission(s)`]}),R.length===0&&!X&&m("div",{className:"p-6 text-center text-gray-500",children:["No ",W," submissions found."]}),R.length>0&&l("div",{className:"divide-y",children:R.map(re=>{var je;const Ne=Lt(re.compatibility);return m("div",{className:"p-4 flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[m("div",{className:"flex-1 min-w-0",children:[m("div",{className:"flex items-center gap-2 flex-wrap",children:[l("span",{className:"font-semibold text-gray-900 truncate",children:re.build_name}),m("span",{className:`inline-flex items-center gap-1 text-xs px-2 py-0.5 rounded-full ${Ne.bg} ${Ne.color}`,children:[Ne.icon,Ne.label]}),m("span",{className:"text-xs text-gray-500",children:["",Number(re.total_price||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),m("div",{className:"text-xs text-gray-600 mt-1 flex flex-wrap gap-2",children:[m("span",{children:["By: ",l("span",{className:"font-medium",children:re.submitter_name||"Unknown"})]}),re.submitter_email&&m("span",{children:["(",re.submitter_email,")"]}),m("span",{children:["Submitted: ",kt(re.submitted_at)]}),re.reviewer_name&&re.reviewed_at&&m("span",{children:["Reviewed by ",re.reviewer_name," on ",kt(re.reviewed_at)]})]}),re.build_description&&l("p",{className:"text-sm text-gray-700 mt-2 line-clamp-2",children:re.build_description})]}),l("div",{className:"flex items-center gap-2",children:W==="pending"?l("button",{onClick:()=>{ee(re),ae(re.admin_notes||"")},className:"px-4 py-2 rounded-md bg-green-600 hover:bg-green-700 text-white",children:"Review"}):m("div",{className:"flex items-center gap-2",children:[l("span",{className:"text-xs text-gray-500",children:(je=re.status)==null?void 0:je.toUpperCase()}),l("button",{onClick:()=>kr(re.id,re.build_name),className:"px-3 py-1 rounded-md bg-red-600 hover:bg-red-700 text-white text-sm",children:"Delete"})]})})]},re.id)})}),m("div",{className:"flex items-center justify-between px-4 py-3 bg-gray-50 text-sm text-gray-600",children:[l("button",{onClick:()=>ne(re=>Math.max(1,re-1)),disabled:G<=1,className:`px-3 py-1 rounded border ${G<=1?"opacity-50 cursor-not-allowed":"hover:bg-white"}`,children:"Prev"}),m("span",{children:["Page ",G," of ",K]}),l("button",{onClick:()=>ne(re=>Math.min(K,re+1)),disabled:G>=K,className:`px-3 py-1 rounded border ${G>=K?"opacity-50 cursor-not-allowed":"hover:bg-white"}`,children:"Next"})]})]})]}),q&&l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:m("div",{className:"bg-white rounded-xl max-w-2xl w-full",children:[m("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[l("h3",{className:"text-xl font-semibold text-gray-900",children:"Review Submission"}),l("button",{onClick:()=>ee(null),className:"text-gray-400 hover:text-gray-600",children:l(Gn,{className:"w-6 h-6"})})]}),m("div",{className:"p-6 space-y-4",children:[m("div",{children:[l("div",{className:"text-sm text-gray-500",children:"Build Name"}),l("div",{className:"text-base font-semibold text-gray-900",children:q.build_name})]}),m("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-700",children:[m("div",{children:["Submitter: ",l("span",{className:"font-medium",children:q.submitter_name})]}),m("div",{children:["Submitted: ",kt(q.submitted_at)]}),m("div",{children:["Compatibility: ",q.compatibility,"%"]}),m("div",{children:["Total Price: ",Number(q.total_price||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),q.build_description&&m("div",{children:[l("div",{className:"text-sm text-gray-500 mb-1",children:"Description"}),l("p",{className:"text-sm text-gray-800 whitespace-pre-wrap",children:q.build_description})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Admin Notes (optional)"}),l("textarea",{value:V,onChange:re=>ae(re.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Add a note to the submitter (optional)"})]})]}),m("div",{className:"p-6 border-t border-gray-200 flex items-center justify-end gap-2",children:[l("button",{onClick:()=>ee(null),className:"px-4 py-2 rounded-md border",children:"Cancel"}),l("button",{disabled:oe,onClick:()=>Ht(q.id,"rejected"),className:`px-4 py-2 rounded-md bg-red-600 hover:bg-red-700 text-white ${oe?"opacity-60 cursor-not-allowed":""}`,children:"Reject"}),l("button",{disabled:oe,onClick:()=>Ht(q.id,"approved"),className:`px-4 py-2 rounded-md bg-green-600 hover:bg-green-700 text-white ${oe?"opacity-60 cursor-not-allowed":""}`,children:"Approve"})]})]})}),i&&l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:m("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[l("div",{className:"p-6 border-b border-gray-200",children:m("div",{className:"flex items-center justify-between",children:[l("h3",{className:"text-xl font-semibold text-gray-900",children:o?"Edit Prebuilt":"Add New Prebuilt"}),l("button",{onClick:et,className:"text-gray-400 hover:text-gray-600",children:l(Gn,{className:"w-6 h-6"})})]})}),m("form",{onSubmit:Qe,className:"p-6 space-y-6",children:[m("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name"}),l("input",{type:"text",value:j.name,onChange:re=>De("name",re.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),m("select",{value:j.category,onChange:re=>De("category",re.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[l("option",{value:"gaming",children:"Gaming"}),l("option",{value:"workstation",children:"Workstation"}),l("option",{value:"cooling",children:"Cooling"})]})]})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),l("textarea",{value:j.description,onChange:re=>De("description",re.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price ()"}),l("input",{type:"number",value:j.price,onChange:re=>De("price",re.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Performance (optional)"}),m("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[m("div",{children:[l("label",{className:"block text-xs text-gray-600 mb-1",children:"Gaming (%)"}),l("input",{type:"number",min:"0",max:"100",value:j.performance.gaming,onChange:re=>ze("performance","gaming",re.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),m("div",{children:[l("label",{className:"block text-xs text-gray-600 mb-1",children:"Streaming (%)"}),l("input",{type:"number",min:"0",max:"100",value:j.performance.streaming,onChange:re=>ze("performance","streaming",re.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})]})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Features"}),m("div",{className:"space-y-2",children:[j.features.map((re,Ne)=>m("div",{className:"flex gap-2",children:[l("input",{type:"text",value:re,onChange:je=>mt(Ne,je.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Enter feature"}),l("button",{type:"button",onClick:()=>Ke(Ne),className:"px-3 py-2 text-red-500 hover:text-red-700",children:l(Gn,{className:"w-4 h-4"})})]},Ne)),m("button",{type:"button",onClick:ct,className:"text-green-600 hover:text-green-700 text-sm flex items-center gap-1",children:[l(Vn,{className:"w-4 h-4"}),"Add Feature"]})]})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Components"}),l("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(j.component_ids).map(([re,Ne])=>m("div",{children:[l("label",{className:"block text-xs text-gray-600 mb-1 capitalize",children:re}),m("select",{value:Ne,onChange:je=>ze("component_ids",re,je.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[m("option",{value:"",children:["Select ",re]}),p.filter(je=>{const at=g.find(Xe=>Xe.id==je.category_id);if(!at)return!1;const _e=at.name.toLowerCase();switch(re){case"cpu":return _e.includes("cpu")||_e.includes("procie")||_e.includes("processor");case"motherboard":return _e.includes("mobo")||_e.includes("motherboard");case"gpu":return _e.includes("gpu")||_e.includes("graphics");case"ram":return _e.includes("ram")||_e.includes("memory");case"storage":return _e.includes("storage")||_e.includes("ssd")||_e.includes("hdd")||_e.includes("hard drive");case"psu":return _e.includes("psu")||_e.includes("power supply");case"case":return _e.includes("case")||_e.includes("chassis");case"cooler":return _e.includes("cooler")||_e.includes("aio")||_e.includes("fan")||_e.includes("heatsink");default:return!1}}).map(je=>m("option",{value:je.id,children:[je.name," - ",gt(je.price)]},je.id))]})]},re))})]}),m("div",{className:"flex gap-4",children:[m("label",{className:"flex items-center",children:[l("input",{type:"checkbox",checked:j.in_stock,onChange:re=>De("in_stock",re.target.checked),className:"mr-2"}),l("span",{className:"text-sm text-gray-700",children:"In Stock"})]}),m("label",{className:"flex items-center",children:[l("input",{type:"checkbox",checked:j.is_hidden,onChange:re=>De("is_hidden",re.target.checked),className:"mr-2"}),l("span",{className:"text-sm text-gray-700",children:"Hidden"})]})]}),m("div",{className:"flex justify-end gap-4 pt-6 border-t border-gray-200",children:[l("button",{type:"button",onClick:et,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),m("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2",children:[l(om,{className:"w-4 h-4"}),o?"Update":"Create"]})]})]})]})})]})},BM=()=>m("div",{children:[l("h2",{children:"Admin Reports"}),l("p",{children:"This is a placeholder for Admin Reports. Please implement report logic as needed."})]}),Zl=["#6366F1","#22D3EE","#F59E42","#F472B6","#A3E635","#F87171","#60A5FA","#FBBF24","#34D399","#818CF8"],SN=({reports:e={},inventory:t=[],categories:r=[],formalCategoryNames:n={},deadstockPeriod:a=90,onDeadstockPeriodChange:i,isLoading:s})=>{var ae,oe;if(s)return m("div",{className:"flex flex-col items-center justify-center min-h-[300px] py-12",children:[l("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500 mb-4"}),l("div",{className:"text-gray-500 text-lg",children:"Loading Sales Reports..."})]});const{monthly_sales:o=[],daily_sales:c=[],weekly_sales:u=[],top_selling_products:d=[],revenue_per_category:f=[],revenue_per_brand:h=[],deadstock:p=[],stock_movement:x=[],order_status_breakdown:g=[],average_order_value:y={}}=e,[v,w]=N.useState("all"),[b,S]=N.useState("monthly"),[k,_]=N.useState(!0),[E,P]=N.useState(""),[A,T]=N.useState(1),R=10,D=["CPU","Motherboard","GPU","RAM","Storage","PSU","Case","Cooler","Procie Only","Mobo","Ram 3200mhz","Ssd Nvme","Psu - Tr","Case Gaming","Aio"],L=(r||[]).filter(I=>D.includes(I.name)),z=p||[],X=Array.from(new Set(z.map(I=>{const W=t.find(U=>U.id===I.id);return W!=null&&W.category_id?String(W.category_id):null}).filter(Boolean))),Y=L.filter(I=>X.includes(String(I.id))),q=(v==="all"?z:z.filter(I=>{var U;const W=(U=t.find(G=>G.id===I.id))==null?void 0:U.category_id;return String(W)===String(v)})).filter(I=>{var ne,K;const W=E.trim().toLowerCase();if(!W)return!0;const U=((ne=I.name)==null?void 0:ne.toLowerCase())||"",G=((K=I.brand)==null?void 0:K.toLowerCase())||"";return U.includes(W)||G.includes(W)});let ee=[],V=null;return b==="monthly"?(ee=o,V=l(ga,{width:"100%",height:250,children:m(Yc,{data:o,margin:{top:10,right:20,left:0,bottom:0},children:[l(ba,{strokeDasharray:"3 3"}),l(wa,{dataKey:"month",label:{value:"Month",position:"insideBottomRight",offset:0}}),l(Na,{}),l(Bn,{}),l(Qr,{}),l(kl,{type:"monotone",dataKey:"total_sales",stroke:"#6366F1",strokeWidth:3})]})})):b==="weekly"?(ee=u,V=l(ga,{width:"100%",height:250,children:m(Yc,{data:u,margin:{top:10,right:20,left:0,bottom:0},children:[l(ba,{strokeDasharray:"3 3"}),l(wa,{dataKey:"week",label:{value:"Week",position:"insideBottomRight",offset:0}}),l(Na,{}),l(Bn,{}),l(Qr,{}),l(kl,{type:"monotone",dataKey:"total_sales",stroke:"#22D3EE",strokeWidth:3})]})})):b==="daily"&&(ee=c,V=l(ga,{width:"100%",height:250,children:m(Ec,{data:c,margin:{top:10,right:20,left:0,bottom:0},children:[l(ba,{strokeDasharray:"3 3"}),l(wa,{dataKey:"day",label:{value:"Day",position:"insideBottomRight",offset:0}}),l(Na,{}),l(Bn,{}),l(Qr,{}),l(Xs,{dataKey:"total_sales",fill:"#F59E42"})]})})),m("div",{className:"page-container space-y-8",children:[l("h2",{className:"page-title",children:"Sales Reports & Analytics"}),m("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[m("div",{className:"card",children:[l("div",{className:"text-sm text-gray-500",children:"Average Order Value"}),l("div",{className:"text-2xl font-bold text-gray-900",children:gt((y==null?void 0:y.value)||0)})]}),m("div",{className:"card",children:[l("div",{className:"text-sm text-gray-500",children:"Top Category"}),l("div",{className:"text-2xl font-bold text-gray-900",children:((ae=f==null?void 0:f[0])==null?void 0:ae.category)||""})]}),m("div",{className:"card",children:[l("div",{className:"text-sm text-gray-500",children:"Top Product"}),l("div",{className:"text-2xl font-bold text-gray-900",children:((oe=d==null?void 0:d[0])==null?void 0:oe.product_name)||""})]})]}),m("div",{className:"space-y-6",children:[m("div",{className:"card chart-card",children:[m("div",{className:"flex items-center justify-between mb-6",children:[l("h3",{className:"text-lg font-semibold text-gray-900",children:"Sales Overview"}),m("div",{className:"flex items-center gap-2",children:[l("label",{htmlFor:"sales-chart-type",className:"text-sm text-gray-600",children:"View:"}),m("select",{id:"sales-chart-type",className:"text-sm border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",value:b,onChange:I=>S(I.target.value),children:[l("option",{value:"monthly",children:"Monthly"}),l("option",{value:"weekly",children:"Weekly"}),l("option",{value:"daily",children:"Daily"})]})]})]}),l("div",{className:"h-[320px]",children:ee&&ee.length>0?V:m("div",{className:"flex flex-col items-center justify-center h-full p-6",children:[l(Ye,{className:"w-12 h-12 text-gray-300 mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-2 text-center",children:"No data available"}),l("p",{className:"text-gray-400 text-sm max-w-md text-center",children:"This could be because there are no completed orders yet or the system is still collecting data."})]})})]}),l("div",{className:"flex justify-end",children:m("button",{className:`btn ${k?"btn-primary":"btn-secondary"}`,onClick:()=>_(I=>!I),children:[k?l(RT,{className:"h-4 w-4"}):l(lo,{className:"h-4 w-4"}),k?"Hide Deadstock":"Show Deadstock"]})}),k&&m("div",{className:"card",children:[l("div",{className:"p-6 border-b border-gray-200",children:m("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[m("h3",{className:"text-lg font-semibold text-gray-900",children:["Deadstock (No Sales in ",a," Days)"]}),m("div",{className:"flex gap-2",children:[l("input",{type:"text",className:"border rounded px-3 py-1.5 text-sm w-full sm:w-64",placeholder:"Search by name or brand...",value:E,onChange:I=>P(I.target.value)}),m("select",{className:"border rounded px-3 py-1.5 text-sm",value:v,onChange:I=>{w(I.target.value),T(1)},children:[l("option",{value:"all",children:"All Categories"}),Y.map(I=>l("option",{value:I.id,children:I.name},I.id))]})]})]})}),l("div",{className:"overflow-x-auto",children:q.length>0?m("div",{children:[l("div",{className:"min-w-full divide-y divide-gray-200",children:m("table",{className:"min-w-full",children:[l("thead",{className:"bg-gray-50",children:m("tr",{children:[l("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Component"}),l("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Qty"}),l("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Price"}),l("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Total Value"}),l("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Last Sold"})]})}),l("tbody",{className:"bg-white divide-y divide-gray-200",children:q.slice((A-1)*R,A*R).map(I=>m("tr",{className:"hover:bg-gray-50",children:[l("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:I.name}),l("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:I.stock_quantity}),l("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:gt(I.price)}),l("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:gt(Number(I.price)*Number(I.stock_quantity))}),l("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:I.last_sold_date?new Date(I.last_sold_date).toLocaleDateString():"Never"})]},I.id))})]})}),q.length>R&&m("div",{className:"flex items-center justify-between mt-4 px-4 py-3 bg-white border-t border-gray-200 sm:px-6",children:[m("div",{className:"flex-1 flex justify-between sm:hidden",children:[l("button",{onClick:()=>T(I=>Math.max(1,I-1)),disabled:A===1,className:`relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md ${A===1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"Previous"}),l("button",{onClick:()=>T(I=>Math.min(Math.ceil(q.length/R),I+1)),disabled:A===Math.ceil(q.length/R),className:`ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md ${A===Math.ceil(q.length/R)?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"Next"})]}),m("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[l("div",{children:m("p",{className:"text-sm text-gray-700",children:["Showing ",l("span",{className:"font-medium",children:(A-1)*R+1})," to"," ",l("span",{className:"font-medium",children:Math.min(A*R,q.length)})," ","of ",l("span",{className:"font-medium",children:q.length})," results"]})}),l("div",{children:m("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[m("button",{onClick:()=>T(I=>Math.max(1,I-1)),disabled:A===1,className:`relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium ${A===1?"text-gray-300 cursor-not-allowed":"text-gray-500 hover:bg-gray-50"}`,children:[l("span",{className:"sr-only",children:"Previous"}),l("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:l("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})})]}),Array.from({length:Math.ceil(q.length/R)},(I,W)=>W+1).map(I=>l("button",{onClick:()=>T(I),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${A===I?"z-10 bg-indigo-50 border-indigo-500 text-indigo-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:I},I)),m("button",{onClick:()=>T(I=>Math.min(Math.ceil(q.length/R),I+1)),disabled:A===Math.ceil(q.length/R),className:`relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium ${A===Math.ceil(q.length/R)?"text-gray-300 cursor-not-allowed":"text-gray-500 hover:bg-gray-50"}`,children:[l("span",{className:"sr-only",children:"Next"}),l("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:l("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})]})]})})]})]})]}):m("div",{className:"text-center py-8 w-full",children:[l(Ye,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-2 text-center",children:"No deadstock data available"}),l("div",{className:"text-center w-full",children:l("p",{className:"text-gray-400 text-sm max-w-md mx-auto text-center leading-relaxed",style:{textAlign:"center",marginLeft:"auto",marginRight:"auto"},children:"This could be because there are no components with no sales in the specified period, or the system is still collecting data."})})]})})]}),m("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[m("div",{className:"card chart-card",children:[m("div",{className:"flex items-center justify-between mb-2",children:[l("h3",{className:"text-lg font-semibold text-gray-900",children:"Top-Selling Products"}),l("span",{className:"text-xs text-gray-500",children:"Qty vs Revenue"})]}),l("div",{className:"h-[320px]",children:d&&d.length>0?m(Ec,{data:d,layout:"vertical",margin:{top:10,right:20,left:0,bottom:0},children:[l(ba,{strokeDasharray:"3 3"}),l(wa,{type:"number"}),l(Na,{dataKey:"name",type:"category",width:120}),l(Bn,{}),l(Qr,{wrapperStyle:{fontSize:12}}),l(Xs,{dataKey:"total_quantity",fill:"#6366F1",name:"Quantity Sold"}),l(Xs,{dataKey:"total_revenue",fill:"#F59E42",name:"Revenue"})]}):m("div",{className:"flex flex-col items-center justify-center h-full p-6",children:[l(Ye,{className:"w-12 h-12 text-gray-300 mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-2 text-center",children:"No data available"}),l("p",{className:"text-gray-400 text-sm max-w-md text-center",children:"This could be because there are no completed orders yet or the system is still collecting data."})]})})]}),m("div",{className:"card chart-card",children:[l("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Revenue by Category"}),l("div",{className:"h-[300px] flex items-center justify-center",children:f&&f.length>0?m(Rx,{width:350,height:250,children:[l(pm,{data:f,dataKey:"total_revenue",nameKey:"category",cx:"50%",cy:"50%",outerRadius:80,label:({name:I,percent:W})=>`${I}: ${(W*100).toFixed(0)}%`,children:f.map((I,W)=>l(il,{fill:Zl[W%Zl.length]},`cell-${W}`))}),l(Bn,{formatter:I=>[gt(I),"Revenue"]}),l(Qr,{})]}):m("div",{className:"flex flex-col items-center justify-center h-full p-6",children:[l(Ye,{className:"w-12 h-12 text-gray-300 mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-2 text-center",children:"No data available"}),l("p",{className:"text-gray-400 text-sm max-w-md text-center",children:"This could be because there are no completed orders yet or the system is still collecting data."})]})})]}),m("div",{className:"card chart-card",children:[m("div",{className:"flex items-center gap-2 mb-4",children:[l(Ye,{className:"h-5 w-5 text-blue-500"}),l("h3",{className:"text-lg font-bold text-gray-900",children:"Revenue by Brand"})]}),l("div",{className:"h-[250px]",children:h&&h.length>0?l(ga,{width:"100%",height:250,children:m(Rx,{children:[l(pm,{data:h,dataKey:"total_revenue",nameKey:"brand",cx:"50%",cy:"50%",outerRadius:80,label:!0,children:h.map((I,W)=>l(il,{fill:Zl[W%Zl.length]},`brand-${W}`))}),l(Bn,{}),l(Qr,{})]})}):m("div",{className:"flex flex-col items-center justify-center h-full p-6",children:[l(Ye,{className:"w-12 h-12 text-gray-300 mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-2 text-center",children:"No data available"}),l("p",{className:"text-gray-400 text-sm max-w-md text-center",children:"This could be because there are no completed orders yet or the system is still collecting data."})]})})]}),m("div",{className:"card chart-card",children:[m("div",{className:"flex items-center gap-2 mb-4",children:[l(FS,{className:"h-5 w-5 text-green-500"}),l("h3",{className:"text-lg font-bold text-gray-900",children:"Order Status Breakdown"})]}),l("div",{className:"h-[250px]",children:g&&g.length>0?l(ga,{width:"100%",height:250,children:m(Rx,{children:[l(pm,{data:g,dataKey:"count",nameKey:"status",cx:"50%",cy:"50%",outerRadius:80,label:!0,children:g.map((I,W)=>l(il,{fill:Zl[W%Zl.length]},`status-${W}`))}),l(Bn,{}),l(Qr,{})]})}):m("div",{className:"flex flex-col items-center justify-center h-full p-6",children:[l(Ye,{className:"w-12 h-12 text-gray-300 mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-2 text-center",children:"No data available"}),l("p",{className:"text-gray-400 text-sm max-w-md text-center",children:"This could be because there are no completed orders yet or the system is still collecting data."})]})})]})]}),l("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mt-8",children:m("div",{className:"card chart-card",children:[m("div",{className:"flex items-center gap-2 mb-4",children:[l(Bc,{className:"h-5 w-5 text-teal-500"}),l("h3",{className:"text-lg font-bold text-gray-900",children:"Stock Movement (Last 30 Days)"})]}),l(ga,{width:"100%",height:250,children:m(Ec,{data:x,layout:"vertical",margin:{top:10,right:20,left:0,bottom:0},children:[l(ba,{strokeDasharray:"3 3"}),l(wa,{type:"number"}),l(Na,{dataKey:"name",type:"category",width:120}),l(Bn,{}),l(Qr,{}),l(Xs,{dataKey:"sold_last_30_days",fill:"#22D3EE",name:"Sold (30d)"})]})})]})}),m("div",{className:"card p-8 max-w-md mx-auto mt-10 flex flex-col items-center",children:[m("div",{className:"flex items-center gap-2 mb-2",children:[l(FS,{className:"h-7 w-7 text-indigo-500"}),l("h3",{className:"text-lg font-bold text-gray-900",children:"Average Order Value"})]}),l("div",{className:"text-4xl font-extrabold text-green-700",children:gt((y==null?void 0:y.avg_order_value)||0)})]})]})]})},kN=({value:e="",onChange:t,inventory:r=[],categories:n=[],placeholder:a="Search components...",className:i="",disabled:s=!1})=>{const[o,c]=N.useState(""),[u,d]=N.useState(!1),[f,h]=N.useState(!1),[p,x]=N.useState(null),[g,y]=N.useState("all"),v=N.useRef(null),w=N.useRef(null),b=[{key:"all",name:"All",icon:null},{key:"CPU",name:"CPU",icon:ua},{key:"Motherboard",name:"Motherboard",icon:up},{key:"GPU",name:"GPU",icon:Ki},{key:"RAM",name:"RAM",icon:ti},{key:"Storage",name:"Storage",icon:au},{key:"PSU",name:"PSU",icon:Ta},{key:"Case",name:"Case",icon:Ye},{key:"Cooler",name:"Cooler",icon:ta}];N.useEffect(()=>{if(e&&r.length>0){const D=r.find(L=>L.id.toString()===e.toString());D&&(x(D),c(D.name))}},[e,r]);const S=D=>{if(!n.length)return null;const L=n.find(X=>X.id===Number(D.category_id));return L&&{CPU:"CPU","Procie Only":"CPU","Pro & Mobo - Amd":"CPU","Pro & Mobo - Intel":"CPU",Motherboard:"Motherboard",Mobo:"Motherboard",GPU:"GPU",RAM:"RAM","Ram 3200mhz":"RAM",Storage:"Storage","Ssd Nvme":"Storage",PSU:"PSU","Psu - Tr":"PSU",Case:"Case","Case Gaming":"Case",Cooler:"Cooler",Aio:"Cooler"}[L.name]||null},k=r.filter(D=>{const L=o===""||D.name.toLowerCase().includes(o.toLowerCase())||D.brand&&D.brand.toLowerCase().includes(o.toLowerCase()),z=g==="all"||S(D)===g;return L&&z}).slice(0,20),_=k.reduce((D,L)=>{const z=S(L)||"Other";return D[z]||(D[z]=[]),D[z].push(L),D},{}),E=D=>{const L=D.target.value;c(L),d(L.length>0),p&&L!==p.name&&(x(null),t(""))},P=D=>{x(D),c(D.name),d(!1),h(!1),t(D.id.toString())},A=()=>{var D;x(null),c(""),d(!1),h(!1),t(""),(D=v.current)==null||D.focus()},T=D=>{setTimeout(()=>{var L;(L=w.current)!=null&&L.contains(D.relatedTarget)||d(!1)},150)},R=D=>{var L;D.key==="Escape"&&(d(!1),h(!1),(L=v.current)==null||L.blur())};return m("div",{className:`relative ${i}`,children:[m("div",{className:"relative",children:[l(Wi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),l("input",{ref:v,type:"text",value:o,onChange:E,onFocus:()=>{d(!0),h(!1)},onBlur:T,onKeyDown:R,placeholder:a,disabled:s,className:`w-full pl-10 pr-10 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent ${s?"bg-gray-50 cursor-not-allowed":"bg-white"}`}),l("button",{type:"button",onClick:()=>{h(!f),d(!1)},disabled:s,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:l(cp,{className:"w-4 h-4"})}),p&&!s&&l("button",{type:"button",onClick:A,className:"absolute right-8 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:l(Gn,{className:"w-4 h-4"})})]}),l("div",{className:"mb-4",children:l("div",{className:"flex flex-wrap gap-2",children:b.map(D=>{const L=D.icon;return m("button",{type:"button",onClick:()=>y(D.key),disabled:s,className:`flex items-center gap-2 px-4 py-2 text-sm rounded-lg border transition-colors ${g===D.key?"bg-blue-100 text-blue-700 border-blue-300 shadow-sm":"bg-gray-100 text-gray-600 border-gray-300 hover:bg-gray-200 hover:shadow-sm"} ${s?"cursor-not-allowed opacity-50":"cursor-pointer"}`,children:[L&&l(L,{className:"w-4 h-4"}),D.name]},D.key)})})}),(u||f)&&!s&&m("div",{ref:w,className:"absolute z-[9999] w-full mt-2 bg-white border border-gray-300 rounded-lg shadow-2xl max-h-[32rem] overflow-y-auto",style:{maxHeight:"32rem",minHeight:"12rem"},children:[l("div",{onClick:()=>{x(null),c(""),t(""),d(!1),h(!1)},className:"px-6 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 text-gray-500 font-medium",children:"Select Component"}),Object.entries(_).map(([D,L])=>{const z=b.find(Y=>Y.key===D),X=z==null?void 0:z.icon;return m("div",{children:[m("div",{className:"px-6 py-3 bg-gray-50 border-b border-gray-200 flex items-center gap-3 text-sm font-semibold text-gray-700",children:[X&&l(X,{className:"w-5 h-5"}),D," (",L.length,")"]}),L.map(Y=>m("div",{onClick:()=>P(Y),className:"px-6 py-4 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0 flex items-center justify-between transition-colors",children:[m("div",{className:"flex-1",children:[l("div",{className:"font-medium text-gray-900 text-base",children:Y.name}),Y.brand&&l("div",{className:"text-sm text-gray-500 mt-1",children:Y.brand}),Y.price&&m("div",{className:"text-sm text-green-600 font-semibold mt-1",children:["",Y.price.toLocaleString()]})]}),p&&p.id===Y.id&&l(rb,{className:"w-5 h-5 text-green-500 flex-shrink-0"})]},Y.id))]},D)}),k.length===0&&m("div",{className:"px-6 py-8 text-gray-500 text-center",children:[l("div",{className:"text-lg font-medium mb-2",children:"No components found"}),l("div",{className:"text-sm",children:"Try adjusting your search terms or category filter"})]})]})]})},Xx={Aio:"CPU Cooler (AIO)","Case Gaming":"PC Case (Gaming)",GPU:"Graphics Card (GPU)",Mobo:"Motherboard","Procie Only":"Processor (CPU)",PSU:"Power Supply (PSU)","Psu - Tr":"Power Supply (PSU, True Rated)","Ram 3200mhz":"Memory (RAM, 3200MHz)","Ssd Nvme":"Storage (SSD NVMe)",Cooler:"CPU Cooler",RAM:"Memory (RAM)",Storage:"Storage",Case:"PC Case",Motherboard:"Motherboard",CPU:"Processor (CPU)"},Nfe=()=>{const[e,t]=N.useState([]),[r,n]=N.useState(!0),[a,i]=N.useState(null);N.useEffect(()=>{s()},[]);const s=async()=>{n(!0);try{const d=await(await qe(ha("view_feedback"))).json();d.success&&t(d.data)}catch(u){console.error("Error fetching feedback:",u)}finally{n(!1)}},o=u=>{switch(u){case"new":return"bg-blue-100 text-blue-800";case"in_progress":return"bg-yellow-100 text-yellow-800";case"resolved":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},c=u=>new Date(u).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return r?m("div",{className:"text-center py-12",children:[l("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),l("p",{className:"text-gray-600",children:"Loading feedback..."})]}):m("div",{className:"space-y-6",children:[m("div",{className:"flex items-center justify-between",children:[l("h2",{className:"text-2xl font-bold text-gray-900",children:"Contact Feedback"}),l("button",{onClick:s,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Refresh"})]}),e.length===0?m("div",{className:"text-center py-12",children:[l(Ca,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No feedback received"}),l("p",{className:"text-gray-600",children:"Contact form submissions will appear here."})]}):l("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:l("div",{className:"overflow-x-auto",children:m("table",{className:"min-w-full divide-y divide-gray-200",children:[l("thead",{className:"bg-gray-50",children:m("tr",{children:[l("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),l("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),l("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject"}),l("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rating"}),l("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),l("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),l("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),l("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(u=>m("tr",{className:"hover:bg-gray-50",children:[l("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:u.name}),l("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:u.email}),l("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:u.subject}),l("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:u.rating>0?`${u.rating}/5`:"No rating"}),l("td",{className:"px-6 py-4 whitespace-nowrap",children:l("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${o(u.status)}`,children:u.status.replace("_"," ").toUpperCase()})}),l("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:c(u.created_at)}),l("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:l("button",{onClick:()=>i(u),className:"text-green-600 hover:text-green-900 mr-3",children:"View"})})]},u.id))})]})})}),a&&l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:m("div",{className:"p-6",children:[m("div",{className:"flex items-center justify-between mb-4",children:[l("h3",{className:"text-xl font-semibold text-gray-900",children:"Feedback Details"}),l("button",{onClick:()=>i(null),className:"text-gray-400 hover:text-gray-600",children:l(Gn,{className:"w-6 h-6"})})]}),m("div",{className:"space-y-4",children:[m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),l("p",{className:"mt-1 text-sm text-gray-900",children:a.name})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),l("p",{className:"mt-1 text-sm text-gray-900",children:a.email})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Subject"}),l("p",{className:"mt-1 text-sm text-gray-900",children:a.subject})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Rating"}),l("p",{className:"mt-1 text-sm text-gray-900",children:a.rating>0?`${a.rating}/5`:"No rating provided"})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Message"}),l("div",{className:"mt-1 p-3 bg-gray-50 rounded-lg",children:l("p",{className:"text-sm text-gray-900 whitespace-pre-wrap",children:a.message})})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Submitted"}),l("p",{className:"mt-1 text-sm text-gray-900",children:c(a.created_at)})]})]}),l("div",{className:"mt-6 flex justify-end",children:l("button",{onClick:()=>i(null),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors",children:"Close"})})]})})})]})},Lo=({initialTab:e,user:t})=>{const[r,n]=N.useState(e||"dashboard"),[a,i]=N.useState([]),[s,o]=N.useState([]);N.useState([]);const[c,u]=N.useState({}),[d,f]=N.useState(!0),[h,p]=N.useState(!0),[x,g]=N.useState(null),[y,v]=N.useState("monthly"),[w,b]=N.useState([]);N.useState([]),N.useState(!1);const[S,k]=N.useState(!1),[_,E]=N.useState(null),[P,A]=N.useState(null),[T,R]=N.useState(null),[D,L]=N.useState(90);N.useState({});const[z,X]=N.useState(null),Y=async W=>{if(window.confirm("Are you sure you want to delete this order?"))try{const U=await qe(`${ve}/index.php?endpoint=orders&id=${W}`,{method:"DELETE",headers:{"Content-Type":"application/json"}}),G=await U.json();if(!U.ok||!G.success)throw new Error(G.error||"Failed to delete order");o(ne=>ne.filter(K=>K.id!==W)),alert("Order deleted successfully")}catch(U){console.error("Delete order error:",U),alert(`Failed to delete order: ${U.message}`)}};N.useEffect(()=>{e&&e!==r&&n(e)},[e]),N.useEffect(()=>{const W=async(G=!1)=>{G&&f(!0),g(null);try{if(!await y8()){g("Session expired. Please log in again."),G&&f(!1);return}const K=await qe(`${ve}/index.php?endpoint=dashboard&period=${D}${z?`&branch=${z}`:""}`);if(K.status===401){g("Authentication failed. Please log in again."),G&&f(!1);return}const le=await K.text();let Q;try{Q=JSON.parse(le)}catch(ce){console.error("JSON parse error:",ce),g("Server returned invalid JSON.");return}if(Q.success){const ce=Q.data;i(ce.inventory||[]),o(ce.orders||[]),u(ce.reports||{})}else console.error("API error:",Q.error),g(Q.error||"API call was not successful")}catch(ne){console.error("Error fetching admin dashboard data:",ne),g("Error fetching admin dashboard data.")}finally{G&&f(!1)}};W(!0);const U=setInterval(()=>{W(!1)},3e4);return()=>{clearInterval(U)}},[]),N.useEffect(()=>{(async()=>{if(!await nr()){g("Session expired. Please log in again.");return}qe(`${ve}/index.php?endpoint=dashboard&period=${D}${z?`&branch=${z}`:""}`).then(U=>U.text()).then(U=>{let G;try{G=JSON.parse(U)}catch{g("Server returned invalid JSON.");return}if(G.success){const ne=G.data;i(ne.inventory||[]),o(ne.orders||[]),u(ne.reports||{})}else g(G.error||"API call was not successful")}).catch(()=>g("Error fetching dashboard data."))})()},[D,z]),N.useEffect(()=>{(async()=>{p(!0);try{const G=await(await qe(`${ve}/index.php?endpoint=categories`)).json();G.success&&Array.isArray(G.data)?b(G.data):(console.error("Failed to load categories:",G),b([]))}catch(U){console.error("Error fetching categories:",U),b([])}finally{p(!1)}})()},[]);const q=()=>{var Q,ce,be,j,$e,Ee;const W=((ce=(Q=c==null?void 0:c.monthly_sales)==null?void 0:Q[0])==null?void 0:ce.total_sales)||0,U=((be=c==null?void 0:c.deadstock)==null?void 0:be.length)||0,G=(($e=(j=c==null?void 0:c.top_selling_products)==null?void 0:j[0])==null?void 0:$e.name)||"N/A";let ne=[],K="",le=null;return y==="monthly"?(ne=(c==null?void 0:c.monthly_sales)||[],K="Monthly Sales",le=ne.length>0?l(ga,{width:"100%",height:200,children:m(Yc,{data:ne,margin:{top:10,right:20,left:0,bottom:0},children:[l(ba,{strokeDasharray:"3 3"}),l(wa,{dataKey:"month",label:{value:"Month",position:"insideBottomRight",offset:0}}),l(Na,{}),l(Bn,{}),l(Qr,{}),l(kl,{type:"monotone",dataKey:"total_sales",stroke:"#A020F0",strokeWidth:3})]})}):l("div",{className:"h-[280px] flex items-center justify-center p-6",children:m("div",{className:"text-center max-w-md",children:[l(Ye,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-3",children:"No data available"}),l("p",{className:"text-gray-400 text-sm leading-relaxed",children:"This could be because there are no completed orders yet or the system is still collecting data."})]})})):y==="daily"&&(ne=(c==null?void 0:c.daily_sales)||[],K="Daily Sales (Last 30 Days)",le=ne.length>0?l(ga,{width:"100%",height:200,children:m(Ec,{data:ne,margin:{top:10,right:20,left:0,bottom:0},children:[l(ba,{strokeDasharray:"3 3"}),l(wa,{dataKey:"day",label:{value:"Day",position:"insideBottomRight",offset:0}}),l(Na,{}),l(Bn,{}),l(Qr,{}),l(Xs,{dataKey:"total_sales",fill:"#36A2EB"})]})}):l("div",{className:"h-[280px] flex items-center justify-center p-6",children:m("div",{className:"text-center max-w-md",children:[l(Ye,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-3",children:"No data available"}),l("p",{className:"text-gray-400 text-sm leading-relaxed",children:"This could be because there are no completed orders yet or the system is still collecting data."})]})})),m("div",{className:"space-y-6",children:[m("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[l("div",{className:"card p-6",children:m("div",{className:"flex items-center",children:[l("div",{className:"p-3 bg-green-100 rounded-lg flex items-center justify-center",children:l("span",{className:"text-2xl font-extrabold text-green-600",children:""})}),m("div",{className:"ml-4",children:[l("p",{className:"text-sm font-medium text-gray-600",children:"Sales This Month"}),m("p",{className:"text-2xl font-bold text-gray-900",children:["",Number(W).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})}),l("div",{className:"card p-6",children:m("div",{className:"flex items-center",children:[l("div",{className:"p-3 bg-yellow-100 rounded-lg",children:l(Ye,{className:"h-6 w-6 text-yellow-600"})}),m("div",{className:"ml-4",children:[l("p",{className:"text-sm font-medium text-gray-600",children:"Deadstock Items"}),m("div",{children:[l("p",{className:"text-2xl font-bold text-gray-900",children:U}),m("p",{className:"text-sm text-gray-600",children:["Total: ",((Ee=c==null?void 0:c.deadstock_total_value)==null?void 0:Ee.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}))||"0.00"]})]})]})]})}),l("div",{className:"card p-6",children:m("div",{className:"flex items-center",children:[l("div",{className:"p-3 bg-blue-100 rounded-lg",children:l(Bc,{className:"h-6 w-6 text-blue-600"})}),m("div",{className:"ml-4",children:[l("p",{className:"text-sm font-medium text-gray-600",children:"Top Seller"}),l("p",{className:"text-base font-bold text-gray-900 break-words leading-tight",title:G,children:G})]})]})})]}),m("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4",children:[m("div",{children:[l("label",{htmlFor:"dashboard-sales-chart-type",className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Sales Chart:"}),m("select",{id:"dashboard-sales-chart-type",className:"border rounded px-4 py-2 text-base focus:ring-2 focus:ring-purple-400 focus:border-purple-400 transition",value:y,onChange:Ae=>v(Ae.target.value),children:[l("option",{value:"monthly",children:"Monthly Sales"}),l("option",{value:"daily",children:"Daily Sales"})]})]}),l("div",{className:"flex-1 flex items-end justify-end",children:m("span",{className:"text-gray-500 text-sm italic",children:["Showing: ",l("span",{className:"font-semibold text-gray-800",children:K})]})})]}),m("div",{className:"card p-6 mb-8",children:[l("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:K}),le]}),m("div",{className:"card p-6",children:[l("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Orders"}),l("div",{className:"overflow-x-auto",children:m("table",{className:"table-ui",children:[l("thead",{children:m("tr",{children:[l("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Order ID"}),l("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Customer ID"}),l("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Total"}),l("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Status"}),l("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Date"})]})}),l("tbody",{children:s&&s.length>0?s.slice(0,5).map(Ae=>m("tr",{children:[m("td",{className:"px-4 py-2 whitespace-nowrap text-sm font-medium text-gray-900",children:["#",Ae.id]}),l("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900",children:Ae.user_id}),m("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900",children:["",Ae.total_price]}),l("td",{className:"px-4 py-2 whitespace-nowrap",children:l("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${Ae.status==="Completed"?"bg-green-100 text-green-800":Ae.status==="Processing"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:Ae.status})}),l("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900",children:Ae.order_date})]},Ae.id)):l("tr",{children:l("td",{colSpan:"5",className:"text-center py-4",children:"No order data available."})})})]})})]})]})},ee=()=>{const[W,U]=N.useState(""),[G,ne]=N.useState("all"),[K,le]=N.useState("all"),[Q,ce]=N.useState("name"),[be,j]=N.useState(!1);N.useEffect(()=>{const te=De=>{be&&!De.target.closest(".export-dropdown")&&j(!1)};return document.addEventListener("mousedown",te),()=>{document.removeEventListener("mousedown",te)}},[be]);const $e=te=>{const De=LM(a,W,G,K,w,te);De>0?alert(`Successfully exported ${De} items to ${te.toUpperCase()} format.`):alert("No items match the current filters to export.")},Ee=[{key:"CPU",names:["CPU","Procie Only","Pro & Mobo - Amd","Pro & Mobo - Intel"]},{key:"Motherboard",names:["Motherboard","Mobo","Pro & Mobo - Amd","Pro & Mobo - Intel"]},{key:"GPU",names:["GPU"]},{key:"RAM",names:["RAM","Ram 3200mhz"]},{key:"Storage",names:["Storage","Ssd Nvme"]},{key:"PSU",names:["PSU","Psu - Tr"]},{key:"Case",names:["Case","Case Gaming"]},{key:"Cooler",names:["Cooler","Aio"]}],Ae={};Ee.forEach(te=>{Ae[te.key]=w.filter(De=>te.names.includes(De.name)).map(De=>String(De.id))});const Be=te=>{const De=w.find(ze=>ze.id===Number(te.category_id));if(!De)return null;for(const ze of Ee)if(ze.names.includes(De.name))return ze.key;return null},we=a.filter(te=>Be(te)),de=Array.from(new Set(we.map(te=>(te.brand||"").trim()).filter(Boolean).map(te=>te.toLowerCase()))),Ge=de.map(te=>te.charAt(0).toUpperCase()+te.slice(1)),et=["all"];de.includes("amd")&&et.push("AMD"),de.includes("intel")&&et.push("Intel"),et.push(...Ge.filter(te=>te!=="Amd"&&te!=="Intel"));let Qe=a.filter(te=>{const De=Be(te);if(!De||G!=="all"&&De!==G)return!1;if(K!=="all"){if(!te.brand)return!1;if(K.toLowerCase()==="amd"||K.toLowerCase()==="intel"){if(te.brand.toLowerCase()!==K.toLowerCase())return!1}else if(te.brand.toLowerCase()!==K.toLowerCase())return!1}return!0});return W.trim()!==""&&(Qe=Qe.filter(te=>te.name.toLowerCase().includes(W.toLowerCase())||te.brand&&te.brand.toLowerCase().includes(W.toLowerCase()))),Qe=[...Qe].sort((te,De)=>Q==="name"?te.name.localeCompare(De.name):Q==="price"?Number(De.price)-Number(te.price):Q==="stock"?Number(te.stock_quantity||te.stock)-Number(De.stock_quantity||De.stock):Q==="category"?(Be(te)||"").localeCompare(Be(De)||""):0),m("div",{className:"space-y-6",children:[m("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l("h2",{className:"page-title",children:"Inventory"}),m("div",{className:"flex items-center gap-2",children:[l("span",{className:"text-sm text-gray-600",children:"Branch:"}),m("div",{className:"inline-flex rounded-lg border overflow-hidden",children:[l("button",{className:`px-3 py-1 text-sm ${z===null?"bg-indigo-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,onClick:()=>X(null),children:"All"}),l("button",{className:`px-3 py-1 text-sm border-l ${z==="BULACAN"?"bg-indigo-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,onClick:()=>X("BULACAN"),children:"Bulacan"}),l("button",{className:`px-3 py-1 text-sm border-l ${z==="MARIKINA"?"bg-indigo-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,onClick:()=>X("MARIKINA"),children:"Marikina"})]})]}),m("div",{className:"relative export-dropdown",children:[m("button",{className:"bg-gray-600 text-white px-5 py-2 rounded-xl hover:bg-gray-700 flex items-center gap-2 shadow-lg",onClick:()=>j(!be),children:[l(oo,{className:"h-4 w-4"}),"Export"]}),be&&l("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border z-10",children:m("div",{className:"py-1",children:[m("button",{onClick:()=>{$e("csv"),j(!1)},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[l(oo,{className:"h-4 w-4"}),"Export as CSV"]}),m("button",{onClick:()=>{$e("excel"),j(!1)},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[l(oo,{className:"h-4 w-4"}),"Export as Excel"]})]})})]}),m("button",{className:"bg-indigo-600 text-white px-5 py-2 rounded-xl hover:bg-indigo-700 flex items-center gap-2 shadow-lg",onClick:()=>R({}),children:[l(Vn,{className:"h-4 w-4"}),"Add Product"]})]}),l("div",{className:"mb-2",children:m("div",{className:"flex flex-col gap-3",children:[l("div",{className:"w-full",children:l("input",{type:"text",placeholder:"Search by name or brand...",value:W,onChange:te=>U(te.target.value),className:"px-4 py-2 border rounded-lg w-full",style:{minHeight:"42px"}})}),m("div",{className:"flex flex-col sm:flex-row gap-2",children:[m("select",{value:G,onChange:te=>ne(te.target.value),className:"px-4 py-2 border rounded-lg flex-1",style:{minHeight:"42px"},children:[l("option",{value:"all",children:"All Components"}),Ee.map(te=>l("option",{value:te.key,children:te.key},te.key))]}),m("select",{value:K,onChange:te=>le(te.target.value),className:"px-4 py-2 border rounded-lg flex-1",style:{minHeight:"42px"},children:[l("option",{value:"all",children:"All Brands"}),et.filter(te=>te!=="all").map(te=>l("option",{value:te,children:te},te))]})]}),l("div",{className:"flex flex-col sm:flex-row gap-2",children:m("select",{value:Q,onChange:te=>ce(te.target.value),className:"px-4 py-2 border rounded-lg w-full sm:w-48",style:{minHeight:"42px"},children:[l("option",{value:"name",children:"Sort by Name"}),l("option",{value:"price",children:"Sort by Price"}),l("option",{value:"stock",children:"Sort by Stock"}),l("option",{value:"category",children:"Sort by Category"})]})})]})}),l("div",{className:"bg-white rounded-2xl shadow-lg border overflow-x-auto",children:m("table",{className:"min-w-full table-fixed divide-y divide-gray-200",children:[l("thead",{className:"bg-gray-50",children:m("tr",{children:[l("th",{className:"w-20 px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Image"}),l("th",{className:"w-1/5 px-2 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Name"}),l("th",{className:"w-1/6 px-2 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Category"}),l("th",{className:"w-1/6 px-2 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Brand"}),l("th",{className:"w-1/12 px-2 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Price"}),l("th",{className:"w-1/12 px-2 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Stock"}),l("th",{className:"w-1/12 px-2 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),l("tbody",{className:"bg-white divide-y divide-gray-200",children:Qe&&Qe.length>0?Qe.map(te=>{const De=w.find(Ke=>String(Ke.id)===String(te.category_id)),ze=De?Xx[De.name]||De.name:te.category_id,ct=te.image_url||ri(te.name);return m("tr",{className:"hover:shadow-2xl",children:[l("td",{className:"w-20 px-4 py-4 whitespace-nowrap align-middle",children:l("img",{src:ct,alt:te.name,className:"w-14 h-14 object-contain rounded border cursor-pointer hover:shadow-lg transition duration-150",onClick:()=>A(te),onError:Ke=>{Ke.target.onerror=null,Ke.target.src="/images/placeholder-component.png"}})}),l("td",{className:"px-2 py-4 whitespace-normal text-sm font-medium text-gray-900 break-words max-w-md flex items-center gap-3 truncate",style:{maxWidth:"320px"},title:te.name,children:te.name}),l("td",{className:"w-1/6 px-2 py-4 whitespace-nowrap text-sm text-gray-900 truncate max-w-xs",title:ze,children:ze}),l("td",{className:"w-1/6 px-2 py-4 whitespace-nowrap text-sm text-gray-900 truncate max-w-[80px]",title:te.brand,children:te.brand}),m("td",{className:"w-1/12 px-2 py-4 whitespace-nowrap text-sm text-gray-900 max-w-[80px]",children:["",te.price]}),l("td",{className:"w-1/12 px-2 py-4 whitespace-nowrap text-sm text-gray-900",children:te.stock_quantity||te.stock}),m("td",{className:"w-1/12 px-2 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[l("button",{className:"text-blue-600 hover:text-blue-900",onClick:()=>R(te),title:"Edit",children:l(_i,{className:"h-4 w-4"})}),(()=>{const Ke=Array.isArray(t==null?void 0:t.roles)?t.roles:typeof(t==null?void 0:t.roles)=="string"?t.roles.split(",").map(mt=>mt.trim()).filter(mt=>mt.length>0):[];return Ke.includes("Super Admin")||Ke.includes("Admin")})()&&l("button",{className:"text-red-600 hover:text-red-900",onClick:async()=>{if(window.confirm(`Delete '${te.name}'?`))try{const mt=await(await qe(`${ve}/index.php?endpoint=delete_component`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:te.id})})).json();mt.success?(i(ht=>ht.filter(Re=>Re.id!==te.id)),A(null),alert("Deleted successfully")):alert(mt.error||"Failed to delete item")}catch(Ke){console.error(Ke),alert("Error deleting item")}},title:"Delete",children:l(an,{className:"h-4 w-4"})})]})]},te.id)}):l("tr",{children:l("td",{colSpan:"7",className:"text-center py-4",children:"No inventory data available."})})})]})}),P&&l("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:()=>A(null),children:m("div",{className:"bg-white rounded-2xl shadow-2xl p-0 relative w-full max-w-4xl flex flex-col md:flex-row items-stretch",onClick:te=>te.stopPropagation(),children:[m("button",{className:"absolute top-4 right-4 bg-gray-100 hover:bg-red-100 text-gray-500 hover:text-red-600 rounded-full p-3 transition-colors shadow text-2xl",onClick:()=>A(null),"aria-label":"Close modal",children:[l("span",{className:"sr-only",children:"Close"}),""]}),l("div",{className:"flex-shrink-0 flex items-center justify-center bg-gray-50 rounded-l-2xl md:rounded-l-2xl md:rounded-r-none p-10 md:w-1/2 w-full border-b md:border-b-0 md:border-r",children:l("div",{className:"flex items-center justify-center w-full max-w-[500px] max-h-[400px] bg-white rounded border overflow-hidden",children:l("img",{src:ri(P.name),alt:P.name,className:"max-w-full max-h-[400px] object-contain"})})}),m("div",{className:"flex-1 flex flex-col justify-center p-10 md:w-1/2 w-full",children:[l("div",{className:"text-3xl font-extrabold text-gray-900 mb-4 text-center md:text-left",children:P.name}),m("div",{className:"mb-6 flex flex-wrap gap-3 justify-center md:justify-start",children:[m("span",{className:"inline-block bg-gray-100 text-gray-700 rounded px-3 py-1 text-base font-semibold",children:["ID: ",P.id]}),l("span",{className:"inline-block bg-blue-100 text-blue-700 rounded px-3 py-1 text-base font-semibold",children:(()=>{const te=w.find(De=>String(De.id)===String(P.category_id));return te?Xx[te.name]||te.name:P.category_id})()}),m("span",{className:"inline-block bg-green-100 text-green-700 rounded px-3 py-1 text-base font-semibold",children:["Brand: ",P.brand||"-"]})]}),m("div",{className:"grid grid-cols-2 gap-x-6 gap-y-4 text-lg text-gray-700 mb-6",children:[m("div",{className:"flex items-center font-semibold",children:[l("span",{className:"mr-2 text-blue-600 text-2xl font-bold align-middle",children:""}),"Price:"]}),m("div",{className:"font-bold text-green-700 text-xl",children:["",P.price]}),m("div",{className:"flex items-center font-semibold",children:[l("span",{className:"mr-2",children:m("svg",{className:"w-5 h-5 text-yellow-500 inline",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[l("circle",{cx:"12",cy:"12",r:"10"}),l("path",{d:"M12 8v4l3 3"})]})}),"Stock:"]}),l("div",{className:"text-lg",children:P.stock_quantity??P.stock})]}),P.specs&&typeof P.specs=="object"&&Object.keys(P.specs).length>0&&m("div",{className:"mb-2",children:[l("div",{className:"font-semibold text-gray-800 mb-2 text-lg",children:"Specs:"}),l("ul",{className:"list-disc list-inside text-base text-gray-600",children:Object.entries(P.specs).map(([te,De])=>m("li",{children:[m("span",{className:"font-medium capitalize",children:[te.replace(/_/g," "),":"]})," ",String(De)]},te))})]})]})]})}),T!==null&&l("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:()=>R(null),children:m("div",{className:"bg-white rounded-2xl shadow-lg p-6 max-w-2xl w-full relative",onClick:te=>te.stopPropagation(),children:[l("button",{className:"absolute top-4 right-4 text-gray-500 hover:text-gray-800",onClick:()=>R(null),children:""}),l("h3",{className:"text-xl font-bold mb-4",children:T.id?"Edit Product":"Add Product"}),l(kfe,{item:T,categories:w,onCancel:()=>R(null),onSave:te=>{te&&i(De=>T.id?De.map(ze=>ze.id===te.id?te:ze):[te,...De]),R(null)}})]})})]})},V=()=>m("div",{className:"page-container space-y-6",children:[m("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l("h2",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:"Orders"}),m("button",{className:"btn btn-primary shadow",onClick:()=>{E(null),k(!0)},children:[l(Vn,{className:"h-4 w-4"}),"Add Order"]})]}),l("div",{className:"card overflow-x-auto",children:m("table",{className:"table-ui",children:[l("thead",{children:m("tr",{children:[l("th",{children:"Order ID"}),l("th",{children:"Customer"}),l("th",{children:"Total"}),l("th",{children:"Status"}),l("th",{children:"Date"}),l("th",{children:"Actions"})]})}),l("tbody",{children:s&&s.length>0?s.map(W=>m("tr",{children:[m("td",{className:"text-sm font-semibold text-gray-900",children:["#",W.id]}),l("td",{className:"text-sm text-gray-900",children:W.user_id}),m("td",{className:"text-sm text-gray-900",children:["",W.total_price]}),l("td",{children:l("span",{className:`chip ${W.status==="Completed"?"chip-green":W.status==="Processing"?"chip-yellow":"chip-gray"}`,children:W.status})}),l("td",{className:"text-sm text-gray-900",children:W.order_date}),m("td",{className:"text-sm font-medium space-x-2",children:[l("button",{className:"btn btn-outline btn-icon",onClick:()=>{E(W),k(!0)},title:"Edit Order",children:l(_i,{className:"h-4 w-4"})}),l("button",{className:"btn btn-outline btn-icon text-red-600 border-red-200 hover:bg-red-50",onClick:()=>Y(W.id),title:"Delete Order",children:l(an,{className:"h-4 w-4"})})]})]},W.id)):l("tr",{children:l("td",{colSpan:"6",className:"empty-state",children:"No order data available."})})})]})}),S&&l("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-6",onClick:()=>{k(!1),E(null)},children:m("div",{className:"bg-white rounded-3xl shadow-2xl p-8 max-w-6xl w-full max-h-[95vh] overflow-y-auto relative modal-scrollbar",onClick:W=>W.stopPropagation(),children:[l("button",{className:"absolute top-6 right-6 text-gray-500 hover:text-gray-800 z-10 text-2xl font-bold",onClick:()=>{k(!1),E(null)},children:""}),l("h3",{className:"text-2xl font-bold mb-6 text-gray-800",children:_?"Edit Order":"Create Order"}),l(Sfe,{user:t,inventory:a,categories:w,editingOrder:_,onCancel:()=>{k(!1),E(null)},onCreated:()=>{k(!1),E(null),qe(`${ve}/index.php?endpoint=orders`).then(W=>W.json()).then(W=>{W&&W.success&&o(W.data||[])}).catch(()=>{})}})]})})]}),ae=()=>l(i3,{inventory:a,categories:w,user:t}),oe=()=>l(NN,{user:t});return l("div",{className:"p-4 sm:p-6 lg:p-8",children:d||h?l("div",{className:"text-center py-12",children:l("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto"})}):x?l("div",{className:"text-center text-red-600 py-8",children:x}):(()=>{switch(r){case"dashboard":return l(q,{});case"inventory":return l(ee,{});case"orders":case"orders-management":return l(V,{});case"feedback":return l(Nfe,{});case"pc-assembly":return l(ae,{});case"prebuilt-management":return l(oe,{});case"sales-reports":return l(BM,{reports:c,orders:s});case"notifications":return l(Vm,{user:t});case"system-reports":return l(SN,{reports:c,inventory:a,categories:w,formalCategoryNames:Xx,isLoading:d||h});default:return l(q,{})}})()})};function Sfe({user:e,inventory:t=[],categories:r=[],editingOrder:n=null,onCancel:a=()=>{},onCreated:i=()=>{}}){const[s,o]=ft.useState([{component_id:"",quantity:1}]),[c,u]=ft.useState("Completed"),[d,f]=ft.useState(!1),[h,p]=ft.useState(""),[x,g]=ft.useState(""),y=()=>o(S=>[...S,{component_id:"",quantity:1}]),v=(S,k)=>o(_=>_.map((E,P)=>P===S?{...E,...k}:E)),w=S=>o(k=>k.filter((_,E)=>E!==S));return ft.useEffect(()=>{n&&(u(n.status||"Completed"),p(n.notes||""),g(n.purchase_date||""),(async()=>{try{const _=await(await qe(`${ve}/index.php?endpoint=orders&id=${n.id}`)).json();if(_.success&&_.data&&_.data.items){const E=_.data.items.map(P=>({component_id:P.component_id.toString(),quantity:P.quantity}));o(E)}else o([]),y()}catch(k){console.error("Error fetching order details:",k),o([]),y()}})())},[n]),m("form",{onSubmit:async S=>{if(S.preventDefault(),!Array.isArray(s)||s.length===0)return;if(s.filter(E=>!E.component_id||E.component_id==="").length>0){alert('Please select a component for all items or remove empty slots using the "Remove" button.');return}if(!x){alert("Please select a purchase date.");return}const _=s.filter(E=>E.component_id&&Number(E.quantity)>0).map(E=>({component_id:Number(E.component_id),quantity:Number(E.quantity)}));if(_.length!==0){f(!0);try{const E=!!n,P=E?`${ve}/index.php?endpoint=orders&id=${n.id}`:`${ve}/index.php?endpoint=orders`,T=await qe(P,{method:E?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:_,status:c,notes:h?String(h).toUpperCase():void 0,purchase_date:x})}),R=await T.json().catch(()=>({}));!T.ok||!R.success?alert(R.error||`Failed to ${E?"update":"create"} order`):i(R.order_id||(n==null?void 0:n.id))}catch(E){console.error(E),alert(`Network error ${n?"updating":"creating"} order`)}finally{f(!1)}}},className:"space-y-8",children:[m("div",{className:"bg-gray-50 rounded-2xl p-6",children:[l("h4",{className:"text-lg font-semibold text-gray-800 mb-6",children:"Component Selection"}),m("div",{className:"space-y-6",children:[s.map((S,k)=>l("div",{className:`bg-white rounded-xl p-6 shadow-sm border-2 ${!S.component_id||S.component_id===""?"border-red-200 bg-red-50":"border-gray-200"}`,children:m("div",{className:"grid grid-cols-12 gap-4 items-end",children:[m("div",{className:"col-span-7",children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Component"}),l(kN,{value:S.component_id,onChange:_=>v(k,{component_id:_}),inventory:t,categories:r,placeholder:"Search components...",className:`w-full ${!S.component_id||S.component_id===""?"border-red-300":""}`}),(!S.component_id||S.component_id==="")&&l("p",{className:"text-red-600 text-sm mt-2 font-medium",children:"Please select a component or remove this item"})]}),m("div",{className:"col-span-3",children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Quantity"}),l("input",{type:"number",min:1,className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors",value:S.quantity,onChange:_=>v(k,{quantity:_.target.value})})]}),l("div",{className:"col-span-2 flex justify-end",children:l("button",{type:"button",className:"text-red-600 hover:text-red-800 font-semibold text-sm py-3 px-4 border-2 border-red-300 rounded-lg hover:bg-red-50 transition-colors whitespace-nowrap",onClick:()=>w(k),children:"Remove"})})]})},k)),m("button",{type:"button",className:"w-full text-green-600 hover:text-green-800 font-semibold flex items-center justify-center gap-3 py-4 px-6 border-2 border-dashed border-green-300 rounded-xl hover:bg-green-50 transition-colors",onClick:y,children:[l(Vn,{className:"h-5 w-5"}),"Add Another Component"]})]})]}),m("div",{className:"bg-gray-50 rounded-2xl p-6",children:[l("h4",{className:"text-lg font-semibold text-gray-800 mb-6",children:"Order Details"}),m("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[m("div",{children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Status"}),m("select",{className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors",value:c,onChange:S=>u(S.target.value),children:[l("option",{value:"Pending",children:"Pending"}),l("option",{value:"Processing",children:"Processing"}),l("option",{value:"Completed",children:"Completed"}),l("option",{value:"Cancelled",children:"Cancelled"})]})]}),m("div",{children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Purchase Date *"}),l("input",{type:"date",className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors",value:x,onChange:S=>g(S.target.value),required:!0})]}),m("div",{children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Notes (COMMENTS)"}),l("input",{className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors",value:h,onChange:S=>p(S.target.value),placeholder:"OPTIONAL"})]})]})]}),m("div",{className:"flex justify-end gap-4 pt-6 border-t-2 border-gray-200",children:[l("button",{type:"button",onClick:a,className:"px-8 py-3 border-2 border-gray-300 rounded-xl hover:bg-gray-50 transition-colors font-semibold text-gray-700",children:"Cancel"}),l("button",{type:"submit",className:"px-8 py-3 bg-green-600 text-white rounded-xl hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-semibold text-lg",disabled:d,children:d?n?"Updating...":"Creating...":n?"Update Order":"Create Order"})]})]})}function kfe({item:e={},categories:t=[],onCancel:r=()=>{},onSave:n=()=>{}}){const[a,i]=ft.useState({id:e.id||null,name:e.name||"",brand:e.brand||"",price:e.price||0,stock_quantity:e.stock_quantity??e.stock??0,category_id:e.category_id||t[0]&&t[0].id||"",image_url:e.image_url||""}),[s,o]=ft.useState(!1),[c,u]=ft.useState({BULACAN:"",MARIKINA:""}),[d,f]=ft.useState(!1),h=ft.useRef(null),[p,x]=ft.useState(null),g=(v,w)=>i(b=>({...b,[v]:w}));return ft.useEffect(()=>{(async()=>{if(a.id){f(!0);try{const w=await qe(`${ve}/index.php?endpoint=component_stock&component_id=${a.id}`),b=await w.json().catch(()=>({}));if(w.ok&&b&&b.success&&b.data&&Array.isArray(b.data.branches)){const S={BULACAN:"",MARIKINA:""};b.data.branches.forEach(k=>{String(k.code).toUpperCase()==="BULACAN"&&(S.BULACAN=String(k.stock_quantity??"")),String(k.code).toUpperCase()==="MARIKINA"&&(S.MARIKINA=String(k.stock_quantity??""))}),u(S)}}catch{}f(!1)}})()},[a.id]),m("form",{onSubmit:async v=>{v.preventDefault(),o(!0);try{const w=a.id?"update_component":"create_component",S=await(await qe(`${ve}/index.php?endpoint=${w}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json();if(!S.success){alert(S.error||"Save failed"),o(!1);return}let k=S.data||{...a,id:a.id||S.data&&S.data.id};const _=k.id||a.id,E=D=>D===""||D===null||D===void 0?null:parseInt(D,10),P=E(c.BULACAN),A=E(c.MARIKINA),T={"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},R=[];if(_&&(P!==null&&!Number.isNaN(P)&&R.push(fetch(`${ve}/update_component_stock.php`,{method:"POST",headers:T,body:JSON.stringify({component_id:_,branch:"BULACAN",stock_quantity:P})})),A!==null&&!Number.isNaN(A)&&R.push(fetch(`${ve}/update_component_stock.php`,{method:"POST",headers:T,body:JSON.stringify({component_id:_,branch:"MARIKINA",stock_quantity:A})}))),R.length){await Promise.allSettled(R);const D=(Number.isFinite(P)?P:0)+(Number.isFinite(A)?A:0);k={...k,stock_quantity:D}}n(k)}catch(w){console.error(w),alert("Error saving item")}finally{o(!1)}},className:"space-y-4",children:[m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),l("input",{required:!0,value:a.name,onChange:v=>g("name",v.target.value),className:"mt-1 block w-full border rounded px-3 py-2"})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Brand"}),l("input",{value:a.brand,onChange:v=>g("brand",v.target.value),className:"mt-1 block w-full border rounded px-3 py-2"})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Image"}),m("div",{className:"flex items-center gap-3",children:[l("input",{type:"text",placeholder:"Image URL (optional)",value:a.image_url,onChange:v=>g("image_url",v.target.value),className:"mt-1 block w-full border rounded px-3 py-2"}),l("input",{ref:h,type:"file",accept:"image/*",onChange:async v=>{const w=v.target.files&&v.target.files[0];if(!w)return;const b=URL.createObjectURL(w);g("image_url",b);try{const S=new Image;S.onload=()=>{x({sizeBytes:w.size,width:S.naturalWidth,height:S.naturalHeight})},S.src=b}catch{}},className:"mt-1"})]}),l("div",{className:"mt-2",children:a.image_url?m("div",{className:"flex items-center gap-3",children:[l("img",{src:a.image_url,alt:"Preview",className:"w-20 h-20 object-contain border rounded",onError:v=>{v.currentTarget.style.display="none"}}),p&&m("span",{className:"text-xs text-gray-600",children:[p.width,"",p.height," px, ",(p.sizeBytes/1024).toFixed(1)," KB"]})]}):l("span",{className:"text-xs text-gray-500",children:"Optional: provide a URL or pick a file"})})]}),m("div",{className:"grid grid-cols-2 gap-4",children:[m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Price"}),l("input",{type:"number",step:"0.01",value:a.price,onChange:v=>g("price",v.target.value),className:"mt-1 block w-full border rounded px-3 py-2"})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Stock Quantity"}),l("input",{type:"number",value:a.stock_quantity,onChange:v=>g("stock_quantity",v.target.value),className:"mt-1 block w-full border rounded px-3 py-2"})]})]}),a.id&&m("div",{className:"grid grid-cols-2 gap-4",children:[m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Bulacan Stock"}),l("input",{type:"number",value:c.BULACAN,onChange:v=>u(w=>({...w,BULACAN:v.target.value})),className:"mt-1 block w-full border rounded px-3 py-2",disabled:d})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Marikina Stock"}),l("input",{type:"number",value:c.MARIKINA,onChange:v=>u(w=>({...w,MARIKINA:v.target.value})),className:"mt-1 block w-full border rounded px-3 py-2",disabled:d})]})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Category"}),l("select",{value:a.category_id,onChange:v=>g("category_id",v.target.value),className:"mt-1 block w-full border rounded px-3 py-2",children:t.map(v=>l("option",{value:v.id,children:v.name},v.id))})]}),m("div",{className:"flex justify-end gap-2",children:[l("button",{type:"button",onClick:r,className:"px-4 py-2 border rounded",children:"Cancel"}),l("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded",disabled:s,children:s?"Saving...":"Save"})]})]})}const eu=({id:e,name:t,value:r,onChange:n,placeholder:a,autoComplete:i,required:s=!1,className:o="",showStrengthIndicator:c=!1,strengthScore:u=0,strengthLabel:d=""})=>{const[f,h]=N.useState(!1),p=()=>{h(!f)};return m("div",{children:[m("div",{className:"relative",children:[l("input",{id:e,name:t,type:f?"text":"password",autoComplete:i,required:s,className:`${o} pr-10`,placeholder:a,value:r,onChange:n}),l("button",{type:"button",onClick:p,className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 focus:outline-none",children:f?l(RT,{className:"h-5 w-5"}):l(lo,{className:"h-5 w-5"})})]}),c&&m(lt,{children:[l("div",{className:"mt-1 h-2 w-full bg-gray-200 rounded",children:l("div",{className:`h-2 rounded ${u>=3?"bg-green-600":u===2?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(100,u*25)}%`}})}),m("p",{className:"text-xs text-gray-600 mt-1",children:["Strength: ",d]})]})]})},_fe=e=>m("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:[l("div",{className:"bg-white shadow-sm border-b border-gray-200 mb-4 sm:mb-6",children:l("div",{className:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4",children:m("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4",children:[m("div",{className:"flex items-center gap-2 sm:gap-3",children:[l("div",{className:"p-1.5 sm:p-2 bg-red-100 rounded-lg",children:l(na,{className:"w-5 h-5 sm:w-6 sm:h-6 text-red-600"})}),m("div",{children:[l("h1",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900",children:"PC Assembly - Super Admin"}),l("p",{className:"text-xs sm:text-sm text-gray-600",children:"Advanced PC building interface with administrative privileges"})]})]}),l("div",{className:"flex items-center gap-2",children:l("div",{className:"px-2 sm:px-3 py-1 bg-red-100 text-red-800 rounded-full text-xs sm:text-sm font-medium",children:"Super Admin Access"})})]})})}),l("div",{className:"px-2 sm:px-4 lg:px-6 pb-4 sm:pb-6 lg:pb-8",children:l($c,{...e})})]});function Efe({item:e={},categories:t=[],onCancel:r=()=>{},onSave:n=()=>{}}){const[a,i]=ft.useState({id:e.id||null,name:e.name||"",brand:e.brand||"",price:e.price||0,stock_quantity:e.stock_quantity??e.stock??0,category_id:e.category_id||t[0]&&t[0].id||"",image_url:e.image_url||""}),[s,o]=ft.useState(!1),c=ft.useRef(null),[u,d]=ft.useState(null),f=(p,x)=>i(g=>({...g,[p]:x}));return m("form",{onSubmit:async p=>{p.preventDefault(),o(!0);try{const x=a.id?"update_component":"create_component",y=await(await qe(`${ve}/index.php?endpoint=${x}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json();y.success?n(y.data||a):alert(y.error||"Save failed")}catch(x){console.error(x),alert("Error saving item")}finally{o(!1)}},className:"space-y-4",children:[m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),l("input",{required:!0,value:a.name,onChange:p=>f("name",p.target.value),className:"mt-1 block w-full border rounded px-3 py-2"})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Brand"}),l("input",{value:a.brand,onChange:p=>f("brand",p.target.value),className:"mt-1 block w-full border rounded px-3 py-2"})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Image"}),m("div",{className:"flex items-center gap-3",children:[l("input",{type:"text",placeholder:"Image URL (optional)",value:a.image_url,onChange:p=>f("image_url",p.target.value),className:"mt-1 block w-full border rounded px-3 py-2"}),l("input",{ref:c,type:"file",accept:"image/*",onChange:async p=>{const x=p.target.files&&p.target.files[0];if(!x)return;const g=URL.createObjectURL(x);f("image_url",g);try{const y=new Image;y.onload=()=>{d({sizeBytes:x.size,width:y.naturalWidth,height:y.naturalHeight})},y.src=g}catch{}},className:"mt-1"})]}),l("div",{className:"mt-2",children:a.image_url?m("div",{className:"flex items-center gap-3",children:[l("img",{src:a.image_url,alt:"Preview",className:"w-20 h-20 object-contain border rounded",onError:p=>{p.currentTarget.style.display="none"}}),u&&m("span",{className:"text-xs text-gray-600",children:[u.width,"",u.height," px, ",(u.sizeBytes/1024).toFixed(1)," KB"]})]}):l("span",{className:"text-xs text-gray-500",children:"Optional: provide a URL or pick a file"})})]}),m("div",{className:"grid grid-cols-2 gap-4",children:[m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Price"}),l("input",{type:"number",step:"0.01",value:a.price,onChange:p=>f("price",p.target.value),className:"mt-1 block w-full border rounded px-3 py-2"})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Stock Quantity"}),l("input",{type:"number",value:a.stock_quantity,onChange:p=>f("stock_quantity",p.target.value),className:"mt-1 block w-full border rounded px-3 py-2"})]})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Category"}),l("select",{value:a.category_id,onChange:p=>f("category_id",p.target.value),className:"mt-1 block w-full border rounded px-3 py-2",children:t.map(p=>l("option",{value:p.id,children:p.name},p.id))})]}),m("div",{className:"flex justify-end gap-2",children:[l("button",{type:"button",onClick:r,className:"px-4 py-2 border rounded",children:"Cancel"}),l("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded",disabled:s,children:s?"Saving...":"Save"})]})]})}const Cfe=({inventory:e,categories:t,user:r})=>{const[n,a]=N.useState(""),[i,s]=N.useState("all"),[o,c]=N.useState("all"),[u,d]=N.useState("name"),[f,h]=N.useState(null),[p,x]=N.useState(null),[g,y]=N.useState(!1);N.useEffect(()=>{const T=R=>{g&&!R.target.closest(".export-dropdown")&&y(!1)};return document.addEventListener("mousedown",T),()=>{document.removeEventListener("mousedown",T)}},[g]);const v=[{key:"CPU",names:["CPU","Procie Only","Pro & Mobo - Amd","Pro & Mobo - Intel"]},{key:"Motherboard",names:["Motherboard","Mobo","Pro & Mobo - Amd","Pro & Mobo - Intel"]},{key:"GPU",names:["GPU"]},{key:"RAM",names:["RAM","Ram 3200mhz"]},{key:"Storage",names:["Storage","Ssd Nvme"]},{key:"PSU",names:["PSU","Psu - Tr"]},{key:"Case",names:["Case","Case Gaming"]},{key:"Cooler",names:["Cooler","Aio"]}],w={};v.forEach(T=>{w[T.key]=t.filter(R=>T.names.includes(R.name)).map(R=>String(R.id))});const b=T=>{const R=t.find(D=>D.id===Number(T.category_id));if(!R)return null;for(const D of v)if(D.names.includes(R.name))return D.key;return null},S=e.filter(T=>b(T)),k=Array.from(new Set(S.map(T=>(T.brand||"").trim()).filter(Boolean).map(T=>T.toLowerCase()))),_=k.map(T=>T.charAt(0).toUpperCase()+T.slice(1)),E=["all"];k.includes("amd")&&E.push("AMD"),k.includes("intel")&&E.push("Intel"),E.push(..._.filter(T=>T!=="Amd"&&T!=="Intel"));let P=e.filter(T=>{const R=b(T);if(!R||i!=="all"&&R!==i)return!1;if(o!=="all"){if(!T.brand)return!1;if(o.toLowerCase()==="amd"||o.toLowerCase()==="intel"){if(T.brand.toLowerCase()!==o.toLowerCase())return!1}else if(T.brand.toLowerCase()!==o.toLowerCase())return!1}return!0});n.trim()!==""&&(P=P.filter(T=>T.name.toLowerCase().includes(n.toLowerCase())||T.brand&&T.brand.toLowerCase().includes(n.toLowerCase()))),P=[...P].sort((T,R)=>u==="name"?T.name.localeCompare(R.name):u==="price"?Number(R.price)-Number(T.price):u==="stock"?Number(T.stock_quantity||T.stock)-Number(R.stock_quantity||R.stock):u==="category"?(b(T)||"").localeCompare(b(R)||""):0);const A=T=>{const R=LM(e,n,i,o,t,T);R>0?alert(`Successfully exported ${R} items to ${T.toUpperCase()} format.`):alert("No items match the current filters to export.")};return m("div",{className:"page-container space-y-6",children:[m("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l("h2",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:"Inventory"}),m("div",{className:"flex items-center gap-2",children:[m("div",{className:"relative export-dropdown",children:[m("button",{className:"btn btn-outline shadow flex items-center gap-2",onClick:()=>y(!g),children:[l(oo,{className:"h-4 w-4"}),"Export"]}),g&&l("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border z-10",children:m("div",{className:"py-1",children:[m("button",{onClick:()=>{A("csv"),y(!1)},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[l(oo,{className:"h-4 w-4"}),"Export as CSV"]}),m("button",{onClick:()=>{A("excel"),y(!1)},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[l(oo,{className:"h-4 w-4"}),"Export as Excel"]})]})})]}),m("button",{className:"btn btn-primary shadow",onClick:()=>x({}),children:[l(Vn,{className:"h-4 w-4"}),"Add Product"]})]})]}),l("div",{className:"card",children:m("div",{className:"flex flex-col gap-3",children:[l("div",{className:"w-full",children:l("input",{type:"text",placeholder:"Search by name or brand...",value:n,onChange:T=>a(T.target.value),className:"px-4 py-2 border rounded-lg w-full",style:{minHeight:"42px"}})}),m("div",{className:"flex flex-col sm:flex-row gap-2",children:[m("select",{value:i,onChange:T=>s(T.target.value),className:"px-4 py-2 border rounded-lg flex-1",style:{minHeight:"42px"},children:[l("option",{value:"all",children:"All Components"}),v.map(T=>l("option",{value:T.key,children:T.key},T.key))]}),m("select",{value:o,onChange:T=>c(T.target.value),className:"px-4 py-2 border rounded-lg flex-1",style:{minHeight:"42px"},children:[l("option",{value:"all",children:"All Brands"}),E.filter(T=>T!=="all").map(T=>l("option",{value:T,children:T},T))]})]}),l("div",{className:"flex flex-col sm:flex-row gap-2",children:m("select",{value:u,onChange:T=>d(T.target.value),className:"px-4 py-2 border rounded-lg w-full sm:w-48",style:{minHeight:"42px"},children:[l("option",{value:"name",children:"Sort by Name"}),l("option",{value:"price",children:"Sort by Price"}),l("option",{value:"stock",children:"Sort by Stock"}),l("option",{value:"category",children:"Sort by Category"})]})})]})}),l("div",{className:"card overflow-x-auto",children:m("table",{className:"table-ui",children:[l("thead",{children:m("tr",{children:[l("th",{children:"Product"}),l("th",{children:"Category"}),l("th",{children:"Stock"}),l("th",{children:"Price"}),l("th",{children:"Status"}),l("th",{children:"Actions"})]})}),l("tbody",{children:P.length>0?P.map(T=>{const R=T.image_url||ri(T.name);return m("tr",{children:[m("td",{className:"text-sm font-medium text-gray-900 break-words max-w-xs flex items-center gap-3",style:{maxWidth:"320px"},title:T.name,children:[l("img",{src:R,alt:T.name,className:"w-12 h-12 object-contain rounded border cursor-pointer hover:shadow-lg transition duration-150",onClick:()=>h(T),onError:D=>{D.target.onerror=null,D.target.src="/images/components/default.png"}}),l("span",{className:"align-middle",children:T.name})]}),l("td",{className:"text-sm text-gray-900",children:b(T)}),l("td",{className:"text-sm text-gray-900",children:T.stock_quantity??T.stock}),m("td",{className:"text-sm text-gray-900",children:["",T.price]}),l("td",{children:(()=>{const D=T.stock_quantity??T.stock,L=Number(T.price);return D===0?l("span",{className:"chip chip-red",children:"Out of Stock"}):L===0?l("span",{className:"chip chip-gray",children:"No Price"}):D>0&&D<=5?l("span",{className:"chip chip-yellow",children:"Low Stock"}):l("span",{className:"chip chip-green",children:"In Stock"})})()}),m("td",{className:"text-sm font-medium space-x-2",children:[l("button",{className:"btn btn-outline btn-icon",onClick:()=>x(T),title:"Edit",children:l(_i,{className:"h-4 w-4"})}),l("button",{className:"btn btn-outline btn-icon text-red-600 border-red-200 hover:bg-red-50",onClick:async()=>{if(window.confirm(`Delete '${T.name}'?`))try{const L=await(await qe(`${ve}/index.php?endpoint=delete_component`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:T.id})})).json();L.success?window.location.reload():alert(L.error||"Failed to delete item")}catch(D){console.error(D),alert("Error deleting item")}},title:"Delete",children:l(an,{className:"h-4 w-4"})})]})]},T.id)}):l("tr",{children:l("td",{colSpan:"6",className:"empty-state",children:"No inventory data available."})})})]})}),f&&l("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:()=>h(null),children:m("div",{className:"bg-white rounded-2xl shadow-2xl p-0 relative w-full max-w-4xl flex flex-col md:flex-row items-stretch",onClick:T=>T.stopPropagation(),children:[m("button",{className:"absolute top-4 right-4 bg-gray-100 hover:bg-green-100 text-gray-500 hover:text-green-600 rounded-full p-3 transition-colors shadow text-2xl",onClick:()=>h(null),"aria-label":"Close modal",children:[l("span",{className:"sr-only",children:"Close"}),""]}),l("div",{className:"flex-shrink-0 flex items-center justify-center bg-gray-50 rounded-l-2xl md:rounded-l-2xl md:rounded-r-none p-10 md:w-1/2 w-full border-b md:border-b-0 md:border-r",children:l("div",{className:"flex items-center justify-center w-full max-w-[500px] max-h-[400px] bg-white rounded border overflow-hidden",children:l("img",{src:ri(f.name),alt:f.name,className:"max-w-full max-h-[400px] object-contain"})})}),m("div",{className:"flex-1 flex flex-col justify-center p-10 md:w-1/2 w-full",children:[l("div",{className:"text-3xl font-extrabold text-gray-900 mb-4 text-center md:text-left",children:f.name}),m("div",{className:"mb-6 flex flex-wrap gap-3 justify-center md:justify-start",children:[m("span",{className:"inline-block bg-gray-100 text-gray-700 rounded px-3 py-1 text-base font-semibold",children:["ID: ",f.id]}),l("span",{className:"inline-block bg-blue-100 text-blue-700 rounded px-3 py-1 text-base font-semibold",children:b(f)}),m("span",{className:"inline-block bg-green-100 text-green-700 rounded px-3 py-1 text-base font-semibold",children:["Brand: ",f.brand||"-"]})]}),m("div",{className:"grid grid-cols-2 gap-x-6 gap-y-4 text-lg text-gray-700 mb-6",children:[m("div",{className:"flex items-center font-semibold",children:[l("span",{className:"mr-2 text-blue-600 text-2xl font-bold align-middle",children:""}),"Price:"]}),m("div",{className:"font-bold text-green-700 text-xl",children:["",f.price]}),m("div",{className:"flex items-center font-semibold",children:[l("span",{className:"mr-2",children:m("svg",{className:"w-5 h-5 text-yellow-500 inline",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[l("circle",{cx:"12",cy:"12",r:"10"}),l("path",{d:"M12 8v4l3 3"})]})}),"Stock:"]}),l("div",{className:"text-lg",children:f.stock_quantity??f.stock})]}),f.specs&&typeof f.specs=="object"&&Object.keys(f.specs).length>0&&m("div",{className:"mb-2",children:[l("div",{className:"font-semibold text-gray-800 mb-2 text-lg",children:"Specs:"}),l("ul",{className:"list-disc list-inside text-xs text-gray-700 bg-green-50 rounded p-2 border border-green-100 mt-1",children:Object.entries(f.specs).map(([T,R])=>m("li",{children:[m("span",{className:"font-medium capitalize",children:[T.replace(/_/g," "),":"]})," ",String(R)]},T))})]})]})]})}),p!==null&&l("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:()=>x(null),children:m("div",{className:"bg-white rounded-2xl shadow-lg p-6 max-w-2xl w-full relative",onClick:T=>T.stopPropagation(),children:[l("button",{className:"absolute top-4 right-4 text-gray-500 hover:text-gray-800",onClick:()=>x(null),children:""}),l("h3",{className:"text-xl font-bold mb-4",children:p.id?"Edit Product":"Add Product"}),l(Efe,{item:p,categories:t,onCancel:()=>x(null),onSave:T=>{T&&window.location.reload(),x(null)}})]})})]})},Afe=({orders:e,inventory:t,categories:r=[],onRefetch:n})=>{const[a,i]=N.useState(!1),[s,o]=N.useState(null),c=async d=>{if(window.confirm("Are you sure you want to delete this order?"))try{const f=localStorage.getItem("token"),h=await fetch(`${ve}/index.php?endpoint=orders&id=${d}&action=delete`,{method:"POST",headers:{Authorization:`Bearer ${f}`,"Content-Type":"application/json"}});if(!h.ok){const p=await h.json();throw new Error(p.error||"Failed to delete order")}alert("Order deleted successfully"),n&&n()}catch(f){console.error("Delete order error:",f),alert(`Failed to delete order: ${f.message}`)}},u=d=>{o(d),i(!0)};return m("div",{className:"page-container space-y-6",children:[m("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l("h2",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:"Orders"}),m("button",{className:"btn btn-primary shadow",onClick:()=>{o(null),i(!0)},children:[l(Vn,{className:"h-4 w-4"}),"Add Order"]})]}),l("div",{className:"card overflow-x-auto",children:m("table",{className:"table-ui",children:[l("thead",{children:m("tr",{children:[l("th",{children:"Order ID"}),l("th",{children:"Customer"}),l("th",{children:"Total"}),l("th",{children:"Status"}),l("th",{children:"Date"}),l("th",{children:"Actions"})]})}),l("tbody",{children:e&&e.length>0?e.map(d=>m("tr",{children:[m("td",{className:"text-sm font-semibold text-gray-900",children:["#",d.id]}),l("td",{className:"text-sm text-gray-900",children:d.user_id}),m("td",{className:"text-sm text-gray-900",children:["",d.total_price]}),l("td",{children:l("span",{className:`chip ${d.status==="Completed"?"chip-green":d.status==="Processing"?"chip-yellow":"chip-gray"}`,children:d.status})}),l("td",{className:"text-sm text-gray-900",children:d.order_date}),m("td",{className:"text-sm font-medium space-x-2",children:[l("button",{className:"btn btn-outline btn-icon",onClick:()=>u(d),title:"Edit Order",children:l(_i,{className:"h-4 w-4"})}),l("button",{className:"btn btn-outline btn-icon text-red-600 border-red-200 hover:bg-red-50",onClick:()=>c(d.id),title:"Delete Order",children:l(an,{className:"h-4 w-4"})})]})]},d.id)):l("tr",{children:l("td",{colSpan:"6",className:"empty-state",children:"No order data available."})})})]})}),a&&l("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-6",onClick:()=>i(!1),children:m("div",{className:"bg-white rounded-3xl shadow-2xl p-8 max-w-6xl w-full max-h-[95vh] overflow-y-auto relative modal-scrollbar",onClick:d=>d.stopPropagation(),children:[l("button",{className:"absolute top-6 right-6 text-gray-500 hover:text-gray-800 z-10 text-2xl font-bold",onClick:()=>i(!1),children:""}),l("h3",{className:"text-2xl font-bold mb-6 text-gray-800",children:s?"Edit Order":"Create Order"}),l(Pfe,{inventory:t,categories:r,editingOrder:s,onCancel:()=>{i(!1),o(null)},onCreated:()=>{i(!1),o(null),n&&n()}})]})})]})},Tfe=()=>{const{notifications:e,loading:t,markAsRead:r,markAllAsRead:n,deleteNotification:a,deleteAllNotifications:i,unreadCount:s}=dp(),[o,c]=N.useState("all");N.useState({});const u=e.filter(h=>o==="unread"?!h.read:o==="read"?h.read:!0),d=h=>h.type==="stock"&&(h.title==="Low Stock: Multiple Components"||h.title==="Out of Stock: Multiple Components"),f=h=>{const p={},x=h.split(`
`);let g=null;return x.forEach(y=>{const v=y.trim(),w=v.match(/^\s*(.+?)\s*\((\d+)\s*items?\):/);if(w){g=w[1].trim(),p[g]=[];return}const b=v.match(/^-\s*(.+)$/);if(b&&g){const S=b[1].trim();p[g].push(S)}}),p};return t?l("div",{className:"flex items-center justify-center h-40",children:l("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"})}):m("div",{className:"p-6 w-full",children:[m("div",{className:"flex items-center justify-between mb-6",children:[m("div",{className:"flex items-center space-x-3",children:[l("div",{className:"w-10 h-10 bg-green-600 rounded-lg flex items-center justify-center",children:l(Ea,{className:"w-6 h-6 text-white"})}),m("div",{children:[l("h1",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:"Notifications"}),m("p",{className:"text-sm text-gray-500",children:[s," unread notification",s!==1?"s":""]})]})]}),m("div",{className:"flex items-center space-x-3",children:[m("select",{value:o,onChange:h=>c(h.target.value),className:"border rounded px-3 py-2 text-sm focus:ring-2 focus:ring-purple-400 focus:border-purple-400 transition",children:[l("option",{value:"all",children:"All Notifications"}),l("option",{value:"unread",children:"Unread"}),l("option",{value:"read",children:"Read"})]}),s>0&&l("button",{onClick:n,className:"px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-md hover:bg-green-700 transition-colors",children:"Mark All as Read"}),e.length>0&&l("button",{onClick:()=>{window.confirm("Are you sure you want to delete all notifications?")&&i()},className:"px-4 py-2 bg-gray-300 text-gray-800 text-sm font-medium rounded-md hover:bg-gray-400 transition-colors",children:"Delete All"})]})]}),l("div",{className:"space-y-4",children:u.length===0?m("div",{className:"text-center py-12",children:[l(Ea,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:o==="all"?"No notifications yet":`No ${o} notifications`}),l("p",{className:"text-gray-500",children:o==="all"?"You'll see important updates here when they arrive.":`You have no ${o} notifications at the moment.`})]}):u.map(h=>{const p=d(h),x=p?f(h.message):{};return l("div",{className:`bg-white rounded-2xl shadow-lg border p-6 transition-all duration-200 hover:shadow-2xl ${h.read?"":"border-l-4 border-red-500 bg-red-50"}`,children:m("div",{className:"flex items-start space-x-4",children:[l("div",{className:"flex-shrink-0 mt-1",children:l(Ea,{className:`w-6 h-6 ${h.read?"text-gray-400":"text-red-600"}`})}),l("div",{className:"flex-1 min-w-0",children:m("div",{className:"flex items-start justify-between",children:[m("div",{className:"flex-1",children:[l("h3",{className:`text-base font-semibold mb-3 ${h.read?"text-gray-700":"text-gray-900"}`,children:h.title}),!p&&l("div",{className:"mt-3 mb-4",children:l("p",{className:"text-sm text-gray-600 leading-relaxed whitespace-pre-line",children:h.message})}),p&&Object.keys(x).length>0&&m("div",{className:"mt-4 mb-4 bg-red-50 rounded-lg p-4 border border-red-100",children:[l("div",{className:"text-sm font-semibold text-red-800 mb-3",children:"Affected Components:"}),l("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:Object.entries(x).map(([g,y])=>m("div",{className:"bg-white rounded-lg p-3 border border-red-200",children:[m("div",{className:"text-sm font-medium text-red-700 mb-2 flex items-center",children:[l("span",{className:"w-2 h-2 bg-red-500 rounded-full mr-2"}),g," (",y.length," items)"]}),l("div",{className:"space-y-1 max-h-60 overflow-y-auto",children:y.map((v,w)=>l("div",{className:"text-xs text-red-600 bg-red-50 rounded px-2 py-1 border border-red-100",children:v},w))})]},g))})]}),l("div",{className:"flex items-center mt-4 text-sm text-gray-500",children:h.timestamp&&new Date(h.timestamp).toLocaleString()})]}),m("div",{className:"flex items-center space-x-3 ml-6",children:[!h.read&&l("button",{onClick:()=>r(h.id),className:"p-2 text-gray-400 hover:text-red-600 transition-colors rounded-lg hover:bg-red-50",title:"Mark as read",children:l(rb,{className:"w-5 h-5"})}),l("button",{onClick:()=>a(h.id),className:"p-2 text-gray-400 hover:text-red-600 transition-colors rounded-lg hover:bg-red-50",title:"Delete notification",children:l(an,{className:"w-5 h-5"})})]})]})})]})},h.id)})})]})},K0=({initialTab:e="dashboard",user:t,setUser:r})=>{const[n,a]=N.useState(e),[i,s]=N.useState([]),[o,c]=N.useState({}),[u,d]=N.useState(!0),[f,h]=N.useState([]),[p,x]=N.useState(!1),[g,y]=N.useState({username:"",email:"",password:"",role:"employee",first_name:"",last_name:""}),[v,w]=N.useState([]),[b,S]=N.useState({}),[k,_]=N.useState([]),[E,P]=N.useState("monthly");let A=[],T="",R=null;E==="monthly"?(A=(b==null?void 0:b.monthly_sales)||[],T="Monthly Sales",R=A.length>0?l(ga,{width:"100%",height:200,children:m(Yc,{data:A,margin:{top:10,right:20,left:0,bottom:0},children:[l(ba,{strokeDasharray:"3 3"}),l(wa,{dataKey:"month",label:{value:"Month",position:"insideBottomRight",offset:0}}),l(Na,{}),l(Bn,{}),l(Qr,{}),l(kl,{type:"monotone",dataKey:"total_sales",stroke:"#A020F0",strokeWidth:3})]})}):l("div",{className:"h-[280px] flex items-center justify-center p-6",children:m("div",{className:"text-center max-w-md",children:[l(Ye,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-3",children:"No data available"}),l("p",{className:"text-gray-400 text-sm leading-relaxed",children:"This could be because there are no completed orders yet or the system is still collecting data."})]})})):E==="weekly"?(A=(b==null?void 0:b.weekly_sales)||[],T="Weekly Sales",R=A.length>0?l(ga,{width:"100%",height:200,children:m(Yc,{data:A,margin:{top:10,right:20,left:0,bottom:0},children:[l(ba,{strokeDasharray:"3 3"}),l(wa,{dataKey:"week",label:{value:"Week",position:"insideBottomRight",offset:0}}),l(Na,{}),l(Bn,{}),l(Qr,{}),l(kl,{type:"monotone",dataKey:"total_sales",stroke:"#36A2EB",strokeWidth:3})]})}):l("div",{className:"h-[280px] flex items-center justify-center p-6",children:m("div",{className:"text-center max-w-md",children:[l(Ye,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-3",children:"No data available"}),l("p",{className:"text-gray-400 text-sm leading-relaxed",children:"This could be because there are no completed orders yet or the system is still collecting data."})]})})):E==="daily"&&(A=(b==null?void 0:b.daily_sales)||[],T="Daily Sales (Last 30 Days)",R=A.length>0?l(ga,{width:"100%",height:250,children:m(Ec,{data:A,margin:{top:10,right:20,left:0,bottom:0},children:[l(ba,{strokeDasharray:"3 3"}),l(wa,{dataKey:"day",label:{value:"Day",position:"insideBottomRight",offset:0}}),l(Na,{}),l(Bn,{}),l(Qr,{}),l(Xs,{dataKey:"total_sales",fill:"#36A2EB"})]})}):l("div",{className:"h-[320px] flex items-center justify-center p-6",children:m("div",{className:"text-center max-w-md",children:[l(Ye,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-3",children:"No data available"}),l("p",{className:"text-gray-400 text-sm leading-relaxed",children:"This could be because there are no completed orders yet or the system is still collecting data."})]})})),N.useEffect(()=>{a(e)},[e]),N.useEffect(()=>{const V=async(oe=!1)=>{oe&&d(!0);try{const I=await qe(`${ve}/index.php?endpoint=dashboard`,{method:"GET"});if(!I.ok)throw new Error("Failed to fetch dashboard data");const W=await I.json();if(W.success){const U=W.data;s(U.users||[]),c(U.system_stats||{}),h(U.inventory||[]),w(U.orders||[]),S(U.reports||{})}else throw new Error(W.error||"API call was not successful")}catch(I){console.error("Error fetching dashboard data:",I)}finally{oe&&d(!1)}};V(!0);const ae=setInterval(()=>{V(!1)},6e4);return()=>clearInterval(ae)},[]),N.useEffect(()=>{(async()=>{try{const oe=await(await qe(`${ve}/index.php?endpoint=categories`)).json();oe.success&&_(oe.data)}catch{}})()},[]),N.useEffect(()=>{const ae=setTimeout(async()=>{try{if(!await nr())return;const I=await qe(`${ve}/index.php?endpoint=profile`,{method:"GET",suppressUnauthorizedEvent:!0});if(I.status===401)return;const W=await I.json().catch(()=>({}));W.success&&W.user&&r&&r(W.user)}catch(oe){console.error("SuperAdminDashboard: Error fetching profile:",oe)}},500);return()=>clearTimeout(ae)},[r]);const D=async({username:V,email:ae,password:oe,first_name:I,last_name:W,role:U})=>{var G;try{await qe(`${ve}/index.php?endpoint=otp_request`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:ae,purpose:"register"})}).catch(()=>{});const ne=await qe(`${ve}/index.php?endpoint=register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:V,email:ae,password:oe,first_name:I,last_name:W,otp_code:"ADMIN_OVERRIDE"})}),K=await ne.json();if(!ne.ok||!K.success||!((G=K.user)!=null&&G.id))throw new Error(K.error||"Registration failed");const le=await qe(`${ve}/index.php?endpoint=assign_role`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:K.user.id,role:U})}),Q=await le.json();if(!le.ok||!Q.success)throw new Error(Q.error||"Role assignment failed");await qe(`${ve}/index.php?endpoint=update_inventory_access`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:K.user.id,can_access_inventory:U!=="Client"?1:0})}).catch(()=>{}),await qe(`${ve}/index.php?endpoint=update_order_access`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:K.user.id,can_access_orders:U!=="Client"?1:0})}).catch(()=>{}),await qe(`${ve}/index.php?endpoint=update_chat_support_access`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:K.user.id,can_access_chat_support:U!=="Client"?1:0})}).catch(()=>{}),alert(`User '${V}' created as ${U}.`)}catch(ne){alert(ne.message||"Failed to create user")}},L=async V=>{if(V.preventDefault(),!g.username||!g.email||!g.password||!g.first_name||!g.last_name){alert("Please complete all required fields.");return}if(!/.+@.+\..+/.test(String(g.email))){alert("Please enter a valid email address.");return}if(String(g.password).length<6){alert("Password must be at least 6 characters.");return}if(String(g.password).length>8){alert("Password must be no more than 8 characters.");return}if(!/[A-Z]/.test(g.password)){alert("Password must contain at least one capital letter.");return}if(!/\d/.test(g.password)){alert("Password must contain at least one number.");return}if(!/[^A-Za-z0-9]/.test(g.password)){alert("Password must contain at least one special symbol.");return}const I={client:"Client",employee:"Employee",admin:"Admin","super admin":"Super Admin"}[String(g.role||"").toLowerCase()]||"Client";await D({username:g.username,email:g.email,password:g.password,first_name:g.first_name,last_name:g.last_name,role:I}),x(!1);try{const U=await(await qe(`${ve}/index.php?endpoint=get_users`)).json();U&&U.success&&s(U.data||[])}catch{}},z=async(V,ae)=>{try{const I=await(await qe(`${ve}/index.php?endpoint=update_inventory_access`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:V,can_access_inventory:ae?0:1})})).json();I.success?s(W=>W.map(U=>U.id===V?{...U,can_access_inventory:ae?0:1}:U)):alert(I.error||"Failed to update inventory access")}catch{alert("Error updating inventory access")}},X=async(V,ae)=>{try{const I=await(await qe(`${ve}/index.php?endpoint=update_order_access`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:V,can_access_orders:ae?0:1})})).json();I.success?s(W=>W.map(U=>U.id===V?{...U,can_access_orders:ae?0:1}:U)):alert(I.error||"Failed to update order access")}catch{alert("Error updating order access")}},Y=async(V,ae)=>{try{const I=await(await qe(`${ve}/index.php?endpoint=update_chat_support_access`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:V,can_access_chat_support:ae?0:1})})).json();I.success?s(W=>W.map(U=>U.id===V?{...U,can_access_chat_support:ae?0:1}:U)):alert(I.error||"Failed to update chat support access")}catch{alert("Error updating chat support access")}},q=async V=>{try{const oe=await(await qe(`${ve}/index.php?endpoint=delete_user`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:V})})).json();oe.success?(s(I=>I.filter(W=>W.id!==V)),alert("User deleted successfully")):alert(oe.error||"Failed to delete user")}catch{alert("Error deleting user")}};return u?l("div",{className:"flex min-h-[50vh] items-center justify-center",children:m("div",{className:"text-center",children:[l("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),l("p",{className:"text-gray-600",children:"Loading dashboard..."})]})}):l("div",{className:"min-h-[70vh]",children:(()=>{var V,ae,oe,I,W;switch(n){case"notifications":return l(Tfe,{});case"system-reports":return l(SN,{reports:b});case"inventory":return l(Cfe,{inventory:f,categories:k,user:t});case"orders-management":return l(Afe,{orders:v,inventory:f,categories:k,onRefetch:()=>{qe(`${ve}/index.php?endpoint=orders`).then(U=>U.json()).then(U=>{U&&U.success&&w(U.data||[])}).catch(()=>{})}});case"pc-assembly":return l(_fe,{user:t,setUser:()=>{}});case"prebuilt-management":return l(NN,{});case"user-management":return m("div",{className:"p-6 space-y-6",children:[m("div",{className:"flex items-center gap-4",children:[l(iu,{className:"h-10 w-10 text-green-500"}),m("div",{children:[l("h2",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:"Users"}),l("p",{className:"text-gray-500 text-base mt-1",children:"Create and manage users, roles, status, and access permissions."})]})]}),m("div",{className:"flex items-center justify-between",children:[m("div",{className:"text-sm text-gray-600",children:["Total users: ",Array.isArray(i)?i.length:0]}),m("button",{className:"bg-green-600 text-white px-5 py-2.5 rounded-xl hover:bg-green-700 transition-colors shadow-lg hover:shadow-xl flex items-center gap-2 font-semibold",onClick:()=>x(!0),children:[l(U8,{className:"h-4 w-4"}),"Create User"]})]}),l("div",{className:"card overflow-x-auto",children:m("table",{className:"table-ui",children:[l("thead",{children:m("tr",{children:[l("th",{children:"User"}),l("th",{children:"Email"}),l("th",{children:"Roles"}),l("th",{children:"Online"}),l("th",{children:"Status"}),l("th",{children:"Inventory"}),l("th",{children:"Orders"}),l("th",{children:"Chat Support"}),l("th",{children:"Actions"})]})}),l("tbody",{children:Array.isArray(i)&&i.length>0?i.map(U=>m("tr",{children:[m("td",{className:"text-sm font-medium text-gray-900",children:[U.username||`User #${U.id}`,l("div",{className:"text-xs text-gray-500",children:[U.first_name,U.last_name].filter(Boolean).join(" ")})]}),l("td",{className:"text-sm text-gray-900",children:U.email}),l("td",{className:"text-sm text-gray-900",children:(Array.isArray(U.roles)?U.roles:typeof U.roles=="string"?U.roles.split(","):[]).map(G=>G.trim()).filter(Boolean).map((G,ne)=>l("span",{className:"inline-block bg-gray-100 text-gray-700 px-2 py-0.5 rounded-full text-xs font-semibold mr-1 mb-1",children:G},ne))}),l("td",{children:(()=>{const G=U.last_login?new Date(U.last_login):null,ne=!!(G&&Date.now()-G.getTime()<=30*60*1e3);return l("span",{className:`chip ${ne?"chip-green":"chip-gray"}`,children:ne?"Online":"Offline"})})()}),l("td",{children:l("span",{className:`chip ${U.is_active?"chip-green":"chip-red"}`,children:U.is_active?"Active":"Disabled"})}),l("td",{children:(()=>{const G=Number(U.can_access_inventory)===1;return l("button",{className:`px-3 py-1.5 rounded-lg text-sm font-semibold ${G?"bg-green-50 text-green-700 border border-green-200 hover:bg-green-100":"bg-green-600 text-white hover:bg-green-700"}`,onClick:()=>{const ne=G?"disable":"enable",K=U.username||`User #${U.id}`;(typeof window>"u"||window.confirm(`Are you sure you want to ${ne} Inventory access for ${K}?`))&&z(U.id,G)},title:G?"Disable Inventory Access":"Enable Inventory Access",children:G?"Disable":"Enable"})})()}),l("td",{children:(()=>{const G=Number(U.can_access_orders)===1;return l("button",{className:`px-3 py-1.5 rounded-lg text-sm font-semibold ${G?"bg-green-50 text-green-700 border border-green-200 hover:bg-green-100":"bg-green-600 text-white hover:bg-green-700"}`,onClick:()=>{const ne=G?"disable":"enable",K=U.username||`User #${U.id}`;(typeof window>"u"||window.confirm(`Are you sure you want to ${ne} Orders access for ${K}?`))&&X(U.id,G)},title:G?"Disable Orders Access":"Enable Orders Access",children:G?"Disable":"Enable"})})()}),l("td",{children:(()=>{const G=Number(U.can_access_chat_support)===1;return l("button",{className:`px-3 py-1.5 rounded-lg text-sm font-semibold ${G?"bg-green-50 text-green-700 border border-green-200 hover:bg-green-100":"bg-green-600 text-white hover:bg-green-700"}`,onClick:()=>{const ne=G?"disable":"enable",K=U.username||`User #${U.id}`;(typeof window>"u"||window.confirm(`Are you sure you want to ${ne} Chat Support access for ${K}?`))&&Y(U.id,G)},title:G?"Disable Chat Support":"Enable Chat Support",children:G?"Disable":"Enable"})})()}),l("td",{children:(()=>(Array.isArray(U.roles)?U.roles:typeof U.roles=="string"?U.roles.split(","):[]).some(K=>["Admin","Employee"].includes(K.trim()))?l("button",{className:"px-3 py-1.5 bg-green-600 text-white rounded-lg text-sm font-semibold hover:bg-green-700 transition-colors",onClick:()=>{const K=U.username||`User #${U.id}`;window.confirm(`Are you sure you want to delete user "${K}"? This action cannot be undone.`)&&q(U.id)},title:"Delete User",children:"Delete"}):l("span",{className:"text-gray-400 text-sm",children:"Protected"}))()})]},U.id)):l("tr",{children:l("td",{colSpan:"8",className:"empty-state",children:"No users found."})})})]})}),p&&l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>x(!1),children:m("div",{className:"bg-white rounded-xl p-6 w-full max-w-lg shadow-2xl",onClick:U=>U.stopPropagation(),children:[m("div",{className:"flex items-center justify-between mb-4",children:[l("h3",{className:"text-xl font-bold",children:"Create User"}),l("button",{className:"text-gray-500 hover:text-gray-800",onClick:()=>x(!1),children:""})]}),m("form",{onSubmit:L,className:"space-y-3",children:[m("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Username"}),l("input",{required:!0,value:g.username,onChange:U=>y(G=>({...G,username:U.target.value})),className:"mt-1 block w-full border rounded px-3 py-2"})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),l("input",{required:!0,type:"email",value:g.email,onChange:U=>y(G=>({...G,email:U.target.value})),className:"mt-1 block w-full border rounded px-3 py-2"})]})]}),m("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"First name"}),l("input",{value:g.first_name,onChange:U=>y(G=>({...G,first_name:U.target.value})),className:"mt-1 block w-full border rounded px-3 py-2"})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Last name"}),l("input",{value:g.last_name,onChange:U=>y(G=>({...G,last_name:U.target.value})),className:"mt-1 block w-full border rounded px-3 py-2"})]})]}),m("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),l(eu,{required:!0,value:g.password,onChange:U=>y(G=>({...G,password:U.target.value})),className:"mt-1 block w-full border rounded px-3 py-2",placeholder:"Enter password"})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Role"}),m("select",{value:g.role,onChange:U=>y(G=>({...G,role:U.target.value})),className:"mt-1 block w-full border rounded px-3 py-2",children:[l("option",{value:"client",children:"Client"}),l("option",{value:"employee",children:"Employee"}),l("option",{value:"admin",children:"Admin"}),l("option",{value:"super admin",children:"Super Admin"})]})]})]}),m("div",{className:"flex justify-end gap-2 pt-2",children:[l("button",{type:"button",onClick:()=>x(!1),className:"px-4 py-2 border rounded",children:"Cancel"}),l("button",{type:"submit",className:"px-5 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"Create"})]})]})]})})]});case"dashboard":default:{const U=((ae=(V=b==null?void 0:b.monthly_sales)==null?void 0:V[0])==null?void 0:ae.total_sales)||0,G=((oe=b==null?void 0:b.deadstock)==null?void 0:oe.length)||0,ne=((W=(I=b==null?void 0:b.top_selling_products)==null?void 0:I[0])==null?void 0:W.name)||"N/A",K=(b==null?void 0:b.deadstock_total_value)??0;return m("div",{className:"p-6 space-y-6",children:[m("div",{children:[l("h2",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:"Super Admin Dashboard"}),l("p",{className:"text-gray-600",children:"Overview of key metrics and recent activity."})]}),m("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[l("div",{className:"bg-white p-6 rounded-2xl shadow-lg border",children:m("div",{className:"flex items-center",children:[l("div",{className:"p-3 bg-green-100 rounded-lg flex items-center justify-center",children:l("span",{className:"text-2xl font-extrabold text-green-600",children:""})}),m("div",{className:"ml-4",children:[l("p",{className:"text-sm font-medium text-gray-600",children:"Sales This Month"}),l("p",{className:"text-2xl font-bold text-gray-900",children:gt(U)})]})]})}),l("div",{className:"bg-white p-6 rounded-2xl shadow-lg border",children:m("div",{className:"flex items-center",children:[l("div",{className:"p-3 bg-yellow-100 rounded-lg",children:l(Ye,{className:"h-6 w-6 text-yellow-600"})}),m("div",{className:"ml-4",children:[l("p",{className:"text-sm font-medium text-gray-600",children:"Deadstock Items"}),m("div",{children:[l("p",{className:"text-2xl font-bold text-gray-900",children:G}),m("p",{className:"text-sm text-gray-600",children:["Total: ",gt(K)]})]})]})]})}),l("div",{className:"bg-white p-6 rounded-2xl shadow-lg border",children:m("div",{className:"flex items-center",children:[l("div",{className:"p-3 bg-blue-100 rounded-lg",children:l(Bc,{className:"h-6 w-6 text-blue-600"})}),m("div",{className:"ml-4 flex-1 min-w-0",children:[l("p",{className:"text-sm font-medium text-gray-600",children:"Top Seller"}),l("p",{className:"text-base font-bold text-gray-900 break-words leading-tight",title:ne,children:ne})]})]})})]}),m("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4",children:[m("div",{children:[l("label",{htmlFor:"dashboard-sales-chart-type",className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Sales Chart:"}),m("select",{id:"dashboard-sales-chart-type",className:"border rounded px-4 py-2 text-base focus:ring-2 focus:ring-green-400 focus:border-green-400 transition",value:E,onChange:le=>P(le.target.value),children:[l("option",{value:"monthly",children:"Monthly Sales"}),l("option",{value:"weekly",children:"Weekly Sales"}),l("option",{value:"daily",children:"Daily Sales"})]})]}),l("div",{className:"flex-1 flex items-end justify-end",children:m("span",{className:"text-gray-500 text-sm italic",children:["Showing: ",l("span",{className:"font-semibold text-gray-800",children:T})]})})]}),m("div",{className:"card p-6 mb-8",children:[l("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:T}),R]}),m("div",{className:"card p-6",children:[l("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Orders"}),l("div",{className:"overflow-x-auto",children:m("table",{className:"table-ui",children:[l("thead",{children:m("tr",{children:[l("th",{children:"Order ID"}),l("th",{children:"Customer"}),l("th",{children:"Total"}),l("th",{children:"Status"}),l("th",{children:"Date"})]})}),l("tbody",{children:v&&v.length>0?v.slice(0,5).map(le=>m("tr",{children:[m("td",{className:"whitespace-nowrap text-sm font-medium text-gray-900",children:["#",le.id]}),l("td",{className:"whitespace-nowrap text-sm text-gray-900",children:le.user_id}),m("td",{className:"whitespace-nowrap text-sm text-gray-900",children:["",le.total_price]}),l("td",{className:"whitespace-nowrap text-sm text-gray-900",children:le.status}),l("td",{className:"whitespace-nowrap text-sm text-gray-900",children:le.order_date})]},le.id)):l("tr",{children:l("td",{colSpan:"5",className:"text-center py-4",children:"No recent orders."})})})]})})]})]})}}})()})};function Pfe({inventory:e=[],categories:t=[],editingOrder:r=null,onCancel:n=()=>{},onCreated:a=()=>{}}){const[i,s]=ft.useState([{component_id:"",quantity:1}]),[o,c]=ft.useState("Completed"),[u,d]=ft.useState(!1),[f,h]=ft.useState(""),[p,x]=ft.useState(""),g=()=>s(b=>[...b,{component_id:"",quantity:1}]),y=(b,S)=>s(k=>k.map((_,E)=>E===b?{..._,...S}:_)),v=b=>s(S=>S.filter((k,_)=>_!==b));return ft.useEffect(()=>{r&&(c(r.status||"Completed"),h(r.notes||""),x(r.purchase_date||""),(async()=>{try{const k=await(await qe(`${ve}/index.php?endpoint=orders&id=${r.id}`)).json();if(k.success&&k.data&&k.data.items){const _=k.data.items.map(E=>({component_id:E.component_id.toString(),quantity:E.quantity}));s(_)}else s([]),g()}catch(S){console.error("Error fetching order details:",S),s([]),g()}})())},[r]),m("form",{onSubmit:async b=>{if(b.preventDefault(),i.filter(_=>!_.component_id||_.component_id==="").length>0){alert('Please select a component for all items or remove empty slots using the "Remove" button.');return}if(!p){alert("Please select a purchase date.");return}const k=i.filter(_=>_.component_id&&Number(_.quantity)>0).map(_=>({component_id:Number(_.component_id),quantity:Number(_.quantity)}));if(k.length===0){alert("Add at least one item.");return}d(!0);try{const _=!!r,E=_?`${ve}/index.php?endpoint=orders&id=${r.id}`:`${ve}/index.php?endpoint=orders`,A=await qe(E,{method:_?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:k,status:o,notes:f?String(f).toUpperCase():void 0,purchase_date:p})}),T=await A.json().catch(()=>({}));!A.ok||!T.success?alert(T.error||`Failed to ${_?"update":"create"} order`):a(T.order_id||(r==null?void 0:r.id))}catch(_){console.error(_),alert(`Network error ${r?"updating":"creating"} order`)}finally{d(!1)}},className:"space-y-8",children:[m("div",{className:"bg-gray-50 rounded-2xl p-6",children:[l("h4",{className:"text-lg font-semibold text-gray-800 mb-6",children:"Component Selection"}),m("div",{className:"space-y-6",children:[i.map((b,S)=>l("div",{className:`bg-white rounded-xl p-6 shadow-sm border-2 ${!b.component_id||b.component_id===""?"border-red-200 bg-red-50":"border-gray-200"}`,children:m("div",{className:"grid grid-cols-12 gap-4 items-end",children:[m("div",{className:"col-span-7",children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Component"}),l(kN,{value:b.component_id,onChange:k=>y(S,{component_id:k}),inventory:e,categories:t,placeholder:"Search components...",className:`w-full ${!b.component_id||b.component_id===""?"border-red-300":""}`}),(!b.component_id||b.component_id==="")&&l("p",{className:"text-red-600 text-sm mt-2 font-medium",children:"Please select a component or remove this item"})]}),m("div",{className:"col-span-3",children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Quantity"}),l("input",{type:"number",min:1,className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors",value:b.quantity,onChange:k=>y(S,{quantity:k.target.value})})]}),l("div",{className:"col-span-2 flex justify-end",children:l("button",{type:"button",className:"text-red-600 hover:text-red-800 font-semibold text-sm py-3 px-4 border-2 border-red-300 rounded-lg hover:bg-red-50 transition-colors whitespace-nowrap",onClick:()=>v(S),children:"Remove"})})]})},S)),m("button",{type:"button",className:"w-full text-green-600 hover:text-green-800 font-semibold flex items-center justify-center gap-3 py-4 px-6 border-2 border-dashed border-green-300 rounded-xl hover:bg-green-50 transition-colors",onClick:g,children:[l(Vn,{className:"h-5 w-5"}),"Add Another Component"]})]})]}),m("div",{className:"bg-gray-50 rounded-2xl p-6",children:[l("h4",{className:"text-lg font-semibold text-gray-800 mb-6",children:"Order Details"}),m("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[m("div",{children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Status"}),m("select",{className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors",value:o,onChange:b=>c(b.target.value),children:[l("option",{value:"Pending",children:"Pending"}),l("option",{value:"Processing",children:"Processing"}),l("option",{value:"Completed",children:"Completed"}),l("option",{value:"Cancelled",children:"Cancelled"})]})]}),m("div",{children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Purchase Date *"}),l("input",{type:"date",className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors",value:p,onChange:b=>x(b.target.value),required:!0})]}),m("div",{children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Notes (COMMENTS)"}),l("input",{className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors",value:f,onChange:b=>h(b.target.value),placeholder:"OPTIONAL"})]})]})]}),m("div",{className:"flex justify-end gap-4 pt-6 border-t-2 border-gray-200",children:[l("button",{type:"button",onClick:n,className:"px-8 py-3 border-2 border-gray-300 rounded-xl hover:bg-gray-50 transition-colors font-semibold text-gray-700",children:"Cancel"}),l("button",{type:"submit",className:"px-8 py-3 bg-green-600 text-white rounded-xl hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-semibold text-lg",disabled:u,children:u?r?"Updating...":"Creating...":r?"Update Order":"Create Order"})]})]})}const qx={Aio:"CPU Cooler (AIO)","Case Gaming":"PC Case (Gaming)",GPU:"Graphics Card (GPU)",Mobo:"Motherboard","Procie Only":"Processor (CPU)",PSU:"Power Supply (PSU)","Psu - Tr":"Power Supply (PSU, True Rated)","Ram 3200mhz":"Memory (RAM, 3200MHz)","Ssd Nvme":"Storage (SSD NVMe)",Cooler:"CPU Cooler",RAM:"Memory (RAM)",Storage:"Storage",Case:"PC Case",Motherboard:"Motherboard",CPU:"Processor (CPU)"},X0=({initialTab:e,user:t,setUser:r})=>{const[n,a]=N.useState(e||"employee-dashboard");N.useEffect(()=>{e&&e!==n&&a(e)},[e,n]);const[i,s]=N.useState([]),[o,c]=N.useState([]),[u,d]=N.useState({}),[f,h]=N.useState(!0),[p,x]=N.useState(null),[g,y]=N.useState("monthly"),[v,w]=N.useState([]),[b,S]=N.useState(null),[k,_]=N.useState(null),[E,P]=N.useState(""),[A,T]=N.useState("all"),[R,D]=N.useState("all"),[L,z]=N.useState("name"),[X,Y]=N.useState(null);dp();const[q,ee]=N.useState(t==null?void 0:t.can_access_inventory),[V,ae]=N.useState(!1),[oe,I]=N.useState(null);N.useEffect(()=>{const de=async(Qe=!1)=>{Qe&&h(!0),x(null);try{if(!await nr()){x("Session expired. Please log in again."),s([]),c([]),d({});return}const De=await qe(`${ve}/index.php?endpoint=dashboard${X?`&branch=${X}`:""}`,{method:"GET"});if(De.status===401){x("Invalid token"),s([]),c([]),d({});return}const ze=await De.json().catch(()=>({}));if(ze&&ze.success){const ct=ze.data||{};s(ct.inventory||[]),c(ct.orders||[]),d(ct.reports||{})}else x(ze&&ze.error||"API call was not successful")}catch(te){x("Error fetching dashboard data."),console.error("Error fetching dashboard data:",te)}finally{Qe&&h(!1)}},Ge=setTimeout(()=>de(!0),200),et=setInterval(()=>de(!1),6e4);return()=>{clearTimeout(Ge),clearInterval(et)}},[X]),N.useEffect(()=>{(async()=>{try{const et=await(await qe(`${ve}/index.php?endpoint=categories`)).json();et.success&&w(et.data)}catch{}})()},[]);const W=[{key:"CPU",names:["CPU","Procie Only","Pro & Mobo - Amd","Pro & Mobo - Intel"]},{key:"Motherboard",names:["Motherboard","Mobo","Pro & Mobo - Amd","Pro & Mobo - Intel"]},{key:"GPU",names:["GPU"]},{key:"RAM",names:["RAM","Ram 3200mhz"]},{key:"Storage",names:["Storage","Ssd Nvme"]},{key:"PSU",names:["PSU","Psu - Tr"]},{key:"Case",names:["Case","Case Gaming"]},{key:"Cooler",names:["Cooler","Aio"]}],U={};W.forEach(de=>{U[de.key]=v.filter(Ge=>de.names.includes(Ge.name)).map(Ge=>String(Ge.id))});const G=de=>{const Ge=v.find(et=>et.id===Number(de.category_id));if(!Ge)return null;for(const et of W)if(et.names.includes(Ge.name))return et.key;return null},ne=i.filter(de=>G(de)),K=Array.from(new Set(ne.map(de=>(de.brand||"").trim()).filter(Boolean).map(de=>de.toLowerCase()))),le=K.map(de=>de.charAt(0).toUpperCase()+de.slice(1)),Q=["all"];K.includes("amd")&&Q.push("AMD"),K.includes("intel")&&Q.push("Intel"),Q.push(...le.filter(de=>de!=="Amd"&&de!=="Intel"));let ce=i.filter(de=>{const Ge=G(de);if(!Ge||A!=="all"&&Ge!==A)return!1;if(R!=="all"){if(!de.brand)return!1;if(R.toLowerCase()==="amd"||R.toLowerCase()==="intel"){if(de.brand.toLowerCase()!==R.toLowerCase())return!1}else if(de.brand.toLowerCase()!==R.toLowerCase())return!1}return!0});E.trim()!==""&&(ce=ce.filter(de=>de.name.toLowerCase().includes(E.toLowerCase())||de.brand&&de.brand.toLowerCase().includes(E.toLowerCase()))),ce=[...ce].sort((de,Ge)=>L==="name"?de.name.localeCompare(Ge.name):L==="price"?Number(Ge.price)-Number(de.price):L==="stock"?Number(de.stock_quantity||de.stock)-Number(Ge.stock_quantity||Ge.stock):L==="category"?(G(de)||"").localeCompare(G(Ge)||""):0);const be=()=>{var ze,ct,Ke,mt,ht;const de=((ct=(ze=u==null?void 0:u.monthly_sales)==null?void 0:ze[0])==null?void 0:ct.total_sales)||0,Ge=((Ke=u==null?void 0:u.deadstock)==null?void 0:Ke.length)||0,et=((ht=(mt=u==null?void 0:u.top_selling_products)==null?void 0:mt[0])==null?void 0:ht.name)||"N/A";let Qe=[],te="",De=null;return g==="monthly"?(Qe=(u==null?void 0:u.monthly_sales)||[],te="Monthly Sales",De=Qe.length>0?l(ga,{width:"100%",height:200,children:m(Yc,{data:Qe,margin:{top:10,right:20,left:0,bottom:0},children:[l(ba,{strokeDasharray:"3 3"}),l(wa,{dataKey:"month",label:{value:"Month",position:"insideBottomRight",offset:0}}),l(Na,{}),l(Bn,{}),l(Qr,{}),l(kl,{type:"monotone",dataKey:"total_sales",stroke:"#A020F0",strokeWidth:3})]})}):l("div",{className:"h-[280px] flex items-center justify-center p-6",children:m("div",{className:"text-center max-w-md",children:[l(Ye,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-3",children:"No data available"}),l("p",{className:"text-gray-400 text-sm leading-relaxed",children:"This could be because there are no completed orders yet or the system is still collecting data."})]})})):g==="daily"&&(Qe=(u==null?void 0:u.daily_sales)||[],te="Daily Sales (Last 30 Days)",De=Qe.length>0?l(ga,{width:"100%",height:200,children:m(Ec,{data:Qe,margin:{top:10,right:20,left:0,bottom:0},children:[l(ba,{strokeDasharray:"3 3"}),l(wa,{dataKey:"day",label:{value:"Day",position:"insideBottomRight",offset:0}}),l(Na,{}),l(Bn,{}),l(Qr,{}),l(Xs,{dataKey:"total_sales",fill:"#36A2EB"})]})}):l("div",{className:"h-[280px] flex items-center justify-center p-6",children:m("div",{className:"text-center max-w-md",children:[l(Ye,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-3",children:"No data available"}),l("p",{className:"text-gray-400 text-sm leading-relaxed",children:"This could be because there are no completed orders yet or the system is still collecting data."})]})})),m("div",{className:"space-y-6",children:[m("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[l("div",{className:"bg-white p-6 rounded-2xl shadow-lg border",children:m("div",{className:"flex items-center",children:[l("div",{className:"p-3 bg-green-100 rounded-lg flex items-center justify-center",children:l("span",{className:"text-2xl font-extrabold text-green-600",children:""})}),m("div",{className:"ml-4",children:[l("p",{className:"text-sm font-medium text-gray-600",children:"Sales This Month"}),l("p",{className:"text-2xl font-bold text-gray-900",children:gt(de)})]})]})}),l("div",{className:"bg-white p-6 rounded-2xl shadow-lg border",children:m("div",{className:"flex items-center",children:[l("div",{className:"p-3 bg-yellow-100 rounded-lg",children:l(Ye,{className:"h-6 w-6 text-yellow-600"})}),m("div",{className:"ml-4",children:[l("p",{className:"text-sm font-medium text-gray-600",children:"Deadstock Items"}),m("div",{children:[l("p",{className:"text-2xl font-bold text-gray-900",children:Ge}),m("p",{className:"text-sm text-gray-600",children:["Total: ",gt((u==null?void 0:u.deadstock_total_value)||0)]})]})]})]})}),l("div",{className:"bg-white p-6 rounded-2xl shadow-lg border",children:m("div",{className:"flex items-center",children:[l("div",{className:"p-3 bg-blue-100 rounded-lg",children:l(Bc,{className:"h-6 w-6 text-blue-600"})}),m("div",{className:"ml-4",children:[l("p",{className:"text-sm font-medium text-gray-600",children:"Top Seller"}),l("p",{className:"text-base font-bold text-gray-900 break-words leading-tight",title:et,children:et})]})]})})]}),m("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4",children:[m("div",{children:[l("label",{htmlFor:"dashboard-sales-chart-type",className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Sales Chart:"}),m("select",{id:"dashboard-sales-chart-type",className:"border rounded px-4 py-2 text-base focus:ring-2 focus:ring-indigo-400 focus:border-indigo-400 transition",value:g,onChange:Re=>y(Re.target.value),children:[l("option",{value:"monthly",children:"Monthly Sales"}),l("option",{value:"daily",children:"Daily Sales"})]})]}),l("div",{className:"flex-1 flex items-end justify-end",children:m("span",{className:"text-gray-500 text-sm italic",children:["Showing: ",l("span",{className:"font-semibold text-gray-800",children:te})]})})]}),m("div",{className:"card p-6 mb-8",children:[l("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:te}),De]}),m("div",{className:"card p-6",children:[l("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Orders"}),l("div",{className:"overflow-x-auto",children:m("table",{className:"table-ui",children:[l("thead",{children:m("tr",{children:[l("th",{children:"Order ID"}),l("th",{children:"Customer ID"}),l("th",{children:"Total"}),l("th",{children:"Status"}),l("th",{children:"Date"})]})}),l("tbody",{children:o&&o.length>0?o.slice(0,5).map(Re=>m("tr",{children:[m("td",{className:"whitespace-nowrap text-sm font-medium text-gray-900",children:["#",Re.id]}),l("td",{className:"whitespace-nowrap text-sm text-gray-900",children:Re.user_id}),l("td",{className:"whitespace-nowrap text-sm text-gray-900",children:gt(Re.total_price)}),l("td",{className:"whitespace-nowrap",children:l("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${Re.status==="Completed"?"bg-green-100 text-green-800":Re.status==="Processing"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:Re.status})}),l("td",{className:"whitespace-nowrap text-sm text-gray-900",children:Re.order_date})]},Re.id)):l("tr",{children:l("td",{colSpan:"5",className:"text-center py-4",children:"No order data available."})})})]})})]})]})},j=()=>m("div",{className:"space-y-6",children:[m("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l("h2",{className:"page-title",children:"Inventory"}),m("div",{className:"flex items-center gap-2",children:[l("span",{className:"text-sm text-gray-600",children:"Branch:"}),m("div",{className:"inline-flex rounded-lg border overflow-hidden",children:[l("button",{className:`px-3 py-1 text-sm ${X===null?"bg-indigo-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,onClick:()=>Y(null),children:"All"}),l("button",{className:`px-3 py-1 text-sm border-l ${X==="BULACAN"?"bg-indigo-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,onClick:()=>Y("BULACAN"),children:"Bulacan"}),l("button",{className:`px-3 py-1 text-sm border-l ${X==="MARIKINA"?"bg-indigo-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,onClick:()=>Y("MARIKINA"),children:"Marikina"})]})]}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")&&m("button",{className:"bg-indigo-600 text-white px-5 py-2 rounded-xl hover:bg-indigo-700 flex items-center gap-2 shadow-lg",onClick:()=>_({}),children:[l(Vn,{className:"h-4 w-4"}),"Add Product"]})]}),l("div",{className:"mb-2",children:m("div",{className:"flex flex-col gap-3",children:[l("div",{className:"w-full",children:l("input",{type:"text",placeholder:"Search by name or brand...",value:E,onChange:de=>P(de.target.value),className:"px-4 py-2 border rounded-lg w-full",style:{minHeight:"42px"}})}),m("div",{className:"flex flex-col sm:flex-row gap-2",children:[m("select",{value:A,onChange:de=>T(de.target.value),className:"px-4 py-2 border rounded-lg flex-1",style:{minHeight:"42px"},children:[l("option",{value:"all",children:"All Components"}),W.map(de=>l("option",{value:de.key,children:de.key},de.key))]}),m("select",{value:R,onChange:de=>D(de.target.value),className:"px-4 py-2 border rounded-lg flex-1",style:{minHeight:"42px"},children:[l("option",{value:"all",children:"All Brands"}),Q.filter(de=>de!=="all").map(de=>l("option",{value:de,children:de},de))]})]}),l("div",{className:"flex flex-col sm:flex-row gap-2",children:m("select",{value:L,onChange:de=>z(de.target.value),className:"px-4 py-2 border rounded-lg w-full sm:w-48",style:{minHeight:"42px"},children:[l("option",{value:"name",children:"Sort by Name"}),l("option",{value:"price",children:"Sort by Price"}),l("option",{value:"stock",children:"Sort by Stock"}),l("option",{value:"category",children:"Sort by Category"})]})})]})}),l("div",{className:"bg-white rounded-2xl shadow-lg border overflow-x-auto",children:m("table",{className:"min-w-full divide-y divide-gray-200",children:[l("thead",{className:"bg-gray-50",children:m("tr",{children:[l("th",{className:"w-20 px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Image"}),l("th",{className:"w-1/5 px-2 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Name"}),l("th",{className:"w-1/6 px-2 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Category"}),l("th",{className:"w-1/6 px-2 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Brand"}),l("th",{className:"w-1/12 px-2 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Price"}),l("th",{className:"w-1/12 px-2 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Stock"}),l("th",{className:"w-1/12 px-2 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),l("tbody",{className:"bg-white divide-y divide-gray-200",children:ce&&ce.length>0?ce.map(de=>{const Ge=v.find(te=>String(te.id)===String(de.category_id)),et=Ge?qx[Ge.name]||Ge.name:de.category_id,Qe=de.image_url||ri(de.name);return m("tr",{children:[l("td",{className:"w-20 px-4 py-4 whitespace-nowrap align-middle",children:l("img",{src:Qe,alt:de.name,className:"w-14 h-14 object-contain rounded border cursor-pointer hover:shadow-lg transition duration-150",onClick:()=>S(de),onError:te=>{te.target.onerror=null,te.target.src="/images/components/default.png"}})}),l("td",{className:"px-2 py-4 whitespace-normal text-sm font-medium text-gray-900 break-words max-w-md flex items-center gap-3 truncate",style:{maxWidth:"320px"},title:de.name,children:de.name}),l("td",{className:"w-1/6 px-2 py-4 whitespace-nowrap text-sm text-gray-900 truncate max-w-xs",title:et,children:et}),l("td",{className:"w-1/6 px-2 py-4 whitespace-nowrap text-sm text-gray-900 truncate max-w-[80px]",title:de.brand,children:de.brand}),l("td",{className:"w-1/12 px-2 py-4 whitespace-nowrap text-sm text-gray-900 max-w-[80px]",children:gt(de.price)}),l("td",{className:"w-1/12 px-2 py-4 whitespace-nowrap text-sm text-gray-900",children:de.stock_quantity||de.stock}),m("td",{className:"w-1/12 px-2 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[l("button",{className:"text-blue-600 hover:text-blue-900",onClick:()=>_(de),title:"Edit",children:l(_i,{className:"h-4 w-4"})}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")&&l("button",{className:"text-red-600 hover:text-red-900",onClick:async()=>{if(window.confirm(`Delete '${de.name}'?`))try{const De=await(await qe(`${ve}/index.php?endpoint=delete_component`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:de.id})})).json();De.success?(s(ze=>ze.filter(ct=>ct.id!==de.id)),S(null),alert("Deleted successfully")):alert(De.error||"Failed to delete item")}catch(te){console.error(te),alert("Error deleting item")}},title:"Delete",children:l(an,{className:"h-4 w-4"})})]})]},de.id)}):l("tr",{children:l("td",{colSpan:"7",className:"text-center py-4",children:"No inventory data available."})})})]})}),b&&l("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:()=>S(null),children:m("div",{className:"bg-white rounded-2xl shadow-lg p-8 max-w-2xl w-full relative flex flex-col md:flex-row gap-8",children:[m("button",{className:"absolute top-4 right-4 bg-gray-100 hover:bg-red-100 text-gray-500 hover:text-red-600 rounded-full p-3 transition-colors shadow text-2xl",onClick:()=>S(null),"aria-label":"Close modal",children:[l("span",{className:"sr-only",children:"Close"}),""]}),l("div",{className:"flex-shrink-0 flex items-center justify-center bg-gray-50 rounded-l-2xl md:rounded-l-2xl md:rounded-r-none p-10 md:w-1/2 w-full border-b md:border-b-0 md:border-r",children:l("div",{className:"flex items-center justify-center w-full max-w-[500px] max-h-[400px] bg-white rounded border overflow-hidden",children:l("img",{src:ri(b.name),alt:b.name,className:"max-w-full max-h-[400px] object-contain"})})}),m("div",{className:"flex-1 flex flex-col justify-center p-10 md:w-1/2 w-full",children:[l("div",{className:"text-3xl font-extrabold text-gray-900 mb-4 text-center md:text-left",children:b.name}),m("div",{className:"mb-6 flex flex-wrap gap-3 justify-center md:justify-start",children:[m("span",{className:"inline-block bg-gray-100 text-gray-700 rounded px-3 py-1 text-base font-semibold",children:["ID: ",b.id]}),l("span",{className:"inline-block bg-blue-100 text-blue-700 rounded px-3 py-1 text-base font-semibold",children:(()=>{const de=v.find(Ge=>String(Ge.id)===String(b.category_id));return de?qx[de.name]||de.name:b.category_id})()}),m("span",{className:"inline-block bg-green-100 text-green-700 rounded px-3 py-1 text-base font-semibold",children:["Brand: ",b.brand||"-"]})]}),m("div",{className:"grid grid-cols-2 gap-x-6 gap-y-4 text-lg text-gray-700 mb-6",children:[m("div",{className:"flex items-center font-semibold",children:[l("span",{className:"mr-2 text-blue-600 text-2xl font-bold align-middle",children:""}),"Price:"]}),m("div",{className:"font-bold text-green-700 text-xl",children:["",b.price]}),m("div",{className:"flex items-center font-semibold",children:[l("span",{className:"mr-2",children:m("svg",{className:"w-5 h-5 text-yellow-500 inline",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[l("circle",{cx:"12",cy:"12",r:"10"}),l("path",{d:"M12 8v4l3 3"})]})}),"Stock:"]}),l("div",{className:"text-lg",children:b.stock_quantity??b.stock})]}),b.specs&&typeof b.specs=="object"&&Object.keys(b.specs).length>0&&m("div",{className:"mb-2",children:[l("div",{className:"font-semibold text-gray-800 mb-2 text-lg",children:"Specs:"}),l("ul",{className:"list-disc list-inside text-base text-gray-600",children:Object.entries(b.specs).map(([de,Ge])=>m("li",{children:[m("span",{className:"font-medium capitalize",children:[de.replace(/_/g," "),":"]})," ",String(Ge)]},de))})]})]})]})}),k!==null&&l("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:()=>_(null),children:m("div",{className:"bg-white rounded-2xl shadow-lg p-6 max-w-2xl w-full relative",onClick:de=>de.stopPropagation(),children:[l("button",{className:"absolute top-4 right-4 text-gray-500 hover:text-gray-800",onClick:()=>_(null),children:""}),l("h3",{className:"text-xl font-bold mb-4",children:k.id?"Edit Product":"Add Product"}),l(Dfe,{item:k,categories:v,onCancel:()=>_(null),onSave:async de=>{de&&s(Ge=>k.id?Ge.map(et=>et.id===de.id?de:et):[de,...Ge]),_(null)}})]})})]}),$e=()=>m("div",{className:"space-y-6",children:[m("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l("h2",{className:"page-title",children:"Orders Management"}),m("button",{className:"bg-indigo-600 text-white px-5 py-2 rounded-xl hover:bg-indigo-700 flex items-center gap-2 shadow-lg",onClick:()=>ae(!0),children:[l(Vn,{className:"h-4 w-4"}),"Add Order"]})]}),l("div",{className:"bg-white rounded-2xl shadow-lg border overflow-x-auto",children:m("table",{className:"min-w-full divide-y divide-gray-200",children:[l("thead",{className:"bg-gray-50",children:m("tr",{children:[l("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Order ID"}),l("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Customer"}),l("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Total"}),l("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Status"}),l("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Date"}),l("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),l("tbody",{className:"bg-white divide-y divide-gray-200",children:o&&o.length>0?o.map(de=>m("tr",{children:[m("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:["#",de.id]}),l("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:de.user_id}),l("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:gt(de.total_price)}),l("td",{className:"px-6 py-4 whitespace-nowrap",children:l("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${de.status==="Completed"?"bg-green-100 text-green-800":de.status==="Processing"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:de.status})}),l("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:de.order_date}),l("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:l("button",{className:"text-blue-600 hover:text-blue-900",onClick:()=>{I(de),ae(!0)},title:"Edit Order",children:l(_i,{className:"h-4 w-4"})})})]},de.id)):l("tr",{children:l("td",{colSpan:"6",className:"text-center py-4",children:"No order data available."})})})]})}),V&&l("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-6",onClick:()=>{ae(!1),I(null)},children:m("div",{className:"bg-white rounded-3xl shadow-2xl p-8 max-w-6xl w-full max-h-[95vh] overflow-y-auto relative modal-scrollbar",onClick:de=>de.stopPropagation(),children:[l("button",{className:"absolute top-6 right-6 text-gray-500 hover:text-gray-800 z-10 text-2xl font-bold",onClick:()=>{ae(!1),I(null)},children:""}),l("h3",{className:"text-2xl font-bold mb-6 text-gray-800",children:oe?"Edit Order":"Create Order"}),l(Ofe,{user:t,inventory:i,categories:v,editingOrder:oe,onCancel:()=>{ae(!1),I(null)},onCreated:()=>{ae(!1),I(null),qe(`${ve}/index.php?endpoint=orders`).then(de=>de.json()).then(de=>{de&&de.success&&c(de.data||[])}).catch(()=>{})}})]})})]}),Ee=de=>l("div",{children:l($c,{...de})}),Ae=de=>l("div",{children:l(NN,{...de})}),Be=()=>{switch(n){case"employee-dashboard":return l(be,{});case"inventory":return t.can_access_inventory===0||t.can_access_inventory==="0"||t.can_access_inventory===!1||t.can_access_inventory==="false"?m("div",{className:"bg-yellow-100 border border-yellow-300 text-yellow-800 px-6 py-4 rounded-2xl text-center max-w-lg mx-auto mt-24",children:[l("h2",{className:"text-2xl font-bold mb-2",children:"Inventory Access Disabled"}),l("p",{className:"text-lg",children:"Your access to Inventory Management has been disabled by a Super Admin. If you believe this is a mistake, please contact your administrator."})]}):l(j,{});case"orders-management":return l($e,{});case"admin-chat-support":return l(pd,{user:t,fullScreen:!0});case"notifications":return l(Vm,{user:t});case"pc-assembly":return l(Ee,{user:t});case"prebuilt-management":return l(Ae,{user:t});case"sales-reports":return l(BM,{reports:u,orders:o});case"system-reports":return l(SN,{reports:u,inventory:i,categories:v,formalCategoryNames:qx});default:return l(be,{})}};return N.useEffect(()=>{localStorage.getItem("token")||(window.location.href="/")},[]),N.useEffect(()=>{const Ge=setTimeout(async()=>{try{if(!await nr())return;const Qe=await qe(`${ve}/index.php?endpoint=profile`,{method:"GET",suppressUnauthorizedEvent:!0});if(Qe.status===401)return;const te=await Qe.json().catch(()=>({}));te.success&&te.user&&r&&r(te.user)}catch(et){console.error("EmployeeDashboard: Error fetching profile:",et)}},500);return()=>clearTimeout(Ge)},[n,r]),N.useEffect(()=>{const de=setInterval(async()=>{try{if(!await nr())return;const et=await qe(`${ve}/index.php?endpoint=profile`,{method:"GET",suppressUnauthorizedEvent:!0});if(et.status===401)return;const Qe=await et.json().catch(()=>({}));Qe.success&&Qe.user&&(typeof q<"u"&&Qe.user.can_access_inventory!==q&&window.location.reload(),r&&r(Qe.user))}catch(Ge){console.error("EmployeeDashboard: Error in profile interval fetch:",Ge)}},3e4);return()=>clearInterval(de)},[r,q]),t?t.can_access_inventory===0&&n==="inventory"?l("div",{className:"flex flex-col items-center justify-center h-full",children:m("div",{className:"bg-yellow-100 border border-yellow-300 text-yellow-800 px-6 py-4 rounded-2xl text-center max-w-lg mx-auto",children:[l("h2",{className:"text-2xl font-bold mb-2",children:"Inventory Access Disabled"}),l("p",{className:"text-lg",children:"Your access to Inventory Management has been disabled by a Super Admin. If you believe this is a mistake, please contact your administrator."})]})}):n==="admin-chat-support"?l(lt,{children:Be()}):l("div",{className:"p-4 sm:p-6 lg:p-8",children:f?l("div",{className:"flex items-center justify-center h-64",children:l("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):p?l("div",{className:"text-center text-red-600 py-8",children:p}):Be()}):l("div",{className:"flex items-center justify-center h-screen",children:l("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})};function Ofe({user:e,inventory:t=[],categories:r=[],editingOrder:n=null,onCancel:a=()=>{},onCreated:i=()=>{}}){const[s,o]=ft.useState([]),[c,u]=ft.useState("Completed"),[d,f]=ft.useState(!1),[h,p]=ft.useState(""),[x,g]=ft.useState(""),y=()=>o(S=>[...S,{component_id:"",quantity:1}]),v=(S,k)=>o(_=>_.map((E,P)=>P===S?{...E,...k}:E)),w=S=>o(k=>k.filter((_,E)=>E!==S));return ft.useEffect(()=>{s.length===0&&y()},[]),ft.useEffect(()=>{n&&(u(n.status||"Completed"),p(n.notes||""),g(n.purchase_date||""),(async()=>{try{const _=await(await qe(`${ve}/index.php?endpoint=orders&id=${n.id}`)).json();if(_.success&&_.data&&_.data.items){const E=_.data.items.map(P=>({component_id:P.component_id.toString(),quantity:P.quantity}));o(E)}else o([]),y()}catch(k){console.error("Error fetching order details:",k),o([]),y()}})())},[n]),m("form",{onSubmit:async S=>{if(S.preventDefault(),!Array.isArray(s)||s.length===0)return;if(s.filter(E=>!E.component_id||E.component_id==="").length>0){alert('Please select a component for all items or remove empty slots using the "Remove" button.');return}if(!x){alert("Please select a purchase date.");return}const _=s.filter(E=>E.component_id&&Number(E.quantity)>0).map(E=>({component_id:Number(E.component_id),quantity:Number(E.quantity)}));if(_.length!==0){f(!0);try{const E=!!n,P=E?`${ve}/index.php?endpoint=orders&id=${n.id}`:`${ve}/index.php?endpoint=orders`,T=await qe(P,{method:E?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:_,status:c,notes:h?String(h).toUpperCase():void 0,purchase_date:x})}),R=await T.json().catch(()=>({}));!T.ok||!R.success?alert(R.error||`Failed to ${E?"update":"create"} order`):i(R.order_id||(n==null?void 0:n.id))}catch(E){console.error(E),alert("Network error creating order")}finally{f(!1)}}},className:"space-y-8",children:[m("div",{className:"bg-gray-50 rounded-2xl p-6",children:[l("h4",{className:"text-lg font-semibold text-gray-800 mb-6",children:"Component Selection"}),m("div",{className:"space-y-6",children:[s.map((S,k)=>l("div",{className:`bg-white rounded-xl p-6 shadow-sm border-2 ${!S.component_id||S.component_id===""?"border-red-200 bg-red-50":"border-gray-200"}`,children:m("div",{className:"grid grid-cols-12 gap-4 items-end",children:[m("div",{className:"col-span-7",children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Component"}),l(kN,{value:S.component_id,onChange:_=>v(k,{component_id:_}),inventory:t,categories:r,placeholder:"Search components...",className:`w-full ${!S.component_id||S.component_id===""?"border-red-300":""}`}),(!S.component_id||S.component_id==="")&&l("p",{className:"text-red-600 text-sm mt-2 font-medium",children:"Please select a component or remove this item"})]}),m("div",{className:"col-span-3",children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Quantity"}),l("input",{type:"number",min:1,className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",value:S.quantity,onChange:_=>v(k,{quantity:_.target.value})})]}),l("div",{className:"col-span-2 flex justify-end",children:l("button",{type:"button",className:"text-red-600 hover:text-red-800 font-semibold text-sm py-3 px-4 border-2 border-red-300 rounded-lg hover:bg-red-50 transition-colors whitespace-nowrap",onClick:()=>w(k),children:"Remove"})})]})},k)),m("button",{type:"button",className:"w-full text-indigo-600 hover:text-indigo-800 font-semibold flex items-center justify-center gap-3 py-4 px-6 border-2 border-dashed border-indigo-300 rounded-xl hover:bg-indigo-50 transition-colors",onClick:y,children:[l(Vn,{className:"h-5 w-5"}),"Add Another Component"]})]})]}),m("div",{className:"bg-gray-50 rounded-2xl p-6",children:[l("h4",{className:"text-lg font-semibold text-gray-800 mb-6",children:"Order Details"}),m("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[m("div",{children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Status"}),m("select",{className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",value:c,onChange:S=>u(S.target.value),children:[l("option",{value:"Pending",children:"Pending"}),l("option",{value:"Processing",children:"Processing"}),l("option",{value:"Completed",children:"Completed"}),l("option",{value:"Cancelled",children:"Cancelled"})]})]}),m("div",{children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Purchase Date *"}),l("input",{type:"date",className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",value:x,onChange:S=>g(S.target.value),required:!0})]}),m("div",{children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Notes (COMMENTS)"}),l("input",{className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",value:h,onChange:S=>p(S.target.value),placeholder:"OPTIONAL"})]})]})]}),m("div",{className:"flex justify-end gap-4 pt-6 border-t-2 border-gray-200",children:[l("button",{type:"button",onClick:a,className:"px-8 py-3 border-2 border-gray-300 rounded-xl hover:bg-gray-50 transition-colors font-semibold text-gray-700",children:"Cancel"}),l("button",{type:"submit",className:"px-8 py-3 bg-indigo-600 text-white rounded-xl hover:bg-indigo-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-semibold text-lg",disabled:d,children:d?n?"Updating...":"Creating...":n?"Update Order":"Create Order"})]})]})}function Dfe({item:e={},categories:t=[],onCancel:r=()=>{},onSave:n=()=>{}}){const[a,i]=ft.useState({id:e.id||null,name:e.name||"",brand:e.brand||"",price:e.price||0,stock_quantity:e.stock_quantity??e.stock??0,category_id:e.category_id||t[0]&&t[0].id||"",image_url:e.image_url||""}),[s,o]=ft.useState(!1),[c,u]=ft.useState({BULACAN:"",MARIKINA:""}),[d,f]=ft.useState(!1),h=ft.useRef(null),[p,x]=ft.useState(null),g=(v,w)=>i(b=>({...b,[v]:w}));return m("form",{onSubmit:async v=>{v.preventDefault(),o(!0);try{const w=a.id?"update_component":"create_component",S=await(await qe(`${ve}/index.php?endpoint=${w}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json();if(!S.success){alert(S.error||"Save failed"),o(!1);return}let k=S.data||{...a,id:a.id||S.data&&S.data.id};const _=k.id||a.id,E={"Content-Type":"application/json",Authorization:`Bearer ${token}`},P=D=>D===""||D===null||D===void 0?null:parseInt(D,10),A=P(c.BULACAN),T=P(c.MARIKINA),R=[];if(_&&(A!==null&&!Number.isNaN(A)&&R.push(fetch(`${ve}/update_component_stock.php`,{method:"POST",headers:E,body:JSON.stringify({component_id:_,branch:"BULACAN",stock_quantity:A})})),T!==null&&!Number.isNaN(T)&&R.push(fetch(`${ve}/update_component_stock.php`,{method:"POST",headers:E,body:JSON.stringify({component_id:_,branch:"MARIKINA",stock_quantity:T})}))),R.length){await Promise.allSettled(R);const D=(Number.isFinite(A)?A:0)+(Number.isFinite(T)?T:0);k={...k,stock_quantity:D}}n(k)}catch(w){console.error(w),alert("Error saving item")}finally{o(!1)}},className:"space-y-4",children:[m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),l("input",{required:!0,value:a.name,onChange:v=>g("name",v.target.value),className:"mt-1 block w-full border rounded px-3 py-2"})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Brand"}),l("input",{value:a.brand,onChange:v=>g("brand",v.target.value),className:"mt-1 block w-full border rounded px-3 py-2"})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Image"}),m("div",{className:"flex items-center gap-3",children:[l("input",{type:"text",placeholder:"Image URL (optional)",value:a.image_url,onChange:v=>g("image_url",v.target.value),className:"mt-1 block w-full border rounded px-3 py-2"}),l("input",{ref:h,type:"file",accept:"image/*",onChange:async v=>{const w=v.target.files&&v.target.files[0];if(!w)return;const b=URL.createObjectURL(w);g("image_url",b);try{const S=new Image;S.onload=()=>{x({sizeBytes:w.size,width:S.naturalWidth,height:S.naturalHeight})},S.src=b}catch{}},className:"mt-1"})]}),l("div",{className:"mt-2",children:a.image_url?m("div",{className:"flex items-center gap-3",children:[l("img",{src:a.image_url,alt:"Preview",className:"w-20 h-20 object-contain border rounded",onError:v=>{v.currentTarget.style.display="none"}}),p&&m("span",{className:"text-xs text-gray-600",children:[p.width,"",p.height," px, ",(p.sizeBytes/1024).toFixed(1)," KB"]})]}):l("span",{className:"text-xs text-gray-500",children:"Optional: provide a URL or pick a file"})})]}),m("div",{className:"grid grid-cols-2 gap-4",children:[m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Price"}),l("input",{type:"number",step:"0.01",value:a.price,onChange:v=>g("price",v.target.value),className:"mt-1 block w-full border rounded px-3 py-2"})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Stock Quantity"}),l("input",{type:"number",value:a.stock_quantity,onChange:v=>g("stock_quantity",v.target.value),className:"mt-1 block w-full border rounded px-3 py-2"})]})]}),a.id&&m("div",{className:"grid grid-cols-2 gap-4",children:[m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Bulacan Stock"}),l("input",{type:"number",value:c.BULACAN,onChange:v=>u(w=>({...w,BULACAN:v.target.value})),className:"mt-1 block w-full border rounded px-3 py-2",disabled:d})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Marikina Stock"}),l("input",{type:"number",value:c.MARIKINA,onChange:v=>u(w=>({...w,MARIKINA:v.target.value})),className:"mt-1 block w-full border rounded px-3 py-2",disabled:d})]})]}),m("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Category"}),l("select",{value:a.category_id,onChange:v=>g("category_id",v.target.value),className:"mt-1 block w-full border rounded px-3 py-2",children:t.map(v=>l("option",{value:v.id,children:v.name},v.id))})]}),m("div",{className:"flex justify-end gap-2",children:[l("button",{type:"button",onClick:r,className:"px-4 py-2 border rounded",children:"Cancel"}),l("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded",disabled:s,children:s?"Saving...":"Save"})]})]})}const Rfe=()=>{const[e,t]=N.useState([]),[r,n]=N.useState(""),a=N.useRef(null),i=N.useRef(null);N.useEffect(()=>{const c=[];for(let u=1;u<=20;u++)c.push({id:u,message:`This is test message number ${u}. This message is long enough to test scrolling functionality. It should wrap to multiple lines and create enough content to make the scroll bar appear.`,sender:u%2===0?"user":"support",sent_at:new Date(Date.now()-(20-u)*6e4).toISOString()});t(c)},[]),N.useEffect(()=>{var c;if(i.current){const u=i.current;u.scrollHeight-u.scrollTop<=u.clientHeight+100&&((c=a.current)==null||c.scrollIntoView({behavior:"smooth"}))}},[e]);const s=()=>{if(!r.trim())return;const c={id:e.length+1,message:r,sender:"user",sent_at:new Date().toISOString()};t([...e,c]),n("")},o=c=>new Date(c).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return m("div",{className:"flex flex-col h-full bg-white rounded-lg shadow-sm overflow-hidden",children:[l("div",{className:"bg-white border-b border-gray-200 p-4 flex-shrink-0",children:l("div",{className:"flex items-center justify-between",children:m("div",{className:"flex items-center gap-3",children:[l("div",{className:"w-10 h-10 rounded-full bg-green-600 flex items-center justify-center text-white",children:l("span",{className:"text-sm font-bold",children:"T"})}),m("div",{children:[l("h3",{className:"font-semibold text-gray-900",children:"Scroll Test"}),l("p",{className:"text-xs text-gray-500",children:"Testing scroll functionality"})]})]})})}),m("div",{ref:i,className:"flex-1 overflow-y-auto overflow-x-hidden p-4 space-y-3 chat-messages-container",style:{minHeight:"0",maxHeight:"calc(100vh - 200px)",scrollbarWidth:"thin",scrollbarColor:"#9ca3af #f1f5f9"},children:[e.map(c=>l("div",{className:`flex ${c.sender==="user"?"justify-end":"justify-start"}`,children:m("div",{className:`max-w-[80%] rounded-xl px-4 py-2 ${c.sender==="user"?"bg-green-600 text-white rounded-br-none":"bg-gray-100 text-gray-800 rounded-bl-none"}`,children:[l("div",{className:"text-sm whitespace-pre-wrap break-words",children:c.message}),l("div",{className:`text-xs mt-1 text-right ${c.sender==="user"?"text-green-200":"text-gray-500"}`,children:o(c.sent_at)})]})},c.id)),l("div",{ref:a,className:"min-h-[1px]"})]}),l("div",{className:"border-t border-gray-200 p-3 bg-white flex-shrink-0",children:m("div",{className:"flex gap-2",children:[l("input",{type:"text",className:"flex-1 p-2 border rounded-lg focus:outline-none focus:ring-1 focus:ring-green-500 focus:border-green-500",placeholder:"Type your message...",value:r,onChange:c=>n(c.target.value),onKeyDown:c=>c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),s())}),l("button",{onClick:s,disabled:!r.trim(),className:`p-2 rounded-lg ${r.trim()?"bg-green-600 text-white hover:bg-green-700":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,title:"Send message",children:l(Il,{className:"w-5 h-5"})})]})})]})},lC=()=>l("div",{className:"min-h-screen bg-gray-100 p-8",children:m("div",{className:"max-w-4xl mx-auto",children:[l("h1",{className:"text-3xl font-bold text-gray-800 mb-8",children:"Chat Scroll Bar Test"}),m("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[m("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[l("h2",{className:"text-xl font-semibold mb-4",children:"Scroll Test Component"}),l("div",{className:"h-96",children:l(Rfe,{})})]}),m("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[l("h2",{className:"text-xl font-semibold mb-4",children:"Manual Scroll Test"}),l("div",{className:"h-96 overflow-y-scroll chat-messages-container border border-gray-200 rounded-lg p-4",style:{scrollbarWidth:"thin",scrollbarColor:"#9ca3af #f1f5f9"},children:Array.from({length:50},(e,t)=>m("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[m("div",{className:"font-medium text-gray-800",children:["Message ",t+1]}),l("div",{className:"text-sm text-gray-600 mt-1",children:"This is a test message to verify scroll bar functionality. This message is long enough to wrap to multiple lines and create enough content to make the scroll bar appear."}),l("div",{className:"text-xs text-gray-400 mt-2",children:new Date(Date.now()-t*6e4).toLocaleTimeString()})]},t))})]})]}),m("div",{className:"mt-8 bg-white rounded-lg shadow-lg p-6",children:[l("h2",{className:"text-xl font-semibold mb-4",children:"Scroll Bar Status"}),m("div",{className:"space-y-2 text-sm",children:[m("div",{className:"flex items-center gap-2",children:[l("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),l("span",{children:"Scroll bar should be visible on the right side"})]}),m("div",{className:"flex items-center gap-2",children:[l("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),l("span",{children:"Scroll bar should be gray with rounded corners"})]}),m("div",{className:"flex items-center gap-2",children:[l("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),l("span",{children:"You should be able to scroll up and down"})]}),m("div",{className:"flex items-center gap-2",children:[l("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),l("span",{children:"Auto-scroll should work when new messages arrive"})]})]})]})]})}),cC=({setCurrentPage:e})=>m("div",{className:"min-h-screen bg-gray-50",children:[l("div",{className:"bg-white shadow-sm",children:l("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:m("div",{className:"flex items-center justify-between h-16",children:[m("button",{onClick:()=>e("home"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[l(wf,{className:"w-5 h-5"}),"Back to Home"]}),l("h1",{className:"text-2xl font-bold text-gray-900",children:"About SIMS"}),l("div",{})]})})}),m("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[m("div",{className:"text-center mb-16",children:[l("h2",{className:"text-4xl font-bold text-gray-900 mb-6",children:"About SIMS"}),l("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"SIMS (Smart Inventory Management System) is a comprehensive PC building platform designed to make computer assembly accessible, reliable, and enjoyable for everyone."})]}),m("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-16",children:[m("div",{className:"bg-white rounded-lg shadow-sm p-8",children:[m("div",{className:"flex items-center gap-3 mb-4",children:[l(MT,{className:"w-8 h-8 text-green-600"}),l("h3",{className:"text-2xl font-semibold text-gray-900",children:"Our Mission"})]}),l("p",{className:"text-gray-600 leading-relaxed",children:"To democratize PC building by providing an intuitive platform that eliminates compatibility concerns and makes custom computer assembly accessible to users of all technical skill levels."})]}),m("div",{className:"bg-white rounded-lg shadow-sm p-8",children:[m("div",{className:"flex items-center gap-3 mb-4",children:[l(Um,{className:"w-8 h-8 text-green-600"}),l("h3",{className:"text-2xl font-semibold text-gray-900",children:"Our Vision"})]}),l("p",{className:"text-gray-600 leading-relaxed",children:"To become the leading platform for PC building education and component compatibility, empowering users to build their dream computers with confidence."})]})]}),m("div",{className:"mb-16",children:[l("h3",{className:"text-3xl font-bold text-gray-900 text-center mb-12",children:"What Makes SIMS Special"}),m("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[m("div",{className:"text-center",children:[l("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l(iu,{className:"w-8 h-8 text-green-600"})}),l("h4",{className:"text-xl font-semibold text-gray-900 mb-3",children:"User-Friendly"}),l("p",{className:"text-gray-600",children:"Intuitive interface designed for both beginners and experts"})]}),m("div",{className:"text-center",children:[l("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l(Um,{className:"w-8 h-8 text-green-600"})}),l("h4",{className:"text-xl font-semibold text-gray-900 mb-3",children:"Reliable"}),l("p",{className:"text-gray-600",children:"Advanced compatibility checking ensures your build will work"})]}),m("div",{className:"text-center",children:[l("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l(E8,{className:"w-8 h-8 text-green-600"})}),l("h4",{className:"text-xl font-semibold text-gray-900 mb-3",children:"Community-Driven"}),l("p",{className:"text-gray-600",children:"Built by PC enthusiasts, for PC enthusiasts"})]})]})]}),m("div",{className:"bg-white rounded-lg shadow-sm p-8",children:[l("h3",{className:"text-3xl font-bold text-gray-900 text-center mb-8",children:"Our Team"}),l("p",{className:"text-gray-600 text-center max-w-2xl mx-auto",children:"SIMS is developed by a passionate team of computer science students and PC building enthusiasts who understand the challenges of building custom computers. We're committed to making PC building accessible and enjoyable for everyone."})]}),l("div",{className:"text-center mt-12",children:l("button",{onClick:()=>e("pc-assembly"),className:"bg-green-600 text-white px-8 py-3 rounded-lg font-semibold text-lg hover:bg-green-700 transition-colors",children:"Start Building Your PC"})})]})]}),uC=({setCurrentPage:e})=>{const[t,r]=N.useState({name:"",email:"",subject:"",message:""}),[n,a]=N.useState(!1),[i,s]=N.useState(null),o=async u=>{u.preventDefault(),a(!0),s(null);try{const f=await(await fetch(`${ve}/submit_feedback.php`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();f.success?(s("success"),r({name:"",email:"",subject:"",message:""}),setTimeout(()=>s(null),5e3)):(s("error"),console.error("Contact form error:",f.error))}catch(d){console.error("Contact form error:",d),s("error")}finally{a(!1)}},c=u=>{r({...t,[u.target.name]:u.target.value})};return m("div",{className:"min-h-screen bg-gray-50",children:[l("div",{className:"bg-white shadow-sm",children:l("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:m("div",{className:"flex items-center justify-between h-16",children:[m("button",{onClick:()=>e("home"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[l(wf,{className:"w-5 h-5"}),"Back to Home"]}),l("h1",{className:"text-2xl font-bold text-gray-900",children:"Contact Us"}),l("div",{})]})})}),m("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[m("div",{className:"text-center mb-12",children:[l("h2",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Get in Touch"}),l("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Have questions about SIMS? Need help with your PC build? We're here to help you every step of the way."})]}),m("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12",children:[m("div",{className:"space-y-8",children:[m("div",{children:[l("h3",{className:"text-2xl font-semibold text-gray-900 mb-6",children:"Contact Information"}),m("div",{className:"space-y-6",children:[m("div",{className:"flex items-start gap-4",children:[l("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0",children:l(P8,{className:"w-6 h-6 text-green-600"})}),m("div",{children:[l("h4",{className:"font-semibold text-gray-900",children:"Email"}),l("p",{className:"text-gray-600",children:"support@builditpc.com"}),l("p",{className:"text-gray-600",children:"info@builditpc.com"})]})]}),m("div",{className:"flex items-start gap-4",children:[l("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0",children:l(I8,{className:"w-6 h-6 text-green-600"})}),m("div",{children:[l("h4",{className:"font-semibold text-gray-900",children:"Phone"}),l("p",{className:"text-gray-600",children:"+63 912 345 6789"}),l("p",{className:"text-gray-600",children:"Mon-Fri: 9AM-6PM (PST)"})]})]}),m("div",{className:"flex items-start gap-4",children:[l("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0",children:l(O8,{className:"w-6 h-6 text-green-600"})}),m("div",{children:[l("h4",{className:"font-semibold text-gray-900",children:"Address"}),l("p",{className:"text-gray-600",children:"Ground flr JSP Bldg. 9109 National rd. Cay Pombo, Santa Maria, Philippines"}),l("p",{className:"text-gray-600",children:"SIMS Development Center"})]})]})]})]}),m("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[l("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Help"}),m("div",{className:"space-y-2",children:[l("button",{onClick:()=>e("faq"),className:"block w-full text-left text-green-600 hover:text-green-700 transition-colors",children:" Frequently Asked Questions"}),l("button",{onClick:()=>e("compatibility-guide"),className:"block w-full text-left text-green-600 hover:text-green-700 transition-colors",children:" Compatibility Guide"}),l("button",{onClick:()=>e("troubleshooting"),className:"block w-full text-left text-green-600 hover:text-green-700 transition-colors",children:" Troubleshooting Guide"})]})]})]}),m("div",{className:"bg-white rounded-lg shadow-sm p-8",children:[l("h3",{className:"text-2xl font-semibold text-gray-900 mb-6",children:"Send us a Message"}),i==="success"&&m("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:[m("div",{className:"flex items-center gap-2",children:[l("div",{className:"w-5 h-5 bg-green-100 rounded-full flex items-center justify-center",children:l("span",{className:"text-green-600 text-sm",children:""})}),l("p",{className:"text-green-800 font-medium",children:"Message sent successfully!"})]}),l("p",{className:"text-green-700 text-sm mt-1",children:"Thank you for your message. We will get back to you soon."})]}),i==="error"&&m("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:[m("div",{className:"flex items-center gap-2",children:[l("div",{className:"w-5 h-5 bg-red-100 rounded-full flex items-center justify-center",children:l("span",{className:"text-red-600 text-sm",children:""})}),l("p",{className:"text-red-800 font-medium",children:"Failed to send message"})]}),l("p",{className:"text-red-700 text-sm mt-1",children:"Please try again later or contact us directly."})]}),m("form",{onSubmit:o,className:"space-y-6",children:[m("div",{children:[l("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name *"}),l("input",{type:"text",id:"name",name:"name",value:t.name,onChange:c,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Your full name"})]}),m("div",{children:[l("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address *"}),l("input",{type:"email",id:"email",name:"email",value:t.email,onChange:c,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"your.email@example.com"})]}),m("div",{children:[l("label",{htmlFor:"subject",className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject *"}),m("select",{id:"subject",name:"subject",value:t.subject,onChange:c,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[l("option",{value:"",children:"Select a subject"}),l("option",{value:"general",children:"General Inquiry"}),l("option",{value:"technical",children:"Technical Support"}),l("option",{value:"billing",children:"Billing Question"}),l("option",{value:"feature",children:"Feature Request"}),l("option",{value:"bug",children:"Bug Report"}),l("option",{value:"other",children:"Other"})]})]}),m("div",{children:[l("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700 mb-2",children:"Message *"}),l("textarea",{id:"message",name:"message",value:t.message,onChange:c,required:!0,rows:"5",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none",placeholder:"Tell us how we can help you..."})]}),l("button",{type:"submit",disabled:n,className:"w-full bg-green-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-green-700 transition-colors flex items-center justify-center gap-2 disabled:bg-gray-400 disabled:cursor-not-allowed",children:n?m(lt,{children:[l("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Sending..."]}):m(lt,{children:[l(Il,{className:"w-5 h-5"}),"Send Message"]})})]})]})]})]})]})},dC=({setCurrentPage:e})=>{const[t,r]=N.useState(null),[n,a]=N.useState(""),s=[{id:1,question:"How does SIMS's compatibility checker work?",answer:"Our advanced compatibility checker uses a sophisticated algorithm that analyzes multiple aspects of your selected components in real-time. It checks CPU socket compatibility with motherboards (ensuring AM5 CPUs work with AM5 motherboards, LGA1700 with LGA1700, etc.), validates RAM type matching (DDR4 vs DDR5), calculates power supply wattage requirements based on component TDP ratings, and verifies case form factor compatibility. The system also considers physical dimensions, cooling requirements, and expansion slot availability. When you select components, the checker immediately updates the compatibility score and provides specific feedback on any issues, helping you make informed decisions before purchasing.",category:"Compatibility"},{id:2,question:"Can I save my PC build for later?",answer:"Currently, SIMS operates as a real-time building and compatibility checking platform. While we don't have a persistent save feature yet, you can easily recreate your build by selecting the same components from our comprehensive database. We're actively developing build saving, sharing, and export features that will allow you to save multiple builds, share them with friends, export parts lists to retailers, and even receive notifications when component prices change. These features will be available in upcoming updates, making it easier to plan and compare different build configurations over time.",category:"Features"},{id:3,question:"Are the component prices on SIMS accurate?",answer:"The prices shown on SIMS are carefully researched market prices in Philippine Peso () based on current retail data from major Philippine retailers and online marketplaces. However, actual prices may vary due to factors like regional availability, seasonal fluctuations, import duties, and retailer-specific promotions. We recommend using our prices as a baseline for budgeting and comparison, then checking with local retailers like PCHub, DynaQuest, EasyPC, or online platforms like Lazada and Shopee for the most current pricing. Our price estimates are updated regularly to reflect market trends and new product releases.",category:"Pricing"},{id:4,question:"How often is the component database updated?",answer:"Our component database is continuously updated through multiple channels. We add new CPU and GPU releases within 24-48 hours of their official announcement, update motherboard specifications as manufacturers release new models, and refresh pricing data weekly. Our team monitors major tech announcements, manufacturer websites, and retailer catalogs to ensure comprehensive coverage. We also update component specifications, compatibility rules, and performance benchmarks based on the latest reviews and testing data. This ensures you always have access to the most current information when making your build decisions, including the latest Intel 14th gen, AMD Ryzen 7000 series, and NVIDIA RTX 4000 series components.",category:"Database"},{id:5,question:"What if the compatibility checker shows issues with my build?",answer:"When compatibility issues are detected, our system provides detailed analysis and actionable solutions. For CPU-motherboard mismatches, we'll suggest compatible alternatives or explain the socket requirements. RAM compatibility issues include recommendations for the correct DDR4/DDR5 modules and supported speeds. Power supply warnings show your estimated power draw and suggest appropriate wattage ratings. Case compatibility issues detail form factor requirements and suggest suitable alternatives. The system also provides performance impact assessments, helping you understand how different component choices affect your build's capabilities. You can use our 'Find Compatible' feature to automatically suggest alternatives that resolve the conflicts while maintaining your performance goals.",category:"Troubleshooting"},{id:6,question:"Can I use SIMS on mobile devices?",answer:"SIMS is fully responsive and optimized for all devices, including smartphones and tablets. The interface automatically adapts to your screen size, with touch-friendly buttons, swipe gestures for component browsing, and optimized layouts for smaller screens. While the desktop experience offers the most comprehensive view with side-by-side component comparison and detailed specifications, the mobile version provides full functionality for building and checking compatibility. You can browse components, check compatibility, view prebuilt recommendations, and access the FAQ section seamlessly on any device. The mobile interface prioritizes essential features while maintaining the same accuracy and reliability as the desktop version.",category:"Mobile"},{id:7,question:"How accurate are the prebuilt PC recommendations?",answer:"Our prebuilt PC recommendations are meticulously curated by a team of PC building experts who analyze market trends, performance benchmarks, and user requirements. Each system is tested for compatibility, performance, and value-for-money across different use cases. Gaming builds are optimized for frame rates and graphics performance, streaming builds balance CPU and GPU requirements for content creation, and workstation builds prioritize multi-core performance and reliability. We regularly update these recommendations based on new component releases, price changes, and performance improvements. Each prebuilt includes detailed specifications, estimated performance metrics, and upgrade paths, helping you understand exactly what you're getting and how it can be improved over time.",category:"Prebuilts"},{id:8,question:"Does SIMS provide assembly instructions?",answer:"While SIMS primarily focuses on component selection and compatibility checking, we provide comprehensive guidance throughout the PC building process. Our platform includes general assembly tips, component installation order recommendations, and common troubleshooting advice. For detailed step-by-step assembly instructions, we recommend consulting the manufacturer manuals that come with each component, as they contain specific installation procedures and safety guidelines. We also provide links to trusted assembly guides and video tutorials from reputable sources. For users who prefer professional assembly, we can recommend local PC building services and provide guidance on what to look for when choosing an assembler. Our goal is to make the entire PC building journey as smooth as possible, from planning to completion.",category:"Assembly"},{id:9,question:"Can I compare different component options side by side?",answer:"Yes! SIMS offers comprehensive component comparison features. You can preview individual components to see detailed specifications, performance benchmarks, and user reviews. The compatibility checker helps you understand how different component combinations work together, showing the impact of each choice on your overall build performance and compatibility. You can compare multiple CPUs, GPUs, or other components side-by-side to see differences in specifications, power consumption, and performance metrics. The system also provides performance estimates for different combinations, helping you make informed decisions based on your specific needs and budget. Whether you're choosing between AMD and Intel processors, different GPU tiers, or various storage options, our comparison tools help you understand the trade-offs and make the best choice for your build.",category:"Comparison"},{id:10,question:"Is SIMS free to use?",answer:"Yes, SIMS is completely free to use! All our core features are available at no cost, including the advanced compatibility checker, comprehensive component database, prebuilt PC recommendations, and all platform tools. We believe that PC building should be accessible to everyone, regardless of budget constraints. Our business model is supported through partnerships with retailers and manufacturers, allowing us to provide accurate pricing and product information while keeping the platform free for users. We're committed to maintaining this free access while continuously improving our features and expanding our component database. There are no hidden fees, premium tiers, or paid features - everything you need to build your perfect PC is available completely free of charge.",category:"Pricing"}].filter(c=>c.question.toLowerCase().includes(n.toLowerCase())||c.answer.toLowerCase().includes(n.toLowerCase())),o=c=>{r(t===c?null:c)};return m("div",{className:"min-h-screen bg-gray-50",children:[l("div",{className:"bg-white shadow-sm",children:l("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:m("div",{className:"flex items-center justify-between h-16",children:[m("button",{onClick:()=>e("home"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[l(wf,{className:"w-5 h-5"}),"Back to Home"]}),l("h1",{className:"text-2xl font-bold text-gray-900",children:"FAQ"}),l("div",{})]})})}),m("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[m("div",{className:"text-center mb-12",children:[m("div",{className:"flex items-center justify-center gap-3 mb-4",children:[l(Wv,{className:"w-8 h-8 text-green-600"}),l("h2",{className:"text-4xl font-bold text-gray-900",children:"Frequently Asked Questions"})]}),l("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Find answers to common questions about SIMS and PC building. Can't find what you're looking for? Contact us for personalized help."})]}),l("div",{className:"mb-8",children:m("div",{className:"relative max-w-2xl mx-auto",children:[l(Wi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),l("input",{type:"text",placeholder:"Search FAQ...",value:n,onChange:c=>a(c.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})}),l("div",{className:"space-y-4",children:s.map(c=>m("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[m("button",{onClick:()=>o(c.id),className:"w-full px-6 py-4 text-left flex items-center justify-between hover:bg-gray-50 transition-colors",children:[m("div",{className:"flex items-center gap-3",children:[l("span",{className:"text-lg font-medium text-gray-900",children:c.question}),l("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full",children:c.category})]}),t===c.id?l(DT,{className:"w-5 h-5 text-gray-500"}):l(cp,{className:"w-5 h-5 text-gray-500"})]}),t===c.id&&l("div",{className:"px-6 pb-4",children:l("p",{className:"text-gray-600 leading-relaxed",children:c.answer})})]},c.id))}),s.length===0&&m("div",{className:"text-center py-12",children:[l(Wv,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No FAQs found"}),l("p",{className:"text-gray-600 mb-4",children:"Try adjusting your search terms or browse all FAQs."}),l("button",{onClick:()=>a(""),className:"text-green-600 hover:text-green-700 font-medium",children:"Clear search"})]}),l("div",{className:"mt-12 text-center",children:m("div",{className:"bg-green-50 rounded-lg p-8",children:[l("h3",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Still have questions?"}),l("p",{className:"text-gray-600 mb-6",children:"Can't find the answer you're looking for? Our support team is here to help."}),m("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[l("button",{onClick:()=>e("contact"),className:"bg-green-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-700 transition-colors",children:"Contact Support"}),l("button",{onClick:()=>e("chat-support"),className:"border-2 border-green-600 text-green-600 px-6 py-3 rounded-lg font-semibold hover:bg-green-50 transition-colors",children:"Live Chat"})]})]})})]})]})},fC=({setCurrentPage:e})=>{const[t,r]=N.useState("cpu-motherboard"),n=[{id:"cpu-motherboard",title:"CPU & Motherboard",icon:l(ua,{className:"w-6 h-6"}),critical:!0,content:{description:"The most critical compatibility check - ensuring your CPU and motherboard have matching sockets.",checks:[{name:"Socket Compatibility",description:"CPU socket must match motherboard socket exactly",examples:[{cpu:"Intel Core i5-12400F",socket:"LGA1700",compatible:!0},{cpu:"AMD Ryzen 5 5600X",socket:"AM4",compatible:!0},{cpu:"Intel Core i7-12700K",socket:"LGA1700",compatible:!0}],tips:["Intel LGA1700 works with 12th and 13th gen Intel CPUs","AMD AM4 works with Ryzen 3000, 4000, and 5000 series","AMD AM5 works with Ryzen 7000 series and newer","Always check the exact socket before purchasing"]}]}},{id:"ram-motherboard",title:"RAM & Motherboard",icon:l(ti,{className:"w-6 h-6"}),critical:!0,content:{description:"Ensuring your RAM type and speed are supported by your motherboard.",checks:[{name:"RAM Type Compatibility",description:"RAM type (DDR4/DDR5) must match motherboard support",examples:[{ram:"DDR4-3200",motherboard:"DDR4 Support",compatible:!0},{ram:"DDR5-5600",motherboard:"DDR5 Support",compatible:!0},{ram:"DDR4-3200",motherboard:"DDR5 Only",compatible:!1}],tips:["DDR4 and DDR5 are not interchangeable","Check motherboard specifications for supported RAM types","Higher speed RAM may run at lower speeds if not supported","Consider future upgradeability when choosing RAM type"]},{name:"RAM Speed Support",description:"Motherboard must support the RAM speed you choose",examples:[{ram:"DDR4-3600",motherboard:"DDR4-3200 Max",compatible:!1},{ram:"DDR4-3200",motherboard:"DDR4-3600 Max",compatible:!0}],tips:["RAM will run at the lowest supported speed","Check motherboard QVL (Qualified Vendor List)","XMP/DOCP profiles may be required for higher speeds"]}]}},{id:"storage-interface",title:"Storage & Motherboard",icon:l(au,{className:"w-6 h-6"}),critical:!0,content:{description:"Ensuring your storage drives are compatible with motherboard interfaces.",checks:[{name:"Storage Interface Support",description:"Motherboard must have the right connectors for your storage",examples:[{storage:"NVMe SSD",interface:"M.2 NVMe",compatible:!0},{storage:"SATA SSD",interface:"SATA",compatible:!0},{storage:"NVMe SSD",interface:"SATA Only",compatible:!1}],tips:["M.2 slots can support both SATA and NVMe drives","Check motherboard specifications for M.2 slot types","Some M.2 slots share bandwidth with SATA ports","Consider future storage needs when choosing motherboard"]}]}},{id:"psu-power",title:"Power Supply",icon:l(Ta,{className:"w-6 h-6"}),critical:!0,content:{description:"Ensuring your power supply can handle all your components safely.",checks:[{name:"Wattage Requirements",description:"PSU must provide enough power for all components",examples:[{components:"RTX 4080 + i7-12700K",psu:"850W",compatible:!0},{components:"RTX 4090 + i9-13900K",psu:"750W",compatible:!1},{components:"RTX 3060 + i5-12400",psu:"650W",compatible:!0}],tips:["Add 20-30% buffer to calculated power requirements","High-end GPUs require more power than CPUs","Consider future upgrades when choosing PSU wattage","Efficiency rating (80+ Gold, etc.) affects actual power delivery"]},{name:"PSU Form Factor",description:"PSU must fit in your case",examples:[{psu:"ATX PSU",case:"ATX Case",compatible:!0},{psu:"SFX PSU",case:"Mini-ITX Case",compatible:!0},{psu:"ATX PSU",case:"Mini-ITX Case",compatible:!1}],tips:["Check case specifications for supported PSU sizes","SFX PSUs are smaller but more expensive","Modular PSUs help with cable management","Consider cable length for larger cases"]}]}},{id:"case-motherboard",title:"Case & Motherboard",icon:l(Ye,{className:"w-6 h-6"}),critical:!0,content:{description:"Ensuring your case can accommodate your motherboard and components.",checks:[{name:"Form Factor Compatibility",description:"Case must support your motherboard form factor",examples:[{motherboard:"ATX",case:"ATX Case",compatible:!0},{motherboard:"Micro-ATX",case:"ATX Case",compatible:!0},{motherboard:"ATX",case:"Micro-ATX Case",compatible:!1}],tips:["Larger cases can accommodate smaller motherboards","Check case specifications for supported form factors","Consider future motherboard upgrades","Smaller cases may have limited expansion options"]},{name:"GPU Length Support",description:"Case must have enough space for your graphics card",examples:[{gpu:"RTX 4090 (304mm)",case:"ATX Case (350mm)",compatible:!0},{gpu:"RTX 4090 (304mm)",case:"Mini-ITX (280mm)",compatible:!1}],tips:["Check case specifications for maximum GPU length","Consider drive cages and other obstructions","Some cases have removable drive cages for longer GPUs","Measure twice, buy once!"]}]}},{id:"cooling",title:"CPU Cooling",icon:l(ta,{className:"w-6 h-6"}),critical:!1,content:{description:"Ensuring your CPU cooler fits and provides adequate cooling.",checks:[{name:"Socket Compatibility",description:"Cooler must support your CPU socket",examples:[{cooler:"Noctua NH-D15",socket:"LGA1700",compatible:!0},{cooler:"AMD Wraith Prism",socket:"AM4",compatible:!0},{cooler:"Intel Stock Cooler",socket:"AM4",compatible:!1}],tips:["Most coolers support multiple sockets with different mounting kits","Check cooler specifications for supported sockets","Some coolers may need separate mounting hardware","AIO coolers have different mounting requirements"]},{name:"Height Clearance",description:"Cooler must fit within case height limits",examples:[{cooler:"Noctua NH-D15 (165mm)",case:"ATX Case (170mm)",compatible:!0},{cooler:"Noctua NH-D15 (165mm)",case:"Mini-ITX (160mm)",compatible:!1}],tips:["Check case specifications for maximum cooler height","Tower coolers are generally taller than low-profile coolers","AIO coolers may have different clearance requirements","Consider RAM height when choosing air coolers"]}]}}],a=s=>s?l(yt,{className:"w-5 h-5 text-green-600"}):l(Cn,{className:"w-5 h-5 text-red-600"}),i=s=>s?"text-green-600":"text-red-600";return m("div",{className:"min-h-screen bg-gray-50",children:[l("div",{className:"bg-white shadow-sm",children:l("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:m("div",{className:"flex items-center justify-between h-16",children:[m("button",{onClick:()=>e("home"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[l(wf,{className:"w-5 h-5"}),"Back to Home"]}),l("h1",{className:"text-2xl font-bold text-gray-900",children:"Compatibility Guide"}),l("div",{})]})})}),m("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[m("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[l("div",{className:"lg:col-span-1",children:m("div",{className:"bg-white rounded-lg shadow-sm p-6 sticky top-8",children:[l("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Compatibility Checks"}),l("nav",{className:"space-y-2",children:n.map(s=>m("button",{onClick:()=>r(s.id),className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg text-left transition-colors ${t===s.id?"bg-green-100 text-green-700":"text-gray-600 hover:bg-gray-100"}`,children:[s.icon,l("span",{className:"font-medium",children:s.title}),s.critical&&l($r,{className:"w-4 h-4 text-red-500 ml-auto"})]},s.id))})]})}),l("div",{className:"lg:col-span-3",children:n.map(s=>t===s.id&&m("div",{className:"bg-white rounded-lg shadow-sm p-8",children:[m("div",{className:"flex items-center gap-3 mb-6",children:[s.icon,l("h2",{className:"text-2xl font-bold text-gray-900",children:s.title}),s.critical&&l("span",{className:"px-2 py-1 bg-red-100 text-red-700 text-xs font-medium rounded-full",children:"Critical"})]}),l("p",{className:"text-gray-600 text-lg mb-8",children:s.content.description}),l("div",{className:"space-y-8",children:s.content.checks.map((o,c)=>m("div",{className:"border border-gray-200 rounded-lg p-6",children:[l("h3",{className:"text-xl font-semibold text-gray-900 mb-3",children:o.name}),l("p",{className:"text-gray-600 mb-6",children:o.description}),o.examples&&m("div",{className:"mb-6",children:[l("h4",{className:"font-semibold text-gray-900 mb-3",children:"Examples:"}),l("div",{className:"space-y-2",children:o.examples.map((u,d)=>m("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[a(u.compatible),m("div",{className:"flex-1",children:[m("span",{className:"font-medium",children:[Object.keys(u)[0],": "]}),l("span",{className:"text-gray-700",children:Object.values(u)[0]}),l("span",{className:"mx-2 text-gray-400",children:""}),m("span",{className:"font-medium",children:[Object.keys(u)[1],": "]}),l("span",{className:"text-gray-700",children:Object.values(u)[1]})]}),l("span",{className:`text-sm font-medium ${i(u.compatible)}`,children:u.compatible?"Compatible":"Incompatible"})]},d))})]}),o.tips&&m("div",{children:[l("h4",{className:"font-semibold text-gray-900 mb-3",children:"Tips:"}),l("ul",{className:"space-y-2",children:o.tips.map((u,d)=>m("li",{className:"flex items-start gap-2",children:[l(mc,{className:"w-4 h-4 text-blue-500 mt-1 flex-shrink-0"}),l("span",{className:"text-gray-600",children:u})]},d))})]})]},c))})]},s.id))})]}),l("div",{className:"mt-12 text-center",children:m("div",{className:"bg-green-50 rounded-lg p-8",children:[l("h3",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Ready to Build?"}),l("p",{className:"text-gray-600 mb-6",children:"Now that you understand compatibility, start building your perfect PC with our guided interface."}),l("button",{onClick:()=>e("pc-assembly"),className:"bg-green-600 text-white px-8 py-3 rounded-lg font-semibold text-lg hover:bg-green-700 transition-colors",children:"Start PC Assembly"})]})})]})]})},mC=({setCurrentPage:e})=>{const[t,r]=N.useState(""),[n,a]=N.useState("all"),i=[{id:"all",name:"All Issues",icon:null},{id:"compatibility",name:"Compatibility",icon:null},{id:"performance",name:"Performance",icon:null},{id:"hardware",name:"Hardware",icon:null},{id:"software",name:"Software",icon:null},{id:"build",name:"Build Process",icon:null}],o=[{id:1,title:"Components show as incompatible when they should work",category:"compatibility",severity:"high",symptoms:["Compatibility checker shows red X for components that should work","Components are from same generation but marked incompatible","Socket types match but still showing as incompatible"],solutions:["Check if component specifications are complete in database","Verify exact model numbers match manufacturer specifications","Update component database with latest specifications","Contact support if issue persists with specific components"],prevention:["Always double-check component specifications before purchasing","Use official manufacturer websites for verification","Keep component database updated with latest information"]},{id:2,title:"PC Assembly page loads slowly or times out",category:"performance",severity:"medium",symptoms:["Page takes more than 5 seconds to load","Components list shows loading spinner indefinitely","Browser shows timeout errors"],solutions:["Check internet connection stability","Clear browser cache and cookies","Try refreshing the page","Disable browser extensions temporarily","Try using a different browser"],prevention:["Use a stable internet connection","Keep browser updated to latest version","Clear browser cache regularly"]},{id:3,title:"Selected components disappear after page refresh",category:"software",severity:"high",symptoms:["Components selected in PC Assembly disappear on refresh","Build progress resets to zero","Selected components not saved"],solutions:["Ensure you are logged in to your account","Check if browser has JavaScript enabled","Try saving your build before refreshing","Clear browser cache and try again"],prevention:["Always log in before starting a build","Save your build periodically during selection","Use a supported browser with JavaScript enabled"]},{id:4,title:"Chat support not working or messages not sending",category:"software",severity:"medium",symptoms:["Chat window opens but messages don't send","Floating chat button not visible","Messages appear to send but don't reach support"],solutions:["Check internet connection","Refresh the page and try again","Clear browser cache","Try using incognito/private browsing mode","Contact support through alternative methods"],prevention:["Use a stable internet connection","Keep browser updated","Avoid using multiple chat sessions simultaneously"]},{id:5,title:"Cannot access admin dashboard or features",category:"software",severity:"high",symptoms:["Admin login works but dashboard doesn't load","Admin features show access denied errors","Cannot see admin sidebar or navigation"],solutions:["Verify admin account has correct permissions","Check if account role is properly set in database","Log out and log back in","Contact system administrator","Check browser console for error messages"],prevention:["Ensure admin accounts are properly configured","Regularly verify user permissions","Keep user roles updated in database"]},{id:6,title:"Component images not loading or showing placeholders",category:"hardware",severity:"low",symptoms:["Component cards show placeholder images","Images load slowly or not at all","Broken image icons appear"],solutions:["Check internet connection speed","Refresh the page","Clear browser cache","Try loading images in a new tab","Contact support if issue persists"],prevention:["Use a stable internet connection","Keep browser updated","Avoid ad blockers that might block images"]},{id:7,title:"Build compatibility score shows incorrect percentage",category:"compatibility",severity:"medium",symptoms:["Compatibility score doesn't match actual compatibility","Score shows 0% when components should be compatible","Score doesn't update when components change"],solutions:["Refresh the page to recalculate compatibility","Remove and re-add components","Check if all required components are selected","Verify component specifications are complete","Contact support with specific component details"],prevention:["Ensure all component data is accurate and complete","Regularly update compatibility checking algorithms","Test compatibility calculations with known good builds"]},{id:8,title:"Cannot save or submit PC build",category:"build",severity:"high",symptoms:["Save button doesn't work or is disabled","Build submission fails with error message","Build appears to save but doesn't persist"],solutions:["Ensure you are logged in to your account","Check if all required fields are filled","Verify internet connection is stable","Try saving with a different build name","Check browser console for error messages","Contact support if issue persists"],prevention:["Always log in before starting a build","Fill in all required information","Use a stable internet connection","Save builds regularly during the process"]}].filter(d=>{const f=d.title.toLowerCase().includes(t.toLowerCase())||d.symptoms.some(p=>p.toLowerCase().includes(t.toLowerCase()))||d.solutions.some(p=>p.toLowerCase().includes(t.toLowerCase())),h=n==="all"||d.category===n;return f&&h}),c=d=>{switch(d){case"high":return"text-red-600 bg-red-100";case"medium":return"text-yellow-600 bg-yellow-100";case"low":return"text-green-600 bg-green-100";default:return"text-gray-600 bg-gray-100"}},u=d=>{switch(d){case"high":return l(Cn,{className:"w-4 h-4"});case"medium":return l($r,{className:"w-4 h-4"});case"low":return l(yt,{className:"w-4 h-4"});default:return l($r,{className:"w-4 h-4"})}};return m("div",{className:"min-h-screen bg-gray-50",children:[l("div",{className:"bg-white shadow-sm",children:l("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:m("div",{className:"flex items-center justify-between h-16",children:[m("button",{onClick:()=>e("home"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[l(wf,{className:"w-5 h-5"}),"Back to Home"]}),l("h1",{className:"text-2xl font-bold text-gray-900",children:"Troubleshooting"}),l("div",{})]})})}),m("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[m("div",{className:"text-center mb-12",children:[m("div",{className:"flex items-center justify-center gap-3 mb-4",children:[l(jS,{className:"w-8 h-8 text-green-600"}),l("h2",{className:"text-4xl font-bold text-gray-900",children:"Troubleshooting Guide"})]}),l("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Having issues with SIMS? Find solutions to common problems and get back to building your perfect PC."})]}),m("div",{className:"mb-8 space-y-4",children:[m("div",{className:"relative max-w-2xl mx-auto",children:[l(Wi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),l("input",{type:"text",placeholder:"Search troubleshooting issues...",value:t,onChange:d=>r(d.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),l("div",{className:"flex flex-wrap justify-center gap-2",children:i.map(d=>m("button",{onClick:()=>a(d.id),className:`px-4 py-2 rounded-lg font-medium transition-colors ${n===d.id?"bg-green-600 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:[d.icon&&l("span",{className:"mr-2",children:d.icon}),d.name]},d.id))})]}),l("div",{className:"space-y-6",children:o.map(d=>m("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[l("div",{className:"flex items-start justify-between mb-4",children:m("div",{className:"flex-1",children:[l("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:d.title}),m("div",{className:"flex items-center gap-3",children:[m("span",{className:`px-2 py-1 rounded-full text-xs font-medium flex items-center gap-1 ${c(d.severity)}`,children:[u(d.severity),d.severity.charAt(0).toUpperCase()+d.severity.slice(1)," Priority"]}),l("span",{className:"text-sm text-gray-500 capitalize",children:d.category})]})]})}),m("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[m("div",{children:[m("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[l($r,{className:"w-4 h-4 text-red-500"}),"Symptoms"]}),l("ul",{className:"space-y-2",children:d.symptoms.map((f,h)=>m("li",{className:"text-sm text-gray-600 flex items-start gap-2",children:[l("span",{className:"text-red-500 mt-1",children:""}),f]},h))})]}),m("div",{children:[m("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[l(jS,{className:"w-4 h-4 text-green-500"}),"Solutions"]}),l("ul",{className:"space-y-2",children:d.solutions.map((f,h)=>m("li",{className:"text-sm text-gray-600 flex items-start gap-2",children:[l("span",{className:"text-green-500 mt-1",children:""}),f]},h))})]}),m("div",{children:[m("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[l(qa,{className:"w-4 h-4 text-blue-500"}),"Prevention"]}),l("ul",{className:"space-y-2",children:d.prevention.map((f,h)=>m("li",{className:"text-sm text-gray-600 flex items-start gap-2",children:[l("span",{className:"text-blue-500 mt-1",children:""}),f]},h))})]})]})]},d.id))}),o.length===0&&m("div",{className:"text-center py-12",children:[l(S8,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No issues found"}),l("p",{className:"text-gray-600 mb-4",children:"Try adjusting your search terms or browse all categories."}),l("button",{onClick:()=>{r(""),a("all")},className:"text-green-600 hover:text-green-700 font-medium",children:"Clear filters"})]}),l("div",{className:"mt-12 text-center",children:m("div",{className:"bg-green-50 rounded-lg p-8",children:[l("h3",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Still need help?"}),l("p",{className:"text-gray-600 mb-6",children:"Can't find a solution to your problem? Our support team is ready to help you get back on track."}),m("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[l("button",{onClick:()=>e("contact"),className:"bg-green-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-700 transition-colors",children:"Contact Support"}),l("button",{onClick:()=>e("chat-support"),className:"border-2 border-green-600 text-green-600 px-6 py-3 rounded-lg font-semibold hover:bg-green-50 transition-colors",children:"Live Chat"})]})]})})]})]})},hC=({onLogin:e,onSwitchToRegister:t})=>{const[r,n]=N.useState({username:"",password:""}),[a,i]=N.useState(""),[s,o]=N.useState(""),[c,u]=N.useState(!1),[d,f]=N.useState(!1),[h,p]=N.useState(!1),[x,g]=N.useState(""),[y,v]=N.useState(!1),[w,b]=N.useState(!1),S=P=>{n({...r,[P.target.name]:P.target.value}),i(""),o("")},k=async P=>{P.preventDefault(),u(!0),i(""),o("");const A=!r.username||!r.username.trim(),T=!d&&(!r.password||!r.password.trim());if(A||T){u(!1),i("Email and Password are required");return}try{if(d){const R=(r.username||"").trim(),D=/^[^@]+@gmail\.com$/i.test(R);if(!R||!R.includes("@")){i("Please enter your email address to use OTP login.");return}if(!D){i("Only Gmail addresses are allowed for OTP.");return}if(!x){i("Enter the 6-digit code sent to your email.");return}const L=await fetch(`${ve}/index.php?endpoint=otp_verify`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r.username,purpose:"login",code:x})}),z=await L.json();L.ok&&z.success&&z.token?(localStorage.setItem("token",z.token),z.refresh_token&&localStorage.setItem("refresh_token",z.refresh_token),e(z.user)):i(z.error||"OTP verification failed")}else{const R=await fetch(`${ve}/index.php?endpoint=login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),D=await R.json();if(R.ok&&D.success){localStorage.setItem("token",D.token),D.refresh_token&&localStorage.setItem("refresh_token",D.refresh_token),await new Promise(L=>setTimeout(L,100));try{const L=await fetch(`${ve}/index.php?endpoint=profile`,{method:"GET",headers:{Authorization:`Bearer ${D.token}`}});if(L.ok){const z=await L.json();if(z.success){e(z.user);return}}e(D.user)}catch{e(D.user)}}else{const L=D&&(D.error||D.message)||"";/invalid password|wrong password/i.test(L)?i("Invalid credentials"):/not found|no account|does not exist|unregistered/i.test(L)?i("Account does not exist"):i("Invalid credentials")}}}catch{i("Network error")}finally{u(!1)}},_=async()=>{i(""),o("");const P=(r.username||"").trim(),A=/^[^@]+@gmail\.com$/i.test(P);if(!P||!P.includes("@")){i("Please enter a valid email address.");return}if(!A){i("Only Gmail addresses are allowed for OTP.");return}try{u(!0);const T=await fetch(`${ve}/index.php?endpoint=otp_request`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r.username,purpose:"login"})}),R=await T.json();T.ok&&R.success?(p(!0),o("Verification code sent. Please check your email.")):i(R.error||"Failed to send code")}catch{i("Network error")}finally{u(!1)}},E=async()=>{i(""),o("");const P=(r.username||"").trim();if(!P||!P.includes("@")){i("Please enter a valid email address.");return}if(!/^[^@]+@gmail\.com$/i.test(P)){i("Only Gmail accounts are allowed for password reset.");return}try{u(!0);const T=await fetch(`${ve}/index.php?endpoint=forgot_password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:P})}),R=await T.json();T.ok&&R.success?(b(!0),o("Password reset instructions sent to your Gmail.")):i(R.error||"Failed to send reset instructions")}catch{i("Network error")}finally{u(!1)}};return l("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:m("div",{className:"max-w-md w-full space-y-8",children:[m("div",{children:[l("div",{className:"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-green-100",children:l("svg",{className:"h-8 w-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),l("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sign in to your account"}),l("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Welcome back to SIMS"})]}),m("form",{className:"mt-8 space-y-6",onSubmit:k,children:[a&&l("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:a}),m("div",{className:"space-y-4",children:[m("div",{children:[l("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700",children:d||y?"Gmail Address":"Username or Email"}),l("input",{id:"username",name:"username",type:d?"email":"text",autoComplete:d?"email":"username",required:!0,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm",placeholder:d||y?"Enter your Gmail address":"Enter your username or email",value:r.username,onChange:S})]}),!d&&!y&&m("div",{children:[l("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),l(eu,{id:"password",name:"password",autoComplete:"current-password",required:!0,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm",placeholder:"Enter your password",value:r.password,onChange:S})]}),d&&m("div",{className:"space-y-3",children:[m("div",{className:"flex items-center gap-2",children:[l("button",{type:"button",onClick:_,disabled:c,className:`px-3 py-2 text-sm font-medium rounded-md text-white ${c?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"}`,children:h?"Resend Code":"Send Code"}),s&&l("span",{className:"text-xs text-gray-600",children:s})]}),h&&m("div",{children:[l("label",{htmlFor:"otpCode",className:"block text-sm font-medium text-gray-700",children:"Enter 6-digit Code"}),l("input",{id:"otpCode",name:"otpCode",type:"text",inputMode:"numeric",pattern:"[0-9]{6}",maxLength:6,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm",placeholder:"123456",value:x,onChange:P=>g(P.target.value.replace(/\D/g,"").slice(0,6))})]})]}),y&&l("div",{className:"space-y-3",children:m("div",{className:"text-center",children:[l("p",{className:"text-sm text-gray-600 mb-2",children:"Enter your Gmail address and we'll send you instructions to reset your password."}),l("p",{className:"text-xs text-gray-500 mb-4",children:"Only Gmail accounts are supported for password reset."}),l("button",{type:"button",onClick:E,disabled:c,className:`px-4 py-2 text-sm font-medium rounded-md text-white ${c?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"}`,children:c?"Sending...":"Send Reset Instructions"}),s&&l("div",{className:"mt-3 p-3 bg-green-50 border border-green-200 text-green-700 rounded-md text-sm",children:s})]})})]}),m("div",{className:"space-y-3",children:[!y&&l("button",{type:"submit",disabled:c||d&&!h,className:`group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white ${c?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500"}`,children:c?d?"Verifying...":"Signing in...":d?"Verify & Sign in":"Sign in"}),!y&&m("div",{className:"text-center space-y-2",children:[l("button",{type:"button",onClick:()=>{f(!d),i(""),o(""),p(!1),g("")},className:"text-sm text-green-600 hover:text-green-500",children:d?"Use password instead":"Use OTP instead"}),l("div",{children:l("button",{type:"button",onClick:()=>{v(!0),i(""),o(""),f(!1),p(!1),g("")},className:"text-sm text-gray-600 hover:text-gray-500",children:"Forgot your password?"})})]}),y&&l("div",{className:"text-center",children:l("button",{type:"button",onClick:()=>{v(!1),i(""),o(""),b(!1)},className:"text-sm text-green-600 hover:text-green-500",children:"Back to login"})})]}),l("div",{className:"text-center",children:m("p",{className:"text-sm text-gray-600",children:["Don't have an account?"," ",l("button",{type:"button",onClick:t,className:"font-medium text-green-600 hover:text-green-500",children:"Register here"})]})})]})]})})},Mfe=e=>/[\u{1F600}-\u{1F64F}\u{1F300}-\u{1F5FF}\u{1F680}-\u{1F6FF}\u{1F1E0}-\u{1F1FF}\u{2600}-\u{26FF}\u{2700}-\u{27BF}\u{1F900}-\u{1F9FF}]/gu.test(e),pC=(e,t)=>Mfe(e)?`${t} should not contain emojis`:"",gC=({onRegister:e,onSwitchToLogin:t})=>{const[r,n]=N.useState({firstName:"",lastName:"",username:"",email:"",password:"",confirmPassword:""}),[a,i]=N.useState(""),[s,o]=N.useState(!1),[c,u]=N.useState(!1),[d,f]=N.useState(!1),[h,p]=N.useState(""),[x,g]=N.useState(""),[y,v]=N.useState(0),[w,b]=N.useState(null),[S,k]=N.useState({min_length:6,max_length:8,require_uppercase:!0,require_lowercase:!0,require_numbers:!0,require_special:!0});ft.useEffect(()=>{(async()=>{try{const L=await(await fetch(`${ve}/index.php?endpoint=password_requirements`)).json();L.success&&L.requirements&&k(L.requirements)}catch(D){console.error("Failed to fetch password requirements:",D)}})()},[]);const _=R=>{const{name:D,value:L}=R.target,z=pC(L,D==="email"?"Email":D==="username"?"Username":"Name");if(z){i(z);return}n({...r,[D]:L}),i("")},E=async R=>{R.preventDefault();const D=[{name:"firstName",label:"First name"},{name:"lastName",label:"Last name"},{name:"username",label:"Username"},{name:"email",label:"Email"}];for(const Y of D){const q=pC(r[Y.name],Y.label);if(q){i(q);return}}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.email)){i("Invalid email format");return}const z=(r.password||"").length;if(!(z>=S.min_length&&(!S.max_length||z<=S.max_length)&&(!S.require_uppercase||/[A-Z]/.test(r.password))&&(!S.require_lowercase||/[a-z]/.test(r.password))&&(!S.require_numbers||/\d/.test(r.password))&&(!S.require_special||/[^A-Za-z0-9]/.test(r.password)))){i("Password must meet security requirements");return}if(r.password!==r.confirmPassword){i("Passwords do not match");return}if(!d||h.length!==6){i("Please send OTP and enter the 6-digit code.");return}o(!0),i("");try{const{confirmPassword:Y,...q}=r,ee={first_name:q.firstName,last_name:q.lastName,username:q.username,email:q.email,password:q.password,otp_code:h},V=await fetch(`${ve}/index.php?endpoint=register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ee)}),ae=await V.json();V.ok&&ae.success?(localStorage.setItem("token",ae.token),ae.refresh_token&&localStorage.setItem("refresh_token",ae.refresh_token),e()):i(ae.error||"Registration failed")}catch{i("Network error")}finally{o(!1)}},P=ft.useMemo(()=>{const R=r.password||"";let D=0;return R.length>=S.min_length&&D++,S.max_length&&R.length<=S.max_length&&D++,S.require_uppercase&&/[A-Z]/.test(R)&&D++,S.require_lowercase&&/[a-z]/.test(R)&&D++,S.require_numbers&&/\d/.test(R)&&D++,S.require_special&&/[^A-Za-z0-9]/.test(R)&&D++,{score:D,label:["Very weak","Weak","Fair","Good","Strong"][Math.min(D,4)]||"Very weak"}},[r.password,S]),A=async()=>{if(i(""),g(""),!r.email||!r.email.includes("@")){i("Enter a valid email first.");return}try{u(!0);const R=await fetch(`${ve}/index.php?endpoint=otp_request`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r.email,purpose:"register"})});let D;try{D=await R.clone().json()}catch{const z=await R.text();try{D=JSON.parse(z)}catch{D={success:R.ok&&/otp sent|verification code/i.test(z)}}}if(R.ok&&D&&D.success){f(!0),g("Verification code sent. Check your email.");const L=Number(D.cooldown_seconds||60),z=Number(D.ttl_minutes||5);v(L),b(Date.now()+z*60*1e3)}else i(D&&D.error||"Failed to send verification code")}catch{i("Network error")}finally{u(!1)}};ft.useEffect(()=>{if(!d||y<=0)return;const R=setInterval(()=>{v(D=>D>0?D-1:0)},1e3);return()=>clearInterval(R)},[d,y]);const T=ft.useMemo(()=>{if(!w)return"";const R=Math.max(0,Math.floor((w-Date.now())/1e3)),D=String(Math.floor(R/60)).padStart(1,"0"),L=String(R%60).padStart(2,"0");return R>0?`Code expires in ${D}:${L}`:"Code expired. Please resend."},[w,Date.now()]);return l("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:m("div",{className:"max-w-md w-full space-y-8",children:[m("div",{children:[l("div",{className:"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-green-100",children:l("svg",{className:"h-8 w-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})})}),l("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Create your account"}),l("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Join SIMS today"})]}),m("form",{className:"mt-8 space-y-6",onSubmit:E,children:[a&&l("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:a}),x&&l("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-md",children:x}),m("div",{className:"space-y-4",children:[m("div",{className:"flex gap-4",children:[m("div",{className:"w-1/2",children:[l("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700",children:"First Name"}),l("input",{id:"firstName",name:"firstName",type:"text",autoComplete:"given-name",required:!0,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm",placeholder:"Enter your first name",value:r.firstName,onChange:_})]}),m("div",{className:"w-1/2",children:[l("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700",children:"Last Name"}),l("input",{id:"lastName",name:"lastName",type:"text",autoComplete:"family-name",required:!0,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm",placeholder:"Enter your last name",value:r.lastName,onChange:_})]})]}),m("div",{children:[l("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700",children:"Username"}),l("input",{id:"username",name:"username",type:"text",autoComplete:"username",required:!0,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm",placeholder:"Choose a username",value:r.username,onChange:_})]}),m("div",{children:[l("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email Address"}),l("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm",placeholder:"Enter your email",value:r.email,onChange:_}),m("div",{className:"mt-2 flex items-center gap-2",children:[l("button",{type:"button",onClick:A,disabled:c||y>0,className:`px-3 py-2 text-sm font-medium rounded-md text-white ${c||y>0?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"}`,children:d?y>0?`Resend (${y}s)`:"Resend Code":"Send Code"}),d&&l("input",{id:"otpCode",name:"otpCode",type:"text",inputMode:"numeric",pattern:"[0-9]{6}",maxLength:6,className:"flex-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm",placeholder:"Enter 6-digit code",value:h,onChange:R=>p(R.target.value.replace(/\D/g,"").slice(0,6))}),d&&l("span",{className:"text-xs text-gray-600",children:T})]})]}),m("div",{children:[l("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),l(eu,{id:"password",name:"password",autoComplete:"new-password",required:!0,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm",placeholder:"Enter your password",value:r.password,onChange:_,showStrengthIndicator:!0,strengthScore:P.score,strengthLabel:P.label}),m("div",{className:"mt-2 text-xs text-gray-600",children:[l("p",{className:"mb-1",children:"Password requirements:"}),m("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[l("li",{children:"6-8 characters"}),l("li",{children:"Must contain number"}),l("li",{children:"Must contain 1 capital letter"}),l("li",{children:"Must contain special symbol"})]})]})]}),m("div",{children:[l("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),l(eu,{id:"confirmPassword",name:"confirmPassword",autoComplete:"new-password",required:!0,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm",placeholder:"Confirm your password",value:r.confirmPassword,onChange:_})]})]}),l("div",{children:l("button",{type:"submit",disabled:s,className:`group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white ${s?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500"}`,children:s?"Creating account...":"Create account"})}),l("div",{className:"text-center",children:m("p",{className:"text-sm text-gray-600",children:["Already have an account?"," ",l("button",{type:"button",onClick:t,className:"font-medium text-green-600 hover:text-green-500",children:"Sign in here"})]})})]})]})})},xC=({onSuccess:e})=>{const[t,r]=N.useState({password:"",confirmPassword:""}),[n,a]=N.useState(""),[i,s]=N.useState(""),[o,c]=N.useState(!1),[u,d]=N.useState("");N.useEffect(()=>{const x=new URLSearchParams(window.location.search).get("token");x?d(x):a("Invalid or missing reset token")},[]);const f=p=>{r({...t,[p.target.name]:p.target.value}),a(""),s("")},h=async p=>{if(p.preventDefault(),c(!0),a(""),s(""),!t.password||t.password.length<6){a("Password must be at least 6 characters long"),c(!1);return}if(t.password.length>8){a("Password must be no more than 8 characters long"),c(!1);return}if(!/[A-Z]/.test(t.password)){a("Password must contain at least one capital letter"),c(!1);return}if(!/\d/.test(t.password)){a("Password must contain at least one number"),c(!1);return}if(!/[^A-Za-z0-9]/.test(t.password)){a("Password must contain at least one special symbol"),c(!1);return}if(t.password!==t.confirmPassword){a("Passwords do not match"),c(!1);return}if(!u){a("Invalid reset token"),c(!1);return}try{const x=await fetch(`${ve}/index.php?endpoint=reset_password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:u,password:t.password})}),g=await x.json();x.ok&&g.success?(s("Password reset successfully! You can now log in with your new password."),setTimeout(()=>{e&&e()},2e3)):a(g.error||"Failed to reset password")}catch{a("Network error")}finally{c(!1)}};return u?l("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:m("div",{className:"max-w-md w-full space-y-8",children:[m("div",{children:[l("div",{className:"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-green-100",children:l("svg",{className:"h-8 w-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})})}),l("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Reset Your Password"}),l("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Enter your new password below"})]}),m("form",{className:"mt-8 space-y-6",onSubmit:h,children:[n&&l("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:n}),i&&l("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-md",children:i}),m("div",{className:"space-y-4",children:[m("div",{children:[l("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"New Password"}),l(eu,{id:"password",name:"password",autoComplete:"new-password",required:!0,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm",placeholder:"Enter your new password",value:t.password,onChange:f}),m("div",{className:"mt-2 text-xs text-gray-600",children:[l("p",{className:"mb-1",children:"Password requirements:"}),m("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[l("li",{children:"6-8 characters"}),l("li",{children:"Must contain number"}),l("li",{children:"Must contain 1 capital letter"}),l("li",{children:"Must contain special symbol"})]})]})]}),m("div",{children:[l("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm New Password"}),l(eu,{id:"confirmPassword",name:"confirmPassword",autoComplete:"new-password",required:!0,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm",placeholder:"Confirm your new password",value:t.confirmPassword,onChange:f})]})]}),l("div",{children:l("button",{type:"submit",disabled:o,className:`group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white ${o?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500"}`,children:o?"Resetting...":"Reset Password"})})]})]})}):l("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:l("div",{className:"max-w-md w-full space-y-8",children:m("div",{className:"text-center",children:[l("div",{className:"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-red-100",children:l("svg",{className:"h-8 w-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),l("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Invalid Reset Link"}),l("p",{className:"mt-2 text-center text-sm text-gray-600",children:"This password reset link is invalid or has expired."})]})})})},Ife=({user:e,setCurrentPage:t})=>{const[r,n]=N.useState(!1),[a,i]=N.useState(0),[s,o]=N.useState(()=>{try{return localStorage.getItem("builditpc_chat_session_id")||null}catch(u){return console.error("Error accessing localStorage:",u),null}});N.useEffect(()=>{if(!s||!e)return;const u=async()=>{try{const h=await(await fetch(`${ve}/chat.php?unread_count&user_id=${e.id}`)).json();h.success&&i(h.unread_count)}catch(f){console.error("Error checking unread count:",f)}};u();const d=setInterval(u,1e4);return()=>clearInterval(d)},[s,e]);const c=()=>{n(!r)};return m(lt,{children:[l("div",{className:"fixed bottom-6 right-6 z-50",children:m("button",{onClick:c,className:"bg-green-600 hover:bg-green-700 text-white rounded-full p-4 shadow-lg transition-all duration-300 hover:scale-110 flex items-center justify-center relative",title:"Chat Support",children:[l(Ca,{className:"w-6 h-6"}),a>0&&l("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-6 h-6 flex items-center justify-center font-bold",children:a>9?"9+":a})]})}),r&&m("div",{className:"fixed bottom-6 right-6 z-50 w-96 h-[500px] bg-white rounded-lg shadow-2xl border border-gray-200 flex flex-col overflow-hidden",children:[m("div",{className:"bg-gradient-to-r from-green-600 to-green-700 text-white px-4 py-3 rounded-t-lg flex items-center justify-between flex-shrink-0",children:[m("div",{className:"flex items-center gap-2",children:[l(Ca,{className:"w-5 h-5"}),l("span",{className:"font-semibold",children:"Chat Support"})]}),l("div",{className:"flex items-center",children:l("button",{onClick:c,className:"text-white hover:text-gray-200 transition-colors p-1",title:"Close",children:l(Gn,{className:"w-4 h-4"})})})]}),l("div",{className:"flex-1 overflow-hidden min-h-0",children:l(pd,{user:e,customStyles:{messagesArea:"p-4",inputArea:"bg-gray-50"},hideHeader:!0})})]})]})};const Ffe=["my-builds","my-orders","notifications"];function Lfe(e){try{const t=e.split(".")[1];if(!t)return!0;let r=t.replace(/-/g,"+").replace(/_/g,"/");for(;r.length%4;)r+="=";const n=JSON.parse(atob(r));return n.exp?Date.now()>=n.exp*1e3:!1}catch{return!0}}const vC=localStorage.getItem("token");vC&&Lfe(vC)&&localStorage.removeItem("token");const Bfe=()=>{var V,ae,oe,I,W,U,G,ne,K,le,Q,ce,be,j,$e,Ee,Ae,Be,we,de,Ge,et,Qe;const e=()=>{const te=localStorage.getItem("token");if(te)try{const De=te.split(".")[1];if(!De)throw new Error("invalid jwt");let ze=De.replace(/-/g,"+").replace(/_/g,"/");for(;ze.length%4;)ze+="=";const Ke=JSON.parse(atob(ze)).roles||[];if(typeof Ke=="string"&&Ke.includes("Super Admin")||Array.isArray(Ke)&&Ke.includes("Super Admin"))return"super-admin-dashboard";if(typeof Ke=="string"&&Ke.includes("Admin")||Array.isArray(Ke)&&Ke.includes("Admin"))return"admin-dashboard";if(typeof Ke=="string"&&Ke.includes("Employee")||Array.isArray(Ke)&&Ke.includes("Employee"))return"employee-dashboard"}catch{}return"home"},[t,r]=N.useState(e()),[n,a]=N.useState({}),[i,s]=N.useState(null),[o,c]=N.useState(null),[u,d]=N.useState(null),[f,h]=N.useState(!0),[p,x]=N.useState("dashboard"),[g,y]=N.useState(()=>{try{return localStorage.getItem("builditpc_sidebar_collapsed")==="1"}catch{return!1}}),[v,w]=N.useState(!1);N.useEffect(()=>{try{localStorage.setItem("builditpc_sidebar_collapsed",g?"1":"0")}catch{}},[g]),N.useEffect(()=>{const te=()=>{const De=window.innerWidth||document.documentElement.clientWidth||0;w(De<1024)};return te(),window.addEventListener("resize",te),()=>window.removeEventListener("resize",te)},[]);const b=g||v,S=N.useCallback(te=>{a(te)},[]);N.useEffect(()=>{(async()=>{try{if(new URLSearchParams(window.location.search).get("token")){d("reset-password"),r("reset-password"),h(!1);return}if(!localStorage.getItem("token")){c(null),h(!1);return}if(!await nr(!1)){localStorage.removeItem("token"),h(!1);return}const mt=await qe(`${ve}/index.php?endpoint=verify`,{method:"GET"});if(mt.ok){const ht=await mt.json().catch(()=>({}));if(ht&&ht.success){const Re=await qe(`${ve}/index.php?endpoint=profile`,{method:"GET"});if(Re.ok){const tt=await Re.json().catch(()=>({}));tt&&tt.success?c(tt.user):(c(null),localStorage.removeItem("token"))}else Re.status===401&&(c(null),localStorage.removeItem("token"))}else c(null),localStorage.removeItem("token")}else mt.status===401&&(c(null),localStorage.removeItem("token"))}catch{c(null),localStorage.removeItem("token")}finally{h(!1)}})()},[]),N.useEffect(()=>{const te=()=>{c(null);try{localStorage.removeItem("token"),localStorage.removeItem("refresh_token")}catch{}d("login")};return window.addEventListener("auth:unauthorized",te),()=>window.removeEventListener("auth:unauthorized",te)},[]);const k=te=>{!o&&Ffe.includes(te)?(r(te),d("login")):te==="login"||te==="register"||te==="reset-password"?(r(te),d(te)):te==="admin-dashboard"&&T.includes("Admin")?(r("admin-dashboard"),d(null)):te==="employee-dashboard"&&T.includes("Employee")?(r("employee-dashboard"),d(null)):(r(te),d(null))},_=()=>{c(null),localStorage.removeItem("token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),localStorage.removeItem("builditpc_chat_session_id"),localStorage.removeItem("builditpc_guest_name"),localStorage.removeItem("builditpc_guest_email"),r("home"),d(null),window.location.reload()},E=te=>{s(te),r("pc-assembly")},P=()=>{i&&s(null)},A=te=>{r("super-admin-dashboard"),x(te)};if(f)return l("div",{className:"flex min-h-screen items-center justify-center bg-gray-50",children:m("div",{className:"text-center",children:[l("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),l("p",{className:"text-gray-600",children:"Loading..."})]})});const T=Array.isArray(o==null?void 0:o.roles)?o.roles:typeof(o==null?void 0:o.roles)=="string"?o.roles.split(",").map(te=>te.trim()).filter(te=>te.length>0):[],R=T.includes("Super Admin"),D=T.includes("Admin"),L=T.includes("Employee"),z=R||D||L,X=te=>te.some(De=>T.includes(De)),Y=new Set(["super-admin-dashboard","admin-dashboard","prebuilt-management","sales-reports","system-reports","notifications","inventory","orders-management","pc-assembly","admin-chat-support"]),q=new Set(["employee-dashboard","inventory","orders-management","prebuilt-management","sales-reports","system-reports","notifications","admin-chat-support","pc-assembly"]),ee=(R||D)&&Y.has(t)||L&&q.has(t);return m(lt,{children:[l(z8,{user:o,children:m("div",{className:"min-h-screen bg-gray-50",children:[!ee&&l(V8,{currentPage:t,onPageChange:k,user:o,onLogout:_,onSuperAdminTabChange:A,activeSuperAdminTab:t==="super-admin-dashboard"?p:void 0}),z&&ee?m("div",{className:`grid ${b?"grid-cols-[88px_1fr] md:grid-cols-[88px_1fr] xl:grid-cols-[104px_1fr]":"grid-cols-[288px_1fr] md:grid-cols-[288px_1fr] xl:grid-cols-[320px_1fr]"} h-screen w-full`,children:[T.includes("Super Admin")&&m(lt,{children:[console.log(" APP.JSX - Using SuperAdminSidebar for Super Admin user!"),l(W8,{currentPage:t,onPageChange:k,user:o,onLogout:_,onSuperAdminTabChange:A,activeSuperAdminTab:t==="super-admin-dashboard"?p:void 0,isCollapsed:b,onToggleCollapse:()=>y(te=>!te)})]}),T.includes("Admin")&&!T.includes("Super Admin")&&l(H8,{currentPage:t,onPageChange:k,user:o,onLogout:_,onSuperAdminTabChange:A,activeSuperAdminTab:t==="super-admin-dashboard"?p:void 0,isCollapsed:b,onToggleCollapse:()=>y(te=>!te)}),T.includes("Employee")&&!T.includes("Admin")&&!T.includes("Super Admin")&&l(G8,{currentPage:t,onPageChange:te=>{(te==="employee-dashboard"||["inventory","orders-management","notifications","sales-reports","system-reports","pc-assembly","prebuilt-management","admin-chat-support"].includes(te))&&k(te)},user:o,onLogout:_,isCollapsed:b,onToggleCollapse:()=>y(te=>!te)}),m("main",{className:"bg-gray-50 h-full relative overflow-y-auto",children:[u==="login"&&l(hC,{onLogin:async te=>{if(localStorage.removeItem("builditpc_chat_session_id"),localStorage.removeItem("builditpc_guest_name"),c(te),await new Promise(ze=>setTimeout(ze,200)),te&&te.id)try{const ze=localStorage.getItem("token"),ct=ze?{Authorization:`Bearer ${ze}`}:{},mt=await(await fetch(`${ve}/chat.php?user_sessions&user_id=${te.id}`,{headers:ct})).json();if(mt.success&&mt.sessions&&Array.isArray(mt.sessions)&&mt.sessions.length>0){const ht=mt.sessions[0];ht&&ht.id&&localStorage.setItem("builditpc_chat_session_id",ht.id)}}catch{}d(null);const De=Array.isArray(te==null?void 0:te.roles)?te.roles:typeof(te==null?void 0:te.roles)=="string"?te.roles.split(",").map(ze=>ze.trim()).filter(ze=>ze.length>0):[];De.includes("Super Admin")?r("super-admin-dashboard"):De.includes("Admin")?r("admin-dashboard"):De.includes("Employee")?r("employee-dashboard"):r("home")},onSwitchToRegister:()=>{d("register"),r("register")}}),u==="register"&&l(gC,{onRegister:()=>{d("login"),r("login")},onSwitchToLogin:()=>{d("login"),r("login")}}),u==="reset-password"&&l(xC,{onSuccess:()=>{d("login"),r("login")}}),!u&&m(lt,{children:[t==="super-admin-dashboard"&&T.includes("Super Admin")&&l(K0,{initialTab:p,user:o,setUser:c}),t==="admin-dashboard"&&T.includes("Admin")&&l(Lo,{user:o}),t==="sales-reports"&&T.includes("Admin")&&l(Lo,{initialTab:"sales-reports",user:o}),t==="system-reports"&&T.includes("Admin")&&l(Lo,{initialTab:"system-reports",user:o}),t==="notifications"&&T.includes("Admin")&&l(Lo,{initialTab:"notifications",user:o}),t==="inventory"&&((V=o==null?void 0:o.roles)==null?void 0:V.includes("Admin"))&&l(Lo,{initialTab:"inventory",user:o}),t==="orders-management"&&((ae=o==null?void 0:o.roles)==null?void 0:ae.includes("Admin"))&&l(Lo,{initialTab:"orders",user:o}),t==="prebuilt-management"&&((oe=o==null?void 0:o.roles)==null?void 0:oe.includes("Admin"))&&l(Lo,{initialTab:"prebuilt-management",user:o}),t==="employee-dashboard"&&((I=o==null?void 0:o.roles)==null?void 0:I.includes("Employee"))&&l(X0,{user:o,setUser:c,initialTab:"employee-dashboard"}),t==="home"&&l(US,{setCurrentPage:r,setSelectedComponents:S}),t==="prebuilt-pcs"&&l(lk,{user:o,setCurrentPage:r,setSelectedComponents:S,onPrebuiltSelect:E}),t==="pc-assembly"&&((W=o==null?void 0:o.roles)==null?void 0:W.includes("Super Admin"))&&l(K0,{initialTab:"pc-assembly",user:o,setUser:c}),t==="pc-assembly"&&((U=o==null?void 0:o.roles)==null?void 0:U.includes("Admin"))&&l(i3,{setCurrentPage:r,setSelectedComponents:S,selectedComponents:i||n,onLoaded:P,user:o,setUser:c,onShowAuth:te=>{d(te),r(te)}}),t==="pc-assembly"&&((G=o==null?void 0:o.roles)==null?void 0:G.includes("Employee"))&&l(UB,{setCurrentPage:r,setSelectedComponents:S,selectedComponents:i||n,onLoaded:P,user:o,setUser:c,onShowAuth:te=>{d(te),r(te)}}),t==="pc-assembly"&&(!(o!=null&&o.roles)||!X(["Super Admin","Admin","Employee"]))&&l($c,{setCurrentPage:r,setSelectedComponents:S,selectedComponents:i||n,onLoaded:P,user:o,setUser:c,onShowAuth:te=>{d(te),r(te)}}),t==="chat-support"&&(((ne=o==null?void 0:o.roles)==null?void 0:ne.includes("Admin"))||((K=o==null?void 0:o.roles)==null?void 0:K.includes("Employee")))&&l(pd,{user:o,fullScreen:!0}),t==="scroll-test"&&l(lC,{}),t==="about"&&l(cC,{setCurrentPage:r}),t==="contact"&&l(uC,{setCurrentPage:r}),t==="faq"&&l(dC,{setCurrentPage:r}),t==="compatibility-guide"&&l(fC,{setCurrentPage:r}),t==="troubleshooting"&&l(mC,{setCurrentPage:r}),t==="my-builds"&&o&&l(sk,{setCurrentPage:r,setSelectedComponents:S,user:o}),t==="my-builds"&&!o&&l("div",{className:"flex items-center justify-center h-64",children:m("div",{className:"text-center",children:[l("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Sign in required"}),l("p",{className:"text-gray-600 mb-4",children:"Log in to view and manage your builds."}),m("div",{className:"flex items-center gap-2 justify-center",children:[l("button",{onClick:()=>{d("login"),r("login")},className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md",children:"Login"}),l("button",{onClick:()=>{d("register"),r("register")},className:"bg-gray-100 hover:bg-gray-200 text-gray-800 px-4 py-2 rounded-md",children:"Register"})]})]})}),t==="my-orders"&&o&&l(ok,{setCurrentPage:r}),t==="notifications"&&o&&!((le=o==null?void 0:o.roles)!=null&&le.includes("Admin"))&&!((Q=o==null?void 0:o.roles)!=null&&Q.includes("Employee"))&&l(Vm,{user:o}),t==="admin-chat-support"&&(((ce=o==null?void 0:o.roles)==null?void 0:ce.includes("Admin"))||((be=o==null?void 0:o.roles)==null?void 0:be.includes("Employee")))&&l(pd,{user:o,fullScreen:!0}),["inventory","orders-management","reports"].includes(t)&&((j=o==null?void 0:o.roles)==null?void 0:j.includes("Super Admin"))&&l(K0,{initialTab:t,user:o,setUser:c}),["inventory","orders-management","prebuilt-management","sales-reports","system-reports","notifications"].includes(t)&&(($e=o==null?void 0:o.roles)==null?void 0:$e.includes("Employee"))&&(()=>t==="inventory"&&((o==null?void 0:o.can_access_inventory)===0||(o==null?void 0:o.can_access_inventory)==="0"||(o==null?void 0:o.can_access_inventory)===!1||(o==null?void 0:o.can_access_inventory)==="false")?l(X0,{initialTab:"employee-dashboard",user:o,setUser:c}):t==="orders-management"&&((o==null?void 0:o.can_access_orders)===0||(o==null?void 0:o.can_access_orders)==="0"||(o==null?void 0:o.can_access_orders)===!1||(o==null?void 0:o.can_access_orders)==="false")?l(X0,{initialTab:"employee-dashboard",user:o,setUser:c}):l(X0,{initialTab:t,user:o,setUser:c}))(),["user-management","system-settings","system-reports","prebuilt-management"].includes(t)&&((Ee=o==null?void 0:o.roles)==null?void 0:Ee.includes("Super Admin"))&&l(K0,{initialTab:t,user:o,setUser:c})]})]})]}):m("main",{className:"bg-gray-50",children:[u==="login"&&l(hC,{onLogin:async te=>{var De,ze,ct;if(localStorage.removeItem("builditpc_chat_session_id"),localStorage.removeItem("builditpc_guest_name"),c(te),te&&te.id)try{const Ke=localStorage.getItem("token"),mt=Ke?{Authorization:`Bearer ${Ke}`}:{},Re=await(await fetch(`${ve}/chat.php?user_sessions&user_id=${te.id}`,{headers:mt})).json();if(Re.success&&Re.sessions&&Re.sessions.length>0){const tt=Re.sessions[0];tt&&tt.id&&localStorage.setItem("builditpc_chat_session_id",tt.id)}}catch{}d(null),(De=te==null?void 0:te.roles)!=null&&De.includes("Super Admin")?r("super-admin-dashboard"):(ze=te==null?void 0:te.roles)!=null&&ze.includes("Admin")?r("admin-dashboard"):(ct=te==null?void 0:te.roles)!=null&&ct.includes("Employee")?r("employee-dashboard"):r("home")},onSwitchToRegister:()=>{d("register"),r("register")}}),u==="register"&&l(gC,{onRegister:()=>{d("login"),r("login")},onSwitchToLogin:()=>{d("login"),r("login")}}),u==="reset-password"&&l(xC,{onSuccess:()=>{d("login"),r("login")}}),!u&&m(lt,{children:[t==="home"&&l(US,{setCurrentPage:r,setSelectedComponents:S}),t==="prebuilt-pcs"&&l(lk,{user:o,setCurrentPage:r,setSelectedComponents:S,onPrebuiltSelect:E}),t==="pc-assembly"&&(!(o!=null&&o.roles)||!X(["Super Admin","Admin"]))&&l($c,{setCurrentPage:r,setSelectedComponents:S,selectedComponents:i||n,onLoaded:P,user:o,setUser:c,onShowAuth:te=>{d(te),r(te)}}),t==="chat-support"&&(((Ae=o==null?void 0:o.roles)==null?void 0:Ae.includes("Admin"))||((Be=o==null?void 0:o.roles)==null?void 0:Be.includes("Employee")))&&l(pd,{user:o,fullScreen:!0}),t==="scroll-test"&&l(lC,{}),t==="about"&&l(cC,{setCurrentPage:r}),t==="contact"&&l(uC,{setCurrentPage:r}),t==="faq"&&l(dC,{setCurrentPage:r}),t==="compatibility-guide"&&l(fC,{setCurrentPage:r}),t==="troubleshooting"&&l(mC,{setCurrentPage:r}),t==="my-builds"&&o&&l(sk,{setCurrentPage:r,setSelectedComponents:S,user:o}),t==="my-builds"&&!o&&l("div",{className:"flex items-center justify-center h-64",children:m("div",{className:"text-center",children:[l("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Sign in required"}),l("p",{className:"text-gray-600 mb-4",children:"Log in to view and manage your builds."}),m("div",{className:"flex items-center gap-2 justify-center",children:[l("button",{onClick:()=>{d("login"),r("login")},className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md",children:"Login"}),l("button",{onClick:()=>{d("register"),r("register")},className:"bg-gray-100 hover:bg-gray-200 text-gray-800 px-4 py-2 rounded-md",children:"Register"})]})]})}),t==="my-orders"&&o&&l(ok,{setCurrentPage:r}),t==="notifications"&&o&&!((we=o==null?void 0:o.roles)!=null&&we.includes("Admin"))&&!((de=o==null?void 0:o.roles)!=null&&de.includes("Employee"))&&l(Vm,{user:o})]})]})]})}),(!o||!((Ge=o==null?void 0:o.roles)!=null&&Ge.includes("Super Admin"))&&!((et=o==null?void 0:o.roles)!=null&&et.includes("Admin"))&&!((Qe=o==null?void 0:o.roles)!=null&&Qe.includes("Employee")))&&l(Ife,{user:o,setCurrentPage:r})]})};function jfe(){return l(Bfe,{})}Yx.createRoot(document.getElementById("root")).render(l(ft.StrictMode,{children:l(jfe,{})}));
