var nF=Object.defineProperty;var aF=(e,t,r)=>t in e?nF(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Lg=(e,t,r)=>(aF(e,typeof t!="symbol"?t+"":t,r),r);function iF(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}function $s(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var T4={exports:{}},rp={},P4={exports:{}},_t={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sf=Symbol.for("react.element"),sF=Symbol.for("react.portal"),oF=Symbol.for("react.fragment"),lF=Symbol.for("react.strict_mode"),cF=Symbol.for("react.profiler"),uF=Symbol.for("react.provider"),dF=Symbol.for("react.context"),fF=Symbol.for("react.forward_ref"),hF=Symbol.for("react.suspense"),mF=Symbol.for("react.memo"),pF=Symbol.for("react.lazy"),AN=Symbol.iterator;function gF(e){return e===null||typeof e!="object"?null:(e=AN&&e[AN]||e["@@iterator"],typeof e=="function"?e:null)}var O4={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},D4=Object.assign,I4={};function pu(e,t,r){this.props=e,this.context=t,this.refs=I4,this.updater=r||O4}pu.prototype.isReactComponent={};pu.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};pu.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function R4(){}R4.prototype=pu.prototype;function u1(e,t,r){this.props=e,this.context=t,this.refs=I4,this.updater=r||O4}var d1=u1.prototype=new R4;d1.constructor=u1;D4(d1,pu.prototype);d1.isPureReactComponent=!0;var TN=Array.isArray,F4=Object.prototype.hasOwnProperty,f1={current:null},M4={key:!0,ref:!0,__self:!0,__source:!0};function L4(e,t,r){var n,a={},i=null,s=null;if(t!=null)for(n in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(i=""+t.key),t)F4.call(t,n)&&!M4.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:Sf,type:e,key:i,ref:s,props:a,_owner:f1.current}}function xF(e,t){return{$$typeof:Sf,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function h1(e){return typeof e=="object"&&e!==null&&e.$$typeof===Sf}function yF(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var PN=/\/+/g;function Bg(e,t){return typeof e=="object"&&e!==null&&e.key!=null?yF(""+e.key):t.toString(36)}function sh(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(i){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case Sf:case sF:s=!0}}if(s)return s=e,a=a(s),e=n===""?"."+Bg(s,0):n,TN(a)?(r="",e!=null&&(r=e.replace(PN,"$&/")+"/"),sh(a,t,r,"",function(u){return u})):a!=null&&(h1(a)&&(a=xF(a,r+(!a.key||s&&s.key===a.key?"":(""+a.key).replace(PN,"$&/")+"/")+e)),t.push(a)),1;if(s=0,n=n===""?".":n+":",TN(e))for(var o=0;o<e.length;o++){i=e[o];var c=n+Bg(i,o);s+=sh(i,t,r,c,a)}else if(c=gF(e),typeof c=="function")for(e=c.call(e),o=0;!(i=e.next()).done;)i=i.value,c=n+Bg(i,o++),s+=sh(i,t,r,c,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function h0(e,t,r){if(e==null)return e;var n=[],a=0;return sh(e,n,"","",function(i){return t.call(r,i,a++)}),n}function vF(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ra={current:null},oh={transition:null},bF={ReactCurrentDispatcher:ra,ReactCurrentBatchConfig:oh,ReactCurrentOwner:f1};function B4(){throw Error("act(...) is not supported in production builds of React.")}_t.Children={map:h0,forEach:function(e,t,r){h0(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return h0(e,function(){t++}),t},toArray:function(e){return h0(e,function(t){return t})||[]},only:function(e){if(!h1(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};_t.Component=pu;_t.Fragment=oF;_t.Profiler=cF;_t.PureComponent=u1;_t.StrictMode=lF;_t.Suspense=hF;_t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bF;_t.act=B4;_t.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=D4({},e.props),a=e.key,i=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,s=f1.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)F4.call(t,c)&&!M4.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:Sf,type:e.type,key:a,ref:i,props:n,_owner:s}};_t.createContext=function(e){return e={$$typeof:dF,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:uF,_context:e},e.Consumer=e};_t.createElement=L4;_t.createFactory=function(e){var t=L4.bind(null,e);return t.type=e,t};_t.createRef=function(){return{current:null}};_t.forwardRef=function(e){return{$$typeof:fF,render:e}};_t.isValidElement=h1;_t.lazy=function(e){return{$$typeof:pF,_payload:{_status:-1,_result:e},_init:vF}};_t.memo=function(e,t){return{$$typeof:mF,type:e,compare:t===void 0?null:t}};_t.startTransition=function(e){var t=oh.transition;oh.transition={};try{e()}finally{oh.transition=t}};_t.unstable_act=B4;_t.useCallback=function(e,t){return ra.current.useCallback(e,t)};_t.useContext=function(e){return ra.current.useContext(e)};_t.useDebugValue=function(){};_t.useDeferredValue=function(e){return ra.current.useDeferredValue(e)};_t.useEffect=function(e,t){return ra.current.useEffect(e,t)};_t.useId=function(){return ra.current.useId()};_t.useImperativeHandle=function(e,t,r){return ra.current.useImperativeHandle(e,t,r)};_t.useInsertionEffect=function(e,t){return ra.current.useInsertionEffect(e,t)};_t.useLayoutEffect=function(e,t){return ra.current.useLayoutEffect(e,t)};_t.useMemo=function(e,t){return ra.current.useMemo(e,t)};_t.useReducer=function(e,t,r){return ra.current.useReducer(e,t,r)};_t.useRef=function(e){return ra.current.useRef(e)};_t.useState=function(e){return ra.current.useState(e)};_t.useSyncExternalStore=function(e,t,r){return ra.current.useSyncExternalStore(e,t,r)};_t.useTransition=function(){return ra.current.useTransition()};_t.version="18.3.1";P4.exports=_t;var N=P4.exports;const ft=$s(N),wF=iF({__proto__:null,default:ft},[N]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NF=N,kF=Symbol.for("react.element"),SF=Symbol.for("react.fragment"),_F=Object.prototype.hasOwnProperty,CF=NF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,EF={key:!0,ref:!0,__self:!0,__source:!0};function j4(e,t,r){var n,a={},i=null,s=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)_F.call(t,n)&&!EF.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:kF,type:e,key:i,ref:s,props:a,_owner:CF.current}}rp.Fragment=SF;rp.jsx=j4;rp.jsxs=j4;T4.exports=rp;var m1=T4.exports;const gt=m1.Fragment,l=m1.jsx,h=m1.jsxs;var ry={},$4={exports:{}},ja={},U4={exports:{}},z4={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ie,B){var ee=ie.length;ie.push(B);e:for(;0<ee;){var le=ee-1>>>1,R=ie[le];if(0<a(R,B))ie[le]=B,ie[ee]=R,ee=le;else break e}}function r(ie){return ie.length===0?null:ie[0]}function n(ie){if(ie.length===0)return null;var B=ie[0],ee=ie.pop();if(ee!==B){ie[0]=ee;e:for(var le=0,R=ie.length,j=R>>>1;le<j;){var V=2*(le+1)-1,P=ie[V],q=V+1,O=ie[q];if(0>a(P,ee))q<R&&0>a(O,P)?(ie[le]=O,ie[q]=ee,le=q):(ie[le]=P,ie[V]=ee,le=V);else if(q<R&&0>a(O,ee))ie[le]=O,ie[q]=ee,le=q;else break e}}return B}function a(ie,B){var ee=ie.sortIndex-B.sortIndex;return ee!==0?ee:ie.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var c=[],u=[],d=1,f=null,m=3,p=!1,x=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(ie){for(var B=r(u);B!==null;){if(B.callback===null)n(u);else if(B.startTime<=ie)n(u),B.sortIndex=B.expirationTime,t(c,B);else break;B=r(u)}}function k(ie){if(g=!1,w(ie),!x)if(r(c)!==null)x=!0,L(S);else{var B=r(u);B!==null&&W(k,B.startTime-ie)}}function S(ie,B){x=!1,g&&(g=!1,v(E),E=-1),p=!0;var ee=m;try{for(w(B),f=r(c);f!==null&&(!(f.expirationTime>B)||ie&&!D());){var le=f.callback;if(typeof le=="function"){f.callback=null,m=f.priorityLevel;var R=le(f.expirationTime<=B);B=e.unstable_now(),typeof R=="function"?f.callback=R:f===r(c)&&n(c),w(B)}else n(c);f=r(c)}if(f!==null)var j=!0;else{var V=r(u);V!==null&&W(k,V.startTime-B),j=!1}return j}finally{f=null,m=ee,p=!1}}var _=!1,C=null,E=-1,A=5,T=-1;function D(){return!(e.unstable_now()-T<A)}function I(){if(C!==null){var ie=e.unstable_now();T=ie;var B=!0;try{B=C(!0,ie)}finally{B?z():(_=!1,C=null)}}else _=!1}var z;if(typeof b=="function")z=function(){b(I)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,H=X.port2;X.port1.onmessage=I,z=function(){H.postMessage(null)}}else z=function(){y(I,0)};function L(ie){C=ie,_||(_=!0,z())}function W(ie,B){E=y(function(){ie(e.unstable_now())},B)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ie){ie.callback=null},e.unstable_continueExecution=function(){x||p||(x=!0,L(S))},e.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<ie?Math.floor(1e3/ie):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(ie){switch(m){case 1:case 2:case 3:var B=3;break;default:B=m}var ee=m;m=B;try{return ie()}finally{m=ee}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ie,B){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var ee=m;m=ie;try{return B()}finally{m=ee}},e.unstable_scheduleCallback=function(ie,B,ee){var le=e.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?le+ee:le):ee=le,ie){case 1:var R=-1;break;case 2:R=250;break;case 5:R=1073741823;break;case 4:R=1e4;break;default:R=5e3}return R=ee+R,ie={id:d++,callback:B,priorityLevel:ie,startTime:ee,expirationTime:R,sortIndex:-1},ee>le?(ie.sortIndex=ee,t(u,ie),r(c)===null&&ie===r(u)&&(g?(v(E),E=-1):g=!0,W(k,ee-le))):(ie.sortIndex=R,t(c,ie),x||p||(x=!0,L(S))),ie},e.unstable_shouldYield=D,e.unstable_wrapCallback=function(ie){var B=m;return function(){var ee=m;m=B;try{return ie.apply(this,arguments)}finally{m=ee}}}})(z4);U4.exports=z4;var AF=U4.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TF=N,Ia=AF;function Be(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var H4=new Set,Id={};function Gl(e,t){Gc(e,t),Gc(e+"Capture",t)}function Gc(e,t){for(Id[e]=t,e=0;e<t.length;e++)H4.add(t[e])}var Ts=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ny=Object.prototype.hasOwnProperty,PF=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ON={},DN={};function OF(e){return ny.call(DN,e)?!0:ny.call(ON,e)?!1:PF.test(e)?DN[e]=!0:(ON[e]=!0,!1)}function DF(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function IF(e,t,r,n){if(t===null||typeof t>"u"||DF(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function na(e,t,r,n,a,i,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var bn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){bn[e]=new na(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];bn[t]=new na(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){bn[e]=new na(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){bn[e]=new na(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){bn[e]=new na(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){bn[e]=new na(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){bn[e]=new na(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){bn[e]=new na(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){bn[e]=new na(e,5,!1,e.toLowerCase(),null,!1,!1)});var p1=/[\-:]([a-z])/g;function g1(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(p1,g1);bn[t]=new na(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(p1,g1);bn[t]=new na(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(p1,g1);bn[t]=new na(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){bn[e]=new na(e,1,!1,e.toLowerCase(),null,!1,!1)});bn.xlinkHref=new na("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){bn[e]=new na(e,1,!1,e.toLowerCase(),null,!0,!0)});function x1(e,t,r,n){var a=bn.hasOwnProperty(t)?bn[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(IF(t,r,a,n)&&(r=null),n||a===null?OF(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Us=TF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,m0=Symbol.for("react.element"),gc=Symbol.for("react.portal"),xc=Symbol.for("react.fragment"),y1=Symbol.for("react.strict_mode"),ay=Symbol.for("react.profiler"),W4=Symbol.for("react.provider"),G4=Symbol.for("react.context"),v1=Symbol.for("react.forward_ref"),iy=Symbol.for("react.suspense"),sy=Symbol.for("react.suspense_list"),b1=Symbol.for("react.memo"),Zs=Symbol.for("react.lazy"),V4=Symbol.for("react.offscreen"),IN=Symbol.iterator;function Lu(e){return e===null||typeof e!="object"?null:(e=IN&&e[IN]||e["@@iterator"],typeof e=="function"?e:null)}var br=Object.assign,jg;function id(e){if(jg===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);jg=t&&t[1]||""}return`
`+jg+e}var $g=!1;function Ug(e,t){if(!e||$g)return"";$g=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),i=n.stack.split(`
`),s=a.length-1,o=i.length-1;1<=s&&0<=o&&a[s]!==i[o];)o--;for(;1<=s&&0<=o;s--,o--)if(a[s]!==i[o]){if(s!==1||o!==1)do if(s--,o--,0>o||a[s]!==i[o]){var c=`
`+a[s].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=s&&0<=o);break}}}finally{$g=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?id(e):""}function RF(e){switch(e.tag){case 5:return id(e.type);case 16:return id("Lazy");case 13:return id("Suspense");case 19:return id("SuspenseList");case 0:case 2:case 15:return e=Ug(e.type,!1),e;case 11:return e=Ug(e.type.render,!1),e;case 1:return e=Ug(e.type,!0),e;default:return""}}function oy(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case xc:return"Fragment";case gc:return"Portal";case ay:return"Profiler";case y1:return"StrictMode";case iy:return"Suspense";case sy:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case G4:return(e.displayName||"Context")+".Consumer";case W4:return(e._context.displayName||"Context")+".Provider";case v1:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case b1:return t=e.displayName||null,t!==null?t:oy(e.type)||"Memo";case Zs:t=e._payload,e=e._init;try{return oy(e(t))}catch{}}return null}function FF(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return oy(t);case 8:return t===y1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function So(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function K4(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function MF(e){var t=K4(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(s){n=""+s,i.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function p0(e){e._valueTracker||(e._valueTracker=MF(e))}function q4(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=K4(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Ch(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function ly(e,t){var r=t.checked;return br({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function RN(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=So(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function X4(e,t){t=t.checked,t!=null&&x1(e,"checked",t,!1)}function cy(e,t){X4(e,t);var r=So(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?uy(e,t.type,r):t.hasOwnProperty("defaultValue")&&uy(e,t.type,So(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function FN(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function uy(e,t,r){(t!=="number"||Ch(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var sd=Array.isArray;function Ic(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+So(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function dy(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Be(91));return br({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function MN(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Be(92));if(sd(r)){if(1<r.length)throw Error(Be(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:So(r)}}function Y4(e,t){var r=So(t.value),n=So(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function LN(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function J4(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function fy(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?J4(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var g0,Q4=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(g0=g0||document.createElement("div"),g0.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=g0.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Rd(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var md={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},LF=["Webkit","ms","Moz","O"];Object.keys(md).forEach(function(e){LF.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),md[t]=md[e]})});function Z4(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||md.hasOwnProperty(e)&&md[e]?(""+t).trim():t+"px"}function eA(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=Z4(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var BF=br({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function hy(e,t){if(t){if(BF[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Be(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Be(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Be(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Be(62))}}function my(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var py=null;function w1(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var gy=null,Rc=null,Fc=null;function BN(e){if(e=Ef(e)){if(typeof gy!="function")throw Error(Be(280));var t=e.stateNode;t&&(t=op(t),gy(e.stateNode,e.type,t))}}function tA(e){Rc?Fc?Fc.push(e):Fc=[e]:Rc=e}function rA(){if(Rc){var e=Rc,t=Fc;if(Fc=Rc=null,BN(e),t)for(e=0;e<t.length;e++)BN(t[e])}}function nA(e,t){return e(t)}function aA(){}var zg=!1;function iA(e,t,r){if(zg)return e(t,r);zg=!0;try{return nA(e,t,r)}finally{zg=!1,(Rc!==null||Fc!==null)&&(aA(),rA())}}function Fd(e,t){var r=e.stateNode;if(r===null)return null;var n=op(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Be(231,t,typeof r));return r}var xy=!1;if(Ts)try{var Bu={};Object.defineProperty(Bu,"passive",{get:function(){xy=!0}}),window.addEventListener("test",Bu,Bu),window.removeEventListener("test",Bu,Bu)}catch{xy=!1}function jF(e,t,r,n,a,i,s,o,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var pd=!1,Eh=null,Ah=!1,yy=null,$F={onError:function(e){pd=!0,Eh=e}};function UF(e,t,r,n,a,i,s,o,c){pd=!1,Eh=null,jF.apply($F,arguments)}function zF(e,t,r,n,a,i,s,o,c){if(UF.apply(this,arguments),pd){if(pd){var u=Eh;pd=!1,Eh=null}else throw Error(Be(198));Ah||(Ah=!0,yy=u)}}function Vl(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function sA(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function jN(e){if(Vl(e)!==e)throw Error(Be(188))}function HF(e){var t=e.alternate;if(!t){if(t=Vl(e),t===null)throw Error(Be(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return jN(a),e;if(i===n)return jN(a),t;i=i.sibling}throw Error(Be(188))}if(r.return!==n.return)r=a,n=i;else{for(var s=!1,o=a.child;o;){if(o===r){s=!0,r=a,n=i;break}if(o===n){s=!0,n=a,r=i;break}o=o.sibling}if(!s){for(o=i.child;o;){if(o===r){s=!0,r=i,n=a;break}if(o===n){s=!0,n=i,r=a;break}o=o.sibling}if(!s)throw Error(Be(189))}}if(r.alternate!==n)throw Error(Be(190))}if(r.tag!==3)throw Error(Be(188));return r.stateNode.current===r?e:t}function oA(e){return e=HF(e),e!==null?lA(e):null}function lA(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=lA(e);if(t!==null)return t;e=e.sibling}return null}var cA=Ia.unstable_scheduleCallback,$N=Ia.unstable_cancelCallback,WF=Ia.unstable_shouldYield,GF=Ia.unstable_requestPaint,Or=Ia.unstable_now,VF=Ia.unstable_getCurrentPriorityLevel,N1=Ia.unstable_ImmediatePriority,uA=Ia.unstable_UserBlockingPriority,Th=Ia.unstable_NormalPriority,KF=Ia.unstable_LowPriority,dA=Ia.unstable_IdlePriority,np=null,Yi=null;function qF(e){if(Yi&&typeof Yi.onCommitFiberRoot=="function")try{Yi.onCommitFiberRoot(np,e,void 0,(e.current.flags&128)===128)}catch{}}var Ti=Math.clz32?Math.clz32:JF,XF=Math.log,YF=Math.LN2;function JF(e){return e>>>=0,e===0?32:31-(XF(e)/YF|0)|0}var x0=64,y0=4194304;function od(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ph(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,s=r&268435455;if(s!==0){var o=s&~a;o!==0?n=od(o):(i&=s,i!==0&&(n=od(i)))}else s=r&~a,s!==0?n=od(s):i!==0&&(n=od(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Ti(t),a=1<<r,n|=e[r],t&=~a;return n}function QF(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ZF(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-Ti(i),o=1<<s,c=a[s];c===-1?(!(o&r)||o&n)&&(a[s]=QF(o,t)):c<=t&&(e.expiredLanes|=o),i&=~o}}function vy(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function fA(){var e=x0;return x0<<=1,!(x0&4194240)&&(x0=64),e}function Hg(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function _f(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ti(t),e[t]=r}function eM(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Ti(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function k1(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Ti(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var Wt=0;function hA(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var mA,S1,pA,gA,xA,by=!1,v0=[],mo=null,po=null,go=null,Md=new Map,Ld=new Map,no=[],tM="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function UN(e,t){switch(e){case"focusin":case"focusout":mo=null;break;case"dragenter":case"dragleave":po=null;break;case"mouseover":case"mouseout":go=null;break;case"pointerover":case"pointerout":Md.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ld.delete(t.pointerId)}}function ju(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=Ef(t),t!==null&&S1(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function rM(e,t,r,n,a){switch(t){case"focusin":return mo=ju(mo,e,t,r,n,a),!0;case"dragenter":return po=ju(po,e,t,r,n,a),!0;case"mouseover":return go=ju(go,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return Md.set(i,ju(Md.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,Ld.set(i,ju(Ld.get(i)||null,e,t,r,n,a)),!0}return!1}function yA(e){var t=nl(e.target);if(t!==null){var r=Vl(t);if(r!==null){if(t=r.tag,t===13){if(t=sA(r),t!==null){e.blockedOn=t,xA(e.priority,function(){pA(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function lh(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=wy(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);py=n,r.target.dispatchEvent(n),py=null}else return t=Ef(r),t!==null&&S1(t),e.blockedOn=r,!1;t.shift()}return!0}function zN(e,t,r){lh(e)&&r.delete(t)}function nM(){by=!1,mo!==null&&lh(mo)&&(mo=null),po!==null&&lh(po)&&(po=null),go!==null&&lh(go)&&(go=null),Md.forEach(zN),Ld.forEach(zN)}function $u(e,t){e.blockedOn===t&&(e.blockedOn=null,by||(by=!0,Ia.unstable_scheduleCallback(Ia.unstable_NormalPriority,nM)))}function Bd(e){function t(a){return $u(a,e)}if(0<v0.length){$u(v0[0],e);for(var r=1;r<v0.length;r++){var n=v0[r];n.blockedOn===e&&(n.blockedOn=null)}}for(mo!==null&&$u(mo,e),po!==null&&$u(po,e),go!==null&&$u(go,e),Md.forEach(t),Ld.forEach(t),r=0;r<no.length;r++)n=no[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<no.length&&(r=no[0],r.blockedOn===null);)yA(r),r.blockedOn===null&&no.shift()}var Mc=Us.ReactCurrentBatchConfig,Oh=!0;function aM(e,t,r,n){var a=Wt,i=Mc.transition;Mc.transition=null;try{Wt=1,_1(e,t,r,n)}finally{Wt=a,Mc.transition=i}}function iM(e,t,r,n){var a=Wt,i=Mc.transition;Mc.transition=null;try{Wt=4,_1(e,t,r,n)}finally{Wt=a,Mc.transition=i}}function _1(e,t,r,n){if(Oh){var a=wy(e,t,r,n);if(a===null)Zg(e,t,n,Dh,r),UN(e,n);else if(rM(a,e,t,r,n))n.stopPropagation();else if(UN(e,n),t&4&&-1<tM.indexOf(e)){for(;a!==null;){var i=Ef(a);if(i!==null&&mA(i),i=wy(e,t,r,n),i===null&&Zg(e,t,n,Dh,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else Zg(e,t,n,null,r)}}var Dh=null;function wy(e,t,r,n){if(Dh=null,e=w1(n),e=nl(e),e!==null)if(t=Vl(e),t===null)e=null;else if(r=t.tag,r===13){if(e=sA(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Dh=e,null}function vA(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(VF()){case N1:return 1;case uA:return 4;case Th:case KF:return 16;case dA:return 536870912;default:return 16}default:return 16}}var so=null,C1=null,ch=null;function bA(){if(ch)return ch;var e,t=C1,r=t.length,n,a="value"in so?so.value:so.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var s=r-e;for(n=1;n<=s&&t[r-n]===a[i-n];n++);return ch=a.slice(e,1<n?1-n:void 0)}function uh(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function b0(){return!0}function HN(){return!1}function $a(e){function t(r,n,a,i,s){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?b0:HN,this.isPropagationStopped=HN,this}return br(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=b0)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=b0)},persist:function(){},isPersistent:b0}),t}var gu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},E1=$a(gu),Cf=br({},gu,{view:0,detail:0}),sM=$a(Cf),Wg,Gg,Uu,ap=br({},Cf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:A1,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Uu&&(Uu&&e.type==="mousemove"?(Wg=e.screenX-Uu.screenX,Gg=e.screenY-Uu.screenY):Gg=Wg=0,Uu=e),Wg)},movementY:function(e){return"movementY"in e?e.movementY:Gg}}),WN=$a(ap),oM=br({},ap,{dataTransfer:0}),lM=$a(oM),cM=br({},Cf,{relatedTarget:0}),Vg=$a(cM),uM=br({},gu,{animationName:0,elapsedTime:0,pseudoElement:0}),dM=$a(uM),fM=br({},gu,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),hM=$a(fM),mM=br({},gu,{data:0}),GN=$a(mM),pM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gM={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yM(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=xM[e])?!!t[e]:!1}function A1(){return yM}var vM=br({},Cf,{key:function(e){if(e.key){var t=pM[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=uh(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?gM[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:A1,charCode:function(e){return e.type==="keypress"?uh(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?uh(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),bM=$a(vM),wM=br({},ap,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),VN=$a(wM),NM=br({},Cf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:A1}),kM=$a(NM),SM=br({},gu,{propertyName:0,elapsedTime:0,pseudoElement:0}),_M=$a(SM),CM=br({},ap,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),EM=$a(CM),AM=[9,13,27,32],T1=Ts&&"CompositionEvent"in window,gd=null;Ts&&"documentMode"in document&&(gd=document.documentMode);var TM=Ts&&"TextEvent"in window&&!gd,wA=Ts&&(!T1||gd&&8<gd&&11>=gd),KN=String.fromCharCode(32),qN=!1;function NA(e,t){switch(e){case"keyup":return AM.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function kA(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var yc=!1;function PM(e,t){switch(e){case"compositionend":return kA(t);case"keypress":return t.which!==32?null:(qN=!0,KN);case"textInput":return e=t.data,e===KN&&qN?null:e;default:return null}}function OM(e,t){if(yc)return e==="compositionend"||!T1&&NA(e,t)?(e=bA(),ch=C1=so=null,yc=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return wA&&t.locale!=="ko"?null:t.data;default:return null}}var DM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function XN(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!DM[e.type]:t==="textarea"}function SA(e,t,r,n){tA(n),t=Ih(t,"onChange"),0<t.length&&(r=new E1("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var xd=null,jd=null;function IM(e){FA(e,0)}function ip(e){var t=wc(e);if(q4(t))return e}function RM(e,t){if(e==="change")return t}var _A=!1;if(Ts){var Kg;if(Ts){var qg="oninput"in document;if(!qg){var YN=document.createElement("div");YN.setAttribute("oninput","return;"),qg=typeof YN.oninput=="function"}Kg=qg}else Kg=!1;_A=Kg&&(!document.documentMode||9<document.documentMode)}function JN(){xd&&(xd.detachEvent("onpropertychange",CA),jd=xd=null)}function CA(e){if(e.propertyName==="value"&&ip(jd)){var t=[];SA(t,jd,e,w1(e)),iA(IM,t)}}function FM(e,t,r){e==="focusin"?(JN(),xd=t,jd=r,xd.attachEvent("onpropertychange",CA)):e==="focusout"&&JN()}function MM(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ip(jd)}function LM(e,t){if(e==="click")return ip(t)}function BM(e,t){if(e==="input"||e==="change")return ip(t)}function jM(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Mi=typeof Object.is=="function"?Object.is:jM;function $d(e,t){if(Mi(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!ny.call(t,a)||!Mi(e[a],t[a]))return!1}return!0}function QN(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ZN(e,t){var r=QN(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=QN(r)}}function EA(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?EA(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function AA(){for(var e=window,t=Ch();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Ch(e.document)}return t}function P1(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function $M(e){var t=AA(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&EA(r.ownerDocument.documentElement,r)){if(n!==null&&P1(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=ZN(r,i);var s=ZN(r,n);a&&s&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var UM=Ts&&"documentMode"in document&&11>=document.documentMode,vc=null,Ny=null,yd=null,ky=!1;function ek(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;ky||vc==null||vc!==Ch(n)||(n=vc,"selectionStart"in n&&P1(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),yd&&$d(yd,n)||(yd=n,n=Ih(Ny,"onSelect"),0<n.length&&(t=new E1("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=vc)))}function w0(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var bc={animationend:w0("Animation","AnimationEnd"),animationiteration:w0("Animation","AnimationIteration"),animationstart:w0("Animation","AnimationStart"),transitionend:w0("Transition","TransitionEnd")},Xg={},TA={};Ts&&(TA=document.createElement("div").style,"AnimationEvent"in window||(delete bc.animationend.animation,delete bc.animationiteration.animation,delete bc.animationstart.animation),"TransitionEvent"in window||delete bc.transitionend.transition);function sp(e){if(Xg[e])return Xg[e];if(!bc[e])return e;var t=bc[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in TA)return Xg[e]=t[r];return e}var PA=sp("animationend"),OA=sp("animationiteration"),DA=sp("animationstart"),IA=sp("transitionend"),RA=new Map,tk="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Mo(e,t){RA.set(e,t),Gl(t,[e])}for(var Yg=0;Yg<tk.length;Yg++){var Jg=tk[Yg],zM=Jg.toLowerCase(),HM=Jg[0].toUpperCase()+Jg.slice(1);Mo(zM,"on"+HM)}Mo(PA,"onAnimationEnd");Mo(OA,"onAnimationIteration");Mo(DA,"onAnimationStart");Mo("dblclick","onDoubleClick");Mo("focusin","onFocus");Mo("focusout","onBlur");Mo(IA,"onTransitionEnd");Gc("onMouseEnter",["mouseout","mouseover"]);Gc("onMouseLeave",["mouseout","mouseover"]);Gc("onPointerEnter",["pointerout","pointerover"]);Gc("onPointerLeave",["pointerout","pointerover"]);Gl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Gl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Gl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Gl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Gl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Gl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ld="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),WM=new Set("cancel close invalid load scroll toggle".split(" ").concat(ld));function rk(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,zF(n,t,void 0,e),e.currentTarget=null}function FA(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var s=n.length-1;0<=s;s--){var o=n[s],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==i&&a.isPropagationStopped())break e;rk(a,o,u),i=c}else for(s=0;s<n.length;s++){if(o=n[s],c=o.instance,u=o.currentTarget,o=o.listener,c!==i&&a.isPropagationStopped())break e;rk(a,o,u),i=c}}}if(Ah)throw e=yy,Ah=!1,yy=null,e}function er(e,t){var r=t[Ay];r===void 0&&(r=t[Ay]=new Set);var n=e+"__bubble";r.has(n)||(MA(t,e,2,!1),r.add(n))}function Qg(e,t,r){var n=0;t&&(n|=4),MA(r,e,n,t)}var N0="_reactListening"+Math.random().toString(36).slice(2);function Ud(e){if(!e[N0]){e[N0]=!0,H4.forEach(function(r){r!=="selectionchange"&&(WM.has(r)||Qg(r,!1,e),Qg(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[N0]||(t[N0]=!0,Qg("selectionchange",!1,t))}}function MA(e,t,r,n){switch(vA(t)){case 1:var a=aM;break;case 4:a=iM;break;default:a=_1}r=a.bind(null,t,r,e),a=void 0,!xy||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Zg(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(s===4)for(s=n.return;s!==null;){var c=s.tag;if((c===3||c===4)&&(c=s.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;s=s.return}for(;o!==null;){if(s=nl(o),s===null)return;if(c=s.tag,c===5||c===6){n=i=s;continue e}o=o.parentNode}}n=n.return}iA(function(){var u=i,d=w1(r),f=[];e:{var m=RA.get(e);if(m!==void 0){var p=E1,x=e;switch(e){case"keypress":if(uh(r)===0)break e;case"keydown":case"keyup":p=bM;break;case"focusin":x="focus",p=Vg;break;case"focusout":x="blur",p=Vg;break;case"beforeblur":case"afterblur":p=Vg;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=WN;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=lM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=kM;break;case PA:case OA:case DA:p=dM;break;case IA:p=_M;break;case"scroll":p=sM;break;case"wheel":p=EM;break;case"copy":case"cut":case"paste":p=hM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=VN}var g=(t&4)!==0,y=!g&&e==="scroll",v=g?m!==null?m+"Capture":null:m;g=[];for(var b=u,w;b!==null;){w=b;var k=w.stateNode;if(w.tag===5&&k!==null&&(w=k,v!==null&&(k=Fd(b,v),k!=null&&g.push(zd(b,k,w)))),y)break;b=b.return}0<g.length&&(m=new p(m,x,null,r,d),f.push({event:m,listeners:g}))}}if(!(t&7)){e:{if(m=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",m&&r!==py&&(x=r.relatedTarget||r.fromElement)&&(nl(x)||x[Ps]))break e;if((p||m)&&(m=d.window===d?d:(m=d.ownerDocument)?m.defaultView||m.parentWindow:window,p?(x=r.relatedTarget||r.toElement,p=u,x=x?nl(x):null,x!==null&&(y=Vl(x),x!==y||x.tag!==5&&x.tag!==6)&&(x=null)):(p=null,x=u),p!==x)){if(g=WN,k="onMouseLeave",v="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(g=VN,k="onPointerLeave",v="onPointerEnter",b="pointer"),y=p==null?m:wc(p),w=x==null?m:wc(x),m=new g(k,b+"leave",p,r,d),m.target=y,m.relatedTarget=w,k=null,nl(d)===u&&(g=new g(v,b+"enter",x,r,d),g.target=w,g.relatedTarget=y,k=g),y=k,p&&x)t:{for(g=p,v=x,b=0,w=g;w;w=ic(w))b++;for(w=0,k=v;k;k=ic(k))w++;for(;0<b-w;)g=ic(g),b--;for(;0<w-b;)v=ic(v),w--;for(;b--;){if(g===v||v!==null&&g===v.alternate)break t;g=ic(g),v=ic(v)}g=null}else g=null;p!==null&&nk(f,m,p,g,!1),x!==null&&y!==null&&nk(f,y,x,g,!0)}}e:{if(m=u?wc(u):window,p=m.nodeName&&m.nodeName.toLowerCase(),p==="select"||p==="input"&&m.type==="file")var S=RM;else if(XN(m))if(_A)S=BM;else{S=MM;var _=FM}else(p=m.nodeName)&&p.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(S=LM);if(S&&(S=S(e,u))){SA(f,S,r,d);break e}_&&_(e,m,u),e==="focusout"&&(_=m._wrapperState)&&_.controlled&&m.type==="number"&&uy(m,"number",m.value)}switch(_=u?wc(u):window,e){case"focusin":(XN(_)||_.contentEditable==="true")&&(vc=_,Ny=u,yd=null);break;case"focusout":yd=Ny=vc=null;break;case"mousedown":ky=!0;break;case"contextmenu":case"mouseup":case"dragend":ky=!1,ek(f,r,d);break;case"selectionchange":if(UM)break;case"keydown":case"keyup":ek(f,r,d)}var C;if(T1)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else yc?NA(e,r)&&(E="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(E="onCompositionStart");E&&(wA&&r.locale!=="ko"&&(yc||E!=="onCompositionStart"?E==="onCompositionEnd"&&yc&&(C=bA()):(so=d,C1="value"in so?so.value:so.textContent,yc=!0)),_=Ih(u,E),0<_.length&&(E=new GN(E,e,null,r,d),f.push({event:E,listeners:_}),C?E.data=C:(C=kA(r),C!==null&&(E.data=C)))),(C=TM?PM(e,r):OM(e,r))&&(u=Ih(u,"onBeforeInput"),0<u.length&&(d=new GN("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=C))}FA(f,t)})}function zd(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Ih(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Fd(e,r),i!=null&&n.unshift(zd(e,i,a)),i=Fd(e,t),i!=null&&n.push(zd(e,i,a))),e=e.return}return n}function ic(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function nk(e,t,r,n,a){for(var i=t._reactName,s=[];r!==null&&r!==n;){var o=r,c=o.alternate,u=o.stateNode;if(c!==null&&c===n)break;o.tag===5&&u!==null&&(o=u,a?(c=Fd(r,i),c!=null&&s.unshift(zd(r,c,o))):a||(c=Fd(r,i),c!=null&&s.push(zd(r,c,o)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var GM=/\r\n?/g,VM=/\u0000|\uFFFD/g;function ak(e){return(typeof e=="string"?e:""+e).replace(GM,`
`).replace(VM,"")}function k0(e,t,r){if(t=ak(t),ak(e)!==t&&r)throw Error(Be(425))}function Rh(){}var Sy=null,_y=null;function Cy(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ey=typeof setTimeout=="function"?setTimeout:void 0,KM=typeof clearTimeout=="function"?clearTimeout:void 0,ik=typeof Promise=="function"?Promise:void 0,qM=typeof queueMicrotask=="function"?queueMicrotask:typeof ik<"u"?function(e){return ik.resolve(null).then(e).catch(XM)}:Ey;function XM(e){setTimeout(function(){throw e})}function ex(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),Bd(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Bd(t)}function xo(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function sk(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var xu=Math.random().toString(36).slice(2),Vi="__reactFiber$"+xu,Hd="__reactProps$"+xu,Ps="__reactContainer$"+xu,Ay="__reactEvents$"+xu,YM="__reactListeners$"+xu,JM="__reactHandles$"+xu;function nl(e){var t=e[Vi];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Ps]||r[Vi]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=sk(e);e!==null;){if(r=e[Vi])return r;e=sk(e)}return t}e=r,r=e.parentNode}return null}function Ef(e){return e=e[Vi]||e[Ps],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function wc(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Be(33))}function op(e){return e[Hd]||null}var Ty=[],Nc=-1;function Lo(e){return{current:e}}function ir(e){0>Nc||(e.current=Ty[Nc],Ty[Nc]=null,Nc--)}function Qt(e,t){Nc++,Ty[Nc]=e.current,e.current=t}var _o={},Un=Lo(_o),da=Lo(!1),Nl=_o;function Vc(e,t){var r=e.type.contextTypes;if(!r)return _o;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function fa(e){return e=e.childContextTypes,e!=null}function Fh(){ir(da),ir(Un)}function ok(e,t,r){if(Un.current!==_o)throw Error(Be(168));Qt(Un,t),Qt(da,r)}function LA(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(Be(108,FF(e)||"Unknown",a));return br({},r,n)}function Mh(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||_o,Nl=Un.current,Qt(Un,e),Qt(da,da.current),!0}function lk(e,t,r){var n=e.stateNode;if(!n)throw Error(Be(169));r?(e=LA(e,t,Nl),n.__reactInternalMemoizedMergedChildContext=e,ir(da),ir(Un),Qt(Un,e)):ir(da),Qt(da,r)}var ds=null,lp=!1,tx=!1;function BA(e){ds===null?ds=[e]:ds.push(e)}function QM(e){lp=!0,BA(e)}function Bo(){if(!tx&&ds!==null){tx=!0;var e=0,t=Wt;try{var r=ds;for(Wt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ds=null,lp=!1}catch(a){throw ds!==null&&(ds=ds.slice(e+1)),cA(N1,Bo),a}finally{Wt=t,tx=!1}}return null}var kc=[],Sc=0,Lh=null,Bh=0,ti=[],ri=0,kl=null,gs=1,xs="";function Yo(e,t){kc[Sc++]=Bh,kc[Sc++]=Lh,Lh=e,Bh=t}function jA(e,t,r){ti[ri++]=gs,ti[ri++]=xs,ti[ri++]=kl,kl=e;var n=gs;e=xs;var a=32-Ti(n)-1;n&=~(1<<a),r+=1;var i=32-Ti(t)+a;if(30<i){var s=a-a%5;i=(n&(1<<s)-1).toString(32),n>>=s,a-=s,gs=1<<32-Ti(t)+a|r<<a|n,xs=i+e}else gs=1<<i|r<<a|n,xs=e}function O1(e){e.return!==null&&(Yo(e,1),jA(e,1,0))}function D1(e){for(;e===Lh;)Lh=kc[--Sc],kc[Sc]=null,Bh=kc[--Sc],kc[Sc]=null;for(;e===kl;)kl=ti[--ri],ti[ri]=null,xs=ti[--ri],ti[ri]=null,gs=ti[--ri],ti[ri]=null}var Pa=null,Ea=null,cr=!1,Si=null;function $A(e,t){var r=ai(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function ck(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Pa=e,Ea=xo(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Pa=e,Ea=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=kl!==null?{id:gs,overflow:xs}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=ai(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Pa=e,Ea=null,!0):!1;default:return!1}}function Py(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Oy(e){if(cr){var t=Ea;if(t){var r=t;if(!ck(e,t)){if(Py(e))throw Error(Be(418));t=xo(r.nextSibling);var n=Pa;t&&ck(e,t)?$A(n,r):(e.flags=e.flags&-4097|2,cr=!1,Pa=e)}}else{if(Py(e))throw Error(Be(418));e.flags=e.flags&-4097|2,cr=!1,Pa=e}}}function uk(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Pa=e}function S0(e){if(e!==Pa)return!1;if(!cr)return uk(e),cr=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Cy(e.type,e.memoizedProps)),t&&(t=Ea)){if(Py(e))throw UA(),Error(Be(418));for(;t;)$A(e,t),t=xo(t.nextSibling)}if(uk(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Be(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Ea=xo(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Ea=null}}else Ea=Pa?xo(e.stateNode.nextSibling):null;return!0}function UA(){for(var e=Ea;e;)e=xo(e.nextSibling)}function Kc(){Ea=Pa=null,cr=!1}function I1(e){Si===null?Si=[e]:Si.push(e)}var ZM=Us.ReactCurrentBatchConfig;function zu(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Be(309));var n=r.stateNode}if(!n)throw Error(Be(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(s){var o=a.refs;s===null?delete o[i]:o[i]=s},t._stringRef=i,t)}if(typeof e!="string")throw Error(Be(284));if(!r._owner)throw Error(Be(290,e))}return e}function _0(e,t){throw e=Object.prototype.toString.call(t),Error(Be(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function dk(e){var t=e._init;return t(e._payload)}function zA(e){function t(v,b){if(e){var w=v.deletions;w===null?(v.deletions=[b],v.flags|=16):w.push(b)}}function r(v,b){if(!e)return null;for(;b!==null;)t(v,b),b=b.sibling;return null}function n(v,b){for(v=new Map;b!==null;)b.key!==null?v.set(b.key,b):v.set(b.index,b),b=b.sibling;return v}function a(v,b){return v=wo(v,b),v.index=0,v.sibling=null,v}function i(v,b,w){return v.index=w,e?(w=v.alternate,w!==null?(w=w.index,w<b?(v.flags|=2,b):w):(v.flags|=2,b)):(v.flags|=1048576,b)}function s(v){return e&&v.alternate===null&&(v.flags|=2),v}function o(v,b,w,k){return b===null||b.tag!==6?(b=lx(w,v.mode,k),b.return=v,b):(b=a(b,w),b.return=v,b)}function c(v,b,w,k){var S=w.type;return S===xc?d(v,b,w.props.children,k,w.key):b!==null&&(b.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Zs&&dk(S)===b.type)?(k=a(b,w.props),k.ref=zu(v,b,w),k.return=v,k):(k=xh(w.type,w.key,w.props,null,v.mode,k),k.ref=zu(v,b,w),k.return=v,k)}function u(v,b,w,k){return b===null||b.tag!==4||b.stateNode.containerInfo!==w.containerInfo||b.stateNode.implementation!==w.implementation?(b=cx(w,v.mode,k),b.return=v,b):(b=a(b,w.children||[]),b.return=v,b)}function d(v,b,w,k,S){return b===null||b.tag!==7?(b=fl(w,v.mode,k,S),b.return=v,b):(b=a(b,w),b.return=v,b)}function f(v,b,w){if(typeof b=="string"&&b!==""||typeof b=="number")return b=lx(""+b,v.mode,w),b.return=v,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case m0:return w=xh(b.type,b.key,b.props,null,v.mode,w),w.ref=zu(v,null,b),w.return=v,w;case gc:return b=cx(b,v.mode,w),b.return=v,b;case Zs:var k=b._init;return f(v,k(b._payload),w)}if(sd(b)||Lu(b))return b=fl(b,v.mode,w,null),b.return=v,b;_0(v,b)}return null}function m(v,b,w,k){var S=b!==null?b.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return S!==null?null:o(v,b,""+w,k);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case m0:return w.key===S?c(v,b,w,k):null;case gc:return w.key===S?u(v,b,w,k):null;case Zs:return S=w._init,m(v,b,S(w._payload),k)}if(sd(w)||Lu(w))return S!==null?null:d(v,b,w,k,null);_0(v,w)}return null}function p(v,b,w,k,S){if(typeof k=="string"&&k!==""||typeof k=="number")return v=v.get(w)||null,o(b,v,""+k,S);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case m0:return v=v.get(k.key===null?w:k.key)||null,c(b,v,k,S);case gc:return v=v.get(k.key===null?w:k.key)||null,u(b,v,k,S);case Zs:var _=k._init;return p(v,b,w,_(k._payload),S)}if(sd(k)||Lu(k))return v=v.get(w)||null,d(b,v,k,S,null);_0(b,k)}return null}function x(v,b,w,k){for(var S=null,_=null,C=b,E=b=0,A=null;C!==null&&E<w.length;E++){C.index>E?(A=C,C=null):A=C.sibling;var T=m(v,C,w[E],k);if(T===null){C===null&&(C=A);break}e&&C&&T.alternate===null&&t(v,C),b=i(T,b,E),_===null?S=T:_.sibling=T,_=T,C=A}if(E===w.length)return r(v,C),cr&&Yo(v,E),S;if(C===null){for(;E<w.length;E++)C=f(v,w[E],k),C!==null&&(b=i(C,b,E),_===null?S=C:_.sibling=C,_=C);return cr&&Yo(v,E),S}for(C=n(v,C);E<w.length;E++)A=p(C,v,E,w[E],k),A!==null&&(e&&A.alternate!==null&&C.delete(A.key===null?E:A.key),b=i(A,b,E),_===null?S=A:_.sibling=A,_=A);return e&&C.forEach(function(D){return t(v,D)}),cr&&Yo(v,E),S}function g(v,b,w,k){var S=Lu(w);if(typeof S!="function")throw Error(Be(150));if(w=S.call(w),w==null)throw Error(Be(151));for(var _=S=null,C=b,E=b=0,A=null,T=w.next();C!==null&&!T.done;E++,T=w.next()){C.index>E?(A=C,C=null):A=C.sibling;var D=m(v,C,T.value,k);if(D===null){C===null&&(C=A);break}e&&C&&D.alternate===null&&t(v,C),b=i(D,b,E),_===null?S=D:_.sibling=D,_=D,C=A}if(T.done)return r(v,C),cr&&Yo(v,E),S;if(C===null){for(;!T.done;E++,T=w.next())T=f(v,T.value,k),T!==null&&(b=i(T,b,E),_===null?S=T:_.sibling=T,_=T);return cr&&Yo(v,E),S}for(C=n(v,C);!T.done;E++,T=w.next())T=p(C,v,E,T.value,k),T!==null&&(e&&T.alternate!==null&&C.delete(T.key===null?E:T.key),b=i(T,b,E),_===null?S=T:_.sibling=T,_=T);return e&&C.forEach(function(I){return t(v,I)}),cr&&Yo(v,E),S}function y(v,b,w,k){if(typeof w=="object"&&w!==null&&w.type===xc&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case m0:e:{for(var S=w.key,_=b;_!==null;){if(_.key===S){if(S=w.type,S===xc){if(_.tag===7){r(v,_.sibling),b=a(_,w.props.children),b.return=v,v=b;break e}}else if(_.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Zs&&dk(S)===_.type){r(v,_.sibling),b=a(_,w.props),b.ref=zu(v,_,w),b.return=v,v=b;break e}r(v,_);break}else t(v,_);_=_.sibling}w.type===xc?(b=fl(w.props.children,v.mode,k,w.key),b.return=v,v=b):(k=xh(w.type,w.key,w.props,null,v.mode,k),k.ref=zu(v,b,w),k.return=v,v=k)}return s(v);case gc:e:{for(_=w.key;b!==null;){if(b.key===_)if(b.tag===4&&b.stateNode.containerInfo===w.containerInfo&&b.stateNode.implementation===w.implementation){r(v,b.sibling),b=a(b,w.children||[]),b.return=v,v=b;break e}else{r(v,b);break}else t(v,b);b=b.sibling}b=cx(w,v.mode,k),b.return=v,v=b}return s(v);case Zs:return _=w._init,y(v,b,_(w._payload),k)}if(sd(w))return x(v,b,w,k);if(Lu(w))return g(v,b,w,k);_0(v,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,b!==null&&b.tag===6?(r(v,b.sibling),b=a(b,w),b.return=v,v=b):(r(v,b),b=lx(w,v.mode,k),b.return=v,v=b),s(v)):r(v,b)}return y}var qc=zA(!0),HA=zA(!1),jh=Lo(null),$h=null,_c=null,R1=null;function F1(){R1=_c=$h=null}function M1(e){var t=jh.current;ir(jh),e._currentValue=t}function Dy(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Lc(e,t){$h=e,R1=_c=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(la=!0),e.firstContext=null)}function ci(e){var t=e._currentValue;if(R1!==e)if(e={context:e,memoizedValue:t,next:null},_c===null){if($h===null)throw Error(Be(308));_c=e,$h.dependencies={lanes:0,firstContext:e}}else _c=_c.next=e;return t}var al=null;function L1(e){al===null?al=[e]:al.push(e)}function WA(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,L1(t)):(r.next=a.next,a.next=r),t.interleaved=r,Os(e,n)}function Os(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var eo=!1;function B1(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function GA(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ks(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function yo(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Dt&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Os(e,r)}return a=n.interleaved,a===null?(t.next=t,L1(n)):(t.next=a.next,a.next=t),n.interleaved=t,Os(e,r)}function dh(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,k1(e,r)}}function fk(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=s:i=i.next=s,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Uh(e,t,r,n){var a=e.updateQueue;eo=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var c=o,u=c.next;c.next=null,s===null?i=u:s.next=u,s=c;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==s&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=c))}if(i!==null){var f=a.baseState;s=0,d=u=c=null,o=i;do{var m=o.lane,p=o.eventTime;if((n&m)===m){d!==null&&(d=d.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var x=e,g=o;switch(m=t,p=r,g.tag){case 1:if(x=g.payload,typeof x=="function"){f=x.call(p,f,m);break e}f=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=g.payload,m=typeof x=="function"?x.call(p,f,m):x,m==null)break e;f=br({},f,m);break e;case 2:eo=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,m=a.effects,m===null?a.effects=[o]:m.push(o))}else p={eventTime:p,lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=p,c=f):d=d.next=p,s|=m;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;m=o,o=m.next,m.next=null,a.lastBaseUpdate=m,a.shared.pending=null}}while(1);if(d===null&&(c=f),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=d,t=a.shared.interleaved,t!==null){a=t;do s|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);_l|=s,e.lanes=s,e.memoizedState=f}}function hk(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(Be(191,a));a.call(n)}}}var Af={},Ji=Lo(Af),Wd=Lo(Af),Gd=Lo(Af);function il(e){if(e===Af)throw Error(Be(174));return e}function j1(e,t){switch(Qt(Gd,t),Qt(Wd,e),Qt(Ji,Af),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:fy(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=fy(t,e)}ir(Ji),Qt(Ji,t)}function Xc(){ir(Ji),ir(Wd),ir(Gd)}function VA(e){il(Gd.current);var t=il(Ji.current),r=fy(t,e.type);t!==r&&(Qt(Wd,e),Qt(Ji,r))}function $1(e){Wd.current===e&&(ir(Ji),ir(Wd))}var pr=Lo(0);function zh(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var rx=[];function U1(){for(var e=0;e<rx.length;e++)rx[e]._workInProgressVersionPrimary=null;rx.length=0}var fh=Us.ReactCurrentDispatcher,nx=Us.ReactCurrentBatchConfig,Sl=0,vr=null,Vr=null,an=null,Hh=!1,vd=!1,Vd=0,e8=0;function _n(){throw Error(Be(321))}function z1(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Mi(e[r],t[r]))return!1;return!0}function H1(e,t,r,n,a,i){if(Sl=i,vr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,fh.current=e===null||e.memoizedState===null?a8:i8,e=r(n,a),vd){i=0;do{if(vd=!1,Vd=0,25<=i)throw Error(Be(301));i+=1,an=Vr=null,t.updateQueue=null,fh.current=s8,e=r(n,a)}while(vd)}if(fh.current=Wh,t=Vr!==null&&Vr.next!==null,Sl=0,an=Vr=vr=null,Hh=!1,t)throw Error(Be(300));return e}function W1(){var e=Vd!==0;return Vd=0,e}function Wi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return an===null?vr.memoizedState=an=e:an=an.next=e,an}function ui(){if(Vr===null){var e=vr.alternate;e=e!==null?e.memoizedState:null}else e=Vr.next;var t=an===null?vr.memoizedState:an.next;if(t!==null)an=t,Vr=e;else{if(e===null)throw Error(Be(310));Vr=e,e={memoizedState:Vr.memoizedState,baseState:Vr.baseState,baseQueue:Vr.baseQueue,queue:Vr.queue,next:null},an===null?vr.memoizedState=an=e:an=an.next=e}return an}function Kd(e,t){return typeof t=="function"?t(e):t}function ax(e){var t=ui(),r=t.queue;if(r===null)throw Error(Be(311));r.lastRenderedReducer=e;var n=Vr,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var s=a.next;a.next=i.next,i.next=s}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var o=s=null,c=null,u=i;do{var d=u.lane;if((Sl&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(o=c=f,s=n):c=c.next=f,vr.lanes|=d,_l|=d}u=u.next}while(u!==null&&u!==i);c===null?s=n:c.next=o,Mi(n,t.memoizedState)||(la=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,vr.lanes|=i,_l|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function ix(e){var t=ui(),r=t.queue;if(r===null)throw Error(Be(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var s=a=a.next;do i=e(i,s.action),s=s.next;while(s!==a);Mi(i,t.memoizedState)||(la=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function KA(){}function qA(e,t){var r=vr,n=ui(),a=t(),i=!Mi(n.memoizedState,a);if(i&&(n.memoizedState=a,la=!0),n=n.queue,G1(JA.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||an!==null&&an.memoizedState.tag&1){if(r.flags|=2048,qd(9,YA.bind(null,r,n,a,t),void 0,null),un===null)throw Error(Be(349));Sl&30||XA(r,t,a)}return a}function XA(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=vr.updateQueue,t===null?(t={lastEffect:null,stores:null},vr.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function YA(e,t,r,n){t.value=r,t.getSnapshot=n,QA(t)&&ZA(e)}function JA(e,t,r){return r(function(){QA(t)&&ZA(e)})}function QA(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Mi(e,r)}catch{return!0}}function ZA(e){var t=Os(e,1);t!==null&&Pi(t,e,1,-1)}function mk(e){var t=Wi();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Kd,lastRenderedState:e},t.queue=e,e=e.dispatch=n8.bind(null,vr,e),[t.memoizedState,e]}function qd(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=vr.updateQueue,t===null?(t={lastEffect:null,stores:null},vr.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function eT(){return ui().memoizedState}function hh(e,t,r,n){var a=Wi();vr.flags|=e,a.memoizedState=qd(1|t,r,void 0,n===void 0?null:n)}function cp(e,t,r,n){var a=ui();n=n===void 0?null:n;var i=void 0;if(Vr!==null){var s=Vr.memoizedState;if(i=s.destroy,n!==null&&z1(n,s.deps)){a.memoizedState=qd(t,r,i,n);return}}vr.flags|=e,a.memoizedState=qd(1|t,r,i,n)}function pk(e,t){return hh(8390656,8,e,t)}function G1(e,t){return cp(2048,8,e,t)}function tT(e,t){return cp(4,2,e,t)}function rT(e,t){return cp(4,4,e,t)}function nT(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function aT(e,t,r){return r=r!=null?r.concat([e]):null,cp(4,4,nT.bind(null,t,e),r)}function V1(){}function iT(e,t){var r=ui();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&z1(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function sT(e,t){var r=ui();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&z1(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function oT(e,t,r){return Sl&21?(Mi(r,t)||(r=fA(),vr.lanes|=r,_l|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,la=!0),e.memoizedState=r)}function t8(e,t){var r=Wt;Wt=r!==0&&4>r?r:4,e(!0);var n=nx.transition;nx.transition={};try{e(!1),t()}finally{Wt=r,nx.transition=n}}function lT(){return ui().memoizedState}function r8(e,t,r){var n=bo(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},cT(e))uT(t,r);else if(r=WA(e,t,r,n),r!==null){var a=Zn();Pi(r,e,n,a),dT(r,t,n)}}function n8(e,t,r){var n=bo(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(cT(e))uT(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var s=t.lastRenderedState,o=i(s,r);if(a.hasEagerState=!0,a.eagerState=o,Mi(o,s)){var c=t.interleaved;c===null?(a.next=a,L1(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch{}finally{}r=WA(e,t,a,n),r!==null&&(a=Zn(),Pi(r,e,n,a),dT(r,t,n))}}function cT(e){var t=e.alternate;return e===vr||t!==null&&t===vr}function uT(e,t){vd=Hh=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function dT(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,k1(e,r)}}var Wh={readContext:ci,useCallback:_n,useContext:_n,useEffect:_n,useImperativeHandle:_n,useInsertionEffect:_n,useLayoutEffect:_n,useMemo:_n,useReducer:_n,useRef:_n,useState:_n,useDebugValue:_n,useDeferredValue:_n,useTransition:_n,useMutableSource:_n,useSyncExternalStore:_n,useId:_n,unstable_isNewReconciler:!1},a8={readContext:ci,useCallback:function(e,t){return Wi().memoizedState=[e,t===void 0?null:t],e},useContext:ci,useEffect:pk,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,hh(4194308,4,nT.bind(null,t,e),r)},useLayoutEffect:function(e,t){return hh(4194308,4,e,t)},useInsertionEffect:function(e,t){return hh(4,2,e,t)},useMemo:function(e,t){var r=Wi();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Wi();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=r8.bind(null,vr,e),[n.memoizedState,e]},useRef:function(e){var t=Wi();return e={current:e},t.memoizedState=e},useState:mk,useDebugValue:V1,useDeferredValue:function(e){return Wi().memoizedState=e},useTransition:function(){var e=mk(!1),t=e[0];return e=t8.bind(null,e[1]),Wi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=vr,a=Wi();if(cr){if(r===void 0)throw Error(Be(407));r=r()}else{if(r=t(),un===null)throw Error(Be(349));Sl&30||XA(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,pk(JA.bind(null,n,i,e),[e]),n.flags|=2048,qd(9,YA.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=Wi(),t=un.identifierPrefix;if(cr){var r=xs,n=gs;r=(n&~(1<<32-Ti(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Vd++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=e8++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},i8={readContext:ci,useCallback:iT,useContext:ci,useEffect:G1,useImperativeHandle:aT,useInsertionEffect:tT,useLayoutEffect:rT,useMemo:sT,useReducer:ax,useRef:eT,useState:function(){return ax(Kd)},useDebugValue:V1,useDeferredValue:function(e){var t=ui();return oT(t,Vr.memoizedState,e)},useTransition:function(){var e=ax(Kd)[0],t=ui().memoizedState;return[e,t]},useMutableSource:KA,useSyncExternalStore:qA,useId:lT,unstable_isNewReconciler:!1},s8={readContext:ci,useCallback:iT,useContext:ci,useEffect:G1,useImperativeHandle:aT,useInsertionEffect:tT,useLayoutEffect:rT,useMemo:sT,useReducer:ix,useRef:eT,useState:function(){return ix(Kd)},useDebugValue:V1,useDeferredValue:function(e){var t=ui();return Vr===null?t.memoizedState=e:oT(t,Vr.memoizedState,e)},useTransition:function(){var e=ix(Kd)[0],t=ui().memoizedState;return[e,t]},useMutableSource:KA,useSyncExternalStore:qA,useId:lT,unstable_isNewReconciler:!1};function Ni(e,t){if(e&&e.defaultProps){t=br({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Iy(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:br({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var up={isMounted:function(e){return(e=e._reactInternals)?Vl(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Zn(),a=bo(e),i=ks(n,a);i.payload=t,r!=null&&(i.callback=r),t=yo(e,i,a),t!==null&&(Pi(t,e,a,n),dh(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Zn(),a=bo(e),i=ks(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=yo(e,i,a),t!==null&&(Pi(t,e,a,n),dh(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Zn(),n=bo(e),a=ks(r,n);a.tag=2,t!=null&&(a.callback=t),t=yo(e,a,n),t!==null&&(Pi(t,e,n,r),dh(t,e,n))}};function gk(e,t,r,n,a,i,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,s):t.prototype&&t.prototype.isPureReactComponent?!$d(r,n)||!$d(a,i):!0}function fT(e,t,r){var n=!1,a=_o,i=t.contextType;return typeof i=="object"&&i!==null?i=ci(i):(a=fa(t)?Nl:Un.current,n=t.contextTypes,i=(n=n!=null)?Vc(e,a):_o),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=up,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function xk(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&up.enqueueReplaceState(t,t.state,null)}function Ry(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},B1(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=ci(i):(i=fa(t)?Nl:Un.current,a.context=Vc(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Iy(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&up.enqueueReplaceState(a,a.state,null),Uh(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Yc(e,t){try{var r="",n=t;do r+=RF(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function sx(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Fy(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var o8=typeof WeakMap=="function"?WeakMap:Map;function hT(e,t,r){r=ks(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Vh||(Vh=!0,Gy=n),Fy(e,t)},r}function mT(e,t,r){r=ks(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){Fy(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Fy(e,t),typeof n!="function"&&(vo===null?vo=new Set([this]):vo.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function yk(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new o8;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=w8.bind(null,e,t,r),t.then(e,e))}function vk(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function bk(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=ks(-1,1),t.tag=2,yo(r,t,1))),r.lanes|=1),e)}var l8=Us.ReactCurrentOwner,la=!1;function Kn(e,t,r,n){t.child=e===null?HA(t,null,r,n):qc(t,e.child,r,n)}function wk(e,t,r,n,a){r=r.render;var i=t.ref;return Lc(t,a),n=H1(e,t,r,n,i,a),r=W1(),e!==null&&!la?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Ds(e,t,a)):(cr&&r&&O1(t),t.flags|=1,Kn(e,t,n,a),t.child)}function Nk(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!eb(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,pT(e,t,i,n,a)):(e=xh(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var s=i.memoizedProps;if(r=r.compare,r=r!==null?r:$d,r(s,n)&&e.ref===t.ref)return Ds(e,t,a)}return t.flags|=1,e=wo(i,n),e.ref=t.ref,e.return=t,t.child=e}function pT(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if($d(i,n)&&e.ref===t.ref)if(la=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(la=!0);else return t.lanes=e.lanes,Ds(e,t,a)}return My(e,t,r,n,a)}function gT(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Qt(Ec,va),va|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Qt(Ec,va),va|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,Qt(Ec,va),va|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,Qt(Ec,va),va|=n;return Kn(e,t,a,r),t.child}function xT(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function My(e,t,r,n,a){var i=fa(r)?Nl:Un.current;return i=Vc(t,i),Lc(t,a),r=H1(e,t,r,n,i,a),n=W1(),e!==null&&!la?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Ds(e,t,a)):(cr&&n&&O1(t),t.flags|=1,Kn(e,t,r,a),t.child)}function kk(e,t,r,n,a){if(fa(r)){var i=!0;Mh(t)}else i=!1;if(Lc(t,a),t.stateNode===null)mh(e,t),fT(t,r,n),Ry(t,r,n,a),n=!0;else if(e===null){var s=t.stateNode,o=t.memoizedProps;s.props=o;var c=s.context,u=r.contextType;typeof u=="object"&&u!==null?u=ci(u):(u=fa(r)?Nl:Un.current,u=Vc(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof s.getSnapshotBeforeUpdate=="function";f||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==n||c!==u)&&xk(t,s,n,u),eo=!1;var m=t.memoizedState;s.state=m,Uh(t,n,s,a),c=t.memoizedState,o!==n||m!==c||da.current||eo?(typeof d=="function"&&(Iy(t,r,d,n),c=t.memoizedState),(o=eo||gk(t,r,o,n,m,c,u))?(f||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),s.props=n,s.state=c,s.context=u,n=o):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,GA(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:Ni(t.type,o),s.props=u,f=t.pendingProps,m=s.context,c=r.contextType,typeof c=="object"&&c!==null?c=ci(c):(c=fa(r)?Nl:Un.current,c=Vc(t,c));var p=r.getDerivedStateFromProps;(d=typeof p=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==f||m!==c)&&xk(t,s,n,c),eo=!1,m=t.memoizedState,s.state=m,Uh(t,n,s,a);var x=t.memoizedState;o!==f||m!==x||da.current||eo?(typeof p=="function"&&(Iy(t,r,p,n),x=t.memoizedState),(u=eo||gk(t,r,u,n,m,x,c)||!1)?(d||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,x,c),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,x,c)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=x),s.props=n,s.state=x,s.context=c,n=u):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),n=!1)}return Ly(e,t,r,n,i,a)}function Ly(e,t,r,n,a,i){xT(e,t);var s=(t.flags&128)!==0;if(!n&&!s)return a&&lk(t,r,!1),Ds(e,t,i);n=t.stateNode,l8.current=t;var o=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&s?(t.child=qc(t,e.child,null,i),t.child=qc(t,null,o,i)):Kn(e,t,o,i),t.memoizedState=n.state,a&&lk(t,r,!0),t.child}function yT(e){var t=e.stateNode;t.pendingContext?ok(e,t.pendingContext,t.pendingContext!==t.context):t.context&&ok(e,t.context,!1),j1(e,t.containerInfo)}function Sk(e,t,r,n,a){return Kc(),I1(a),t.flags|=256,Kn(e,t,r,n),t.child}var By={dehydrated:null,treeContext:null,retryLane:0};function jy(e){return{baseLanes:e,cachePool:null,transitions:null}}function vT(e,t,r){var n=t.pendingProps,a=pr.current,i=!1,s=(t.flags&128)!==0,o;if((o=s)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Qt(pr,a&1),e===null)return Oy(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=n.children,e=n.fallback,i?(n=t.mode,i=t.child,s={mode:"hidden",children:s},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=s):i=hp(s,n,0,null),e=fl(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=jy(r),t.memoizedState=By,e):K1(t,s));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return c8(e,t,s,n,o,a,r);if(i){i=n.fallback,s=t.mode,a=e.child,o=a.sibling;var c={mode:"hidden",children:n.children};return!(s&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=wo(a,c),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?i=wo(o,i):(i=fl(i,s,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,s=e.child.memoizedState,s=s===null?jy(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},i.memoizedState=s,i.childLanes=e.childLanes&~r,t.memoizedState=By,n}return i=e.child,e=i.sibling,n=wo(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function K1(e,t){return t=hp({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function C0(e,t,r,n){return n!==null&&I1(n),qc(t,e.child,null,r),e=K1(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function c8(e,t,r,n,a,i,s){if(r)return t.flags&256?(t.flags&=-257,n=sx(Error(Be(422))),C0(e,t,s,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=hp({mode:"visible",children:n.children},a,0,null),i=fl(i,a,s,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&qc(t,e.child,null,s),t.child.memoizedState=jy(s),t.memoizedState=By,i);if(!(t.mode&1))return C0(e,t,s,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(Be(419)),n=sx(i,n,void 0),C0(e,t,s,n)}if(o=(s&e.childLanes)!==0,la||o){if(n=un,n!==null){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|s)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,Os(e,a),Pi(n,e,a,-1))}return Z1(),n=sx(Error(Be(421))),C0(e,t,s,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=N8.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,Ea=xo(a.nextSibling),Pa=t,cr=!0,Si=null,e!==null&&(ti[ri++]=gs,ti[ri++]=xs,ti[ri++]=kl,gs=e.id,xs=e.overflow,kl=t),t=K1(t,n.children),t.flags|=4096,t)}function _k(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Dy(e.return,t,r)}function ox(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function bT(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(Kn(e,t,n.children,r),n=pr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&_k(e,r,t);else if(e.tag===19)_k(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Qt(pr,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&zh(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),ox(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&zh(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}ox(t,!0,r,null,i);break;case"together":ox(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function mh(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ds(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),_l|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Be(153));if(t.child!==null){for(e=t.child,r=wo(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=wo(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function u8(e,t,r){switch(t.tag){case 3:yT(t),Kc();break;case 5:VA(t);break;case 1:fa(t.type)&&Mh(t);break;case 4:j1(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Qt(jh,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Qt(pr,pr.current&1),t.flags|=128,null):r&t.child.childLanes?vT(e,t,r):(Qt(pr,pr.current&1),e=Ds(e,t,r),e!==null?e.sibling:null);Qt(pr,pr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return bT(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Qt(pr,pr.current),n)break;return null;case 22:case 23:return t.lanes=0,gT(e,t,r)}return Ds(e,t,r)}var wT,$y,NT,kT;wT=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};$y=function(){};NT=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,il(Ji.current);var i=null;switch(r){case"input":a=ly(e,a),n=ly(e,n),i=[];break;case"select":a=br({},a,{value:void 0}),n=br({},n,{value:void 0}),i=[];break;case"textarea":a=dy(e,a),n=dy(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Rh)}hy(r,n);var s;r=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var o=a[u];for(s in o)o.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Id.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var c=n[u];if(o=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&c!==o&&(c!=null||o!=null))if(u==="style")if(o){for(s in o)!o.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in c)c.hasOwnProperty(s)&&o[s]!==c[s]&&(r||(r={}),r[s]=c[s])}else r||(i||(i=[]),i.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Id.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&er("scroll",e),i||o===c||(i=[])):(i=i||[]).push(u,c))}r&&(i=i||[]).push("style",r);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};kT=function(e,t,r,n){r!==n&&(t.flags|=4)};function Hu(e,t){if(!cr)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Cn(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function d8(e,t,r){var n=t.pendingProps;switch(D1(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Cn(t),null;case 1:return fa(t.type)&&Fh(),Cn(t),null;case 3:return n=t.stateNode,Xc(),ir(da),ir(Un),U1(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(S0(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Si!==null&&(qy(Si),Si=null))),$y(e,t),Cn(t),null;case 5:$1(t);var a=il(Gd.current);if(r=t.type,e!==null&&t.stateNode!=null)NT(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Be(166));return Cn(t),null}if(e=il(Ji.current),S0(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[Vi]=t,n[Hd]=i,e=(t.mode&1)!==0,r){case"dialog":er("cancel",n),er("close",n);break;case"iframe":case"object":case"embed":er("load",n);break;case"video":case"audio":for(a=0;a<ld.length;a++)er(ld[a],n);break;case"source":er("error",n);break;case"img":case"image":case"link":er("error",n),er("load",n);break;case"details":er("toggle",n);break;case"input":RN(n,i),er("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},er("invalid",n);break;case"textarea":MN(n,i),er("invalid",n)}hy(r,i),a=null;for(var s in i)if(i.hasOwnProperty(s)){var o=i[s];s==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&k0(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&k0(n.textContent,o,e),a=["children",""+o]):Id.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&er("scroll",n)}switch(r){case"input":p0(n),FN(n,i,!0);break;case"textarea":p0(n),LN(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Rh)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{s=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=J4(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),r==="select"&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[Vi]=t,e[Hd]=n,wT(e,t,!1,!1),t.stateNode=e;e:{switch(s=my(r,n),r){case"dialog":er("cancel",e),er("close",e),a=n;break;case"iframe":case"object":case"embed":er("load",e),a=n;break;case"video":case"audio":for(a=0;a<ld.length;a++)er(ld[a],e);a=n;break;case"source":er("error",e),a=n;break;case"img":case"image":case"link":er("error",e),er("load",e),a=n;break;case"details":er("toggle",e),a=n;break;case"input":RN(e,n),a=ly(e,n),er("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=br({},n,{value:void 0}),er("invalid",e);break;case"textarea":MN(e,n),a=dy(e,n),er("invalid",e);break;default:a=n}hy(r,a),o=a;for(i in o)if(o.hasOwnProperty(i)){var c=o[i];i==="style"?eA(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Q4(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Rd(e,c):typeof c=="number"&&Rd(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Id.hasOwnProperty(i)?c!=null&&i==="onScroll"&&er("scroll",e):c!=null&&x1(e,i,c,s))}switch(r){case"input":p0(e),FN(e,n,!1);break;case"textarea":p0(e),LN(e);break;case"option":n.value!=null&&e.setAttribute("value",""+So(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Ic(e,!!n.multiple,i,!1):n.defaultValue!=null&&Ic(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Rh)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Cn(t),null;case 6:if(e&&t.stateNode!=null)kT(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Be(166));if(r=il(Gd.current),il(Ji.current),S0(t)){if(n=t.stateNode,r=t.memoizedProps,n[Vi]=t,(i=n.nodeValue!==r)&&(e=Pa,e!==null))switch(e.tag){case 3:k0(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&k0(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Vi]=t,t.stateNode=n}return Cn(t),null;case 13:if(ir(pr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(cr&&Ea!==null&&t.mode&1&&!(t.flags&128))UA(),Kc(),t.flags|=98560,i=!1;else if(i=S0(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(Be(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Be(317));i[Vi]=t}else Kc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Cn(t),i=!1}else Si!==null&&(qy(Si),Si=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||pr.current&1?Xr===0&&(Xr=3):Z1())),t.updateQueue!==null&&(t.flags|=4),Cn(t),null);case 4:return Xc(),$y(e,t),e===null&&Ud(t.stateNode.containerInfo),Cn(t),null;case 10:return M1(t.type._context),Cn(t),null;case 17:return fa(t.type)&&Fh(),Cn(t),null;case 19:if(ir(pr),i=t.memoizedState,i===null)return Cn(t),null;if(n=(t.flags&128)!==0,s=i.rendering,s===null)if(n)Hu(i,!1);else{if(Xr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=zh(e),s!==null){for(t.flags|=128,Hu(i,!1),n=s.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,s=i.alternate,s===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,i.type=s.type,e=s.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Qt(pr,pr.current&1|2),t.child}e=e.sibling}i.tail!==null&&Or()>Jc&&(t.flags|=128,n=!0,Hu(i,!1),t.lanes=4194304)}else{if(!n)if(e=zh(s),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Hu(i,!0),i.tail===null&&i.tailMode==="hidden"&&!s.alternate&&!cr)return Cn(t),null}else 2*Or()-i.renderingStartTime>Jc&&r!==1073741824&&(t.flags|=128,n=!0,Hu(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(r=i.last,r!==null?r.sibling=s:t.child=s,i.last=s)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Or(),t.sibling=null,r=pr.current,Qt(pr,n?r&1|2:r&1),t):(Cn(t),null);case 22:case 23:return Q1(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?va&1073741824&&(Cn(t),t.subtreeFlags&6&&(t.flags|=8192)):Cn(t),null;case 24:return null;case 25:return null}throw Error(Be(156,t.tag))}function f8(e,t){switch(D1(t),t.tag){case 1:return fa(t.type)&&Fh(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Xc(),ir(da),ir(Un),U1(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return $1(t),null;case 13:if(ir(pr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Be(340));Kc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ir(pr),null;case 4:return Xc(),null;case 10:return M1(t.type._context),null;case 22:case 23:return Q1(),null;case 24:return null;default:return null}}var E0=!1,Dn=!1,h8=typeof WeakSet=="function"?WeakSet:Set,et=null;function Cc(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){kr(e,t,n)}else r.current=null}function Uy(e,t,r){try{r()}catch(n){kr(e,t,n)}}var Ck=!1;function m8(e,t){if(Sy=Oh,e=AA(),P1(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var s=0,o=-1,c=-1,u=0,d=0,f=e,m=null;t:for(;;){for(var p;f!==r||a!==0&&f.nodeType!==3||(o=s+a),f!==i||n!==0&&f.nodeType!==3||(c=s+n),f.nodeType===3&&(s+=f.nodeValue.length),(p=f.firstChild)!==null;)m=f,f=p;for(;;){if(f===e)break t;if(m===r&&++u===a&&(o=s),m===i&&++d===n&&(c=s),(p=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=p}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(_y={focusedElem:e,selectionRange:r},Oh=!1,et=t;et!==null;)if(t=et,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,et=e;else for(;et!==null;){t=et;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var g=x.memoizedProps,y=x.memoizedState,v=t.stateNode,b=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:Ni(t.type,g),y);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Be(163))}}catch(k){kr(t,t.return,k)}if(e=t.sibling,e!==null){e.return=t.return,et=e;break}et=t.return}return x=Ck,Ck=!1,x}function bd(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&Uy(t,r,i)}a=a.next}while(a!==n)}}function dp(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function zy(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function ST(e){var t=e.alternate;t!==null&&(e.alternate=null,ST(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Vi],delete t[Hd],delete t[Ay],delete t[YM],delete t[JM])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function _T(e){return e.tag===5||e.tag===3||e.tag===4}function Ek(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||_T(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Hy(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Rh));else if(n!==4&&(e=e.child,e!==null))for(Hy(e,t,r),e=e.sibling;e!==null;)Hy(e,t,r),e=e.sibling}function Wy(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Wy(e,t,r),e=e.sibling;e!==null;)Wy(e,t,r),e=e.sibling}var mn=null,ki=!1;function Js(e,t,r){for(r=r.child;r!==null;)CT(e,t,r),r=r.sibling}function CT(e,t,r){if(Yi&&typeof Yi.onCommitFiberUnmount=="function")try{Yi.onCommitFiberUnmount(np,r)}catch{}switch(r.tag){case 5:Dn||Cc(r,t);case 6:var n=mn,a=ki;mn=null,Js(e,t,r),mn=n,ki=a,mn!==null&&(ki?(e=mn,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):mn.removeChild(r.stateNode));break;case 18:mn!==null&&(ki?(e=mn,r=r.stateNode,e.nodeType===8?ex(e.parentNode,r):e.nodeType===1&&ex(e,r),Bd(e)):ex(mn,r.stateNode));break;case 4:n=mn,a=ki,mn=r.stateNode.containerInfo,ki=!0,Js(e,t,r),mn=n,ki=a;break;case 0:case 11:case 14:case 15:if(!Dn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,s=i.destroy;i=i.tag,s!==void 0&&(i&2||i&4)&&Uy(r,t,s),a=a.next}while(a!==n)}Js(e,t,r);break;case 1:if(!Dn&&(Cc(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){kr(r,t,o)}Js(e,t,r);break;case 21:Js(e,t,r);break;case 22:r.mode&1?(Dn=(n=Dn)||r.memoizedState!==null,Js(e,t,r),Dn=n):Js(e,t,r);break;default:Js(e,t,r)}}function Ak(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new h8),t.forEach(function(n){var a=k8.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function bi(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,s=t,o=s;e:for(;o!==null;){switch(o.tag){case 5:mn=o.stateNode,ki=!1;break e;case 3:mn=o.stateNode.containerInfo,ki=!0;break e;case 4:mn=o.stateNode.containerInfo,ki=!0;break e}o=o.return}if(mn===null)throw Error(Be(160));CT(i,s,a),mn=null,ki=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(u){kr(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)ET(t,e),t=t.sibling}function ET(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(bi(t,e),ji(e),n&4){try{bd(3,e,e.return),dp(3,e)}catch(g){kr(e,e.return,g)}try{bd(5,e,e.return)}catch(g){kr(e,e.return,g)}}break;case 1:bi(t,e),ji(e),n&512&&r!==null&&Cc(r,r.return);break;case 5:if(bi(t,e),ji(e),n&512&&r!==null&&Cc(r,r.return),e.flags&32){var a=e.stateNode;try{Rd(a,"")}catch(g){kr(e,e.return,g)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,s=r!==null?r.memoizedProps:i,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&X4(a,i),my(o,s);var u=my(o,i);for(s=0;s<c.length;s+=2){var d=c[s],f=c[s+1];d==="style"?eA(a,f):d==="dangerouslySetInnerHTML"?Q4(a,f):d==="children"?Rd(a,f):x1(a,d,f,u)}switch(o){case"input":cy(a,i);break;case"textarea":Y4(a,i);break;case"select":var m=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?Ic(a,!!i.multiple,p,!1):m!==!!i.multiple&&(i.defaultValue!=null?Ic(a,!!i.multiple,i.defaultValue,!0):Ic(a,!!i.multiple,i.multiple?[]:"",!1))}a[Hd]=i}catch(g){kr(e,e.return,g)}}break;case 6:if(bi(t,e),ji(e),n&4){if(e.stateNode===null)throw Error(Be(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(g){kr(e,e.return,g)}}break;case 3:if(bi(t,e),ji(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Bd(t.containerInfo)}catch(g){kr(e,e.return,g)}break;case 4:bi(t,e),ji(e);break;case 13:bi(t,e),ji(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(Y1=Or())),n&4&&Ak(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Dn=(u=Dn)||d,bi(t,e),Dn=u):bi(t,e),ji(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(et=e,d=e.child;d!==null;){for(f=et=d;et!==null;){switch(m=et,p=m.child,m.tag){case 0:case 11:case 14:case 15:bd(4,m,m.return);break;case 1:Cc(m,m.return);var x=m.stateNode;if(typeof x.componentWillUnmount=="function"){n=m,r=m.return;try{t=n,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(g){kr(n,r,g)}}break;case 5:Cc(m,m.return);break;case 22:if(m.memoizedState!==null){Pk(f);continue}}p!==null?(p.return=m,et=p):Pk(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{a=f.stateNode,u?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=f.stateNode,c=f.memoizedProps.style,s=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=Z4("display",s))}catch(g){kr(e,e.return,g)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(g){kr(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:bi(t,e),ji(e),n&4&&Ak(e);break;case 21:break;default:bi(t,e),ji(e)}}function ji(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(_T(r)){var n=r;break e}r=r.return}throw Error(Be(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Rd(a,""),n.flags&=-33);var i=Ek(e);Wy(e,i,a);break;case 3:case 4:var s=n.stateNode.containerInfo,o=Ek(e);Hy(e,o,s);break;default:throw Error(Be(161))}}catch(c){kr(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function p8(e,t,r){et=e,AT(e)}function AT(e,t,r){for(var n=(e.mode&1)!==0;et!==null;){var a=et,i=a.child;if(a.tag===22&&n){var s=a.memoizedState!==null||E0;if(!s){var o=a.alternate,c=o!==null&&o.memoizedState!==null||Dn;o=E0;var u=Dn;if(E0=s,(Dn=c)&&!u)for(et=a;et!==null;)s=et,c=s.child,s.tag===22&&s.memoizedState!==null?Ok(a):c!==null?(c.return=s,et=c):Ok(a);for(;i!==null;)et=i,AT(i),i=i.sibling;et=a,E0=o,Dn=u}Tk(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,et=i):Tk(e)}}function Tk(e){for(;et!==null;){var t=et;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Dn||dp(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Dn)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Ni(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&hk(t,i,n);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}hk(t,s,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Bd(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Be(163))}Dn||t.flags&512&&zy(t)}catch(m){kr(t,t.return,m)}}if(t===e){et=null;break}if(r=t.sibling,r!==null){r.return=t.return,et=r;break}et=t.return}}function Pk(e){for(;et!==null;){var t=et;if(t===e){et=null;break}var r=t.sibling;if(r!==null){r.return=t.return,et=r;break}et=t.return}}function Ok(e){for(;et!==null;){var t=et;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{dp(4,t)}catch(c){kr(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(c){kr(t,a,c)}}var i=t.return;try{zy(t)}catch(c){kr(t,i,c)}break;case 5:var s=t.return;try{zy(t)}catch(c){kr(t,s,c)}}}catch(c){kr(t,t.return,c)}if(t===e){et=null;break}var o=t.sibling;if(o!==null){o.return=t.return,et=o;break}et=t.return}}var g8=Math.ceil,Gh=Us.ReactCurrentDispatcher,q1=Us.ReactCurrentOwner,oi=Us.ReactCurrentBatchConfig,Dt=0,un=null,$r=null,vn=0,va=0,Ec=Lo(0),Xr=0,Xd=null,_l=0,fp=0,X1=0,wd=null,oa=null,Y1=0,Jc=1/0,us=null,Vh=!1,Gy=null,vo=null,A0=!1,oo=null,Kh=0,Nd=0,Vy=null,ph=-1,gh=0;function Zn(){return Dt&6?Or():ph!==-1?ph:ph=Or()}function bo(e){return e.mode&1?Dt&2&&vn!==0?vn&-vn:ZM.transition!==null?(gh===0&&(gh=fA()),gh):(e=Wt,e!==0||(e=window.event,e=e===void 0?16:vA(e.type)),e):1}function Pi(e,t,r,n){if(50<Nd)throw Nd=0,Vy=null,Error(Be(185));_f(e,r,n),(!(Dt&2)||e!==un)&&(e===un&&(!(Dt&2)&&(fp|=r),Xr===4&&ao(e,vn)),ha(e,n),r===1&&Dt===0&&!(t.mode&1)&&(Jc=Or()+500,lp&&Bo()))}function ha(e,t){var r=e.callbackNode;ZF(e,t);var n=Ph(e,e===un?vn:0);if(n===0)r!==null&&$N(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&$N(r),t===1)e.tag===0?QM(Dk.bind(null,e)):BA(Dk.bind(null,e)),qM(function(){!(Dt&6)&&Bo()}),r=null;else{switch(hA(n)){case 1:r=N1;break;case 4:r=uA;break;case 16:r=Th;break;case 536870912:r=dA;break;default:r=Th}r=MT(r,TT.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function TT(e,t){if(ph=-1,gh=0,Dt&6)throw Error(Be(327));var r=e.callbackNode;if(Bc()&&e.callbackNode!==r)return null;var n=Ph(e,e===un?vn:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=qh(e,n);else{t=n;var a=Dt;Dt|=2;var i=OT();(un!==e||vn!==t)&&(us=null,Jc=Or()+500,dl(e,t));do try{v8();break}catch(o){PT(e,o)}while(1);F1(),Gh.current=i,Dt=a,$r!==null?t=0:(un=null,vn=0,t=Xr)}if(t!==0){if(t===2&&(a=vy(e),a!==0&&(n=a,t=Ky(e,a))),t===1)throw r=Xd,dl(e,0),ao(e,n),ha(e,Or()),r;if(t===6)ao(e,n);else{if(a=e.current.alternate,!(n&30)&&!x8(a)&&(t=qh(e,n),t===2&&(i=vy(e),i!==0&&(n=i,t=Ky(e,i))),t===1))throw r=Xd,dl(e,0),ao(e,n),ha(e,Or()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(Be(345));case 2:Jo(e,oa,us);break;case 3:if(ao(e,n),(n&130023424)===n&&(t=Y1+500-Or(),10<t)){if(Ph(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){Zn(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Ey(Jo.bind(null,e,oa,us),t);break}Jo(e,oa,us);break;case 4:if(ao(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var s=31-Ti(n);i=1<<s,s=t[s],s>a&&(a=s),n&=~i}if(n=a,n=Or()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*g8(n/1960))-n,10<n){e.timeoutHandle=Ey(Jo.bind(null,e,oa,us),n);break}Jo(e,oa,us);break;case 5:Jo(e,oa,us);break;default:throw Error(Be(329))}}}return ha(e,Or()),e.callbackNode===r?TT.bind(null,e):null}function Ky(e,t){var r=wd;return e.current.memoizedState.isDehydrated&&(dl(e,t).flags|=256),e=qh(e,t),e!==2&&(t=oa,oa=r,t!==null&&qy(t)),e}function qy(e){oa===null?oa=e:oa.push.apply(oa,e)}function x8(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!Mi(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ao(e,t){for(t&=~X1,t&=~fp,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Ti(t),n=1<<r;e[r]=-1,t&=~n}}function Dk(e){if(Dt&6)throw Error(Be(327));Bc();var t=Ph(e,0);if(!(t&1))return ha(e,Or()),null;var r=qh(e,t);if(e.tag!==0&&r===2){var n=vy(e);n!==0&&(t=n,r=Ky(e,n))}if(r===1)throw r=Xd,dl(e,0),ao(e,t),ha(e,Or()),r;if(r===6)throw Error(Be(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Jo(e,oa,us),ha(e,Or()),null}function J1(e,t){var r=Dt;Dt|=1;try{return e(t)}finally{Dt=r,Dt===0&&(Jc=Or()+500,lp&&Bo())}}function Cl(e){oo!==null&&oo.tag===0&&!(Dt&6)&&Bc();var t=Dt;Dt|=1;var r=oi.transition,n=Wt;try{if(oi.transition=null,Wt=1,e)return e()}finally{Wt=n,oi.transition=r,Dt=t,!(Dt&6)&&Bo()}}function Q1(){va=Ec.current,ir(Ec)}function dl(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,KM(r)),$r!==null)for(r=$r.return;r!==null;){var n=r;switch(D1(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Fh();break;case 3:Xc(),ir(da),ir(Un),U1();break;case 5:$1(n);break;case 4:Xc();break;case 13:ir(pr);break;case 19:ir(pr);break;case 10:M1(n.type._context);break;case 22:case 23:Q1()}r=r.return}if(un=e,$r=e=wo(e.current,null),vn=va=t,Xr=0,Xd=null,X1=fp=_l=0,oa=wd=null,al!==null){for(t=0;t<al.length;t++)if(r=al[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var s=i.next;i.next=a,n.next=s}r.pending=n}al=null}return e}function PT(e,t){do{var r=$r;try{if(F1(),fh.current=Wh,Hh){for(var n=vr.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Hh=!1}if(Sl=0,an=Vr=vr=null,vd=!1,Vd=0,q1.current=null,r===null||r.return===null){Xr=1,Xd=t,$r=null;break}e:{var i=e,s=r.return,o=r,c=t;if(t=vn,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=o,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=vk(s);if(p!==null){p.flags&=-257,bk(p,s,o,i,t),p.mode&1&&yk(i,u,t),t=p,c=u;var x=t.updateQueue;if(x===null){var g=new Set;g.add(c),t.updateQueue=g}else x.add(c);break e}else{if(!(t&1)){yk(i,u,t),Z1();break e}c=Error(Be(426))}}else if(cr&&o.mode&1){var y=vk(s);if(y!==null){!(y.flags&65536)&&(y.flags|=256),bk(y,s,o,i,t),I1(Yc(c,o));break e}}i=c=Yc(c,o),Xr!==4&&(Xr=2),wd===null?wd=[i]:wd.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var v=hT(i,c,t);fk(i,v);break e;case 1:o=c;var b=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(vo===null||!vo.has(w)))){i.flags|=65536,t&=-t,i.lanes|=t;var k=mT(i,o,t);fk(i,k);break e}}i=i.return}while(i!==null)}IT(r)}catch(S){t=S,$r===r&&r!==null&&($r=r=r.return);continue}break}while(1)}function OT(){var e=Gh.current;return Gh.current=Wh,e===null?Wh:e}function Z1(){(Xr===0||Xr===3||Xr===2)&&(Xr=4),un===null||!(_l&268435455)&&!(fp&268435455)||ao(un,vn)}function qh(e,t){var r=Dt;Dt|=2;var n=OT();(un!==e||vn!==t)&&(us=null,dl(e,t));do try{y8();break}catch(a){PT(e,a)}while(1);if(F1(),Dt=r,Gh.current=n,$r!==null)throw Error(Be(261));return un=null,vn=0,Xr}function y8(){for(;$r!==null;)DT($r)}function v8(){for(;$r!==null&&!WF();)DT($r)}function DT(e){var t=FT(e.alternate,e,va);e.memoizedProps=e.pendingProps,t===null?IT(e):$r=t,q1.current=null}function IT(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=f8(r,t),r!==null){r.flags&=32767,$r=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Xr=6,$r=null;return}}else if(r=d8(r,t,va),r!==null){$r=r;return}if(t=t.sibling,t!==null){$r=t;return}$r=t=e}while(t!==null);Xr===0&&(Xr=5)}function Jo(e,t,r){var n=Wt,a=oi.transition;try{oi.transition=null,Wt=1,b8(e,t,r,n)}finally{oi.transition=a,Wt=n}return null}function b8(e,t,r,n){do Bc();while(oo!==null);if(Dt&6)throw Error(Be(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Be(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(eM(e,i),e===un&&($r=un=null,vn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||A0||(A0=!0,MT(Th,function(){return Bc(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=oi.transition,oi.transition=null;var s=Wt;Wt=1;var o=Dt;Dt|=4,q1.current=null,m8(e,r),ET(r,e),$M(_y),Oh=!!Sy,_y=Sy=null,e.current=r,p8(r),GF(),Dt=o,Wt=s,oi.transition=i}else e.current=r;if(A0&&(A0=!1,oo=e,Kh=a),i=e.pendingLanes,i===0&&(vo=null),qF(r.stateNode),ha(e,Or()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Vh)throw Vh=!1,e=Gy,Gy=null,e;return Kh&1&&e.tag!==0&&Bc(),i=e.pendingLanes,i&1?e===Vy?Nd++:(Nd=0,Vy=e):Nd=0,Bo(),null}function Bc(){if(oo!==null){var e=hA(Kh),t=oi.transition,r=Wt;try{if(oi.transition=null,Wt=16>e?16:e,oo===null)var n=!1;else{if(e=oo,oo=null,Kh=0,Dt&6)throw Error(Be(331));var a=Dt;for(Dt|=4,et=e.current;et!==null;){var i=et,s=i.child;if(et.flags&16){var o=i.deletions;if(o!==null){for(var c=0;c<o.length;c++){var u=o[c];for(et=u;et!==null;){var d=et;switch(d.tag){case 0:case 11:case 15:bd(8,d,i)}var f=d.child;if(f!==null)f.return=d,et=f;else for(;et!==null;){d=et;var m=d.sibling,p=d.return;if(ST(d),d===u){et=null;break}if(m!==null){m.return=p,et=m;break}et=p}}}var x=i.alternate;if(x!==null){var g=x.child;if(g!==null){x.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}et=i}}if(i.subtreeFlags&2064&&s!==null)s.return=i,et=s;else e:for(;et!==null;){if(i=et,i.flags&2048)switch(i.tag){case 0:case 11:case 15:bd(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,et=v;break e}et=i.return}}var b=e.current;for(et=b;et!==null;){s=et;var w=s.child;if(s.subtreeFlags&2064&&w!==null)w.return=s,et=w;else e:for(s=b;et!==null;){if(o=et,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:dp(9,o)}}catch(S){kr(o,o.return,S)}if(o===s){et=null;break e}var k=o.sibling;if(k!==null){k.return=o.return,et=k;break e}et=o.return}}if(Dt=a,Bo(),Yi&&typeof Yi.onPostCommitFiberRoot=="function")try{Yi.onPostCommitFiberRoot(np,e)}catch{}n=!0}return n}finally{Wt=r,oi.transition=t}}return!1}function Ik(e,t,r){t=Yc(r,t),t=hT(e,t,1),e=yo(e,t,1),t=Zn(),e!==null&&(_f(e,1,t),ha(e,t))}function kr(e,t,r){if(e.tag===3)Ik(e,e,r);else for(;t!==null;){if(t.tag===3){Ik(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(vo===null||!vo.has(n))){e=Yc(r,e),e=mT(t,e,1),t=yo(t,e,1),e=Zn(),t!==null&&(_f(t,1,e),ha(t,e));break}}t=t.return}}function w8(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Zn(),e.pingedLanes|=e.suspendedLanes&r,un===e&&(vn&r)===r&&(Xr===4||Xr===3&&(vn&130023424)===vn&&500>Or()-Y1?dl(e,0):X1|=r),ha(e,t)}function RT(e,t){t===0&&(e.mode&1?(t=y0,y0<<=1,!(y0&130023424)&&(y0=4194304)):t=1);var r=Zn();e=Os(e,t),e!==null&&(_f(e,t,r),ha(e,r))}function N8(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),RT(e,r)}function k8(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Be(314))}n!==null&&n.delete(t),RT(e,r)}var FT;FT=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||da.current)la=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return la=!1,u8(e,t,r);la=!!(e.flags&131072)}else la=!1,cr&&t.flags&1048576&&jA(t,Bh,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;mh(e,t),e=t.pendingProps;var a=Vc(t,Un.current);Lc(t,r),a=H1(null,t,n,e,a,r);var i=W1();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,fa(n)?(i=!0,Mh(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,B1(t),a.updater=up,t.stateNode=a,a._reactInternals=t,Ry(t,n,e,r),t=Ly(null,t,n,!0,i,r)):(t.tag=0,cr&&i&&O1(t),Kn(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(mh(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=_8(n),e=Ni(n,e),a){case 0:t=My(null,t,n,e,r);break e;case 1:t=kk(null,t,n,e,r);break e;case 11:t=wk(null,t,n,e,r);break e;case 14:t=Nk(null,t,n,Ni(n.type,e),r);break e}throw Error(Be(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ni(n,a),My(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ni(n,a),kk(e,t,n,a,r);case 3:e:{if(yT(t),e===null)throw Error(Be(387));n=t.pendingProps,i=t.memoizedState,a=i.element,GA(e,t),Uh(t,n,null,r);var s=t.memoizedState;if(n=s.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=Yc(Error(Be(423)),t),t=Sk(e,t,n,r,a);break e}else if(n!==a){a=Yc(Error(Be(424)),t),t=Sk(e,t,n,r,a);break e}else for(Ea=xo(t.stateNode.containerInfo.firstChild),Pa=t,cr=!0,Si=null,r=HA(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Kc(),n===a){t=Ds(e,t,r);break e}Kn(e,t,n,r)}t=t.child}return t;case 5:return VA(t),e===null&&Oy(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,s=a.children,Cy(n,a)?s=null:i!==null&&Cy(n,i)&&(t.flags|=32),xT(e,t),Kn(e,t,s,r),t.child;case 6:return e===null&&Oy(t),null;case 13:return vT(e,t,r);case 4:return j1(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=qc(t,null,n,r):Kn(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ni(n,a),wk(e,t,n,a,r);case 7:return Kn(e,t,t.pendingProps,r),t.child;case 8:return Kn(e,t,t.pendingProps.children,r),t.child;case 12:return Kn(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,s=a.value,Qt(jh,n._currentValue),n._currentValue=s,i!==null)if(Mi(i.value,s)){if(i.children===a.children&&!da.current){t=Ds(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){s=i.child;for(var c=o.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=ks(-1,r&-r),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),Dy(i.return,r,t),o.lanes|=r;break}c=c.next}}else if(i.tag===10)s=i.type===t.type?null:i.child;else if(i.tag===18){if(s=i.return,s===null)throw Error(Be(341));s.lanes|=r,o=s.alternate,o!==null&&(o.lanes|=r),Dy(s,r,t),s=i.sibling}else s=i.child;if(s!==null)s.return=i;else for(s=i;s!==null;){if(s===t){s=null;break}if(i=s.sibling,i!==null){i.return=s.return,s=i;break}s=s.return}i=s}Kn(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,Lc(t,r),a=ci(a),n=n(a),t.flags|=1,Kn(e,t,n,r),t.child;case 14:return n=t.type,a=Ni(n,t.pendingProps),a=Ni(n.type,a),Nk(e,t,n,a,r);case 15:return pT(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ni(n,a),mh(e,t),t.tag=1,fa(n)?(e=!0,Mh(t)):e=!1,Lc(t,r),fT(t,n,a),Ry(t,n,a,r),Ly(null,t,n,!0,e,r);case 19:return bT(e,t,r);case 22:return gT(e,t,r)}throw Error(Be(156,t.tag))};function MT(e,t){return cA(e,t)}function S8(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ai(e,t,r,n){return new S8(e,t,r,n)}function eb(e){return e=e.prototype,!(!e||!e.isReactComponent)}function _8(e){if(typeof e=="function")return eb(e)?1:0;if(e!=null){if(e=e.$$typeof,e===v1)return 11;if(e===b1)return 14}return 2}function wo(e,t){var r=e.alternate;return r===null?(r=ai(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function xh(e,t,r,n,a,i){var s=2;if(n=e,typeof e=="function")eb(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case xc:return fl(r.children,a,i,t);case y1:s=8,a|=8;break;case ay:return e=ai(12,r,t,a|2),e.elementType=ay,e.lanes=i,e;case iy:return e=ai(13,r,t,a),e.elementType=iy,e.lanes=i,e;case sy:return e=ai(19,r,t,a),e.elementType=sy,e.lanes=i,e;case V4:return hp(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case W4:s=10;break e;case G4:s=9;break e;case v1:s=11;break e;case b1:s=14;break e;case Zs:s=16,n=null;break e}throw Error(Be(130,e==null?e:typeof e,""))}return t=ai(s,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function fl(e,t,r,n){return e=ai(7,e,n,t),e.lanes=r,e}function hp(e,t,r,n){return e=ai(22,e,n,t),e.elementType=V4,e.lanes=r,e.stateNode={isHidden:!1},e}function lx(e,t,r){return e=ai(6,e,null,t),e.lanes=r,e}function cx(e,t,r){return t=ai(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function C8(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Hg(0),this.expirationTimes=Hg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Hg(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function tb(e,t,r,n,a,i,s,o,c){return e=new C8(e,t,r,o,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=ai(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},B1(i),e}function E8(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:gc,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function LT(e){if(!e)return _o;e=e._reactInternals;e:{if(Vl(e)!==e||e.tag!==1)throw Error(Be(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(fa(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Be(171))}if(e.tag===1){var r=e.type;if(fa(r))return LA(e,r,t)}return t}function BT(e,t,r,n,a,i,s,o,c){return e=tb(r,n,!0,e,a,i,s,o,c),e.context=LT(null),r=e.current,n=Zn(),a=bo(r),i=ks(n,a),i.callback=t??null,yo(r,i,a),e.current.lanes=a,_f(e,a,n),ha(e,n),e}function mp(e,t,r,n){var a=t.current,i=Zn(),s=bo(a);return r=LT(r),t.context===null?t.context=r:t.pendingContext=r,t=ks(i,s),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=yo(a,t,s),e!==null&&(Pi(e,a,s,i),dh(e,a,s)),s}function Xh(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Rk(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function rb(e,t){Rk(e,t),(e=e.alternate)&&Rk(e,t)}function A8(){return null}var jT=typeof reportError=="function"?reportError:function(e){console.error(e)};function nb(e){this._internalRoot=e}pp.prototype.render=nb.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Be(409));mp(e,t,null,null)};pp.prototype.unmount=nb.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Cl(function(){mp(null,e,null,null)}),t[Ps]=null}};function pp(e){this._internalRoot=e}pp.prototype.unstable_scheduleHydration=function(e){if(e){var t=gA();e={blockedOn:null,target:e,priority:t};for(var r=0;r<no.length&&t!==0&&t<no[r].priority;r++);no.splice(r,0,e),r===0&&yA(e)}};function ab(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function gp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Fk(){}function T8(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var u=Xh(s);i.call(u)}}var s=BT(t,n,e,0,null,!1,!1,"",Fk);return e._reactRootContainer=s,e[Ps]=s.current,Ud(e.nodeType===8?e.parentNode:e),Cl(),s}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var u=Xh(c);o.call(u)}}var c=tb(e,0,!1,null,null,!1,!1,"",Fk);return e._reactRootContainer=c,e[Ps]=c.current,Ud(e.nodeType===8?e.parentNode:e),Cl(function(){mp(t,c,r,n)}),c}function xp(e,t,r,n,a){var i=r._reactRootContainer;if(i){var s=i;if(typeof a=="function"){var o=a;a=function(){var c=Xh(s);o.call(c)}}mp(t,s,e,a)}else s=T8(r,t,e,a,n);return Xh(s)}mA=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=od(t.pendingLanes);r!==0&&(k1(t,r|1),ha(t,Or()),!(Dt&6)&&(Jc=Or()+500,Bo()))}break;case 13:Cl(function(){var n=Os(e,1);if(n!==null){var a=Zn();Pi(n,e,1,a)}}),rb(e,1)}};S1=function(e){if(e.tag===13){var t=Os(e,134217728);if(t!==null){var r=Zn();Pi(t,e,134217728,r)}rb(e,134217728)}};pA=function(e){if(e.tag===13){var t=bo(e),r=Os(e,t);if(r!==null){var n=Zn();Pi(r,e,t,n)}rb(e,t)}};gA=function(){return Wt};xA=function(e,t){var r=Wt;try{return Wt=e,t()}finally{Wt=r}};gy=function(e,t,r){switch(t){case"input":if(cy(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=op(n);if(!a)throw Error(Be(90));q4(n),cy(n,a)}}}break;case"textarea":Y4(e,r);break;case"select":t=r.value,t!=null&&Ic(e,!!r.multiple,t,!1)}};nA=J1;aA=Cl;var P8={usingClientEntryPoint:!1,Events:[Ef,wc,op,tA,rA,J1]},Wu={findFiberByHostInstance:nl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},O8={bundleType:Wu.bundleType,version:Wu.version,rendererPackageName:Wu.rendererPackageName,rendererConfig:Wu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Us.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=oA(e),e===null?null:e.stateNode},findFiberByHostInstance:Wu.findFiberByHostInstance||A8,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var T0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!T0.isDisabled&&T0.supportsFiber)try{np=T0.inject(O8),Yi=T0}catch{}}ja.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P8;ja.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ab(t))throw Error(Be(200));return E8(e,t,null,r)};ja.createRoot=function(e,t){if(!ab(e))throw Error(Be(299));var r=!1,n="",a=jT;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=tb(e,1,!1,null,null,r,!1,n,a),e[Ps]=t.current,Ud(e.nodeType===8?e.parentNode:e),new nb(t)};ja.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Be(188)):(e=Object.keys(e).join(","),Error(Be(268,e)));return e=oA(t),e=e===null?null:e.stateNode,e};ja.flushSync=function(e){return Cl(e)};ja.hydrate=function(e,t,r){if(!gp(t))throw Error(Be(200));return xp(null,e,t,!0,r)};ja.hydrateRoot=function(e,t,r){if(!ab(e))throw Error(Be(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",s=jT;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=BT(t,null,e,1,r??null,a,!1,i,s),e[Ps]=t.current,Ud(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new pp(t)};ja.render=function(e,t,r){if(!gp(t))throw Error(Be(200));return xp(null,e,t,!1,r)};ja.unmountComponentAtNode=function(e){if(!gp(e))throw Error(Be(40));return e._reactRootContainer?(Cl(function(){xp(null,null,e,!1,function(){e._reactRootContainer=null,e[Ps]=null})}),!0):!1};ja.unstable_batchedUpdates=J1;ja.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!gp(r))throw Error(Be(200));if(e==null||e._reactInternals===void 0)throw Error(Be(38));return xp(e,t,r,!1,n)};ja.version="18.3.1-next-f1338f8080-20240426";function $T(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE($T)}catch(e){console.error(e)}}$T(),$4.exports=ja;var ib=$4.exports,Mk=ib;ry.createRoot=Mk.createRoot,ry.hydrateRoot=Mk.hydrateRoot;const ke=(()=>typeof import.meta<"u"&&{VITE_RECAPTCHA_SITE_KEY:"6LfVeQAsAAAAAMqw5OZ0mbNLGTBXtrWydNCW30VC",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}&&!1||typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"/api":"")(),D8=()=>{const e=typeof import.meta<"u"&&{VITE_RECAPTCHA_SITE_KEY:"6LfVeQAsAAAAAMqw5OZ0mbNLGTBXtrWydNCW30VC",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}&&!1,t=typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1");return!!(e||t)},An=(e,t={})=>{if(D8()){const r=`/api/${e}.php`;if(Object.keys(t).length===0)return r;const n=new URLSearchParams(t).toString();return`${r}?${n}`}else{const r=`/index.php?endpoint=${e}`;if(Object.keys(t).length===0)return r;const n=new URLSearchParams(t).toString();return`${r}&${n}`}};let P0=null,Xy=0,Gu=0;const I8=3,Lk=2e3,UT=e=>{try{const t=e.split(".")[1];if(!t)return 0;let r=t.replace(/-/g,"+").replace(/_/g,"/");for(;r.length%4;)r+="=";const n=JSON.parse(atob(r));return Number(n.exp||0)}catch{return 0}},R8=e=>{const t=UT(e);return t?Date.now()>=t*1e3-2*60*1e3:!1},F8=e=>{const t=UT(e);return t?Date.now()>=t*1e3:!0};async function M8(){const e=localStorage.getItem("refresh_token");if(!e)return console.log("No refresh token available"),null;if(F8(e))return console.log("Refresh token is expired"),localStorage.removeItem("token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),typeof window<"u"&&window.dispatchEvent&&window.dispatchEvent(new CustomEvent("auth:login-required")),null;try{console.log("Attempting token refresh...");const t=await fetch(`${ke}/index.php?endpoint=refresh`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({refresh_token:e})}),r=await t.json().catch(()=>({}));return t.ok&&r&&r.success&&r.token?(console.log("Token refresh successful"),localStorage.setItem("token",r.token),r.refresh_token&&localStorage.setItem("refresh_token",r.refresh_token),r.token):(console.log("Token refresh failed:",r.error||"Unknown error"),localStorage.removeItem("token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),typeof window<"u"&&window.dispatchEvent&&window.dispatchEvent(new CustomEvent("auth:login-required")),null)}catch(t){console.error("Token refresh error:",t),localStorage.removeItem("token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),typeof window<"u"&&window.dispatchEvent&&window.dispatchEvent(new CustomEvent("auth:login-required"))}return null}const gr=async(e=!1)=>{const t=localStorage.getItem("token");if(!e&&t&&!R8(t))return t;if(!t&&!localStorage.getItem("refresh_token"))return null;if(Gu>=I8)return localStorage.removeItem("token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),Gu=0,null;const r=Date.now();r-Xy<Lk&&Gu>0&&await new Promise(a=>setTimeout(a,Lk-(r-Xy))),P0||(Gu++,P0=M8().finally(()=>{setTimeout(()=>{P0=null},100)}));const n=await P0;return n?(Gu=0,n):null},tt=async(e,t={},r=!0)=>{const n=!!t.suppressUnauthorizedEvent;if("suppressUnauthorizedEvent"in t){const{suppressUnauthorizedEvent:u,...d}=t;t=d}let a=await gr(!1);if(!a)return console.warn("No valid token available for request to:",e),new Response(JSON.stringify({error:"No valid token available"}),{status:401,statusText:"Unauthorized",headers:{"Content-Type":"application/json"}});const i=u=>({...t,headers:{...t.headers||{},...u?{Authorization:`Bearer ${u}`,"X-Auth-Token":u,Accept:"application/json"}:{}}}),s=(u,d)=>{try{if(!d||typeof u=="string"&&u.includes("endpoint=refresh"))return u;if(typeof u=="string"&&(u.startsWith("/api")||u.includes("/api/")||u.startsWith("/backend/api")||u.includes("/backend/api/")||u.includes("/index.php?endpoint=")||u.includes("index.php?endpoint="))){const f=u.includes("?")?"&":"?";return`${u.replace(/[?&]token=[^&]*/g,"").replace(/\?$/,"")}${f}token=${encodeURIComponent(d)}`}}catch{}return u},o=s(e,a);let c=await fetch(o,i(a));if(c.status===401&&r){console.log("Received 401, attempting token refresh for:",e),Xy=Date.now();const u=await gr(!0);if(u&&u!==a){console.log("Got new token, retrying request");const d=s(e,u),f=await fetch(d,i(u));f.ok?(console.log("Retry successful with new token"),c=f):(console.log("Retry failed even with new token, status:",f.status),c=f)}else console.log("Token refresh failed or no new token available")}if(c.status===401&&(console.warn("Still unauthorized after refresh attempt for URL:",e),!n))try{typeof window<"u"&&window.dispatchEvent&&window.dispatchEvent(new CustomEvent("auth:unauthorized"))}catch{}return c},L8=async(e=5e3)=>{const t=Date.now();for(;Date.now()-t<e;){const r=await gr();if(r)return r;await new Promise(n=>setTimeout(n,100))}return null};var B8={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const j8=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),$8=(e,t)=>{const r=N.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:s,children:o,...c},u)=>N.createElement("svg",{ref:u,...B8,width:a,height:a,stroke:n,strokeWidth:s?Number(i)*24/Number(a):i,className:`lucide lucide-${j8(e)}`,...c},[...t.map(([d,f])=>N.createElement(d,f)),...(Array.isArray(o)?o:[o])||[]]));return r.displayName=`${e}`,r};var Xe=$8;const ts=Xe("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Fn=Xe("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),U8=Xe("Archive",[["rect",{width:"20",height:"5",x:"2",y:"4",rx:"2",key:"uhwcea"}],["path",{d:"M4 9v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9",key:"shkvi4"}],["path",{d:"M10 13h4",key:"ytezjc"}]]),Tf=Xe("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),Qi=Xe("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),Yh=Xe("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),No=Xe("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),Aa=Xe("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),z8=Xe("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),Yd=Xe("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),At=Xe("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),kd=Xe("CheckSquare",[["polyline",{points:"9 11 12 14 22 4",key:"19ybtz"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]),sb=Xe("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),Pf=Xe("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),ob=Xe("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),lb=Xe("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),cb=Xe("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),Co=Xe("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),H8=Xe("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]),Bk=Xe("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),Ra=Xe("Cpu",[["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"9",y:"9",width:"6",height:"6",key:"o3kz5p"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]),Ss=Xe("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),zT=Xe("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),hl=Xe("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),ys=Xe("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),W8=Xe("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),jk=Xe("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z",key:"nb9nel"}]]),Of=Xe("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]),G8=Xe("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),Yy=Xe("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),V8=Xe("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),Ac=Xe("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Jh=Xe("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),Qh=Xe("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),K8=Xe("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),q8=Xe("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),X8=Xe("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),Y8=Xe("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),sc=Xe("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),lo=Xe("MemoryStick",[["path",{d:"M6 19v-3",key:"1nvgqn"}],["path",{d:"M10 19v-3",key:"iu8nkm"}],["path",{d:"M14 19v-3",key:"kcehxu"}],["path",{d:"M18 19v-3",key:"1vh91z"}],["path",{d:"M8 11V9",key:"63erz4"}],["path",{d:"M16 11V9",key:"fru6f3"}],["path",{d:"M12 11V9",key:"ha00sb"}],["path",{d:"M2 15h20",key:"16ne18"}],["path",{d:"M2 7a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v1.1a2 2 0 0 0 0 3.837V17a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-5.1a2 2 0 0 0 0-3.837Z",key:"lhddv3"}]]),J8=Xe("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),Jy=Xe("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),ca=Xe("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),$k=Xe("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),Is=Xe("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),Q8=Xe("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),nt=Xe("Package",[["path",{d:"M16.5 9.4 7.55 4.24",key:"10qotr"}],["path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z",key:"yt0hxn"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]),Oi=Xe("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),Z8=Xe("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),eL=Xe("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),Uk=Xe("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]),wn=Xe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),O0=Xe("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),tL=Xe("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]),rL=Xe("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),yh=Xe("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),Di=Xe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),yu=Xe("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),ub=Xe("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]),db=Xe("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Zh=Xe("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),Ta=Xe("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]),vs=Xe("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),nL=Xe("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),aL=Xe("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),HT=Xe("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Rs=Xe("Thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]),Hr=Xe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Qc=Xe("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),iL=Xe("Truck",[["path",{d:"M10 17h4V5H2v12h3",key:"1jq12e"}],["path",{d:"M20 17h2v-3.34a4 4 0 0 0-1.17-2.83L19 9h-5",key:"1xb3ft"}],["path",{d:"M14 17h1",key:"nufu4t"}],["circle",{cx:"7.5",cy:"17.5",r:"2.5",key:"a7aife"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]),WT=Xe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),zk=Xe("User2",[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 1 0-16 0",key:"199sx2"}]]),Hk=Xe("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),sL=Xe("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),sl=Xe("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Df=Xe("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Wk=Xe("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]),ka=Xe("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),oL=Xe("XOctagon",[["polygon",{points:"7.86 2 16.14 2 22 7.86 22 16.14 16.14 22 7.86 22 2 16.14 2 7.86 7.86 2",key:"h1p8hx"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Yr=Xe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),rs=Xe("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),GT=N.createContext(),yp=()=>{const e=N.useContext(GT);if(!e)throw new Error("useNotifications must be used within a NotificationProvider");return e},lL=({children:e,user:t})=>{const[r,n]=N.useState([]),[a,i]=N.useState(0),[s,o]=N.useState(!1),c=N.useRef(null),u=b=>!!(b&&b.id);N.useEffect(()=>{if(t&&t.id&&u(t)){d(),f();const b=setInterval(()=>{d()},3e4),w=setInterval(()=>{f()},6e4);return()=>{b&&clearInterval(b),w&&clearInterval(w)}}else n([]),i(0),c.current&&(clearInterval(c.current),c.current=null)},[t]),N.useEffect(()=>{const b=()=>{n([]),i(0),c.current&&(clearInterval(c.current),c.current=null)};return window.addEventListener("auth:login-required",b),window.addEventListener("auth:unauthorized",b),()=>{window.removeEventListener("auth:login-required",b),window.removeEventListener("auth:unauthorized",b)}},[]);const d=async()=>{if(!(!t||!t.id||!u(t))){o(!0);try{if(!await gr(!1)){n([]),i(0),c.current&&(clearInterval(c.current),c.current=null),o(!1);return}const w=await tt(`${ke}/index.php?endpoint=notifications`,{method:"GET",suppressUnauthorizedEvent:!0});if(w.status===401){n([]),i(0),c.current&&(clearInterval(c.current),c.current=null),o(!1);return}if(w.ok){const k=await w.json();if(k.success){const _=(k.data||[]).filter(C=>C&&C.id&&C.id!==null&&C.id!==void 0&&C.id>0).map(C=>({...C,timestamp:new Date(C.timestamp)}));n(_)}}else console.warn("NotificationContext: Unexpected response status:",w.status)}catch(b){console.error("Error loading notifications:",b)}finally{o(!1)}}},f=async()=>{if(!(!t||!t.id||!u(t)))try{if(!await gr(!1)){n([]),i(0);return}const w=await tt(`${ke}/index.php?endpoint=notifications&count=1`,{method:"GET",suppressUnauthorizedEvent:!0});if(w.status===401){console.log("NotificationContext: 401 error, stopping polling"),c.current&&(clearInterval(c.current),c.current=null);return}if(w.ok){const k=await w.json();k.success&&i(k.count)}else console.warn("NotificationContext: Unexpected response status:",w.status)}catch(b){console.error("Error loading unread count:",b)}},v={notifications:r,unreadCount:a,loading:s,markAsRead:async b=>{if(!(!t||!t.id||!u(t)))try{if(!await gr(!1))return;const k=await tt(`${ke}/index.php?endpoint=notifications`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({notification_id:b}),suppressUnauthorizedEvent:!0});if(k.status===401)return;k.ok&&(await k.json()).success&&(n(_=>_.map(C=>C.id===b?{...C,read:!0}:C)),i(_=>Math.max(0,_-1)))}catch(w){console.error("Error marking notification as read:",w)}},markAllAsRead:async()=>{if(!(!t||!t.id||!u(t)))try{if(!await gr(!1))return;const w=await tt(`${ke}/index.php?endpoint=notifications&action=mark-all-read`,{method:"PUT",suppressUnauthorizedEvent:!0});if(w.status===401)return;w.ok&&(await w.json()).success&&(n(S=>S.map(_=>({..._,read:!0}))),i(0))}catch(b){console.error("Error marking all notifications as read:",b)}},deleteNotification:async b=>{if(!(!t||!t.id||!u(t))){if(!b||b===null||b===void 0||b===0){console.error("Invalid notification ID:",b);return}try{if(!await gr(!1))return;const k=await tt(`${ke}/index.php?endpoint=notifications`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({notification_id:Number(b)}),suppressUnauthorizedEvent:!0});if(k.status===401)return;if(k.ok){const S=await k.json();if(S.success){const _=r.find(C=>C.id===b);n(C=>C.filter(E=>E&&E.id&&E.id!==b)),_&&!_.read&&i(C=>Math.max(0,C-1)),f()}else console.error("Failed to delete notification:",S.error||"Unknown error")}else{const S=await k.json().catch(()=>({error:"Unknown error"}));console.error("Error deleting notification:",k.status,S)}}catch(w){console.error("Error deleting notification:",w)}}},addNotification:b=>{const w={id:Date.now(),timestamp:new Date,read:!1,...b};n(k=>[w,...k]),i(k=>k+1)},loadNotifications:d,loadUnreadCount:f,deleteAllNotifications:async()=>{if(!(!t||!t.id||!u(t)))try{if(!await gr(!1))return;const w=await tt(`${ke}/index.php?endpoint=notifications&all=1`,{method:"DELETE",headers:{"Content-Type":"application/json"},suppressUnauthorizedEvent:!0});if(w.status===401)return;w.ok&&(n([]),i(0))}catch(b){console.error("Error deleting all notifications:",b)}}};return l(GT.Provider,{value:v,children:e})},cL=({currentPage:e,onPageChange:t,user:r,onLogout:n,onSuperAdminTabChange:a,activeSuperAdminTab:i,notificationsCount:s,isCollapsed:o,onToggleCollapse:c})=>{var y,v,b,w,k,S,_,C,E;const u=A=>{try{A&&A.preventDefault&&A.preventDefault()}catch{}if(typeof n=="function")n();else{try{localStorage.removeItem("token")}catch{}try{sessionStorage&&sessionStorage.clear&&sessionStorage.clear()}catch{}try{window.location.reload()}catch{}}},d=()=>{if(!(r!=null&&r.roles))return"User";const A=Array.isArray(r.roles)?r.roles:typeof r.roles=="string"?r.roles.split(",").map(D=>D.trim()).filter(D=>D.length>0):[];return[...new Set(A)].join(", ")},f=()=>{if(!(r!=null&&r.roles))return"bg-gray-500";const A=Array.isArray(r.roles)?r.roles:typeof r.roles=="string"?r.roles.split(",").map(T=>T.trim()).filter(T=>T.length>0):[];return A.includes("Super Admin")||A.includes("Admin")||A.includes("Employee"),"bg-green-500"};console.log("âš ï¸ ADMINSIDEBAR LOADED - This should NOT show for Super Admin users!"),console.log("AdminSidebar - User object:",r),console.log("AdminSidebar - User roles:",r==null?void 0:r.roles),console.log("AdminSidebar - Is Super Admin:",(y=r==null?void 0:r.roles)==null?void 0:y.includes("Super Admin")),console.log("AdminSidebar - Is Admin:",(v=r==null?void 0:r.roles)==null?void 0:v.includes("Admin")),console.log("AdminSidebar - Admin condition result:",((b=r==null?void 0:r.roles)==null?void 0:b.includes("Admin"))&&!((w=r==null?void 0:r.roles)!=null&&w.includes("Super Admin"))),(k=r==null?void 0:r.roles)!=null&&k.includes("Super Admin")&&((S=r==null?void 0:r.roles)!=null&&S.includes("Admin"))&&console.warn("Super Admin user has both Super Admin and Admin roles - this indicates an old token. Please log out and log back in.");const m=[{id:"dashboard",name:"Dashboard",icon:l(No,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"notifications",name:"Notifications",icon:l(Aa,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"system-reports",name:"Sales Reports",icon:l(ys,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"inventory",name:"Inventory",icon:l(nt,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"orders-management",name:"Orders",icon:l(ys,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"pc-assembly",name:"PC Assembly",icon:l(Ra,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"prebuilt-management",name:"Prebuilt",icon:l(Is,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})}],x=[{id:"dashboard",name:"Dashboard",icon:l(No,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"notifications",name:"Notifications",icon:l(Aa,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"system-reports",name:"Sales Reports",icon:l(ys,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"inventory",name:"Inventory",icon:l(nt,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"orders-management",name:"Orders",icon:l(ys,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"pc-assembly",name:"PC Assembly",icon:l(Ra,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"prebuilt-management",name:"Prebuilt",icon:l(Is,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"admin-chat-support",name:"Chat Support",icon:l(ca,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})}].map(A=>{var D;let T=!1;return(D=r==null?void 0:r.roles)!=null&&D.includes("Super Admin")||(A.id==="inventory"?T=Number(r==null?void 0:r.can_access_inventory)!==1:A.id==="orders-management"?T=Number(r==null?void 0:r.can_access_orders)!==1:A.id==="admin-chat-support"&&(T=Number(r==null?void 0:r.can_access_chat_support)!==1)),{...A,isDisabled:T}}),g=(A,T)=>{if(T){let D="";A==="inventory"?D="Your access to Inventory Management has been disabled by a Super Admin.":A==="orders-management"?D="Your access to Orders Management has been disabled by a Super Admin.":A==="admin-chat-support"&&(D="Your access to Chat Support has been disabled by a Super Admin."),alert(D);return}t(A==="dashboard"?"admin-dashboard":A)};return l(gt,{children:h("div",{className:`
        sticky top-0 z-40
        bg-white shadow-lg flex flex-col h-screen flex-shrink-0 relative
        ${o?"w-[88px] xl:w-[104px]":"w-[288px] xl:w-[320px]"}
        transition-[width] duration-300 ease-in-out
      `,children:[l("div",{className:`absolute ${o?"top-1/2 -translate-y-1/2":"top-4"} right-2 lg:right-3 z-50 transition-all`,children:l("button",{onClick:c,className:"bg-white p-2 rounded-md shadow-lg border",title:o?"Expand sidebar":"Collapse sidebar","aria-label":o?"Expand sidebar":"Collapse sidebar",children:o?l(lb,{className:"h-5 w-5"}):l(ob,{className:"h-5 w-5"})})}),l("div",{className:"p-4 lg:p-6 border-b border-gray-200",children:h("div",{className:"flex items-center space-x-3",children:[l("div",{className:"w-8 h-8 lg:w-10 lg:h-10 bg-green-600 rounded-lg flex items-center justify-center",children:l("svg",{className:"w-5 h-5 lg:w-6 lg:h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})})}),!o&&h("div",{children:[l("h1",{className:"text-lg lg:text-xl font-bold text-gray-900",children:"SIMS"}),l("p",{className:"text-xs lg:text-sm text-gray-500",children:"PC Building Platform"})]})]})}),r&&l("div",{className:"p-3 lg:p-4 border-b border-gray-200",children:h("div",{className:"flex items-center space-x-3",children:[l("div",{className:"w-8 h-8 lg:w-10 lg:h-10 bg-gray-300 rounded-full flex items-center justify-center",children:r!=null&&r.profile_image?l("img",{src:r.profile_image,alt:"Profile",className:"w-8 h-8 lg:w-10 lg:h-10 rounded-full object-cover"}):l("svg",{className:"w-4 h-4 lg:w-6 lg:h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),!o&&h("div",{className:"flex-1 min-w-0",children:[h("p",{className:"text-xs lg:text-sm font-medium text-gray-900 truncate",children:[r==null?void 0:r.first_name," ",r==null?void 0:r.last_name]}),h("p",{className:"text-xs text-gray-500 truncate",children:["@",r==null?void 0:r.username]}),l("div",{className:"flex items-center mt-1",children:l("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium text-white ${f()}`,children:d()})})]})]})}),h("nav",{className:"flex-1 p-3 lg:p-4 space-y-1 lg:space-y-2 overflow-y-auto max-h-[calc(100vh-200px)]",children:[((_=r==null?void 0:r.roles)==null?void 0:_.includes("Super Admin"))&&h(gt,{children:[!o&&l("div",{className:"pt-2 lg:pt-4 border-t border-gray-200",children:l("h3",{className:"px-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Super Admin"})}),m.map(A=>h("button",{onClick:()=>{a(A.id)},className:`w-full flex items-center px-3 lg:px-5 py-2 text-xs lg:text-sm font-medium rounded-md transition-colors ${o?"justify-center":"truncate"} ${e==="super-admin-dashboard"&&i===A.id||e===A.id?"bg-green-100 text-green-700":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,title:A.name,"aria-label":A.name,children:[A.icon,!o&&A.name,!o&&A.id==="notifications"&&typeof s<"u"&&s>0&&l("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-green-600 rounded-full",children:s})]},A.id))]}),(()=>{var D,I;const A=(D=r==null?void 0:r.roles)==null?void 0:D.includes("Admin"),T=(I=r==null?void 0:r.roles)==null?void 0:I.includes("Super Admin");return console.log("AdminSidebar - isAdmin:",A,"isSuperAdmin:",T,"shouldShowAdminNav:",A&&!T),A&&!T})()&&h(gt,{children:[!o&&l("div",{className:"pt-2 lg:pt-4 border-t border-gray-200",children:l("h3",{className:"px-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Admin"})}),x.map(A=>h("button",{onClick:()=>g(A.id,A.isDisabled),disabled:A.isDisabled,className:`w-full flex items-center px-3 lg:px-5 py-2 text-xs lg:text-sm font-medium rounded-md transition-colors ${o?"justify-center":"truncate"} ${A.id==="dashboard"&&e==="admin-dashboard"||e===A.id?"bg-green-100 text-green-700":A.isDisabled?"text-gray-400 cursor-not-allowed opacity-60 bg-gray-50 border border-gray-200":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,title:A.isDisabled?"Access disabled by Super Admin":A.name,"aria-label":A.name,children:[A.icon,!o&&l("span",{className:"flex-1 text-left",children:A.name}),!o&&A.isDisabled&&l(Qh,{className:"ml-2 h-4 w-4 text-gray-400"}),!o&&A.id==="notifications"&&typeof s<"u"&&s>0&&l("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-green-600 rounded-full",children:s})]},A.id))]}),((C=r==null?void 0:r.roles)==null?void 0:C.includes("Employee"))&&!((E=r==null?void 0:r.roles)!=null&&E.includes("Admin"))&&h(gt,{children:[!o&&l("div",{className:"pt-2 lg:pt-4 border-t border-gray-200",children:l("h3",{className:"px-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Employee"})}),x.map(A=>h("button",{onClick:()=>g(A.id,A.isDisabled),disabled:A.isDisabled,className:`w-full flex items-center px-3 lg:px-5 py-2 text-xs lg:text-sm font-medium rounded-md transition-colors ${o?"justify-center":"truncate"} ${A.id==="dashboard"&&e==="admin-dashboard"||e===A.id?"bg-green-100 text-green-700":A.isDisabled?"text-gray-400 cursor-not-allowed opacity-60 bg-gray-50 border border-gray-200":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,title:A.isDisabled?"Access disabled by Super Admin":A.name,"aria-label":A.name,children:[A.icon,!o&&l("span",{className:"flex-1 text-left",children:A.name}),!o&&A.isDisabled&&l(Qh,{className:"ml-2 h-4 w-4 text-gray-400"}),!o&&A.id==="notifications"&&typeof s<"u"&&s>0&&l("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-green-600 rounded-full",children:s})]},A.id))]})]}),l("div",{className:"p-3 lg:p-4 border-t border-gray-200",children:h("button",{type:"button",onClick:u,onKeyDown:A=>{(A.key==="Enter"||A.key===" ")&&u(A)},className:`w-full flex items-center ${o?"justify-center":"justify-center gap-2"} px-4 py-2 text-white bg-red-600 hover:bg-red-700 rounded-xl shadow-lg font-semibold transition-colors duration-200`,children:[l("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),!o&&"Logout"]})})]})})},uL=({currentPage:e,onPageChange:t,user:r,onLogout:n,onSuperAdminTabChange:a,activeSuperAdminTab:i,notificationsCount:s,chatUnreadCount:o=0,isCollapsed:c,onToggleCollapse:u})=>{var x,g;const d=y=>{try{y&&y.preventDefault&&y.preventDefault()}catch{}if(typeof n=="function")n();else{try{localStorage.removeItem("token")}catch{}try{sessionStorage&&sessionStorage.clear&&sessionStorage.clear()}catch{}try{window.location.reload()}catch{}}},f=()=>{if(!(r!=null&&r.roles))return"User";const y=Array.isArray(r.roles)?r.roles:typeof r.roles=="string"?r.roles.split(",").map(b=>b.trim()).filter(b=>b.length>0):[];return[...new Set(y)].join(", ")},m=()=>{if(!(r!=null&&r.roles))return"bg-gray-500";const y=Array.isArray(r.roles)?r.roles:typeof r.roles=="string"?r.roles.split(",").map(v=>v.trim()).filter(v=>v.length>0):[];return y.includes("Super Admin")||y.includes("Admin")||y.includes("Employee"),"bg-green-500"};console.log("ðŸš€ SUPERADMINSIDEBAR LOADED - This should show for Super Admin users only!"),console.log("SuperAdminSidebar - User object:",r),console.log("SuperAdminSidebar - User roles:",r==null?void 0:r.roles),console.log("SuperAdminSidebar - Is Super Admin:",(x=r==null?void 0:r.roles)==null?void 0:x.includes("Super Admin"));const p=[{id:"dashboard",name:"Dashboard",icon:l(No,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"notifications",name:"Notifications",icon:l(Aa,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"system-reports",name:"Sales Reports",icon:l(ys,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"inventory",name:"Inventory",icon:l(nt,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"orders-management",name:"Orders",icon:l(ys,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"pc-assembly",name:"PC Assembly",icon:l(Ra,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"prebuilt-management",name:"Prebuilt",icon:l(Is,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"admin-chat-support",name:"Chat Support",icon:l(ca,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"user-management",name:"User",icon:l(Df,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})}];return l(gt,{children:h("div",{className:`
        sticky top-0 z-40
        bg-white shadow-lg flex flex-col h-screen flex-shrink-0 relative
        ${c?"w-[88px] xl:w-[104px]":"w-[288px] xl:w-[320px]"}
        transition-[width] duration-300 ease-in-out
      `,children:[l("div",{className:`absolute ${c?"top-1/2 -translate-y-1/2":"top-4"} right-2 lg:right-3 z-50 transition-all`,children:l("button",{onClick:u,className:"bg-white p-2 rounded-md shadow-lg border",title:c?"Expand sidebar":"Collapse sidebar","aria-label":c?"Expand sidebar":"Collapse sidebar",children:c?l(lb,{className:"h-5 w-5"}):l(ob,{className:"h-5 w-5"})})}),l("div",{className:"p-4 lg:p-6 border-b border-gray-200",children:h("div",{className:"flex items-center space-x-3",children:[l("div",{className:"w-8 h-8 lg:w-10 lg:h-10 bg-green-600 rounded-lg flex items-center justify-center",children:l("svg",{className:"w-5 h-5 lg:w-6 lg:h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})})}),!c&&h("div",{children:[l("h1",{className:"text-lg lg:text-xl font-bold text-gray-900",children:"SIMS"}),l("p",{className:"text-xs lg:text-sm text-gray-500",children:"PC Building Platform"})]})]})}),r&&l("div",{className:"p-3 lg:p-4 border-b border-gray-200",children:h("div",{className:"flex items-center space-x-3",children:[l("div",{className:"w-8 h-8 lg:w-10 lg:h-10 bg-gray-300 rounded-full flex items-center justify-center",children:r!=null&&r.profile_image?l("img",{src:r.profile_image,alt:"Profile",className:"w-8 h-8 lg:w-10 lg:h-10 rounded-full object-cover"}):l("svg",{className:"w-4 h-4 lg:w-6 lg:h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),!c&&h("div",{className:"flex-1 min-w-0",children:[h("p",{className:"text-xs lg:text-sm font-medium text-gray-900 truncate",children:[r==null?void 0:r.first_name," ",r==null?void 0:r.last_name]}),h("p",{className:"text-xs text-gray-500 truncate",children:["@",r==null?void 0:r.username]}),l("div",{className:"flex items-center mt-1",children:l("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium text-white ${m()}`,children:f()})})]})]})}),l("nav",{className:"flex-1 p-3 lg:p-4 space-y-1 lg:space-y-2 overflow-y-auto max-h-[calc(100vh-200px)]",children:((g=r==null?void 0:r.roles)==null?void 0:g.includes("Super Admin"))&&h(gt,{children:[!c&&l("div",{className:"pt-2 lg:pt-4 border-t border-gray-200",children:l("h3",{className:"px-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Super Admin"})}),p.map(y=>{const b=["admin-chat-support","inventory","orders-management","pc-assembly","prebuilt-management","system-reports","notifications","user-management"].includes(y.id);return h("button",{onClick:()=>{b?t(y.id):a(y.id)},className:`w-full flex items-center px-3 lg:px-5 py-2 text-xs lg:text-sm font-medium rounded-md transition-colors ${c?"justify-center":"truncate"} ${e==="super-admin-dashboard"&&i===y.id||e===y.id?"bg-green-100 text-green-700":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,title:y.name,"aria-label":y.name,children:[y.icon,!c&&y.name,!c&&y.id==="notifications"&&typeof s<"u"&&s>0&&l("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-green-600 rounded-full",children:s}),null]},y.id)})]})}),l("div",{className:"p-3 lg:p-4 border-t border-gray-200",children:h("button",{type:"button",onClick:d,onKeyDown:y=>{(y.key==="Enter"||y.key===" ")&&d(y)},className:`w-full flex items-center ${c?"justify-center":"justify-center gap-2"} px-4 py-2 text-white bg-red-600 hover:bg-red-700 rounded-xl shadow-lg font-semibold transition-colors duration-200`,children:[l("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),!c&&"Logout"]})})]})})},dL=({currentPage:e,onPageChange:t,user:r,onLogout:n,isCollapsed:a,onToggleCollapse:i})=>{const s=m=>{try{m&&m.preventDefault&&m.preventDefault()}catch{}if(!(typeof window<"u")||window.confirm("Are you sure you want to logout?"))if(typeof n=="function")n();else{try{localStorage.removeItem("token")}catch{}try{sessionStorage&&sessionStorage.clear&&sessionStorage.clear()}catch{}try{window.location.reload()}catch{}}},o=()=>{if(!(r!=null&&r.roles))return"User";const m=Array.isArray(r.roles)?r.roles:typeof r.roles=="string"?r.roles.split(",").map(x=>x.trim()).filter(x=>x.length>0):[];return[...new Set(m)].join(", ")},c=()=>{if(!(r!=null&&r.roles))return"bg-gray-500";const m=Array.isArray(r.roles)?r.roles:typeof r.roles=="string"?r.roles.split(",").map(p=>p.trim()).filter(p=>p.length>0):[];return m.includes("Super Admin")||m.includes("Admin")||m.includes("Employee"),"bg-green-500"},d=[{id:"employee-dashboard",name:"Dashboard",icon:l(No,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"notifications",name:"Notifications",icon:l(Aa,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"system-reports",name:"Sales Reports",icon:l(ys,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"inventory",name:"Inventory",icon:l(nt,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"orders-management",name:"Orders",icon:l(ys,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"pc-assembly",name:"PC Assembly",icon:l(Ra,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"prebuilt-management",name:"Prebuilt",icon:l(Is,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})},{id:"admin-chat-support",name:"Chat Support",icon:l(ca,{className:"mr-3 h-4 w-4 lg:h-5 lg:w-5"})}].map(m=>{let p=!1;return m.id==="inventory"?p=Number(r==null?void 0:r.can_access_inventory)!==1:m.id==="orders-management"?p=Number(r==null?void 0:r.can_access_orders)!==1:m.id==="admin-chat-support"&&(p=Number(r==null?void 0:r.can_access_chat_support)!==1),{...m,isDisabled:p}}),f=(m,p)=>{if(p){let x="";m==="inventory"?x="Your access to Inventory Management has been disabled by a Super Admin.":m==="orders-management"?x="Your access to Orders Management has been disabled by a Super Admin.":m==="admin-chat-support"&&(x="Your access to Chat Support has been disabled by a Super Admin."),alert(x);return}t(m)};return l(gt,{children:h("div",{className:`
        sticky top-0 z-40
        bg-white shadow-lg flex flex-col h-screen flex-shrink-0 relative
        ${a?"w-[88px] xl:w-[104px]":"w-[288px] xl:w-[320px]"}
        transition-[width] duration-300 ease-in-out
      `,children:[l("div",{className:`absolute ${a?"top-1/2 -translate-y-1/2":"top-4"} right-2 lg:right-3 z-50 transition-all`,children:l("button",{onClick:i,className:"bg-white p-2 rounded-md shadow-lg border",title:a?"Expand sidebar":"Collapse sidebar","aria-label":a?"Expand sidebar":"Collapse sidebar",children:a?l(lb,{className:"h-5 w-5"}):l(ob,{className:"h-5 w-5"})})}),l("div",{className:"p-4 lg:p-6 border-b border-gray-200",children:h("div",{className:"flex items-center space-x-3",children:[l("div",{className:"w-8 h-8 lg:w-10 lg:h-10 bg-green-600 rounded-lg flex items-center justify-center",children:l("svg",{className:"w-5 h-5 lg:w-6 lg:h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})})}),!a&&h("div",{children:[l("h1",{className:"text-lg lg:text-xl font-bold text-gray-900",children:"SIMS"}),l("p",{className:"text-xs lg:text-sm text-gray-500",children:"PC Building Platform"})]})]})}),r&&l("div",{className:"p-3 lg:p-4 border-b border-gray-200",children:h("div",{className:"flex items-center space-x-3",children:[l("div",{className:"w-8 h-8 lg:w-10 lg:h-10 bg-gray-300 rounded-full flex items-center justify-center",children:r!=null&&r.profile_image?l("img",{src:r.profile_image,alt:"Profile",className:"w-8 h-8 lg:w-10 lg:h-10 rounded-full object-cover"}):l("svg",{className:"w-4 h-4 lg:w-6 lg:h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),!a&&h("div",{className:"flex-1 min-w-0",children:[h("p",{className:"text-xs lg:text-sm font-medium text-gray-900 truncate",children:[r==null?void 0:r.first_name," ",r==null?void 0:r.last_name]}),h("p",{className:"text-xs text-gray-500 truncate",children:["@",r==null?void 0:r.username]}),l("div",{className:"flex items-center mt-1",children:l("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium text-white ${c()}`,children:o()})})]})]})}),h("nav",{className:"flex-1 p-3 lg:p-4 space-y-1 lg:space-y-2 overflow-y-auto max-h-[calc(100vh-200px)]",children:[!a&&l("div",{className:"pt-2 lg:pt-4 border-t border-gray-200",children:l("h3",{className:"px-3 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Employee"})}),d.map(m=>h("button",{onClick:()=>f(m.id,m.isDisabled),disabled:m.isDisabled,className:`w-full flex items-center px-3 lg:px-5 py-2 text-xs lg:text-sm font-medium rounded-md transition-colors ${a?"justify-center":"truncate"} ${m.isDisabled?"text-gray-400 cursor-not-allowed opacity-60 bg-gray-50 border border-gray-200":e===m.id?"bg-green-100 text-green-700":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,title:m.isDisabled?"Access disabled by Super Admin":m.name,"aria-label":m.name,children:[m.icon,!a&&l("span",{className:"flex-1 text-left",children:m.name}),!a&&m.isDisabled&&l(Qh,{className:"ml-2 h-4 w-4 text-gray-400"})]},m.id))]}),l("div",{className:"p-3 lg:p-4 border-t border-gray-200",children:h("button",{type:"button",onClick:s,onKeyDown:m=>{(m.key==="Enter"||m.key===" ")&&s(m)},className:`w-full flex items-center ${a?"justify-center":"justify-center gap-2"} px-4 py-2 text-white bg-red-600 hover:bg-red-700 rounded-xl shadow-lg font-semibold transition-colors duration-200`,children:[l("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),!a&&"Logout"]})})]})})},fL=({currentPage:e,onPageChange:t,user:r,onLogout:n,onSuperAdminTabChange:a,activeSuperAdminTab:i})=>{const[s,o]=N.useState(!1),[c,u]=N.useState(!1),[d,f]=N.useState(0);let m=0;try{const{unreadCount:w}=yp();m=w||0}catch{m=0}N.useEffect(()=>{const w=async()=>{if(!r){f(0);return}try{const S=localStorage.getItem("token");if(!S){f(0);return}const _=await fetch(`${ke}/index.php?endpoint=cart&count`,{method:"GET",headers:{Authorization:`Bearer ${S}`}});if(_.ok){const C=await _.json();C&&C.success&&f(C.total_items||0)}}catch(S){console.error("Error fetching cart count:",S)}};w();const k=setInterval(w,3e4);if(e==="cart"){const S=setTimeout(w,500);return()=>{clearInterval(k),clearTimeout(S)}}return()=>clearInterval(k)},[r,e]);const p=w=>{try{w&&w.preventDefault&&w.preventDefault()}catch{}if(!(typeof window<"u")||window.confirm("Are you sure you want to logout?"))if(typeof n=="function")n();else{try{localStorage.removeItem("token")}catch{}try{sessionStorage&&sessionStorage.clear&&sessionStorage.clear()}catch{}try{window.location.reload()}catch{}}},x=()=>{if(!(r!=null&&r.roles))return"User";const w=Array.isArray(r.roles)?r.roles:typeof r.roles=="string"?r.roles.split(",").map(S=>S.trim()).filter(S=>S.length>0):[];return[...new Set(w)].join(", ")},g=()=>{if(!(r!=null&&r.roles))return"bg-gray-500";const w=Array.isArray(r.roles)?r.roles:typeof r.roles=="string"?r.roles.split(",").map(k=>k.trim()).filter(k=>k.length>0):[];return w.includes("Super Admin")?"bg-red-500":w.includes("Admin")?"bg-purple-500":w.includes("Employee")?"bg-blue-500":"bg-green-500"},y=Array.isArray(r==null?void 0:r.roles)?r.roles:typeof(r==null?void 0:r.roles)=="string"?r.roles.split(",").map(w=>w.trim()):[],v=[{id:"home",name:"HOME",icon:l(V8,{className:"w-4 h-4"})},{id:"prebuilt-pcs",name:"PREBUILT PCS",icon:l(nt,{className:"w-4 h-4"})},{id:"pc-assembly",name:"BUILD A PC",icon:l(Ra,{className:"w-4 h-4"})}],b=r?[...y.includes("Super Admin")?[{id:"super-admin-dashboard",name:"Super Admin Dashboard",icon:l(No,{className:"w-4 h-4"})}]:y.includes("Admin")&&!y.includes("Super Admin")?[{id:"admin-dashboard",name:"Admin Dashboard",icon:l(No,{className:"w-4 h-4"})}]:y.includes("Employee")&&!y.includes("Admin")&&!y.includes("Super Admin")?[{id:"employee-dashboard",name:"Employee Dashboard",icon:l(No,{className:"w-4 h-4"})}]:[],...y.includes("Client")&&!y.includes("Admin")&&!y.includes("Employee")&&!y.includes("Super Admin")?[{id:"my-builds",name:"My Builds",icon:l(nt,{className:"w-4 h-4"})},{id:"cart",name:"Shopping Cart",icon:l(vs,{className:"w-4 h-4"}),badge:d},{id:"my-orders",name:"My Orders",icon:l(ys,{className:"w-4 h-4"})},{id:"pc-assembly",name:"PC Assembly",icon:l(Ra,{className:"w-4 h-4"})},{id:"notifications",name:"Notifications",icon:l(Aa,{className:"w-4 h-4"}),badge:m}]:[]]:[];return l("nav",{className:"bg-white shadow-lg sticky top-0 z-50",children:h("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[h("div",{className:"flex justify-between items-center h-16",children:[h("button",{onClick:()=>{var w,k,S;(w=r==null?void 0:r.roles)!=null&&w.includes("Super Admin")?t("super-admin-dashboard"):(k=r==null?void 0:r.roles)!=null&&k.includes("Admin")?t("admin-dashboard"):(S=r==null?void 0:r.roles)!=null&&S.includes("Employee")?t("employee-dashboard"):t("home")},className:"flex items-center space-x-3 hover:opacity-80 transition-opacity",children:[l("div",{className:"w-8 h-8 bg-green-600 rounded-lg flex items-center justify-center",children:l("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})})}),l("div",{children:l("h1",{className:"text-lg font-bold text-gray-900",children:"SIMS"})})]}),l("div",{className:"hidden md:flex items-center space-x-8",children:v.map(w=>h("button",{onClick:()=>t(w.id),className:`flex items-center space-x-1 px-3 py-2 text-sm font-medium rounded-md transition-colors ${e===w.id?"text-green-600 bg-green-50":"text-gray-700 hover:text-green-600 hover:bg-gray-50"}`,children:[w.icon,l("span",{children:w.name})]},w.id))}),h("div",{className:"flex items-center space-x-4",children:[r&&y.includes("Client")&&!y.includes("Admin")&&!y.includes("Employee")&&!y.includes("Super Admin")&&h("button",{onClick:()=>t("cart"),className:"relative p-2 text-gray-700 hover:text-green-600 transition-colors",title:"Shopping Cart",children:[l(vs,{className:"w-5 h-5"}),d>0&&l("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 rounded-full text-xs font-bold bg-green-500 text-white min-w-[1.25rem]",children:d>99?"99+":d})]}),r&&h("button",{onClick:()=>t("notifications"),className:"relative p-2 text-gray-700 hover:text-green-600 transition-colors",children:[l(Aa,{className:"w-5 h-5"}),m>0&&l("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 rounded-full text-xs font-bold bg-red-500 text-white",children:m})]}),r?h("div",{className:"relative",children:[h("button",{onClick:()=>u(!c),className:"flex items-center space-x-2 p-2 text-gray-700 hover:text-green-600 transition-colors rounded-md hover:bg-gray-50",children:[l("div",{className:"w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center",children:r!=null&&r.profile_image?l("img",{src:r.profile_image,alt:"Profile",className:"w-8 h-8 rounded-full object-cover"}):l(sl,{className:"w-4 h-4 text-gray-600"})}),h("span",{className:"hidden sm:block text-sm font-medium",children:[r==null?void 0:r.first_name," ",r==null?void 0:r.last_name]}),l(Pf,{className:"w-4 h-4"})]}),c&&h("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-md shadow-lg py-1 z-50",children:[h("div",{className:"px-4 py-2 border-b border-gray-200",children:[h("p",{className:"text-sm font-medium text-gray-900",children:[r==null?void 0:r.first_name," ",r==null?void 0:r.last_name]}),h("p",{className:"text-xs text-gray-500",children:["@",r==null?void 0:r.username]}),l("div",{className:"flex items-center mt-1",children:l("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium text-white ${g()}`,children:x()})})]}),b.length>0&&h(gt,{children:[b.map(w=>h("button",{onClick:()=>{t(w.id),u(!1)},className:"w-full flex items-center justify-between px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[h("div",{className:"flex items-center space-x-2",children:[w.icon,l("span",{children:w.name})]}),w.badge&&w.badge>0&&l("span",{className:`inline-flex items-center justify-center px-2 py-0.5 rounded-full text-xs font-bold text-white ${w.id==="cart"?"bg-green-500":"bg-red-500"}`,children:w.badge>99?"99+":w.badge})]},w.id)),l("div",{className:"border-t border-gray-200 my-1"})]}),h("button",{type:"button",onClick:w=>{w.preventDefault(),p(),u(!1)},className:"w-full flex items-center space-x-2 px-4 py-2 text-sm text-red-600 hover:bg-red-50 rounded-md transition-colors duration-200 group",children:[l(q8,{className:"w-4 h-4 group-hover:scale-110 transition-transform"}),l("span",{children:"Logout"})]})]})]}):h("div",{className:"flex items-center space-x-2",children:[l("button",{onClick:()=>t("login"),className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-green-600 transition-colors",children:"Login"}),l("button",{onClick:()=>t("register"),className:"px-4 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 rounded-md transition-colors",children:"Register"})]}),l("button",{onClick:()=>o(!s),className:"md:hidden p-2 text-gray-700 hover:text-green-600 transition-colors",children:s?l(Yr,{className:"w-6 h-6"}):l(J8,{className:"w-6 h-6"})})]})]}),s&&l("div",{className:"md:hidden border-t border-gray-200 py-4",children:h("div",{className:"space-y-2",children:[v.map(w=>h("button",{onClick:()=>{t(w.id),o(!1)},className:`w-full flex items-center space-x-2 px-3 py-2 text-sm font-medium rounded-md transition-colors ${e===w.id?"text-green-600 bg-green-50":"text-gray-700 hover:text-green-600 hover:bg-gray-50"}`,children:[w.icon,l("span",{children:w.name})]},w.id)),r&&b.map(w=>h("button",{onClick:()=>{t(w.id),o(!1)},className:"w-full flex items-center justify-between px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:[h("div",{className:"flex items-center space-x-2",children:[w.icon,l("span",{children:w.name})]}),w.badge&&w.badge>0&&l("span",{className:"inline-flex items-center justify-center px-2 py-0.5 rounded-full text-xs font-bold bg-red-500 text-white",children:w.badge})]},w.id))]})})]})})};function it(e,t={}){const n=(()=>{if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const s=e.replace(/[^0-9.\-]/g,""),o=Number(s);if(Number.isFinite(o))return o}return 0})();return new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:t.minimumFractionDigits??2,maximumFractionDigits:t.maximumFractionDigits??2}).format(n).replace("PHP","").replace("â‚±","â‚±")}const Vu=import.meta&&{VITE_RECAPTCHA_SITE_KEY:"6LfVeQAsAAAAAMqw5OZ0mbNLGTBXtrWydNCW30VC",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}&&"/"||"/",Nt=e=>{if(!e)return e;const t=e.startsWith("/")?e.slice(1):e;return!Vu||Vu==="./"?t:`${Vu.endsWith("/")?Vu.slice(0,-1):Vu}/${t}`},hL=(e,t)=>{if(!e||t<=0)return 0;let r=5381;for(let n=0;n<e.length;n++)r=(r<<5)+r^e.charCodeAt(n);return Math.abs(r)%t},Gk={"R3 3200G (TRAY) WITH HEATSINK FAN":"/images/components/cpu/R3 3200G (TRAY) WITH HEATSINK FAN.png","R5 5600G (TRAY) WITH HEATSINK FAN":"/images/components/cpu/r5_5600G_tray.png","R5 5600GT (TRAY) WITH HEATSINK FAN":"/images/components/cpu/R5 5600GT (TRAY) WITH HEATSINK FAN.png","R5 5600X (box) WITH WRAITH STEALTH COOLER":"/images/components/cpu/R5 5600X (TRAY) WITH HEATSINK FAN.png","R5 5600X (box) WITH WRAITH STEALTH":"/images/components/cpu/R5 5600X (TRAY) WITH HEATSINK FAN.png","R5 5600X (TRAY) NO COOLER":"/images/components/cpu/r5_5600x_tray.png","R5 5600X (TRAY) WITH HEATSINK FAN":"/images/components/cpu/R5 5600X (TRAY) WITH HEATSINK FAN.png","R5 7600X (TRAY) WITH HEATSINK FAN":"/images/components/cpu/R5 7600X (TRAY) WITH HEATSINK FAN.png","R7 4750G (TRAY) WITH HEATSINK FAN":"/images/components/cpu/R7 4750G (TRAY) WITH HEATSINK FAN.png","R7 5700G (TRAY) WITH HEATSINK FAN":"/images/components/cpu/R7 5700G (TRAY) WITH HEATSINK FAN.png","R7 5700X (TRAY) WITH HEATSINK FAN":"/images/components/cpu/R7 5700X (TRAY) WITH HEATSINK FAN.png","R7 5800X (TRAY) WITH HEATSINK FAN":"/images/components/cpu/R7 5800X (TRAY) WITH HEATSINK FAN.png","i7-11700 (plastic blister) + ISF":"/images/components/cpu/i7-11700 (plastic blister).png","R7 5700X3D 8 CORE 16 THREADS 3.0/4.1 GHZ AM4 W/OUT COOLER":"/images/components/cpu/R7 5700X3D (TRAY).png","R7 5700X (TRAY) NO COOLER":"/images/components/cpu/R7 5700X (TRAY) WITH HEATSINK FAN.png","GALAX RTX 3060 1-CLICK OC BLK 12GB":"/images/components/gpu/GALAX RTX 3060 1-CLICK OC BLK 12GB.png","GALAX RTX 4060 1-CLICK OC BLACK 8GB":"/images/components/gpu/GALAX RTX 4060 1-CLICK OC BLACK 8GB.png","GIGABYTE RTX 4060 AERO OC 8GB WHITE":"/images/components/gpu/GIGABYTE RTX 4060 AERO OC 8GB WHITE.png","GIGABYTE RTX 4060TI AERO OC 16GB WHITE":"/images/components/gpu/GIGABYTE RTX 4060TI AERO OC 16GB WHITE.png","GIGABYTE RTX 4060TI AERO OC 8GB WHITE":"/images/components/gpu/GIGABYTE RTX 4060TI AERO OC 8GB WHITE.png","GIGABYTE RTX 4070 SUPER EAGLE OC 12GB":"/images/components/gpu/GIGABYTE RTX 4070 SUPER EAGLE OC 12GB.png","GIGABYTE RX 6600 8GB EAGLE":"/images/components/gpu/GIGABYTE RX 6600 8GB EAGLE.png","GIGABYTE RX 7600XT GAMING OC 16GB":"/images/components/gpu/GIGABYTE RX 7600XT GAMING OC 16GB.png","PNY VERTO RTX 4060 8GB DUAL FAN OC":"/images/components/gpu/PNY VERTO RTX 4060 8GB DUAL FAN OC.png","RAMSTA RX550 4GB GDDR5":"/images/components/gpu/RAMSTA RX550 4GB GDDR5.png","RAMSTA RX580 8GB GDDR5":"/images/components/gpu/RAMSTA RX580 8GB GDDR5.png","SAPPHIRE PULSE AMD RADEON RX 7800 XT 16GB":"/images/components/gpu/SAPPHIRE PULSE AMD RADEON RX 7800 XT 16GB.png","ASROCK RX 6600 CHALLENGER 8GB WHITE":"/images/components/gpu/ASROCK RX 6600 CHALLENGER 8GB WHITE.png","COLORFUL GEFORCE RTX 3070 BATTLE AX 8GB":"/images/components/gpu/COLORFUL GEFORCE RTX 3070 BATTLE AX 8GB.png","COLORFUL IGAME ULTRA RTX 4060 8GB (WHITE":"/images/components/gpu/COLORFUL IGAME ULTRA RTX 4060 8GB (WHITE.png","GALAX GTX 1650EX PLUS 4GB DDR6":"/images/components/gpu/GALAX GTX 1650EX PLUS 4GB DDR6.png","GALAX RTX 3050 1-CLICK OC BLK 6GB":"/images/components/gpu/GALAX RTX 3050 1-CLICK OC BLK 6GB.png","RX 6600 CHALLENGER 8GB WHITE":"/images/components/gpu/ASROCK RX 6600 CHALLENGER 8GB WHITE.png","RX 7600XT GAMING OC 16GB":"/images/components/gpu/GIGABYTE RX 7600XT GAMING OC 16GB.png","KINGSTON FURY BEAST DDR4 8GB":"/images/components/ram/KINGSTON FURY BEAST DDR4 8GB.png","KINGSTON FURY BEAST DDR4 16GB (single stick)":"/images/components/ram/KINGSTON FURY BEAST DDR4 16GB (single stick).png","KINGSPEC DDR4 8GB RGB":"/images/components/ram/KINGSPEC DDR4 8GB RGB.png","NEO FORZA FAYE DDR4":"/images/components/ram/NEO FORZA FAYE DDR4.png","NEO FORZA FAYE DDR4 16GB (2X8GB) NON RGB":"/images/components/ram/NEO FORZA FAYE DDR4 16GB (2X8GB) NON RGB.png","SKIHOTAR DDR4 4GB (2666MHz)":"/images/components/ram/SKIHOTAR DDR4 4GB (2666MHz).png","SKIHOTAR DDR4 8GB (3200MHz)":"/images/components/ram/SKIHOTAR DDR4 8GB (3200MHz).png","TEAM ELITE PLUS GOLD DDR4 8GB":"/images/components/ram/TEAM ELITE PLUS GOLD DDR4 8GB.png","TFORCE DDR4 DARKZA 16GB (2x8gb) 3600MHz":"/images/components/ram/TFORCE DDR4 DARKZA 16GB (2x8gb) 3600MHz.png","TFORCE Delta RGB DDR4 16GB kit (2x8gb) 3600MHz BLACK":"/images/components/ram/TFORCE Delta RGB DDR4 16GB kit (2x8gb) 3600MHz BLACK.png","TFORCE Delta RGB DDR4 16GB kit (2x8gb) 3600MHz WHITE":"/images/components/ram/TFORCE Delta RGB DDR4 16GB kit (2x8gb) 3600MHz WHITE.png","TFORCE Delta RGB DDR4 16GB kit (2x8gb) BLACK":"/images/components/ram/TFORCE Delta RGB DDR4 16GB kit (2x8gb) BLACK.png","TFORCE Delta RGB DDR4 16GB kit (2x8gb) WHITE":"/images/components/ram/TFORCE Delta RGB DDR4 16GB kit (2x8gb) WHITE.png","TFORCE Delta RGB DDR4 32GB kit (2x16gb) BLACK":"/images/components/ram/TFORCE Delta RGB DDR4 32GB kit (2x16gb) BLACK.png","TFORCE Delta RGB DDR4 32GB kit (2x16gb) WHITE":"/images/components/ram/TFORCE Delta RGB DDR4 32GB kit (2x16gb) WHITE.png","FURY BEAST DDR4 8gb":"/images/components/ram/KINGSTON FURY BEAST DDR4 8GB.png","FURY BEAST DDR4 16gb (single stick)":"/images/components/ram/KINGSTON FURY BEAST DDR4 16GB (single stick).png","FAYE DDR4 16GB (2X8GB) 3200 NON RGB w/ HS":"/images/components/ram/NEO FORZA FAYE DDR4 16GB (2X8GB) NON RGB.png","DDR4 8GB":"/images/components/ram/SKIHOTAR DDR4 8GB (3200MHz).png","PLUS GOLD DDR4  8GB":"/images/components/ram/TEAM ELITE PLUS GOLD DDR4 8GB.png","Delta RGB DDR4 16gb-kit (2x8gb) black":"/images/components/ram/TFORCE Delta RGB DDR4 16GB kit (2x8gb) BLACK.png","Delta RGB DDR4 16gb-kit (2x8gb) white":"/images/components/ram/TFORCE Delta RGB DDR4 16GB kit (2x8gb) WHITE.png","Delta RGB DDR4 32gb-kit (2x16gb) black":"/images/components/ram/TFORCE Delta RGB DDR4 32GB kit (2x16gb) BLACK.png","Delta RGB DDR4 32gb-kit (2x16gb) white":"/images/components/ram/TFORCE Delta RGB DDR4 32GB kit (2x16gb) WHITE.png","DDR4 DARKZA 16GB (2x8gb)":"/images/components/ram/TFORCE DDR4 DARKZA 16GB (2x8gb) 3600MHz.png","Delta RGB DDR4 16gb kit (2x8gb) black":"/images/components/ram/TFORCE Delta RGB DDR4 16GB kit (2x8gb) BLACK.png","Delta RGB DDR4 16gb kit (2x8gb) white":"/images/components/ram/TFORCE Delta RGB DDR4 16GB kit (2x8gb) WHITE.png","Delta RGB DDR4 32gb kit (2x16gb) black":"/images/components/ram/TFORCE Delta RGB DDR4 32GB kit (2x16gb) BLACK.png","Delta RGB DDR4 32gb kit (2x16gb) white":"/images/components/ram/TFORCE Delta RGB DDR4 32GB kit (2x16gb) WHITE.png","Delta RGB DDR4 (SINGLE STICK) 32gb white":"/images/components/ram/TFORCE Delta RGB DDR4 32GB kit (2x16gb) WHITE.png","ASRock B550M STEEL LEGEND":"/images/components/motherboard/ASRock B550M STEEL LEGEND.png","ASRock B550M-ITX-AC":"/images/components/motherboard/ASRock B550M-ITX-AC.png","ASRock H510M-HVS":"/images/components/motherboard/ASRock H510M-HVS.png","ASRock H610M-HVS":"/images/components/motherboard/ASRock H610M-HVS.png","ASUS PRIME A520M K":"/images/components/motherboard/ASUS PRIME A520M K.png","ASUS PRIME H510M-E":"/images/components/motherboard/ASUS PRIME H510M-E.png","BIOSTAR A520MHP":"/images/components/motherboard/BIOSTAR A520MHP.png","BIOSTAR B450MHP DDR43200 AM4":"/images/components/motherboard/BIOSTAR B450MHP DDR43200 AM4.png","GIGABYTE AORUS B550M ELITE":"/images/components/motherboard/GIGABYTE AORUS B550M ELITE.png","GIGABYTE B550M DS3H AC":"/images/components/motherboard/GIGABYTE B550M DS3H AC.png","GIGABYTE B550M DS3H":"/images/components/motherboard/GIGABYTE B550M DS3H.png","GIGABYTE B550M-K":"/images/components/motherboard/GIGABYTE B550M-K.png","GIGABYTE B660M DS3H":"/images/components/motherboard/GIGABYTE B660M DS3H.png","GIGABYTE H510M-K-V2":"/images/components/motherboard/GIGABYTE H510M-K-V2.png","GIGABYTE H610M H":"/images/components/motherboard/GIGABYTE H610M H.png","MMA A320":"/images/components/motherboard/MMA A320.png","MSI B550M PRO-VDH":"/images/components/motherboard/MSI B550M PRO-VDH.png","MSI MAG B550M":"/images/components/motherboard/MSI MAG B550M.png","WHALEKOM B450MV1":"/images/components/motherboard/WHALEKOM B450MV1.png","H510M HVS":"/images/components/motherboard/ASRock H510M-HVS.png","B550M STEEL LEGEND":"/images/components/motherboard/ASRock B550M STEEL LEGEND.png","A520M K":"/images/components/motherboard/ASUS PRIME A520M K.png","B450MHP DDR4/3200 AM4":"/images/components/motherboard/BIOSTAR B450MHP DDR43200 AM4.png",B450MV1:"/images/components/motherboard/WHALEKOM B450MV1.png",A520MHP:"/images/components/motherboard/BIOSTAR A520MHP.png","Crucial BX500 SSD":"/images/components/storage/Crucial BX500 SSD.png","Crucial P3 1TB-2TB":"/images/components/storage/Crucial P3 1TB-2TB.png","Kingston A400 SSD":"/images/components/storage/Kingston A400 SSD.png","Kingston NV2 500GB-1TB":"/images/components/storage/Kingston NV2 500GB-1TB.png","Samsung 970 EVO Plus 500GB":"/images/components/storage/Samsung 970 EVO Plus 500GB.png","Samsung 980 1TB NVMe":"/images/components/storage/Samsung 980 1TB NVMe.png","Seagate Barracuda 1TB-2TB HDD":"/images/components/storage/Seagate Barracuda 1TB-2TB HDD.png","WD Blue 1TB-2TB HDD":"/images/components/storage/WD Blue 1TB-2TB HDD.png","WD Blue SN570 1TB":"/images/components/storage/WD Blue SN570 1TB.png","WD Blue SN580 500GB":"/images/components/storage/WD Blue SN580 500GB.png","970 EVO PLUS 1tb":"/images/components/storage/Samsung 970 EVO Plus 500GB.png","NV3 PCIe 4.0 1TB":"/images/components/storage/Kingston NV2 500GB-1TB.png","Cooler Master MWE Bronze 550W":"/images/components/psu/Cooler Master MWE Bronze 550W.png","Corsair CV550":"/images/components/psu/Corsair CV550.png","Corsair CX550F":"/images/components/psu/Corsair CX550F.png","DeepCool DN series":"/images/components/psu/DeepCool DN series.png","EVGA 500 W1":"/images/components/psu/EVGA 500 W1.png","EVGA 600 BR":"/images/components/psu/EVGA 600 BR.png","FSP HV PRO 550W":"/images/components/psu/FSP HV PRO 550W.png","Seasonic Core GM-500":"/images/components/psu/Seasonic Core GM-500.png","Seasonic Focus GX-650":"/images/components/psu/Seasonic Focus GX-650.png","Thermaltake Smart 500W":"/images/components/psu/Thermaltake Smart 500W.png","CX550 80+ BRONZE 550watts":"/images/components/psu/Corsair CV550.png","CX650 80+ BRONZE 650watts":"/images/components/psu/Corsair CX550F.png","CV750 80+ BRONZE 750watts":"/images/components/psu/Corsair CV550.png","RM750E 80+ GOLD FULLY MODULAR 750watts":"/images/components/psu/Seasonic Focus GX-650.png","RM850E 80+ GOLD FULLY MODULAR 850watts":"/images/components/psu/Seasonic Focus GX-650.png","DE-600 v2 600watts":"/images/components/psu/DeepCool DN series.png","BTS-550 BRONZE 550WATTS":"/images/components/psu/EVGA 500 W1.png","BTS-650 BRONZE 650WATTS":"/images/components/psu/EVGA 600 BR.png","BTS-750 BRONZE 750WATTS":"/images/components/psu/EVGA 600 BR.png","(GC-PS014W/RGPS-650SFX) 80+ GOLD FULL MOD (white) 650watts":"/images/components/psu/Seasonic Focus GX-650.png","RGPS-700W 80+ BRONZE FULL MODULAR":"/images/components/psu/Seasonic Focus GX-650.png","P550SS SILVER WHITE (ICE)":"/images/components/psu/EVGA 600 BR.png","P550SS SILVER":"/images/components/psu/EVGA 600 BR.png","GS550 ULTRA BLACK ATX POWERSUPPLY 550W 80+ BRONZE RGB":"/images/components/psu/Cooler Master MWE Bronze 550W.png","GS650 ULTRA BLACK ATX POWERSUPPLY 650W 80+ BRONZE RGB":"/images/components/psu/Cooler Master MWE Bronze 550W.png","CX750 80+ BRONZE 750watts":"/images/components/psu/Corsair CV550.png","ACER V920":"/images/components/case/ACER V920.png","ACER V950":"/images/components/case/ACER V950.png","COOLMAN HARLEY":"/images/components/case/COOLMAN HARLEY.png","COOLMAN REYNA":"/images/components/case/COOLMAN REYNA.png","COOLMAN RUBY":"/images/components/case/COOLMAN RUBY.png","DARKFLASH DK351":"/images/components/case/DARKFLASH DK351.png","DARKFLASH DLM21 MESH":"/images/components/case/DARKFLASH DLM21 MESH.png","GAMDIAS TALOS E3 MESH":"/images/components/case/GAMDIAS TALOS E3 MESH.png","INPLAY WIND 01":"/images/components/case/INPLAY WIND 01.png","KEYTECH CYBORG CASE":"/images/components/case/KEYTECH CYBORG CASE.png","KEYTECH ROBIN SE (BLACK-WHITE)":"/images/components/case/KEYTECH ROBIN SE (BLACK-WHITE).png","KEYTECH T1000 (BLACK-WHITE)":"/images/components/case/KEYTECH T1000 (BLACK-WHITE).png","MMA AK99":"/images/components/case/MMA AK99.png","MMA SR89":"/images/components/case/MMA SR89.png","NZXT H5 FLOW":"/images/components/case/NZXT H5 FLOW.png","YGT B708":"/images/components/case/YGT B708.png","YGT B709":"/images/components/case/YGT B709.png","YGT N195":"/images/components/case/YGT N195.png","VISOR - WHITE (TEMPERED GLASS)":"/images/components/case/KEYTECH ROBIN SE (BLACK-WHITE).png","DEEPCOOL AG400 (AIR COOLERS)":"/images/components/cooler/DEEPCOOL AG400 (AIR COOLERS).png","DEEPCOOL AK400":"/images/components/cooler/DEEPCOOL AK400.png","DEEPCOOL AK500":"/images/components/cooler/DEEPCOOL AK500.png","DEEPCOOL LIQUID COOLER AIO - ARGB LE520":"/images/components/cooler/DEEPCOOL LIQUID COOLER AIO - ARGB LE520.png","DEEPCOOL LIQUID COOLER AIO - LS520 SE DIGITAL)":"/images/components/cooler/DEEPCOOL LIQUID COOLER AIO - LS520 SE DIGITAL).png","DEEPCOOL LIQUID COOLER AIO - LT520":"/images/components/cooler/DEEPCOOL LIQUID COOLER AIO - LT520.png","DEEPCOOL MYSTIQUE 240":"/images/components/cooler/DEEPCOOL MYSTIQUE 240.png","DEEPCOOL MYSTIQUE 360":"/images/components/cooler/DEEPCOOL MYSTIQUE 360.png","JONSBO CR 1200 EVO (AIR COOLERS)":"/images/components/cooler/JONSBO CR 1200 EVO (AIR COOLERS).png","JONSBO CR 1400 EVO (AIR COOLERS)":"/images/components/cooler/JONSBO CR 1400 EVO (AIR COOLERS).png","JUNGLE LEOPARD ASTROBEAT":"/images/components/cooler/JUNGLE LEOPARD ASTROBEAT.png","JUNGLE LEOPARD ASTROSHEL":"/images/components/cooler/JUNGLE LEOPARD ASTROSHEL.png","OVATION HURRICANE 240":"/images/components/cooler/OVATION HURRICANE 240.png","THERMALRIGHT LIQUID COOLER FROZEN WARFRAME 240 ARGB":"/images/components/cooler/THERMALRIGHT LIQUID COOLER FROZEN WARFRAME 240 ARGB.png","YGT LIQUID COOLER AIO - DF-120":"/images/components/cooler/YGT LIQUID COOLER AIO - DF-120.png"},oc={cpu:["/images/components/cpu/R3 3200G (TRAY) WITH HEATSINK FAN.png","/images/components/cpu/r5_5600G_tray.png","/images/components/cpu/R5 5600X (TRAY) WITH HEATSINK FAN.png","/images/components/cpu/R7 5700X (TRAY) WITH HEATSINK FAN.png","/images/components/cpu/R7 5800X (TRAY) WITH HEATSINK FAN.png"],gpu:["/images/components/gpu/GALAX RTX 3060 1-CLICK OC BLK 12GB.png","/images/components/gpu/GIGABYTE RTX 4060 AERO OC 8GB WHITE.png","/images/components/gpu/GIGABYTE RX 6600 8GB EAGLE.png","/images/components/gpu/SAPPHIRE PULSE AMD RADEON RX 7800 XT 16GB.png"],ram:["/images/components/ram/KINGSTON FURY BEAST DDR4 8GB.png","/images/components/ram/TFORCE Delta RGB DDR4 16GB kit (2x8gb) BLACK.png","/images/components/ram/TFORCE Delta RGB DDR4 16GB kit (2x8gb) WHITE.png","/images/components/ram/TFORCE Delta RGB DDR4 32GB kit (2x16gb) BLACK.png"],motherboard:["/images/components/motherboard/ASRock B550M STEEL LEGEND.png","/images/components/motherboard/GIGABYTE B550M DS3H.png","/images/components/motherboard/MSI B550M PRO-VDH.png","/images/components/motherboard/GIGABYTE B660M DS3H.png"],storage:["/images/components/storage/Samsung 970 EVO Plus 500GB.png","/images/components/storage/WD Blue SN570 1TB.png","/images/components/storage/Crucial P3 1TB-2TB.png","/images/components/storage/Kingston NV2 500GB-1TB.png"],psu:["/images/components/psu/Corsair CX550F.png","/images/components/psu/EVGA 600 BR.png","/images/components/psu/Seasonic Focus GX-650.png","/images/components/psu/Thermaltake Smart 500W.png"],case:["/images/components/case/INPLAY WIND 01.png","/images/components/case/NZXT H5 FLOW.png","/images/components/case/COOLMAN HARLEY.png","/images/components/case/DARKFLASH DK351.png"],cooler:["/images/components/cooler/DEEPCOOL AK400.png","/images/components/cooler/DEEPCOOL AK500.png","/images/components/cooler/DEEPCOOL LIQUID COOLER AIO - ARGB LE520.png","/images/components/cooler/DEEPCOOL MYSTIQUE 240.png"],default:["/images/components/cpu/R3 3200G (TRAY) WITH HEATSINK FAN.png","/images/components/gpu/GALAX RTX 3060 1-CLICK OC BLK 12GB.png"]};function mL(e){const t=e.toLowerCase();return t.includes("ryzen")||t.includes("core i")||t.includes("intel")||t.includes("amd")||t.includes("cpu")||t.includes("r3")||t.includes("r5")||t.includes("r7")||t.includes("r9")||t.includes("athlon")||t.includes("i3")||t.includes("i5")||t.includes("i7")?"cpu":t.includes("rtx")||t.includes("gtx")||t.includes("rx")||t.includes("graphics")||t.includes("gpu")||t.includes("radeon")||t.includes("geforce")?"gpu":t.includes("ddr")||t.includes("memory")||t.includes("ram")||t.includes("fury")||t.includes("vengeance")||t.includes("trident")||t.includes("tforce")||t.includes("kingston")||t.includes("team")||t.includes("skihotar")||t.includes("neo forza")||t.includes("kingspec")?"ram":t.includes("motherboard")||t.includes("mobo")||t.includes("b550")||t.includes("b660")||t.includes("h510")||t.includes("x570")||t.includes("asrock")||t.includes("asus")||t.includes("msi")||t.includes("gigabyte")||t.includes("biostar")||t.includes("mma")||t.includes("whalekom")?"motherboard":t.includes("ssd")||t.includes("hdd")||t.includes("nvme")||t.includes("samsung")||t.includes("wd")||t.includes("seagate")||t.includes("crucial")||t.includes("kingston")?"storage":t.includes("psu")||t.includes("power")||t.includes("watt")||t.includes("corsair")||t.includes("evga")||t.includes("seasonic")||t.includes("cooler master")||t.includes("deepcool")||t.includes("fsp")||t.includes("thermaltake")?"psu":t.includes("case")||t.includes("chassis")||t.includes("nzxt")||t.includes("coolman")||t.includes("darkflash")||t.includes("gamdias")||t.includes("inplay")||t.includes("keytech")||t.includes("acer")||t.includes("mma")||t.includes("ygt")?"case":t.includes("cooler")||t.includes("fan")||t.includes("deepcool")||t.includes("jonsbo")||t.includes("jungle leopard")||t.includes("ovation")||t.includes("thermalright")||t.includes("ygt")||t.includes("aio")||t.includes("liquid")?"cooler":"default"}function xr(e,t=null){const r=typeof e=="string"?e:e.name;if(!r)return Nt(oc.default[0]);if(Gk[r])return Nt(Gk[r]);const n=r.toLowerCase();if(n.includes("5600g"))return Nt("/images/components/cpu/r5_5600G_tray.png");if(n.includes("ryzen"))return n.includes("5600x")?Nt("/images/components/cpu/R5 5600X (TRAY) WITH HEATSINK FAN.png"):n.includes("5600g")?Nt("/images/components/cpu/r5_5600G_tray.png"):n.includes("5700x")?Nt("/images/components/cpu/R7 5700X (TRAY) WITH HEATSINK FAN.png"):n.includes("5800x")?Nt("/images/components/cpu/R7 5800X (TRAY) WITH HEATSINK FAN.png"):n.includes("7600x")?Nt("/images/components/cpu/R5 7600X (TRAY) WITH HEATSINK FAN.png"):Nt(oc.cpu[0]);if(n.includes("rtx"))return n.includes("3060")?Nt("/images/components/gpu/GALAX RTX 3060 1-CLICK OC BLK 12GB.png"):n.includes("4060")?Nt("/images/components/gpu/GIGABYTE RTX 4060 AERO OC 8GB WHITE.png"):n.includes("4070")?Nt("/images/components/gpu/GIGABYTE RTX 4070 SUPER EAGLE OC 12GB.png"):Nt(oc.gpu[0]);if(n.includes("rx"))return n.includes("6600")?Nt("/images/components/gpu/GIGABYTE RX 6600 8GB EAGLE.png"):n.includes("7800")?Nt("/images/components/gpu/SAPPHIRE PULSE AMD RADEON RX 7800 XT 16GB.png"):Nt(oc.gpu[0]);if(n.includes("kingston")&&n.includes("fury"))return Nt("/images/components/ram/KINGSTON FURY BEAST DDR4 8GB.png");if(n.includes("tforce")||n.includes("t-force"))return Nt("/images/components/ram/TFORCE Delta RGB DDR4 16GB kit (2x8gb) BLACK.png");if(n.includes("team"))return Nt("/images/components/ram/TEAM ELITE PLUS GOLD DDR4 8GB.png");if(n.includes("asrock"))return Nt("/images/components/motherboard/ASRock B550M STEEL LEGEND.png");if(n.includes("msi"))return Nt("/images/components/motherboard/MSI B550M PRO-VDH.png");if(n.includes("asus"))return Nt("/images/components/motherboard/ASUS PRIME A520M K.png");if(n.includes("gigabyte"))return Nt("/images/components/motherboard/GIGABYTE B550M DS3H.png");if(n.includes("samsung"))return Nt("/images/components/storage/Samsung 970 EVO Plus 500GB.png");if(n.includes("wd")||n.includes("western digital"))return Nt("/images/components/storage/WD Blue SN570 1TB.png");if(n.includes("crucial"))return Nt("/images/components/storage/Crucial P3 1TB-2TB.png");if(n.includes("seagate"))return Nt("/images/components/storage/Seagate Barracuda 1TB-2TB HDD.png");if(n.includes("corsair"))return Nt("/images/components/psu/Corsair CX550F.png");if(n.includes("evga"))return Nt("/images/components/psu/EVGA 600 BR.png");if(n.includes("seasonic"))return Nt("/images/components/psu/Seasonic Focus GX-650.png");if(n.includes("thermaltake"))return Nt("/images/components/psu/Thermaltake Smart 500W.png");if(n.includes("nzxt"))return Nt("/images/components/case/NZXT H5 FLOW.png");if(n.includes("coolman"))return Nt("/images/components/case/COOLMAN HARLEY.png");if(n.includes("darkflash"))return Nt("/images/components/case/DARKFLASH DK351.png");if(n.includes("inplay"))return Nt("/images/components/case/INPLAY WIND 01.png");if(n.includes("deepcool"))return Nt("/images/components/cooler/DEEPCOOL AK400.png");if(n.includes("jonsbo"))return Nt("/images/components/cooler/JONSBO CR 1200 EVO (AIR COOLERS).png");if(n.includes("thermalright"))return Nt("/images/components/cooler/THERMALRIGHT LIQUID COOLER FROZEN WARFRAME 240 ARGB.png");const a=t||mL(r),i=oc[a]||oc.default,s=hL(r,i.length);return Nt(i[s])}const pL=({setCurrentPage:e})=>{const[t,r]=N.useState(0),[n,a]=N.useState(!1),[i,s]=N.useState([]),[o,c]=N.useState(!0),u={1:"CPU",2:"Motherboard",3:"GPU",4:"RAM",5:"Storage",6:"PSU",7:"Case",8:"Cooler",9:"Aio",11:"Case Gaming"};N.useEffect(()=>{(async()=>{try{const k=await(await fetch(An("get_all_components"))).json();if(k.success&&Array.isArray(k.data)){const S=[1,2,3,4,5,6,7,8,9,11],E=k.data.filter(H=>S.includes(Number(H.category_id))).map(H=>({...H,category:u[Number(H.category_id)]||H.category_id})).map(H=>({...H,priceValue:parseFloat((H.price||"").toString().replace(/[^0-9.]/g,""))||0})).sort((H,L)=>L.priceValue-H.priceValue),A=H=>{try{return(xr(H,(H.category||"").toLowerCase())||"").toLowerCase()}catch{return""}},T=new Set,D=new Set,I=[];for(const H of E){const L=H.id?String(H.id):null,W=`${(H.brand||"").toString().toLowerCase().trim()}::${(H.name||"").toString().toLowerCase().trim()}`,ie=A(H),B=`${W}::${ie}`;L&&T.has(L)||D.has(B)||(L&&T.add(L),D.add(B),I.push(H))}const z=10,X=I.slice(0,z);s(X)}else s([])}catch{s([])}finally{c(!1)}})()},[]);const d=b=>{r(b)},f=()=>{r(b=>(b+1)%i.length)},m=()=>{r(b=>(b-1+i.length)%i.length)};if(N.useEffect(()=>{t>=i.length&&i.length>0&&r(0)},[i.length,t]),N.useEffect(()=>{i.length!==0&&t>=i.length&&r(Math.max(i.length-1,0))},[i.length,t]),N.useEffect(()=>{if(!i||i.length===0||n)return;const b=setInterval(()=>{r(w=>(w+1)%i.length)},5e3);return()=>clearInterval(b)},[i.length,n]),N.useEffect(()=>{if(!i||i.length===0)return;const b=import.meta&&{VITE_RECAPTCHA_SITE_KEY:"6LfVeQAsAAAAAMqw5OZ0mbNLGTBXtrWydNCW30VC",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}&&"/"||"/",w=b.endsWith("/")?b.slice(0,-1):b,k=new Set;i.forEach(_=>{const C=xr(_,(_.category||"").toLowerCase())||`${w}/images/placeholder-component.svg`;C&&k.add(C)}),[(t+1)%i.length,(t-1+i.length)%i.length].forEach(_=>{const C=i[_];if(!C)return;const E=xr(C,(C.category||"").toLowerCase())||`${w}/images/placeholder-component.svg`;E&&k.add(E)}),k.forEach(_=>{const C=new Image;C.decoding="async",C.loading="eager",C.src=_})},[i,t]),o)return l("section",{className:"relative h-screen flex items-center justify-center bg-gradient-to-br from-gray-800 to-gray-900",children:l("div",{className:"text-white text-xl font-semibold",children:"Loading components..."})});if(!i||i.length===0)return l("section",{className:"relative h-screen flex items-center justify-center bg-gradient-to-br from-gray-800 to-gray-900",children:h("div",{className:"text-white text-xl font-semibold text-center",children:["No PC components with working images found for the slideshow.",l("br",{}),"Please check your database or try again later."]})});const p=i[Math.min(t,i.length-1)],x=import.meta&&{VITE_RECAPTCHA_SITE_KEY:"6LfVeQAsAAAAAMqw5OZ0mbNLGTBXtrWydNCW30VC",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}&&"/"||"/",g=x.endsWith("/")?x.slice(0,-1):x,y=xr(p,((p==null?void 0:p.category)||"").toLowerCase()),v=y&&y.trim()!==""?y:`${g}/images/placeholder-component.svg`;return h("section",{className:"relative h-screen overflow-hidden bg-gray-900",onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),children:[h("div",{className:"pointer-events-none absolute inset-0 overflow-hidden",children:[l("div",{className:"absolute -top-24 -left-24 w-96 h-96 rounded-full blur-3xl opacity-30",style:{background:"radial-gradient(closest-side, rgba(16,185,129,0.6), rgba(16,185,129,0) 70%)"}}),l("div",{className:"absolute -bottom-24 -right-24 w-[28rem] h-[28rem] rounded-full blur-3xl opacity-25",style:{background:"radial-gradient(closest-side, rgba(59,130,246,0.5), rgba(59,130,246,0) 70%)"}}),l("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[36rem] h-[36rem] rounded-full blur-[80px] opacity-15",style:{background:"radial-gradient(closest-side, rgba(147,51,234,0.5), rgba(147,51,234,0) 70%)"}})]}),l("div",{className:"relative h-full",children:(()=>{const b=p,w=(b==null?void 0:b.gradient)||"from-green-custom-800 to-gray-900",k=w.includes("from-")?w.replace("from-","").replace("to-","").split(" ").map((T,D)=>`rgba(${{"blue-700":"59,130,50","gray-900":"17,24,39","purple-700":"124,58,237","green-700":"59,130,50","green-custom-800":"59,130,50","green-custom-900":"39,98,34","red-700":"185,28,28","indigo-700":"67,56,202"}[T]||"59,130,50"},${D===0?.72:.92})`):["rgba(59,130,50,0.72)","rgba(17,24,39,0.92)"],S=(b==null?void 0:b.description)||(b!=null&&b.brand?`${b.brand} ${b.name}`:b==null?void 0:b.name),_=Array.isArray(b==null?void 0:b.specs)&&b.specs.length>0?b.specs:[],C=(b==null?void 0:b.originalPrice)||"",E=typeof(b==null?void 0:b.priceValue)=="number"?b.priceValue:parseFloat(((b==null?void 0:b.price)||"").toString().replace(/[^0-9.]/g,""))||0,A=C&&parseFloat(C.toString().replace(/[^0-9.]/g,""))||0;if(typeof window<"u"){window.__loggedImages||(window.__loggedImages={});const T=(b==null?void 0:b.id)||`${(b==null?void 0:b.brand)||""}-${(b==null?void 0:b.name)||""}`;T&&!window.__loggedImages[T]&&(window.__loggedImages[T]=!0)}return l("div",{className:"absolute inset-0 opacity-100 z-10",style:{backgroundImage:`linear-gradient(135deg, ${k.join(", ")}), url('${v}')`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundColor:"#0b1120"},children:l("div",{className:"h-full text-white flex items-center justify-center p-4",children:l("div",{className:"max-w-7xl mx-auto px-4 lg:px-8 w-full",children:h("div",{className:"grid grid-cols-1 lg:grid-cols-12 items-center gap-8 lg:gap-16",children:[l("div",{className:"lg:col-span-6 flex items-center justify-center",children:h("div",{className:"relative anim-slide-in-left",children:[l("div",{className:"bg-black bg-opacity-35 rounded-2xl p-4 lg:p-8 backdrop-blur-md shadow-[0_20px_60px_rgba(0,0,0,0.45)] ring-1 ring-white/10 anim-glow-pulse",children:l("img",{src:v,alt:b==null?void 0:b.name,className:"w-auto h-64 md:h-72 lg:h-80 xl:h-96 object-contain drop-shadow-[0_12px_40px_rgba(0,0,0,0.5)] select-none anim-float-y",loading:"eager",decoding:"async",onError:T=>{const D=`${g}/images/placeholder-component.svg`;T.currentTarget.src!==D&&(T.currentTarget.src=D)}})}),l("div",{className:"pointer-events-none absolute -top-6 -left-6 w-24 h-24 rounded-full opacity-40 blur-2xl",style:{background:"radial-gradient(closest-side, rgba(255,255,255,0.35), rgba(255,255,255,0) 70%)"}})]})}),l("div",{className:"lg:col-span-6 text-center lg:text-left anim-slide-in-right",children:h("div",{className:"flex flex-col h-full justify-between",children:[h("div",{children:[l("span",{className:"inline-block bg-white bg-opacity-90 text-gray-900 text-sm font-semibold px-3 py-1 rounded-full mb-4 shadow-md",children:b==null?void 0:b.category}),l("h1",{className:"text-3xl lg:text-5xl font-extrabold mb-3 lg:mb-4 leading-tight drop-shadow-[0_2px_4px_rgba(0,0,0,0.45)]",children:b==null?void 0:b.name}),l("p",{className:"text-base lg:text-lg mb-6 text-gray-200 leading-relaxed max-w-xl",children:S}),l("div",{className:"mb-6",children:h("div",{className:"flex items-baseline justify-center lg:justify-start",children:[l("span",{className:"text-3xl font-bold text-white",children:it(E||0,{minimumFractionDigits:0,maximumFractionDigits:0})}),A>E&&h(gt,{children:[l("span",{className:"ml-2 text-lg text-gray-300 line-through",children:it(A,{minimumFractionDigits:0,maximumFractionDigits:0})}),h("span",{className:"ml-2 text-sm bg-red-600 text-white px-2 py-0.5 rounded",children:[Math.round((1-E/A)*100),"% OFF"]})]})]})}),l("div",{className:"grid grid-cols-2 gap-3 mb-6",children:_.length>0&&_.slice(0,4).map((T,D)=>h("div",{className:"bg-white bg-opacity-10 p-3 rounded-lg",children:[l("div",{className:"text-xs text-gray-300",children:T.label}),l("div",{className:"font-medium text-white",children:T.value})]},D))})]}),l("div",{className:"mt-auto",children:h("div",{className:"flex flex-col sm:flex-row gap-4",children:[h("button",{onClick:()=>e("pc-assembly"),className:"flex-1 flex items-center justify-center px-6 py-3 border-2 border-transparent text-base font-medium rounded-lg text-white bg-gradient-to-r from-green-custom-600 to-green-custom-700 hover:from-green-custom-700 hover:to-green-custom-800 transition-all duration-200 shadow-lg hover:shadow-xl hover:scale-[1.02] transform",children:["Go to Build",l(Qi,{className:"ml-2 h-5 w-5 group-hover:translate-x-1 transition-transform"})]}),h("button",{onClick:()=>e("pc-assembly"),className:"flex-1 flex items-center justify-center px-6 py-3 border-2 border-white text-base font-medium rounded-lg text-white hover:bg-white hover:bg-opacity-10 transition-all duration-200 hover:shadow-lg",children:["View All ",b==null?void 0:b.category,"s"]})]})})]})})]})})})},(b==null?void 0:b.id)||`${((b==null?void 0:b.brand)||"").toString()}-${((b==null?void 0:b.name)||"").toString()}-active`)})()}),l("button",{onClick:m,className:"absolute left-4 top-1/2 -translate-y-1/2 bg-black bg-opacity-40 hover:bg-opacity-60 text-white p-3 rounded-full z-50 transition-all duration-200 focus:outline-none pointer-events-auto","aria-label":"Previous component",children:l("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),l("button",{onClick:f,className:"absolute right-4 top-1/2 -translate-y-1/2 bg-black bg-opacity-40 hover:bg-opacity-60 text-white p-3 rounded-full z-50 transition-all duration-200 focus:outline-none pointer-events-auto","aria-label":"Next component",children:l("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),l("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 flex space-x-2 z-10",children:i.map((b,w)=>l("button",{onClick:()=>d(w),className:`w-3 h-3 rounded-full transition-all duration-200 ${w===t?"bg-white w-8":"bg-white bg-opacity-40 hover:bg-opacity-70"}`,"aria-label":`Go to slide ${w+1}`},w))}),l("div",{className:"absolute bottom-0 left-0 w-full h-1 bg-white bg-opacity-10",children:l("div",{className:"h-full bg-white transition-all duration-5000 ease-linear",style:{width:`${(t+1)/i.length*100}%`,transitionDuration:"5000ms"}})})]})},Vk=({setCurrentPage:e,setSelectedComponents:t})=>{const[r,n]=N.useState(null),[a,i]=N.useState(!1),[s,o]=N.useState(0),[c,u]=N.useState(""),[d,f]=N.useState(""),[m,p]=N.useState(!1),[x,g]=N.useState([]),[y,v]=N.useState(!0),b=async X=>{try{const H=X.component_ids||X.componentIds||{};if(!H||typeof H!="object"||Object.keys(H).length===0)return X.price||0;const L=Object.values(H).map(ee=>typeof ee=="string"?parseInt(ee,10):ee).filter(ee=>Number.isFinite(ee)&&ee>0);if(L.length===0)return X.price||0;const W=`${ke}/get_components_by_ids.php?ids=${L.join(",")}`,B=await(await fetch(W)).json();if(B.success&&Array.isArray(B.data)){const ee=B.data.reduce((le,R)=>{const j=typeof R.price=="number"?R.price:parseFloat(R.price)||0;return le+j},0);return ee>0?ee:X.price||0}}catch(H){console.error("Error recalculating price:",H)}return X.price||0};N.useEffect(()=>{(async()=>{try{const L=await(await fetch(`${ke}/prebuilts.php`)).json();if(Array.isArray(L)){const W=await Promise.all(L.map(async ie=>{const B=await b(ie);return{...ie,price:B}}));g(W)}else g([])}catch(H){console.error("Error fetching prebuilts:",H),g([])}finally{v(!1)}})()},[]);const w={cpu:["cpu","processor","procie","procie only","processor only"],motherboard:["motherboard","mobo"],gpu:["gpu","graphics","graphics card","video","video card","vga"],ram:["ram","memory","ddr","ddr4","ddr5"],storage:["storage","ssd","nvme","hdd","hard drive","drive"],psu:["psu","power supply","psu - tr","tr psu"],case:["case","chassis","case gaming"],cooler:["cooler","coolers","aio","cooling","cpu cooler","water cooling","liquid cooler","fan","heatsink"]};async function k(X){if(!X||typeof X!="object")return{};const H=Object.values(X).map(B=>typeof B=="string"?parseInt(B,10):B).filter(B=>Number.isFinite(B)&&B>0);if(H.length===0)return{};const L=`${ke}/get_components_by_ids.php?ids=${H.join(",")}`,ie=await(await fetch(L)).json();if(ie.success&&ie.data){const B={};return ie.data.forEach(ee=>{const le=Object.keys(X).find(R=>X[R]==ee.id);le&&(B[le]=ee)}),B}return{}}async function S(X){const L={cpu:"CPU",motherboard:"Motherboard",gpu:"GPU",ram:"RAM",storage:"Storage",psu:"PSU",case:"Case",cooler:"Cooler"}[X];if(!L)return null;try{const W=`${ke}/index.php?endpoint=components&category=${encodeURIComponent(L)}`,B=await(await fetch(W)).json();if(!B.success||!Array.isArray(B.data)||B.data.length===0)return null;const ee=B.data.slice();return ee.sort((le,R)=>(Number(le.price)||0)-(Number(R.price)||0)),ee[0]||null}catch{return null}}const _=async X=>{try{let H={};X.component_ids?typeof X.component_ids=="string"?H=JSON.parse(X.component_ids):H=X.component_ids:X.componentIds&&(H=X.componentIds);const L=await k(H),W={},ie=Object.keys(L).reduce((j,V)=>(j[V.toLowerCase()]=L[V],j),{});Object.entries(w).forEach(([j,V])=>{for(const P of V)if(ie[P]){W[j]=ie[P];break}}),Object.keys(L).forEach(j=>{w[j]&&(W[j]=L[j])});const B=Object.keys(H||{}).map(j=>j.toLowerCase());if((w.cooler||[]).some(j=>B.includes(j))&&!W.cooler){const j=await S("cooler");j&&(W.cooler=j)}const R=["cpu","motherboard","gpu","ram","storage","psu","case"].filter(j=>!W[j]);R.length>0&&(await Promise.all(R.map(V=>S(V)))).forEach((V,P)=>{V&&(W[R[P]]=V)});try{localStorage.setItem("builditpc-selected-components",JSON.stringify(W)),localStorage.setItem("builditpc-editing-build",JSON.stringify({name:(X.name||"Prebuilt")+" (Prebuilt)",description:X.description||""}))}catch{}t&&t(W),e("pc-assembly")}catch(H){console.error("Error loading prebuilt components:",H),alert("Error loading prebuilt components. Please try again.")}},C=[{icon:l(rs,{className:"w-8 h-8"}),title:"Lightning Fast",description:"Build your dream PC in minutes with our intuitive interface"},{icon:l(Ta,{className:"w-8 h-8"}),title:"100% Compatible",description:"Advanced compatibility checking ensures all parts work together"},{icon:l(Df,{className:"w-8 h-8"}),title:"Expert Support",description:"Get help from our PC building experts anytime"},{icon:l(Yh,{className:"w-8 h-8"}),title:"Best Prices",description:"Competitive prices on all components and prebuilt systems"}],E=[{id:"general",name:"General Feedback",color:"bg-blue-50 text-blue-700 border-blue-200"},{id:"bug",name:"Bug Report",color:"bg-red-50 text-red-700 border-red-200"},{id:"feature",name:"Feature Request",color:"bg-green-50 text-green-700 border-green-200"},{id:"compatibility",name:"Compatibility Issue",color:"bg-purple-50 text-purple-700 border-purple-200"},{id:"pricing",name:"Pricing Feedback",color:"bg-yellow-50 text-yellow-700 border-yellow-200"},{id:"ui",name:"User Interface",color:"bg-indigo-50 text-indigo-700 border-indigo-200"}],A=[{id:1,question:"How does SIMS's compatibility checker work?",answer:"Our advanced compatibility checker uses a sophisticated algorithm that analyzes multiple aspects of your selected components in real-time. It checks CPU socket compatibility with motherboards (ensuring AM5 CPUs work with AM5 motherboards, LGA1700 with LGA1700, etc.), validates RAM type matching (DDR4 vs DDR5), calculates power supply wattage requirements based on component TDP ratings, and verifies case form factor compatibility. The system also considers physical dimensions, cooling requirements, and expansion slot availability. When you select components, the checker immediately updates the compatibility score and provides specific feedback on any issues, helping you make informed decisions before purchasing."},{id:2,question:"Can I save my PC build for later?",answer:"Currently, SIMS operates as a real-time building and compatibility checking platform. While we don't have a persistent save feature yet, you can easily recreate your build by selecting the same components from our comprehensive database. We're actively developing build saving, sharing, and export features that will allow you to save multiple builds, share them with friends, export parts lists to retailers, and even receive notifications when component prices change. These features will be available in upcoming updates, making it easier to plan and compare different build configurations over time."},{id:3,question:"Are the component prices on SIMS accurate?",answer:"The prices shown on SIMS are carefully researched market prices in Philippine Peso (â‚±) based on current retail data from major Philippine retailers and online marketplaces. However, actual prices may vary due to factors like regional availability, seasonal fluctuations, import duties, and retailer-specific promotions. We recommend using our prices as a baseline for budgeting and comparison, then checking with local retailers like PCHub, DynaQuest, EasyPC, or online platforms like Lazada and Shopee for the most current pricing. Our price estimates are updated regularly to reflect market trends and new product releases."},{id:4,question:"How often is the component database updated?",answer:"Our component database is continuously updated through multiple channels. We add new CPU and GPU releases within 24-48 hours of their official announcement, update motherboard specifications as manufacturers release new models, and refresh pricing data weekly. Our team monitors major tech announcements, manufacturer websites, and retailer catalogs to ensure comprehensive coverage. We also update component specifications, compatibility rules, and performance benchmarks based on the latest reviews and testing data. This ensures you always have access to the most current information when making your build decisions, including the latest Intel 14th gen, AMD Ryzen 7000 series, and NVIDIA RTX 4000 series components."},{id:5,question:"What if the compatibility checker shows issues with my build?",answer:"When compatibility issues are detected, our system provides detailed analysis and actionable solutions. For CPU-motherboard mismatches, we'll suggest compatible alternatives or explain the socket requirements. RAM compatibility issues include recommendations for the correct DDR4/DDR5 modules and supported speeds. Power supply warnings show your estimated power draw and suggest appropriate wattage ratings. Case compatibility issues detail form factor requirements and suggest suitable alternatives. The system also provides performance impact assessments, helping you understand how different component choices affect your build's capabilities. You can use our 'Find Compatible' feature to automatically suggest alternatives that resolve the conflicts while maintaining your performance goals."},{id:6,question:"Can I use SIMS on mobile devices?",answer:"SIMS is fully responsive and optimized for all devices, including smartphones and tablets. The interface automatically adapts to your screen size, with touch-friendly buttons, swipe gestures for component browsing, and optimized layouts for smaller screens. While the desktop experience offers the most comprehensive view with side-by-side component comparison and detailed specifications, the mobile version provides full functionality for building and checking compatibility. You can browse components, check compatibility, view prebuilt recommendations, and access the FAQ section seamlessly on any device. The mobile interface prioritizes essential features while maintaining the same accuracy and reliability as the desktop version."},{id:7,question:"How accurate are the prebuilt PC recommendations?",answer:"Our prebuilt PC recommendations are meticulously curated by a team of PC building experts who analyze market trends, performance benchmarks, and user requirements. Each system is tested for compatibility, performance, and value-for-money across different use cases. Gaming builds are optimized for frame rates and graphics performance, streaming builds balance CPU and GPU requirements for content creation, and workstation builds prioritize multi-core performance and reliability. We regularly update these recommendations based on new component releases, price changes, and performance improvements. Each prebuilt includes detailed specifications, estimated performance metrics, and upgrade paths, helping you understand exactly what you're getting and how it can be improved over time."},{id:8,question:"Does SIMS provide assembly instructions?",answer:"While SIMS primarily focuses on component selection and compatibility checking, we provide comprehensive guidance throughout the PC building process. Our platform includes general assembly tips, component installation order recommendations, and common troubleshooting advice. For detailed step-by-step assembly instructions, we recommend consulting the manufacturer manuals that come with each component, as they contain specific installation procedures and safety guidelines. We also provide links to trusted assembly guides and video tutorials from reputable sources. For users who prefer professional assembly, we can recommend local PC building services and provide guidance on what to look for when choosing an assembler. Our goal is to make the entire PC building journey as smooth as possible, from planning to completion."},{id:9,question:"Can I compare different component options side by side?",answer:"Yes! SIMS offers comprehensive component comparison features. You can preview individual components to see detailed specifications, performance benchmarks, and user reviews. The compatibility checker helps you understand how different component combinations work together, showing the impact of each choice on your overall build performance and compatibility. You can compare multiple CPUs, GPUs, or other components side-by-side to see differences in specifications, power consumption, and performance metrics. The system also provides performance estimates for different combinations, helping you make informed decisions based on your specific needs and budget. Whether you're choosing between AMD and Intel processors, different GPU tiers, or various storage options, our comparison tools help you understand the trade-offs and make the best choice for your build."},{id:10,question:"Is SIMS free to use?",answer:"Yes, SIMS is completely free to use! All our core features are available at no cost, including the advanced compatibility checker, comprehensive component database, prebuilt PC recommendations, and all platform tools. We believe that PC building should be accessible to everyone, regardless of budget constraints. Our business model is supported through partnerships with retailers and manufacturers, allowing us to provide accurate pricing and product information while keeping the platform free for users. We're committed to maintaining this free access while continuously improving our features and expanding our component database. There are no hidden fees, premium tiers, or paid features - everything you need to build your perfect PC is available completely free of charge."}],T=X=>{n(r===X?null:X)},D=async X=>{X.preventDefault();try{const L=await(await fetch(`${ke}/submit_feedback.php`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rating:s,category:c,message:d})})).json().catch(()=>({}));L&&L.success?(p(!0),setTimeout(()=>{p(!1),o(0),u(""),f(""),i(!1)},2e3)):alert("Failed to submit feedback. Please try again later.")}catch(H){console.error("Feedback submit error:",H),alert("Failed to submit feedback. Please try again later.")}},I=()=>{o(0),u(""),f(""),p(!1)},z=X=>{switch(X){case"gaming":return l(rs,{className:"w-5 h-5"});case"workstation":return l(Yh,{className:"w-5 h-5"});case"cooling":return l(Ta,{className:"w-5 h-5"});default:return l(Ra,{className:"w-5 h-5"})}};return h("div",{className:"min-h-screen bg-gray-50",children:[l(pL,{setCurrentPage:e}),l("section",{className:"py-12 lg:py-20 bg-white px-4 lg:px-8",children:h("div",{className:"max-w-7xl mx-auto",children:[h("div",{className:"text-center mb-12 lg:mb-16",children:[l("h2",{className:"text-3xl lg:text-4xl font-bold text-gray-900 mb-4",children:"Why Choose SIMS?"}),l("p",{className:"text-lg lg:text-xl text-gray-600 max-w-3xl mx-auto",children:"We make PC building simple, reliable, and enjoyable. Our platform ensures you get the perfect build every time."})]}),l("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 lg:gap-8",children:C.map((X,H)=>h("div",{className:"text-center p-4 lg:p-6 rounded-lg hover:bg-gray-50 transition-colors",children:[l("div",{className:"w-12 h-12 lg:w-16 lg:h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4 text-green-600",children:X.icon}),l("h3",{className:"text-lg lg:text-xl font-semibold text-gray-900 mb-2",children:X.title}),l("p",{className:"text-gray-600 text-sm lg:text-base",children:X.description})]},H))})]})}),l("section",{className:"py-12 lg:py-20 bg-gray-50 px-4 lg:px-8",children:h("div",{className:"max-w-7xl mx-auto",children:[h("div",{className:"text-center mb-12 lg:mb-16",children:[l("h2",{className:"text-3xl lg:text-4xl font-bold text-gray-900 mb-4",children:"Prebuilt PC Recommendations"}),l("p",{className:"text-lg lg:text-xl text-gray-600 max-w-3xl mx-auto",children:"Not sure where to start? Check out our expertly curated prebuilt configurations for different use cases and budgets."})]}),l("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:y?l("div",{className:"text-center py-12",children:l("p",{children:"Loading prebuilt PC recommendations..."})}):x.length===0?l("div",{className:"text-center py-12",children:l("p",{children:"No prebuilt PC recommendations found. Please check back later or try a different search."})}):x.slice(0,3).map(X=>l("div",{onClick:()=>_(X),className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-lg transition-all duration-300 cursor-pointer transform hover:scale-105 hover:border-green-300",children:h("div",{className:"p-6",children:[h("div",{className:"mb-4",children:[l("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:X.name}),h("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[z(X.category),l("span",{className:"capitalize",children:X.category})]})]}),l("div",{className:"mb-4",children:l("div",{className:"flex items-center gap-2",children:l("span",{className:"text-3xl font-bold text-green-600",children:it(X.price,{minimumFractionDigits:0,maximumFractionDigits:0})})})}),X.description&&l("div",{className:"mb-4",children:l("p",{className:"text-sm text-gray-600",children:X.description})}),(()=>{let H=null;if(X.performance)if(typeof X.performance=="string")try{H=JSON.parse(X.performance)}catch{H=null}else H=X.performance;return H&&(H.gaming||H.streaming)?h("div",{className:"mb-4 space-y-2",children:[H.gaming&&h(gt,{children:[h("div",{className:"flex items-center justify-between text-sm",children:[l("span",{className:"text-gray-600",children:"Gaming"}),h("span",{className:"font-medium",children:[H.gaming,"%"]})]}),l("div",{className:"w-full bg-gray-200 rounded-full h-2",children:l("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-500",style:{width:`${H.gaming}%`}})})]}),H.streaming&&h(gt,{children:[h("div",{className:"flex items-center justify-between text-sm",children:[l("span",{className:"text-gray-600",children:"Streaming"}),h("span",{className:"font-medium",children:[H.streaming,"%"]})]}),l("div",{className:"w-full bg-gray-200 rounded-full h-2",children:l("div",{className:"bg-purple-600 h-2 rounded-full transition-all duration-500",style:{width:`${H.streaming}%`}})})]})]}):null})(),(()=>{let H=null;if(X.features)if(typeof X.features=="string")try{H=JSON.parse(X.features)}catch{H=null}else H=X.features;return H&&H.length>0?l("div",{className:"mb-6",children:l("div",{className:"flex flex-wrap gap-1",children:H.slice(0,3).map((L,W)=>l("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs",children:L},W))})}):null})(),l("div",{className:"mb-4 text-center",children:l("p",{className:"text-sm text-gray-500 italic",children:"Click to view in PC Assembly"})}),h("button",{onClick:H=>{H.stopPropagation(),_(X)},className:"w-full bg-green-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center justify-center gap-2",children:[l(Qi,{className:"w-4 h-4"}),"View Details"]})]})},X.id))})]})}),l("section",{className:"py-12 lg:py-20 bg-white px-4 lg:px-8",children:l("div",{className:"max-w-7xl mx-auto",children:h("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-16 items-center",children:[h("div",{children:[l("h2",{className:"text-3xl lg:text-4xl font-bold text-gray-900 mb-4 lg:mb-6",children:"Advanced Compatibility Checking"}),l("p",{className:"text-lg lg:text-xl text-gray-600 mb-6 lg:mb-8",children:"Our intelligent system checks compatibility between all components in real-time, ensuring your build will work perfectly together."}),h("div",{className:"space-y-3 lg:space-y-4",children:[h("div",{className:"flex items-center gap-3",children:[l(At,{className:"w-5 h-5 lg:w-6 lg:h-6 text-green-600"}),l("span",{className:"text-base lg:text-lg text-gray-700",children:"CPU and motherboard socket compatibility"})]}),h("div",{className:"flex items-center gap-3",children:[l(At,{className:"w-5 h-5 lg:w-6 lg:h-6 text-green-600"}),l("span",{className:"text-base lg:text-lg text-gray-700",children:"RAM type and speed validation"})]}),h("div",{className:"flex items-center gap-3",children:[l(At,{className:"w-5 h-5 lg:w-6 lg:h-6 text-green-600"}),l("span",{className:"text-base lg:text-lg text-gray-700",children:"Power supply wattage requirements"})]}),h("div",{className:"flex items-center gap-3",children:[l(At,{className:"w-5 h-5 lg:w-6 lg:h-6 text-green-600"}),l("span",{className:"text-base lg:text-lg text-gray-700",children:"Case and motherboard form factor matching"})]})]})]}),l("div",{className:"bg-gray-100 rounded-lg p-6 lg:p-8",children:h("div",{className:"space-y-4",children:[l("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:h("div",{className:"flex items-center justify-between",children:[l("span",{className:"font-medium",children:"Compatibility Score"}),l("span",{className:"text-green-600 font-bold",children:"100%"})]})}),l("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:h("div",{className:"flex items-center justify-between",children:[l("span",{className:"font-medium",children:"Total Price"}),l("span",{className:"text-green-600 font-bold",children:"â‚±45,999"})]})}),l("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:h("div",{className:"flex items-center justify-between",children:[l("span",{className:"font-medium",children:"Build Status"}),l("span",{className:"text-green-600 font-bold",children:"Ready"})]})})]})})]})})}),l("section",{className:"py-12 lg:py-20 bg-gray-50 px-4 lg:px-8",children:h("div",{className:"max-w-4xl mx-auto",children:[h("div",{className:"text-center mb-12 lg:mb-16",children:[h("div",{className:"flex items-center justify-center gap-3 mb-4",children:[l(Yy,{className:"w-8 h-8 text-green-600"}),l("h2",{className:"text-3xl lg:text-4xl font-bold text-gray-900",children:"Frequently Asked Questions"})]}),l("p",{className:"text-lg lg:text-xl text-gray-600 max-w-3xl mx-auto",children:"Got questions about SIMS? We've got answers. Find everything you need to know about our platform and PC building."})]}),l("div",{className:"space-y-4",children:A.map(X=>h("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[h("button",{onClick:()=>T(X.id),className:"w-full px-6 py-4 text-left flex items-center justify-between hover:bg-gray-50 transition-colors",children:[l("span",{className:"text-lg font-medium text-gray-900",children:X.question}),r===X.id?l(cb,{className:"w-5 h-5 text-gray-500"}):l(Pf,{className:"w-5 h-5 text-gray-500"})]}),r===X.id&&l("div",{className:"px-6 pb-4",children:l("p",{className:"text-gray-600 leading-relaxed",children:X.answer})})]},X.id))})]})}),l("section",{className:"py-12 lg:py-20 bg-white px-4 lg:px-8",children:h("div",{className:"max-w-4xl mx-auto text-center",children:[h("div",{className:"mb-8",children:[l("h2",{className:"text-3xl lg:text-4xl font-bold text-gray-900 mb-4",children:"Help Us Improve"}),l("p",{className:"text-lg lg:text-xl text-gray-600 max-w-2xl mx-auto",children:"Your feedback helps us make SIMS better for everyone. Share your thoughts, report issues, or suggest new features."})]}),h("button",{onClick:()=>i(!0),className:"bg-green-600 text-white px-8 py-4 rounded-lg font-semibold text-lg hover:bg-green-700 transition-colors flex items-center gap-3 mx-auto",children:[l(ca,{className:"w-6 h-6"}),"Give Feedback"]})]})}),l("section",{className:"py-12 lg:py-20 bg-green-600 text-white px-4 lg:px-8",children:h("div",{className:"max-w-7xl mx-auto text-center",children:[l("h2",{className:"text-3xl lg:text-4xl font-bold mb-4 lg:mb-6",children:"Ready to Build Your Dream PC?"}),l("p",{className:"text-lg lg:text-xl mb-6 lg:mb-8 max-w-2xl mx-auto",children:"Join thousands of users who have successfully built their perfect PC using our platform. Start your build today!"}),h("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[h("button",{onClick:()=>e("pc-assembly"),className:"bg-white text-green-600 px-6 lg:px-8 py-3 lg:py-4 rounded-lg font-semibold text-base lg:text-lg hover:bg-gray-100 transition-colors flex items-center gap-3",children:["Get Started Now",l(Qi,{className:"w-5 h-5"})]}),h("button",{onClick:()=>e("prebuilt-pcs"),className:"bg-transparent border border-white text-white px-6 lg:px-8 py-3 lg:py-4 rounded-lg font-semibold text-base lg:text-lg hover:bg-white hover:text-green-600 transition-colors flex items-center gap-3",children:["View Prebuilts",l(Qi,{className:"w-5 h-5"})]})]})]})}),l("button",{onClick:()=>e("chat-support"),"aria-label":"Open chat support",className:"fixed bottom-6 right-6 bg-green-600 text-white rounded-full shadow-lg hover:bg-green-700 transition-colors p-4 z-40 flex items-center justify-center",children:l(ca,{className:"w-6 h-6"})}),a&&l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:h("div",{className:"p-6 lg:p-8",children:[h("div",{className:"flex items-center justify-between mb-6",children:[l("h3",{className:"text-2xl lg:text-3xl font-bold text-gray-900",children:"Share Your Feedback"}),l("button",{onClick:()=>{i(!1),I()},className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:l(Yr,{className:"w-6 h-6 text-gray-500"})})]}),m?h("div",{className:"text-center p-6 bg-green-50 rounded-lg border border-green-200",children:[h("div",{className:"flex items-center justify-center gap-3 mb-2",children:[l(At,{className:"w-6 h-6 text-green-600"}),l("h4",{className:"text-lg font-semibold text-green-800",children:"Thank You!"})]}),l("p",{className:"text-green-700",children:"Your feedback has been submitted successfully. We appreciate your input and will use it to improve SIMS!"})]}):h("form",{onSubmit:D,className:"space-y-6",children:[h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"How would you rate your experience with SIMS?"}),l("div",{className:"flex justify-center gap-2",children:[1,2,3,4,5].map(X=>l("button",{type:"button",onClick:()=>o(X),className:`p-2 rounded-lg transition-colors ${s>=X?"text-yellow-400 bg-yellow-50":"text-gray-300 hover:text-yellow-400"}`,children:l(nL,{className:`w-8 h-8 ${s>=X?"fill-current":""}`})},X))})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"What type of feedback is this?"}),l("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-3",children:E.map(X=>l("button",{type:"button",onClick:()=>u(X.id),className:`p-3 rounded-lg border-2 transition-colors flex items-center gap-2 text-sm ${c===X.id?`border-current ${X.color}`:"border-gray-200 hover:border-gray-300 text-gray-700"}`,children:X.name},X.id))})]}),h("div",{children:[l("label",{htmlFor:"feedback-message",className:"block text-sm font-medium text-gray-700 mb-3",children:"Tell us more about your experience"}),l("textarea",{id:"feedback-message",value:d,onChange:X=>f(X.target.value),placeholder:"Share your thoughts, suggestions, or report any issues you encountered...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none",rows:"4",required:!0})]}),h("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[h("button",{type:"submit",disabled:!s||!c||!d.trim(),className:"bg-green-600 text-white px-6 lg:px-8 py-3 lg:py-4 rounded-lg font-semibold hover:bg-green-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center gap-3 justify-center",children:[l(yu,{className:"w-5 h-5"}),"Submit Feedback"]}),l("button",{type:"button",onClick:()=>{i(!1),I()},className:"border-2 border-gray-300 text-gray-700 px-6 lg:px-8 py-3 lg:py-4 rounded-lg font-semibold hover:bg-gray-50 transition-colors",children:"Cancel"})]})]})]})})}),h("footer",{className:"bg-gray-900 text-white",children:[l("div",{className:"max-w-7xl mx-auto px-4 lg:px-8 py-12 lg:py-16",children:h("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 lg:gap-12",children:[l("div",{className:"lg:col-span-1",children:h("div",{className:"mb-6",children:[l("h3",{className:"text-2xl lg:text-3xl font-bold text-green-400 mb-2",children:"SIMS"}),l("p",{className:"text-gray-300 text-sm lg:text-base leading-relaxed",children:"The ultimate platform for building your perfect PC. Check compatibility, compare prices, and create your dream build with confidence."})]})}),h("div",{children:[l("h4",{className:"text-lg font-semibold mb-4",children:"Quick Links"}),h("ul",{className:"space-y-2",children:[l("li",{children:l("button",{onClick:()=>e("pc-assembly"),className:"text-gray-300 hover:text-white transition-colors",children:"PC Assembly"})}),l("li",{children:l("button",{onClick:()=>e("prebuilt-pcs"),className:"text-gray-300 hover:text-white transition-colors",children:"Prebuilt PCs"})})]})]}),h("div",{children:[l("h4",{className:"text-lg font-semibold mb-4",children:"Support"}),l("ul",{className:"space-y-2",children:l("li",{children:l("button",{onClick:()=>e("faq"),className:"text-gray-300 hover:text-white transition-colors",children:"FAQ"})})})]}),h("div",{children:[l("h4",{className:"text-lg font-semibold mb-4",children:"Contact Info"}),h("div",{className:"space-y-2 text-gray-300",children:[l("p",{children:"Email: support@builditpc.com"}),l("p",{children:"Phone: +63 912 345 6789"}),l("p",{children:"Address: Ground flr JSP Bldg. 9109 National rd. Cay Pombo, Santa Maria, Philippines"})]})]})]})}),l("div",{className:"border-t border-gray-800",children:l("div",{className:"max-w-7xl mx-auto px-4 lg:px-8 py-6",children:h("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[l("p",{className:"text-gray-400 text-sm",children:"Â© 2025 SIMS. All rights reserved."}),l("div",{className:"mt-4 md:mt-0"})]})})})]})]})},Kk=e=>e.socket?"cpu":e.chipset||e.ram_type||e.form_factor?"motherboard":e.chipset&&e.memory?"gpu":e.type&&e.speed?"ram":e.capacity&&e.type&&(e.type.toLowerCase().includes("ssd")||e.type.toLowerCase().includes("hdd"))?"storage":e.wattage&&e.efficiency?"psu":e.form_factor&&e.fans?"case":e.type&&e.tdp?"cooler":"default",gL=({selectedComponents:e={},onComponentSelect:t=()=>{},onComponentRemove:r=()=>{},activeCategory:n="",prefetchedComponents:a=[],recommendations:i=[],loadingRecommendations:s=!1,compatibilityIssues:o=[],branch:c=null})=>{const[u,d]=N.useState(""),[f,m]=N.useState("name"),p=N.useMemo(()=>!a||a.length===0?[]:a,[a]),x=N.useMemo(()=>p.filter(v=>v.name.toLowerCase().includes(u.toLowerCase())||v.brand&&v.brand.toLowerCase().includes(u.toLowerCase())),[p,u]),g=N.useMemo(()=>[...x].sort((v,b)=>{switch(f){case"price":return(v.price||0)-(b.price||0);case"name":return(v.name||"").localeCompare(b.name||"");default:return 0}}),[x,f]),y=e[n];return!a||a.length===0?l("div",{className:"space-y-6",children:h("div",{className:"text-center py-12",children:[l(nt,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No components available"}),l("p",{className:"text-gray-600",children:"Components are being loaded..."})]})}):h("div",{className:"space-y-6",children:[h("div",{className:"flex flex-col sm:flex-row gap-4",children:[h("div",{className:"flex-1 relative",children:[l(Di,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),l("input",{type:"text",placeholder:`Search ${n||"components"}...`,value:u,onChange:v=>d(v.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),l("div",{className:"flex gap-2",children:h("select",{value:f,onChange:v=>m(v.target.value),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[l("option",{value:"name",children:"Sort by Name"}),l("option",{value:"price",children:"Sort by Price"})]})})]}),o.length>0&&h("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-4",children:[h("div",{className:"flex items-center gap-2 mb-3",children:[l(Fn,{className:"w-5 h-5 text-orange-600"}),l("h3",{className:"text-sm font-semibold text-orange-900",children:"Compatibility Warnings"})]}),l("div",{className:"space-y-2",children:o.map((v,b)=>l("p",{className:"text-sm text-orange-800",children:v.message},b))})]}),y&&l("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:h("div",{className:"flex items-center justify-between",children:[h("div",{className:"flex items-center gap-4",children:[l(At,{className:"w-8 h-8 text-green-600"}),h("div",{children:[l("h3",{className:"font-semibold text-green-900",children:"Currently Selected"}),l("p",{className:"text-green-700",children:y.name}),l("p",{className:"text-sm text-green-600",children:it(y.price)})]})]}),l("button",{onClick:()=>r(n),className:"px-3 py-2 text-red-700 bg-red-100 rounded-lg hover:bg-red-200 transition-colors",children:"Remove"})]})}),i.length>0&&h("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:[l("h3",{className:"text-sm font-semibold text-blue-900 mb-3",children:"Recommended Components"}),l("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:i.slice(0,3).map(v=>l("div",{className:"bg-white rounded-lg p-3 border border-blue-200 hover:border-blue-300 transition-colors",children:h("div",{className:"flex items-center gap-3",children:[h("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0",children:[l("img",{src:xr(v.name,Kk(v)),alt:v.name,className:"w-10 h-10 rounded object-cover",onError:b=>{b.target.style.display="none",b.target.nextSibling&&(b.target.nextSibling.style.display="flex")}}),l("div",{className:"hidden w-10 h-10 bg-gray-200 rounded items-center justify-center",children:l(nt,{className:"w-5 h-5 text-gray-400"})})]}),h("div",{className:"flex-1 min-w-0",children:[l("h5",{className:"text-sm font-semibold text-gray-900 truncate",children:v.name}),l("span",{className:"text-sm font-bold text-blue-600",children:it(v.price)})]}),h("button",{className:"flex items-center gap-1 px-3 py-1.5 bg-blue-600 text-white text-xs font-medium rounded-lg hover:bg-blue-700 transition-colors",onClick:()=>t(n,v),children:[l(Qi,{className:"w-3 h-3"}),"Select"]})]})},v.id))})]}),l("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map(v=>l("div",{className:`bg-white rounded-lg border-2 transition-all duration-200 hover:shadow-lg ${(y==null?void 0:y.id)===v.id?"border-green-500 shadow-lg":"border-gray-200 hover:border-gray-300"}`,children:h("div",{className:"p-6",children:[h("div",{className:"w-full h-32 bg-gray-100 rounded-lg mb-4 flex items-center justify-center",children:[l("img",{src:xr(v.name,Kk(v)),alt:v.name,className:"w-full h-full object-cover rounded-lg",onError:b=>{b.target.style.display="none",b.target.nextSibling&&(b.target.nextSibling.style.display="flex")}}),l("div",{className:"hidden w-full h-full items-center justify-center text-gray-400",children:l(nt,{className:"w-12 h-12"})})]}),h("div",{className:"space-y-3",children:[h("div",{children:[l("h3",{className:"font-semibold text-gray-900 text-lg mb-1",children:v.name}),v.brand&&l("p",{className:"text-sm text-gray-600 mb-2",children:v.brand}),l("div",{className:"flex items-center justify-between",children:l("span",{className:"text-2xl font-bold text-green-600",children:it(v.price)})})]}),l("div",{className:"flex gap-2 pt-2",children:l("button",{onClick:()=>t(n,v),className:`flex-1 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${(y==null?void 0:y.id)===v.id?"bg-green-600 text-white":"bg-green-600 text-white hover:bg-green-700"}`,children:(y==null?void 0:y.id)===v.id?h(gt,{children:[l(At,{className:"w-4 h-4 inline mr-1"}),"Selected"]}):h(gt,{children:[l(wn,{className:"w-4 h-4 inline mr-1"}),"Select"]})})})]})]})},v.id))}),g.length===0&&h("div",{className:"text-center py-12",children:[l(Di,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No components found"}),l("p",{className:"text-gray-600",children:"Try adjusting your search terms."})]})]})},xL=({compatibilityStatus:e,compatibilityScore:t,compatibilityDetails:r={},selectionProgress:n=0})=>{const i=[{id:"cpu_motherboard",name:"CPU & Motherboard",description:"Socket compatibility check",status:e.cpu_motherboard,detail:r.cpu_motherboard,icon:l(Ra,{className:"w-5 h-5"}),critical:!0},{id:"ram_motherboard",name:"RAM & Motherboard",description:"Memory type and speed compatibility",status:e.ram_motherboard,detail:r.ram_motherboard,icon:l(lo,{className:"w-5 h-5"}),critical:!0},{id:"ram_slots",name:"RAM Slots",description:"RAM modules vs motherboard slots",status:e.ram_slots,detail:r.ram_slots,icon:l(lo,{className:"w-5 h-5"}),critical:!0},{id:"ram_speed",name:"RAM Speed",description:"Memory speed vs motherboard support",status:e.ram_speed,detail:r.ram_speed,icon:l(lo,{className:"w-5 h-5"}),critical:!1},{id:"storage_interface",name:"Storage Interface",description:"Storage connection compatibility",status:e.storage_interface,detail:r.storage_interface,icon:l(Of,{className:"w-5 h-5"}),critical:!0},{id:"psu_power",name:"Power Supply",description:"Adequate power for components",status:e.psu_power,detail:r.psu_power,icon:l(rs,{className:"w-5 h-5"}),critical:!0},{id:"psu_form_factor",name:"PSU Form Factor",description:"PSU size vs case support",status:e.psu_form_factor,detail:r.psu_form_factor,icon:l(rs,{className:"w-5 h-5"}),critical:!0},{id:"case_motherboard",name:"Case & Motherboard",description:"Form factor compatibility",status:e.case_motherboard,detail:r.case_motherboard,icon:l(nt,{className:"w-5 h-5"}),critical:!0},{id:"gpu_length",name:"GPU & Case",description:"Graphics card length fit",status:e.gpu_length,detail:r.gpu_length,icon:l(Is,{className:"w-5 h-5"}),critical:!0},{id:"cooler_height",name:"CPU Cooler & Case",description:"Cooler height clearance",status:e.cooler_height,detail:r.cooler_height,icon:l(Rs,{className:"w-5 h-5"}),critical:!1},{id:"cooler_socket",name:"CPU Cooler Socket",description:"Cooler socket compatibility",status:e.cooler_socket,detail:r.cooler_socket,icon:l(Rs,{className:"w-5 h-5"}),critical:!0},{id:"ram_cpu_speed",name:"RAM & CPU Speed",description:"Memory speed vs CPU support",status:e.ram_cpu_speed,detail:r.ram_cpu_speed,icon:l(lo,{className:"w-5 h-5"}),critical:!1}].filter(p=>p.status!==void 0),s=i.filter(p=>p.critical),o=i.filter(p=>!p.critical),c=p=>p===0?"text-gray-600":p>=90?"text-green-600":p>=70?"text-yellow-600":"text-red-600",u=p=>p===!0?l(At,{className:"w-6 h-6 text-green-600"}):p===!1?l(ka,{className:"w-6 h-6 text-red-600"}):l(Ac,{className:"w-6 h-6 text-gray-400"}),d=p=>p===!0?"Compatible":p===!1?"Incompatible":"Not checked",f=p=>p===0?"bg-gray-400":p>=90?"bg-green-500":p>=70?"bg-yellow-500":"bg-red-500",m=s.filter(p=>p.status===!1).length;return h("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-6 mb-6",children:[h("div",{className:"mb-8",children:[h("div",{className:"flex items-center justify-between mb-6",children:[h("div",{className:"flex items-center gap-3",children:[l("div",{className:"p-2 bg-blue-100 rounded-lg",children:l(Ta,{className:"w-6 h-6 text-blue-600"})}),h("div",{children:[l("h3",{className:"text-2xl font-bold text-gray-900",children:"Compatibility Checker"}),l("p",{className:"text-sm text-gray-600",children:"Real-time compatibility validation for your PC build"})]})]}),m>0&&h("div",{className:"flex items-center gap-2 px-4 py-2 bg-red-50 border border-red-200 rounded-lg",children:[l(ka,{className:"w-5 h-5 text-red-600"}),h("span",{className:"text-red-800 font-semibold",children:[m," Critical Issue",m>1?"s":""]})]})]}),h("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[h("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[h("div",{children:[h("div",{className:"flex items-center justify-between mb-2",children:[l("span",{className:"text-sm font-medium text-gray-700",children:"Component Selection"}),h("span",{className:"text-sm font-bold text-gray-900",children:[n,"%"]})]}),l("div",{className:"w-full bg-gray-200 rounded-full h-3",children:l("div",{className:`h-3 rounded-full transition-all duration-700 ${f(n)}`,style:{width:`${n}%`}})})]}),h("div",{children:[h("div",{className:"flex items-center justify-between mb-2",children:[l("span",{className:"text-sm font-medium text-gray-700",children:"Compatibility Score"}),h("span",{className:`text-sm font-bold ${c(t)}`,children:[t,"%"]})]}),l("div",{className:"w-full bg-gray-200 rounded-full h-3",children:l("div",{className:`h-3 rounded-full transition-all duration-700 ${f(t)}`,style:{width:`${t}%`}})})]})]}),l("div",{className:`p-3 rounded-lg border-l-4 ${n===0?"bg-blue-50 border-blue-400":t===100?"bg-green-50 border-green-400":m>0?"bg-red-50 border-red-400":"bg-yellow-50 border-yellow-400"}`,children:l("p",{className:`text-sm font-medium ${n===0?"text-blue-800":t===100?"text-green-800":m>0?"text-red-800":"text-yellow-800"}`,children:n===0?"Start building by selecting components from the categories above":n<100?`${7-Math.round(n/14.28)} more components needed to complete your build`:t===100?"Excellent! Your build is fully compatible and ready for assembly":t>0?`${t}% compatibility - ${m>0?"Fix critical issues below":"Minor optimizations available"}`:"Compatibility issues detected - review the checks below"})})]})]}),s.length>0&&h("div",{className:"mb-8",children:[h("div",{className:"flex items-center justify-between mb-6",children:[h("div",{className:"flex items-center gap-3",children:[l("div",{className:"p-2 bg-red-100 rounded-lg",children:l(Ta,{className:"w-5 h-5 text-red-600"})}),h("div",{children:[l("h4",{className:"text-xl font-bold text-gray-900",children:"Critical Compatibility Checks"}),l("p",{className:"text-sm text-gray-600",children:"These checks must pass for your build to work properly"})]})]}),h("div",{className:"text-right",children:[h("div",{className:"text-2xl font-bold text-gray-900",children:[s.filter(p=>p.status===!0).length,"/",s.length]}),l("div",{className:"text-sm text-gray-600",children:"Passed"})]})]}),l("div",{className:"grid gap-4",children:s.map(p=>l("div",{className:`p-5 rounded-xl border-2 transition-all duration-300 hover:shadow-md ${p.status===!0?"bg-green-50 border-green-200":p.status===!1?"bg-red-50 border-red-200":"bg-gray-50 border-gray-200"}`,children:h("div",{className:"flex items-start gap-4",children:[l("div",{className:`p-3 rounded-xl ${p.status===!0?"bg-green-100":p.status===!1?"bg-red-100":"bg-gray-100"}`,children:p.icon}),h("div",{className:"flex-1",children:[h("div",{className:"flex items-center justify-between mb-3",children:[l("h5",{className:"text-lg font-semibold text-gray-900",children:p.name}),h("div",{className:"flex items-center gap-2",children:[u(p.status),l("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${p.status===!0?"bg-green-100 text-green-800":p.status===!1?"bg-red-100 text-red-800":"bg-gray-100 text-gray-600"}`,children:d(p.status)})]})]}),l("p",{className:"text-gray-600 mb-3",children:p.description}),(p.status===!1||p.status===!0&&p.detail)&&p.detail&&l("div",{className:`p-3 rounded-lg border ${p.status===!1?"bg-red-50 border-red-200 text-red-800":"bg-blue-50 border-blue-200 text-blue-800"}`,children:h("div",{className:"flex items-start gap-2",children:[l(Fn,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),h("div",{className:"text-sm",children:[l("div",{className:"font-medium mb-1",children:p.status===!1?"Issue:":"Note:"}),l("div",{children:p.detail})]})]})})]})]})},p.id))})]}),o.length>0&&h("div",{className:"mb-8",children:[h("div",{className:"flex items-center justify-between mb-6",children:[h("div",{className:"flex items-center gap-3",children:[l("div",{className:"p-2 bg-blue-100 rounded-lg",children:l(Ac,{className:"w-5 h-5 text-blue-600"})}),h("div",{children:[l("h4",{className:"text-xl font-bold text-gray-900",children:"Additional Optimizations"}),l("p",{className:"text-sm text-gray-600",children:"These checks improve performance and efficiency"})]})]}),h("div",{className:"text-right",children:[h("div",{className:"text-2xl font-bold text-gray-900",children:[o.filter(p=>p.status===!0).length,"/",o.length]}),l("div",{className:"text-sm text-gray-600",children:"Optimized"})]})]}),l("div",{className:"grid gap-4",children:o.map(p=>l("div",{className:`p-5 rounded-xl border-2 transition-all duration-300 hover:shadow-md ${p.status===!0?"bg-green-50 border-green-200":p.status===!1?"bg-yellow-50 border-yellow-200":"bg-gray-50 border-gray-200"}`,children:h("div",{className:"flex items-start gap-4",children:[l("div",{className:`p-3 rounded-xl ${p.status===!0?"bg-green-100":p.status===!1?"bg-yellow-100":"bg-gray-100"}`,children:p.icon}),h("div",{className:"flex-1",children:[h("div",{className:"flex items-center justify-between mb-3",children:[l("h5",{className:"text-lg font-semibold text-gray-900",children:p.name}),h("div",{className:"flex items-center gap-2",children:[u(p.status),l("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${p.status===!0?"bg-green-100 text-green-800":p.status===!1?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-600"}`,children:d(p.status)})]})]}),l("p",{className:"text-gray-600 mb-3",children:p.description}),(p.status===!1||p.status===!0&&p.detail)&&p.detail&&l("div",{className:`p-3 rounded-lg border ${p.status===!1?"bg-yellow-50 border-yellow-200 text-yellow-800":"bg-blue-50 border-blue-200 text-blue-800"}`,children:h("div",{className:"flex items-start gap-2",children:[l(Fn,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),h("div",{className:"text-sm",children:[l("div",{className:"font-medium mb-1",children:p.status===!1?"Recommendation:":"Note:"}),l("div",{children:p.detail})]})]})})]})]})},p.id))})]}),l("div",{className:"mb-8",children:l("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-200 p-6",children:h("div",{className:"flex items-start gap-4",children:[l("div",{className:"p-3 bg-blue-100 rounded-lg",children:l(Jh,{className:"w-6 h-6 text-blue-600"})}),h("div",{className:"flex-1",children:[l("h4",{className:"text-lg font-semibold text-blue-900 mb-3",children:"Build Tips & Best Practices"}),h("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h("div",{children:[l("h5",{className:"font-medium text-blue-800 mb-2",children:"Essential Checks"}),h("ul",{className:"text-sm text-blue-700 space-y-1",children:[l("li",{children:"â€¢ CPU socket matches motherboard (AM4, AM5, LGA1200, LGA1700)"}),l("li",{children:"â€¢ RAM type compatibility (DDR4/DDR5) and speed support"}),l("li",{children:"â€¢ PSU wattage with 20% buffer for efficiency"}),l("li",{children:"â€¢ Case supports motherboard form factor"})]})]}),h("div",{children:[l("h5",{className:"font-medium text-blue-800 mb-2",children:"Performance Tips"}),h("ul",{className:"text-sm text-blue-700 space-y-1",children:[l("li",{children:"â€¢ Check GPU length and CPU cooler height clearance"}),l("li",{children:"â€¢ Consider aftermarket cooler for better performance"}),l("li",{children:"â€¢ Match RAM speed to CPU and motherboard support"}),l("li",{children:"â€¢ Ensure adequate case airflow and cooling"})]})]})]})]})]})})}),t===100&&l("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl border-2 border-green-200 p-6",children:h("div",{className:"flex items-center gap-4",children:[l("div",{className:"p-3 bg-green-100 rounded-full",children:l(At,{className:"w-8 h-8 text-green-600"})}),h("div",{className:"flex-1",children:[l("h4",{className:"text-xl font-bold text-green-900 mb-2",children:"Perfect Build Ready!"}),l("p",{className:"text-green-800 mb-3",children:"All components are fully compatible and your PC is ready for assembly."}),h("div",{className:"flex items-center gap-4 text-sm text-green-700",children:[h("span",{className:"flex items-center gap-1",children:[l(At,{className:"w-4 h-4"}),"All critical checks passed"]}),h("span",{className:"flex items-center gap-1",children:[l(At,{className:"w-4 h-4"}),"Build ready for assembly"]})]})]})]})}),t>0&&t<100&&m===0&&l("div",{className:"bg-gradient-to-r from-yellow-50 to-amber-50 rounded-xl border-2 border-yellow-200 p-6",children:h("div",{className:"flex items-center gap-4",children:[l("div",{className:"p-3 bg-yellow-100 rounded-full",children:l(Fn,{className:"w-8 h-8 text-yellow-600"})}),h("div",{className:"flex-1",children:[l("h4",{className:"text-xl font-bold text-yellow-900 mb-2",children:"Good Build with Optimizations Available"}),l("p",{className:"text-yellow-800 mb-3",children:"Your build will work well, but consider the optimization recommendations above for better performance."}),h("div",{className:"flex items-center gap-4 text-sm text-yellow-700",children:[h("span",{className:"flex items-center gap-1",children:[l(At,{className:"w-4 h-4"}),"All critical checks passed"]}),h("span",{className:"flex items-center gap-1",children:[l(Fn,{className:"w-4 h-4"}),"Minor optimizations available"]})]})]})]})}),m>0&&l("div",{className:"bg-gradient-to-r from-red-50 to-rose-50 rounded-xl border-2 border-red-200 p-6",children:h("div",{className:"flex items-center gap-4",children:[l("div",{className:"p-3 bg-red-100 rounded-full",children:l(ka,{className:"w-8 h-8 text-red-600"})}),h("div",{className:"flex-1",children:[l("h4",{className:"text-xl font-bold text-red-900 mb-2",children:"Critical Issues Must Be Fixed"}),h("p",{className:"text-red-800 mb-3",children:[m," critical compatibility issue",m>1?"s":""," detected. Your build will not work properly until these issues are resolved."]}),h("div",{className:"flex items-center gap-4 text-sm text-red-700",children:[h("span",{className:"flex items-center gap-1",children:[l(ka,{className:"w-4 h-4"}),m," critical issue",m>1?"s":""," found"]}),h("span",{className:"flex items-center gap-1",children:[l(Fn,{className:"w-4 h-4"}),"Build not ready for assembly"]})]})]})]})}),t===0&&Object.keys(e).length===0&&l("div",{className:"bg-gradient-to-r from-gray-50 to-slate-50 rounded-xl border-2 border-gray-200 p-6",children:h("div",{className:"flex items-center gap-4",children:[l("div",{className:"p-3 bg-gray-100 rounded-full",children:l(Ac,{className:"w-8 h-8 text-gray-600"})}),h("div",{className:"flex-1",children:[l("h4",{className:"text-xl font-bold text-gray-900 mb-2",children:"Start Building Your PC"}),l("p",{className:"text-gray-800 mb-3",children:"Select components from the categories above to begin checking compatibility and building your perfect PC."}),h("div",{className:"flex items-center gap-4 text-sm text-gray-700",children:[h("span",{className:"flex items-center gap-1",children:[l(Ac,{className:"w-4 h-4"}),"No components selected yet"]}),h("span",{className:"flex items-center gap-1",children:[l(Qi,{className:"w-4 h-4"}),"Choose components to start"]})]})]})]})})]})},qk={cpu_sockets:{"AMD AM4":["AMD AM4"],"AMD AM5":["AMD AM5"],"AMD sTRX4":["AMD sTRX4"],"AMD TR4":["AMD TR4"],"AMD sWRX8":["AMD sWRX8"],"Intel LGA1200":["Intel LGA1200"],"Intel LGA1700":["Intel LGA1700"],"Intel LGA1851":["Intel LGA1851"],"Intel LGA1151":["Intel LGA1151"],"Intel LGA2066":["Intel LGA2066"],"Intel LGA2011-3":["Intel LGA2011-3"],"Intel LGA3647":["Intel LGA3647"],"Intel LGA4189":["Intel LGA4189"]},ram_types:{DDR4:["DDR4"],DDR5:["DDR5"],DDR3:["DDR3"]},ram_speeds:{DDR4:{min:2133,max:4800,recommended:[2400,2666,3e3,3200,3600,4e3]},DDR5:{min:4800,max:6400,recommended:[4800,5200,5600,6e3,6400]}},cpu_ram_compatibility:{"Intel LGA1200":["DDR4"],"Intel LGA1700":["DDR4","DDR5"],"Intel LGA1851":["DDR5"],"Intel LGA1151":["DDR4"],"AMD AM4":["DDR4"],"AMD AM5":["DDR5"]},form_factors:{ATX:["ATX","Micro-ATX","Mini-ITX"],"Micro-ATX":["Micro-ATX","Mini-ITX"],"Mini-ITX":["Mini-ITX"],"E-ATX":["E-ATX","ATX","Micro-ATX","Mini-ITX"]},power_requirements:{cpu:{low:65,mid:95,high:125,extreme:165},gpu:{low:75,mid:150,high:250,extreme:350}},gpu_length_support:{small:300,medium:350,large:400,extreme:450},cooler_height_support:{small:160,medium:180,large:200,extreme:220}},yt=(e,t)=>{var n,a;if(!e)return null;const r=e.specs||{};switch(t){case"socket":return e.socket||r.socket||yL(e.name);case"brand":return e.brand||r.brand||vL(e.name);case"ram_type":return e.ram_type||r.ram_type||e.type||r.type;case"form_factor":return e.form_factor||r.form_factor;case"wattage":return e.wattage||r.wattage||bL(e.name);case"tdp":return e.tdp||r.tdp||wL(e.name);case"length":return e.length||r.length||((n=e.dimensions)==null?void 0:n.length);case"height":return e.height||r.height||((a=e.dimensions)==null?void 0:a.height);case"capacity":return e.capacity||r.capacity;case"speed":return e.speed||r.speed;default:return e[t]||r[t]}},yL=e=>{if(!e)return null;const t=e.toLowerCase(),r=t.replace(/[\s\-_]/g,"");if(r.includes("am4")||r.includes("amd4"))return"AMD AM4";if(r.includes("am5")||r.includes("amd5"))return"AMD AM5";if(r.includes("lga1200"))return"Intel LGA1200";if(r.includes("lga1700"))return"Intel LGA1700";if(r.includes("lga1151"))return"Intel LGA1151";if(r.includes("lga2066"))return"Intel LGA2066";const n=t.match(/\br[3579]\s*-?\s*(\d{4})([a-z0-9]*)?/i);if(n&&n[1]){const a=parseInt(n[1],10);if(!isNaN(a)){if(a>=7e3)return"AMD AM5";if(a>=1e3)return"AMD AM4"}}return t.includes("i7-11700")||t.includes("i7-11700k")||t.includes("i7-11700f")||t.includes("i5-11600")||t.includes("i5-11500")||t.includes("i5-11400")||t.includes("i3-11100")||t.includes("i3-10100")||t.includes("i9-11900")||t.includes("i9-10900")||t.includes("i5-10400")||t.includes("i5-10600")||t.includes("i3-10100")||t.includes("i3-10300")?"Intel LGA1200":t.includes("i7-12700")||t.includes("i7-13700")||t.includes("i5-12600")||t.includes("i5-13600")||t.includes("i3-12100")||t.includes("i3-13100")||t.includes("i9-12900")||t.includes("i9-13900")?"Intel LGA1700":t.includes("i7-14700")||t.includes("i5-14600")||t.includes("i3-14100")||t.includes("i9-14900")?"Intel LGA1851":t.includes("i7-8700")||t.includes("i7-9700")||t.includes("i5-8400")||t.includes("i5-9400")||t.includes("i3-8100")||t.includes("i3-9100")?"Intel LGA1151":t.includes("ryzen 3 3200g")||t.includes("ryzen 5 5600g")||t.includes("ryzen 5 5600gt")||t.includes("ryzen 7 5800")||t.includes("ryzen 9 5900")?"AMD AM4":t.includes("ryzen 7 7700")||t.includes("ryzen 9 7900")||t.includes("ryzen 5 7600")||t.includes("ryzen 7 7800")||t.includes("ryzen 9 7950")?"AMD AM5":t.includes("ryzen 5 5600")||t.includes("ryzen 7 5700")||t.includes("ryzen 9 5950")||t.includes("athlon 200ge")||t.includes("athlon 300ge")||t.includes("athlon 3000g")||t.includes("a8 7680")?"AMD AM4":null},vL=e=>{if(!e)return null;const t=e.toLowerCase();return t.includes("amd")||t.includes("ryzen")?"AMD":t.includes("intel")||t.includes("core")?"Intel":t.includes("nvidia")||t.includes("rtx")||t.includes("gtx")?"NVIDIA":t.includes("radeon")||t.includes("rx")?"AMD":null},bL=e=>{if(!e)return null;const t=e.match(/(\d+)\s*w/i);return t?parseInt(t[1]):null},wL=e=>{if(!e)return null;const t=e.match(/(\d+)\s*w\s*tdp/i);return t?parseInt(t[1]):null},Xk=e=>{if(!e)return null;let t=e.toString().trim().toUpperCase();return t=t.replace(/^SOCKET\s+/,""),t=t.replace(/[\s\-_]/g,""),t=t.replace(/^AMD4$/,"AM4").replace(/^AMD5$/,"AM5").replace(/^AMD/,"AM"),t.includes("AM4")?"AMD AM4":t.includes("AM5")?"AMD AM5":t.includes("LGA1200")?"Intel LGA1200":t.includes("LGA1700")?"Intel LGA1700":t.includes("LGA1851")?"Intel LGA1851":t.includes("LGA1151")?"Intel LGA1151":t.includes("LGA2066")?"Intel LGA2066":t.includes("LGA2011")?"Intel LGA2011-3":t.includes("LGA3647")?"Intel LGA3647":t.includes("LGA4189")?"Intel LGA4189":t},Yk=e=>{if(!e)return null;let t=e.toString().trim().toLowerCase();return t=t.replace(/_/g,"-"),t=t.replace(/\s+/g,"-"),t==="atx"?"ATX":t==="e-atx"||t==="eatx"?"E-ATX":t==="micro-atx"||t==="matx"||t==="u-atx"||t==="uatx"||t==="m-atx"||t==="microatx"?"Micro-ATX":t==="mini-itx"||t==="mitx"||t==="miniitx"?"Mini-ITX":t.includes("micro")&&t.includes("atx")?"Micro-ATX":t.includes("mini")&&t.includes("itx")?"Mini-ITX":t.includes("atx")?"ATX":e},lc=(e,t,r)=>{switch(r){case"cpu_motherboard":return VT(e,t);case"ram_motherboard":return KT(e,t);case"case_motherboard":return qT(e,t);case"psu_power":return XT(e,t);case"gpu_case":return YT(e,t);case"cooler_case":return JT(e,t);default:return{compatible:!0,reason:"No specific compatibility check defined"}}},VT=(e,t)=>{const r=yt(e,"socket"),n=yt(t,"socket");if(r&&n){const s=Xk(r),o=Xk(n);if(s&&o){const u=s===o;return{compatible:u,reason:u?"Socket compatible":`Socket mismatch: ${s} vs ${o}`,details:{cpuSocket:s,moboSocket:o}}}const c=r.toString().trim().toLowerCase()===n.toString().trim().toLowerCase();return{compatible:c,reason:c?"Socket compatible":`Socket mismatch: ${r} vs ${n}`,details:{cpuSocket:r,moboSocket:n}}}const a=yt(e,"brand"),i=yt(t,"brand");if(a&&i){const s=a==="AMD"&&i==="AMD"||a==="Intel"&&i==="Intel";return{compatible:s,reason:s?`Brand compatible: ${a} CPU with ${i} motherboard`:`Brand mismatch: ${a} CPU with ${i} motherboard`,details:{cpuBrand:a,moboBrand:i,cpuSocket:r,moboSocket:n}}}return{compatible:!0,reason:"Compatibility cannot be determined - assuming compatible",details:{cpuSocket:r,moboSocket:n,cpuBrand:a,moboBrand:i}}},KT=(e,t)=>{const r=yt(e,"ram_type"),n=yt(t,"ram_type"),a=yt(e,"speed"),i=yt(t,"max_ram_speed"),s=yt(e,"capacity"),o=yt(t,"max_ram_capacity"),c=yt(e,"modules")||1,u=yt(t,"ram_slots"),d=[],f={ramType:r,moboRamType:n,ramSpeed:a,moboMaxSpeed:i,ramCapacity:s,moboMaxCapacity:o,ramSticks:c,moboRamSlots:u};if(r&&n&&r!==n&&d.push(`RAM type mismatch: ${r} vs ${n}`),a&&i){const m=parseInt(a),p=parseInt(i);m>p?d.push(`RAM speed (${a}MHz) exceeds motherboard maximum (${i}MHz)`):m<2133&&d.push(`RAM speed (${a}MHz) is below minimum supported (2133MHz)`)}if(s&&o){const m=Math.floor(parseInt(o)/(u||4));parseInt(s)>m&&d.push(`RAM module size (${s}GB) exceeds maximum supported (${m}GB per module)`)}if(c&&u&&c>u&&d.push(`Number of RAM modules (${c}) exceeds motherboard slots (${u})`),s&&c&&o){const m=parseInt(s)*c;m>parseInt(o)&&d.push(`Total RAM (${m}GB) exceeds motherboard maximum (${o}GB)`)}return c===1&&u>=2&&d.push("Warning: Single RAM stick detected - consider dual-channel setup for better performance"),c>1&&c%2!==0&&d.push("Warning: Odd number of RAM sticks may not enable dual-channel mode"),d.length>0?{compatible:d.filter(p=>!p.startsWith("Warning:")).length===0,reason:d.join("; "),details:f,warnings:d.filter(p=>p.startsWith("Warning:")).length}:{compatible:!0,reason:"RAM is compatible with motherboard",details:f}},qT=(e,t)=>{const r=yt(e,"form_factor"),n=yt(t,"form_factor");if(r&&n){const s=Yk(r),o=Yk(n);if(s&&o&&qk.form_factors[s]){const c=qk.form_factors[s].includes(o);return{compatible:c,reason:c?"Form factor compatible":`Form factor mismatch: ${o} motherboard cannot fit in ${s} case`,details:{caseFormFactor:s,moboFormFactor:o}}}return{compatible:!0,reason:"Form factor unknown or unrecognized - assuming compatible",details:{caseFormFactor:s||r,moboFormFactor:o||n}}}const a=yt(e,"brand"),i=yt(t,"brand");return a&&i?{compatible:!0,reason:`Case brand compatible: ${a} case with ${i} motherboard`,details:{caseBrand:a,moboBrand:i,caseFormFactor:r,moboFormFactor:n}}:{compatible:!0,reason:"Case compatibility cannot be determined - assuming compatible",details:{caseFormFactor:r,moboFormFactor:n,caseBrand:a,moboBrand:i}}},XT=(e,t)=>{const r=yt(e,"wattage"),n=yt(e,"efficiency")||"80+ Gold";if(!r)return{compatible:!0,reason:"PSU wattage unknown - assuming compatible (verify PSU specs)"};const a={};let i=0;if(t.cpu){const f=yt(t.cpu,"tdp")||95,m=yt(t.cpu,"unlocked_multiplier")===!0,p=Math.ceil(f*(m?1.4:1.2));a.cpu=p,i+=p}if(t.gpu){const f=yt(t.gpu,"tdp")||150,m=f>200,p=Math.ceil(f*(m?1.5:1.3));a.gpu=p,i+=p}if(t.motherboard){const f=yt(t.motherboard,"chipset")||"",p=["X570","Z690","X670","Z790"].some(x=>f.includes(x))?80:50;a.motherboard=p,i+=p}if(t.ram){const f=yt(t.ram,"modules")||1,m=yt(t.ram,"speed")||3200,p=yt(t.ram,"voltage")||1.35,x=Math.ceil(f*(m/2133)*1.5*p);a.ram=x,i+=x}if(t.storage){const m=(yt(t.storage,"type")||"SSD").toLowerCase()==="hdd"?10:5;a.storage=m,i+=m}if(t.cooler){const m=(yt(t.cooler,"type")||"air").toLowerCase()==="aio"?15:5;a.cooling=m,i+=m}const o=(yt(t.case,"fans")||2)*2;a.fans=o,i+=o,a.peripherals=20,i+=20,i=Math.ceil(i*1.15);const c=r>=i,u={"80+":.8,"80+ Bronze":.82,"80+ Silver":.85,"80+ Gold":.87,"80+ Platinum":.89,"80+ Titanium":.92}[n]||.85,d=Math.ceil(i/u);return{compatible:c,reason:c?`Sufficient power (${r}W PSU for ${i}W system load)`:`Insufficient power: ${r}W PSU for ${i}W system load (${d}W recommended)`,details:{psuWattage:r,totalPowerNeeded:i,recommendedWattage:d,efficiency:n,powerBreakdown:a}}},YT=(e,t,r)=>{const n=yt(e,"length"),a=yt(e,"width")||120,i=yt(e,"slot_thickness")||2,s=yt(t,"max_gpu_length"),o=yt(t,"max_gpu_width")||140,c=yt(t,"expansion_slots")||7,u=[],d={gpuLength:n,gpuWidth:a,gpuSlotThickness:i,caseMaxLength:s,caseMaxWidth:o,caseMaxSlots:c};if(n&&s&&parseInt(n)>parseInt(s)&&u.push(`GPU length (${n}mm) exceeds case maximum (${s}mm)`),parseInt(a)>parseInt(o)&&u.push(`GPU width (${a}mm) exceeds case maximum (${o}mm)`),parseInt(i)>2){const m=Math.ceil(parseInt(i)/2)*2;m>parseInt(c)&&u.push(`GPU requires ${m} slots but case only has ${c}`)}return r&&(yt(r,"pcie_slots")||1)<1&&u.push("Motherboard has no available PCIe slots"),yt(t,"vertical_gpu_mount")===!1&&i>2&&u.push("Case does not support vertical GPU mounting for thick cards"),u.length>0?{compatible:!1,reason:u.join("; "),details:d}:{compatible:!0,reason:"GPU is compatible with case",details:d}},Jd=e=>{const t=[];let r=0,n=0;if(e.cpu&&e.motherboard){r++;const s=VT(e.cpu,e.motherboard);t.push({type:"cpu_motherboard",...s}),s.compatible&&n++}if(e.ram&&e.motherboard){r++;const s=KT(e.ram,e.motherboard);t.push({type:"ram_motherboard",...s}),s.compatible&&n++}if(e.case&&e.motherboard){r++;const s=qT(e.case,e.motherboard);t.push({type:"case_motherboard",...s}),s.compatible&&n++}if(e.psu){r++;const s=XT(e.psu,e);t.push({type:"psu_power",...s}),s.compatible&&n++}if(e.gpu&&e.case){r++;const s=YT(e.gpu,e.case);t.push({type:"gpu_case",...s}),s.compatible&&n++}if(e.cooler&&e.case){r++;const s=JT(e.cooler,e.case);t.push({type:"cooler_case",...s}),s.compatible&&n++}return{score:Object.values(e).some(s=>s!=null&&typeof s=="object"&&Object.keys(s).length>0&&s.id&&s.name)?r>0?Math.round(n/r*100):100:0,totalChecks:r,passedChecks:n,checks:t}},JT=(e,t)=>{const r=yt(e,"cooler"),n=yt(t,"case");if(!r||!n)return{compatible:!0};if(r.type&&r.type.toLowerCase().includes("liquid")){const a=r.name.match(/(\d+)mm/);if(a){const i=parseInt(a[1]),s=`${i}mm`;if(n.radiatorSupport){if(!n.radiatorSupport.split(",").map(c=>c.trim()).includes(s))return{compatible:!1,reason:`Case does not support ${i}mm radiator`}}else return{compatible:!0}}}if(r.type&&(r.type.toLowerCase().includes("air")||!r.type.toLowerCase().includes("liquid"))){const a=r.name.match(/(\d+)mm/);if(a&&n.maxCoolerHeight){const i=parseInt(a[1]),s=parseInt(n.maxCoolerHeight);if(i>s)return{compatible:!1,reason:`Cooler height (${i}mm) exceeds case maximum (${s}mm)`}}}return{compatible:!0}},NL=({isOpen:e,onClose:t,selectedComponents:r,currentCategory:n,allComponents:a=[],onComponentSelect:i})=>{const[s,o]=N.useState("compatible"),[c,u]=N.useState(!1),[d,f]=N.useState(""),[m,p]=N.useState("name"),[x,g]=N.useState({compatible:[],incompatible:[]}),y=[{id:"cpu",name:"CPU",icon:Ra,description:"Brain of your PC"},{id:"motherboard",name:"Motherboard",icon:ub,description:"Connects everything"},{id:"gpu",name:"Graphics Card",icon:Is,description:"Handles graphics"},{id:"ram",name:"RAM",icon:lo,description:"System memory"},{id:"storage",name:"Storage",icon:Of,description:"Data storage"},{id:"psu",name:"Power Supply",icon:rs,description:"Powers everything"},{id:"case",name:"Case",icon:nt,description:"Houses components"},{id:"cooler",name:"Cooler",icon:Rs,description:"Keeps it cool"}];N.useEffect(()=>{if(a.length>0){const S=[],_=[];a.forEach(A=>{const T=v(A);T.compatible?S.push({...A,compatibility:T}):_.push({...A,compatibility:T})});const C=A=>d?A.filter(T=>{var D,I;return((D=T.name)==null?void 0:D.toLowerCase().includes(d.toLowerCase()))||((I=T.brand)==null?void 0:I.toLowerCase().includes(d.toLowerCase()))}):A,E=A=>[...A].sort((T,D)=>{switch(m){case"price":return(T.price||0)-(D.price||0);case"name":return(T.name||"").localeCompare(D.name||"");case"brand":return(T.brand||"").localeCompare(D.brand||"");default:return 0}});g({compatible:E(C(S)),incompatible:E(C(_))})}},[a,d,m,r,n]);const v=S=>{const _=[];let C=!0;switch(n){case"motherboard":if(r.cpu){const A=lc(r.cpu,S,"cpu_motherboard");A.compatible||(_.push(A.reason),C=!1)}break;case"ram":if(r.motherboard){const A=lc(S,r.motherboard,"ram_motherboard");A.compatible||(_.push(A.reason),C=!1)}break;case"case":if(r.motherboard){const A=lc(S,r.motherboard,"case_motherboard");A.compatible||(_.push(A.reason),C=!1)}break;case"psu":const E=lc(S,r,"psu_power");E.compatible||(_.push(E.reason),C=!1);break;case"gpu":if(r.case){const A=lc(S,r.case,"gpu_case");A.compatible||(_.push(A.reason),C=!1)}break;case"cooler":if(r.case){const A=lc(S,r.case,"cooler_case");A.compatible||(_.push(A.reason),C=!1)}break}return{compatible:C,issues:_,reason:_.length>0?_.join("; "):"Compatible with current selections"}},b=S=>{if(!S.compatibility)return null;const _=[];if(n==="cpu"||n==="motherboard"){const C=yt(S,"socket");C&&_.push({label:"Socket",value:C})}if(n==="ram"||n==="motherboard"){const C=yt(S,"ram_type");C&&_.push({label:"RAM Type",value:C})}if(n==="case"||n==="motherboard"){const C=yt(S,"form_factor");C&&_.push({label:"Form Factor",value:C})}if(n==="psu"){const C=yt(S,"wattage");C&&_.push({label:"Wattage",value:`${C}W`})}if(n==="gpu"){const C=yt(S,"length");C&&_.push({label:"Length",value:`${C}mm`})}if(n==="cooler"){const C=yt(S,"height");C&&_.push({label:"Height",value:`${C}mm`})}return _},w=(S,_)=>{var A,T,D;const C=b(S),E=((A=r[n])==null?void 0:A.id)===S.id;return h("div",{className:`bg-white rounded-lg border-2 p-4 transition-all duration-200 hover:shadow-lg ${E?"border-green-500 bg-green-50":_?"border-gray-200 hover:border-green-300":"border-red-200 bg-red-50"}`,children:[l("div",{className:"flex justify-center mb-4",children:l("img",{src:xr(S,n),alt:S.name,className:"w-20 h-20 object-contain",onError:I=>{I.target.src="/images/components/default.png"}})}),h("div",{className:"text-center mb-4",children:[l("h3",{className:"font-semibold text-gray-900 text-sm mb-1 line-clamp-2",children:S.name}),S.brand&&h("p",{className:"text-gray-600 text-xs mb-2",children:[S.brand,S.model?` â€¢ ${S.model}`:""]}),S.price!==void 0&&S.price!==null&&h("p",{className:"text-green-600 font-bold text-lg",children:["â‚±",S.price.toLocaleString()]})]}),C&&C.length>0&&l("div",{className:"mb-4 space-y-2",children:C.map((I,z)=>h("div",{className:"flex justify-between text-xs",children:[h("span",{className:"text-gray-600",children:[I.label,":"]}),l("span",{className:"font-medium text-gray-900",children:I.value})]},z))}),h("div",{className:"mb-4 p-3 rounded-lg bg-gray-50",children:[h("div",{className:"flex items-center justify-between mb-2",children:[l("span",{className:"text-xs font-medium text-gray-700",children:"Status:"}),_?l(At,{className:"w-4 h-4 text-green-500"}):l(ka,{className:"w-4 h-4 text-red-500"})]}),l("p",{className:"text-xs text-gray-600",children:((T=S.compatibility)==null?void 0:T.reason)||"Compatibility unknown"}),((D=S.compatibility)==null?void 0:D.issues)&&S.compatibility.issues.length>0&&h("div",{className:"mt-2",children:[l("p",{className:"text-xs font-medium text-red-600 mb-1",children:"Issues:"}),l("ul",{className:"text-xs text-red-600 space-y-1",children:S.compatibility.issues.map((I,z)=>h("li",{className:"flex items-start",children:[l(ka,{className:"w-3 h-3 mr-1 mt-0.5 flex-shrink-0"}),I]},z))})]})]}),l("button",{onClick:()=>{_&&(i(n,S),t())},disabled:!_,className:`w-full py-2 px-3 rounded-lg text-sm font-medium transition-colors ${_?"bg-green-500 text-white hover:bg-green-600":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:_?"Select Component":"Incompatible"})]},S.id)};if(!e)return null;const k=y.find(S=>S.id===n);return l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h("div",{className:"bg-white rounded-xl max-w-6xl w-full max-h-[90vh] overflow-hidden",children:[h("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[l("div",{className:"flex items-center gap-3",children:k&&h(gt,{children:[l(k.icon,{className:"w-8 h-8 text-green-600"}),h("div",{children:[h("h2",{className:"text-2xl font-bold text-gray-900",children:[k.name," Compatibility Comparison"]}),l("p",{className:"text-sm text-gray-600",children:"Compare compatible and incompatible components"})]})]})}),l("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:l(Yr,{className:"w-6 h-6 text-gray-500"})})]}),l("div",{className:"p-6 border-b border-gray-200",children:h("div",{className:"flex flex-col sm:flex-row gap-4",children:[h("div",{className:"flex-1 relative",children:[l(Di,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),l("input",{type:"text",placeholder:"Search components...",value:d,onChange:S=>f(S.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),h("select",{value:m,onChange:S=>p(S.target.value),className:"px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[l("option",{value:"name",children:"Sort by Name"}),l("option",{value:"price",children:"Sort by Price"}),l("option",{value:"brand",children:"Sort by Brand"})]}),h("div",{className:"flex items-center gap-2 ml-auto",children:[l("input",{id:"toggle-incompatible",type:"checkbox",checked:c,onChange:S=>u(S.target.checked)}),l("label",{htmlFor:"toggle-incompatible",className:"text-sm text-gray-700 select-none",children:"Show Incompatible"})]})]})}),h("div",{className:"flex-1 overflow-hidden",children:[h("div",{className:"flex border-b border-gray-200",children:[l("button",{onClick:()=>o("compatible"),className:`flex-1 py-4 px-6 text-sm font-medium transition-colors ${s==="compatible"?"text-green-600 border-b-2 border-green-500 bg-green-50":"text-gray-500 hover:text-gray-700"}`,children:h("div",{className:"flex items-center justify-center gap-2",children:[l(At,{className:"w-5 h-5"}),"Compatible (",x.compatible.length,")"]})}),l("button",{onClick:()=>o("incompatible"),className:`flex-1 py-4 px-6 text-sm font-medium transition-colors ${s==="incompatible"?"text-red-600 border-b-2 border-red-500 bg-red-50":"text-gray-500 hover:text-gray-700"}`,children:h("div",{className:"flex items-center justify-center gap-2",children:[l(ka,{className:"w-5 h-5"}),"Incompatible (",x.incompatible.length,")"]})})]}),l("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:s==="compatible"?x.compatible.length>0?l("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:x.compatible.map(S=>w(S,!0))}):h("div",{className:"text-center py-12",children:[l(At,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Compatible Components"}),l("p",{className:"text-gray-600",children:d?"Try adjusting your search terms.":"No compatible components found for your current selections."})]}):c?x.incompatible.length>0?l("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:x.incompatible.map(S=>w(S,!1))}):h("div",{className:"text-center py-12",children:[l(ka,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Incompatible Components"}),l("p",{className:"text-gray-600",children:d?"Try adjusting your search terms.":"All components are compatible with your current selections."})]}):h("div",{className:"text-center py-12",children:[l(ka,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Show Incompatible"}),l("p",{className:"text-gray-600",children:'Toggle "Show Incompatible" to view incompatible options'})]})})]}),l("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:h("div",{className:"flex items-center justify-between",children:[h("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[l(Ta,{className:"w-4 h-4"}),l("span",{children:"Compatibility is checked against your current component selections"})]}),l("button",{onClick:t,className:"px-6 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"Close"})]})})]})})};function QT(e,t){return function(){return e.apply(t,arguments)}}const{toString:kL}=Object.prototype,{getPrototypeOf:fb}=Object,{iterator:vp,toStringTag:ZT}=Symbol,bp=(e=>t=>{const r=kL.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Li=e=>(e=e.toLowerCase(),t=>bp(t)===e),wp=e=>t=>typeof t===e,{isArray:vu}=Array,Zc=wp("undefined");function If(e){return e!==null&&!Zc(e)&&e.constructor!==null&&!Zc(e.constructor)&&ma(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const e3=Li("ArrayBuffer");function SL(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&e3(e.buffer),t}const _L=wp("string"),ma=wp("function"),t3=wp("number"),Rf=e=>e!==null&&typeof e=="object",CL=e=>e===!0||e===!1,vh=e=>{if(bp(e)!=="object")return!1;const t=fb(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(ZT in e)&&!(vp in e)},EL=e=>{if(!Rf(e)||If(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},AL=Li("Date"),TL=Li("File"),PL=Li("Blob"),OL=Li("FileList"),DL=e=>Rf(e)&&ma(e.pipe),IL=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||ma(e.append)&&((t=bp(e))==="formdata"||t==="object"&&ma(e.toString)&&e.toString()==="[object FormData]"))},RL=Li("URLSearchParams"),[FL,ML,LL,BL]=["ReadableStream","Request","Response","Headers"].map(Li),jL=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ff(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),vu(e))for(n=0,a=e.length;n<a;n++)t.call(null,e[n],n,e);else{if(If(e))return;const i=r?Object.getOwnPropertyNames(e):Object.keys(e),s=i.length;let o;for(n=0;n<s;n++)o=i[n],t.call(null,e[o],o,e)}}function r3(e,t){if(If(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,a;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const ol=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),n3=e=>!Zc(e)&&e!==ol;function Qy(){const{caseless:e,skipUndefined:t}=n3(this)&&this||{},r={},n=(a,i)=>{const s=e&&r3(r,i)||i;vh(r[s])&&vh(a)?r[s]=Qy(r[s],a):vh(a)?r[s]=Qy({},a):vu(a)?r[s]=a.slice():(!t||!Zc(a))&&(r[s]=a)};for(let a=0,i=arguments.length;a<i;a++)arguments[a]&&Ff(arguments[a],n);return r}const $L=(e,t,r,{allOwnKeys:n}={})=>(Ff(t,(a,i)=>{r&&ma(a)?e[i]=QT(a,r):e[i]=a},{allOwnKeys:n}),e),UL=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),zL=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},HL=(e,t,r,n)=>{let a,i,s;const o={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),i=a.length;i-- >0;)s=a[i],(!n||n(s,e,t))&&!o[s]&&(t[s]=e[s],o[s]=!0);e=r!==!1&&fb(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},WL=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},GL=e=>{if(!e)return null;if(vu(e))return e;let t=e.length;if(!t3(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},VL=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&fb(Uint8Array)),KL=(e,t)=>{const n=(e&&e[vp]).call(e);let a;for(;(a=n.next())&&!a.done;){const i=a.value;t.call(e,i[0],i[1])}},qL=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},XL=Li("HTMLFormElement"),YL=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),Jk=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),JL=Li("RegExp"),a3=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};Ff(r,(a,i)=>{let s;(s=t(a,i,e))!==!1&&(n[i]=s||a)}),Object.defineProperties(e,n)},QL=e=>{a3(e,(t,r)=>{if(ma(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(ma(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},ZL=(e,t)=>{const r={},n=a=>{a.forEach(i=>{r[i]=!0})};return vu(e)?n(e):n(String(e).split(t)),r},eB=()=>{},tB=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function rB(e){return!!(e&&ma(e.append)&&e[ZT]==="FormData"&&e[vp])}const nB=e=>{const t=new Array(10),r=(n,a)=>{if(Rf(n)){if(t.indexOf(n)>=0)return;if(If(n))return n;if(!("toJSON"in n)){t[a]=n;const i=vu(n)?[]:{};return Ff(n,(s,o)=>{const c=r(s,a+1);!Zc(c)&&(i[o]=c)}),t[a]=void 0,i}}return n};return r(e,0)},aB=Li("AsyncFunction"),iB=e=>e&&(Rf(e)||ma(e))&&ma(e.then)&&ma(e.catch),i3=((e,t)=>e?setImmediate:t?((r,n)=>(ol.addEventListener("message",({source:a,data:i})=>{a===ol&&i===r&&n.length&&n.shift()()},!1),a=>{n.push(a),ol.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",ma(ol.postMessage)),sB=typeof queueMicrotask<"u"?queueMicrotask.bind(ol):typeof process<"u"&&process.nextTick||i3,oB=e=>e!=null&&ma(e[vp]),Ne={isArray:vu,isArrayBuffer:e3,isBuffer:If,isFormData:IL,isArrayBufferView:SL,isString:_L,isNumber:t3,isBoolean:CL,isObject:Rf,isPlainObject:vh,isEmptyObject:EL,isReadableStream:FL,isRequest:ML,isResponse:LL,isHeaders:BL,isUndefined:Zc,isDate:AL,isFile:TL,isBlob:PL,isRegExp:JL,isFunction:ma,isStream:DL,isURLSearchParams:RL,isTypedArray:VL,isFileList:OL,forEach:Ff,merge:Qy,extend:$L,trim:jL,stripBOM:UL,inherits:zL,toFlatObject:HL,kindOf:bp,kindOfTest:Li,endsWith:WL,toArray:GL,forEachEntry:KL,matchAll:qL,isHTMLForm:XL,hasOwnProperty:Jk,hasOwnProp:Jk,reduceDescriptors:a3,freezeMethods:QL,toObjectSet:ZL,toCamelCase:YL,noop:eB,toFiniteNumber:tB,findKey:r3,global:ol,isContextDefined:n3,isSpecCompliantForm:rB,toJSONObject:nB,isAsyncFn:aB,isThenable:iB,setImmediate:i3,asap:sB,isIterable:oB};function vt(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}Ne.inherits(vt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ne.toJSONObject(this.config),code:this.code,status:this.status}}});const s3=vt.prototype,o3={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{o3[e]={value:e}});Object.defineProperties(vt,o3);Object.defineProperty(s3,"isAxiosError",{value:!0});vt.from=(e,t,r,n,a,i)=>{const s=Object.create(s3);Ne.toFlatObject(e,s,function(d){return d!==Error.prototype},u=>u!=="isAxiosError");const o=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return vt.call(s,o,c,r,n,a),e&&s.cause==null&&Object.defineProperty(s,"cause",{value:e,configurable:!0}),s.name=e&&e.name||"Error",i&&Object.assign(s,i),s};const lB=null;function Zy(e){return Ne.isPlainObject(e)||Ne.isArray(e)}function l3(e){return Ne.endsWith(e,"[]")?e.slice(0,-2):e}function Qk(e,t,r){return e?e.concat(t).map(function(a,i){return a=l3(a),!r&&i?"["+a+"]":a}).join(r?".":""):t}function cB(e){return Ne.isArray(e)&&!e.some(Zy)}const uB=Ne.toFlatObject(Ne,{},null,function(t){return/^is[A-Z]/.test(t)});function Np(e,t,r){if(!Ne.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=Ne.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,y){return!Ne.isUndefined(y[g])});const n=r.metaTokens,a=r.visitor||d,i=r.dots,s=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&Ne.isSpecCompliantForm(t);if(!Ne.isFunction(a))throw new TypeError("visitor must be a function");function u(x){if(x===null)return"";if(Ne.isDate(x))return x.toISOString();if(Ne.isBoolean(x))return x.toString();if(!c&&Ne.isBlob(x))throw new vt("Blob is not supported. Use a Buffer instead.");return Ne.isArrayBuffer(x)||Ne.isTypedArray(x)?c&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function d(x,g,y){let v=x;if(x&&!y&&typeof x=="object"){if(Ne.endsWith(g,"{}"))g=n?g:g.slice(0,-2),x=JSON.stringify(x);else if(Ne.isArray(x)&&cB(x)||(Ne.isFileList(x)||Ne.endsWith(g,"[]"))&&(v=Ne.toArray(x)))return g=l3(g),v.forEach(function(w,k){!(Ne.isUndefined(w)||w===null)&&t.append(s===!0?Qk([g],k,i):s===null?g:g+"[]",u(w))}),!1}return Zy(x)?!0:(t.append(Qk(y,g,i),u(x)),!1)}const f=[],m=Object.assign(uB,{defaultVisitor:d,convertValue:u,isVisitable:Zy});function p(x,g){if(!Ne.isUndefined(x)){if(f.indexOf(x)!==-1)throw Error("Circular reference detected in "+g.join("."));f.push(x),Ne.forEach(x,function(v,b){(!(Ne.isUndefined(v)||v===null)&&a.call(t,v,Ne.isString(b)?b.trim():b,g,m))===!0&&p(v,g?g.concat(b):[b])}),f.pop()}}if(!Ne.isObject(e))throw new TypeError("data must be an object");return p(e),t}function Zk(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function hb(e,t){this._pairs=[],e&&Np(e,this,t)}const c3=hb.prototype;c3.append=function(t,r){this._pairs.push([t,r])};c3.toString=function(t){const r=t?function(n){return t.call(this,n,Zk)}:Zk;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function dB(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function u3(e,t,r){if(!t)return e;const n=r&&r.encode||dB;Ne.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let i;if(a?i=a(t,r):i=Ne.isURLSearchParams(t)?t.toString():new hb(t,r).toString(n),i){const s=e.indexOf("#");s!==-1&&(e=e.slice(0,s)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class fB{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Ne.forEach(this.handlers,function(n){n!==null&&t(n)})}}const eS=fB,d3={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},hB=typeof URLSearchParams<"u"?URLSearchParams:hb,mB=typeof FormData<"u"?FormData:null,pB=typeof Blob<"u"?Blob:null,gB={isBrowser:!0,classes:{URLSearchParams:hB,FormData:mB,Blob:pB},protocols:["http","https","file","blob","url","data"]},mb=typeof window<"u"&&typeof document<"u",ev=typeof navigator=="object"&&navigator||void 0,xB=mb&&(!ev||["ReactNative","NativeScript","NS"].indexOf(ev.product)<0),yB=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),vB=mb&&window.location.href||"http://localhost",bB=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:mb,hasStandardBrowserEnv:xB,hasStandardBrowserWebWorkerEnv:yB,navigator:ev,origin:vB},Symbol.toStringTag,{value:"Module"})),Mn={...bB,...gB};function wB(e,t){return Np(e,new Mn.classes.URLSearchParams,{visitor:function(r,n,a,i){return Mn.isNode&&Ne.isBuffer(r)?(this.append(n,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function NB(e){return Ne.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function kB(e){const t={},r=Object.keys(e);let n;const a=r.length;let i;for(n=0;n<a;n++)i=r[n],t[i]=e[i];return t}function f3(e){function t(r,n,a,i){let s=r[i++];if(s==="__proto__")return!0;const o=Number.isFinite(+s),c=i>=r.length;return s=!s&&Ne.isArray(a)?a.length:s,c?(Ne.hasOwnProp(a,s)?a[s]=[a[s],n]:a[s]=n,!o):((!a[s]||!Ne.isObject(a[s]))&&(a[s]=[]),t(r,n,a[s],i)&&Ne.isArray(a[s])&&(a[s]=kB(a[s])),!o)}if(Ne.isFormData(e)&&Ne.isFunction(e.entries)){const r={};return Ne.forEachEntry(e,(n,a)=>{t(NB(n),a,r,0)}),r}return null}function SB(e,t,r){if(Ne.isString(e))try{return(t||JSON.parse)(e),Ne.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const pb={transitional:d3,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,i=Ne.isObject(t);if(i&&Ne.isHTMLForm(t)&&(t=new FormData(t)),Ne.isFormData(t))return a?JSON.stringify(f3(t)):t;if(Ne.isArrayBuffer(t)||Ne.isBuffer(t)||Ne.isStream(t)||Ne.isFile(t)||Ne.isBlob(t)||Ne.isReadableStream(t))return t;if(Ne.isArrayBufferView(t))return t.buffer;if(Ne.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return wB(t,this.formSerializer).toString();if((o=Ne.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Np(o?{"files[]":t}:t,c&&new c,this.formSerializer)}}return i||a?(r.setContentType("application/json",!1),SB(t)):t}],transformResponse:[function(t){const r=this.transitional||pb.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(Ne.isResponse(t)||Ne.isReadableStream(t))return t;if(t&&Ne.isString(t)&&(n&&!this.responseType||a)){const s=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t,this.parseReviver)}catch(o){if(s)throw o.name==="SyntaxError"?vt.from(o,vt.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Mn.classes.FormData,Blob:Mn.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ne.forEach(["delete","get","head","post","put","patch"],e=>{pb.headers[e]={}});const gb=pb,_B=Ne.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),CB=e=>{const t={};let r,n,a;return e&&e.split(`
`).forEach(function(s){a=s.indexOf(":"),r=s.substring(0,a).trim().toLowerCase(),n=s.substring(a+1).trim(),!(!r||t[r]&&_B[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},tS=Symbol("internals");function Ku(e){return e&&String(e).trim().toLowerCase()}function bh(e){return e===!1||e==null?e:Ne.isArray(e)?e.map(bh):String(e)}function EB(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const AB=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function ux(e,t,r,n,a){if(Ne.isFunction(n))return n.call(this,t,r);if(a&&(t=r),!!Ne.isString(t)){if(Ne.isString(n))return t.indexOf(n)!==-1;if(Ne.isRegExp(n))return n.test(t)}}function TB(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function PB(e,t){const r=Ne.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(a,i,s){return this[n].call(this,t,a,i,s)},configurable:!0})})}class kp{constructor(t){t&&this.set(t)}set(t,r,n){const a=this;function i(o,c,u){const d=Ku(c);if(!d)throw new Error("header name must be a non-empty string");const f=Ne.findKey(a,d);(!f||a[f]===void 0||u===!0||u===void 0&&a[f]!==!1)&&(a[f||c]=bh(o))}const s=(o,c)=>Ne.forEach(o,(u,d)=>i(u,d,c));if(Ne.isPlainObject(t)||t instanceof this.constructor)s(t,r);else if(Ne.isString(t)&&(t=t.trim())&&!AB(t))s(CB(t),r);else if(Ne.isObject(t)&&Ne.isIterable(t)){let o={},c,u;for(const d of t){if(!Ne.isArray(d))throw TypeError("Object iterator must return a key-value pair");o[u=d[0]]=(c=o[u])?Ne.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}s(o,r)}else t!=null&&i(r,t,n);return this}get(t,r){if(t=Ku(t),t){const n=Ne.findKey(this,t);if(n){const a=this[n];if(!r)return a;if(r===!0)return EB(a);if(Ne.isFunction(r))return r.call(this,a,n);if(Ne.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Ku(t),t){const n=Ne.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||ux(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let a=!1;function i(s){if(s=Ku(s),s){const o=Ne.findKey(n,s);o&&(!r||ux(n,n[o],o,r))&&(delete n[o],a=!0)}}return Ne.isArray(t)?t.forEach(i):i(t),a}clear(t){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const i=r[n];(!t||ux(this,this[i],i,t,!0))&&(delete this[i],a=!0)}return a}normalize(t){const r=this,n={};return Ne.forEach(this,(a,i)=>{const s=Ne.findKey(n,i);if(s){r[s]=bh(a),delete r[i];return}const o=t?TB(i):String(i).trim();o!==i&&delete r[i],r[o]=bh(a),n[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return Ne.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=t&&Ne.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(a=>n.set(a)),n}static accessor(t){const n=(this[tS]=this[tS]={accessors:{}}).accessors,a=this.prototype;function i(s){const o=Ku(s);n[o]||(PB(a,s),n[o]=!0)}return Ne.isArray(t)?t.forEach(i):i(t),this}}kp.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ne.reduceDescriptors(kp.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});Ne.freezeMethods(kp);const Ii=kp;function dx(e,t){const r=this||gb,n=t||r,a=Ii.from(n.headers);let i=n.data;return Ne.forEach(e,function(o){i=o.call(r,i,a.normalize(),t?t.status:void 0)}),a.normalize(),i}function h3(e){return!!(e&&e.__CANCEL__)}function bu(e,t,r){vt.call(this,e??"canceled",vt.ERR_CANCELED,t,r),this.name="CanceledError"}Ne.inherits(bu,vt,{__CANCEL__:!0});function m3(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new vt("Request failed with status code "+r.status,[vt.ERR_BAD_REQUEST,vt.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function OB(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function DB(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a=0,i=0,s;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),d=n[i];s||(s=u),r[a]=c,n[a]=u;let f=i,m=0;for(;f!==a;)m+=r[f++],f=f%e;if(a=(a+1)%e,a===i&&(i=(i+1)%e),u-s<t)return;const p=d&&u-d;return p?Math.round(m*1e3/p):void 0}}function IB(e,t){let r=0,n=1e3/t,a,i;const s=(u,d=Date.now())=>{r=d,a=null,i&&(clearTimeout(i),i=null),e(...u)};return[(...u)=>{const d=Date.now(),f=d-r;f>=n?s(u,d):(a=u,i||(i=setTimeout(()=>{i=null,s(a)},n-f)))},()=>a&&s(a)]}const em=(e,t,r=3)=>{let n=0;const a=DB(50,250);return IB(i=>{const s=i.loaded,o=i.lengthComputable?i.total:void 0,c=s-n,u=a(c),d=s<=o;n=s;const f={loaded:s,total:o,progress:o?s/o:void 0,bytes:c,rate:u||void 0,estimated:u&&o&&d?(o-s)/u:void 0,event:i,lengthComputable:o!=null,[t?"download":"upload"]:!0};e(f)},r)},rS=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},nS=e=>(...t)=>Ne.asap(()=>e(...t)),RB=Mn.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Mn.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Mn.origin),Mn.navigator&&/(msie|trident)/i.test(Mn.navigator.userAgent)):()=>!0,FB=Mn.hasStandardBrowserEnv?{write(e,t,r,n,a,i){const s=[e+"="+encodeURIComponent(t)];Ne.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),Ne.isString(n)&&s.push("path="+n),Ne.isString(a)&&s.push("domain="+a),i===!0&&s.push("secure"),document.cookie=s.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function MB(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function LB(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function p3(e,t,r){let n=!MB(t);return e&&(n||r==!1)?LB(e,t):t}const aS=e=>e instanceof Ii?{...e}:e;function El(e,t){t=t||{};const r={};function n(u,d,f,m){return Ne.isPlainObject(u)&&Ne.isPlainObject(d)?Ne.merge.call({caseless:m},u,d):Ne.isPlainObject(d)?Ne.merge({},d):Ne.isArray(d)?d.slice():d}function a(u,d,f,m){if(Ne.isUndefined(d)){if(!Ne.isUndefined(u))return n(void 0,u,f,m)}else return n(u,d,f,m)}function i(u,d){if(!Ne.isUndefined(d))return n(void 0,d)}function s(u,d){if(Ne.isUndefined(d)){if(!Ne.isUndefined(u))return n(void 0,u)}else return n(void 0,d)}function o(u,d,f){if(f in t)return n(u,d);if(f in e)return n(void 0,u)}const c={url:i,method:i,data:i,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:o,headers:(u,d,f)=>a(aS(u),aS(d),f,!0)};return Ne.forEach(Object.keys({...e,...t}),function(d){const f=c[d]||a,m=f(e[d],t[d],d);Ne.isUndefined(m)&&f!==o||(r[d]=m)}),r}const g3=e=>{const t=El({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:i,headers:s,auth:o}=t;if(t.headers=s=Ii.from(s),t.url=u3(p3(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&s.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),Ne.isFormData(r)){if(Mn.hasStandardBrowserEnv||Mn.hasStandardBrowserWebWorkerEnv)s.setContentType(void 0);else if(Ne.isFunction(r.getHeaders)){const c=r.getHeaders(),u=["content-type","content-length"];Object.entries(c).forEach(([d,f])=>{u.includes(d.toLowerCase())&&s.set(d,f)})}}if(Mn.hasStandardBrowserEnv&&(n&&Ne.isFunction(n)&&(n=n(t)),n||n!==!1&&RB(t.url))){const c=a&&i&&FB.read(i);c&&s.set(a,c)}return t},BB=typeof XMLHttpRequest<"u",jB=BB&&function(e){return new Promise(function(r,n){const a=g3(e);let i=a.data;const s=Ii.from(a.headers).normalize();let{responseType:o,onUploadProgress:c,onDownloadProgress:u}=a,d,f,m,p,x;function g(){p&&p(),x&&x(),a.cancelToken&&a.cancelToken.unsubscribe(d),a.signal&&a.signal.removeEventListener("abort",d)}let y=new XMLHttpRequest;y.open(a.method.toUpperCase(),a.url,!0),y.timeout=a.timeout;function v(){if(!y)return;const w=Ii.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),S={data:!o||o==="text"||o==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:w,config:e,request:y};m3(function(C){r(C),g()},function(C){n(C),g()},S),y=null}"onloadend"in y?y.onloadend=v:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(v)},y.onabort=function(){y&&(n(new vt("Request aborted",vt.ECONNABORTED,e,y)),y=null)},y.onerror=function(k){const S=k&&k.message?k.message:"Network Error",_=new vt(S,vt.ERR_NETWORK,e,y);_.event=k||null,n(_),y=null},y.ontimeout=function(){let k=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const S=a.transitional||d3;a.timeoutErrorMessage&&(k=a.timeoutErrorMessage),n(new vt(k,S.clarifyTimeoutError?vt.ETIMEDOUT:vt.ECONNABORTED,e,y)),y=null},i===void 0&&s.setContentType(null),"setRequestHeader"in y&&Ne.forEach(s.toJSON(),function(k,S){y.setRequestHeader(S,k)}),Ne.isUndefined(a.withCredentials)||(y.withCredentials=!!a.withCredentials),o&&o!=="json"&&(y.responseType=a.responseType),u&&([m,x]=em(u,!0),y.addEventListener("progress",m)),c&&y.upload&&([f,p]=em(c),y.upload.addEventListener("progress",f),y.upload.addEventListener("loadend",p)),(a.cancelToken||a.signal)&&(d=w=>{y&&(n(!w||w.type?new bu(null,e,y):w),y.abort(),y=null)},a.cancelToken&&a.cancelToken.subscribe(d),a.signal&&(a.signal.aborted?d():a.signal.addEventListener("abort",d)));const b=OB(a.url);if(b&&Mn.protocols.indexOf(b)===-1){n(new vt("Unsupported protocol "+b+":",vt.ERR_BAD_REQUEST,e));return}y.send(i||null)})},$B=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,a;const i=function(u){if(!a){a=!0,o();const d=u instanceof Error?u:this.reason;n.abort(d instanceof vt?d:new bu(d instanceof Error?d.message:d))}};let s=t&&setTimeout(()=>{s=null,i(new vt(`timeout ${t} of ms exceeded`,vt.ETIMEDOUT))},t);const o=()=>{e&&(s&&clearTimeout(s),s=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(i):u.removeEventListener("abort",i)}),e=null)};e.forEach(u=>u.addEventListener("abort",i));const{signal:c}=n;return c.unsubscribe=()=>Ne.asap(o),c}},UB=$B,zB=function*(e,t){let r=e.byteLength;if(!t||r<t){yield e;return}let n=0,a;for(;n<r;)a=n+t,yield e.slice(n,a),n=a},HB=async function*(e,t){for await(const r of WB(e))yield*zB(r,t)},WB=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},iS=(e,t,r,n)=>{const a=HB(e,t);let i=0,s,o=c=>{s||(s=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await a.next();if(u){o(),c.close();return}let f=d.byteLength;if(r){let m=i+=f;r(m)}c.enqueue(new Uint8Array(d))}catch(u){throw o(u),u}},cancel(c){return o(c),a.return()}},{highWaterMark:2})},sS=64*1024,{isFunction:D0}=Ne,GB=(({Request:e,Response:t})=>({Request:e,Response:t}))(Ne.global),{ReadableStream:oS,TextEncoder:lS}=Ne.global,cS=(e,...t)=>{try{return!!e(...t)}catch{return!1}},VB=e=>{e=Ne.merge.call({skipUndefined:!0},GB,e);const{fetch:t,Request:r,Response:n}=e,a=t?D0(t):typeof fetch=="function",i=D0(r),s=D0(n);if(!a)return!1;const o=a&&D0(oS),c=a&&(typeof lS=="function"?(x=>g=>x.encode(g))(new lS):async x=>new Uint8Array(await new r(x).arrayBuffer())),u=i&&o&&cS(()=>{let x=!1;const g=new r(Mn.origin,{body:new oS,method:"POST",get duplex(){return x=!0,"half"}}).headers.has("Content-Type");return x&&!g}),d=s&&o&&cS(()=>Ne.isReadableStream(new n("").body)),f={stream:d&&(x=>x.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(x=>{!f[x]&&(f[x]=(g,y)=>{let v=g&&g[x];if(v)return v.call(g);throw new vt(`Response type '${x}' is not supported`,vt.ERR_NOT_SUPPORT,y)})});const m=async x=>{if(x==null)return 0;if(Ne.isBlob(x))return x.size;if(Ne.isSpecCompliantForm(x))return(await new r(Mn.origin,{method:"POST",body:x}).arrayBuffer()).byteLength;if(Ne.isArrayBufferView(x)||Ne.isArrayBuffer(x))return x.byteLength;if(Ne.isURLSearchParams(x)&&(x=x+""),Ne.isString(x))return(await c(x)).byteLength},p=async(x,g)=>{const y=Ne.toFiniteNumber(x.getContentLength());return y??m(g)};return async x=>{let{url:g,method:y,data:v,signal:b,cancelToken:w,timeout:k,onDownloadProgress:S,onUploadProgress:_,responseType:C,headers:E,withCredentials:A="same-origin",fetchOptions:T}=g3(x),D=t||fetch;C=C?(C+"").toLowerCase():"text";let I=UB([b,w&&w.toAbortSignal()],k),z=null;const X=I&&I.unsubscribe&&(()=>{I.unsubscribe()});let H;try{if(_&&u&&y!=="get"&&y!=="head"&&(H=await p(E,v))!==0){let le=new r(g,{method:"POST",body:v,duplex:"half"}),R;if(Ne.isFormData(v)&&(R=le.headers.get("content-type"))&&E.setContentType(R),le.body){const[j,V]=rS(H,em(nS(_)));v=iS(le.body,sS,j,V)}}Ne.isString(A)||(A=A?"include":"omit");const L=i&&"credentials"in r.prototype,W={...T,signal:I,method:y.toUpperCase(),headers:E.normalize().toJSON(),body:v,duplex:"half",credentials:L?A:void 0};z=i&&new r(g,W);let ie=await(i?D(z,T):D(g,W));const B=d&&(C==="stream"||C==="response");if(d&&(S||B&&X)){const le={};["status","statusText","headers"].forEach(P=>{le[P]=ie[P]});const R=Ne.toFiniteNumber(ie.headers.get("content-length")),[j,V]=S&&rS(R,em(nS(S),!0))||[];ie=new n(iS(ie.body,sS,j,()=>{V&&V(),X&&X()}),le)}C=C||"text";let ee=await f[Ne.findKey(f,C)||"text"](ie,x);return!B&&X&&X(),await new Promise((le,R)=>{m3(le,R,{data:ee,headers:Ii.from(ie.headers),status:ie.status,statusText:ie.statusText,config:x,request:z})})}catch(L){throw X&&X(),L&&L.name==="TypeError"&&/Load failed|fetch/i.test(L.message)?Object.assign(new vt("Network Error",vt.ERR_NETWORK,x,z),{cause:L.cause||L}):vt.from(L,L&&L.code,x,z)}}},KB=new Map,x3=e=>{let t=e?e.env:{};const{fetch:r,Request:n,Response:a}=t,i=[n,a,r];let s=i.length,o=s,c,u,d=KB;for(;o--;)c=i[o],u=d.get(c),u===void 0&&d.set(c,u=o?new Map:VB(t)),d=u;return u};x3();const tv={http:lB,xhr:jB,fetch:{get:x3}};Ne.forEach(tv,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const uS=e=>`- ${e}`,qB=e=>Ne.isFunction(e)||e===null||e===!1,y3={getAdapter:(e,t)=>{e=Ne.isArray(e)?e:[e];const{length:r}=e;let n,a;const i={};for(let s=0;s<r;s++){n=e[s];let o;if(a=n,!qB(n)&&(a=tv[(o=String(n)).toLowerCase()],a===void 0))throw new vt(`Unknown adapter '${o}'`);if(a&&(Ne.isFunction(a)||(a=a.get(t))))break;i[o||"#"+s]=a}if(!a){const s=Object.entries(i).map(([c,u])=>`adapter ${c} `+(u===!1?"is not supported by the environment":"is not available in the build"));let o=r?s.length>1?`since :
`+s.map(uS).join(`
`):" "+uS(s[0]):"as no adapter specified";throw new vt("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return a},adapters:tv};function fx(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new bu(null,e)}function dS(e){return fx(e),e.headers=Ii.from(e.headers),e.data=dx.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),y3.getAdapter(e.adapter||gb.adapter,e)(e).then(function(n){return fx(e),n.data=dx.call(e,e.transformResponse,n),n.headers=Ii.from(n.headers),n},function(n){return h3(n)||(fx(e),n&&n.response&&(n.response.data=dx.call(e,e.transformResponse,n.response),n.response.headers=Ii.from(n.response.headers))),Promise.reject(n)})}const v3="1.12.2",Sp={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Sp[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const fS={};Sp.transitional=function(t,r,n){function a(i,s){return"[Axios v"+v3+"] Transitional option '"+i+"'"+s+(n?". "+n:"")}return(i,s,o)=>{if(t===!1)throw new vt(a(s," has been removed"+(r?" in "+r:"")),vt.ERR_DEPRECATED);return r&&!fS[s]&&(fS[s]=!0,console.warn(a(s," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,s,o):!0}};Sp.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function XB(e,t,r){if(typeof e!="object")throw new vt("options must be an object",vt.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const i=n[a],s=t[i];if(s){const o=e[i],c=o===void 0||s(o,i,e);if(c!==!0)throw new vt("option "+i+" must be "+c,vt.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new vt("Unknown option "+i,vt.ERR_BAD_OPTION)}}const wh={assertOptions:XB,validators:Sp},$i=wh.validators;class tm{constructor(t){this.defaults=t||{},this.interceptors={request:new eS,response:new eS}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const i=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=El(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:i}=r;n!==void 0&&wh.assertOptions(n,{silentJSONParsing:$i.transitional($i.boolean),forcedJSONParsing:$i.transitional($i.boolean),clarifyTimeoutError:$i.transitional($i.boolean)},!1),a!=null&&(Ne.isFunction(a)?r.paramsSerializer={serialize:a}:wh.assertOptions(a,{encode:$i.function,serialize:$i.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),wh.assertOptions(r,{baseUrl:$i.spelling("baseURL"),withXsrfToken:$i.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let s=i&&Ne.merge(i.common,i[r.method]);i&&Ne.forEach(["delete","get","head","post","put","patch","common"],x=>{delete i[x]}),r.headers=Ii.concat(s,i);const o=[];let c=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(r)===!1||(c=c&&g.synchronous,o.unshift(g.fulfilled,g.rejected))});const u=[];this.interceptors.response.forEach(function(g){u.push(g.fulfilled,g.rejected)});let d,f=0,m;if(!c){const x=[dS.bind(this),void 0];for(x.unshift(...o),x.push(...u),m=x.length,d=Promise.resolve(r);f<m;)d=d.then(x[f++],x[f++]);return d}m=o.length;let p=r;for(;f<m;){const x=o[f++],g=o[f++];try{p=x(p)}catch(y){g.call(this,y);break}}try{d=dS.call(this,p)}catch(x){return Promise.reject(x)}for(f=0,m=u.length;f<m;)d=d.then(u[f++],u[f++]);return d}getUri(t){t=El(this.defaults,t);const r=p3(t.baseURL,t.url,t.allowAbsoluteUrls);return u3(r,t.params,t.paramsSerializer)}}Ne.forEach(["delete","get","head","options"],function(t){tm.prototype[t]=function(r,n){return this.request(El(n||{},{method:t,url:r,data:(n||{}).data}))}});Ne.forEach(["post","put","patch"],function(t){function r(n){return function(i,s,o){return this.request(El(o||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:i,data:s}))}}tm.prototype[t]=r(),tm.prototype[t+"Form"]=r(!0)});const Nh=tm;class xb{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const n=this;this.promise.then(a=>{if(!n._listeners)return;let i=n._listeners.length;for(;i-- >0;)n._listeners[i](a);n._listeners=null}),this.promise.then=a=>{let i;const s=new Promise(o=>{n.subscribe(o),i=o}).then(a);return s.cancel=function(){n.unsubscribe(i)},s},t(function(i,s,o){n.reason||(n.reason=new bu(i,s,o),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new xb(function(a){t=a}),cancel:t}}}const YB=xb;function JB(e){return function(r){return e.apply(null,r)}}function QB(e){return Ne.isObject(e)&&e.isAxiosError===!0}const rv={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(rv).forEach(([e,t])=>{rv[t]=e});const ZB=rv;function b3(e){const t=new Nh(e),r=QT(Nh.prototype.request,t);return Ne.extend(r,Nh.prototype,t,{allOwnKeys:!0}),Ne.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return b3(El(e,a))},r}const Wr=b3(gb);Wr.Axios=Nh;Wr.CanceledError=bu;Wr.CancelToken=YB;Wr.isCancel=h3;Wr.VERSION=v3;Wr.toFormData=Np;Wr.AxiosError=vt;Wr.Cancel=Wr.CanceledError;Wr.all=function(t){return Promise.all(t)};Wr.spread=JB;Wr.isAxiosError=QB;Wr.mergeConfig=El;Wr.AxiosHeaders=Ii;Wr.formToJSON=e=>f3(Ne.isHTMLForm(e)?new FormData(e):e);Wr.getAdapter=y3.getAdapter;Wr.HttpStatusCode=ZB;Wr.default=Wr;const hx=Wr,eu=({setCurrentPage:e,selectedComponents:t,setSelectedComponents:r,onLoaded:n,user:a,onShowAuth:i,setUser:s,saveToPrebuilts:o=!1,hideCompleteButton:c=!1})=>{const[u,d]=N.useState({cpu:null,motherboard:null,gpu:null,ram:null,storage:null,psu:null,case:null,cooler:null}),f=N.useMemo(()=>t||u,[t,u]),m=r||d,[p,x]=N.useState(!1),[g,y]=N.useState(1),[v,b]=N.useState(!0),[w,k]=N.useState(!1),[S,_]=N.useState(!1),[C,E]=N.useState(!1),[A,T]=N.useState(0),[D,I]=N.useState(!1),[z,X]=N.useState(null),[H,L]=N.useState(!1),[W,ie]=N.useState(""),[B,ee]=N.useState(""),[le,R]=N.useState(!1),[j,V]=N.useState(!1),[P,q]=N.useState(!1),[O,K]=N.useState(null),[G,te]=N.useState(!1),[ce,M]=N.useState({}),[Le,Te]=N.useState({}),[je,ze]=N.useState(!1),[Ce,de]=N.useState([]),[$e,Re]=N.useState(100),[Fe,Me]=N.useState({}),[Ge,Qe]=N.useState({}),[we,pe]=N.useState(null),me=N.useRef(null),Ae=N.useRef(!1),Ke=N.useMemo(()=>[{key:"cpu",name:"Processor",icon:Ra,description:"Brain of your PC",priority:1},{key:"motherboard",name:"Motherboard",icon:ub,description:"Connects everything",priority:2},{key:"gpu",name:"Graphics Card",icon:Is,description:"Handles graphics",priority:3},{key:"ram",name:"Memory",icon:lo,description:"System memory",priority:4},{key:"storage",name:"Storage",icon:Of,description:"Data storage",priority:5},{key:"psu",name:"Power Supply",icon:rs,description:"Powers everything",priority:6},{key:"case",name:"Case",icon:nt,description:"Houses components",priority:7},{key:"cooler",name:"Cooling",icon:Rs,description:"Keeps it cool",priority:8}],[]),He=N.useCallback(()=>Ke[g-1]||Ke[0],[Ke,g]),qe=N.useCallback(F=>{switch(F){case"cpu":return"CPU";case"motherboard":return"Motherboard";case"gpu":return"GPU";case"ram":return"RAM";case"storage":return"Storage";case"psu":return"PSU";case"case":return"Case";case"cooler":return"Cooler";default:return""}},[]),xt=N.useCallback(F=>F.socket?"cpu":F.chipset||F.ram_type||F.form_factor?"motherboard":F.chipset&&F.memory?"gpu":F.type&&F.speed?"ram":F.capacity&&F.type&&(F.type.toLowerCase().includes("ssd")||F.type.toLowerCase().includes("hdd"))?"storage":F.wattage&&F.efficiency?"psu":F.form_factor&&F.fans?"case":F.type&&F.tdp?"cooler":"default",[]);N.useEffect(()=>{if(!p)return;const F=Jd(f);Re(F.score)},[f,p]),N.useEffect(()=>{(async()=>{var Z;try{const ue=He();if(!ue||!ue.key)return;const oe=qe(ue.key),se=An("components",{category:oe,...we&&{branch:we}}),he=await fetch(se);if(!he.ok){const Ve=await he.text();console.error(`Error fetching components: ${he.status} ${he.statusText}`,Ve);try{const Ze=JSON.parse(Ve);console.error("API Error Details:",Ze)}catch{console.error("Non-JSON error response:",Ve)}de([]);return}const Se=await he.json();Se.success?(de(Se.data||[]),console.log(`Loaded ${((Z=Se.data)==null?void 0:Z.length)||0} components for category: ${oe}`)):(console.error("API returned error:",Se.error||"Unknown error"),de([]))}catch(ue){console.error("Error fetching components for comparison:",ue),de([])}})()},[He,qe,we]);const dt=N.useCallback(F=>{const Z={cpu:null,motherboard:null,gpu:null,ram:null,storage:null,psu:null,case:null,cooler:null},ue={cpu:["cpu","processor","procie","procie only","processor only"],motherboard:["motherboard","mobo"],gpu:["gpu","graphics","graphics card","video","video card","vga"],ram:["ram","memory","ddr","ddr4","ddr5","ram 3200mhz"],storage:["storage","ssd","nvme","ssd nvme","hdd","hard drive","drive"],psu:["psu","power supply","psu - tr","tr psu"],case:["case","chassis","case gaming"],cooler:["cooler","coolers","cooling","aio","cpu cooler","liquid cooler","water cooling","fan","heatsink"]},oe=F||{},se={};Object.keys(oe).forEach(Se=>{se[Se.toLowerCase()]=oe[Se]});const he={};return Object.entries(ue).forEach(([Se,Ve])=>{for(const Ze of Ve)if(se[Ze]){he[Se]=se[Ze];break}}),Object.keys(se).forEach(Se=>{ue[Se]&&(he[Se]=se[Se])}),{...Z,...he}},[]),Y=N.useCallback((F,Z)=>{if(!F)return null;if(Z==="socket"){const ue=[F.socket,F.Socket,F.type,F.Type,F.model,F.Model,F.name,F.Name,F.specs&&F.specs.socket,F.specs&&F.specs.type,F.specs&&F.specs.model,F.specs&&F.specs.name];for(let oe of ue)if(typeof oe=="string"&&oe.trim()){const se=oe.trim().toLowerCase();if(se.includes("am4"))return"am4";if(se.includes("lga1200"))return"lga1200";if(se.includes("am5"))return"am5";if(se.includes("lga1700"))return"lga1700"}return null}if(Z==="brand"){const ue=[F.brand,F.Brand,F.name,F.Name,F.model,F.Model,F.type,F.Type,F.specs&&F.specs.brand,F.specs&&F.specs.name];for(let oe of ue)if(typeof oe=="string"&&oe.trim()){const se=oe.trim().toLowerCase();if(se.includes("amd"))return"amd";if(se.includes("intel"))return"intel"}return null}return Z==="ramType"?F.ram_type||F.type||F.specs&&(F.specs.ram_type||F.specs.type)||null:Z==="formFactor"?F.form_factor||F.specs&&F.specs.form_factor||null:F[Z]||F.specs&&F.specs[Z]||null},[]),ve=N.useCallback(async F=>{try{const Z=Object.values(F).filter(he=>he&&typeof he=="number");if(Z.length===0)return{};const ue=`${ke}/get_components_by_ids.php?ids=${Z.join(",")}`,se=await(await fetch(ue)).json();if(se.success&&se.data){const he={};return se.data.forEach(Se=>{const Ve=Object.keys(F).find(Ze=>F[Ze]==Se.id);Ve&&(he[Ve]=Se)}),he}return{}}catch(Z){return console.error("Error fetching components by IDs:",Z),{}}},[]),Je=N.useCallback(async(F,Z={})=>{const ue=qe(F);if(ue){Qe(oe=>({...oe,[F]:!0}));try{let oe={category:ue,limit:5};Z.socket&&(oe.socket=Z.socket),Z.type&&(oe.ramType=Z.type),Z.minWattage&&(oe.minWattage=Z.minWattage),Z.minSize&&(oe.minSize=Z.minSize),Z.formFactor&&(oe.formFactor=Z.formFactor);let{data:se}=await hx.get(`${ke}/index.php?endpoint=recommendations`,{params:oe});if(!se.data||se.data.length===0){const he={category:ue,limit:5,minPrice:1e3,maxPrice:5e5},Se=await hx.get(`${ke}/index.php?endpoint=recommendations`,{params:he});Se.data.data&&Se.data.data.length>0&&(se=Se.data)}if(!se.data||se.data.length===0){const he={category:ue,limit:3},Se=await hx.get(`${ke}/index.php?endpoint=recommendations`,{params:he});Se.data.data&&Se.data.data.length>0&&(se=Se.data)}Me(he=>({...he,[F]:se.data||[]}))}catch(oe){console.error("Error fetching recommendations:",oe),Me(se=>({...se,[F]:[]}))}finally{Qe(oe=>({...oe,[F]:!1}))}}},[qe]);N.useEffect(()=>{const F=He();if(F){const Z={};if(f.cpu){const ue=Y(f.cpu,"socket");ue&&(Z.socket=ue)}if(f.motherboard){const ue=Y(f.motherboard,"ramType");ue&&(Z.type=ue);const oe=Y(f.motherboard,"formFactor");oe&&(Z.formFactor=oe)}Je(F.key,Z)}},[g,f,He,Je,Y]);const pt=N.useCallback(F=>{const Z=f[F];if(!Z)return null;const ue=[];if(F==="cpu"&&f.motherboard){const oe=Y(Z,"socket"),se=Y(f.motherboard,"socket");oe&&se&&oe!==se&&!(oe.toLowerCase()==="am4"&&se.toLowerCase()==="am4")&&ue.push({type:"replace",message:`CPU socket (${oe}) doesn't match motherboard (${se})`,action:"Replace CPU",targetCategory:"cpu",requirements:{socket:se}})}if(F==="motherboard"){const oe=Y(Z,"socket"),se=Y(Z,"ramType");if(f.cpu){const he=Y(f.cpu,"socket");oe&&he&&oe!==he&&!(oe.toLowerCase()==="am4"&&he.toLowerCase()==="am4")&&ue.push({type:"replace",message:`Motherboard socket (${oe}) doesn't match CPU (${he})`,action:"Replace Motherboard",targetCategory:"motherboard",requirements:{socket:he}})}if(f.ram){const he=Y(f.ram,"ramType");se&&he&&se!==he&&ue.push({type:"replace",message:`Motherboard supports ${se} but RAM is ${he}`,action:"Replace RAM",targetCategory:"ram",requirements:{type:se}})}}if(F==="ram"&&f.motherboard){const oe=Y(Z,"ramType"),se=Y(f.motherboard,"ramType");oe&&se&&oe!==se&&ue.push({type:"replace",message:`RAM type (${oe}) doesn't match motherboard (${se})`,action:"Replace RAM",targetCategory:"ram",requirements:{type:se}});const he=Y(Z,"sticks")||Y(Z,"modules")||1,Se=Y(f.motherboard,"ram_slots")||Y(f.motherboard,"slots")||2;he>Se&&ue.push({type:"replace",message:`Selected RAM (${he} sticks) exceeds motherboard slots (${Se})`,action:"Replace RAM",targetCategory:"ram",requirements:{maxSticks:Se}})}if(F==="storage"&&f.motherboard){const oe=Y(Z,"interface")||Y(Z,"type"),se=Y(f.motherboard,"storage_interfaces")||Y(f.motherboard,"storage_support");oe&&se&&!String(se).toLowerCase().includes(String(oe).toLowerCase())&&ue.push({type:"replace",message:`Storage interface (${oe}) not supported by motherboard (${se})`,action:"Replace Storage",targetCategory:"storage",requirements:{interface:se}})}if(F==="psu"){const oe=Y(f.cpu,"tdp")||0,se=Y(f.gpu,"tdp")||0,he=oe+se+100,Se=Math.ceil(he*1.2/10)*10,Ve=Y(Z,"wattage");if(Ve&&Ve<Se&&ue.push({type:"upgrade",message:`PSU (${Ve}W) may not provide enough power (${Se}W recommended)`,action:"Upgrade PSU",targetCategory:"psu",requirements:{minWattage:Se}}),f.case){const Ze=Y(Z,"form_factor")||Y(Z,"type"),ot=Y(f.case,"psu_support")||Y(f.case,"psu_type");Ze&&ot&&!String(ot).toLowerCase().includes(String(Ze).toLowerCase())&&ue.push({type:"replace",message:`PSU form factor (${Ze}) not supported by case (${ot})`,action:"Replace PSU",targetCategory:"psu",requirements:{form_factor:ot}})}}if(F==="gpu"&&f.case){const oe=Y(Z,"length")||Y(Z,"max_length"),se=Y(f.case,"gpu_max_length")||Y(f.case,"max_gpu_length");oe&&se&&Number(oe)>Number(se)&&ue.push({type:"replace",message:`GPU length (${oe}mm) exceeds case max GPU length (${se}mm)`,action:"Replace GPU",targetCategory:"gpu",requirements:{maxLength:se}})}if(F==="cooler"&&f.case){const oe=Y(Z,"height")||Y(Z,"max_height"),se=Y(f.case,"cooler_max_height")||Y(f.case,"max_cooler_height");oe&&se&&Number(oe)>Number(se)&&ue.push({type:"replace",message:`Cooler height (${oe}mm) exceeds case max cooler height (${se}mm)`,action:"Replace Cooler",targetCategory:"cooler",requirements:{maxHeight:se}})}if(F==="case"&&f.motherboard){const oe=Y(f.case,"formFactor"),se=Y(f.motherboard,"formFactor");oe&&se&&((Array.isArray(oe)?oe.map(Se=>Se.toLowerCase()):String(oe).split(/,|\//).map(Se=>Se.trim().toLowerCase())).includes(String(se).toLowerCase())||ue.push({type:"replace",message:`Case form factor (${oe}) may not fit motherboard (${se})`,action:"Replace Case",targetCategory:"case",requirements:{formFactor:se}}))}return ue},[f,Y]),fe=(F,Z=!1)=>F>=90?Z?"bg-green-500":"text-green-600":F>=70?Z?"bg-yellow-500":"text-yellow-600":F>=50?Z?"bg-orange-500":"text-orange-600":Z?"bg-red-500":"text-red-600",De=F=>F>=90?"bg-green-50 border-green-400":F>=70?"bg-yellow-50 border-yellow-400":F>=50?"bg-orange-50 border-orange-400":"bg-red-50 border-red-400",Ie=F=>F>=90?"text-green-800":F>=70?"text-yellow-800":F>=50?"text-orange-800":"text-red-800",Ye=F=>F>=90?"Excellent! Your build is highly compatible and ready for assembly.":F>=70?"Good compatibility with minor optimizations available.":F>=50?"Moderate compatibility - some components may need adjustment.":F>0?"Low compatibility - significant issues detected that need attention.":"No components selected yet - start building to see compatibility score.",Oe=N.useCallback((F,Z)=>{m(oe=>({...oe,[F]:Z})),Ke.findIndex(oe=>oe.key===F)===g-1&&g<Ke.length&&y(g+1)},[m,Ke,g]),at=N.useCallback(F=>{m(Z=>({...Z,[F]:null}))},[m]);N.useCallback(F=>{y(Ke.findIndex(Z=>Z.key===F.targetCategory)+1)},[Ke]);const Gr=N.useCallback(()=>{const F={cpu:null,motherboard:null,gpu:null,ram:null,storage:null,psu:null,case:null,cooler:null};try{m(F)}catch{}try{d&&d(F)}catch{}try{localStorage.removeItem("builditpc-selected-components")}catch{}try{localStorage.removeItem("builditpc-editing-build")}catch{}M({}),Te({}),Me({}),Re(0),y(1),q(!1),K(null),ie(""),ee("");try{me.current=JSON.stringify(F)}catch{}T(Z=>Z+1);try{window.dispatchEvent(new CustomEvent("builditpc:clear"))}catch{}},[m,d]),Nr=N.useCallback(()=>Object.values(f).filter(F=>F).reduce((F,Z)=>{if(typeof Z=="object"&&Z!==null){const ue=typeof Z.price=="string"?parseFloat(Z.price):Z.price||0;return F+ue}return F},0),[f]),xi=N.useCallback(()=>["cpu","motherboard","gpu","ram","storage","psu","case"].filter(oe=>{const se=f[oe];return!se||typeof se!="object"||Object.keys(se).length===0?!1:se.id&&se.name}).length===0?0:Jd(f).score,[f]),d0=N.useCallback(()=>{const F=[];return ce.cpu_motherboard===!1&&F.push("cpu","motherboard"),ce.ram_motherboard===!1&&F.push("ram","motherboard"),ce.ram_slots===!1&&F.push("ram","motherboard"),ce.ram_speed===!1&&F.push("ram","motherboard"),ce.storage_interface===!1&&F.push("storage","motherboard"),ce.psu_power===!1&&F.push("psu"),ce.psu_form_factor===!1&&F.push("psu","case"),ce.case_motherboard===!1&&F.push("case","motherboard"),ce.gpu_length===!1&&F.push("gpu","case"),ce.cooler_height===!1&&F.push("cooler","case"),ce.cooler_socket===!1&&F.push("cooler","cpu"),ce.ram_cpu_speed===!1&&F.push("ram","cpu"),new Set(F)},[ce]),Ko=N.useCallback(()=>Object.entries(f).filter(([F,Z])=>Z!=null).length,[f]),Lt=N.useCallback(()=>7,[]),Ct=N.useCallback(()=>["cpu","motherboard","gpu","ram","storage","psu","case"].filter(Z=>{const ue=f[Z];return!ue||typeof ue!="object"||Object.keys(ue).length===0?!1:ue.id&&ue.name}).length,[f]);N.useCallback(()=>Ct()>=5,[Ct]);const rc=N.useCallback(()=>{const F=f;let Z=0,ue=0,oe=0,se=0;if(F.gpu&&F.cpu){const he=typeof F.gpu=="object"&&F.gpu.price||0,Se=typeof F.cpu=="object"&&F.cpu.price||0;Z=Math.min(100,he/5e4*100+Se/3e4*100)}if(F.cpu&&F.ram){const he=typeof F.cpu=="object"&&F.cpu.cores||0,Se=typeof F.ram=="object"&&F.ram.capacity||0;ue=Math.min(100,he/16*100+Se/64*100)}return F.cooler&&typeof F.cooler=="object"?oe=F.cooler.type==="AIO Liquid Cooler"?100:F.cooler.type==="Air Cooler"?80:60:oe=40,F.motherboard&&(typeof F.motherboard=="object"?se=F.motherboard.ram_type==="DDR5"?100:70:se=70),{gamingScore:Z,workstationScore:ue,coolingScore:oe,upgradeScore:se}},[f]),Gn=N.useMemo(()=>rc(),[rc]),za=N.useCallback(()=>{const F=["cpu","motherboard","gpu","ram","storage","psu","case"],Z=F.filter(ue=>{const oe=f[ue];return!oe||typeof oe!="object"||Object.keys(oe).length===0?!1:oe.id&&oe.name}).length;return Math.round(Z/F.length*100)},[f]);N.useCallback(F=>{if(!f[F])return!1;switch(F){case"cpu":return ce.cpu_motherboard===!1||ce.cooler_socket===!1||ce.ram_cpu_speed===!1;case"motherboard":return ce.cpu_motherboard===!1||ce.ram_motherboard===!1||ce.ram_slots===!1||ce.ram_speed===!1||ce.storage_interface===!1||ce.case_motherboard===!1;case"ram":return ce.ram_motherboard===!1||ce.ram_slots===!1||ce.ram_speed===!1||ce.ram_cpu_speed===!1;case"storage":return ce.storage_interface===!1;case"psu":return ce.psu_power===!1||ce.psu_form_factor===!1;case"case":return ce.case_motherboard===!1||ce.gpu_length===!1||ce.cooler_height===!1||ce.psu_form_factor===!1;case"gpu":return ce.gpu_length===!1;case"cooler":return ce.cooler_height===!1||ce.cooler_socket===!1;default:return!1}},[f,ce]);const Sn=Object.values(ce).some(F=>F===!1),Mu=()=>Ct()===Lt()?Sn?ce.cpu_motherboard===!1?"Incompatible: Socket mismatch":"Compatibility issues detected":xi()===100?"Build compatible and ready":"":"Build incomplete, please add more components",U=F=>{try{const Z=F.split(".")[1];if(!Z)return!0;let ue=Z.replace(/-/g,"+").replace(/_/g,"/");for(;ue.length%4;)ue+="=";const oe=JSON.parse(atob(ue));return oe.exp?Date.now()>=oe.exp*1e3:!1}catch{return!0}},[re,J]=N.useState(!1),[Q,ne]=N.useState(!1),ae=N.useCallback(async()=>{if(Ct()<Lt()){alert("Build incomplete, please add more components");return}const F=localStorage.getItem("token");if(!F||U(F)||!a){E(!0);return}try{ne(!0);const Z=["cpu","motherboard","gpu","ram","storage","psu","case"],ue=["cooler"],oe={},se=[],he=(ot,Et)=>{ot&&typeof ot.id=="number"&&(oe[Et]=ot.id,se.push({component_id:ot.id,quantity:1}))};if(Z.forEach(ot=>he(f[ot],ot)),ue.forEach(ot=>he(f[ot],ot)),se.length===0){alert("No valid components found to add to cart.");return}try{const ot=Object.values(oe).filter(Yt=>typeof Yt=="number"),Et=`${ke}/index.php?endpoint=cart&action=find_prebuilt&component_ids=${encodeURIComponent(JSON.stringify(ot))}`,Bt=await fetch(Et,{headers:{Authorization:`Bearer ${F}`}});if(Bt.ok){const Yt=await Bt.json();if(Yt.success&&Yt.prebuilt){const Ir=await fetch(`${ke}/index.php?endpoint=cart`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${F}`},body:JSON.stringify({prebuilt_id:Yt.prebuilt.id,quantity:1})}),yi=await Ir.json();if(Ir.ok&&yi.success){alert(`Prebuilt PC "${Yt.prebuilt.name}" added to cart successfully!`);return}else console.warn("Failed to add prebuilt, falling back to individual components:",yi.error)}}}catch(ot){console.warn("Error checking for matching prebuilt, adding components individually:",ot)}let Se=0,Ve=[],Ze={};for(const ot of se)try{const Et=await fetch(`${ke}/index.php?endpoint=cart`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${F}`},body:JSON.stringify(ot)}),Bt=await Et.json().catch(()=>({}));if(Et.ok&&Bt.success)Se++;else{const Yt=Bt.error||"Failed to add component to cart";if(Ve.push(Yt),Bt.prebuilt_id&&Bt.prebuilt_name){const Ir=Bt.prebuilt_id;Ze[Ir]||(Ze[Ir]={name:Bt.prebuilt_name,count:0,errors:[]}),Ze[Ir].count++,Ze[Ir].errors.push(Yt)}}}catch(Et){Ve.push(`Error adding component: ${Et.message}`)}if(Se===se.length)alert(`All ${Se} components added to cart successfully!`);else if(Se>0){let ot=`Added ${Se} out of ${se.length} components to cart.

`;const Et=Object.keys(Ze);Et.length>0?(ot+=`Some components could not be added because they are already included in prebuilt PC(s) in your cart:

`,Et.forEach(Bt=>{const Yt=Ze[Bt];ot+=`â€¢ "${Yt.name}": ${Yt.count} component(s) already in cart
`}),ot+=`
Tip: If you want to add this build as a separate prebuilt, you can add it directly from the Prebuilt PCs page instead of adding components individually.`):ot+=`Some items could not be added:
`+Ve.join(`
`),alert(ot)}else alert(`Failed to add items to cart:
${Ve.join(`
`)}`)}catch(Z){console.error("Add to cart failed:",Z),alert(`Failed to add to cart: ${Z.message}`)}finally{ne(!1)}},[f,a,ke,Lt,Ct,e]),ye=N.useCallback(()=>{if(Ct()<Lt()){alert("Build incomplete, please add more components");return}if(Sn){ce.cpu_motherboard===!1?alert("Incompatible: Socket mismatch"):alert("Please resolve critical compatibility issues before proceeding.");return}const F=localStorage.getItem("token");if(!F||U(F)||!a){E(!0);return}L(!0)},[f,a,Sn,Lt,Ct]),Ee=N.useCallback(async()=>{try{const F=localStorage.getItem("token");if(!F||U(F)||!a){E(!0),L(!1);return}const Z=["cpu","motherboard","gpu","ram","storage","psu","case"],ue=["cooler"],oe=[],se=Ve=>{if(Ve&&typeof Ve.id=="number"){const Ze=typeof Ve.price=="string"?parseFloat(Ve.price):Ve.price||0;oe.push({component_id:Ve.id,quantity:1,unit_price:Ze})}};if(Z.forEach(Ve=>se(f[Ve])),ue.forEach(Ve=>se(f[Ve])),oe.length===0){alert("No valid components found to place an order."),L(!1);return}I(!0);const he=await fetch(`${ke}/index.php?endpoint=orders${we?`&branch=${encodeURIComponent(we)}`:""}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${F}`},body:JSON.stringify({user_id:a==null?void 0:a.id,status:"pending",items:oe})}),Se=await he.json().catch(()=>({}));if(!he.ok||!Se.success){if(Se.out_of_stock_items&&Array.isArray(Se.out_of_stock_items)&&Se.out_of_stock_items.length>0){const Ve=Se.out_of_stock_items.map(Ze=>Ze.available===0?`  â€¢ ${Ze.name} - Out of stock`:`  â€¢ ${Ze.name} - Requested: ${Ze.requested}, Available: ${Ze.available}`).join(`
`);throw new Error(`${Se.error||"Insufficient stock"}

Out of stock components:
${Ve}

Please select different components or wait for restocking.`)}throw new Error(Se.error||"Failed to place order")}L(!1),X({order_id:Se.order_id,total:Se.total})}catch(F){console.error("Order creation failed:",F),alert(`Failed to place order: ${F.message}`)}finally{I(!1)}},[f,a,ke,we]),ge=N.useCallback(async F=>{if(!F||!Number.isInteger(F)||F<=0)throw console.error("Submission failed: Build ID is required"),new Error("Build ID is required");const Z=localStorage.getItem("token");if(!Z||U(Z)||!a)throw E(!0),new Error("Authentication required");te(!0);try{const ue=await fetch(`${ke}/index.php?endpoint=community_submission`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Z}`},body:JSON.stringify({build_id:F,build_name:W,build_description:B,total_price:Nr(),compatibility:$e})});if(!ue.ok){const se=await ue.text();throw console.error("Server response:",se),new Error(`HTTP error! status: ${ue.status}`)}const oe=await ue.json();if(!oe.success)throw console.error("Submission failed:",oe.error),new Error(oe.error||"Failed to submit build for review");return oe}catch(ue){throw console.error("Error in handleSubmitToCommunity:",ue),ue}finally{te(!1)}},[W,B,Nr,$e,a,ke]),be=N.useCallback(async()=>{var se,he,Se,Ve,Ze,ot;if(!W.trim())return;const F=localStorage.getItem("token");if(re)return;if(!F||U(F)||!a){E(!0);return}if(j)return;const Z=Object.fromEntries(Object.entries(f).filter(([Et,Bt])=>Bt&&typeof Bt.id=="number")),oe=["cpu","motherboard","gpu","ram","storage","psu","case"].filter(Et=>!Z[Et]);if(oe.length>0){alert("Please select valid components for: "+oe.join(", "));return}V(!0);try{if(o){const Et=nc=>{const ga=[],vi=ac=>{const f0=nc[ac];if(f0&&f0.name){const Mg=f0.name.split(",")[0].split("(")[0].trim();ga.push(Mg)}};return vi("cpu"),vi("motherboard"),vi("gpu"),vi("ram"),vi("storage"),vi("psu"),vi("case"),vi("cooler"),ga.join(", ")},Bt={};Object.entries(Z).forEach(([nc,ga])=>{ga&&typeof ga.id=="number"&&(Bt[nc]=ga.id)});const Yt={name:W,category:"Custom",description:B&&B.trim().length>0?B:Et(Z),component_ids:Bt,price:Nr(),performance:{},features:[((se=Z.cpu)==null?void 0:se.name)||null,((he=Z.gpu)==null?void 0:he.name)||null,((Se=Z.ram)==null?void 0:Se.name)||null,((Ve=Z.storage)==null?void 0:Ve.name)||null].filter(Boolean),in_stock:1,is_hidden:0},Ir={"Content-Type":"application/json"};F&&(Ir.Authorization=`Bearer ${F}`);const yi=await fetch(An("prebuilts"),{method:"POST",headers:Ir,body:JSON.stringify(Yt)}),Vn=await yi.json();if(!yi.ok||!Vn.success)throw new Error(Vn.error||"Failed to save as prebuilt");alert("Prebuilt created successfully. You can manage it in Prebuilt Management."),k(!1)}else{const Et={name:W,description:B,components:Z,compatibility:$e,totalPrice:Nr(),is_public:le},Bt=typeof O=="string"?parseInt(O,10):O,Yt=P&&Number.isFinite(Bt)&&Bt>0,Ir=Yt?"PUT":"POST";let yi=Yt?`${ke}/index.php?endpoint=builds&id=${Bt}`:`${ke}/index.php?endpoint=builds`;const Vn={"Content-Type":"application/json"};F&&(Vn.Authorization=`Bearer ${F}`);const nc=await fetch(yi,{method:Ir,headers:Vn,body:JSON.stringify(Et)}),ga=await nc.json();if(ga.success){const vi=Yt?Bt||ga.build_id||((Ze=ga.data)==null?void 0:Ze.id):ga.build_id||((ot=ga.data)==null?void 0:ot.id),ac=vi?parseInt(vi,10):null;if(le&&ac&&Number.isInteger(ac)&&ac>0)try{await ge(ac),alert("Your build has been saved and submitted for community review!")}catch(Mg){console.error("Error during community submission:",Mg),alert("Build saved successfully, but there was an error submitting for community review.")}ie(""),ee(""),k(!1),localStorage.removeItem("builditpc-selected-components"),localStorage.removeItem("builditpc-editing-build"),q(!1),K(null),alert(P?"Build updated successfully! You can view it in My Builds.":"Build saved successfully! You can view it in My Builds."),e("my-builds")}else nc.status===409?alert("A build with this name and configuration already exists."):alert("Error saving build: "+(ga.error||"Unknown error"))}}catch(Et){console.error("Error saving build:",Et),alert("Error saving build. Please try again.")}finally{V(!1)}},[W,B,f,P,O,$e,Nr,e,a,s,re,o,le,ge]);return N.useEffect(()=>{if(Ae.current)return;(async()=>{try{let Z=dt({});if(t&&Object.keys(t).length>0)if(Object.values(t).some(oe=>typeof oe=="number")){const oe=await ve(t);Z=dt(oe)}else Z=dt(t);else if(a&&a.id){const ue=localStorage.getItem("builditpc-selected-components");if(ue)try{const oe=JSON.parse(ue);Z=dt(oe),Object.values(oe).some(he=>he!=null&&typeof he=="object"&&Object.keys(he).length>0&&he.id&&he.name)&&(_(!0),setTimeout(()=>_(!1),5e3))}catch(oe){console.error("Error parsing saved components:",oe)}}else localStorage.removeItem("builditpc-selected-components"),localStorage.removeItem("builditpc-editing-build");if(m(Z),x(!0),n&&n(),a&&a.id){const ue=localStorage.getItem("builditpc-editing-build");if(ue)try{const oe=JSON.parse(ue),se=typeof oe.id=="string"?parseInt(oe.id,10):oe.id;Number.isFinite(se)&&se>0?(q(!0),K(se)):(q(!1),K(null)),ie(oe.name||""),ee(oe.description||"")}catch(oe){console.error("Error parsing editing build data:",oe)}}Ae.current=!0}catch(Z){console.error("Error initializing component:",Z),x(!0),Ae.current=!0}})()},[t]),N.useEffect(()=>{if(!p)return;const F={},Z={},ue=(oe,se)=>{if(!oe)return null;const Se={socket:["socket","Socket","type","Type","cpu_socket"],ramType:["ramType","ram_type","memory_type","type","Type","ddr"],formFactor:["formFactor","form_factor","size","Size","type","Type"],wattage:["wattage","Wattage","power","Power","w","W"],tdp:["tdp","TDP","thermal_design_power","power_consumption"],length:["length","Length","max_length","maxLength","size"],height:["height","Height","max_height","maxHeight"],width:["width","Width","max_width","maxWidth"],interface:["interface","Interface","connection","Connection","type","Type"],slots:["slots","Slots","ram_slots","memory_slots","dimms"],sticks:["sticks","Sticks","modules","Modules","ram_modules"],storage_interfaces:["storage_interfaces","storage_support","sata_ports","m2_slots"],gpu_max_length:["gpu_max_length","max_gpu_length","gpu_length","max_length"],cooler_max_height:["cooler_max_height","max_cooler_height","cpu_cooler_height"],psu_support:["psu_support","psu_type","power_supply_support"],chipset:["chipset","Chipset","platform","Platform"]}[se]||[se];for(const Ze of Se){if(oe[Ze])return oe[Ze];if(oe.specs&&oe.specs[Ze])return oe.specs[Ze]}const Ve=`${oe.name||""} ${oe.description||""}`.toLowerCase();return se==="socket"&&Ve.includes("am4")?"AM4":se==="socket"&&Ve.includes("am5")?"AM5":se==="socket"&&Ve.includes("lga1200")?"LGA1200":se==="socket"&&Ve.includes("lga1700")?"LGA1700":se==="ramType"&&Ve.includes("ddr4")?"DDR4":se==="ramType"&&Ve.includes("ddr5")?"DDR5":se==="formFactor"&&Ve.includes("atx")?"ATX":se==="formFactor"&&Ve.includes("micro-atx")?"Micro-ATX":se==="formFactor"&&Ve.includes("mini-itx")?"Mini-ITX":null};if(f.cpu&&f.motherboard){const oe=ue(f.cpu,"socket"),se=ue(f.motherboard,"socket"),he=f.cpu.name||"",Se=f.motherboard.name||"",Ze=(()=>{if(!oe||!se)return null;const ot=oe.toLowerCase().trim(),Et=se.toLowerCase().trim();if(ot.includes("am4")&&Et.includes("am4")){const Bt=/ryzen\s*(5[0-9]{3}|5600|5700|5800|5900|5950)/i.test(he),Yt=/(a320|b350|b450|a520)/i.test(Se);return Bt&&Yt?{compatible:!0,warning:"May require BIOS update for Ryzen 5000 series"}:{compatible:!0}}return ot.includes("am5")&&Et.includes("am5")?{compatible:!0}:ot.includes("lga1200")&&Et.includes("lga1200")?{compatible:!0}:ot.includes("lga1700")&&Et.includes("lga1700")?{compatible:!0}:ot.includes("lga1851")&&Et.includes("lga1851")?{compatible:!0}:{compatible:!1}})();Ze===null?Z.cpu_motherboard="Cannot determine socket compatibility (missing data)":Ze.compatible?(F.cpu_motherboard=!0,Ze.warning&&(Z.cpu_motherboard=`Compatible. ${Ze.warning}`)):(F.cpu_motherboard=!1,Z.cpu_motherboard=`CPU socket (${oe}) is not compatible with motherboard socket (${se})`)}if(f.ram&&f.motherboard){const oe=ue(f.ram,"ramType"),se=ue(f.motherboard,"ramType"),he=ue(f.ram,"sticks")||1,Se=ue(f.motherboard,"slots")||2,Ve=ue(f.ram,"speed")||ue(f.ram,"frequency"),Ze=ue(f.motherboard,"max_ram_speed")||ue(f.motherboard,"memory_speed");if(oe&&se){const ot=oe.toLowerCase().trim(),Et=se.toLowerCase().trim();ot!==Et?(F.ram_motherboard=!1,Z.ram_motherboard=`RAM type (${oe}) is not compatible with motherboard (${se})`):F.ram_motherboard=!0}else Z.ram_motherboard="Cannot determine RAM type compatibility (missing data)";if(he>Se&&(F.ram_slots=!1,Z.ram_slots=`Selected RAM (${he} sticks) exceeds motherboard slots (${Se})`),Ve&&Ze){const ot=parseInt(Ve),Et=parseInt(Ze);ot>Et&&(F.ram_speed=!1,Z.ram_speed=`RAM speed (${Ve}MHz) exceeds motherboard maximum (${Ze}MHz)`)}}if(f.storage&&f.motherboard){const oe=ue(f.storage,"interface"),se=ue(f.motherboard,"storage_interfaces");if(oe&&se){const he=oe.toLowerCase(),Se=se.toLowerCase();he.includes("sata")&&Se.includes("sata")||he.includes("nvme")&&Se.includes("nvme")||he.includes("m.2")&&Se.includes("m.2")||he.includes("pcie")&&Se.includes("pcie")?F.storage_interface=!0:(F.storage_interface=!1,Z.storage_interface=`Storage interface (${oe}) not supported by motherboard`)}else Z.storage_interface="Cannot determine storage compatibility (missing data)"}if(f.psu){const oe=ue(f.psu,"wattage");if(oe){let se=0;if(f.cpu){const Ve=ue(f.cpu,"tdp")||65;se+=parseInt(Ve)}if(f.gpu){const Ve=ue(f.gpu,"tdp")||150;se+=parseInt(Ve)}se+=100;const he=Math.ceil(se*1.2/50)*50,Se=parseInt(oe);Se<he?(F.psu_power=!1,Z.psu_power=`PSU wattage (${oe}W) is below recommended (${he}W) for your components`):Se<he*1.5?(F.psu_power=!0,Z.psu_power=`PSU wattage (${oe}W) is adequate but consider ${he*1.5}W for better efficiency`):F.psu_power=!0}else Z.psu_power="Cannot determine PSU compatibility (missing wattage data)";if(f.case){const se=ue(f.psu,"form_factor"),he=ue(f.case,"psu_support");if(se&&he){const Se=se.toLowerCase(),Ve=he.toLowerCase();Se.includes("atx")&&Ve.includes("atx")||Se.includes("sfx")&&Ve.includes("sfx")||Se.includes("sfx-l")&&Ve.includes("sfx-l")?F.psu_form_factor=!0:(F.psu_form_factor=!1,Z.psu_form_factor=`PSU form factor (${se}) not supported by case`)}}}if(f.case&&f.motherboard){const oe=ue(f.case,"formFactor"),se=ue(f.motherboard,"formFactor");if(oe&&se){const he=oe.toLowerCase(),Se=se.toLowerCase();({atx:["atx","micro-atx","mini-itx"],"micro-atx":["micro-atx","mini-itx"],"mini-itx":["mini-itx"],"e-atx":["e-atx","atx","micro-atx","mini-itx"]}[he]||[]).includes(Se)?F.case_motherboard=!0:(F.case_motherboard=!1,Z.case_motherboard=`Case form factor (${oe}) does not support motherboard (${se})`)}else Z.case_motherboard="Cannot determine form factor compatibility (missing data)"}if(f.gpu&&f.case){const oe=ue(f.gpu,"length"),se=ue(f.case,"gpu_max_length");if(oe&&se){const he=parseInt(oe),Se=parseInt(se);he>Se?(F.gpu_length=!1,Z.gpu_length=`GPU length (${oe}mm) exceeds case maximum (${se}mm)`):F.gpu_length=!0}else Z.gpu_length="Cannot determine GPU-case compatibility (missing data)"}if(f.cooler&&f.case){const oe=ue(f.cooler,"height"),se=ue(f.case,"cooler_max_height");if(oe&&se){const he=parseInt(oe),Se=parseInt(se);he>Se?(F.cooler_height=!1,Z.cooler_height=`Cooler height (${oe}mm) exceeds case maximum (${se}mm)`):F.cooler_height=!0}else Z.cooler_height="Cannot determine cooler-case compatibility (missing data)"}if(f.cooler&&f.cpu){const oe=ue(f.cooler,"socket"),se=ue(f.cpu,"socket");if(oe&&se){const he=oe.toLowerCase(),Se=se.toLowerCase();he.includes("am4")&&Se.includes("am4")||he.includes("am5")&&Se.includes("am5")||he.includes("lga1200")&&Se.includes("lga1200")||he.includes("lga1700")&&Se.includes("lga1700")||he.includes("universal")||he.includes("all")?F.cooler_socket=!0:(F.cooler_socket=!1,Z.cooler_socket=`CPU cooler socket (${oe}) not compatible with CPU (${se})`)}}if(f.ram&&f.cpu){const oe=ue(f.ram,"speed"),se=ue(f.cpu,"max_memory_speed");if(oe&&se){const he=parseInt(oe),Se=parseInt(se);he>Se&&(F.ram_cpu_speed=!1,Z.ram_cpu_speed=`RAM speed (${oe}MHz) exceeds CPU maximum (${se}MHz)`)}}M(F),Te(Z)},[f,p]),N.useEffect(()=>{if(!a||!a.id)return;const F=JSON.stringify(f),Z=me.current;F!==Z&&(localStorage.setItem("builditpc-selected-components",F),me.current=F)},[f,a]),N.useEffect(()=>{(!a||!a.id)&&(localStorage.removeItem("builditpc-selected-components"),localStorage.removeItem("builditpc-editing-build"),me.current=null)},[a]),N.useEffect(()=>()=>{P&&localStorage.removeItem("builditpc-editing-build"),Ae.current=!1},[P]),N.useEffect(()=>{const F=localStorage.getItem("token");!a&&typeof s=="function"&&F&&!U(F)&&(J(!0),fetch(`${ke}/index.php?endpoint=profile`,{method:"GET",headers:{Authorization:`Bearer ${F}`}}).then(Z=>Z.status===401?null:Z.json()).then(Z=>{Z&&Z.success&&Z.user&&s(Z.user)}).catch(()=>{}).finally(()=>J(!1)))},[a,s]),p?h("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:[Sn&&h("div",{className:"bg-red-100 border border-red-300 text-red-800 px-6 py-4 flex items-center justify-between shadow-md",children:[h("div",{className:"flex items-center gap-3",children:[l(Fn,{className:"w-6 h-6 text-red-600"}),l("span",{className:"font-semibold",children:"Compatibility Issues Detected!"}),l("span",{className:"text-sm",children:"Some components are not compatible. Please review the issues below before saving your build."})]}),l("button",{onClick:()=>{var F;return window.scrollTo({top:((F=document.getElementById("compatibility-checker"))==null?void 0:F.offsetTop)||0,behavior:"smooth"})},className:"ml-4 px-4 py-2 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 transition-colors",children:"Review Issues"})]}),l("div",{className:"bg-white shadow-sm border-b border-gray-200",children:l("div",{className:"w-full px-4 sm:px-6 lg:px-8 xl:px-12 2xl:px-16 py-6",children:h("div",{className:"flex items-center justify-between",children:[h("div",{children:[h("div",{className:"flex items-center gap-3",children:[l("h1",{className:"text-3xl font-bold text-gray-900",children:"PC Assembly"}),P&&h("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:[l(Oi,{className:"w-4 h-4 mr-1"}),"Editing Build"]})]}),l("p",{className:"text-gray-600 mt-1",children:P?"Modify your existing build configuration":"Build your dream PC with confidence"})]}),l("div",{className:"flex items-center gap-4",children:h("button",{onClick:()=>b(!v),className:"flex items-center gap-2 px-4 py-2 bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors",children:[l(Jh,{className:"w-4 h-4"}),v?"Hide Tips":"Show Tips"]})})]})})}),S&&l("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-6 mb-4",children:l("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-xl p-4 shadow-sm",children:h("div",{className:"flex items-center justify-between",children:[h("div",{className:"flex items-center gap-3",children:[l("div",{className:"flex-shrink-0",children:l("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:l(At,{className:"w-5 h-5 text-green-600"})})}),h("div",{children:[l("h3",{className:"text-sm font-semibold text-green-900",children:"Components Restored"}),l("p",{className:"text-sm text-green-700",children:"Your previously selected components have been restored from your last session."})]})]}),l("button",{onClick:()=>_(!1),className:"flex-shrink-0 p-1 text-green-400 hover:text-green-600 hover:bg-green-100 rounded-full transition-colors duration-200","aria-label":"Dismiss notification",children:l(Yr,{className:"w-4 h-4"})})]})})}),l("div",{className:"w-full px-2 sm:px-4 lg:px-6 xl:px-8 2xl:px-12 py-4 sm:py-6 lg:py-8",children:h("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-4 sm:gap-6 lg:gap-8",children:[h("div",{className:"lg:col-span-8 xl:col-span-8 2xl:col-span-9 space-y-4 sm:space-y-6 lg:space-y-8",children:[Ct()>=3&&h("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 sm:p-6",children:[h("div",{className:"flex items-center gap-2 sm:gap-3 mb-4 sm:mb-6",children:[l(Qc,{className:"w-5 h-5 sm:w-6 sm:h-6 text-purple-600"}),l("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:"Performance Analysis"})]}),h("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[h("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-4",children:[h("div",{className:"flex items-center gap-2 mb-2",children:[l(Is,{className:"w-5 h-5 text-blue-600"}),l("span",{className:"font-medium text-blue-900",children:"Gaming"})]}),h("div",{className:"text-2xl font-bold text-blue-700",children:[Math.round(Gn.gamingScore),"%"]}),l("div",{className:"w-full bg-blue-200 rounded-full h-2 mt-2",children:l("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-500",style:{width:`${Gn.gamingScore}%`}})})]}),h("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-4",children:[h("div",{className:"flex items-center gap-2 mb-2",children:[l(db,{className:"w-5 h-5 text-purple-600"}),l("span",{className:"font-medium text-purple-900",children:"Workstation"})]}),h("div",{className:"text-2xl font-bold text-purple-700",children:[Math.round(Gn.workstationScore),"%"]}),l("div",{className:"w-full bg-purple-200 rounded-full h-2 mt-2",children:l("div",{className:"bg-purple-600 h-2 rounded-full transition-all duration-500",style:{width:`${Gn.workstationScore}%`}})})]}),h("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-4",children:[h("div",{className:"flex items-center gap-2 mb-2",children:[l(Rs,{className:"w-5 h-5 text-green-600"}),l("span",{className:"font-medium text-green-900",children:"Cooling"})]}),h("div",{className:"text-2xl font-bold text-green-700",children:[Math.round(Gn.coolingScore),"%"]}),l("div",{className:"w-full bg-green-200 rounded-full h-2 mt-2",children:l("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-500",style:{width:`${Gn.coolingScore}%`}})})]}),h("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 rounded-lg p-4",children:[h("div",{className:"flex items-center gap-2 mb-2",children:[l(Qi,{className:"w-5 h-5 text-orange-600"}),l("span",{className:"font-medium text-orange-900",children:"Upgrade Path"})]}),h("div",{className:"text-2xl font-bold text-orange-700",children:[Math.round(Gn.upgradeScore),"%"]}),l("div",{className:"w-full bg-orange-200 rounded-full h-2 mt-2",children:l("div",{className:"bg-orange-600 h-2 rounded-full transition-all duration-500",style:{width:`${Gn.upgradeScore}%`}})})]})]})]}),h("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[h("div",{className:"flex items-center justify-between mb-6",children:[h("div",{className:"flex items-center gap-3",children:[l("div",{className:"p-2 bg-green-100 rounded-lg",children:l(kd,{className:"w-5 h-5 text-green-600"})}),h("div",{children:[l("h2",{className:"text-xl font-semibold text-gray-900",children:"Build Progress"}),l("p",{className:"text-sm text-gray-600",children:"Track your component selection progress"})]})]}),h("div",{className:"flex items-center gap-4",children:[h("div",{className:"text-right",children:[h("div",{className:"text-2xl font-bold text-green-600",children:[Ct(),"/",Lt()]}),l("div",{className:"text-sm text-gray-600",children:"components selected"})]}),h("div",{className:"w-16 h-16 relative",children:[h("svg",{className:"w-16 h-16 transform -rotate-90",viewBox:"0 0 36 36",children:[l("path",{className:"text-gray-200",stroke:"currentColor",strokeWidth:"3",fill:"none",d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"}),l("path",{className:"text-green-600",stroke:"currentColor",strokeWidth:"3",fill:"none",strokeDasharray:`${Ct()/Lt()*100}, 100`,d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"})]}),l("div",{className:"absolute inset-0 flex items-center justify-center",children:h("span",{className:"text-sm font-semibold text-gray-700",children:[Math.round(Ct()/Lt()*100),"%"]})})]})]})]}),l("div",{className:"grid grid-cols-4 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 xl:grid-cols-8 2xl:grid-cols-8 gap-2 sm:gap-3 lg:gap-4",children:Ke.map((F,Z)=>{const ue=f[F.key],oe=Z+1===g,se=Z+1<g;F.key==="cpu"||F.key==="motherboard"||d0().has(F.key);const he=F.icon;return l("div",{className:`relative group cursor-pointer ${oe?"scale-105":""}`,onClick:()=>y(Z+1),children:h("div",{className:`
                        w-full aspect-square rounded-lg border-2 flex flex-col items-center justify-center p-2 transition-all duration-200
                        ${ue?"bg-green-50 border-green-500 text-green-700":oe?"bg-blue-50 border-blue-500 text-blue-700":se?"bg-gray-50 border-gray-300 text-gray-600":"bg-white border-gray-200 text-gray-400 hover:border-gray-300"}
                      `,children:[l(he,{className:`w-6 h-6 mb-1 ${ue?"text-green-600":oe?"text-blue-600":""}`}),l("span",{className:"text-xs font-medium text-center leading-tight",children:F.name}),ue&&l(At,{className:"w-4 h-4 text-green-600 absolute -top-1 -right-1"})]})},F.key)})})]}),v&&h("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl border border-blue-200 p-6",children:[h("div",{className:"flex items-center gap-3 mb-4",children:[l(Jh,{className:"w-6 h-6 text-blue-600"}),l("h3",{className:"text-lg font-semibold text-blue-900",children:"Building Tips"})]}),h("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-blue-800",children:[h("div",{className:"flex items-start gap-2",children:[l(HT,{className:"w-4 h-4 mt-0.5 text-blue-600 flex-shrink-0"}),l("span",{children:"Start with CPU and motherboard - they determine compatibility for other parts"})]}),h("div",{className:"flex items-start gap-2",children:[l(Ta,{className:"w-4 h-4 mt-0.5 text-blue-600 flex-shrink-0"}),l("span",{children:"Ensure your power supply has enough wattage for all components"})]}),h("div",{className:"flex items-start gap-2",children:[l(Qc,{className:"w-4 h-4 mt-0.5 text-blue-600 flex-shrink-0"}),l("span",{children:"Consider future upgrades when choosing motherboard and case"})]}),h("div",{className:"flex items-start gap-2",children:[l(Co,{className:"w-4 h-4 mt-0.5 text-blue-600 flex-shrink-0"}),l("span",{children:"Don't rush - take time to research and compare components"})]})]})]}),h("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[l("div",{className:"bg-gradient-to-r from-green-600 to-green-700 px-6 py-4",children:h("div",{className:"flex items-center gap-3",children:[(()=>{const Z=He().icon;return l(Z,{className:"w-6 h-6 text-white"})})(),h("div",{children:[h("h2",{className:"text-xl font-semibold text-white",children:["Select ",He().name]}),l("p",{className:"text-green-100 text-sm",children:He().description})]})]})}),h("div",{className:"p-4 sm:p-6 lg:p-8",children:[l("div",{className:"mb-8",children:l("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-200 p-4 sm:p-6 mb-4 sm:mb-6",children:h("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-3 sm:gap-4",children:[h("div",{className:"flex-1",children:[h("div",{className:"flex items-center gap-3 mb-3",children:[l("div",{className:"p-2 bg-blue-100 rounded-lg",children:l(Ta,{className:"w-5 h-5 text-blue-600"})}),h("div",{children:[l("h3",{className:"text-lg font-semibold text-gray-900",children:"Compatibility Score"}),l("p",{className:"text-sm text-gray-600",children:"Overall system compatibility rating"})]})]}),h("div",{className:"space-y-3",children:[h("div",{className:"flex items-center justify-between",children:[l("span",{className:"text-sm font-medium text-gray-700",children:"System Compatibility"}),h("span",{className:`text-lg font-bold ${fe($e)}`,children:[$e,"%"]})]}),h("div",{className:"relative",children:[l("div",{className:"w-full bg-gray-200 rounded-full h-4 overflow-hidden",children:l("div",{className:`h-4 rounded-full transition-all duration-1000 ease-out ${fe($e,!0)}`,style:{width:`${$e}%`}})}),h("div",{className:"flex justify-between mt-1 text-xs text-gray-500",children:[l("span",{children:"0%"}),l("span",{children:"25%"}),l("span",{children:"50%"}),l("span",{children:"75%"}),l("span",{children:"100%"})]})]}),l("div",{className:`p-3 rounded-lg border-l-4 ${De($e)}`,children:l("p",{className:`text-sm font-medium ${Ie($e)}`,children:Ye($e)})})]})]}),h("div",{className:"flex flex-col gap-4",children:[h("button",{onClick:()=>ze(!0),className:"flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium shadow-sm",children:[l(W8,{className:"w-4 h-4"}),"Compare Compatibility"]}),l("div",{className:"text-sm text-gray-700 text-center",children:Mu()}),h("div",{className:"bg-white rounded-lg border border-gray-200 p-3",children:[l("div",{className:"flex items-center gap-2 mb-2",children:l("span",{className:"text-sm font-medium text-gray-700",children:"Branch Filter:"})}),h("div",{className:"inline-flex rounded-lg border overflow-hidden shadow-sm",children:[l("button",{className:`px-4 py-2 text-sm font-medium transition-colors ${we===null?"bg-green-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,onClick:()=>pe(null),type:"button",children:"All Branches"}),l("button",{className:`px-4 py-2 text-sm font-medium border-l transition-colors ${we==="BULACAN"?"bg-green-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,onClick:()=>pe("BULACAN"),type:"button",children:"Bulacan"}),l("button",{className:`px-4 py-2 text-sm font-medium border-l transition-colors ${we==="MARIKINA"?"bg-green-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,onClick:()=>pe("MARIKINA"),type:"button",children:"Marikina"})]})]})]})]})})}),l(gL,{selectedComponents:f,onComponentSelect:Oe,onComponentRemove:at,activeCategory:He().key,prefetchedComponents:Ce,recommendations:Fe[He().key]||[],loadingRecommendations:Ge[He().key]||!1,compatibilityIssues:pt(He().key)||[],branch:we},`ecs-${A}-${He().key}`)]})]})]}),h("div",{className:"lg:col-span-4 xl:col-span-4 2xl:col-span-3 space-y-4 sm:space-y-6 lg:space-y-8",children:[l(xL,{compatibilityStatus:ce,compatibilityScore:xi(),compatibilityDetails:Le,selectionProgress:za()}),h("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-4 sm:p-6",children:[h("div",{className:"mb-4 sm:mb-6 lg:mb-8",children:[h("div",{className:"flex items-center justify-between mb-6",children:[h("div",{className:"flex items-center gap-4",children:[l("div",{className:"p-3 bg-gradient-to-br from-green-100 to-blue-100 rounded-xl",children:l(vs,{className:"w-7 h-7 text-green-600"})}),h("div",{children:[l("h3",{className:"text-2xl font-bold text-gray-900",children:"Build Summary"}),l("p",{className:"text-gray-600",children:"Track your PC build progress and components"})]})]}),h("div",{className:"text-right",children:[h("div",{className:"text-3xl font-bold text-green-600",children:[Math.round(Ct()/Lt()*100),"%"]}),l("div",{className:"text-sm text-gray-600",children:"Complete"})]})]}),h("div",{className:"bg-gradient-to-r from-gray-50 to-blue-50 rounded-xl p-3 sm:p-4 mb-4 sm:mb-6",children:[h("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-0 mb-2 sm:mb-3",children:[l("span",{className:"text-xs sm:text-sm font-semibold text-gray-700",children:"Build Progress"}),h("span",{className:"text-xs sm:text-sm font-bold text-gray-900",children:[Ct(),"/",Lt()," Components"]})]}),l("div",{className:"w-full bg-gray-200 rounded-full h-4 mb-3",children:l("div",{className:"bg-gradient-to-r from-green-500 to-green-600 h-4 rounded-full transition-all duration-700 shadow-sm",style:{width:`${Ct()/Lt()*100}%`}})}),l("div",{className:`p-3 rounded-lg border-l-4 ${Ct()===0?"bg-blue-50 border-blue-400":Ct()===Lt()?"bg-green-50 border-green-400":"bg-yellow-50 border-yellow-400"}`,children:l("p",{className:`text-sm font-medium ${Ct()===0?"text-blue-800":Ct()===Lt()?"text-green-800":"text-yellow-800"}`,children:Ct()===0?"Start building by selecting components from the categories above":Ct()===Lt()?"Build complete! Ready for final review and ordering":`${Lt()-Ct()} more components needed to complete your build`})})]})]}),h("div",{className:"mb-6 sm:mb-8",children:[h("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[l("h4",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Selected Components"}),h("span",{className:"text-xs sm:text-sm text-gray-500",children:[Ko()," items"]})]}),h("div",{className:"space-y-2 sm:space-y-3 max-h-64 sm:max-h-80 overflow-y-auto pr-1 sm:pr-2",children:[Object.entries(f).map(([F,Z])=>Z&&l("div",{className:"group bg-gradient-to-r from-gray-50 to-blue-50 rounded-xl border border-gray-200 p-3 sm:p-4 hover:shadow-md transition-all duration-200",children:h("div",{className:"flex items-center justify-between",children:[h("div",{className:"flex items-center gap-2 sm:gap-3 lg:gap-4 flex-1 min-w-0",children:[l("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-br from-green-100 to-blue-100 rounded-xl flex items-center justify-center flex-shrink-0",children:l("span",{className:"text-xs sm:text-sm font-bold text-green-600",children:F==="motherboard"?"MB":F==="gpu"?"GPU":F==="storage"?"SSD":F==="psu"?"PSU":F==="cooler"?"FAN":F.toUpperCase()})}),h("div",{className:"flex-1 min-w-0",children:[l("h5",{className:"font-semibold text-gray-900 text-xs sm:text-sm mb-1 truncate",children:Z.name}),h("div",{className:"flex items-center gap-2 sm:gap-3 text-xs text-gray-600",children:[l("span",{className:"font-bold text-green-600 text-xs sm:text-sm",children:it(Z.price)}),l("span",{className:"w-1 h-1 bg-gray-400 rounded-full"}),h("span",{className:"truncate",children:[Z.socket&&`Socket: ${Z.socket}`,Z.memory&&`Memory: ${Z.memory}`,Z.type&&Z.speed&&`${Z.type} ${Z.speed}`,Z.capacity&&`Capacity: ${Z.capacity}`,Z.wattage&&`${Z.wattage}W`,Z.size&&`Size: ${Z.size}`]})]})]})]}),h("div",{className:"flex items-center gap-2 flex-shrink-0",children:[l("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),l("button",{onClick:()=>at(F),className:"p-2 text-red-400 hover:text-red-600 rounded-lg hover:bg-red-50 transition-all duration-200 opacity-0 group-hover:opacity-100",title:"Remove component",children:l(Hr,{className:"w-4 h-4"})})]})]})},F)),Ko()===0&&h("div",{className:"text-center py-12 bg-gradient-to-br from-gray-50 to-blue-50 rounded-xl border-2 border-dashed border-gray-300",children:[l("div",{className:"p-4 bg-white rounded-full w-20 h-20 mx-auto mb-4 flex items-center justify-center",children:l(nt,{className:"w-10 h-10 text-gray-400"})}),l("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Components Selected"}),l("p",{className:"text-gray-600 mb-4",children:"Start building by selecting components from the categories above"}),h("div",{className:"flex items-center justify-center gap-2 text-sm text-blue-600",children:[l(Qi,{className:"w-4 h-4"}),l("span",{children:"Choose your first component to begin"})]})]})]})]}),h("div",{className:"bg-gradient-to-r from-gray-50 to-green-50 rounded-xl p-4 sm:p-6 border border-gray-200",children:[h("div",{className:"flex items-center gap-2 sm:gap-3 mb-4 sm:mb-6",children:[l("div",{className:"p-2 bg-green-100 rounded-lg",children:l("span",{className:"text-green-600 text-lg font-bold",children:"â‚±"})}),l("h4",{className:"text-lg font-semibold text-gray-900",children:"Price Summary"})]}),h("div",{className:"space-y-4 mb-6",children:[h("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200",children:[l("span",{className:"text-gray-600 font-medium",children:"Subtotal:"}),l("span",{className:"text-lg font-semibold text-gray-900",children:it(Nr())})]}),h("div",{className:"flex items-center justify-between p-4 bg-gradient-to-r from-green-50 to-blue-50 rounded-lg border-2 border-green-200",children:[h("div",{className:"flex items-center gap-3",children:[l("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:l("span",{className:"text-green-600 font-bold",children:"â‚±"})}),l("span",{className:"text-lg font-semibold text-gray-900",children:"Total Price:"})]}),l("span",{className:"text-3xl font-bold text-green-600",children:it(Nr())})]})]}),h("div",{className:"space-y-4",children:[h("div",{className:"grid grid-cols-1 gap-3",children:[h("button",{onClick:()=>k(!0),className:`flex items-center justify-center gap-3 px-6 py-4 rounded-xl font-semibold text-lg transition-all duration-200 ${a?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg hover:shadow-xl hover:from-blue-700 hover:to-blue-800 transform hover:scale-105":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,disabled:!a,title:a?"":"Please log in to save builds",children:[l(yh,{className:"w-5 h-5"}),P?o?"Update Prebuilt":"Update Build":o?"Save Prebuilt":"Save Build",!a&&l("span",{className:"text-sm ml-2 opacity-75",children:"(Login Required)"})]}),!c&&l("button",{onClick:ye,className:`flex items-center justify-center gap-3 px-6 py-4 rounded-xl font-semibold text-lg transition-all duration-200 ${Ct()===Lt()?xi()===100?"bg-gradient-to-r from-green-600 to-green-700 text-white shadow-lg hover:shadow-xl hover:from-green-700 hover:to-green-800 transform hover:scale-105":"bg-gradient-to-r from-orange-500 to-red-500 text-white shadow-lg hover:shadow-xl hover:from-orange-600 hover:to-red-600":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,disabled:Ct()<Lt(),children:D?h("div",{className:"flex items-center justify-center gap-3",children:[l("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),l("span",{children:"Placing order..."})]}):Ct()===Lt()?xi()===100?h("div",{className:"flex items-center justify-center gap-3",children:[l(vs,{className:"w-5 h-5"}),l("span",{children:"Buy PC Build!"})]}):h("div",{className:"flex items-center justify-center gap-3",children:[l(Fn,{className:"w-5 h-5"}),l("span",{children:"Buy PC Build"})]}):`Select ${Lt()-Ct()} more components`}),!c&&l("button",{onClick:ae,className:`flex items-center justify-center gap-3 px-6 py-4 rounded-xl font-semibold text-lg transition-all duration-200 ${Ct()===Lt()&&a?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg hover:shadow-xl hover:from-blue-700 hover:to-blue-800 transform hover:scale-105":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,disabled:Ct()<Lt()||!a||Q,title:a?"":"Please log in to add items to cart",children:Q?h("div",{className:"flex items-center justify-center gap-3",children:[l("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),l("span",{children:"Adding to cart..."})]}):Ct()===Lt()?h("div",{className:"flex items-center justify-center gap-3",children:[l(nt,{className:"w-5 h-5"}),l("span",{children:"Add to Cart"})]}):`Select ${Lt()-Ct()} more components`})]}),l("div",{className:"pt-2 border-t border-gray-200",children:h("button",{onClick:Gr,className:"w-full flex items-center justify-center gap-3 px-6 py-3 rounded-xl font-semibold text-lg bg-red-50 text-red-600 border border-red-200 hover:bg-red-100 hover:border-red-300 transition-all duration-200",children:[l(Hr,{className:"w-5 h-5"}),"Clear All Components"]})})]}),Ct()===Lt()&&l("div",{className:"text-center text-sm mt-4 p-3 rounded-lg",children:xi()===100?h("div",{className:"text-green-600 bg-green-50",children:[l("p",{className:"font-medium",children:"Ready to proceed with your build!"}),!f.cooler&&l("p",{className:"text-yellow-600 mt-1 text-xs",children:"Consider adding an aftermarket cooler for better performance"})]}):h("div",{className:"text-orange-600 bg-orange-50",children:[l("p",{className:"font-medium",children:"Build ready with compatibility warnings"}),l("p",{className:"text-xs mt-1",children:"Your build can be completed, but consider reviewing the warnings above for optimal performance"}),!f.cooler&&l("p",{className:"text-yellow-600 mt-1 text-xs",children:"Consider adding an aftermarket cooler for better performance"})]})})]})]})]})]})}),w&&l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h("div",{className:"bg-white rounded-xl max-w-2xl w-full shadow-2xl max-h-[90vh] overflow-y-auto",children:[l("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-xl",children:h("div",{className:"flex items-center justify-between",children:[h("div",{className:"flex items-center gap-3",children:[l("div",{className:"w-12 h-12 bg-gradient-to-br from-green-500 to-blue-600 rounded-full flex items-center justify-center",children:l(yh,{className:"w-6 h-6 text-white"})}),h("div",{children:[l("h2",{className:"text-2xl font-bold text-gray-900",children:P?"Update Your Build":"Save Your Build"}),l("p",{className:"text-sm text-gray-600",children:"Save your PC configuration for future reference"})]})]}),l("button",{onClick:()=>k(!1),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors",children:l(Yr,{className:"w-6 h-6"})})]})}),l("div",{className:"p-6",children:h("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[h("div",{className:"space-y-6",children:[h("div",{children:[l("label",{htmlFor:"build-name",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Build Name *"}),l("input",{id:"build-name",type:"text",value:W,onChange:F=>ie(F.target.value),placeholder:"e.g., Gaming Beast Pro, Workstation Build",className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors ${W.trim()===""?"border-red-300 focus:ring-red-500":"border-gray-300"}`,maxLength:50}),h("p",{className:`text-xs mt-2 ${W.trim()===""?"text-red-500":"text-gray-500"}`,children:[W.length,"/50 characters ",W.trim()===""&&"(Required)"]})]}),h("div",{children:[l("label",{htmlFor:"build-description",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Description (Optional)"}),l("textarea",{id:"build-description",value:B,onChange:F=>ee(F.target.value),placeholder:"Describe your build, intended use, or any special features...",rows:"4",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none transition-colors",maxLength:200}),h("p",{className:"text-xs text-gray-500 mt-2",children:[B.length,"/200 characters"]})]}),l("div",{className:"bg-gray-50 rounded-xl p-4",style:{display:o?"none":void 0},children:h("div",{className:"flex items-center justify-between mb-3",children:[h("div",{children:[l("h3",{className:"text-sm font-semibold text-gray-900",children:"Build Visibility"}),l("p",{className:"text-xs text-gray-600 mt-1",children:"Your build will be visible to other users in the PC Build Sharing section. You can change this later."})]}),h("div",{className:"flex items-center gap-3",children:[l("span",{className:`text-sm font-medium ${le?"text-green-600":"text-gray-500"}`,children:le?"Public":"Private"}),l("button",{type:"button",onClick:()=>R(!le),className:`relative inline-flex h-7 w-12 items-center rounded-full transition-colors duration-200 ${le?"bg-green-600":"bg-gray-300"}`,children:l("span",{className:`inline-block h-5 w-5 transform rounded-full bg-white shadow-md transition-transform duration-200 ${le?"translate-x-6":"translate-x-1"}`})})]})]})})]}),h("div",{className:"space-y-6",children:[h("div",{className:"bg-gradient-to-br from-green-50 to-blue-50 rounded-xl p-6 border border-green-200",children:[h("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[l(nt,{className:"w-5 h-5 text-green-600"}),"Build Summary"]}),h("div",{className:"space-y-4",children:[h("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200",children:[h("div",{className:"flex items-center gap-3",children:[l("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:l(nt,{className:"w-4 h-4 text-blue-600"})}),l("span",{className:"text-sm font-medium text-gray-700",children:"Components"})]}),h("span",{className:"text-lg font-bold text-blue-600",children:[Ct(),"/",Lt()]})]}),h("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200",children:[h("div",{className:"flex items-center gap-3",children:[l("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:l(At,{className:"w-4 h-4 text-green-600"})}),l("span",{className:"text-sm font-medium text-gray-700",children:"Compatibility"})]}),h("span",{className:"text-lg font-bold text-green-600",children:[xi(),"%"]})]}),h("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200",children:[h("div",{className:"flex items-center gap-3",children:[l("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center",children:l("span",{className:"text-lg font-bold text-purple-600",children:"â‚±"})}),l("span",{className:"text-sm font-medium text-gray-700",children:"Total Price"})]}),l("span",{className:"text-lg font-bold text-purple-600",children:Nr().toLocaleString()})]})]})]}),xi()<100&&h("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4",children:[h("div",{className:"flex items-center gap-2 mb-2",children:[l(Fn,{className:"w-5 h-5 text-yellow-600"}),l("span",{className:"text-sm font-semibold text-yellow-800",children:"Compatibility Notice"})]}),l("p",{className:"text-xs text-yellow-700",children:"Your build has some compatibility warnings. Consider reviewing the compatibility checker for optimal performance."})]}),h("div",{className:"space-y-3",children:[l("button",{onClick:be,disabled:!W.trim()||Sn||j,className:`w-full flex items-center justify-center gap-3 px-6 py-4 rounded-xl font-semibold text-white text-lg transition-all duration-200 shadow-lg ${!W.trim()||Sn?"bg-gray-400 cursor-not-allowed":"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 hover:shadow-xl transform hover:scale-[1.02]"}`,title:W.trim()?Sn?"Cannot save build due to compatibility issues":"Save your build":"Please enter a build name",children:j?h(gt,{children:[l("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),l("span",{children:"Saving..."})]}):h(gt,{children:[l(yh,{className:"w-5 h-5"}),l("span",{children:P?"Update Build":"Save Build"})]})}),l("button",{onClick:()=>k(!1),className:"w-full px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-xl font-medium hover:bg-gray-50 transition-colors",children:"Cancel"})]})]})]})})]})}),H&&l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-y-auto",children:h("div",{className:"bg-white rounded-xl max-w-4xl w-full shadow-2xl my-8 max-h-[90vh] overflow-y-auto",children:[l("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-xl z-10",children:h("div",{className:"flex items-center justify-between",children:[h("div",{className:"flex items-center gap-3",children:[l("div",{className:"w-12 h-12 bg-gradient-to-br from-green-500 to-green-600 rounded-full flex items-center justify-center",children:l(vs,{className:"w-6 h-6 text-white"})}),h("div",{children:[l("h2",{className:"text-2xl font-bold text-gray-900",children:"Review Your Build"}),l("p",{className:"text-sm text-gray-600",children:"Please review your components before placing the order"})]})]}),l("button",{onClick:()=>L(!1),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:l(Yr,{className:"w-5 h-5 text-gray-500"})})]})}),h("div",{className:"p-6",children:[l("div",{className:"space-y-4",children:Ke.filter(F=>{const Z=f[F.key];return Z!=null}).map(F=>{const Z=f[F.key];if(!Z)return null;const ue=F.name,oe=F.icon,se=typeof Z.price=="string"?parseFloat(Z.price):Z.price||0;return l("div",{className:"bg-white border-2 border-gray-200 rounded-lg p-4 hover:border-gray-300 transition-colors",children:h("div",{className:"flex items-start gap-4",children:[h("div",{className:"w-24 h-24 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0",children:[l("img",{src:xr(Z,xt(Z)),alt:Z.name||"Component",className:"w-full h-full object-cover rounded-lg",onError:he=>{he.target.style.display="none",he.target.nextSibling&&(he.target.nextSibling.style.display="flex")}}),l("div",{className:"hidden w-full h-full items-center justify-center text-gray-400",children:l(oe,{className:"w-10 h-10"})})]}),l("div",{className:"flex-1 min-w-0",children:l("div",{className:"flex items-start justify-between gap-4",children:h("div",{className:"flex-1",children:[h("div",{className:"flex items-center gap-2 mb-1",children:[l(oe,{className:"w-4 h-4 text-gray-500"}),l("span",{className:"text-sm font-medium text-gray-500 uppercase",children:ue})]}),l("h3",{className:"font-semibold text-gray-900 text-lg mb-1",children:Z.name}),Z.brand&&l("p",{className:"text-sm text-gray-600 mb-2",children:Z.brand}),l("div",{className:"flex items-center",children:l("span",{className:"text-xl font-bold text-green-600",children:it(se)})})]})})})]})},F.key)})}),h("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[l("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Price Breakdown"}),l("div",{className:"space-y-3 mb-4",children:Ke.filter(F=>{const Z=f[F.key];return Z!=null}).map(F=>{const Z=f[F.key];if(!Z)return null;const ue=typeof Z.price=="string"?parseFloat(Z.price):Z.price||0;return h("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200",children:[h("div",{className:"flex-1 min-w-0",children:[l("span",{className:"text-sm font-medium text-gray-900",children:Z.name}),h("span",{className:"text-xs text-gray-500 ml-2",children:["(",F.name,")"]})]}),l("span",{className:"text-base font-semibold text-gray-900 ml-4 flex-shrink-0",children:it(ue)})]},F.key)})}),h("div",{className:"space-y-3 pt-3 border-t border-gray-200",children:[h("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-gray-200",children:[l("span",{className:"text-gray-600 font-medium",children:"Subtotal:"}),l("span",{className:"text-lg font-semibold text-gray-900",children:it(Nr())})]}),h("div",{className:"flex items-center justify-between p-4 bg-gradient-to-r from-green-50 to-blue-50 rounded-lg border-2 border-green-200",children:[h("div",{className:"flex items-center gap-3",children:[l("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:l("span",{className:"text-green-600 font-bold",children:"â‚±"})}),l("span",{className:"text-lg font-semibold text-gray-900",children:"Total Price:"})]}),l("span",{className:"text-3xl font-bold text-green-600",children:it(Nr())})]})]})]})]}),l("div",{className:"sticky bottom-0 bg-white border-t border-gray-200 p-6 rounded-b-xl",children:h("div",{className:"flex items-center justify-end gap-3",children:[l("button",{onClick:()=>L(!1),className:"px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-xl font-medium hover:bg-gray-50 transition-colors",disabled:D,children:"Cancel"}),l("button",{onClick:Ee,disabled:D,className:"px-6 py-3 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-xl font-semibold hover:from-green-700 hover:to-green-800 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center gap-2",children:D?h(gt,{children:[l("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),l("span",{children:"Placing Order..."})]}):h(gt,{children:[l(vs,{className:"w-5 h-5"}),l("span",{children:"Confirm Purchase"})]})})]})})]})}),z&&l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h("div",{className:"bg-white rounded-xl max-w-md w-full shadow-2xl",children:[l("div",{className:"p-6 border-b border-gray-200",children:l("h2",{className:"text-xl font-semibold text-gray-900",children:"Order Placed Successfully"})}),h("div",{className:"p-6 space-y-3",children:[l("p",{className:"text-sm text-gray-700",children:"Your PC build has been recorded as a sales order."}),h("div",{className:"flex items-center justify-between text-sm",children:[l("span",{className:"text-gray-600",children:"Order ID:"}),h("span",{className:"font-semibold text-gray-900",children:["#",z.order_id]})]}),h("div",{className:"flex items-center justify-between text-sm",children:[l("span",{className:"text-gray-600",children:"Order Total:"}),h("span",{className:"font-semibold text-green-700",children:["â‚±",Number(z.total||0).toLocaleString()]})]})]}),l("div",{className:"p-6 pt-0 flex items-center justify-end gap-3",children:l("button",{onClick:()=>{X(null);try{Gr()}catch{}},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Done"})})]})}),C&&l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h("div",{className:"bg-white rounded-xl max-w-md w-full shadow-2xl",children:[h("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[h("div",{className:"flex items-center gap-3",children:[l("div",{className:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center",children:l(Ta,{className:"w-5 h-5 text-orange-600"})}),l("h2",{className:"text-xl font-semibold text-gray-900",children:"Login Required"})]}),l("button",{onClick:()=>E(!1),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:l(Yr,{className:"w-5 h-5"})})]}),h("div",{className:"p-6",children:[h("div",{className:"text-center mb-6",children:[l("div",{className:"w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l(Ta,{className:"w-8 h-8 text-orange-600"})}),l("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Save Your Build"}),l("p",{className:"text-gray-600",children:"You need to be logged in to save your PC build configuration. This will allow you to access your builds later and share them with others."})]}),h("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[l("h4",{className:"font-medium text-gray-900 mb-3",children:"Your Build Preview"}),h("div",{className:"space-y-2 text-sm",children:[h("div",{className:"flex justify-between",children:[l("span",{className:"text-gray-600",children:"Components:"}),h("span",{className:"font-medium",children:[Ct(),"/",Lt()," selected"]})]}),h("div",{className:"flex justify-between",children:[l("span",{className:"text-gray-600",children:"Compatibility:"}),h("span",{className:"font-medium text-green-600",children:[xi(),"%"]})]}),h("div",{className:"flex justify-between",children:[l("span",{className:"text-gray-600",children:"Total Price:"}),h("span",{className:"font-medium text-green-600",children:["â‚±",Nr().toLocaleString()]})]})]})]}),h("div",{className:"flex flex-col gap-3",children:[h("button",{onClick:()=>{E(!1),i("login")},className:"w-full px-4 py-3 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 transition-colors flex items-center justify-center gap-2",children:[l(K8,{className:"w-5 h-5"}),"Login to Save Build"]}),h("button",{onClick:()=>{E(!1),i("register")},className:"w-full px-4 py-3 border-2 border-gray-300 text-gray-700 rounded-lg font-semibold hover:bg-gray-50 transition-colors flex items-center justify-center gap-2",children:[l(sl,{className:"w-5 h-5"}),"Create Account"]}),l("button",{onClick:()=>E(!1),className:"w-full px-4 py-2 text-gray-500 hover:text-gray-700 transition-colors",children:"Continue building without saving"})]})]})]})}),l(NL,{isOpen:je,onClose:()=>ze(!1),selectedComponents:f,currentCategory:He().key,allComponents:Ce,onComponentSelect:Oe})]}):l("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center",children:h("div",{className:"text-center",children:[l("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-green-600 mx-auto mb-4"}),l("h3",{className:"text-xl font-medium text-gray-900 mb-2",children:"Loading PC Assembly..."}),l("p",{className:"text-gray-600",children:"Please wait while we load your components."})]})})},w3=e=>h("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:[l("div",{className:"bg-white shadow-sm border-b border-gray-200 mb-4 sm:mb-6",children:l("div",{className:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4",children:h("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4",children:[h("div",{className:"flex items-center gap-2 sm:gap-3",children:[l("div",{className:"p-1.5 sm:p-2 bg-purple-100 rounded-lg",children:l(Ta,{className:"w-5 h-5 sm:w-6 sm:h-6 text-purple-600"})}),h("div",{children:[l("h1",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900",children:"PC Assembly - Admin"}),l("p",{className:"text-xs sm:text-sm text-gray-600",children:"PC building interface with administrative access"})]})]}),l("div",{className:"flex items-center gap-2",children:l("div",{className:"px-2 sm:px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-xs sm:text-sm font-medium",children:"Admin Access"})})]})})}),l("div",{className:"px-2 sm:px-4 lg:px-6 pb-4 sm:pb-6 lg:pb-8",children:l(eu,{...e,saveToPrebuilts:!0,hideCompleteButton:!0})})]}),ej=e=>h("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:[l("div",{className:"bg-white shadow-sm border-b border-gray-200 mb-4 sm:mb-6",children:l("div",{className:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4",children:h("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4",children:[h("div",{className:"flex items-center gap-2 sm:gap-3",children:[l("div",{className:"p-1.5 sm:p-2 bg-blue-100 rounded-lg",children:l(Ta,{className:"w-5 h-5 sm:w-6 sm:h-6 text-blue-600"})}),h("div",{children:[l("h1",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900",children:"PC Assembly - Employee"}),l("p",{className:"text-xs sm:text-sm text-gray-600",children:"Create prebuilts directly"})]})]}),l("div",{className:"flex items-center gap-2",children:l("div",{className:"px-2 sm:px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs sm:text-sm font-medium",children:"Employee Access"})})]})})}),l("div",{className:"px-2 sm:px-4 lg:px-6 pb-4 sm:pb-6 lg:pb-8",children:l(eu,{...e,saveToPrebuilts:!0,hideCompleteButton:!0})})]}),N3=e=>h("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:[l("div",{className:"bg-white shadow-sm border-b border-gray-200 mb-4 sm:mb-6",children:l("div",{className:"px-3 sm:px-4 lg:px-6 py-3 sm:py-4",children:h("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4",children:[h("div",{className:"flex items-center gap-2 sm:gap-3",children:[l("div",{className:"p-1.5 sm:p-2 bg-red-100 rounded-lg",children:l(Ta,{className:"w-5 h-5 sm:w-6 sm:h-6 text-red-600"})}),h("div",{children:[l("h1",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900",children:"PC Assembly - Super Admin"}),l("p",{className:"text-xs sm:text-sm text-gray-600",children:"Create prebuilts directly"})]})]}),l("div",{className:"flex items-center gap-2",children:l("div",{className:"px-2 sm:px-3 py-1 bg-red-100 text-red-800 rounded-full text-xs sm:text-sm font-medium",children:"Super Admin Access"})})]})})}),l("div",{className:"px-2 sm:px-4 lg:px-6 pb-4 sm:pb-6 lg:pb-8",children:l(eu,{...e,saveToPrebuilts:!0,hideCompleteButton:!0})})]}),qu=`${ke}/chat.php`,Xu=()=>{const e=localStorage.getItem("token");return e?{Authorization:`Bearer ${e}`}:{}},tj=({user:e,customStyles:t={},hideHeader:r=!1})=>{const[n,a]=N.useState(()=>{const ee=localStorage.getItem("builditpc_chat_session_id");if(ee&&ee!=="null"&&ee!=="0"){const le=parseInt(ee,10);return isNaN(le)?null:le}return null}),[i,s]=N.useState(()=>localStorage.getItem("builditpc_guest_name")||""),[o,c]=N.useState([]),[u,d]=N.useState(""),[f,m]=N.useState(!1),[p,x]=N.useState(null),[g,y]=N.useState("open"),v=N.useRef(null),b=N.useRef(null),[w,k]=N.useState(""),[S,_]=N.useState(0),[C,E]=N.useState(!1),A=N.useRef(null),[T,D]=N.useState(!0),I=[{title:"BuildIt PC System",items:["How do I use the BuildIt PC compatibility checker?","How are prebuilt PC prices calculated in your system?","Where can I see current stock availability for parts?","Can I get notified when an out-of-stock part is available?","How do I contact support about an issue with my account?"]},{title:"Account & Orders",items:["How can I reset or change my password?","How do I track my order status on your site?","Can I cancel an order before it is processed?","How do I update my shipping address on an existing order?","How do I view my past orders and invoices?"]},{title:"Shop Information",items:["Where is the BuildIt PC shop located?","What is the contact number for the shop?","Where can I view prices for each product?","What services does your shop offer?"]},{title:"PC Building (General)",items:["What CPU and GPU do you recommend for 1080p gaming?","How much wattage should my power supply have for my build?","What RAM speed and capacity do you recommend for gaming?","How do I choose a compatible motherboard for my CPU?","Should I pick an SSD or HDD for my primary drive?"]}],z=async()=>{if(!(!(e!=null&&e.id)||!n))try{await fetch(`${qu}?update_last_seen`,{method:"POST",headers:{"Content-Type":"application/json",...Xu()},body:JSON.stringify({user_id:e.id,session_id:n})})}catch(ee){console.error("Error updating last seen:",ee)}};N.useEffect(()=>{if(!n)return;z();const ee=async()=>{try{const R=`${qu}?messages&session_id=${n}${e?`&user_id=${e.id}`:i?`&guest_name=${encodeURIComponent(i)}`:""}`,V=await(await fetch(R,{headers:Xu()})).json();V.success&&c(V.messages||[])}catch(R){console.error("Error fetching messages:",R)}};ee();const le=setInterval(ee,2e3);return()=>clearInterval(le)},[n,e]),N.useEffect(()=>{var ee;T&&((ee=v.current)==null||ee.scrollIntoView({behavior:"smooth"}))},[o,T]),N.useEffect(()=>{i&&localStorage.setItem("builditpc_guest_name",i)},[i]);const X=async ee=>{m(!0),x(null);try{const R=await(await fetch(`${qu}?send`,{method:"POST",headers:{"Content-Type":"application/json",...Xu()},body:JSON.stringify({session_id:null,sender:"user",message:ee??u,guest_name:e?void 0:i,guest_email:null,user_id:e?e.id:void 0})})).json();if(R.error)throw new Error(R.error);if(R.session_id){const j=parseInt(R.session_id,10);!isNaN(j)&&j>0&&(a(j),localStorage.setItem("builditpc_chat_session_id",j.toString()),y("open"))}d(""),D(!0)}catch(le){x("Failed to start chat session: "+le.message)}m(!1)},H=async ee=>{const le=(ee??u).trim();if(le){m(!0),x(null);try{if(!n){await X(le);return}const j=await(await fetch(`${qu}?send`,{method:"POST",headers:{"Content-Type":"application/json",...Xu()},body:JSON.stringify({session_id:n&&n>0?n:null,sender:"user",message:le,user_id:e?e.id:void 0,guest_name:e?void 0:i})})).json();if(j.error)throw new Error(j.error);d(""),D(!0)}catch(R){x("Failed to send message: "+R.message)}m(!1)}},L=ee=>{f||g==="resolved"||(E(!1),H(ee))};N.useEffect(()=>{C&&A.current&&(A.current.scrollTop=0)},[C]);const W=async()=>{if(window.confirm("Are you sure you want to clear this conversation? This cannot be undone."))try{await fetch(`${qu}?delete_session`,{method:"POST",headers:{"Content-Type":"application/json",...Xu()},body:JSON.stringify({session_id:n})}),a(null),localStorage.removeItem("builditpc_chat_session_id"),c([]),_(0),y("open")}catch{x("Failed to clear conversation")}},ie=()=>{if(!b.current)return;const ee=b.current,le=64,R=ee.scrollHeight-ee.scrollTop-ee.clientHeight<=le;D(R)};if(!e&&!i){const ee=()=>{w.trim()&&s(w.trim())};return l("div",{className:"flex flex-col items-center h-full max-h-[600px] py-4 px-6",children:h("div",{className:"bg-white rounded-lg w-full max-w-md",children:[h("div",{className:"text-center mb-6",children:[l(ca,{className:"w-10 h-10 text-green-600 mx-auto mb-2"}),l("h2",{className:"text-xl font-bold text-gray-800 mb-1",children:"Start Chat Support"}),l("p",{className:"text-sm text-gray-600",children:"Get help from our expert team"})]}),h("div",{className:"space-y-4 px-6",children:[h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Your Name *"}),l("input",{type:"text",className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent text-sm",placeholder:"Enter your name",value:w,onChange:le=>k(le.target.value),onKeyDown:le=>{le.key==="Enter"&&ee()}})]}),l("div",{className:"pb-4",children:l("button",{className:"w-full bg-green-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm",onClick:ee,disabled:!w.trim(),children:"Start Chat"})})]})]})})}return h("div",{className:"flex flex-col h-full bg-white",children:[l("style",{children:`
    /* Common scrollbar styles */
    .custom-scrollbar::-webkit-scrollbar {
      width: 10px;
      height: 10px;
    }
    .custom-scrollbar::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 6px;
    }
    .custom-scrollbar::-webkit-scrollbar-thumb {
      background: #c1c1c1;
      border-radius: 6px;
      border: 2px solid #f1f1f1;
    }
    .custom-scrollbar::-webkit-scrollbar-thumb:hover {
      background: #a8a8a8;
    }
    
    /* Firefox */
    .custom-scrollbar {
      scrollbar-width: thin;
      scrollbar-color: #c1c1c1 #f1f1f1;
    }
    
    /* Ensure smooth scrolling on all devices */
    .custom-scrollbar {
      -webkit-overflow-scrolling: touch;
      -ms-overflow-style: -ms-autohiding-scrollbar;
      overflow-y: auto;
    }
    
    /* Messages area specific styles */
    .messages-area::-webkit-scrollbar-thumb {
      background: #c1c1c1;
      border: 2px solid #ffffff;
    }
    
    /* For smaller screens */
    @media (max-width: 640px) {
      .custom-scrollbar::-webkit-scrollbar {
        width: 6px;
        height: 6px;
      }
    }
  `}),!r&&l("div",{className:"border-b border-gray-200 bg-white p-3 flex justify-end",children:n&&h("button",{onClick:W,className:"flex items-center gap-1 text-red-600 hover:text-red-700 text-sm font-medium px-3 py-1.5 rounded-md hover:bg-red-50 transition-colors",title:"Clear Conversation",children:[l(Hr,{className:"w-4 h-4"}),"Clear Chat"]})}),h("div",{className:"flex-grow relative flex flex-col",children:[l("div",{ref:b,className:"flex-grow overflow-y-auto custom-scrollbar messages-area",style:{maxHeight:"calc(100vh - 250px)",WebkitOverflowScrolling:"touch"},onScroll:ie,children:h("div",{className:"p-6 space-y-4",children:[o.length===0?h("div",{className:"flex flex-col items-center justify-start min-h-[250px] pt-8",children:[l("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Welcome to BuildIT PC Support"}),l("p",{className:"text-sm text-gray-600 text-center max-w-sm mb-6",children:"Our support team is here to help! Type your message below."}),l("div",{className:"w-full max-w-3xl"})]}):o.map((ee,le)=>l("div",{className:`flex items-start gap-2 ${ee.sender==="user"?"justify-end":"justify-start"}`,children:h("div",{className:`group relative rounded-lg px-4 py-3 max-w-[80%] shadow-sm ${ee.sender==="user"?"bg-green-600 text-white":"bg-gray-100 text-gray-800"}`,children:[l("div",{className:"text-sm whitespace-pre-wrap",children:ee.message||""}),l("div",{className:`text-xs mt-1 ${ee.sender==="user"?"text-green-100":"text-gray-500"}`,children:new Date(ee.sent_at).toLocaleTimeString()})]})},ee.id||le)),l("div",{ref:v})]})}),C&&h("div",{className:"absolute inset-0 bg-white z-20 flex flex-col",children:[l("div",{className:"px-6 py-4 border-b border-gray-200",children:l("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"Quick questions"})}),l("div",{ref:A,className:"flex-1 overflow-y-auto px-6 py-4 space-y-4 custom-scrollbar",children:I.map(ee=>h("div",{children:[l("div",{className:"text-xs font-semibold text-gray-500 mb-2",children:ee.title}),l("div",{className:"flex flex-wrap gap-2",children:ee.items.map(le=>l("button",{onClick:()=>L(le),className:"text-xs md:text-sm px-3 py-2 rounded-full border border-gray-300 hover:border-green-500 hover:text-green-700 hover:bg-green-50 transition-colors",children:le},le))})]},ee.title))})]})]}),h("div",{className:"mt-auto border-t bg-white",children:[p&&l("div",{className:"bg-red-50 border border-red-200 text-red-700 p-4 text-center text-sm",children:p}),l("div",{className:"px-4 pt-3",children:h("div",{className:"flex items-center justify-between",children:[l("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"Quick questions"}),l("button",{type:"button",onClick:()=>E(ee=>!ee),className:"text-xs font-medium text-green-600 hover:text-green-700 transition-colors",disabled:f||g==="resolved","aria-expanded":C,children:C?"Hide":"Show"})]})}),h("div",{className:"p-4 flex items-center gap-3",children:[n&&l("button",{onClick:W,className:"p-3 rounded-lg bg-red-50 text-red-600 hover:bg-red-100 transition-colors",title:"Clear Conversation",children:l(Hr,{className:"w-5 h-5"})}),l("input",{type:"text",className:"flex-grow p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:g==="resolved"?"Chat resolved. Start a new conversation...":"Type your message...",value:u,onChange:ee=>d(ee.target.value),onKeyDown:ee=>{ee.key==="Enter"&&!ee.shiftKey&&(ee.preventDefault(),H())},disabled:f||g==="resolved"}),h("button",{onClick:H,disabled:f||!u.trim()||g==="resolved",className:`p-3 rounded-lg font-semibold flex items-center gap-2 transition-colors min-w-[90px] justify-center ${f||g==="resolved"?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"}`,children:[l(yu,{className:"w-5 h-5"}),f?"Sending...":"Send"]})]}),g==="resolved"&&l("div",{className:"bg-yellow-50 border-t border-yellow-100 px-4 py-2 text-center text-sm text-yellow-700",children:"This chat has been marked as resolved. Start a new conversation to continue."})]})]})},ls=`${ke}/chat.php`,cs=()=>{const e=localStorage.getItem("token");return e?{Authorization:`Bearer ${e}`}:{}},rj=({user:e})=>{const[t,r]=N.useState([]),[n,a]=N.useState(null),[i,s]=N.useState(""),[o,c]=N.useState(""),[u,d]=N.useState([]),[f,m]=N.useState(!0),[p,x]=N.useState(!1),[g,y]=N.useState(null),[v,b]=N.useState(null),[w,k]=N.useState(!1),[S,_]=N.useState(""),[C,E]=N.useState(!1),A=N.useRef(null),T=N.useRef(null),D=()=>{var O;if(T.current){const K=T.current;K.scrollHeight-K.scrollTop<=K.clientHeight+100&&((O=A.current)==null||O.scrollIntoView({behavior:"smooth"}))}};N.useEffect(()=>{D()},[u]);const I=O=>O?O.includes("Admin")?l("span",{className:"inline-block bg-purple-100 text-purple-700 px-2 py-0.5 rounded-full text-xs font-semibold ml-2",children:"Admin"}):O.includes("Employee")?l("span",{className:"inline-block bg-blue-100 text-blue-700 px-2 py-0.5 rounded-full text-xs font-semibold ml-2",children:"Employee"}):null:null,z=O=>O?l("span",{className:"inline-block bg-green-100 text-green-700 px-2 py-0.5 rounded-full text-xs font-semibold ml-2",children:"Active"}):l("span",{className:"inline-block bg-red-100 text-red-700 px-2 py-0.5 rounded-full text-xs font-semibold ml-2",children:"Disabled"}),X=O=>{const K={low:"bg-gray-100 text-gray-700",normal:"bg-blue-100 text-blue-700",high:"bg-orange-100 text-orange-700",urgent:"bg-red-100 text-red-700"};return l("span",{className:`inline-block ${K[O]||K.normal} px-2 py-0.5 rounded-full text-xs font-semibold`,children:O?O.charAt(0).toUpperCase()+O.slice(1):"Normal"})},H=async()=>{try{const K=await(await fetch(`${ls}?stats`,{headers:cs()})).json();K.success&&b(K.stats)}catch(O){console.error("Error fetching stats:",O)}},L=async(O=!1)=>{O||m(!0);try{const G=await(await fetch(`${ls}?sessions`,{headers:cs()})).json();if(G.success){const te=G.sessions||[];r(ce=>{const M=JSON.stringify(ce),Le=JSON.stringify(te);return M!==Le?te:ce}),te.length>0&&!n&&a(te[0].id)}else G.error&&y(G.error)}catch{y("Failed to load chat sessions.")}O||m(!1)},W=async(O=!1)=>{if(n){O||x(!0);try{const G=await(await fetch(`${ls}?messages&session_id=${n}`,{headers:cs()})).json();if(G.success){const te=G.messages||[];d(ce=>{const M=JSON.stringify(ce),Le=JSON.stringify(te);return M!==Le?te:ce})}}catch{y("Failed to load messages.")}O||x(!1)}};N.useEffect(()=>{L(),H()},[]);const ie=t.filter(O=>{const K=i.toLowerCase(),G=(O.username||"").toLowerCase(),te=(O.guest_name||"").toLowerCase(),ce=(O.guest_email||"").toLowerCase();return["debug test user","test user","debug@test.com","test@example.com"].some(Le=>te===Le||ce===Le||G===Le)?!1:!K||G.includes(K)||te.includes(K)||ce.includes(K)});N.useEffect(()=>{ie.length===0?a(null):ie.some(O=>O.id===n)||a(ie[0].id)},[ie,n]),N.useEffect(()=>{n&&W()},[n]),N.useEffect(()=>{const O=setInterval(()=>{L(!0)},15e3);return()=>clearInterval(O)},[]),N.useEffect(()=>{if(!n)return;const O=setInterval(()=>{W(!0)},8e3);return()=>clearInterval(O)},[n]);const B=t.find(O=>O.id===n),ee=async()=>{if(!(!o.trim()||!n))try{(await(await fetch(`${ls}?send`,{method:"POST",headers:{"Content-Type":"application/json",...cs()},body:JSON.stringify({session_id:n,message:o.trim(),sender:"admin"})})).json()).success&&(c(""),W(),L())}catch{y("Failed to send message.")}},le=async()=>{E(!0)},R=async()=>{try{(await(await fetch(`${ls}?reopen`,{method:"POST",headers:{"Content-Type":"application/json",...cs()},body:JSON.stringify({session_id:n})})).json()).success&&(L(),W())}catch{y("Failed to reopen chat.")}},j=async O=>{try{(await(await fetch(`${ls}?update_priority`,{method:"POST",headers:{"Content-Type":"application/json",...cs()},body:JSON.stringify({session_id:n,priority:O})})).json()).success&&L()}catch{y("Failed to update priority.")}},V=async O=>{if(!O||O===null||O===void 0||O===0){y("Invalid message ID"),console.error("Cannot delete message: messageId is",O);return}if(confirm("Are you sure you want to delete this message?"))try{const G=await(await fetch(`${ls}?delete_message`,{method:"POST",headers:{"Content-Type":"application/json",...cs()},body:JSON.stringify({message_id:Number(O)})})).json();G.success?W():y(G.error||"Failed to delete message.")}catch(K){y("Failed to delete message: "+K.message),console.error("Delete message error:",K)}},P=async O=>{if(!O||O===0||O==="0"){y("Invalid chat session ID"),console.error("Cannot delete: chatId is",O);return}if(confirm("Are you sure you want to delete this chat session? This action cannot be undone."))try{const G=await(await fetch(`${ls}?delete_session`,{method:"POST",headers:{"Content-Type":"application/json",...cs()},body:JSON.stringify({session_id:parseInt(O,10)})})).json();G.success?(n===O&&(a(null),d([])),L()):(y(G.error||"Failed to delete chat session."),console.error("Delete session error:",G))}catch(K){y("Failed to delete chat session: "+K.message),console.error("Delete session error:",K)}},q=async()=>{try{(await(await fetch(`${ls}?resolve`,{method:"POST",headers:{"Content-Type":"application/json",...cs()},body:JSON.stringify({session_id:n,resolution_notes:S})})).json()).success&&(E(!1),_(""),L(),W())}catch{y("Failed to resolve chat.")}};return h("div",{className:"flex h-screen w-full bg-gray-50 overflow-hidden",style:{margin:0,padding:0},children:[h("div",{className:"w-1/3 min-w-[350px] max-w-sm border-r bg-white flex flex-col shadow-lg h-full",children:[h("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 flex-shrink-0",children:[l("h2",{className:"page-title",children:"Chat Support"}),h("div",{className:"flex items-center gap-2",children:[l("button",{onClick:()=>k(!w),className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",title:"Toggle Statistics",children:l(No,{className:"w-5 h-5"})}),l("button",{onClick:()=>{L(),H()},className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",title:"Refresh",children:l(O0,{className:"w-5 h-5"})})]})]}),w&&v&&h("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-3 border-b border-blue-200 flex-shrink-0",children:[l("h3",{className:"font-semibold text-blue-800 mb-2 text-sm",children:"Today's Statistics"}),h("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[h("div",{className:"bg-white p-2 rounded-lg border shadow-sm",children:[l("div",{className:"text-blue-600 font-bold text-lg",children:v.open_sessions}),l("div",{className:"text-gray-600 text-xs",children:"Open Chats"})]}),h("div",{className:"bg-white p-2 rounded-lg border shadow-sm",children:[l("div",{className:"text-green-600 font-bold text-lg",children:v.today_sessions}),l("div",{className:"text-gray-600 text-xs",children:"Today's Total"})]}),h("div",{className:"bg-white p-2 rounded-lg border shadow-sm",children:[l("div",{className:"text-purple-600 font-bold text-lg",children:v.total_sessions}),l("div",{className:"text-gray-600 text-xs",children:"All Time"})]}),h("div",{className:"bg-white p-2 rounded-lg border shadow-sm",children:[h("div",{className:"text-orange-600 font-bold text-lg",children:[v.avg_response_time,"m"]}),l("div",{className:"text-gray-600 text-xs",children:"Avg Response"})]})]})]}),l("div",{className:"p-4 border-b border-gray-200 flex-shrink-0",children:h("div",{className:"relative",children:[l(Di,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),l("input",{type:"text",placeholder:"Search user or email...",className:"w-full pl-12 pr-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-transparent bg-gray-50",value:i,onChange:O=>s(O.target.value)})]})}),l("div",{className:"flex-1 overflow-y-auto min-h-0 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100",children:f?h("div",{className:"flex items-center justify-center h-32 text-gray-400",children:[l(O0,{className:"w-5 h-5 animate-spin mr-2"}),"Loading chats..."]}):h("div",{className:"p-4",children:[ie.map(O=>l("div",{className:`p-4 rounded-lg cursor-pointer transition-all duration-200 mb-2 ${n===O.id?"bg-green-50 border-2 border-green-500 shadow-lg":"hover:bg-gray-50 border border-gray-200 hover:border-gray-300"}`,onClick:()=>a(O.id),children:h("div",{className:"flex items-start justify-between",children:[h("div",{className:"flex-1 min-w-0",children:[h("div",{className:"flex items-center gap-2 mb-2",children:[l("div",{className:"font-semibold truncate flex items-center gap-2",children:O.user_id?h(gt,{children:[l(Hk,{className:"inline w-5 h-5 text-green-500",title:"Registered User"}),O.username||`User #${O.user_id}`]}):h(gt,{children:[l(zk,{className:"inline w-5 h-5 text-gray-400",title:"Guest"}),O.guest_name||"Guest"]})}),X(O.priority)]}),l("div",{className:"text-sm text-gray-500 truncate mb-1",children:O.guest_email||""}),l("div",{className:"text-xs text-gray-400",children:O.last_message_time?new Date(O.last_message_time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""})]}),h("div",{className:"flex items-center gap-2 ml-3",children:[Number(O.unread_messages||0)>0&&l("div",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full font-semibold min-w-[22px] text-center",children:Number(O.unread_messages)}),O.status==="resolved"?l(At,{className:"w-5 h-5 text-green-500",title:"Resolved"}):l(ca,{className:"w-5 h-5 text-blue-500",title:"Open"}),l("button",{className:"text-red-400 hover:text-red-600 opacity-80 hover:opacity-100 transition-opacity",title:"Delete chat session",onClick:K=>{K.stopPropagation(),P(O.id)},children:l(Hr,{className:"w-4 h-4"})})]})]})},O.id)),ie.length===0&&!f&&h("div",{className:"text-center py-12 text-gray-400",children:[l(ca,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),l("div",{className:"text-lg font-medium mb-2",children:"No chats found"}),l("div",{className:"text-sm",children:"Start a conversation to see it here"})]})]})})]}),h("div",{className:"flex-1 flex flex-col bg-white overflow-hidden h-full min-h-0",children:[g&&l("div",{className:"bg-red-50 border border-red-200 text-red-700 p-4 text-center text-sm flex-shrink-0",children:g}),B?h("div",{className:"flex flex-col h-full min-h-0",children:[h("div",{className:"flex items-center justify-between bg-white px-6 py-6 border-b border-gray-200 shadow-sm flex-shrink-0",children:[h("div",{className:"flex-1",children:[h("div",{className:"font-bold text-xl flex items-center gap-3 mb-2",children:[B.user_id?h(gt,{children:[l(Hk,{className:"inline w-6 h-6 text-green-500",title:"Registered User"}),B.username||`User #${B.user_id}`]}):h(gt,{children:[l(zk,{className:"inline w-6 h-6 text-gray-400",title:"Guest"}),B.guest_name||"Guest"]}),I((e==null?void 0:e.roles)||[]),l("span",{className:`inline-block ${B.status==="resolved"?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"} px-2 py-0.5 rounded-full text-xs font-semibold`,children:B.status==="resolved"?"Resolved":"Open"}),typeof(e==null?void 0:e.is_active)=="boolean"&&z(!!e.is_active),X(B.priority)]}),l("div",{className:"text-sm text-gray-500 mb-1",children:B.guest_email||""}),h("div",{className:"text-xs text-gray-400",children:["Created ",B.created_at?new Date(B.created_at).toLocaleDateString():""]})]}),h("div",{className:"flex items-center gap-4",children:[h("select",{value:B.priority||"normal",onChange:O=>j(O.target.value),className:"border border-gray-300 rounded-lg px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-green-400 bg-white",children:[l("option",{value:"low",children:"Low Priority"}),l("option",{value:"normal",children:"Normal"}),l("option",{value:"high",children:"High"}),l("option",{value:"urgent",children:"Urgent"})]}),B.status==="resolved"?h("button",{className:"bg-blue-500 text-white px-6 py-2 rounded-lg flex items-center hover:bg-blue-600 transition-colors shadow-sm",onClick:R,children:[l(O0,{className:"w-4 h-4 mr-2"})," Reopen"]}):h("button",{className:"bg-green-500 text-white px-6 py-2 rounded-lg flex items-center hover:bg-green-600 transition-colors shadow-sm",onClick:le,children:[l(At,{className:"w-4 h-4 mr-2"})," Resolve"]})]})]}),l("div",{ref:T,className:"flex-1 overflow-y-auto overflow-x-hidden bg-gray-50 p-4 min-h-0",style:{scrollbarWidth:"thin",scrollbarColor:"#9ca3af #f1f5f9",flex:"1 1 auto",minHeight:"0px"},children:p?h("div",{className:"flex items-center justify-center h-32 text-gray-400",children:[l(O0,{className:"w-5 h-5 animate-spin mr-2"}),"Loading messages..."]}):u.length===0?l("div",{className:"flex items-center justify-center h-full text-gray-400",children:h("div",{className:"text-center",children:[l(ca,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),l("div",{className:"text-lg font-medium mb-2",children:"No messages yet"}),l("div",{className:"text-sm",children:"Start the conversation by sending a message"})]})}):h("div",{className:"space-y-4",children:[u.map((O,K)=>l("div",{className:`flex ${O.sender==="admin"?"justify-end":"justify-start"}`,children:h("div",{className:`group relative max-w-xs lg:max-w-md xl:max-w-lg ${O.sender==="admin"?"ml-auto":"mr-auto"}`,children:[h("div",{className:`relative rounded-2xl px-5 py-4 shadow-sm ${O.sender==="admin"?"bg-green-500 text-white":O.message_type==="system"?"bg-gray-200 text-gray-700 border border-gray-300":"bg-white text-gray-800 border border-gray-200"}`,children:[O.id&&O.id>0?l("button",{className:"absolute -top-2 -right-2 opacity-0 group-hover:opacity-100 transition-opacity bg-red-500 text-white rounded-full p-1.5 hover:bg-red-600 z-10 shadow-lg",title:"Delete message",onClick:()=>V(O.id),children:l(Hr,{className:"w-3 h-3"})}):null,l("div",{className:"text-sm whitespace-pre-wrap break-words leading-relaxed",children:O.message||""}),O.message_type!=="text"&&l("div",{className:"text-xs opacity-70 mt-2 pt-2 border-t border-opacity-20",children:O.message_type})]}),l("div",{className:`text-xs text-gray-500 mt-2 ${O.sender==="admin"?"text-right":"text-left"}`,children:O.sent_at?new Date(O.sent_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""})]})},O.id||K)),l("div",{ref:A})]})}),l("div",{className:"px-6 py-4 border-t border-gray-200 bg-white flex-shrink-0 sticky bottom-0",children:h("div",{className:"flex items-center gap-3",children:[l("div",{className:"flex-1 relative",children:l("input",{type:"text",className:"w-full border border-gray-300 rounded-2xl px-6 py-3 pr-16 focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-transparent resize-none text-base",placeholder:"Type your reply...",value:o,onChange:O=>c(O.target.value),onKeyDown:O=>{O.key==="Enter"&&!O.shiftKey&&(O.preventDefault(),ee())}})}),l("button",{className:"bg-green-500 text-white p-2 rounded-full hover:bg-green-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed shadow-lg",onClick:ee,disabled:!o.trim(),children:l(yu,{className:"w-5 h-5"})})]})})]}):l("div",{className:"flex-1 flex items-center justify-center text-gray-400",children:h("div",{className:"text-center",children:[l(ca,{className:"w-24 h-24 mx-auto mb-6 opacity-50"}),l("div",{className:"text-2xl font-medium mb-3",children:"Select a chat to view messages"}),l("div",{className:"text-base",children:"Choose a conversation from the sidebar to start responding"})]})})]}),C&&l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:h("div",{className:"bg-white rounded-xl p-8 w-full max-w-md mx-4 shadow-2xl",children:[l("h3",{className:"text-xl font-bold mb-6",children:"Resolve Chat Session"}),l("textarea",{className:"w-full border border-gray-300 rounded-lg px-4 py-3 mb-6 focus:outline-none focus:ring-2 focus:ring-green-400 resize-none",placeholder:"Add resolution notes (optional)...",value:S,onChange:O=>_(O.target.value),rows:4}),h("div",{className:"flex gap-3 justify-end",children:[l("button",{className:"px-6 py-2 text-gray-600 hover:text-gray-800 transition-colors",onClick:()=>{E(!1),_("")},children:"Cancel"}),l("button",{className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",onClick:q,children:"Resolve"})]})]})})]})},Tc=({user:e,fullScreen:t=!1,customStyles:r={},hideHeader:n=!1})=>{var f,m,p,x,g;const[a,i]=N.useState(null),[s,o]=N.useState(!0),[c,u]=N.useState(null);if(N.useEffect(()=>{(async()=>{try{const v=localStorage.getItem("token"),b=await fetch(`${ke}/chat.php?check_permissions`,{headers:{Authorization:`Bearer ${v}`}});if(!b.ok)throw new Error(`HTTP error! status: ${b.status}`);const w=await b.json();w.success?i(w):i({hasPermission:!1,canRead:!1,canWrite:!1})}catch(v){console.error("Error checking permissions:",v),i({hasPermission:!1,canRead:!1,canWrite:!1}),u("Failed to load chat support")}finally{o(!1)}})()},[e]),s)return l("div",{className:"flex items-center justify-center h-64",children:h("div",{className:"text-center",children:[l(ca,{className:"w-8 h-8 animate-pulse text-green-600 mx-auto mb-2"}),l("div",{className:"text-gray-600",children:"Loading chat support..."})]})});if(c)return l("div",{className:"flex items-center justify-center h-64",children:h("div",{className:"text-center text-red-600",children:[l(Fn,{className:"w-8 h-8 mx-auto mb-2"}),l("div",{children:c})]})});const d=()=>{var y,v,b;return a!=null&&a.canRead&&((y=e==null?void 0:e.roles)!=null&&y.includes("Super Admin")||(v=e==null?void 0:e.roles)!=null&&v.includes("Admin")||(b=e==null?void 0:e.roles)!=null&&b.includes("Employee"))?l("div",{className:t?"h-screen":"h-full",children:l(rj,{user:e})}):l("div",{className:t?"h-screen":"h-full",children:l(tj,{user:e,customStyles:r,hideHeader:n})})};return a&&!a.hasPermission&&e&&!((f=e.roles)!=null&&f.includes("Super Admin"))&&((m=e.roles)!=null&&m.includes("Admin")||(p=e.roles)!=null&&p.includes("Employee"))?l("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:h("div",{className:"text-center max-w-md mx-auto p-8",children:[l(Ta,{className:"w-16 h-16 text-red-500 mx-auto mb-6"}),l("h3",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Access Restricted"}),l("p",{className:"text-gray-600 mb-6 text-lg",children:"You don't have permission to access chat support management."}),l("p",{className:"text-sm text-gray-500 mb-6",children:"Your access to this feature has been disabled by a Super Admin."}),l("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:h("p",{className:"text-yellow-800 text-sm",children:[l("strong",{children:"Need access?"})," Contact your Super Administrator to enable chat support permissions for your account."]})})]})}):!s&&!a&&e&&((x=e.roles)!=null&&x.includes("Admin")||(g=e.roles)!=null&&g.includes("Employee"))?l("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:h("div",{className:"text-center max-w-md mx-auto p-8",children:[l(Fn,{className:"w-16 h-16 text-yellow-500 mx-auto mb-6"}),l("h3",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Unable to Load Chat Support"}),l("p",{className:"text-gray-600 mb-6 text-lg",children:"There was an error loading your chat support permissions."}),l("p",{className:"text-sm text-gray-500 mb-6",children:"Please try refreshing the page or contact your administrator."}),l("button",{onClick:()=>window.location.reload(),className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors",children:"Refresh Page"})]})}):!s&&a===null?l("div",{className:"flex items-center justify-center h-64",children:h("div",{className:"text-center text-gray-600",children:[l(Fn,{className:"w-8 h-8 mx-auto mb-2"}),l("div",{children:"Loading chat support..."})]})}):l("div",{className:"relative",children:d()})},k3=({buildId:e,user:t,className:r=""})=>{const[n,a]=N.useState([]),[i,s]=N.useState(!0),[o,c]=N.useState(!1),[u,d]=N.useState(""),[f,m]=N.useState(null),[p,x]=N.useState(null),[g,y]=N.useState(""),[v,b]=N.useState({}),[w,k]=N.useState(""),S=async()=>{try{s(!0);const X=await(await fetch(`${ke}/build_comments.php?action=list&build_id=${e}`)).json();X.success?a(X.data):k(X.error||"Failed to load comments")}catch(z){console.error("Failed to load comments:",z),k("Failed to load comments. Please refresh the page.")}finally{s(!1)}};N.useEffect(()=>{e&&S()},[e]);const _=async z=>{if(z.preventDefault(),!(!u.trim()||o))try{c(!0),k("");const H=await(await tt(`${ke}/build_comments.php?action=add`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({build_id:e,comment_text:u.trim(),parent_id:f})})).json();H.success?(d(""),m(null),await S()):k(H.error||"Failed to submit comment")}catch(X){console.error("Comment submission error:",X),k("Failed to submit comment. Please try again.")}finally{c(!1)}},C=async z=>{if(g.trim())try{const H=await(await tt(`${ke}/build_comments.php?action=edit`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({comment_id:z,comment_text:g.trim()})})).json();H.success?(x(null),y(""),await S()):k(H.error||"Failed to update comment")}catch{k("Failed to update comment")}},E=async z=>{if(confirm("Are you sure you want to delete this comment?"))try{const H=await(await tt(`${ke}/build_comments.php?action=delete&comment_id=${z}`,{method:"DELETE"})).json();H.success?await S():k(H.error||"Failed to delete comment")}catch{k("Failed to delete comment")}},A=z=>{const X=new Date(z),L=Math.floor((new Date-X)/(1e3*60*60));return L<1?"Just now":L<24?`${L}h ago`:L<168?`${Math.floor(L/24)}d ago`:X.toLocaleDateString()},T=z=>z.first_name&&z.last_name?`${z.first_name} ${z.last_name}`:z.username||"Anonymous",D=z=>t&&(t.id===z.user_id||t.role==="admin"||t.role==="super_admin"),I=(z,X=0)=>{const H=X>0;return l("div",{className:`${H?"ml-8 mt-3":"mb-4"}`,children:h("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[h("div",{className:"flex items-start justify-between",children:[h("div",{className:"flex items-center gap-2 mb-2",children:[l("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:l(sl,{className:"w-4 h-4 text-white"})}),h("div",{children:[l("div",{className:"font-medium text-gray-900",children:T(z)}),h("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[l(Co,{className:"w-3 h-3"}),l("span",{children:A(z.created_at)}),z.is_edited&&l("span",{className:"text-xs text-gray-400",children:"(edited)"})]})]})]}),D(z)&&h("div",{className:"relative",children:[l("button",{onClick:()=>b(L=>({...L,[z.id]:!L[z.id]})),className:"p-1 hover:bg-gray-200 rounded-full",children:l(Q8,{className:"w-4 h-4 text-gray-500"})}),v[z.id]&&h("div",{className:"absolute right-0 top-8 bg-white border border-gray-200 rounded-lg shadow-lg z-10",children:[h("button",{onClick:()=>{x(z.id),y(z.comment_text),b(L=>({...L,[z.id]:!1}))},className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left",children:[l(Z8,{className:"w-3 h-3"}),"Edit"]}),h("button",{onClick:()=>{E(z.id),b(L=>({...L,[z.id]:!1}))},className:"flex items-center gap-2 px-3 py-2 text-sm text-red-600 hover:bg-red-50 w-full text-left",children:[l(Hr,{className:"w-3 h-3"}),"Delete"]})]})]})]}),p===z.id?h("div",{className:"mt-2",children:[l("textarea",{value:g,onChange:L=>y(L.target.value),className:"w-full p-2 border border-gray-300 rounded-lg resize-none",rows:"3",maxLength:"1000"}),h("div",{className:"flex gap-2 mt-2",children:[l("button",{onClick:()=>C(z.id),className:"px-3 py-1 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700",children:"Save"}),l("button",{onClick:()=>{x(null),y("")},className:"px-3 py-1 bg-gray-300 text-gray-700 text-sm rounded-lg hover:bg-gray-400",children:"Cancel"})]})]}):l("div",{className:"text-gray-800 whitespace-pre-wrap",children:z.comment_text}),!H&&t&&l("div",{className:"flex gap-2 mt-3",children:h("button",{onClick:()=>m(z.id),className:"flex items-center gap-1 text-sm text-blue-600 hover:text-blue-700",children:[l(tL,{className:"w-3 h-3"}),"Reply"]})}),z.replies&&z.replies.length>0&&l("div",{className:"mt-3",children:z.replies.map(L=>I(L,X+1))})]})},z.id)};return i?l("div",{className:`bg-white rounded-lg border border-gray-200 p-6 ${r}`,children:l("div",{className:"flex items-center justify-center py-8",children:l("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):h("div",{className:`bg-white rounded-lg border border-gray-200 ${r}`,children:[h("div",{className:"p-6 border-b border-gray-200",children:[h("div",{className:"flex items-center gap-2 mb-4",children:[l(Jy,{className:"w-5 h-5 text-blue-600"}),h("h3",{className:"text-lg font-semibold text-gray-900",children:["Comments (",n.length,")"]})]}),w&&l("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:w}),t?h("form",{onSubmit:_,className:"mb-6",children:[l("div",{className:"space-y-3",children:h("div",{children:[l("textarea",{value:u,onChange:z=>d(z.target.value),placeholder:f?"Write a reply...":"Write a comment...",className:"w-full p-3 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"3",maxLength:"1000",required:!0}),h("div",{className:"flex justify-between items-center mt-1",children:[h("div",{className:"text-xs text-gray-500",children:[u.length,"/1000 characters"]}),h("button",{type:"submit",disabled:!u.trim()||o,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 text-sm font-medium",children:[o?l("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):l(yu,{className:"w-4 h-4"}),f?"Reply":"Comment"]})]})]})}),f&&l("div",{className:"mt-2",children:l("button",{type:"button",onClick:()=>m(null),className:"text-sm text-gray-500 hover:text-gray-700",children:"Cancel reply"})})]}):l("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg text-center",children:h("p",{className:"text-gray-600",children:["Please ",l("a",{href:"/login",className:"text-blue-600 hover:underline",children:"login"})," to comment"]})})]}),l("div",{className:"p-6",children:n.length===0?h("div",{className:"text-center py-8 text-gray-500",children:[l(Jy,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),l("p",{children:"No comments yet. Be the first to comment!"})]}):l("div",{className:"space-y-4",children:n.map(z=>I(z))})})]})};function mx(e){try{const t=e.split(".")[1];if(!t)return!0;let r=t.replace(/-/g,"+").replace(/_/g,"/");for(;r.length%4;)r+="=";const n=JSON.parse(atob(r));return n.exp?Date.now()>=n.exp*1e3:!1}catch{return!0}}const hS=({setCurrentPage:e,setSelectedComponents:t,user:r})=>{const[n,a]=N.useState([]),[i,s]=N.useState(!0),[o,c]=N.useState(null),[u,d]=N.useState(!1),[f,m]=N.useState(null),[p,x]=N.useState(!1),[g,y]=N.useState(null),[v,b]=N.useState([]);N.useEffect(()=>{(async()=>{var ie;const W=localStorage.getItem("token");if(!W||mx(W)){s(!1);return}try{const B={Authorization:`Bearer ${W}`},ee=await fetch(`${ke}/index.php?endpoint=builds`,{method:"GET",headers:B});if(ee.status===401){s(!1),a([]);return}const le=await ee.json();if(console.log("API Response:",le),le.success){console.log("Raw builds from API:",le.data),console.log("Debug info:",le.debug);const R=(le.data||[]).map((j,V)=>{let P=j.id||j.build_id||j.ID||j.Id;return console.log(`Build ${V}:`,{id:j.id,buildId:P,type:typeof j.id,fullBuild:j}),(!P||P<=0)&&console.error("Build missing valid ID at index",V,":",j),P&&(P=typeof P=="string"?parseInt(P,10):Number(P)),{...j,id:P||null}}).filter(j=>j.id&&j.id>0);console.log("Fetched builds:",R.length,"valid builds out of",((ie=le.data)==null?void 0:ie.length)||0),le.debug&&console.log("Backend debug:",le.debug),a(R)}else console.error("API returned error:",le.error||le),a([])}catch{a([])}finally{s(!1)}})()},[]),N.useEffect(()=>{(async()=>{const W=localStorage.getItem("token");if(!(!W||mx(W)))try{const B=await(await fetch(`${ke}/community_submission.php`,{headers:{Authorization:`Bearer ${W}`}})).json();B.success&&b(B.data||[])}catch{}})()},[]);const w=L=>{let W;if(L==null){console.error("Build ID is null or undefined"),alert("Error: Invalid build ID. Please refresh the page and try again.");return}if(typeof L=="string"?W=parseInt(L,10):typeof L=="number"?W=L:W=parseInt(String(L),10),isNaN(W)||W<=0||!Number.isInteger(W)){console.error("Invalid build ID:",L,"parsed as:",W,"type:",typeof L),alert("Error: Invalid build ID. The build may not have been saved properly. Please refresh the page and try again.");return}const ie=Number.isInteger(W)&&W>0?W:null;if(!ie){console.error("Build ID validation failed after conversion:",{original:L,converted:W}),alert("Error: Invalid build ID. Please refresh the page and try again.");return}console.log("Setting buildToDelete:",ie,"from input:",L,"type:",typeof L),m(ie),d(!0)},k=async L=>{if(L&&(L.preventDefault(),L.stopPropagation()),f==null||typeof f!="number"||f<=0||p){console.log("Delete blocked:",{buildToDelete:f,deletingBuild:p,type:typeof f});return}console.log("Starting delete process for build:",f),x(!0);try{const W=localStorage.getItem("token");if(!W||mx(W)){alert("Session expired. Please log in again."),d(!1),m(null),x(!1);return}const ie=`${ke}/index.php?endpoint=builds&id=${f}`;console.log("Delete URL:",ie);const B=await fetch(ie,{method:"DELETE",headers:{Authorization:`Bearer ${W}`,"Content-Type":"application/json"}});console.log("Delete response status:",B.status);let ee;const le=B.headers.get("content-type");if(le&&le.includes("application/json"))ee=await B.json(),console.log("Delete response:",ee);else{const R=await B.text();throw console.error("Non-JSON response:",R),new Error("Invalid response from server: "+R.substring(0,100))}if(B.ok&&ee.success)a(R=>R.filter(j=>j.id!==f)),d(!1),m(null),alert("Build deleted successfully!");else{const R=ee.error||ee.message||`HTTP ${B.status}: ${B.statusText}`;console.error("Delete failed:",R,ee),alert("Error deleting build: "+R)}}catch(W){console.error("Error deleting build:",W),alert("Error deleting build: "+(W.message||"Please try again."))}finally{x(!1)}},S=async L=>{y(L);try{const W=localStorage.getItem("token"),B=await(await fetch(`${ke}/index.php?endpoint=builds&public=1&id=${L}`,{method:"PUT",headers:{Authorization:`Bearer ${W}`}})).json();B.success?(a(ee=>ee.map(le=>le.id===L?{...le,isPublic:B.is_public}:le)),alert(B.message)):alert(B.error||"Unable to change visibility.")}catch(W){console.error("Error updating build visibility:",W),alert("Error updating build visibility. Please try again.")}finally{y(null)}},_=async L=>{try{const W=localStorage.getItem("token"),B=await(await fetch(`${ke}/index.php?endpoint=community_submission`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${W}`},body:JSON.stringify({build_id:L.id,build_name:L.name,build_description:L.description||"",total_price:L.totalPrice||0,compatibility:L.compatibility||0})})).json();B.success?(alert("Build submitted for PC Build Sharing review! Admins will review and approve it for PC Build Sharing."),b(ee=>[{id:B.submission_id,build_id:L.id,status:"pending"},...ee])):alert(B.error||"Failed to submit for review.")}catch(W){console.error("Error submitting to community:",W),alert("Network error while submitting. Please try again.")}},C=L=>{let W={};Array.isArray(L.components)?L.components.forEach(ie=>{ie&&ie.category&&(W[ie.category.toLowerCase()]=ie)}):L.components&&typeof L.components=="object"&&(Object.keys(L.components).every(B=>!isNaN(Number(B)))?Object.values(L.components).forEach(B=>{B&&B.category&&(W[B.category.toLowerCase()]=B)}):W={...L.components}),localStorage.setItem("builditpc-selected-components",JSON.stringify(W)),localStorage.setItem("builditpc-editing-build",JSON.stringify({id:L.id,name:L.name,description:L.description})),typeof t=="function"&&t(W),e("pc-assembly")},E=L=>new Date(L).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),A=L=>L>=90?{status:"Excellent",color:"text-green-600",bgColor:"bg-green-100",icon:l(At,{className:"w-4 h-4"})}:L>=70?{status:"Good",color:"text-yellow-600",bgColor:"bg-yellow-100",icon:l(ts,{className:"w-4 h-4"})}:{status:"Issues",color:"text-red-600",bgColor:"bg-red-100",icon:l(ts,{className:"w-4 h-4"})},T=L=>{const W=Number(L);return isNaN(W)?0:W},D=L=>{if(!L)return"N/A";const W=new Date(L);return isNaN(W)?"N/A":W.toLocaleDateString()},I=()=>h("div",{className:"flex flex-col items-center justify-center py-16 px-6",children:[l("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-6",children:l("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})})}),l("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No builds yet"}),l("p",{className:"text-gray-600 text-center max-w-md mb-8",children:"You haven't saved any PC builds yet. Start building your dream PC in the PC Assembly section and save your configurations for future reference."}),l("div",{className:"flex flex-col sm:flex-row gap-4",children:h("button",{onClick:()=>e("pc-assembly"),className:"bg-green-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-700 transition-colors flex items-center gap-2",children:[l(wn,{className:"w-5 h-5"}),"Start Building"]})}),h("div",{className:"mt-8 p-6 bg-blue-50 rounded-lg max-w-md",children:[l("h4",{className:"font-semibold text-blue-900 mb-2",children:"Pro Tips:"}),h("ul",{className:"text-sm text-blue-800 space-y-1",children:[l("li",{children:"â€¢ Save multiple builds to compare different configurations"}),l("li",{children:"â€¢ Share your builds with friends for feedback"}),l("li",{children:"â€¢ Export parts lists to local retailers"}),l("li",{children:"â€¢ Track price changes on your saved components"})]})]})]}),z=({build:L})=>{if(!L||!L.id||L.id<=0)return console.error("Invalid build data:",L),null;let W=[];if(Array.isArray(L.components))W=L.components.filter(R=>R&&typeof R=="object");else if(L.components&&typeof L.components=="object")W=Object.values(L.components).filter(R=>R&&typeof R=="object");else if(typeof L.components=="string")try{const R=JSON.parse(L.components);Array.isArray(R)?W=R.filter(j=>j&&typeof j=="object"):R&&typeof R=="object"&&(W=Object.values(R).filter(j=>j&&typeof j=="object"))}catch(R){console.error("Failed to parse components string:",R),W=[]}let ie=T(L.totalPrice);if(ie<=0&&W.length>0){const R=W.reduce((j,V)=>{const P=T(V.price);return j+P},0);R>0&&(ie=R)}let B=typeof L.compatibility=="number"?L.compatibility:0;if((!B||B===0)&&W.length>0)try{const R={cpu:["cpu","processor","procie"],motherboard:["motherboard","mobo"],gpu:["gpu","graphics card","graphics","video card","vga"],ram:["ram","memory"],storage:["storage","ssd","hdd","nvme"],psu:["psu","power supply"],case:["case","chassis"],cooler:["cooler","cooling","aio"]},j={};W.forEach(P=>{if(!P||typeof P!="object")return;const q=String((P==null?void 0:P.category)||(P==null?void 0:P.name)||"").toLowerCase(),O=Object.keys(R).find(K=>K===q||R[K].some(G=>q.includes(G))||P.name&&R[K].some(G=>P.name.toLowerCase().includes(G)));O&&(j[O]=P)});const V=Jd(j);V&&typeof V.score=="number"&&V.score>0&&(B=V.score)}catch(R){console.error("Error calculating compatibility:",R)}const ee=A(B),le=v.find(R=>R.build_id===L.id);return l("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:h("div",{className:"p-6",children:[h("div",{className:"flex items-start justify-between mb-4",children:[h("div",{className:"flex-1",children:[l("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:L.name}),l("p",{className:"text-sm text-gray-600 mb-2",children:L.description}),h("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[h("div",{className:"flex items-center gap-1",children:[l(Yd,{className:"w-4 h-4"}),D(L.createdAt)]}),h("div",{className:"flex items-center gap-1",children:[l("span",{className:"text-gray-700",children:"â‚±"}),it(ie)]})]})]}),h("div",{className:"flex items-center gap-2",children:[l("button",{onClick:()=>S(L.id),disabled:g===L.id,className:`p-2 rounded-lg transition-colors ${L.isPublic?"text-green-600 hover:text-green-700 hover:bg-green-50":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,title:L.isPublic?"Make Private":"Make Public",children:g===L.id?l("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}):L.isPublic?l(jk,{className:"w-4 h-4"}):l(Qh,{className:"w-4 h-4"})}),!L.isPublic&&l("button",{onClick:()=>_(L),disabled:le&&le.status==="pending",className:`p-2 rounded-lg transition-colors ${le&&le.status==="pending"?"text-yellow-600 bg-yellow-50":"text-blue-600 hover:text-blue-700 hover:bg-blue-50"}`,title:le&&le.status==="pending"?"Awaiting admin review":"Submit to PC Build Sharing",children:le&&le.status==="pending"?l(Co,{className:"w-4 h-4"}):l(Zh,{className:"w-4 h-4"})}),l("button",{onClick:()=>C(L),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:l(Oi,{className:"w-4 h-4"})}),l("button",{"data-build-id":L.id,onClick:R=>{R.preventDefault(),R.stopPropagation();let j=R.currentTarget.getAttribute("data-build-id");if(!j&&L&&(j=L.id||L.build_id||L.ID||L.Id),console.log("Delete button clicked - Build ID from data:",R.currentTarget.getAttribute("data-build-id")),console.log("Delete button clicked - Build ID from object:",L==null?void 0:L.id),console.log("Delete button clicked - Full build object:",L),!j){console.error("Build ID is missing from both data attribute and build object:",{build:L,"data-build-id":R.currentTarget.getAttribute("data-build-id")}),alert("Error: Cannot delete build - invalid build ID. Please refresh the page and try again.");return}if(typeof j=="string"&&(j=parseInt(j,10)),j==null||j<=0||isNaN(j)){console.error("Build ID is invalid after conversion:",{original:R.currentTarget.getAttribute("data-build-id"),build:L,buildId:j,type:typeof j}),alert("Error: Cannot delete build - invalid build ID. Please refresh the page and try again.");return}const V=typeof j=="number"?j:parseInt(j,10);if(isNaN(V)||V<=0){console.error("Build ID conversion failed:",{original:R.currentTarget.getAttribute("data-build-id"),converted:V}),alert("Error: Cannot delete build - invalid build ID. Please refresh the page and try again.");return}console.log("Delete button clicked for build:",V,"type:",typeof V),w(V)},className:"p-2 text-red-400 hover:text-red-600 rounded-lg hover:bg-red-50",title:"Delete Build",children:l(Hr,{className:"w-4 h-4"})})]})]}),h("div",{className:"flex items-center justify-between mb-4",children:[h("div",{className:"flex items-center gap-3",children:[h("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full ${ee.bgColor}`,children:[ee.icon,h("span",{className:`text-sm font-medium ${ee.color}`,children:[B,"% Compatible"]})]}),L.isPublic&&h("div",{className:"flex items-center gap-1 px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs font-medium",children:[l(jk,{className:"w-3 h-3"}),"Public"]})]}),h("div",{className:"flex items-center gap-2",children:[l("span",{className:"text-sm text-gray-500",children:"Last updated:"}),l("span",{className:"text-sm font-medium text-gray-900",children:D(L.updatedAt)})]})]}),l("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:W.length>0?W.map((R,j)=>{if(!R||typeof R!="object")return null;const V=R.category||R.name||"Unknown",P=R.name||"Unnamed Component",q=T(R.price);return h("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[l("div",{className:"text-xs font-medium text-gray-600 mb-1",children:V}),l("div",{className:"text-sm font-semibold text-gray-900 truncate",title:P,children:P}),l("div",{className:"text-xs text-gray-500",children:it(q)})]},j)}):l("div",{className:"col-span-full text-center text-sm text-gray-500 py-2",children:"No components found"})}),h("div",{className:"flex gap-3",children:[h("button",{className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center justify-center gap-2",onClick:()=>c(L),children:[l(hl,{className:"w-4 h-4"}),"View Details"]}),h("button",{onClick:()=>C(L),className:"flex-1 border-2 border-gray-300 text-gray-700 py-2 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors flex items-center justify-center gap-2",children:[l(Oi,{className:"w-4 h-4"}),"Edit Build"]})]})]})})};if(i)return l("div",{className:"flex items-center justify-center h-64",children:h("div",{className:"text-center",children:[l("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),l("p",{className:"mt-4 text-gray-600",children:"Loading your builds..."})]})});const X=n.length,H=n.reduce((L,W)=>{let ie=T(W.totalPrice);return ie<=0&&W.components&&(ie=(Array.isArray(W.components)?W.components:Object.values(W.components||{})).reduce((ee,le)=>ee+T(le==null?void 0:le.price),0)),L+ie},0);return h("div",{className:"p-6",children:[h("div",{className:"mb-8",children:[h("div",{className:"flex items-center justify-between mb-4",children:[h("div",{children:[l("h1",{className:"text-3xl font-bold mb-1",children:"My Builds"}),l("p",{className:"text-gray-600",children:"Manage and organize your saved PC configurations"})]}),h("div",{className:"flex gap-3",children:[h("button",{onClick:()=>e("prebuilt-pcs"),className:"border-2 border-gray-300 text-gray-700 px-5 py-2 rounded-lg font-semibold hover:bg-gray-50 transition-colors flex items-center gap-2",children:[l(Zh,{className:"w-5 h-5"})," Browse PC Build Sharing"]}),n.length>0&&h("button",{className:"bg-green-600 text-white px-5 py-2 rounded-lg font-semibold hover:bg-green-700 transition-colors flex items-center gap-2",onClick:()=>e("pc-assembly"),children:[l(wn,{className:"w-5 h-5"})," New Build"]})]})]}),n.length>0&&h("div",{className:"mb-6 text-gray-700 text-lg",children:["Total builds: ",X," Â  â€¢ Â  Total value: ",it(H)]})]}),n.length===0?l(I,{}):l("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:n.map(L=>l(z,{build:L},L.id))}),u&&l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:L=>{L.target===L.currentTarget&&!p&&(d(!1),m(null))},children:h("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",onClick:L=>L.stopPropagation(),children:[h("div",{className:"flex items-center gap-3 mb-4",children:[l("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:l(Hr,{className:"w-5 h-5 text-red-600"})}),l("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete Build"})]}),l("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to delete this build? This action cannot be undone."}),h("div",{className:"flex gap-3",children:[l("button",{type:"button",onClick:L=>{L.preventDefault(),L.stopPropagation(),p||(d(!1),m(null))},disabled:p,className:"flex-1 border-2 border-gray-300 text-gray-700 py-2 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),l("button",{type:"button",onClick:L=>{L.preventDefault(),L.stopPropagation(),k(L)},disabled:p,className:"flex-1 bg-red-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:p?h(gt,{children:[l("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Deleting..."]}):"Delete"})]})]})}),o&&(()=>{let L=[];Array.isArray(o.components)?L=o.components.filter(B=>B&&typeof B=="object"):o.components&&typeof o.components=="object"&&(L=Object.values(o.components).filter(B=>B&&typeof B=="object"));let W=T(o.totalPrice);if(W<=0&&L.length>0){const B=L.reduce((ee,le)=>ee+T(le==null?void 0:le.price),0);B>0&&(W=B)}let ie=typeof o.compatibility=="number"?o.compatibility:0;if((!ie||ie===0)&&L.length>0)try{const B={cpu:["cpu","processor","procie"],motherboard:["motherboard","mobo"],gpu:["gpu","graphics card","graphics","video card","vga"],ram:["ram","memory"],storage:["storage","ssd","hdd","nvme"],psu:["psu","power supply"],case:["case","chassis"],cooler:["cooler","cooling","aio"]},ee={};L.forEach(R=>{if(!R||typeof R!="object")return;const j=String((R==null?void 0:R.category)||(R==null?void 0:R.name)||"").toLowerCase(),V=Object.keys(B).find(P=>P===j||B[P].some(q=>j.includes(q))||R.name&&B[P].some(q=>R.name.toLowerCase().includes(q)));V&&(ee[V]=R)});const le=Jd(ee);le&&typeof le.score=="number"&&le.score>0&&(ie=le.score)}catch(B){console.error("Error calculating compatibility in modal:",B)}return l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[l("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-xl",children:h("div",{className:"flex items-center justify-between",children:[h("div",{className:"flex items-center gap-4",children:[l("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:l("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})})}),h("div",{children:[l("h2",{className:"text-2xl font-bold text-gray-900",children:o.name}),l("p",{className:"text-gray-600",children:o.description})]})]}),l("button",{onClick:()=>c(null),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors",children:l("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),h("div",{className:"p-6",children:[h("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[h("div",{className:"bg-gradient-to-br from-green-50 to-blue-50 rounded-xl p-6 border border-green-200",children:[h("div",{className:"flex items-center gap-3 mb-3",children:[l("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:l(At,{className:"w-5 h-5 text-green-600"})}),h("div",{children:[l("h3",{className:"font-semibold text-gray-900",children:"Compatibility"}),h("p",{className:"text-2xl font-bold text-green-600",children:[ie,"%"]})]})]}),l("div",{className:"w-full bg-gray-200 rounded-full h-2",children:l("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${ie}%`}})})]}),h("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl p-6 border border-blue-200",children:[h("div",{className:"flex items-center gap-3 mb-3",children:[l("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:l("span",{className:"text-blue-600 text-xl font-bold",children:"â‚±"})}),h("div",{children:[l("h3",{className:"font-semibold text-gray-900",children:"Total Price"}),l("p",{className:"text-2xl font-bold text-blue-600",children:it(W)})]})]}),l("p",{className:"text-sm text-gray-600",children:"All components included"})]}),h("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-6 border border-purple-200",children:[h("div",{className:"flex items-center gap-3 mb-3",children:[l("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:l(nt,{className:"w-5 h-5 text-purple-600"})}),h("div",{children:[l("h3",{className:"font-semibold text-gray-900",children:"Components"}),l("p",{className:"text-2xl font-bold text-purple-600",children:L.length})]})]}),l("p",{className:"text-sm text-gray-600",children:"Parts in this build"})]})]}),h("div",{className:"bg-gray-50 rounded-xl p-6 mb-8",children:[h("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[l(Yd,{className:"w-5 h-5 text-gray-600"}),"Build Timeline"]}),h("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h("div",{className:"flex items-center gap-3",children:[l("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:l(At,{className:"w-4 h-4 text-green-600"})}),h("div",{children:[l("p",{className:"font-medium text-gray-900",children:"Created"}),l("p",{className:"text-sm text-gray-600",children:E(o.createdAt)})]})]}),h("div",{className:"flex items-center gap-3",children:[l("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:l(Co,{className:"w-4 h-4 text-blue-600"})}),h("div",{children:[l("p",{className:"font-medium text-gray-900",children:"Last Updated"}),l("p",{className:"text-sm text-gray-600",children:E(o.updatedAt)})]})]})]})]}),h("div",{children:[h("h3",{className:"text-xl font-bold text-gray-900 mb-6 flex items-center gap-2",children:[l(nt,{className:"w-6 h-6 text-gray-600"}),"Build Components"]}),l("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:L.length>0?L.map((B,ee)=>{if(!B||typeof B!="object")return null;const le=B.category||"Unknown",R=B.name||"Unnamed Component",j=T(B.price);return l("div",{className:"bg-white border border-gray-200 rounded-xl p-6 hover:shadow-lg transition-shadow",children:h("div",{className:"flex items-start gap-4",children:[l("div",{className:"w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0",children:l(nt,{className:"w-8 h-8 text-gray-400"})}),h("div",{className:"flex-1 min-w-0",children:[h("div",{className:"flex items-center justify-between mb-2",children:[l("span",{className:"inline-block bg-green-100 text-green-800 text-xs font-medium px-2 py-1 rounded-full",children:le}),l("span",{className:"text-lg font-bold text-green-600",children:it(j)})]}),l("h4",{className:"font-semibold text-gray-900 text-lg mb-2 line-clamp-2",title:R,children:R}),B.brand&&h("p",{className:"text-sm text-gray-600 mb-2",children:["Brand: ",l("span",{className:"font-medium",children:B.brand})]}),B.specs&&typeof B.specs=="object"&&l("div",{className:"text-xs text-gray-500 space-y-1",children:Object.entries(B.specs).slice(0,3).map(([V,P])=>h("div",{className:"flex justify-between",children:[h("span",{className:"capitalize",children:[V.replace(/_/g," "),":"]}),l("span",{className:"font-medium",children:String(P)})]},V))})]})]})},ee)}):l("div",{className:"col-span-full text-center text-gray-500 py-8",children:"No components found in this build"})})]}),o.isPublic&&l("div",{className:"mt-8",children:l(k3,{buildId:o.id,user:r,className:"mb-8"})}),l("div",{className:"flex gap-4 mt-8 pt-6 border-t border-gray-200",children:h("button",{onClick:()=>C(o),className:"flex-1 bg-green-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-green-700 transition-colors flex items-center justify-center gap-2",children:[l(Oi,{className:"w-5 h-5"}),"Edit Build"]})})]})]})})})()]})},mS=({setCurrentPage:e})=>{const[t,r]=N.useState([]),[n,a]=N.useState(!0),[i,s]=N.useState(null),[o,c]=N.useState(!1),u=k=>{try{const S=k.split(".")[1];if(!S)return!0;let _=S.replace(/-/g,"+").replace(/_/g,"/");for(;_.length%4;)_+="=";const C=JSON.parse(atob(_));return C.exp?Date.now()>=C.exp*1e3:!1}catch{return!0}};N.useEffect(()=>{(async()=>{try{const S=localStorage.getItem("token");if(!S||u(S)){r([]),a(!1);return}const _=await fetch(`${ke}/index.php?endpoint=orders`,{method:"GET",headers:{Authorization:`Bearer ${S}`}});if(_.status===401){r([]),a(!1);return}const C=await _.json();if(C&&C.success&&Array.isArray(C.data)){const E=C.data.map(A=>({id:A.id,orderNumber:A.id,description:A.notes||"",status:(A.status||"pending").toString().toLowerCase(),orderDate:A.order_date,totalAmount:Number(A.total??A.total_price??0),itemCount:Number(A.item_count||0),items:[],progress:(()=>{const T=(A.status||"").toString().toLowerCase();return T==="pending"?.25:T==="processing"?.5:T==="shipped"?.75:T==="delivered"||T==="completed"?1:0})()}));r(E)}else r([])}catch(S){console.error("Error loading orders:",S),r([])}finally{a(!1)}})()},[]);const d=k=>{switch(k){case"pending":return{color:"text-yellow-600",bgColor:"bg-yellow-100",icon:l(Co,{className:"w-4 h-4"})};case"processing":return{color:"text-blue-600",bgColor:"bg-blue-100",icon:l(nt,{className:"w-4 h-4"})};case"shipped":return{color:"text-purple-600",bgColor:"bg-purple-100",icon:l(iL,{className:"w-4 h-4"})};case"delivered":return{color:"text-green-600",bgColor:"bg-green-100",icon:l(At,{className:"w-4 h-4"})};case"completed":return{color:"text-green-600",bgColor:"bg-green-100",icon:l(At,{className:"w-4 h-4"})};case"cancelled":return{color:"text-red-600",bgColor:"bg-red-100",icon:l(ka,{className:"w-4 h-4"})};default:return{color:"text-gray-600",bgColor:"bg-gray-100",icon:l(ts,{className:"w-4 h-4"})}}},f=k=>{switch(k){case"pending":return"Pending Payment";case"processing":return"Processing";case"shipped":return"Shipped";case"delivered":return"Delivered";case"completed":return"Completed";case"cancelled":return"Cancelled";default:return"Unknown"}},m=k=>new Date(k).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),p=async k=>{try{const S=localStorage.getItem("token");if(!S||u(S))return;const _=await fetch(`${ke}/index.php?endpoint=orders&id=${k}`,{method:"GET",headers:{Authorization:`Bearer ${S}`}});if(_.status===401)return;const C=await _.json();if(C&&C.success&&C.data){const E=C.data,A=Array.isArray(E.items)?E.items.map(I=>({name:I.component_name||`Component #${I.component_id}`,category:I.category||"Component",price:Number(I.price||0),quantity:Number(I.quantity||1)})):[],T=A.reduce((I,z)=>I+(z.quantity||0),0),D={id:E.id,orderNumber:E.id,description:E.notes||"",status:(E.status||"pending").toString().toLowerCase(),orderDate:E.order_date,totalAmount:Number(E.total??E.total_price??0),itemCount:T,items:A,subtotal:A.reduce((I,z)=>I+z.price*z.quantity,0),shipping:0,tax:0,progress:(()=>{const I=(E.status||"").toString().toLowerCase();return I==="pending"?.25:I==="processing"?.5:I==="shipped"?.75:I==="delivered"||I==="completed"?1:0})()};s(D),c(!0)}}catch(S){console.error("Error loading order details:",S)}},x=async k=>{if(window.confirm("Are you sure you want to cancel this order?"))try{const S=localStorage.getItem("token");if(!S||u(S)){alert("Please log in to cancel orders");return}const _=await fetch(`${ke}/index.php?endpoint=orders&id=${k}&action=cancel`,{method:"GET",headers:{Authorization:`Bearer ${S}`}}),C=await _.json();if(!_.ok||!C.success)throw new Error(C.error||"Failed to cancel order");r(E=>E.map(A=>A.id===k?{...A,status:"cancelled",progress:0}:A)),alert("Order cancelled successfully.")}catch(S){console.error("Error cancelling order:",S),alert(`Failed to cancel order: ${S.message}`)}},g=async k=>{if(window.confirm("Are you sure you want to delete this order? This action cannot be undone. Inventory will be restored if applicable."))try{const S=localStorage.getItem("token");if(!S||u(S)){alert("Please log in to delete orders");return}const _=await fetch(`${ke}/index.php?endpoint=orders&id=${k}`,{method:"DELETE",headers:{Authorization:`Bearer ${S}`}}),C=await _.json();if(!_.ok||!C.success)throw new Error(C.error||"Failed to delete order");r(E=>E.filter(A=>A.id!==k)),i&&i.id===k&&(c(!1),s(null)),alert("Order deleted successfully.")}catch(S){console.error("Error deleting order:",S),alert(`Failed to delete order: ${S.message}`)}},y=k=>{const S=(k.status||"").toString().toLowerCase();return S==="pending"||S==="processing"},v=()=>h("div",{className:"flex flex-col items-center justify-center py-16 px-6",children:[l("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-6",children:l(vs,{className:"w-12 h-12 text-gray-400"})}),l("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No orders yet"}),l("p",{className:"text-gray-600 text-center max-w-md mb-8",children:"You haven't placed any orders yet. Once you purchase components, your order history will appear here."}),l("div",{className:"flex flex-col sm:flex-row gap-4 mb-8",children:h("button",{onClick:()=>e("pc-assembly"),className:"bg-green-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-700 transition-colors flex items-center gap-2",children:[l(wn,{className:"w-5 h-5"}),"Start Building"]})}),h("div",{className:"flex flex-col md:flex-row gap-6 w-full max-w-3xl justify-center items-stretch",children:[h("div",{className:"p-6 bg-blue-50 rounded-lg border border-blue-200 flex-1 mb-0",children:[h("div",{className:"flex items-center gap-3 mb-3",children:[l("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:l(nt,{className:"w-5 h-5 text-blue-600"})}),l("h4",{className:"font-semibold text-blue-900",children:"Component Orders"})]}),l("p",{className:"text-sm text-blue-800",children:"Purchase individual components from our partner retailers and track your orders here."})]}),h("div",{className:"p-6 bg-yellow-50 rounded-lg border border-yellow-200 flex-1 mt-6 md:mt-0",children:[l("h4",{className:"font-semibold text-yellow-900 mb-2",children:"How it works:"}),h("ul",{className:"text-sm text-yellow-800 space-y-1",children:[l("li",{children:"â€¢ Build your PC using our compatibility checker"}),l("li",{children:"â€¢ Purchase components from partner retailers"}),l("li",{children:"â€¢ Track your orders and shipping status"}),l("li",{children:"â€¢ Get notifications on order updates"})]})]})]})]}),b=({order:k})=>{const S=d(k.status),_=y(k);return l("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:h("div",{className:"p-6",children:[l("div",{className:"flex items-start justify-between mb-4",children:h("div",{className:"flex-1",children:[h("div",{className:"flex items-center gap-3 mb-2",children:[h("h3",{className:"text-lg font-semibold text-gray-900",children:["Order #",k.orderNumber]}),h("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full ${S.bgColor}`,children:[S.icon,l("span",{className:`text-sm font-medium ${S.color}`,children:f(k.status)})]})]}),l("p",{className:"text-sm text-gray-600 mb-2",children:k.description}),h("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[h("div",{className:"flex items-center gap-1",children:[l(Yd,{className:"w-4 h-4"}),m(k.orderDate)]}),l("div",{className:"flex items-center gap-1",children:it(k.totalAmount)}),h("div",{className:"flex items-center gap-1",children:[l(nt,{className:"w-4 h-4"}),k.itemCount," ",k.itemCount===1?"item":"items"]})]})]})}),h("div",{className:"mb-4",children:[h("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-2",children:[l("span",{children:"Order Progress"}),h("span",{children:[Math.round((k.progress||0)*100),"%"]})]}),l("div",{className:"w-full bg-gray-200 rounded-full h-2",children:l("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${(k.progress||0)*100}%`}})})]}),h("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-3 mb-4",children:[k.items.slice(0,3).map((C,E)=>h("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[l("div",{className:"text-xs font-medium text-gray-600 mb-1",children:C.category}),l("div",{className:"text-sm font-semibold text-gray-900 truncate",children:C.name}),l("div",{className:"text-xs text-gray-500",children:it(C.price)})]},E)),k.items.length>3&&l("div",{className:"text-center p-3 bg-gray-50 rounded-lg flex items-center justify-center",children:h("span",{className:"text-sm text-gray-500",children:["+",k.items.length-3," more"]})})]}),h("div",{className:"flex gap-3",children:[h("button",{onClick:()=>p(k.id),className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center justify-center gap-2",children:[l(hl,{className:"w-4 h-4"}),"View Details"]}),_&&h("button",{onClick:()=>x(k.id),className:"bg-red-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-red-700 transition-colors flex items-center justify-center gap-2",children:[l(oL,{className:"w-4 h-4"}),"Cancel Order"]}),h("button",{onClick:()=>g(k.id),className:"bg-gray-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-gray-700 transition-colors flex items-center justify-center gap-2",title:"Delete Order",children:[l(Hr,{className:"w-4 h-4"}),"Delete"]})]})]})})},w=({order:k,onClose:S})=>{if(!k)return null;const _=d(k.status);return l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[h("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[h("div",{className:"flex items-center gap-3",children:[l("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:l(nt,{className:"w-5 h-5 text-green-600"})}),h("div",{children:[h("h2",{className:"text-xl font-semibold text-gray-900",children:["Order #",k.orderNumber]}),l("p",{className:"text-sm text-gray-600",children:m(k.orderDate)})]})]}),l("button",{onClick:S,className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:l(Yr,{className:"w-5 h-5"})})]}),h("div",{className:"p-6",children:[l("div",{className:"mb-6",children:h("div",{className:`inline-flex items-center gap-2 px-4 py-2 rounded-full ${_.bgColor}`,children:[_.icon,l("span",{className:`font-medium ${_.color}`,children:f(k.status)})]})}),h("div",{className:"mb-6",children:[l("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Order Items"}),l("div",{className:"space-y-3",children:k.items.map((C,E)=>h("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[h("div",{className:"flex items-center gap-4",children:[l("div",{className:"w-12 h-12 bg-white rounded-lg flex items-center justify-center",children:l(nt,{className:"w-6 h-6 text-gray-600"})}),h("div",{children:[l("h4",{className:"font-medium text-gray-900",children:C.name}),l("p",{className:"text-sm text-gray-600",children:C.category})]})]}),h("div",{className:"text-right",children:[l("p",{className:"font-medium text-gray-900",children:it(C.price)}),h("p",{className:"text-sm text-gray-600",children:["Qty: ",C.quantity]})]})]},E))})]}),h("div",{className:"border-t pt-6",children:[l("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Order Summary"}),h("div",{className:"space-y-2",children:[h("div",{className:"flex justify-between",children:[l("span",{className:"text-gray-600",children:"Subtotal:"}),l("span",{className:"font-medium",children:it(k.subtotal)})]}),h("div",{className:"flex justify-between",children:[l("span",{className:"text-gray-600",children:"Shipping:"}),l("span",{className:"font-medium text-green-600",children:it(k.shipping)})]}),h("div",{className:"flex justify-between",children:[l("span",{className:"text-gray-600",children:"Tax:"}),l("span",{className:"font-medium",children:it(k.tax)})]}),h("div",{className:"flex justify-between text-lg font-semibold border-t pt-2",children:[l("span",{className:"text-gray-900",children:"Total:"}),l("span",{className:"text-green-600",children:it(k.totalAmount)})]})]})]})]}),l("div",{className:"border-t p-6 flex justify-end gap-3",children:h("button",{onClick:()=>{window.confirm("Are you sure you want to delete this order? This action cannot be undone. Inventory will be restored if applicable.")&&g(k.id)},className:"bg-gray-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-gray-700 transition-colors flex items-center gap-2",children:[l(Hr,{className:"w-4 h-4"}),"Delete Order"]})})]})})};return n?l("div",{className:"flex items-center justify-center h-64",children:h("div",{className:"text-center",children:[l("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),l("p",{className:"mt-4 text-gray-600",children:"Loading your orders..."})]})}):h("div",{className:"p-6",children:[h("div",{className:"mb-8",children:[l("div",{className:"flex items-center justify-between mb-4",children:h("div",{children:[l("h1",{className:"text-2xl font-bold text-gray-900",children:"My Orders"}),l("p",{className:"text-gray-600",children:"Track your component orders"})]})}),t.length>0&&h("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[h("span",{children:["Total orders: ",t.length]}),l("span",{children:"â€¢"}),h("span",{children:["Total spent: ",it(t.reduce((k,S)=>k+S.totalAmount,0))]})]})]}),t.length===0?l(v,{}):l("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:t.map(k=>l(b,{order:k},k.id))}),o&&i&&l(w,{order:i,onClose:()=>{c(!1),s(null)}})]})},pS=({setCurrentPage:e,user:t,onShowAuth:r})=>{const[n,a]=N.useState([]),[i,s]=N.useState(!0),[o,c]=N.useState(null),[u,d]=N.useState(0),[f,m]=N.useState(0),[p,x]=N.useState(new Set),[g,y]=N.useState({}),[v,b]=N.useState(new Set),[w,k]=N.useState(!1),[S,_]=N.useState(""),[C,E]=N.useState(""),[A,T]=N.useState(""),D=P=>{try{const q=P.split(".")[1];if(!q)return!0;let O=q.replace(/-/g,"+").replace(/_/g,"/");for(;O.length%4;)O+="=";const K=JSON.parse(atob(O));return K.exp?Date.now()>=K.exp*1e3:!1}catch{return!0}},I=async(P=!1)=>{try{const q=localStorage.getItem("token");if(!q||D(q)){a([]),s(!1),!t&&r&&r();return}const O=await fetch(`${ke}/index.php?endpoint=cart`,{method:"GET",headers:{Authorization:`Bearer ${q}`}});if(O.status===401){a([]),s(!1),r&&r();return}const K=await O.json();if(K&&K.success){const G=K.data||[];a(G),d(K.total||0),m(K.item_count||0);const te=new Set(G.map(M=>M.id));b(te),P&&K.cleanup_message&&alert(K.cleanup_message);const ce=G.filter(M=>M.item_type==="prebuilt"||M.prebuilt_id);if(ce.length>0){const M=ce.map(async je=>{if(!je.component_ids)return{prebuiltId:je.prebuilt_id,components:[]};let ze=je.component_ids;if(typeof ze=="string")try{ze=JSON.parse(ze)}catch{return{prebuiltId:je.prebuilt_id,components:[]}}const Ce=Object.values(ze).map(de=>typeof de=="string"?parseInt(de,10):de).filter(de=>Number.isFinite(de)&&de>0);if(Ce.length===0)return{prebuiltId:je.prebuilt_id,components:[]};try{const de=`${ke}/get_components_by_ids.php?ids=${Ce.join(",")}`,Re=await(await fetch(de)).json();if(Re.success&&Re.data)return{prebuiltId:je.prebuilt_id,components:Re.data}}catch(de){console.error("Error fetching prebuilt components:",de)}return{prebuiltId:je.prebuilt_id,components:[]}}),Le=await Promise.all(M),Te={};Le.forEach(({prebuiltId:je,components:ze})=>{je&&(Te[je]=ze)}),y(Te)}}else a([]),d(0),m(0)}catch(q){console.error("Error loading cart:",q),a([]),d(0),m(0)}finally{s(!1)}};N.useEffect(()=>{I()},[t]);const z=async(P,q)=>{if(q<1)return;const O=localStorage.getItem("token");if(!O||D(O)){r&&r();return}c(P);try{const K=await fetch(`${ke}/index.php?endpoint=cart`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${O}`},body:JSON.stringify({cart_item_id:P,quantity:q})}),G=await K.json();K.ok&&G.success?await I():alert(G.error||"Failed to update quantity")}catch(K){console.error("Error updating quantity:",K),alert("Failed to update quantity")}finally{c(null)}},X=async P=>{if(!window.confirm("Remove this item from cart?"))return;const q=localStorage.getItem("token");if(!q||D(q)){r&&r();return}c(P);try{const O=await fetch(`${ke}/index.php?endpoint=cart&id=${P}`,{method:"DELETE",headers:{Authorization:`Bearer ${q}`}}),K=await O.json();O.ok&&K.success?await I():alert(K.error||"Failed to remove item")}catch(O){console.error("Error removing item:",O),alert("Failed to remove item")}finally{c(null)}},H=async()=>{if(!window.confirm("Clear entire cart? This action cannot be undone."))return;const P=localStorage.getItem("token");if(!P||D(P)){r&&r();return}try{const q=await fetch(`${ke}/index.php?endpoint=cart&action=clear`,{method:"POST",headers:{Authorization:`Bearer ${P}`}}),O=await q.json();q.ok&&O.success?(a([]),d(0),m(0),b(new Set),alert("Cart cleared successfully")):alert(O.error||"Failed to clear cart")}catch(q){console.error("Error clearing cart:",q),alert("Failed to clear cart")}},L=async()=>{var q;const P=localStorage.getItem("token");if(!P||D(P)){r&&r();return}try{const O=await fetch(`${ke}/index.php?endpoint=cart&action=cleanup`,{method:"POST",headers:{Authorization:`Bearer ${P}`}}),K=await O.json();O.ok&&K.success?K.cleaned>0?(alert(`Cart cleaned! Converted ${K.cleaned} prebuilt(s) from individual components:
${((q=K.prebuilts)==null?void 0:q.join(", "))||""}`),await I()):alert("No prebuilts found to convert. Your cart is already up to date!"):alert(K.error||"Failed to cleanup cart")}catch(O){console.error("Error cleaning up cart:",O),alert("Failed to cleanup cart")}},W=P=>{b(q=>{const O=new Set(q);return O.has(P)?O.delete(P):O.add(P),O})},ie=()=>{const P=new Set(n.map(q=>q.id));b(P)},B=()=>{b(new Set)},ee=()=>{const P=n.filter(K=>v.has(K.id)),q=P.reduce((K,G)=>K+parseFloat(G.price)*parseInt(G.quantity),0),O=P.length;return{selectedTotal:q,selectedCount:O,selectedItems:P}},le=async()=>{if(n.length===0){alert("Cart is empty");return}const{selectedTotal:P,selectedCount:q,selectedItems:O}=ee();if(O.length===0){alert("Please select at least one item to checkout");return}const K=localStorage.getItem("token");if(!K||D(K)||!t){r&&r();return}T(""),k(!0)},R=P=>{if(!P)return!1;const q=P.replace(/[^\d]/g,"");return/^63\d{10}$/.test(q)},j=async()=>{const P=S.trim(),q=C.trim();if(P.length<2){T("Full name is required.");return}if(!R(q)){T("Enter a valid PH number starting with 63 and 10 digits after.");return}k(!1),T("");const{selectedTotal:O,selectedCount:K,selectedItems:G}=ee();if(window.confirm(`Checkout ${K} item(s) for ${it(O)}?

Contact: ${P} â€¢ ${q}`))try{const te=localStorage.getItem("token");if(!te||D(te)||!t){r&&r();return}const M=G.filter(Ce=>Ce.item_type==="prebuilt"||Ce.prebuilt_id).filter(Ce=>Ce.prebuilt_id?(g[Ce.prebuilt_id]||[]).length===0&&Ce.component_ids:!1),Le={...g};if(M.length>0){const Ce=M.map(async de=>{if(!de.component_ids)return null;let $e=de.component_ids;if(typeof $e=="string")try{$e=JSON.parse($e)}catch{return null}const Re=Object.values($e).map(Fe=>typeof Fe=="string"?parseInt(Fe,10):Fe).filter(Fe=>Number.isFinite(Fe)&&Fe>0);if(Re.length===0)return null;try{const Fe=`${ke}/get_components_by_ids.php?ids=${Re.join(",")}`,Ge=await(await fetch(Fe)).json();if(Ge.success&&Ge.data)return Le[de.prebuilt_id]=Ge.data,y(Qe=>({...Qe,[de.prebuilt_id]:Ge.data})),Ge.data}catch(Fe){console.error("Error fetching prebuilt components:",Fe)}return null});await Promise.all(Ce)}const Te=[];for(const Ce of G)if((Ce.item_type==="prebuilt"||Ce.prebuilt_id)&&Ce.prebuilt_id){const $e=Le[Ce.prebuilt_id]||[],Re=parseInt(Ce.quantity)||1;if($e.length===0){alert(`Cannot checkout: Prebuilt "${Ce.name||"Unknown"}" has no components loaded. Please refresh the page and try again.`);return}for(let Fe=0;Fe<Re;Fe++)$e.forEach(Me=>{Me&&Me.id&&Te.push({component_id:Me.id,quantity:1,unit_price:parseFloat(Me.price)||0})})}else Ce.component_id&&Te.push({component_id:Ce.component_id,quantity:parseInt(Ce.quantity)||1,unit_price:parseFloat(Ce.price)||0});if(Te.length===0){alert("No valid items to checkout. Please ensure prebuilts have components loaded.");return}const je=await fetch(`${ke}/index.php?endpoint=orders`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${te}`},body:JSON.stringify({user_id:t.id,status:"pending",items:Te,notes:`Contact: ${P} | Phone: ${q}`,customer_name:P,customer_phone:q})}),ze=await je.json();if(je.ok&&ze.success){const Ce=localStorage.getItem("token");if(Ce&&!D(Ce)){const de=G.map(async $e=>{try{return(await fetch(`${ke}/index.php?endpoint=cart&id=${$e.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${Ce}`}})).ok}catch(Re){return console.error("Error removing item from cart:",Re),!1}});await Promise.all(de),await I()}alert(`Order placed successfully! Order ID: #${ze.order_id}`),e&&e("my-orders")}else if(ze.out_of_stock_items&&Array.isArray(ze.out_of_stock_items)){const Ce=ze.out_of_stock_items.map(de=>de.available===0?`  â€¢ ${de.name} - Out of stock`:`  â€¢ ${de.name} - Requested: ${de.requested}, Available: ${de.available}`).join(`
`);alert(`${ze.error||"Insufficient stock"}

Out of stock components:
${Ce}`)}else alert(ze.error||"Failed to place order")}catch(te){console.error("Error checking out:",te),alert(`Failed to checkout: ${te.message}`)}},V=()=>h("div",{className:"flex flex-col items-center justify-center py-16 px-6",children:[l("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-6",children:l(vs,{className:"w-12 h-12 text-gray-400"})}),l("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Your cart is empty"}),l("p",{className:"text-gray-600 text-center max-w-md mb-8",children:"Start building your PC by selecting components and adding them to your cart."}),h("button",{onClick:()=>e("pc-assembly"),className:"bg-green-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-700 transition-colors flex items-center gap-2",children:[l(nt,{className:"w-5 h-5"}),"Build a PC"]})]});return i?l("div",{className:"flex items-center justify-center h-64",children:h("div",{className:"text-center",children:[l("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),l("p",{className:"mt-4 text-gray-600",children:"Loading your cart..."})]})}):n.length===0?h("div",{className:"p-6",children:[h("div",{className:"mb-8",children:[l("h1",{className:"text-3xl font-bold mb-1",children:"Shopping Cart"}),l("p",{className:"text-gray-600",children:"Manage your selected components"})]}),l(V,{})]}):h("div",{className:"p-6",children:[h("div",{className:"mb-8",children:[h("div",{className:"flex items-center justify-between mb-4",children:[h("div",{children:[l("h1",{className:"text-3xl font-bold mb-1",children:"Shopping Cart"}),h("p",{className:"text-gray-600",children:[f," item(s) in your cart"]})]}),n.length>0&&h("div",{className:"flex items-center gap-2",children:[h("button",{onClick:L,className:"px-4 py-2 text-blue-600 border border-blue-300 rounded-lg font-semibold hover:bg-blue-50 transition-colors flex items-center gap-2",title:"Convert individual prebuilt components to prebuilt items",children:[l(nt,{className:"w-4 h-4"}),"Fix Prebuilts"]}),h("button",{onClick:H,className:"px-4 py-2 text-red-600 border border-red-300 rounded-lg font-semibold hover:bg-red-50 transition-colors flex items-center gap-2",children:[l(Hr,{className:"w-4 h-4"}),"Clear Cart"]})]})]}),n.length>0&&h("div",{className:"flex items-center gap-4 mb-4",children:[l("button",{onClick:ie,className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Select All"}),l("button",{onClick:B,className:"text-sm text-gray-600 hover:text-gray-700 font-medium",children:"Deselect All"}),h("span",{className:"text-sm text-gray-500",children:[v.size," of ",n.length," item(s) selected"]})]})]}),h("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[l("div",{className:"lg:col-span-2 space-y-4",children:n.map(P=>{const q=P.item_type==="prebuilt"||P.prebuilt_id&&P.prebuilt_id>0||!P.component_id&&P.prebuilt_id,O=q&&P.prebuilt_id?g[P.prebuilt_id]||[]:[],K=p.has(P.id),G=v.has(P.id);return q?l("div",{className:`bg-gradient-to-br from-white to-green-50 border-2 rounded-xl p-6 hover:shadow-lg transition-all shadow-sm ${G?"border-green-600 ring-2 ring-green-200":"border-green-400"}`,children:h("div",{className:"flex gap-4",children:[l("div",{className:"flex items-start pt-1",children:l("input",{type:"checkbox",checked:G,onChange:()=>W(P.id),className:"w-5 h-5 text-green-600 border-gray-300 rounded focus:ring-green-500 focus:ring-2 cursor-pointer"})}),l("div",{className:"w-24 h-24 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0",children:P.image||P.image_url?l("img",{src:P.image||P.image_url,alt:P.name||"Prebuilt PC",className:"w-full h-full object-cover rounded-lg",onError:te=>{te.target.src="/placeholder-component.png"}}):l(nt,{className:"w-12 h-12 text-gray-400"})}),h("div",{className:"flex-1 min-w-0",children:[h("div",{className:"flex items-start justify-between mb-2",children:[h("div",{className:"flex-1",children:[h("div",{className:"flex items-center gap-2 mb-2",children:[h("span",{className:"inline-flex items-center px-3 py-1 rounded-full bg-gradient-to-r from-green-500 to-green-600 text-white text-xs font-bold uppercase tracking-wide shadow-sm",children:[l(nt,{className:"w-3 h-3 mr-1"}),"PREBUILT PC"]}),l("h3",{className:"text-xl font-bold text-gray-900",children:P.name})]}),P.category&&h("p",{className:"text-sm text-gray-500 mb-1",children:["Category: ",P.category]}),P.description&&l("p",{className:"text-sm text-gray-600 mb-2 line-clamp-2",children:P.description}),l("p",{className:"text-lg font-bold text-green-600 mt-2",children:it(P.price)})]}),l("button",{onClick:()=>X(P.id),disabled:o===P.id,className:"p-2 text-gray-400 hover:text-red-600 rounded-lg hover:bg-red-50 transition-colors",title:"Remove from cart",children:l(Yr,{className:"w-5 h-5"})})]}),l("div",{className:"mt-3 mb-3",children:O.length>0?l("button",{onClick:()=>{const te=new Set(p);K?te.delete(P.id):te.add(P.id),x(te)},className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-50 hover:bg-blue-100 text-blue-700 border border-blue-200 rounded-lg font-medium transition-colors",children:K?h(gt,{children:[l(cb,{className:"w-5 h-5"}),h("span",{children:["Hide Components (",O.length,")"]})]}):h(gt,{children:[l(Pf,{className:"w-5 h-5"}),h("span",{children:["View Components (",O.length,")"]})]})}):h("div",{className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-gray-50 text-gray-500 border border-gray-200 rounded-lg text-sm",children:[l(nt,{className:"w-4 h-4"}),l("span",{children:"Loading components..."})]})}),K&&O.length>0&&h("div",{className:"mt-3 mb-3 p-4 bg-gradient-to-br from-gray-50 to-blue-50 rounded-lg border-2 border-blue-200 shadow-sm",children:[h("h4",{className:"text-base font-bold text-gray-800 mb-3 flex items-center gap-2",children:[l(nt,{className:"w-5 h-5 text-blue-600"}),"Included Components (",O.length,")"]}),l("div",{className:"space-y-2.5",children:O.map((te,ce)=>h("div",{className:"flex items-center justify-between p-2 bg-white rounded-md border border-gray-200 hover:border-blue-300 transition-colors",children:[h("div",{className:"flex-1",children:[h("span",{className:"font-semibold text-blue-700 text-xs uppercase tracking-wide",children:[te.category||"Component",":"]}),l("span",{className:"text-sm text-gray-800 ml-2",children:te.name})]}),l("span",{className:"text-sm font-semibold text-gray-700 ml-4",children:it(te.price||0)})]},ce))})]}),h("div",{className:"flex items-center gap-3 mt-4",children:[l("span",{className:"text-sm text-gray-600",children:"Quantity:"}),h("div",{className:"flex items-center gap-2 border border-gray-300 rounded-lg",children:[l("button",{onClick:()=>z(P.id,parseInt(P.quantity)-1),disabled:o===P.id||parseInt(P.quantity)<=1,className:"p-2 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:l($k,{className:"w-4 h-4"})}),l("span",{className:"px-4 py-1 min-w-[3rem] text-center font-semibold",children:o===P.id?"...":P.quantity}),l("button",{onClick:()=>z(P.id,parseInt(P.quantity)+1),disabled:o===P.id,className:"p-2 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:l(wn,{className:"w-4 h-4"})})]})]})]}),h("div",{className:"text-right",children:[l("p",{className:"text-sm text-gray-500 mb-1",children:"Subtotal"}),l("p",{className:"text-xl font-bold text-gray-900",children:it(parseFloat(P.price)*parseInt(P.quantity))})]})]})},P.id):l("div",{className:`bg-white border rounded-xl p-6 hover:shadow-md transition-shadow ${G?"border-green-600 ring-2 ring-green-200":"border-gray-200"}`,children:h("div",{className:"flex gap-4",children:[l("div",{className:"flex items-start pt-1",children:l("input",{type:"checkbox",checked:G,onChange:()=>W(P.id),className:"w-5 h-5 text-green-600 border-gray-300 rounded focus:ring-green-500 focus:ring-2 cursor-pointer"})}),l("div",{className:"w-24 h-24 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0",children:l("img",{src:xr(P,P.component_id),alt:P.name||"Component",className:"w-full h-full object-cover rounded-lg",onError:te=>{te.target.src="/placeholder-component.png"}})}),h("div",{className:"flex-1 min-w-0",children:[h("div",{className:"flex items-start justify-between mb-2",children:[h("div",{children:[l("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:P.name}),(P.brand||P.model)&&l("p",{className:"text-sm text-gray-500",children:[P.brand,P.model].filter(Boolean).join(" â€¢ ")}),l("p",{className:"text-lg font-bold text-green-600 mt-2",children:it(P.price)}),P.stock_quantity&&parseInt(P.stock_quantity)<parseInt(P.quantity)&&h("p",{className:"text-sm text-red-600 mt-1 flex items-center gap-1",children:[l(ts,{className:"w-4 h-4"}),"Only ",P.stock_quantity," available"]})]}),l("button",{onClick:()=>X(P.id),disabled:o===P.id,className:"p-2 text-gray-400 hover:text-red-600 rounded-lg hover:bg-red-50 transition-colors",title:"Remove from cart",children:l(Yr,{className:"w-5 h-5"})})]}),h("div",{className:"flex items-center gap-3 mt-4",children:[l("span",{className:"text-sm text-gray-600",children:"Quantity:"}),h("div",{className:"flex items-center gap-2 border border-gray-300 rounded-lg",children:[l("button",{onClick:()=>z(P.id,parseInt(P.quantity)-1),disabled:o===P.id||parseInt(P.quantity)<=1,className:"p-2 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:l($k,{className:"w-4 h-4"})}),l("span",{className:"px-4 py-1 min-w-[3rem] text-center font-semibold",children:o===P.id?"...":P.quantity}),l("button",{onClick:()=>z(P.id,parseInt(P.quantity)+1),disabled:o===P.id||P.stock_quantity&&parseInt(P.stock_quantity)<parseInt(P.quantity)+1,className:"p-2 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:l(wn,{className:"w-4 h-4"})})]})]})]}),h("div",{className:"text-right",children:[l("p",{className:"text-sm text-gray-500 mb-1",children:"Subtotal"}),l("p",{className:"text-xl font-bold text-gray-900",children:it(parseFloat(P.price)*parseInt(P.quantity))})]})]})},P.id)})}),l("div",{className:"lg:col-span-1",children:h("div",{className:"bg-gradient-to-br from-gray-50 to-blue-50 rounded-xl p-6 border border-gray-200 sticky top-6",children:[l("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Order Summary"}),l("div",{className:"space-y-4 mb-6",children:(()=>{const{selectedTotal:P,selectedCount:q}=ee();return h(gt,{children:[h("div",{className:"flex items-center justify-between",children:[h("span",{className:"text-gray-600",children:["Items (",q," of ",f," selected)"]}),l("span",{className:"font-semibold text-gray-900",children:it(P)})]}),h("div",{className:"flex items-center justify-between text-sm",children:[l("span",{className:"text-gray-500",children:"Subtotal"}),l("span",{className:"text-gray-700",children:it(P)})]}),h("div",{className:"flex items-center justify-between text-sm",children:[l("span",{className:"text-gray-500",children:"Shipping"}),l("span",{className:"text-gray-700",children:"Calculated at checkout"})]}),l("div",{className:"border-t border-gray-300 pt-4",children:h("div",{className:"flex items-center justify-between",children:[l("span",{className:"text-lg font-bold text-gray-900",children:"Total"}),l("span",{className:"text-2xl font-bold text-green-600",children:it(P)})]})})]})})()}),h("button",{onClick:le,disabled:v.size===0,className:`w-full px-6 py-4 rounded-xl font-semibold text-lg transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105 flex items-center justify-center gap-2 ${v.size===0?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-gradient-to-r from-green-600 to-green-700 text-white hover:from-green-700 hover:to-green-800"}`,children:[l(At,{className:"w-5 h-5"}),"Proceed to Checkout",l(Qi,{className:"w-5 h-5"})]}),h("button",{onClick:()=>e("pc-assembly"),className:"w-full mt-4 border-2 border-gray-300 text-gray-700 px-6 py-3 rounded-xl font-semibold hover:bg-gray-50 transition-colors flex items-center justify-center gap-2",children:[l(nt,{className:"w-5 h-5"}),"Continue Shopping"]})]})})]}),w&&h("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[l("div",{className:"absolute inset-0 bg-black bg-opacity-50"}),h("div",{className:"relative bg-white w-full max-w-md mx-4 rounded-xl shadow-2xl border border-gray-200",children:[h("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[l("h3",{className:"text-lg font-bold text-gray-900",children:"Contact Information"}),l("button",{onClick:()=>k(!1),className:"p-2 rounded-md hover:bg-gray-100","aria-label":"Close",children:l(Yr,{className:"w-5 h-5 text-gray-600"})})]}),h("div",{className:"px-6 py-4 space-y-4",children:[h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full name"}),l("input",{type:"text",value:S,onChange:P=>_(P.target.value),placeholder:"Juan Dela Cruz",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500"})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Number (PH, starts with 63)"}),l("input",{type:"tel",value:C,onChange:P=>E(P.target.value),placeholder:"639XXXXXXXXX",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-500"}),l("p",{className:"mt-1 text-xs text-gray-500",children:"Example: 639171234567"})]}),A&&h("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[l(ts,{className:"w-4 h-4"}),l("span",{children:A})]})]}),h("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end gap-3",children:[l("button",{onClick:()=>k(!1),className:"px-4 py-2 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-50",children:"Cancel"}),l("button",{onClick:j,className:"px-4 py-2 rounded-lg bg-green-600 text-white font-semibold hover:bg-green-700",children:"Proceed"})]})]})]})]})},nj=`${ke}/prebuilts.php`,qo={cpu:["cpu","processor","procie","procie only","processor only"],motherboard:["motherboard","mobo"],gpu:["gpu","graphics","graphics card","video","video card","vga"],ram:["ram","memory","ram 3200mhz","ddr","ddr4","ddr5"],storage:["storage","ssd","nvme","ssd nvme","hdd","hard drive","drive"],psu:["psu","power supply","psu - tr","tr psu"],case:["case","chassis","case gaming"],cooler:["cooler","coolers","aio","cooling","cpu cooler","water cooling","liquid cooler","fan","heatsink"]};async function aj(e){if(!e||typeof e!="object")return{};const t=Object.values(e).map(i=>typeof i=="string"?parseInt(i,10):i).filter(i=>Number.isFinite(i)&&i>0);if(t.length===0)return{};const r=`${ke}/get_components_by_ids.php?ids=${t.join(",")}`,a=await(await fetch(r)).json();if(a.success&&a.data){const i={};return a.data.forEach(s=>{const o=Object.keys(e).find(c=>e[c]==s.id);o&&(i[o]=s)}),i}return{}}async function I0(e,t={}){const n={cpu:"CPU",motherboard:"Motherboard",gpu:"GPU",ram:"RAM",storage:"Storage",psu:"PSU",case:"Case",cooler:"Cooler"}[e];if(!n)return null;try{const a=An("components",{category:n,only_in_stock:"1"}),s=await(await fetch(a)).json();if(!s.success||!Array.isArray(s.data)||s.data.length===0)return null;const o=s.data.slice();return o.sort((c,u)=>(Number(c.price)||0)-(Number(u.price)||0)),o[0]||null}catch{return null}}const gS=({setCurrentPage:e,setSelectedComponents:t,onPrebuiltSelect:r,user:n})=>{const[a,i]=N.useState([]),[s,o]=N.useState("all"),[c,u]=N.useState("all"),[d,f]=N.useState(""),[m,p]=N.useState("name"),[x,g]=N.useState(!0),[y,v]=N.useState(null),[b,w]=N.useState("all"),[k,S]=N.useState([]),[_,C]=N.useState(!0),[E,A]=N.useState(null),[T,D]=N.useState(""),[I,z]=N.useState("newest"),[X,H]=N.useState("all"),[L,W]=N.useState("prebuilts"),[ie,B]=N.useState([]),[ee,le]=N.useState(!1),[R,j]=N.useState(null),[V,P]=N.useState({}),[q,O]=N.useState(""),[K,G]=N.useState(!1),te=async Y=>{try{const ve=Y.component_ids||Y.componentIds||{};if(!ve||typeof ve!="object"||Object.keys(ve).length===0)return Y.price||0;const Je=Object.values(ve).map(Ie=>typeof Ie=="string"?parseInt(Ie,10):Ie).filter(Ie=>Number.isFinite(Ie)&&Ie>0);if(Je.length===0)return Y.price||0;const pt=`${ke}/get_components_by_ids.php?ids=${Je.join(",")}`,De=await(await fetch(pt)).json();if(De.success&&Array.isArray(De.data)){const Ie=De.data.reduce((Ye,Oe)=>{const at=typeof Oe.price=="number"?Oe.price:parseFloat(Oe.price)||0;return Ye+at},0);return Ie>0?Ie:Y.price||0}}catch(ve){console.error("Error recalculating price:",ve)}return Y.price||0},ce=async Y=>{try{const ve=Y.component_ids||Y.componentIds||{};if(!ve||typeof ve!="object"||Object.keys(ve).length===0)return{available:!1,reason:"No components",outOfStockComponents:[]};const Je=Object.values(ve).map(Ie=>typeof Ie=="string"?parseInt(Ie,10):Ie).filter(Ie=>Number.isFinite(Ie)&&Ie>0);if(Je.length===0)return{available:!1,reason:"Invalid component IDs",outOfStockComponents:[]};const pt=`${ke}/get_components_by_ids.php?ids=${Je.join(",")}`,De=await(await fetch(pt)).json();if(De.success&&Array.isArray(De.data)){const Ie=[];let Ye=!0;return De.data.forEach(Oe=>{const at=Oe.stock_quantity||Oe.stock||0;at<=0&&(Ye=!1,Ie.push({id:Oe.id,name:Oe.name,stock:at}))}),{available:Ye,reason:Ie.length>0?`${Ie.length} component(s) out of stock`:"All components available",outOfStockComponents:Ie}}}catch(ve){return console.error("Error checking prebuilt availability:",ve),{available:!1,reason:"Error checking availability",outOfStockComponents:[]}}return{available:!0,reason:"Could not verify",outOfStockComponents:[]}};N.useEffect(()=>{(async()=>{g(!0),v(null);try{const Je=await(await fetch(`${nj}`)).json();if(Array.isArray(Je)){const pt=await Promise.all(Je.map(async fe=>{const De=await te(fe),Ie=await ce(fe);return{...fe,price:De,stockAvailable:Ie.available,stockReason:Ie.reason,outOfStockComponents:Ie.outOfStockComponents}}));i(pt)}else i([])}catch{v("Failed to fetch prebuilts."),i([])}g(!1)})()},[]),N.useEffect(()=>{(async()=>{C(!0);try{const Je=await(await fetch(`${ke}/index.php?endpoint=builds&public=1`)).json();Je.success?S(Je.data):S([])}catch(ve){console.error("Error fetching public builds:",ve),S([])}finally{C(!1)}})()},[]),N.useEffect(()=>{we()&&(pe(),me())},[n]);const M=Y=>{const ve=Te(Y);return ve==="amd"?l("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full bg-red-100 text-red-700 text-xs font-semibold",children:"AMD"}):ve==="intel"?l("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full bg-blue-100 text-blue-700 text-xs font-semibold",children:"Intel"}):l("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full bg-gray-100 text-gray-700 text-xs font-semibold",children:"Mixed"})},Le=Y=>{const ve=`${Y.name||""} ${Y.description||""}`,Je=ve.match(/(R[3579] \d{3,4}X?|Ryzen\s?\d|i[3579]-?\d{3,5}|Intel\s?Core\s?i[3579]-?\d{3,5})/i),pt=ve.match(/(RTX\s?\d{3,4}|GTX\s?\d{3,4}|RX\s?\d{3,4}|Arc\s?\w+|IGPU)/i),fe=ve.match(/(\d{2,3})\s?GB\s?(DDR\d)?/i),De=ve.match(/(\d(?:\.\d)?\s?TB|\d{3,4}\s?GB)\s?(NVME|SSD|HDD)?/i);return{cpu:Je?Je[0]:null,gpu:pt?pt[0]:null,ram:fe?`${fe[1]}GB`:null,storage:De?De[0].replace(/\s+/g," "):null}},Te=Y=>{if(Y.brand){const Je=String(Y.brand).toLowerCase();if(Je.includes("amd"))return"amd";if(Je.includes("intel"))return"intel"}const ve=`${Y.name||""} ${Y.description||""}`.toLowerCase();return ve.includes("amd")||ve.includes("ryzen")?"amd":ve.includes("intel")||ve.includes("core i")?"intel":"other"},je=[{id:"all",name:"All PCs",count:a.length},...Array.from(new Set(a.map(Y=>Y.category))).filter(Boolean).map(Y=>({id:Y,name:Y.charAt(0).toUpperCase()+Y.slice(1),count:a.filter(ve=>ve.category===Y).length}))],ze=[{id:"all",name:"All Brands",count:a.length},{id:"amd",name:"AMD Builds",count:a.filter(Y=>Te(Y)==="amd").length},{id:"intel",name:"Intel Builds",count:a.filter(Y=>Te(Y)==="intel").length}];a.filter(Y=>s==="all"||Y.category===s).filter(Y=>c==="all"||Te(Y)===c).filter(Y=>Y.name&&Y.name.toLowerCase().includes(d.toLowerCase())).sort((Y,ve)=>{switch(m){case"price":return Y.price-ve.price;case"name":return Y.name.localeCompare(ve.name);default:return 0}});const Ce=async Y=>{try{if(Y.stockAvailable===!1){const at=Y.outOfStockComponents&&Y.outOfStockComponents.length>0?Y.outOfStockComponents.map(Nr=>`- ${Nr.name}`).join(`
`):"",Gr=`This prebuilt is currently unavailable due to out-of-stock components.

${Y.stockReason||"Some components are out of stock."}${at?`

Out of stock components:
${at}`:""}

You can still view the build, but you won't be able to place an order until all components are back in stock.`;if(!confirm(Gr+`

Do you want to view the build anyway?`))return}let ve={};if(Y.component_ids)if(typeof Y.component_ids=="string")try{ve=JSON.parse(Y.component_ids)}catch{alert("This prebuilt has invalid component data and cannot be loaded. Please contact support or try another prebuilt.");return}else ve=Y.component_ids;else Y.componentIds&&(ve=Y.componentIds);if(!ve||Object.keys(ve).length===0){alert("This prebuilt has no components and cannot be loaded.");return}const Je=await aj(ve);if(!Je||Object.keys(Je).length===0){alert("The components for this prebuilt could not be found.");return}const pt={},fe=Object.keys(Je).reduce((at,Gr)=>(at[Gr.toLowerCase()]=Je[Gr],at),{});Object.entries(qo).forEach(([at,Gr])=>{for(const Nr of Gr)if(fe[Nr]){pt[at]=fe[Nr];break}}),Object.keys(Je).forEach(at=>{qo[at]&&(pt[at]=Je[at])});const De=Object.keys(ve||{}).map(at=>String(at).toLowerCase());if((qo.cooler||[]).some(at=>De.includes(at))&&!pt.cooler){const at=await I0("cooler");at&&(pt.cooler=at)}const Oe=["cpu","motherboard","gpu","ram","storage","psu","case"].filter(at=>!pt[at]);Oe.length>0&&(await Promise.all(Oe.map(Gr=>I0(Gr)))).forEach((Gr,Nr)=>{Gr&&(pt[Oe[Nr]]=Gr)});try{localStorage.setItem("builditpc-selected-components",JSON.stringify(pt)),localStorage.setItem("builditpc-editing-build",JSON.stringify({name:(Y.name||"Prebuilt")+" (Prebuilt)",description:Y.description||""}))}catch{}r?r(pt):(t&&t(pt),e("pc-assembly"))}catch(ve){console.error("Error loading prebuilt components:",ve),alert("Error loading prebuilt components. Please try again.")}},de=async(Y,ve)=>{Y.stopPropagation();const Je=localStorage.getItem("token");if(!Je||!n){alert("Please log in to add items to cart"),onShowAuth&&onShowAuth();return}if(ve.stockAvailable===!1||!(ve.in_stock||ve.inStock)){alert("This prebuilt is currently out of stock and cannot be added to cart.");return}try{const pt=await fetch(`${ke}/index.php?endpoint=cart`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Je}`},body:JSON.stringify({prebuilt_id:ve.id,quantity:1})}),fe=await pt.json();pt.ok&&fe.success?alert("Prebuilt PC added to cart successfully!"):alert(fe.error||"Failed to add prebuilt to cart")}catch(pt){console.error("Add prebuilt to cart failed:",pt),alert(`Failed to add prebuilt to cart: ${pt.message}`)}},$e=Y=>{switch(Y){case"gaming":return l(rs,{className:"w-5 h-5"});case"workstation":return l(db,{className:"w-5 h-5"});case"cooling":return l(Rs,{className:"w-5 h-5"});default:return l(nt,{className:"w-5 h-5"})}},Re=Y=>new Date(Y).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),Fe=Y=>Y>=90?{status:"Excellent",color:"text-green-600",bgColor:"bg-green-100",icon:l(At,{className:"w-4 h-4"})}:Y>=70?{status:"Good",color:"text-yellow-600",bgColor:"bg-yellow-100",icon:l(ts,{className:"w-4 h-4"})}:{status:"Issues",color:"text-red-600",bgColor:"bg-red-100",icon:l(ts,{className:"w-4 h-4"})},Me=Y=>{const ve=Number(Y);return isNaN(ve)?0:ve},Ge=async Y=>{let ve={};Array.isArray(Y.components)?Y.components.forEach(Ye=>{Ye&&Ye.category&&(ve[Ye.category.toLowerCase()]=Ye)}):Y.components&&typeof Y.components=="object"&&(Object.keys(Y.components).every(Oe=>!isNaN(Number(Oe)))?Object.values(Y.components).forEach(Oe=>{Oe&&Oe.category&&(ve[Oe.category.toLowerCase()]=Oe)}):ve={...Y.components});const Je={},pt=Object.keys(ve).reduce((Ye,Oe)=>(Ye[Oe.toLowerCase()]=ve[Oe],Ye),{});Object.entries(qo).forEach(([Ye,Oe])=>{for(const at of Oe)if(pt[at]){Je[Ye]=pt[at];break}}),Object.keys(ve).forEach(Ye=>{qo[Ye]&&(Je[Ye]=ve[Ye])});const De=["cpu","motherboard","gpu","ram","storage","psu","case"].filter(Ye=>!Je[Ye]);De.length>0&&(await Promise.all(De.map(Oe=>I0(Oe)))).forEach((Oe,at)=>{Oe&&(Je[De[at]]=Oe)});let Ie=!1;if(Array.isArray(Y.components))Ie=Y.components.some(Ye=>{const Oe=((Ye==null?void 0:Ye.category)||"").toLowerCase();return(qo.cooler||[]).some(at=>Oe.includes(at))});else if(Y.components&&typeof Y.components=="object"){const Ye=Object.keys(Y.components).map(Oe=>Oe.toLowerCase());Ie=(qo.cooler||[]).some(Oe=>Ye.includes(Oe))}if(Ie&&!Je.cooler){const Ye=await I0("cooler");Ye&&(Je.cooler=Ye)}try{localStorage.setItem("builditpc-selected-components",JSON.stringify(Je)),localStorage.setItem("builditpc-editing-build",JSON.stringify({name:Y.name+" (Copy)",description:Y.description+" - Shared by "+Y.creator_name}))}catch{}typeof t=="function"&&t(Je),e("pc-assembly")},Qe=Y=>{const ve=`${window.location.origin}/prebuilt-pcs?build=${Y}`;navigator.clipboard.writeText(ve).then(()=>{alert("Build link copied to clipboard!")})},we=()=>!n||!n.roles?!1:(Array.isArray(n.roles)?n.roles:n.roles.split(",").map(ve=>ve.trim())).some(ve=>["Admin","Super Admin","Employee"].includes(ve)),pe=async()=>{if(we()){le(!0);try{const Y=localStorage.getItem("token"),Je=await(await fetch(`${ke}/index.php?endpoint=community_management&action=submissions`,{headers:{Authorization:`Bearer ${Y}`}})).json();Je.success&&B(Je.data)}catch(Y){console.error("Error fetching community submissions:",Y)}finally{le(!1)}}},me=async()=>{if(we())try{const Y=localStorage.getItem("token"),Je=await(await fetch(`${ke}/index.php?endpoint=community_management&action=stats`,{headers:{Authorization:`Bearer ${Y}`}})).json();if(Je.success){const pt={};Je.data.forEach(fe=>{pt[fe.status]=fe.count}),P(pt)}}catch(Y){console.error("Error fetching submission stats:",Y)}},Ae=async(Y,ve)=>{G(!0);try{const Je=localStorage.getItem("token"),fe=await(await fetch(`${ke}/index.php?endpoint=community_management&action=review`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Je}`},body:JSON.stringify({submission_id:Y,status:ve,admin_notes:q})})).json();fe.success?(alert(`Submission ${ve} successfully!`),j(null),O(""),pe(),me()):alert("Error reviewing submission: "+(fe.error||"Unknown error"))}catch(Je){console.error("Error reviewing submission:",Je),alert("Error reviewing submission. Please try again.")}finally{G(!1)}},Ke=async(Y,ve)=>{if(confirm(`Are you sure you want to delete the submission "${ve}"? This action cannot be undone.`))try{const Je=localStorage.getItem("token"),fe=await(await fetch(`${ke}/index.php?endpoint=community_management&action=delete`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Je}`},body:JSON.stringify({submission_id:Y})})).json();fe.success?(alert("Submission deleted successfully!"),pe(),me()):alert("Error deleting submission: "+(fe.error||"Unknown error"))}catch(Je){console.error("Error deleting submission:",Je),alert("Error deleting submission. Please try again.")}},He=async(Y,ve)=>{try{await fetch(`${ke}/update_build_compatibility.php`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({build_id:Y,compatibility:ve})})}catch{}},qe=k.filter(Y=>Y.name.toLowerCase().includes(T.toLowerCase())||Y.description.toLowerCase().includes(T.toLowerCase())||Y.creator_name.toLowerCase().includes(T.toLowerCase())).map(Y=>{try{const ve=typeof Y.compatibility=="number"&&Y.compatibility>0,Je=Array.isArray(Y.components)?Y.components:Object.values(Y.components||{});if(!ve&&Je.length>0){const pt={cpu:["cpu","processor","procie"],motherboard:["motherboard","mobo"],gpu:["gpu","graphics card","graphics","video card","vga"],ram:["ram","memory"],storage:["storage","ssd","hdd","nvme"],psu:["psu","power supply"],case:["case","chassis"],cooler:["cooler","cooling","aio"]},fe={};Je.forEach(Ie=>{const Ye=String((Ie==null?void 0:Ie.category)||"").toLowerCase(),Oe=Object.keys(pt).find(at=>at===Ye||pt[at].some(Gr=>Ye.includes(Gr)));Oe&&(fe[Oe]=Ie)});const De=Jd(fe);if(De&&typeof De.score=="number"){const Ie={...Y,compatibility:De.score};return Y.id&&He(Y.id,De.score),Ie}}}catch{}return Y}).filter(Y=>{const ve=Me(Y.totalPrice);switch(X){case"under-50k":return ve<5e4;case"50k-100k":return ve>=5e4&&ve<1e5;case"100k-200k":return ve>=1e5&&ve<2e5;case"over-200k":return ve>=2e5;default:return!0}}).sort((Y,ve)=>{switch(I){case"newest":return new Date(ve.createdAt)-new Date(Y.createdAt);case"oldest":return new Date(Y.createdAt)-new Date(ve.createdAt);case"price-low":return Me(Y.totalPrice)-Me(ve.totalPrice);case"price-high":return Me(ve.totalPrice)-Me(Y.totalPrice);case"compatibility":return ve.compatibility-Y.compatibility;default:return 0}}),xt=Y=>{if(typeof Y=="number"&&Number.isFinite(Y))return Y;if(typeof Y=="string"){const ve=Y.replace(/[^0-9.\-]/g,""),Je=Number(ve);return Number.isFinite(Je)?Je:0}return 0},dt=a.filter(Y=>s==="all"||Y.category===s).filter(Y=>c==="all"||Te(Y)===c).filter(Y=>Y.name.toLowerCase().includes(d.toLowerCase())).filter(Y=>{const ve=xt(Y.price);switch(b){case"under-50k":return ve<5e4;case"50k-100k":return ve>=5e4&&ve<1e5;case"100k-200k":return ve>=1e5&&ve<2e5;case"over-200k":return ve>=2e5;default:return!0}}).sort((Y,ve)=>m==="price-asc"?xt(Y.price)-xt(ve.price):m==="price-desc"?xt(ve.price)-xt(Y.price):String(Y.name).localeCompare(String(ve.name)));return h("div",{className:"min-h-screen bg-gray-50",children:[l("div",{className:"bg-white shadow-sm border-b border-gray-200",children:h("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[h("div",{className:"text-center",children:[l("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Prebuilt PC Systems"}),l("p",{className:"text-lg text-gray-600 max-w-3xl mx-auto",children:"Expertly curated PC configurations using real components from our inventory."})]}),l("div",{className:"flex justify-center mt-8",children:h("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[h("button",{onClick:()=>W("prebuilts"),className:`px-6 py-3 rounded-md font-medium transition-colors flex items-center gap-2 ${L==="prebuilts"?"bg-white text-green-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[l(nt,{className:"w-5 h-5"}),"Prebuilt PCs"]}),h("button",{onClick:()=>W("community"),className:`px-6 py-3 rounded-md font-medium transition-colors flex items-center gap-2 ${L==="community"?"bg-white text-green-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[l(Df,{className:"w-5 h-5"}),"PC Build Sharing"]}),we()&&h("button",{onClick:()=>W("management"),className:`px-6 py-3 rounded-md font-medium transition-colors flex items-center gap-2 ${L==="management"?"bg-white text-green-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[l(kd,{className:"w-5 h-5"}),"PC Build Sharing",V.pending>0&&l("span",{className:"ml-1 bg-red-500 text-white text-xs px-2 py-0.5 rounded-full",children:V.pending})]})]})})]})}),h("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[L==="prebuilts"&&h(gt,{children:[h("div",{className:"card mb-8",children:[h("div",{className:"flex flex-col lg:flex-row gap-4",children:[h("div",{className:"flex-1 relative",children:[l(Di,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),l("input",{type:"text",placeholder:"Search prebuilt PCs...",value:d,onChange:Y=>f(Y.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),h("select",{value:m,onChange:Y=>p(Y.target.value),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[l("option",{value:"name",children:"Sort by Name"}),l("option",{value:"price-asc",children:"Price: Low to High"}),l("option",{value:"price-desc",children:"Price: High to Low"})]})]}),h("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4 mt-6",children:[h("div",{children:[l("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Categories"}),l("div",{className:"flex flex-wrap gap-2",children:je.map(Y=>h("button",{onClick:()=>o(Y.id),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center ${s===Y.id?"bg-green-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[$e(Y.id),l("span",{className:"ml-2",children:Y.name}),l("span",{className:"ml-2 bg-white bg-opacity-20 px-2 py-0.5 rounded-full text-xs",children:Y.count})]},Y.id))})]}),h("div",{children:[l("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Brands"}),l("div",{className:"flex flex-wrap gap-2",children:ze.map(Y=>h("button",{onClick:()=>u(Y.id),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center ${c===Y.id?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[l(Ra,{className:"w-5 h-5"}),l("span",{className:"ml-2",children:Y.name}),l("span",{className:"ml-2 bg-white bg-opacity-20 px-2 py-0.5 rounded-full text-xs",children:Y.count})]},Y.id))})]})]})]}),h("div",{className:"card mb-6 p-4 grid grid-cols-1 md:grid-cols-3 gap-4",children:[h("div",{children:[l("label",{className:"block text-sm text-gray-600 mb-1",children:"Sort"}),h("select",{value:m,onChange:Y=>p(Y.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[l("option",{value:"name",children:"Name"}),l("option",{value:"price-asc",children:"Price: Low to High"}),l("option",{value:"price-desc",children:"Price: High to Low"})]})]}),h("div",{children:[l("label",{className:"block text-sm text-gray-600 mb-1",children:"Price Range"}),h("select",{value:b,onChange:Y=>w(Y.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[l("option",{value:"all",children:"All"}),l("option",{value:"under-50k",children:"Under â‚±50,000"}),l("option",{value:"50k-100k",children:"â‚±50,000 - â‚±100,000"}),l("option",{value:"100k-200k",children:"â‚±100,000 - â‚±200,000"}),l("option",{value:"over-200k",children:"Over â‚±200,000"})]})]})]}),h("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[x&&Array.from({length:6}).map((Y,ve)=>h("div",{className:"card p-6 animate-pulse",children:[l("div",{className:"h-5 w-2/3 bg-gray-200 rounded mb-3"}),l("div",{className:"h-4 w-full bg-gray-100 rounded mb-2"}),l("div",{className:"h-4 w-5/6 bg-gray-100 rounded mb-2"}),l("div",{className:"h-4 w-1/2 bg-gray-100 rounded"})]},`s-${ve}`)),!x&&dt.length===0&&l("div",{className:"col-span-full",children:h("div",{className:"card p-8 text-center text-gray-600",children:[l(nt,{className:"w-10 h-10 text-gray-400 mx-auto mb-2"}),"No results found"]})}),!x&&dt.map(Y=>h("div",{onClick:()=>Ce(Y),className:"card relative cursor-pointer hover:border-green-300",children:[h("div",{className:"absolute top-4 left-4 flex gap-2",children:[(!(Y.in_stock||Y.inStock)||Y.stockAvailable===!1)&&l("span",{className:"bg-red-500 text-white px-2 py-1 rounded-full text-xs font-medium",title:Y.stockReason||"This prebuilt is currently unavailable",children:"OUT OF STOCK"}),Y.stockAvailable===!0&&(Y.in_stock||Y.inStock)&&l("span",{className:"bg-green-500 text-white px-2 py-1 rounded-full text-xs font-medium",children:"IN STOCK"})]}),l("div",{className:"absolute top-4 right-4 bg-green-600 text-white p-2 rounded-full opacity-0 hover:opacity-100 transition-opacity",children:l(Qi,{className:"w-4 h-4"})}),h("div",{className:"p-6",children:[h("div",{className:"flex items-start justify-between gap-2 mb-2",children:[l("h2",{className:"text-xl font-bold text-gray-900",children:Y.name}),M(Y)]}),l("div",{className:"text-gray-600 mb-2",children:Y.description}),(()=>{const ve=Le(Y);return h("div",{className:"flex flex-wrap gap-2 mb-3",children:[ve.cpu&&h("span",{className:"inline-flex items-center px-2 py-1 rounded bg-gray-100 text-gray-800 text-xs",children:["CPU: ",ve.cpu]}),ve.gpu&&h("span",{className:"inline-flex items-center px-2 py-1 rounded bg-gray-100 text-gray-800 text-xs",children:["GPU: ",ve.gpu]}),ve.ram&&h("span",{className:"inline-flex items-center px-2 py-1 rounded bg-gray-100 text-gray-800 text-xs",children:["RAM: ",ve.ram]}),ve.storage&&h("span",{className:"inline-flex items-center px-2 py-1 rounded bg-gray-100 text-gray-800 text-xs",children:["Storage: ",ve.storage]})]})})(),h("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-600 mb-4",children:[h("li",{className:"flex items-center gap-1",children:[l(aL,{className:"w-4 h-4 text-green-500"}),l("span",{className:"font-medium",children:"Category:"})," ",Y.category]}),h("li",{className:"flex items-center gap-1",children:[l(H8,{className:"w-4 h-4 text-green-500"}),l("span",{className:"font-medium",children:"Price:"})," ",it(Y.price,{minimumFractionDigits:0,maximumFractionDigits:0})]})]}),h("button",{onClick:ve=>de(ve,Y),disabled:Y.stockAvailable===!1||!(Y.in_stock||Y.inStock),className:"w-full bg-green-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-green-700 transition-colors flex items-center justify-center gap-2 disabled:bg-gray-400 disabled:cursor-not-allowed",title:Y.stockAvailable===!1?"This prebuilt is out of stock":"Add to cart",children:[l(vs,{className:"w-4 h-4"}),"Add to Cart"]})]})]},Y.id))]})]}),L==="community"&&h("div",{children:[h("div",{className:"mb-8",children:[h("div",{className:"flex items-center justify-between mb-4",children:[h("div",{children:[l("h2",{className:"text-2xl font-bold mb-1",children:"PC Build Sharing"}),l("p",{className:"text-gray-600",children:"Discover and get inspired by PC builds shared by the community"})]}),h("div",{className:"flex gap-3",children:[h("button",{onClick:()=>e("my-builds"),className:"border-2 border-gray-300 text-gray-700 px-5 py-2 rounded-lg font-semibold hover:bg-gray-50 transition-colors flex items-center gap-2",children:[l(hl,{className:"w-5 h-5"})," My Builds"]}),h("button",{onClick:()=>e("pc-assembly"),className:"bg-green-600 text-white px-5 py-2 rounded-lg font-semibold hover:bg-green-700 transition-colors flex items-center gap-2",children:[l(nt,{className:"w-5 h-5"})," Create Build"]})]})]}),k.length>0&&h("div",{className:"mb-6 text-gray-700 text-lg",children:["Total builds: ",qe.length," Â  â€¢ Â  Total value: ",it(qe.reduce((Y,ve)=>Y+Me(ve.totalPrice),0))]})]}),k.length>0&&l("div",{className:"card mb-6 p-4",children:h("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[h("div",{className:"relative",children:[l(Di,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),l("input",{type:"text",placeholder:"Search builds, creators...",value:T,onChange:Y=>D(Y.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),h("select",{value:I,onChange:Y=>z(Y.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[l("option",{value:"newest",children:"Newest First"}),l("option",{value:"oldest",children:"Oldest First"}),l("option",{value:"price-low",children:"Price: Low to High"}),l("option",{value:"price-high",children:"Price: High to Low"}),l("option",{value:"compatibility",children:"Best Compatibility"})]}),h("select",{value:X,onChange:Y=>H(Y.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[l("option",{value:"all",children:"All Prices"}),l("option",{value:"under-50k",children:"Under â‚±50,000"}),l("option",{value:"50k-100k",children:"â‚±50,000 - â‚±100,000"}),l("option",{value:"100k-200k",children:"â‚±100,000 - â‚±200,000"}),l("option",{value:"over-200k",children:"Over â‚±200,000"})]}),h("div",{className:"text-sm text-gray-600 flex items-center justify-center",children:[qe.length," of ",k.length," builds"]})]})}),_?l("div",{className:"flex items-center justify-center h-64",children:h("div",{className:"text-center",children:[l("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),l("p",{className:"mt-4 text-gray-600",children:"Loading PC builds..."})]})}):k.length===0?h("div",{className:"flex flex-col items-center justify-center py-16 px-6",children:[l("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-6",children:l(Zh,{className:"w-12 h-12 text-gray-400"})}),l("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No public builds yet"}),l("p",{className:"text-gray-600 text-center max-w-md mb-8",children:"Be the first to share your PC build with the community! Create a build and make it public to inspire others."}),h("div",{className:"flex flex-col sm:flex-row gap-4",children:[h("button",{onClick:()=>e("pc-assembly"),className:"bg-green-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-700 transition-colors flex items-center gap-2",children:[l(nt,{className:"w-5 h-5"}),"Create Your Build"]}),h("button",{onClick:()=>e("my-builds"),className:"border-2 border-gray-300 text-gray-700 px-6 py-3 rounded-lg font-semibold hover:bg-gray-50 transition-colors flex items-center gap-2",children:[l(hl,{className:"w-5 h-5"}),"View My Builds"]})]})]}):qe.length===0?h("div",{className:"text-center py-16",children:[l("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6",children:l(Di,{className:"w-12 h-12 text-gray-400"})}),l("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No builds found"}),l("p",{className:"text-gray-600",children:"Try adjusting your search or filter criteria."})]}):l("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:qe.map(Y=>l("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:h("div",{className:"p-6",children:[h("div",{className:"flex items-start justify-between mb-4",children:[h("div",{className:"flex-1",children:[l("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:Y.name}),l("p",{className:"text-sm text-gray-600 mb-2",children:Y.description}),h("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[h("div",{className:"flex items-center gap-1",children:[l(sl,{className:"w-4 h-4"}),Y.creator_name]}),h("div",{className:"flex items-center gap-1",children:[l(Yd,{className:"w-4 h-4"}),Re(Y.createdAt)]}),h("div",{className:"flex items-center gap-1",children:[l(nt,{className:"w-4 h-4"}),it(Me(Y.totalPrice))]})]})]}),l("div",{className:"flex items-center gap-2",children:l("button",{onClick:()=>Qe(Y.id),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",title:"Copy build link",children:l(Bk,{className:"w-4 h-4"})})})]}),h("div",{className:"flex items-center justify-between mb-4",children:[h("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full ${Fe(Y.compatibility).bgColor}`,children:[Fe(Y.compatibility).icon,h("span",{className:`text-sm font-medium ${Fe(Y.compatibility).color}`,children:[Y.compatibility,"% Compatible"]})]}),h("div",{className:"flex items-center gap-2",children:[l("span",{className:"text-sm text-gray-500",children:"Shared:"}),l("span",{className:"text-sm font-medium text-gray-900",children:Re(Y.createdAt)})]})]}),h("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[(Array.isArray(Y.components)?Y.components:Object.values(Y.components||{})).slice(0,8).map((ve,Je)=>h("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[l("div",{className:"text-xs font-medium text-gray-600 mb-1",children:ve.category}),l("div",{className:"text-sm font-semibold text-gray-900 truncate",children:ve.name}),l("div",{className:"text-xs text-gray-500",children:it(ve.price||0)})]},Je)),(Array.isArray(Y.components)?Y.components:Object.values(Y.components||{})).length>8&&h("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[h("div",{className:"text-xs font-medium text-blue-600 mb-1",children:["+",(Array.isArray(Y.components)?Y.components:Object.values(Y.components||{})).length-8," more"]}),l("div",{className:"text-sm font-semibold text-blue-800",children:"components"})]})]}),h("div",{className:"flex gap-3",children:[h("button",{className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center justify-center gap-2",onClick:()=>A(Y),children:[l(hl,{className:"w-4 h-4"}),"View Details"]}),h("button",{onClick:()=>Ge(Y),className:"flex-1 border-2 border-gray-300 text-gray-700 py-2 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors flex items-center justify-center gap-2",children:[l(Ss,{className:"w-4 h-4"}),"Use This Build"]})]})]})},Y.id))})]}),L==="management"&&we()&&h("div",{children:[h("div",{className:"mb-8",children:[l("div",{className:"flex items-center justify-between mb-4",children:h("div",{children:[l("h2",{className:"text-2xl font-bold mb-1",children:"PC Build Sharing"}),l("p",{className:"text-gray-600",children:"Review and manage PC build sharing submissions"})]})}),h("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[l("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:h("div",{className:"flex items-center gap-3",children:[l("div",{className:"w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center",children:l(Co,{className:"w-5 h-5 text-yellow-600"})}),h("div",{children:[l("h3",{className:"font-semibold text-gray-900",children:"Pending"}),l("p",{className:"text-2xl font-bold text-yellow-600",children:V.pending||0})]})]})}),l("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:h("div",{className:"flex items-center gap-3",children:[l("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:l(At,{className:"w-5 h-5 text-green-600"})}),h("div",{children:[l("h3",{className:"font-semibold text-gray-900",children:"Approved"}),l("p",{className:"text-2xl font-bold text-green-600",children:V.approved||0})]})]})}),l("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:h("div",{className:"flex items-center gap-3",children:[l("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:l(ka,{className:"w-5 h-5 text-red-600"})}),h("div",{children:[l("h3",{className:"font-semibold text-gray-900",children:"Rejected"}),l("p",{className:"text-2xl font-bold text-red-600",children:V.rejected||0})]})]})})]})]}),ee?l("div",{className:"flex items-center justify-center h-64",children:h("div",{className:"text-center",children:[l("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),l("p",{className:"mt-4 text-gray-600",children:"Loading submissions..."})]})}):ie.length===0?h("div",{className:"flex flex-col items-center justify-center py-16 px-6",children:[l("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-6",children:l(kd,{className:"w-12 h-12 text-gray-400"})}),l("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No submissions to review"}),l("p",{className:"text-gray-600 text-center max-w-md",children:"All PC build sharing submissions have been reviewed. Check back later for new submissions."})]}):l("div",{className:"space-y-4",children:ie.map(Y=>l("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:h("div",{className:"flex items-start justify-between mb-4",children:[h("div",{className:"flex-1",children:[h("div",{className:"flex items-center gap-3 mb-2",children:[l("h3",{className:"text-lg font-semibold text-gray-900",children:Y.build_name}),l("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Y.status==="pending"?"bg-yellow-100 text-yellow-800":Y.status==="approved"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:Y.status.charAt(0).toUpperCase()+Y.status.slice(1)})]}),l("p",{className:"text-sm text-gray-600 mb-2",children:Y.build_description}),h("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[h("div",{className:"flex items-center gap-1",children:[l(sl,{className:"w-4 h-4"}),Y.submitter_name]}),h("div",{className:"flex items-center gap-1",children:[l(Yd,{className:"w-4 h-4"}),Re(Y.submitted_at)]}),h("div",{className:"flex items-center gap-1",children:[l(nt,{className:"w-4 h-4"}),it(Y.total_price)]}),h("div",{className:"flex items-center gap-1",children:[l(At,{className:"w-4 h-4"}),Y.compatibility,"% Compatible"]})]}),Y.admin_notes&&l("div",{className:"mt-2 p-3 bg-gray-50 rounded-lg",children:h("p",{className:"text-sm text-gray-700",children:[l("strong",{children:"Admin Notes:"})," ",Y.admin_notes]})})]}),h("div",{className:"flex gap-2",children:[Y.status==="pending"&&l("button",{onClick:()=>j(Y),className:"px-4 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition-colors",children:"Review"}),(Y.status==="approved"||Y.status==="rejected")&&l("button",{onClick:()=>Ke(Y.id,Y.build_name),className:"px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition-colors",children:"Delete"})]})]})},Y.id))})]}),E&&(()=>{const Y=Array.isArray(E.components)?E.components:Object.values(E.components||{});return l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[l("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-xl",children:h("div",{className:"flex items-center justify-between",children:[h("div",{className:"flex items-center gap-4",children:[l("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:l(Zh,{className:"w-6 h-6 text-green-600"})}),h("div",{children:[l("h2",{className:"text-2xl font-bold text-gray-900",children:E.name}),h("p",{className:"text-gray-600",children:["Shared by ",E.creator_name]})]})]}),l("button",{onClick:()=>A(null),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors",children:l("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),h("div",{className:"p-6",children:[h("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[h("div",{className:"bg-gradient-to-br from-green-50 to-blue-50 rounded-xl p-6 border border-green-200",children:[h("div",{className:"flex items-center gap-3 mb-3",children:[l("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:l(At,{className:"w-5 h-5 text-green-600"})}),h("div",{children:[l("h3",{className:"font-semibold text-gray-900",children:"Compatibility"}),h("p",{className:"text-2xl font-bold text-green-600",children:[E.compatibility,"%"]})]})]}),l("div",{className:"w-full bg-gray-200 rounded-full h-2",children:l("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${E.compatibility}%`}})})]}),h("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl p-6 border border-blue-200",children:[h("div",{className:"flex items-center gap-3 mb-3",children:[l("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:l(nt,{className:"w-5 h-5 text-blue-600"})}),h("div",{children:[l("h3",{className:"font-semibold text-gray-900",children:"Total Price"}),l("p",{className:"text-2xl font-bold text-blue-600",children:it(E.totalPrice||0)})]})]}),l("p",{className:"text-sm text-gray-600",children:"All components included"})]}),h("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-6 border border-purple-200",children:[h("div",{className:"flex items-center gap-3 mb-3",children:[l("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:l(sl,{className:"w-5 h-5 text-purple-600"})}),h("div",{children:[l("h3",{className:"font-semibold text-gray-900",children:"Creator"}),l("p",{className:"text-lg font-bold text-purple-600",children:E.creator_name})]})]}),h("p",{className:"text-sm text-gray-600",children:["Build shared on ",Re(E.createdAt)]})]})]}),h("div",{className:"bg-gray-50 rounded-xl p-6 mb-8",children:[h("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[l(Jy,{className:"w-5 h-5 text-gray-600"}),"Build Description"]}),l("p",{className:"text-gray-700 leading-relaxed",children:E.description})]}),h("div",{children:[h("h3",{className:"text-xl font-bold text-gray-900 mb-6 flex items-center gap-2",children:[l(nt,{className:"w-6 h-6 text-gray-600"}),"Build Components"]}),l("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:Y.sort((ve,Je)=>{var Oe,at;const pt=["motherboard","cpu","gpu","ram","storage","psu","case","cooler"],fe=((Oe=ve==null?void 0:ve.category)==null?void 0:Oe.toLowerCase())||"",De=((at=Je==null?void 0:Je.category)==null?void 0:at.toLowerCase())||"",Ie=pt.indexOf(fe),Ye=pt.indexOf(De);return Ie!==-1&&Ye!==-1?Ie-Ye:Ie!==-1?-1:Ye!==-1?1:((ve==null?void 0:ve.category)||"").localeCompare((Je==null?void 0:Je.category)||"")}).map((ve,Je)=>l("div",{className:"bg-white border border-gray-200 rounded-xl p-6 hover:shadow-lg transition-shadow",children:h("div",{className:"flex items-start gap-4",children:[l("div",{className:"w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0",children:l(nt,{className:"w-8 h-8 text-gray-400"})}),h("div",{className:"flex-1 min-w-0",children:[h("div",{className:"flex items-center justify-between mb-2",children:[l("span",{className:"inline-block bg-green-100 text-green-800 text-xs font-medium px-2 py-1 rounded-full",children:ve.category}),l("span",{className:"text-lg font-bold text-green-600",children:it(ve.price||0)})]}),l("h4",{className:"font-semibold text-gray-900 text-lg mb-2 line-clamp-2",children:ve.name}),ve.brand&&h("p",{className:"text-sm text-gray-600 mb-2",children:["Brand: ",l("span",{className:"font-medium",children:ve.brand})]}),ve.specs&&l("div",{className:"text-xs text-gray-500 space-y-1",children:Object.entries(ve.specs).slice(0,3).map(([pt,fe])=>h("div",{className:"flex justify-between",children:[h("span",{className:"capitalize",children:[pt.replace(/_/g," "),":"]}),l("span",{className:"font-medium",children:fe})]},pt))})]})]})},Je))})]}),l("div",{className:"mt-8",children:l(k3,{buildId:E.id,user:n,className:"mb-8"})}),h("div",{className:"flex gap-4 mt-8 pt-6 border-t border-gray-200",children:[h("button",{onClick:()=>Ge(E),className:"flex-1 bg-green-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-green-700 transition-colors flex items-center justify-center gap-2",children:[l(Ss,{className:"w-5 h-5"}),"Use This Build"]}),h("button",{onClick:()=>Qe(E.id),className:"flex-1 border-2 border-gray-300 text-gray-700 py-3 px-6 rounded-lg font-semibold hover:bg-gray-50 transition-colors flex items-center justify-center gap-2",children:[l(Bk,{className:"w-5 h-5"}),"Copy Link"]})]})]})]})})})(),R&&l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:h("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[l("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-xl",children:h("div",{className:"flex items-center justify-between",children:[h("div",{className:"flex items-center gap-4",children:[l("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:l(kd,{className:"w-6 h-6 text-blue-600"})}),h("div",{children:[l("h2",{className:"text-2xl font-bold text-gray-900",children:"Review Submission"}),l("p",{className:"text-gray-600",children:R.build_name})]})]}),l("button",{onClick:()=>j(null),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors",children:l(Yr,{className:"w-6 h-6"})})]})}),h("div",{className:"p-6",children:[h("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[h("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl p-6 border border-blue-200",children:[h("div",{className:"flex items-center gap-3 mb-3",children:[l("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:l(sl,{className:"w-5 h-5 text-blue-600"})}),h("div",{children:[l("h3",{className:"font-semibold text-gray-900",children:"Submitter"}),l("p",{className:"text-lg font-bold text-blue-600",children:R.submitter_name})]})]}),h("p",{className:"text-sm text-gray-600",children:["Submitted on ",Re(R.submitted_at)]})]}),h("div",{className:"bg-gradient-to-br from-green-50 to-blue-50 rounded-xl p-6 border border-green-200",children:[h("div",{className:"flex items-center gap-3 mb-3",children:[l("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:l(At,{className:"w-5 h-5 text-green-600"})}),h("div",{children:[l("h3",{className:"font-semibold text-gray-900",children:"Compatibility"}),h("p",{className:"text-2xl font-bold text-green-600",children:[R.compatibility,"%"]})]})]}),l("div",{className:"w-full bg-gray-200 rounded-full h-2",children:l("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${R.compatibility}%`}})})]})]}),h("div",{className:"bg-gray-50 rounded-xl p-6 mb-6",children:[l("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Build Information"}),h("div",{className:"space-y-3",children:[h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Build Name"}),l("p",{className:"text-gray-900 font-medium",children:R.build_name})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),l("p",{className:"text-gray-900",children:R.build_description||"No description provided"})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Price"}),l("p",{className:"text-gray-900 font-medium",children:it(R.total_price)})]})]})]}),h("div",{className:"mb-6",children:[l("label",{htmlFor:"review-notes",className:"block text-sm font-medium text-gray-700 mb-2",children:"Review Notes (Optional)"}),l("textarea",{id:"review-notes",value:q,onChange:Y=>O(Y.target.value),placeholder:"Add notes about your decision (will be shared with the submitter)...",rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none",maxLength:500}),h("p",{className:"text-xs text-gray-500 mt-1",children:[q.length,"/500 characters"]})]}),h("div",{className:"flex gap-4 pt-6 border-t border-gray-200",children:[l("button",{onClick:()=>j(null),className:"flex-1 px-4 py-3 border-2 border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Cancel"}),l("button",{onClick:()=>Ae(R.id,"rejected"),disabled:K,className:"flex-1 px-4 py-3 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition-colors disabled:opacity-50",children:K?"Processing...":"Reject"}),l("button",{onClick:()=>Ae(R.id,"approved"),disabled:K,className:"flex-1 px-4 py-3 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition-colors disabled:opacity-50",children:K?"Processing...":"Approve"})]})]})]})})]})]})},rm=({user:e})=>{const{notifications:t,loading:r,markAsRead:n,markAllAsRead:a,deleteNotification:i,deleteAllNotifications:s}=yp(),[o,c]=N.useState("all"),u=g=>{switch(g){case"order":return l(At,{className:"w-5 h-5 text-green-600"});case"build":return l(ts,{className:"w-5 h-5 text-orange-600"});case"system":return l(Ac,{className:"w-5 h-5 text-blue-600"});case"promo":return l(Aa,{className:"w-5 h-5 text-purple-600"});case"support":return l(At,{className:"w-5 h-5 text-blue-600"});default:return l(Aa,{className:"w-5 h-5 text-gray-600"})}},d=(g,y)=>{if(!g)return null;if(y==="stock"){const v=g.split(`
`).filter(_=>_.trim().length>0),b=v[0]||"",w=v.slice(1).filter(_=>_.trim().startsWith("-")),k=v.slice(1).filter(_=>!_.trim().startsWith("-")),S=k.length>0?k[k.length-1]:"";return h("div",{children:[b&&l("p",{className:"text-sm text-gray-600 mt-1",children:b}),w.length>0&&l("ul",{className:"list-disc pl-5 text-sm text-gray-600 mt-1 space-y-1",children:w.map((_,C)=>l("li",{children:_.replace(/^[-\s]+/,"")},C))}),S&&l("p",{className:"text-sm text-gray-600 mt-2",children:S})]})}return l("p",{className:"text-sm text-gray-600 mt-1 whitespace-pre-line",children:g})},f=g=>{switch(g){case"high":return"border-l-red-500";case"medium":return"border-l-orange-500";case"low":return"border-l-green-500";default:return"border-l-gray-500"}},m=g=>{if(!g||isNaN(g.getTime()))return"Unknown time";const y=Date.now()-g.getTime(),v=Math.abs(y),b=Math.floor(v/(1e3*60)),w=Math.floor(v/(1e3*60*60)),k=Math.floor(v/(1e3*60*60*24));if(v<60*1e3)return"just now";const S=y<0,_=" ago",C="in ";return b<60?S?`${C}${b} minute${b!==1?"s":""}`:`${b} minute${b!==1?"s":""}${_}`:w<24?S?`${C}${w} hour${w!==1?"s":""}`:`${w} hour${w!==1?"s":""}${_}`:S?`${C}${k} day${k!==1?"s":""}`:`${k} day${k!==1?"s":""}${_}`},p=t.filter(g=>o==="unread"?!g.read:o==="read"?g.read:!0),x=t.filter(g=>!g.read).length;return r?l("div",{className:"flex items-center justify-center h-full",children:l("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"})}):h("div",{className:"p-6 max-w-4xl mx-auto",children:[h("div",{className:"flex items-center justify-between mb-6",children:[h("div",{className:"flex items-center space-x-3",children:[l("div",{className:"w-10 h-10 bg-green-600 rounded-lg flex items-center justify-center",children:l(Aa,{className:"w-6 h-6 text-white"})}),h("div",{children:[l("h1",{className:"text-2xl font-bold text-gray-900",children:"Notifications"}),h("p",{className:"text-sm text-gray-500",children:[x," unread notification",x!==1?"s":""]})]})]}),h("div",{className:"flex items-center space-x-3",children:[h("select",{value:o,onChange:g=>c(g.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[l("option",{value:"all",children:"All Notifications"}),l("option",{value:"unread",children:"Unread"}),l("option",{value:"read",children:"Read"})]}),x>0&&l("button",{onClick:a,className:"px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-md hover:bg-green-700 transition-colors",children:"Mark All as Read"}),t.length>0&&l("button",{onClick:()=>{window.confirm("Are you sure you want to delete all notifications?")&&s()},className:"px-4 py-2 bg-red-600 text-white text-sm font-medium rounded-md hover:bg-red-700 transition-colors",children:"Delete All"})]})]}),l("div",{className:"space-y-3",children:p.length===0?h("div",{className:"text-center py-12",children:[l(Aa,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:o==="all"?"No notifications yet":`No ${o} notifications`}),l("p",{className:"text-gray-500",children:o==="all"?"You'll see important updates here when they arrive.":`You have no ${o} notifications at the moment.`})]}):p.map(g=>l("div",{className:`bg-white rounded-lg border border-gray-200 p-4 transition-all duration-200 hover:shadow-md ${g.read?"":"border-l-4 "+f(g.priority)} ${g.read?"":"bg-blue-50"}`,children:h("div",{className:"flex items-start space-x-3",children:[l("div",{className:"flex-shrink-0 mt-1",children:u(g.type)}),l("div",{className:"flex-1 min-w-0",children:h("div",{className:"flex items-start justify-between",children:[h("div",{className:"flex-1",children:[l("h3",{className:`text-sm font-medium ${g.read?"text-gray-700":"text-gray-900"}`,children:g.title}),d(g.message,g.type),h("div",{className:"flex items-center mt-2 text-xs text-gray-500",children:[l(Co,{className:"w-3 h-3 mr-1"}),m(g.timestamp)]})]}),h("div",{className:"flex items-center space-x-2 ml-4",children:[!g.read&&l("button",{onClick:()=>n(g.id),className:"p-1 text-gray-400 hover:text-green-600 transition-colors",title:"Mark as read",children:l(sb,{className:"w-4 h-4"})}),l("button",{onClick:()=>{g.id&&g.id>0?i(g.id):console.error("Cannot delete notification: Invalid ID",g)},className:"p-1 text-gray-400 hover:text-red-600 transition-colors",title:"Delete notification",children:l(Hr,{className:"w-4 h-4"})})]})]})})]})},g.id))})]})};function S3(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=S3(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Ft(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=S3(e))&&(n&&(n+=" "),n+=t);return n}var ij=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function yb(e){if(typeof e!="string")return!1;var t=ij;return t.includes(e)}var sj=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function _3(e){if(typeof e!="string")return!1;var t=sj;return t.includes(e)}function C3(e){return typeof e=="string"&&e.startsWith("data-")}function Fa(e){var t=Object.entries(e).filter(r=>{var[n]=r;return _3(n)||C3(n)});return Object.fromEntries(t)}function Al(e){if(e==null)return null;if(N.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return Fa(t)}return typeof e=="object"&&!Array.isArray(e)?Fa(e):null}function ea(e){var t=Object.entries(e).filter(r=>{var[n]=r;return _3(n)||C3(n)||yb(n)});return Object.fromEntries(t)}function oj(e){return e==null?null:N.isValidElement(e)?ea(e.props):typeof e=="object"&&!Array.isArray(e)?ea(e):null}var lj=["children","width","height","viewBox","className","style","title","desc"];function nv(){return nv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nv.apply(null,arguments)}function cj(e,t){if(e==null)return{};var r,n,a=uj(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function uj(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var vb=N.forwardRef((e,t)=>{var{children:r,width:n,height:a,viewBox:i,className:s,style:o,title:c,desc:u}=e,d=cj(e,lj),f=i||{width:n,height:a,x:0,y:0},m=Ft("recharts-surface",s);return N.createElement("svg",nv({},ea(d),{className:m,width:n,height:a,style:o,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height),ref:t}),N.createElement("title",null,c),N.createElement("desc",null,u),r)}),dj=["children","className"];function av(){return av=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},av.apply(null,arguments)}function fj(e,t){if(e==null)return{};var r,n,a=hj(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function hj(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Nn=N.forwardRef((e,t)=>{var{children:r,className:n}=e,a=fj(e,dj),i=Ft("recharts-layer",n);return N.createElement("g",av({className:i},ea(a),{ref:t}),r)}),E3=N.createContext(null),mj=()=>N.useContext(E3);function Jt(e){return function(){return e}}const A3=Math.cos,nm=Math.sin,Bi=Math.sqrt,am=Math.PI,_p=2*am,iv=Math.PI,sv=2*iv,Qo=1e-6,pj=sv-Qo;function T3(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function gj(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return T3;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class xj{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?T3:gj(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,s){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,o=this._y1,c=n-t,u=a-r,d=s-t,f=o-r,m=d*d+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(m>Qo)if(!(Math.abs(f*c-u*d)>Qo)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let p=n-s,x=a-o,g=c*c+u*u,y=p*p+x*x,v=Math.sqrt(g),b=Math.sqrt(m),w=i*Math.tan((iv-Math.acos((g+m-y)/(2*v*b)))/2),k=w/b,S=w/v;Math.abs(k-1)>Qo&&this._append`L${t+k*d},${r+k*f}`,this._append`A${i},${i},0,0,${+(f*p>d*x)},${this._x1=t+S*c},${this._y1=r+S*u}`}}arc(t,r,n,a,i,s){if(t=+t,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(a),c=n*Math.sin(a),u=t+o,d=r+c,f=1^s,m=s?a-i:i-a;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>Qo||Math.abs(this._y1-d)>Qo)&&this._append`L${u},${d}`,n&&(m<0&&(m=m%sv+sv),m>pj?this._append`A${n},${n},0,1,${f},${t-o},${r-c}A${n},${n},0,1,${f},${this._x1=u},${this._y1=d}`:m>Qo&&this._append`A${n},${n},0,${+(m>=iv)},${f},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function bb(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new xj(t)}function wb(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function P3(e){this._context=e}P3.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Cp(e){return new P3(e)}function O3(e){return e[0]}function D3(e){return e[1]}function I3(e,t){var r=Jt(!0),n=null,a=Cp,i=null,s=bb(o);e=typeof e=="function"?e:e===void 0?O3:Jt(e),t=typeof t=="function"?t:t===void 0?D3:Jt(t);function o(c){var u,d=(c=wb(c)).length,f,m=!1,p;for(n==null&&(i=a(p=s())),u=0;u<=d;++u)!(u<d&&r(f=c[u],u,c))===m&&((m=!m)?i.lineStart():i.lineEnd()),m&&i.point(+e(f,u,c),+t(f,u,c));if(p)return i=null,p+""||null}return o.x=function(c){return arguments.length?(e=typeof c=="function"?c:Jt(+c),o):e},o.y=function(c){return arguments.length?(t=typeof c=="function"?c:Jt(+c),o):t},o.defined=function(c){return arguments.length?(r=typeof c=="function"?c:Jt(!!c),o):r},o.curve=function(c){return arguments.length?(a=c,n!=null&&(i=a(n)),o):a},o.context=function(c){return arguments.length?(c==null?n=i=null:i=a(n=c),o):n},o}function R0(e,t,r){var n=null,a=Jt(!0),i=null,s=Cp,o=null,c=bb(u);e=typeof e=="function"?e:e===void 0?O3:Jt(+e),t=typeof t=="function"?t:Jt(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?D3:Jt(+r);function u(f){var m,p,x,g=(f=wb(f)).length,y,v=!1,b,w=new Array(g),k=new Array(g);for(i==null&&(o=s(b=c())),m=0;m<=g;++m){if(!(m<g&&a(y=f[m],m,f))===v)if(v=!v)p=m,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),x=m-1;x>=p;--x)o.point(w[x],k[x]);o.lineEnd(),o.areaEnd()}v&&(w[m]=+e(y,m,f),k[m]=+t(y,m,f),o.point(n?+n(y,m,f):w[m],r?+r(y,m,f):k[m]))}if(b)return o=null,b+""||null}function d(){return I3().defined(a).curve(s).context(i)}return u.x=function(f){return arguments.length?(e=typeof f=="function"?f:Jt(+f),n=null,u):e},u.x0=function(f){return arguments.length?(e=typeof f=="function"?f:Jt(+f),u):e},u.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:Jt(+f),u):n},u.y=function(f){return arguments.length?(t=typeof f=="function"?f:Jt(+f),r=null,u):t},u.y0=function(f){return arguments.length?(t=typeof f=="function"?f:Jt(+f),u):t},u.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:Jt(+f),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(n).y(t)},u.defined=function(f){return arguments.length?(a=typeof f=="function"?f:Jt(!!f),u):a},u.curve=function(f){return arguments.length?(s=f,i!=null&&(o=s(i)),u):s},u.context=function(f){return arguments.length?(f==null?i=o=null:o=s(i=f),u):i},u}class R3{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function yj(e){return new R3(e,!0)}function vj(e){return new R3(e,!1)}const Nb={draw(e,t){const r=Bi(t/am);e.moveTo(r,0),e.arc(0,0,r,0,_p)}},bj={draw(e,t){const r=Bi(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},F3=Bi(1/3),wj=F3*2,Nj={draw(e,t){const r=Bi(t/wj),n=r*F3;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},kj={draw(e,t){const r=Bi(t),n=-r/2;e.rect(n,n,r,r)}},Sj=.8908130915292852,M3=nm(am/10)/nm(7*am/10),_j=nm(_p/10)*M3,Cj=-A3(_p/10)*M3,Ej={draw(e,t){const r=Bi(t*Sj),n=_j*r,a=Cj*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const s=_p*i/5,o=A3(s),c=nm(s);e.lineTo(c*r,-o*r),e.lineTo(o*n-c*a,c*n+o*a)}e.closePath()}},px=Bi(3),Aj={draw(e,t){const r=-Bi(t/(px*3));e.moveTo(0,r*2),e.lineTo(-px*r,-r),e.lineTo(px*r,-r),e.closePath()}},Ha=-.5,Wa=Bi(3)/2,ov=1/Bi(12),Tj=(ov/2+1)*3,Pj={draw(e,t){const r=Bi(t/Tj),n=r/2,a=r*ov,i=n,s=r*ov+r,o=-i,c=s;e.moveTo(n,a),e.lineTo(i,s),e.lineTo(o,c),e.lineTo(Ha*n-Wa*a,Wa*n+Ha*a),e.lineTo(Ha*i-Wa*s,Wa*i+Ha*s),e.lineTo(Ha*o-Wa*c,Wa*o+Ha*c),e.lineTo(Ha*n+Wa*a,Ha*a-Wa*n),e.lineTo(Ha*i+Wa*s,Ha*s-Wa*i),e.lineTo(Ha*o+Wa*c,Ha*c-Wa*o),e.closePath()}};function Oj(e,t){let r=null,n=bb(a);e=typeof e=="function"?e:Jt(e||Nb),t=typeof t=="function"?t:Jt(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:Jt(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:Jt(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function im(){}function sm(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function L3(e){this._context=e}L3.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:sm(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:sm(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Dj(e){return new L3(e)}function B3(e){this._context=e}B3.prototype={areaStart:im,areaEnd:im,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:sm(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Ij(e){return new B3(e)}function j3(e){this._context=e}j3.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:sm(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Rj(e){return new j3(e)}function $3(e){this._context=e}$3.prototype={areaStart:im,areaEnd:im,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Fj(e){return new $3(e)}function xS(e){return e<0?-1:1}function yS(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),s=(r-e._y1)/(a||n<0&&-0),o=(i*a+s*n)/(n+a);return(xS(i)+xS(s))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs(o))||0}function vS(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function gx(e,t,r){var n=e._x0,a=e._y0,i=e._x1,s=e._y1,o=(i-n)/3;e._context.bezierCurveTo(n+o,a+o*t,i-o,s-o*r,i,s)}function om(e){this._context=e}om.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:gx(this,this._t0,vS(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,gx(this,vS(this,r=yS(this,e,t)),r);break;default:gx(this,this._t0,r=yS(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function U3(e){this._context=new z3(e)}(U3.prototype=Object.create(om.prototype)).point=function(e,t){om.prototype.point.call(this,t,e)};function z3(e){this._context=e}z3.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function Mj(e){return new om(e)}function Lj(e){return new U3(e)}function H3(e){this._context=e}H3.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=bS(e),a=bS(t),i=0,s=1;s<r;++i,++s)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[s],t[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function bS(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),s=new Array(r);for(a[0]=0,i[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,s[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,s[t]-=n*s[t-1];for(a[r-1]=s[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(s[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function Bj(e){return new H3(e)}function Ep(e,t){this._context=e,this._t=t}Ep.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function jj(e){return new Ep(e,.5)}function $j(e){return new Ep(e,0)}function Uj(e){return new Ep(e,1)}function tu(e,t){if((s=e.length)>1)for(var r=1,n,a,i=e[t[0]],s,o=i.length;r<s;++r)for(a=i,i=e[t[r]],n=0;n<o;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function lv(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function zj(e,t){return e[t]}function Hj(e){const t=[];return t.key=e,t}function Wj(){var e=Jt([]),t=lv,r=tu,n=zj;function a(i){var s=Array.from(e.apply(this,arguments),Hj),o,c=s.length,u=-1,d;for(const f of i)for(o=0,++u;o<c;++o)(s[o][u]=[0,+n(f,s[o].key,u,i)]).data=f;for(o=0,d=wb(t(s));o<c;++o)s[d[o]].index=o;return r(s,d),s}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:Jt(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:Jt(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?lv:typeof i=="function"?i:Jt(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??tu,a):r},a}function Gj(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,s;a<i;++a){for(s=r=0;r<n;++r)s+=e[r][a][1]||0;if(s)for(r=0;r<n;++r)e[r][a][1]/=s}tu(e,t)}}function Vj(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var s=0,o=0;s<a;++s)o+=e[s][r][1]||0;n[r][1]+=n[r][0]=-o/2}tu(e,t)}}function Kj(e,t){if(!(!((s=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,s;n<i;++n){for(var o=0,c=0,u=0;o<s;++o){for(var d=e[t[o]],f=d[n][1]||0,m=d[n-1][1]||0,p=(f-m)/2,x=0;x<o;++x){var g=e[t[x]],y=g[n][1]||0,v=g[n-1][1]||0;p+=y-v}c+=f,u+=p*f}a[n-1][1]+=a[n-1][0]=r,c&&(r-=u/c)}a[n-1][1]+=a[n-1][0]=r,tu(e,t)}}var Ap={},W3={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(W3);var kb={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(kb);var Tp={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var n;return typeof r=="string"||typeof r=="symbol"?r:Object.is((n=r==null?void 0:r.valueOf)==null?void 0:n.call(r),-0)?"-0":String(r)}e.toKey=t})(Tp);var Pp={},G3={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}e.toString=t})(G3);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=G3,r=Tp;function n(a){if(Array.isArray(a))return a.map(r.toKey);if(typeof a=="symbol")return[a];a=t.toString(a);const i=[],s=a.length;if(s===0)return i;let o=0,c="",u="",d=!1;for(a.charCodeAt(0)===46&&(i.push(""),o++);o<s;){const f=a[o];u?f==="\\"&&o+1<s?(o++,c+=a[o]):f===u?u="":c+=f:d?f==='"'||f==="'"?u=f:f==="]"?(d=!1,i.push(c),c=""):c+=f:f==="["?(d=!0,c&&(i.push(c),c="")):f==="."?c&&(i.push(c),c=""):c+=f,o++}return c&&i.push(c),i}e.toPath=n})(Pp);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=W3,r=kb,n=Tp,a=Pp;function i(o,c,u){if(o==null)return u;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return u;const d=o[c];return d===void 0?r.isDeepKey(c)?i(o,a.toPath(c),u):u:d}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const d=o[c];return d===void 0?u:d}default:{if(Array.isArray(c))return s(o,c,u);if(Object.is(c==null?void 0:c.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return u;const d=o[c];return d===void 0?u:d}}}function s(o,c,u){if(c.length===0)return u;let d=o;for(let f=0;f<c.length;f++){if(d==null||t.isUnsafeProperty(c[f]))return u;d=d[c[f]]}return d===void 0?u:d}e.get=i})(Ap);var qj=Ap.get;const Tl=$s(qj);var ln=e=>e===0?0:e>0?1:-1,di=e=>typeof e=="number"&&e!=+e,Fs=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,lt=e=>(typeof e=="number"||e instanceof Number)&&!di(e),ns=e=>lt(e)||typeof e=="string",Xj=0,Qd=e=>{var t=++Xj;return"".concat(e||"").concat(t)},Bn=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!lt(t)&&typeof t!="string")return n;var i;if(Fs(t)){if(r==null)return n;var s=t.indexOf("%");i=r*parseFloat(t.slice(0,s))/100}else i=+t;return di(i)&&(i=n),a&&r!=null&&i>r&&(i=r),i},V3=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[e[n]])r[e[n]]=!0;else return!0;return!1};function _r(e,t,r){return lt(e)&&lt(t)?e+r*(t-e):t}function K3(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):Tl(n,t))===r)}var dr=e=>e===null||typeof e>"u",Mf=e=>dr(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),Yj=["type","size","sizeType"];function cv(){return cv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cv.apply(null,arguments)}function wS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function NS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wS(Object(r),!0).forEach(function(n){Jj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Jj(e,t,r){return(t=Qj(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qj(e){var t=Zj(e,"string");return typeof t=="symbol"?t:t+""}function Zj(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function e7(e,t){if(e==null)return{};var r,n,a=t7(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function t7(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var q3={symbolCircle:Nb,symbolCross:bj,symbolDiamond:Nj,symbolSquare:kj,symbolStar:Ej,symbolTriangle:Aj,symbolWye:Pj},r7=Math.PI/180,n7=e=>{var t="symbol".concat(Mf(e));return q3[t]||Nb},a7=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*r7;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},i7=(e,t)=>{q3["symbol".concat(Mf(e))]=t},Sb=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,a=e7(e,Yj),i=NS(NS({},a),{},{type:t,size:r,sizeType:n}),s="circle";typeof t=="string"&&(s=t);var o=()=>{var m=n7(s),p=Oj().type(m).size(a7(r,n,s)),x=p();if(x!==null)return x},{className:c,cx:u,cy:d}=i,f=ea(i);return u===+u&&d===+d&&r===+r?N.createElement("path",cv({},f,{className:Ft("recharts-symbols",c),transform:"translate(".concat(u,", ").concat(d,")"),d:o()})):null};Sb.registerSymbol=i7;var _b=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(N.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{yb(a)&&(n[a]=t||(i=>r[a](r,i)))}),n},s7=(e,t,r)=>n=>(e(t,r,n),null),Lf=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(a=>{var i=e[a];yb(a)&&typeof i=="function"&&(n||(n={}),n[a]=s7(i,t,r))}),n};function uv(){return uv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uv.apply(null,arguments)}function kS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function o7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kS(Object(r),!0).forEach(function(n){Cb(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Cb(e,t,r){return(t=l7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l7(e){var t=c7(e,"string");return typeof t=="symbol"?t:t+""}function c7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ga=32;class Eb extends N.PureComponent{renderIcon(t,r){var{inactiveColor:n}=this.props,a=Ga/2,i=Ga/6,s=Ga/3,o=t.inactive?n:t.color,c=r??t.type;if(c==="none")return null;if(c==="plainline")return N.createElement("line",{strokeWidth:4,fill:"none",stroke:o,strokeDasharray:t.payload.strokeDasharray,x1:0,y1:a,x2:Ga,y2:a,className:"recharts-legend-icon"});if(c==="line")return N.createElement("path",{strokeWidth:4,fill:"none",stroke:o,d:"M0,".concat(a,"h").concat(s,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(2*s,",").concat(a,`
            H`).concat(Ga,"M").concat(2*s,",").concat(a,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(s,",").concat(a),className:"recharts-legend-icon"});if(c==="rect")return N.createElement("path",{stroke:"none",fill:o,d:"M0,".concat(Ga/8,"h").concat(Ga,"v").concat(Ga*3/4,"h").concat(-Ga,"z"),className:"recharts-legend-icon"});if(N.isValidElement(t.legendIcon)){var u=o7({},t);return delete u.legendIcon,N.cloneElement(t.legendIcon,u)}return N.createElement(Sb,{fill:o,cx:a,cy:a,size:Ga,sizeType:"diameter",type:c})}renderItems(){var{payload:t,iconSize:r,layout:n,formatter:a,inactiveColor:i,iconType:s}=this.props,o={x:0,y:0,width:Ga,height:Ga},c={display:n==="horizontal"?"inline-block":"block",marginRight:10},u={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((d,f)=>{var m=d.formatter||a,p=Ft({"recharts-legend-item":!0,["legend-item-".concat(f)]:!0,inactive:d.inactive});if(d.type==="none")return null;var x=d.inactive?i:d.color,g=m?m(d.value,d,f):d.value;return N.createElement("li",uv({className:p,style:c,key:"legend-item-".concat(f)},Lf(this.props,d,f)),N.createElement(vb,{width:r,height:r,viewBox:o,style:u,"aria-label":"".concat(g," legend icon")},this.renderIcon(d,s)),N.createElement("span",{className:"recharts-legend-item-text",style:{color:x}},g))})}render(){var{payload:t,layout:r,align:n}=this.props;if(!t||!t.length)return null;var a={padding:0,margin:0,textAlign:r==="horizontal"?n:"left"};return N.createElement("ul",{className:"recharts-default-legend",style:a},this.renderItems())}}Cb(Eb,"displayName","Legend");Cb(Eb,"defaultProps",{align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"});var X3={},Y3={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const a=new Map;for(let i=0;i<r.length;i++){const s=r[i],o=n(s);a.has(o)||a.set(o,s)}return Array.from(a.values())}e.uniqBy=t})(Y3);var Ab={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(Ab);var J3={},Op={},Q3={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(Q3);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Q3;function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(Op);var Z3={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(Z3);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Op,r=Z3;function n(a){return r.isObjectLike(a)&&t.isArrayLike(a)}e.isArrayLikeObject=n})(J3);var eP={},tP={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ap;function r(n){return function(a){return t.get(a,n)}}e.property=r})(tP);var rP={},xx={},yx={},Tb={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(Tb);var Pb={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(Pb);var Ob={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.eq=t})(Ob);var SS;function u7(){return SS||(SS=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Db(),r=Tb,n=Pb,a=Ob;function i(f,m,p){return typeof p!="function"?t.isMatch(f,m):s(f,m,function x(g,y,v,b,w,k){const S=p(g,y,v,b,w,k);return S!==void 0?!!S:s(g,y,x,k)},new Map)}function s(f,m,p,x){if(m===f)return!0;switch(typeof m){case"object":return o(f,m,p,x);case"function":return Object.keys(m).length>0?s(f,{...m},p,x):a.eq(f,m);default:return r.isObject(f)?typeof m=="string"?m==="":!0:a.eq(f,m)}}function o(f,m,p,x){if(m==null)return!0;if(Array.isArray(m))return u(f,m,p,x);if(m instanceof Map)return c(f,m,p,x);if(m instanceof Set)return d(f,m,p,x);const g=Object.keys(m);if(f==null)return g.length===0;if(g.length===0)return!0;if(x&&x.has(m))return x.get(m)===f;x&&x.set(m,f);try{for(let y=0;y<g.length;y++){const v=g[y];if(!n.isPrimitive(f)&&!(v in f)||m[v]===void 0&&f[v]!==void 0||m[v]===null&&f[v]!==null||!p(f[v],m[v],v,f,m,x))return!1}return!0}finally{x&&x.delete(m)}}function c(f,m,p,x){if(m.size===0)return!0;if(!(f instanceof Map))return!1;for(const[g,y]of m.entries()){const v=f.get(g);if(p(v,y,g,f,m,x)===!1)return!1}return!0}function u(f,m,p,x){if(m.length===0)return!0;if(!Array.isArray(f))return!1;const g=new Set;for(let y=0;y<m.length;y++){const v=m[y];let b=!1;for(let w=0;w<f.length;w++){if(g.has(w))continue;const k=f[w];let S=!1;if(p(k,v,y,f,m,x)&&(S=!0),S){g.add(w),b=!0;break}}if(!b)return!1}return!0}function d(f,m,p,x){return m.size===0?!0:f instanceof Set?u([...f],[...m],p,x):!1}e.isMatchWith=i,e.isSetMatch=d}(yx)),yx}var _S;function Db(){return _S||(_S=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=u7();function r(n,a){return t.isMatchWith(n,a,()=>{})}e.isMatch=r}(xx)),xx}var nP={},Ib={},aP={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(aP);var Rb={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(Rb);var Fb={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",i="[object Arguments]",s="[object Symbol]",o="[object Date]",c="[object Map]",u="[object Set]",d="[object Array]",f="[object Function]",m="[object ArrayBuffer]",p="[object Object]",x="[object Error]",g="[object DataView]",y="[object Uint8Array]",v="[object Uint8ClampedArray]",b="[object Uint16Array]",w="[object Uint32Array]",k="[object BigUint64Array]",S="[object Int8Array]",_="[object Int16Array]",C="[object Int32Array]",E="[object BigInt64Array]",A="[object Float32Array]",T="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=m,e.arrayTag=d,e.bigInt64ArrayTag=E,e.bigUint64ArrayTag=k,e.booleanTag=a,e.dataViewTag=g,e.dateTag=o,e.errorTag=x,e.float32ArrayTag=A,e.float64ArrayTag=T,e.functionTag=f,e.int16ArrayTag=_,e.int32ArrayTag=C,e.int8ArrayTag=S,e.mapTag=c,e.numberTag=n,e.objectTag=p,e.regexpTag=t,e.setTag=u,e.stringTag=r,e.symbolTag=s,e.uint16ArrayTag=b,e.uint32ArrayTag=w,e.uint8ArrayTag=y,e.uint8ClampedArrayTag=v})(Fb);var iP={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(iP);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=aP,r=Rb,n=Fb,a=Pb,i=iP;function s(d,f){return o(d,void 0,d,new Map,f)}function o(d,f,m,p=new Map,x=void 0){const g=x==null?void 0:x(d,f,m,p);if(g!==void 0)return g;if(a.isPrimitive(d))return d;if(p.has(d))return p.get(d);if(Array.isArray(d)){const y=new Array(d.length);p.set(d,y);for(let v=0;v<d.length;v++)y[v]=o(d[v],v,m,p,x);return Object.hasOwn(d,"index")&&(y.index=d.index),Object.hasOwn(d,"input")&&(y.input=d.input),y}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const y=new RegExp(d.source,d.flags);return y.lastIndex=d.lastIndex,y}if(d instanceof Map){const y=new Map;p.set(d,y);for(const[v,b]of d)y.set(v,o(b,v,m,p,x));return y}if(d instanceof Set){const y=new Set;p.set(d,y);for(const v of d)y.add(o(v,void 0,m,p,x));return y}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(i.isTypedArray(d)){const y=new(Object.getPrototypeOf(d)).constructor(d.length);p.set(d,y);for(let v=0;v<d.length;v++)y[v]=o(d[v],v,m,p,x);return y}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const y=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return p.set(d,y),c(y,d,m,p,x),y}if(typeof File<"u"&&d instanceof File){const y=new File([d],d.name,{type:d.type});return p.set(d,y),c(y,d,m,p,x),y}if(typeof Blob<"u"&&d instanceof Blob){const y=new Blob([d],{type:d.type});return p.set(d,y),c(y,d,m,p,x),y}if(d instanceof Error){const y=new d.constructor;return p.set(d,y),y.message=d.message,y.name=d.name,y.stack=d.stack,y.cause=d.cause,c(y,d,m,p,x),y}if(d instanceof Boolean){const y=new Boolean(d.valueOf());return p.set(d,y),c(y,d,m,p,x),y}if(d instanceof Number){const y=new Number(d.valueOf());return p.set(d,y),c(y,d,m,p,x),y}if(d instanceof String){const y=new String(d.valueOf());return p.set(d,y),c(y,d,m,p,x),y}if(typeof d=="object"&&u(d)){const y=Object.create(Object.getPrototypeOf(d));return p.set(d,y),c(y,d,m,p,x),y}return d}function c(d,f,m=d,p,x){const g=[...Object.keys(f),...t.getSymbols(f)];for(let y=0;y<g.length;y++){const v=g[y],b=Object.getOwnPropertyDescriptor(d,v);(b==null||b.writable)&&(d[v]=o(f[v],v,m,p,x))}}function u(d){switch(r.getTag(d)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=s,e.cloneDeepWithImpl=o,e.copyProperties=c})(Ib);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ib;function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(nP);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Db(),r=nP;function n(a){return a=r.cloneDeep(a),i=>t.isMatch(i,a)}e.matches=n})(rP);var sP={},oP={},lP={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ib,r=Fb;function n(a,i){return t.cloneDeepWith(a,(s,o,c,u)=>{const d=i==null?void 0:i(s,o,c,u);if(d!==void 0)return d;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case r.numberTag:case r.stringTag:case r.booleanTag:{const f=new a.constructor(a==null?void 0:a.valueOf());return t.copyProperties(f,a),f}case r.argumentsTag:{const f={};return t.copyProperties(f,a),f.length=a.length,f[Symbol.iterator]=a[Symbol.iterator],f}default:return}})}e.cloneDeepWith=n})(lP);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=lP;function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(oP);var cP={},Mb={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(Mb);var uP={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Rb;function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(uP);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=kb,r=Mb,n=uP,a=Pp;function i(s,o){let c;if(Array.isArray(o)?c=o:typeof o=="string"&&t.isDeepKey(o)&&(s==null?void 0:s[o])==null?c=a.toPath(o):c=[o],c.length===0)return!1;let u=s;for(let d=0;d<c.length;d++){const f=c[d];if((u==null||!Object.hasOwn(u,f))&&!((Array.isArray(u)||n.isArguments(u))&&r.isIndex(f)&&f<u.length))return!1;u=u[f]}return!0}e.has=i})(cP);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Db(),r=Tp,n=oP,a=Ap,i=cP;function s(o,c){switch(typeof o){case"object":{Object.is(o==null?void 0:o.valueOf(),-0)&&(o="-0");break}case"number":{o=r.toKey(o);break}}return c=n.cloneDeep(c),function(u){const d=a.get(u,o);return d===void 0?i.has(u,o):c===void 0?d===void 0:t.isMatch(d,c)}}e.matchesProperty=s})(sP);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ab,r=tP,n=rP,a=sP;function i(s){if(s==null)return t.identity;switch(typeof s){case"function":return s;case"object":return Array.isArray(s)&&s.length===2?a.matchesProperty(s[0],s[1]):n.matches(s);case"string":case"symbol":case"number":return r.property(s)}}e.iteratee=i})(eP);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Y3,r=Ab,n=J3,a=eP;function i(s,o=r.identity){return n.isArrayLikeObject(s)?t.uniqBy(Array.from(s),a.iteratee(o)):[]}e.uniqBy=i})(X3);var d7=X3.uniqBy;const CS=$s(d7);function dP(e,t,r){return t===!0?CS(e,r):typeof t=="function"?CS(e,t):e}var fP={exports:{}},hP={},mP={exports:{}},pP={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ru=N;function f7(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var h7=typeof Object.is=="function"?Object.is:f7,m7=ru.useState,p7=ru.useEffect,g7=ru.useLayoutEffect,x7=ru.useDebugValue;function y7(e,t){var r=t(),n=m7({inst:{value:r,getSnapshot:t}}),a=n[0].inst,i=n[1];return g7(function(){a.value=r,a.getSnapshot=t,vx(a)&&i({inst:a})},[e,r,t]),p7(function(){return vx(a)&&i({inst:a}),e(function(){vx(a)&&i({inst:a})})},[e]),x7(r),r}function vx(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!h7(e,r)}catch{return!0}}function v7(e,t){return t()}var b7=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?v7:y7;pP.useSyncExternalStore=ru.useSyncExternalStore!==void 0?ru.useSyncExternalStore:b7;mP.exports=pP;var w7=mP.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dp=N,N7=w7;function k7(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var S7=typeof Object.is=="function"?Object.is:k7,_7=N7.useSyncExternalStore,C7=Dp.useRef,E7=Dp.useEffect,A7=Dp.useMemo,T7=Dp.useDebugValue;hP.useSyncExternalStoreWithSelector=function(e,t,r,n,a){var i=C7(null);if(i.current===null){var s={hasValue:!1,value:null};i.current=s}else s=i.current;i=A7(function(){function c(p){if(!u){if(u=!0,d=p,p=n(p),a!==void 0&&s.hasValue){var x=s.value;if(a(x,p))return f=x}return f=p}if(x=f,S7(d,p))return x;var g=n(p);return a!==void 0&&a(x,g)?(d=p,x):(d=p,f=g)}var u=!1,d,f,m=r===void 0?null:r;return[function(){return c(t())},m===null?void 0:function(){return c(m())}]},[t,r,n,a]);var o=_7(e,i[0],i[1]);return E7(function(){s.hasValue=!0,s.value=o},[o]),T7(o),o};fP.exports=hP;var P7=fP.exports,Lb=N.createContext(null),O7=e=>e,fr=()=>{var e=N.useContext(Lb);return e?e.store.dispatch:O7},kh=()=>{},D7=()=>kh,I7=(e,t)=>e===t;function st(e){var t=N.useContext(Lb);return P7.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:D7,t?t.store.getState:kh,t?t.store.getState:kh,t?e:kh,I7)}function R7(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function F7(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function M7(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var ES=e=>Array.isArray(e)?e:[e];function L7(e){const t=Array.isArray(e[0])?e[0]:e;return M7(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function B7(e,t){const r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var j7=class{constructor(e){this.value=e}deref(){return this.value}},$7=typeof WeakRef<"u"?WeakRef:j7,U7=0,AS=1;function F0(){return{s:U7,v:void 0,o:null,p:null}}function gP(e,t={}){let r=F0();const{resultEqualityCheck:n}=t;let a,i=0;function s(){var f;let o=r;const{length:c}=arguments;for(let m=0,p=c;m<p;m++){const x=arguments[m];if(typeof x=="function"||typeof x=="object"&&x!==null){let g=o.o;g===null&&(o.o=g=new WeakMap);const y=g.get(x);y===void 0?(o=F0(),g.set(x,o)):o=y}else{let g=o.p;g===null&&(o.p=g=new Map);const y=g.get(x);y===void 0?(o=F0(),g.set(x,o)):o=y}}const u=o;let d;if(o.s===AS)d=o.v;else if(d=e.apply(null,arguments),i++,n){const m=((f=a==null?void 0:a.deref)==null?void 0:f.call(a))??a;m!=null&&n(m,d)&&(d=m,i!==0&&i--),a=typeof d=="object"&&d!==null||typeof d=="function"?new $7(d):d}return u.s=AS,u.v=d,d}return s.clearCache=()=>{r=F0(),s.resetResultsCount()},s.resultsCount=()=>i,s.resetResultsCount=()=>{i=0},s}function z7(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let i=0,s=0,o,c={},u=a.pop();typeof u=="object"&&(c=u,u=a.pop()),R7(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...r,...c},{memoize:f,memoizeOptions:m=[],argsMemoize:p=gP,argsMemoizeOptions:x=[],devModeChecks:g={}}=d,y=ES(m),v=ES(x),b=L7(a),w=f(function(){return i++,u.apply(null,arguments)},...y),k=p(function(){s++;const _=B7(b,arguments);return o=w.apply(null,_),o},...v);return Object.assign(k,{resultFunc:u,memoizedResultFunc:w,dependencies:b,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>o,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:f,argsMemoize:p})};return Object.assign(n,{withTypes:()=>n}),n}var xe=z7(gP),H7=Object.assign((e,t=xe)=>{F7(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(i=>e[i]);return t(n,(...i)=>i.reduce((s,o,c)=>(s[r[c]]=o,s),{}))},{withTypes:()=>H7}),xP={},yP={},vP={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,i)=>{if(n!==a){const s=t(n),o=t(a);if(s===o&&s===0){if(n<a)return i==="desc"?1:-1;if(n>a)return i==="desc"?-1:1}return i==="desc"?o-s:s-o}return 0};e.compareValues=r})(vP);var bP={},Bb={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(Bb);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Bb,r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,s){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(n.test(i)||!r.test(i))||s!=null&&Object.hasOwn(s,i)}e.isKey=a})(bP);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=vP,r=bP,n=Pp;function a(i,s,o,c){if(i==null)return[];o=c?void 0:o,Array.isArray(i)||(i=Object.values(i)),Array.isArray(s)||(s=s==null?[null]:[s]),s.length===0&&(s=[null]),Array.isArray(o)||(o=o==null?[]:[o]),o=o.map(p=>String(p));const u=(p,x)=>{let g=p;for(let y=0;y<x.length&&g!=null;++y)g=g[x[y]];return g},d=(p,x)=>x==null||p==null?x:typeof p=="object"&&"key"in p?Object.hasOwn(x,p.key)?x[p.key]:u(x,p.path):typeof p=="function"?p(x):Array.isArray(p)?u(x,p):typeof x=="object"?x[p]:x,f=s.map(p=>(Array.isArray(p)&&p.length===1&&(p=p[0]),p==null||typeof p=="function"||Array.isArray(p)||r.isKey(p)?p:{key:p,path:n.toPath(p)}));return i.map(p=>({original:p,criteria:f.map(x=>d(x,p))})).slice().sort((p,x)=>{for(let g=0;g<f.length;g++){const y=t.compareValues(p.criteria[g],x.criteria[g],o[g]);if(y!==0)return y}return 0}).map(p=>p.original)}e.orderBy=a})(yP);var wP={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const a=[],i=Math.floor(n),s=(o,c)=>{for(let u=0;u<o.length;u++){const d=o[u];Array.isArray(d)&&c<i?s(d,c+1):a.push(d)}};return s(r,0),a}e.flatten=t})(wP);var jb={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Mb,r=Op,n=Tb,a=Ob;function i(s,o,c){return n.isObject(c)&&(typeof o=="number"&&r.isArrayLike(c)&&t.isIndex(o)&&o<c.length||typeof o=="string"&&o in c)?a.eq(c[o],s):!1}e.isIterateeCall=i})(jb);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=yP,r=wP,n=jb;function a(i,...s){const o=s.length;return o>1&&n.isIterateeCall(i,s[0],s[1])?s=[]:o>2&&n.isIterateeCall(s[0],s[1],s[2])&&(s=[s[0]]),t.orderBy(i,r.flatten(s),["asc"])}e.sortBy=a})(xP);var W7=xP.sortBy;const Ip=$s(W7);var NP=e=>e.legend.settings,G7=e=>e.legend.size,V7=e=>e.legend.payload,K7=xe([V7,NP],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?Ip(n,r):n});function q7(){return st(K7)}var M0=1;function kP(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=N.useState({height:0,left:0,top:0,width:0}),n=N.useCallback(a=>{if(a!=null){var i=a.getBoundingClientRect(),s={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(s.height-t.height)>M0||Math.abs(s.left-t.left)>M0||Math.abs(s.top-t.top)>M0||Math.abs(s.width-t.width)>M0)&&r({height:s.height,left:s.left,top:s.top,width:s.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function hn(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var X7=(()=>typeof Symbol=="function"&&Symbol.observable||"@@observable")(),TS=X7,bx=()=>Math.random().toString(36).substring(7).split("").join("."),Y7={INIT:`@@redux/INIT${bx()}`,REPLACE:`@@redux/REPLACE${bx()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${bx()}`},lm=Y7;function $b(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function SP(e,t,r){if(typeof e!="function")throw new Error(hn(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(hn(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(hn(1));return r(SP)(e,t)}let n=e,a=t,i=new Map,s=i,o=0,c=!1;function u(){s===i&&(s=new Map,i.forEach((y,v)=>{s.set(v,y)}))}function d(){if(c)throw new Error(hn(3));return a}function f(y){if(typeof y!="function")throw new Error(hn(4));if(c)throw new Error(hn(5));let v=!0;u();const b=o++;return s.set(b,y),function(){if(v){if(c)throw new Error(hn(6));v=!1,u(),s.delete(b),i=null}}}function m(y){if(!$b(y))throw new Error(hn(7));if(typeof y.type>"u")throw new Error(hn(8));if(typeof y.type!="string")throw new Error(hn(17));if(c)throw new Error(hn(9));try{c=!0,a=n(a,y)}finally{c=!1}return(i=s).forEach(b=>{b()}),y}function p(y){if(typeof y!="function")throw new Error(hn(10));n=y,m({type:lm.REPLACE})}function x(){const y=f;return{subscribe(v){if(typeof v!="object"||v===null)throw new Error(hn(11));function b(){const k=v;k.next&&k.next(d())}return b(),{unsubscribe:y(b)}},[TS](){return this}}}return m({type:lm.INIT}),{dispatch:m,subscribe:f,getState:d,replaceReducer:p,[TS]:x}}function J7(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:lm.INIT})>"u")throw new Error(hn(12));if(typeof r(void 0,{type:lm.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(hn(13))})}function _P(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const s=t[i];typeof e[s]=="function"&&(r[s]=e[s])}const n=Object.keys(r);let a;try{J7(r)}catch(i){a=i}return function(s={},o){if(a)throw a;let c=!1;const u={};for(let d=0;d<n.length;d++){const f=n[d],m=r[f],p=s[f],x=m(p,o);if(typeof x>"u")throw o&&o.type,new Error(hn(14));u[f]=x,c=c||x!==p}return c=c||n.length!==Object.keys(s).length,c?u:s}}function cm(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function Q7(...e){return t=>(r,n)=>{const a=t(r,n);let i=()=>{throw new Error(hn(15))};const s={getState:a.getState,dispatch:(c,...u)=>i(c,...u)},o=e.map(c=>c(s));return i=cm(...o)(a.dispatch),{...a,dispatch:i}}}function CP(e){return $b(e)&&"type"in e&&typeof e.type=="string"}var EP=Symbol.for("immer-nothing"),PS=Symbol.for("immer-draftable"),Ma=Symbol.for("immer-state");function _i(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var nu=Object.getPrototypeOf;function Pl(e){return!!e&&!!e[Ma]}function Ms(e){var t;return e?AP(e)||Array.isArray(e)||!!e[PS]||!!((t=e.constructor)!=null&&t[PS])||Bf(e)||Fp(e):!1}var Z7=Object.prototype.constructor.toString();function AP(e){if(!e||typeof e!="object")return!1;const t=nu(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===Z7}function um(e,t){Rp(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function Rp(e){const t=e[Ma];return t?t.type_:Array.isArray(e)?1:Bf(e)?2:Fp(e)?3:0}function dv(e,t){return Rp(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function TP(e,t,r){const n=Rp(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function e9(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Bf(e){return e instanceof Map}function Fp(e){return e instanceof Set}function Zo(e){return e.copy_||e.base_}function fv(e,t){if(Bf(e))return new Map(e);if(Fp(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=AP(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[Ma];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const s=a[i],o=n[s];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[s]})}return Object.create(nu(e),n)}else{const n=nu(e);if(n!==null&&r)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function Ub(e,t=!1){return Mp(e)||Pl(e)||!Ms(e)||(Rp(e)>1&&Object.defineProperties(e,{set:{value:L0},add:{value:L0},clear:{value:L0},delete:{value:L0}}),Object.freeze(e),t&&Object.values(e).forEach(r=>Ub(r,!0))),e}function L0(){_i(2)}function Mp(e){return Object.isFrozen(e)}var t9={};function Ol(e){const t=t9[e];return t||_i(0,e),t}var Zd;function PP(){return Zd}function r9(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function OS(e,t){t&&(Ol("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function hv(e){mv(e),e.drafts_.forEach(n9),e.drafts_=null}function mv(e){e===Zd&&(Zd=e.parent_)}function DS(e){return Zd=r9(Zd,e)}function n9(e){const t=e[Ma];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function IS(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[Ma].modified_&&(hv(t),_i(4)),Ms(e)&&(e=dm(t,e),t.parent_||fm(t,e)),t.patches_&&Ol("Patches").generateReplacementPatches_(r[Ma].base_,e,t.patches_,t.inversePatches_)):e=dm(t,r,[]),hv(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==EP?e:void 0}function dm(e,t,r){if(Mp(t))return t;const n=t[Ma];if(!n)return um(t,(a,i)=>RS(e,n,t,a,i,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return fm(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const a=n.copy_;let i=a,s=!1;n.type_===3&&(i=new Set(a),a.clear(),s=!0),um(i,(o,c)=>RS(e,n,a,o,c,r,s)),fm(e,a,!1),r&&e.patches_&&Ol("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function RS(e,t,r,n,a,i,s){if(Pl(a)){const o=i&&t&&t.type_!==3&&!dv(t.assigned_,n)?i.concat(n):void 0,c=dm(e,a,o);if(TP(r,n,c),Pl(c))e.canAutoFreeze_=!1;else return}else s&&r.add(a);if(Ms(a)&&!Mp(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;dm(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(Bf(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&fm(e,a)}}function fm(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Ub(t,r)}function a9(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:PP(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,i=zb;r&&(a=[n],i=ef);const{revoke:s,proxy:o}=Proxy.revocable(a,i);return n.draft_=o,n.revoke_=s,o}var zb={get(e,t){if(t===Ma)return e;const r=Zo(e);if(!dv(r,t))return i9(e,r,t);const n=r[t];return e.finalized_||!Ms(n)?n:n===wx(e.base_,t)?(Nx(e),e.copy_[t]=gv(n,e)):n},has(e,t){return t in Zo(e)},ownKeys(e){return Reflect.ownKeys(Zo(e))},set(e,t,r){const n=OP(Zo(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=wx(Zo(e),t),i=a==null?void 0:a[Ma];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(e9(r,a)&&(r!==void 0||dv(e.base_,t)))return!0;Nx(e),pv(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return wx(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Nx(e),pv(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Zo(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){_i(11)},getPrototypeOf(e){return nu(e.base_)},setPrototypeOf(){_i(12)}},ef={};um(zb,(e,t)=>{ef[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});ef.deleteProperty=function(e,t){return ef.set.call(this,e,t,void 0)};ef.set=function(e,t,r){return zb.set.call(this,e[0],t,r,e[0])};function wx(e,t){const r=e[Ma];return(r?Zo(r):e)[t]}function i9(e,t,r){var a;const n=OP(t,r);return n?"value"in n?n.value:(a=n.get)==null?void 0:a.call(e.draft_):void 0}function OP(e,t){if(!(t in e))return;let r=nu(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=nu(r)}}function pv(e){e.modified_||(e.modified_=!0,e.parent_&&pv(e.parent_))}function Nx(e){e.copy_||(e.copy_=fv(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var s9=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const s=this;return function(c=i,...u){return s.produce(c,d=>r.call(this,d,...u))}}typeof r!="function"&&_i(6),n!==void 0&&typeof n!="function"&&_i(7);let a;if(Ms(t)){const i=DS(this),s=gv(t,void 0);let o=!0;try{a=r(s),o=!1}finally{o?hv(i):mv(i)}return OS(i,n),IS(a,i)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===EP&&(a=void 0),this.autoFreeze_&&Ub(a,!0),n){const i=[],s=[];Ol("Patches").generateReplacementPatches_(t,a,i,s),n(i,s)}return a}else _i(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(s,...o)=>this.produceWithPatches(s,c=>t(c,...o));let n,a;return[this.produce(t,r,(s,o)=>{n=s,a=o}),n,a]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Ms(e)||_i(8),Pl(e)&&(e=_s(e));const t=DS(this),r=gv(e,void 0);return r[Ma].isManual_=!0,mv(t),r}finishDraft(e,t){const r=e&&e[Ma];(!r||!r.isManual_)&&_i(9);const{scope_:n}=r;return OS(n,t),IS(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const n=Ol("Patches").applyPatches_;return Pl(e)?n(e,t):this.produce(e,a=>n(a,t))}};function gv(e,t){const r=Bf(e)?Ol("MapSet").proxyMap_(e,t):Fp(e)?Ol("MapSet").proxySet_(e,t):a9(e,t);return(t?t.scope_:PP()).drafts_.push(r),r}function _s(e){return Pl(e)||_i(10,e),DP(e)}function DP(e){if(!Ms(e)||Mp(e))return e;const t=e[Ma];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=fv(e,t.scope_.immer_.useStrictShallowCopy_)}else r=fv(e,!0);return um(r,(n,a)=>{TP(r,n,DP(a))}),t&&(t.finalized_=!1),r}var o9=new s9,IP=o9.produce;function RP(e){return({dispatch:r,getState:n})=>a=>i=>typeof i=="function"?i(r,n,e):a(i)}var l9=RP(),c9=RP,u9=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?cm:cm.apply(null,arguments)};function fi(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(Oa(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>CP(n)&&n.type===e,r}var FP=class cd extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,cd.prototype)}static get[Symbol.species](){return cd}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new cd(...t[0].concat(this)):new cd(...t.concat(this))}};function FS(e){return Ms(e)?IP(e,()=>{}):e}function B0(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function d9(e){return typeof e=="boolean"}var f9=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:i=!0}=t??{};let s=new FP;return r&&(d9(r)?s.push(l9):s.push(c9(r.extraArgument))),s},MP="RTK_autoBatch",Yn=()=>e=>({payload:e,meta:{[MP]:!0}}),MS=e=>t=>{setTimeout(t,e)},LP=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let a=!0,i=!1,s=!1;const o=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:MS(10):e.type==="callback"?e.queueNotification:MS(e.timeout),u=()=>{s=!1,i&&(i=!1,o.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const f=()=>a&&d(),m=n.subscribe(f);return o.add(d),()=>{m(),o.delete(d)}},dispatch(d){var f;try{return a=!((f=d==null?void 0:d.meta)!=null&&f[MP]),i=!a,i&&(s||(s=!0,c(u))),n.dispatch(d)}finally{a=!0}}})},h9=e=>function(r){const{autoBatch:n=!0}=r??{};let a=new FP(e);return n&&a.push(LP(typeof n=="object"?n:void 0)),a};function m9(e){const t=f9(),{reducer:r=void 0,middleware:n,devTools:a=!0,duplicateMiddlewareCheck:i=!0,preloadedState:s=void 0,enhancers:o=void 0}=e||{};let c;if(typeof r=="function")c=r;else if($b(r))c=_P(r);else throw new Error(Oa(1));let u;typeof n=="function"?u=n(t):u=t();let d=cm;a&&(d=u9({trace:!1,...typeof a=="object"&&a}));const f=Q7(...u),m=h9(f);let p=typeof o=="function"?o(m):m();const x=d(...p);return SP(c,s,x)}function BP(e){const t={},r=[];let n;const a={addCase(i,s){const o=typeof i=="string"?i:i.type;if(!o)throw new Error(Oa(28));if(o in t)throw new Error(Oa(29));return t[o]=s,a},addAsyncThunk(i,s){return s.pending&&(t[i.pending.type]=s.pending),s.rejected&&(t[i.rejected.type]=s.rejected),s.fulfilled&&(t[i.fulfilled.type]=s.fulfilled),s.settled&&r.push({matcher:i.settled,reducer:s.settled}),a},addMatcher(i,s){return r.push({matcher:i,reducer:s}),a},addDefaultCase(i){return n=i,a}};return e(a),[t,r,n]}function p9(e){return typeof e=="function"}function g9(e,t){let[r,n,a]=BP(t),i;if(p9(e))i=()=>FS(e());else{const o=FS(e);i=()=>o}function s(o=i(),c){let u=[r[c.type],...n.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[a]),u.reduce((d,f)=>{if(f)if(Pl(d)){const p=f(d,c);return p===void 0?d:p}else{if(Ms(d))return IP(d,m=>f(m,c));{const m=f(d,c);if(m===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return m}}return d},o)}return s.getInitialState=i,s}var x9="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",y9=(e=21)=>{let t="",r=e;for(;r--;)t+=x9[Math.random()*64|0];return t},v9=Symbol.for("rtk-slice-createasyncthunk");function b9(e,t){return`${e}/${t}`}function w9({creators:e}={}){var r;const t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[v9];return function(a){const{name:i,reducerPath:s=i}=a;if(!i)throw new Error(Oa(11));typeof process<"u";const o=(typeof a.reducers=="function"?a.reducers(k9()):a.reducers)||{},c=Object.keys(o),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(k,S){const _=typeof k=="string"?k:k.type;if(!_)throw new Error(Oa(12));if(_ in u.sliceCaseReducersByType)throw new Error(Oa(13));return u.sliceCaseReducersByType[_]=S,d},addMatcher(k,S){return u.sliceMatchers.push({matcher:k,reducer:S}),d},exposeAction(k,S){return u.actionCreators[k]=S,d},exposeCaseReducer(k,S){return u.sliceCaseReducersByName[k]=S,d}};c.forEach(k=>{const S=o[k],_={reducerName:k,type:b9(i,k),createNotation:typeof a.reducers=="function"};_9(S)?E9(_,S,d,t):S9(_,S,d)});function f(){const[k={},S=[],_=void 0]=typeof a.extraReducers=="function"?BP(a.extraReducers):[a.extraReducers],C={...k,...u.sliceCaseReducersByType};return g9(a.initialState,E=>{for(let A in C)E.addCase(A,C[A]);for(let A of u.sliceMatchers)E.addMatcher(A.matcher,A.reducer);for(let A of S)E.addMatcher(A.matcher,A.reducer);_&&E.addDefaultCase(_)})}const m=k=>k,p=new Map,x=new WeakMap;let g;function y(k,S){return g||(g=f()),g(k,S)}function v(){return g||(g=f()),g.getInitialState()}function b(k,S=!1){function _(E){let A=E[k];return typeof A>"u"&&S&&(A=B0(x,_,v)),A}function C(E=m){const A=B0(p,S,()=>new WeakMap);return B0(A,E,()=>{const T={};for(const[D,I]of Object.entries(a.selectors??{}))T[D]=N9(I,E,()=>B0(x,E,v),S);return T})}return{reducerPath:k,getSelectors:C,get selectors(){return C(_)},selectSlice:_}}const w={name:i,reducer:y,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:v,...b(s),injectInto(k,{reducerPath:S,..._}={}){const C=S??s;return k.inject({reducerPath:C,reducer:y},_),{...w,...b(C,!0)}}};return w}}function N9(e,t,r,n){function a(i,...s){let o=t(i);return typeof o>"u"&&n&&(o=r()),e(o,...s)}return a.unwrapped=e,a}var Ua=w9();function k9(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function S9({type:e,reducerName:t,createNotation:r},n,a){let i,s;if("reducer"in n){if(r&&!C9(n))throw new Error(Oa(17));i=n.reducer,s=n.prepare}else i=n;a.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,s?fi(e,s):fi(e))}function _9(e){return e._reducerDefinitionType==="asyncThunk"}function C9(e){return e._reducerDefinitionType==="reducerWithPrepare"}function E9({type:e,reducerName:t},r,n,a){if(!a)throw new Error(Oa(18));const{payloadCreator:i,fulfilled:s,pending:o,rejected:c,settled:u,options:d}=r,f=a(e,i,d);n.exposeAction(t,f),s&&n.addCase(f.fulfilled,s),o&&n.addCase(f.pending,o),c&&n.addCase(f.rejected,c),u&&n.addMatcher(f.settled,u),n.exposeCaseReducer(t,{fulfilled:s||j0,pending:o||j0,rejected:c||j0,settled:u||j0})}function j0(){}var A9="task",jP="listener",$P="completed",Hb="cancelled",T9=`task-${Hb}`,P9=`task-${$P}`,xv=`${jP}-${Hb}`,O9=`${jP}-${$P}`,Lp=class{constructor(e){Lg(this,"name","TaskAbortError");Lg(this,"message");this.code=e,this.message=`${A9} ${Hb} (reason: ${e})`}},Wb=(e,t)=>{if(typeof e!="function")throw new TypeError(Oa(32))},hm=()=>{},UP=(e,t=hm)=>(e.catch(t),e),zP=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),ml=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},pl=e=>{if(e.aborted){const{reason:t}=e;throw new Lp(t)}};function HP(e,t){let r=hm;return new Promise((n,a)=>{const i=()=>a(new Lp(e.reason));if(e.aborted){i();return}r=zP(e,i),t.finally(()=>r()).then(n,a)}).finally(()=>{r=hm})}var D9=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof Lp?"cancelled":"rejected",error:r}}finally{t==null||t()}},mm=e=>t=>UP(HP(e,t).then(r=>(pl(e),r))),WP=e=>{const t=mm(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:jc}=Object,LS={},Bp="listenerMiddleware",I9=(e,t)=>{const r=n=>zP(e,()=>ml(n,e.reason));return(n,a)=>{Wb(n);const i=new AbortController;r(i);const s=D9(async()=>{pl(e),pl(i.signal);const o=await n({pause:mm(i.signal),delay:WP(i.signal),signal:i.signal});return pl(i.signal),o},()=>ml(i,P9));return a!=null&&a.autoJoin&&t.push(s.catch(hm)),{result:mm(e)(s),cancel(){ml(i,T9)}}}},R9=(e,t)=>{const r=async(n,a)=>{pl(t);let i=()=>{};const o=[new Promise((c,u)=>{let d=e({predicate:n,effect:(f,m)=>{m.unsubscribe(),c([f,m.getState(),m.getOriginalState()])}});i=()=>{d(),u()}})];a!=null&&o.push(new Promise(c=>setTimeout(c,a,null)));try{const c=await HP(t,Promise.race(o));return pl(t),c}finally{i()}};return(n,a)=>UP(r(n,a))},GP=e=>{let{type:t,actionCreator:r,matcher:n,predicate:a,effect:i}=e;if(t)a=fi(t).match;else if(r)t=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(Oa(21));return Wb(i),{predicate:a,type:t,effect:i}},VP=jc(e=>{const{type:t,predicate:r,effect:n}=GP(e);return{id:y9(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Oa(22))}}},{withTypes:()=>VP}),BS=(e,t)=>{const{type:r,effect:n,predicate:a}=GP(t);return Array.from(e.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===a)&&i.effect===n)},yv=e=>{e.pending.forEach(t=>{ml(t,xv)})},F9=(e,t)=>()=>{for(const r of t.keys())yv(r);e.clear()},jS=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},KP=jc(fi(`${Bp}/add`),{withTypes:()=>KP}),M9=fi(`${Bp}/removeAll`),qP=jc(fi(`${Bp}/remove`),{withTypes:()=>qP}),L9=(...e)=>{console.error(`${Bp}/error`,...e)},jf=(e={})=>{const t=new Map,r=new Map,n=p=>{const x=r.get(p)??0;r.set(p,x+1)},a=p=>{const x=r.get(p)??1;x===1?r.delete(p):r.set(p,x-1)},{extra:i,onError:s=L9}=e;Wb(s);const o=p=>(p.unsubscribe=()=>t.delete(p.id),t.set(p.id,p),x=>{p.unsubscribe(),x!=null&&x.cancelActive&&yv(p)}),c=p=>{const x=BS(t,p)??VP(p);return o(x)};jc(c,{withTypes:()=>c});const u=p=>{const x=BS(t,p);return x&&(x.unsubscribe(),p.cancelActive&&yv(x)),!!x};jc(u,{withTypes:()=>u});const d=async(p,x,g,y)=>{const v=new AbortController,b=R9(c,v.signal),w=[];try{p.pending.add(v),n(p),await Promise.resolve(p.effect(x,jc({},g,{getOriginalState:y,condition:(k,S)=>b(k,S).then(Boolean),take:b,delay:WP(v.signal),pause:mm(v.signal),extra:i,signal:v.signal,fork:I9(v.signal,w),unsubscribe:p.unsubscribe,subscribe:()=>{t.set(p.id,p)},cancelActiveListeners:()=>{p.pending.forEach((k,S,_)=>{k!==v&&(ml(k,xv),_.delete(k))})},cancel:()=>{ml(v,xv),p.pending.delete(v)},throwIfCancelled:()=>{pl(v.signal)}})))}catch(k){k instanceof Lp||jS(s,k,{raisedBy:"effect"})}finally{await Promise.all(w),ml(v,O9),a(p),p.pending.delete(v)}},f=F9(t,r);return{middleware:p=>x=>g=>{if(!CP(g))return x(g);if(KP.match(g))return c(g.payload);if(M9.match(g)){f();return}if(qP.match(g))return u(g.payload);let y=p.getState();const v=()=>{if(y===LS)throw new Error(Oa(23));return y};let b;try{if(b=x(g),t.size>0){const w=p.getState(),k=Array.from(t.values());for(const S of k){let _=!1;try{_=S.predicate(g,w,y)}catch(C){_=!1,jS(s,C,{raisedBy:"predicate"})}_&&d(S,g,p,v)}}}finally{y=LS}return b},startListening:c,stopListening:u,clearListeners:f}};function Oa(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var B9={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},XP=Ua({name:"chartLayout",initialState:B9,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,a,i;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(a=t.payload.bottom)!==null&&a!==void 0?a:0,e.margin.left=(i=t.payload.left)!==null&&i!==void 0?i:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:j9,setLayout:$9,setChartSize:U9,setScale:z9}=XP.actions,H9=XP.reducer;function $S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function US(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$S(Object(r),!0).forEach(function(n){W9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$S(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function W9(e,t,r){return(t=G9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function G9(e){var t=V9(e,"string");return typeof t=="symbol"?t:t+""}function V9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pm=Math.PI/180,K9=e=>e*180/Math.PI,Ur=(e,t,r,n)=>({x:e+Math.cos(-pm*n)*r,y:t+Math.sin(-pm*n)*r}),YP=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0,width:0,height:0,brushBottom:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},q9=(e,t)=>{var{x:r,y:n}=e,{x:a,y:i}=t;return Math.sqrt((r-a)**2+(n-i)**2)},X9=(e,t)=>{var{x:r,y:n}=e,{cx:a,cy:i}=t,s=q9({x:r,y:n},{x:a,y:i});if(s<=0)return{radius:s,angle:0};var o=(r-a)/s,c=Math.acos(o);return n>i&&(c=2*Math.PI-c),{radius:s,angle:K9(c),angleInRadian:c}},Y9=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),a=Math.floor(r/360),i=Math.min(n,a);return{startAngle:t-i*360,endAngle:r-i*360}},J9=(e,t)=>{var{startAngle:r,endAngle:n}=t,a=Math.floor(r/360),i=Math.floor(n/360),s=Math.min(a,i);return e+s*360},Q9=(e,t)=>{var{x:r,y:n}=e,{radius:a,angle:i}=X9({x:r,y:n},t),{innerRadius:s,outerRadius:o}=t;if(a<s||a>o||a===0)return null;var{startAngle:c,endAngle:u}=Y9(t),d=i,f;if(c<=u){for(;d>u;)d-=360;for(;d<c;)d+=360;f=d>=c&&d<=u}else{for(;d>c;)d-=360;for(;d<u;)d+=360;f=d>=u&&d<=c}return f?US(US({},t),{},{radius:a,angle:J9(d,t)}):null};function JP(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function zS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ni(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zS(Object(r),!0).forEach(function(n){Z9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Z9(e,t,r){return(t=e$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function e$(e){var t=t$(e,"string");return typeof t=="symbol"?t:t+""}function t$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zt(e,t,r){return dr(e)||dr(t)?r:ns(t)?Tl(e,t,r):typeof t=="function"?t(e):r}var r$=(e,t,r,n,a)=>{var i,s=-1,o=(i=t==null?void 0:t.length)!==null&&i!==void 0?i:0;if(o<=1||e==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var c=0;c<o;c++){var u=c>0?r[c-1].coordinate:r[o-1].coordinate,d=r[c].coordinate,f=c>=o-1?r[0].coordinate:r[c+1].coordinate,m=void 0;if(ln(d-u)!==ln(f-d)){var p=[];if(ln(f-d)===ln(a[1]-a[0])){m=f;var x=d+a[1]-a[0];p[0]=Math.min(x,(x+u)/2),p[1]=Math.max(x,(x+u)/2)}else{m=u;var g=f+a[1]-a[0];p[0]=Math.min(d,(g+d)/2),p[1]=Math.max(d,(g+d)/2)}var y=[Math.min(d,(m+d)/2),Math.max(d,(m+d)/2)];if(e>y[0]&&e<=y[1]||e>=p[0]&&e<=p[1]){({index:s}=r[c]);break}}else{var v=Math.min(u,f),b=Math.max(u,f);if(e>(v+d)/2&&e<=(b+d)/2){({index:s}=r[c]);break}}}else if(t){for(var w=0;w<o;w++)if(w===0&&e<=(t[w].coordinate+t[w+1].coordinate)/2||w>0&&w<o-1&&e>(t[w].coordinate+t[w-1].coordinate)/2&&e<=(t[w].coordinate+t[w+1].coordinate)/2||w===o-1&&e>(t[w].coordinate+t[w-1].coordinate)/2){({index:s}=t[w]);break}}return s},n$=(e,t,r)=>{if(t&&r){var{width:n,height:a}=r,{align:i,verticalAlign:s,layout:o}=t;if((o==="vertical"||o==="horizontal"&&s==="middle")&&i!=="center"&&lt(e[i]))return ni(ni({},e),{},{[i]:e[i]+(n||0)});if((o==="horizontal"||o==="vertical"&&i==="center")&&s!=="middle"&&lt(e[s]))return ni(ni({},e),{},{[s]:e[s]+(a||0)})}return e},jo=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",QP=(e,t,r,n)=>{if(n)return e.map(o=>o.coordinate);var a,i,s=e.map(o=>(o.coordinate===t&&(a=!0),o.coordinate===r&&(i=!0),o.coordinate));return a||s.push(t),i||s.push(r),s},ZP=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:a,range:i,scale:s,realScaleType:o,isCategorical:c,categoricalDomain:u,tickCount:d,ticks:f,niceTicks:m,axisType:p}=e;if(!s)return null;var x=o==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,g=(t||r)&&a==="category"&&s.bandwidth?s.bandwidth()/x:0;if(g=p==="angleAxis"&&i&&i.length>=2?ln(i[0]-i[1])*2*g:g,t&&(f||m)){var y=(f||m||[]).map((v,b)=>{var w=n?n.indexOf(v):v;return{coordinate:s(w)+g,value:v,offset:g,index:b}});return y.filter(v=>!di(v.coordinate))}return c&&u?u.map((v,b)=>({coordinate:s(v)+g,value:v,index:b,offset:g})):s.ticks&&!r&&d!=null?s.ticks(d).map((v,b)=>({coordinate:s(v)+g,value:v,offset:g,index:b})):s.domain().map((v,b)=>({coordinate:s(v)+g,value:n?n[v]:v,index:b,offset:g}))},HS=1e-4,a$=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),a=Math.min(n[0],n[1])-HS,i=Math.max(n[0],n[1])+HS,s=e(t[0]),o=e(t[r-1]);(s<a||s>i||o<a||o>i)&&e.domain([t[0],t[r-1]])}},i$=(e,t)=>{if(!t||t.length!==2||!lt(t[0])||!lt(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!lt(e[0])||e[0]<r)&&(a[0]=r),(!lt(e[1])||e[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},s$=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0,s=0;s<t;++s){var o=di(e[s][r][1])?e[s][r][0]:e[s][r][1];o>=0?(e[s][r][0]=a,e[s][r][1]=a+o,a=e[s][r][1]):(e[s][r][0]=i,e[s][r][1]=i+o,i=e[s][r][1])}},o$=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0;i<t;++i){var s=di(e[i][r][1])?e[i][r][0]:e[i][r][1];s>=0?(e[i][r][0]=a,e[i][r][1]=a+s,a=e[i][r][1]):(e[i][r][0]=0,e[i][r][1]=0)}},l$={sign:s$,expand:Gj,none:tu,silhouette:Vj,wiggle:Kj,positive:o$},c$=(e,t,r)=>{var n=l$[r],a=Wj().keys(t).value((i,s)=>+Zt(i,s,0)).order(lv).offset(n);return a(e)};function u$(e){return e==null?void 0:String(e)}function WS(e){var{axis:t,ticks:r,bandSize:n,entry:a,index:i,dataKey:s}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!dr(a[t.dataKey])){var o=K3(r,"value",a[t.dataKey]);if(o)return o.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var c=Zt(a,dr(s)?t.dataKey:s);return dr(c)?null:t.scale(c)}var GS=e=>{var{axis:t,ticks:r,offset:n,bandSize:a,entry:i,index:s}=e;if(t.type==="category")return r[s]?r[s].coordinate+n:null;var o=Zt(i,t.dataKey,t.scale.domain()[s]);return dr(o)?null:t.scale(o)-a/2+n},d$=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},f$=e=>{var t=e.flat(2).filter(lt);return[Math.min(...t),Math.max(...t)]},h$=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],m$=(e,t,r)=>{if(e!=null)return h$(Object.keys(e).reduce((n,a)=>{var i=e[a],{stackedData:s}=i,o=s.reduce((c,u)=>{var d=JP(u,t,r),f=f$(d);return[Math.min(c[0],f[0]),Math.max(c[1],f[1])]},[1/0,-1/0]);return[Math.min(o[0],n[0]),Math.max(o[1],n[1])]},[1/0,-1/0]))},VS=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,KS=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,tf=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var a=Ip(t,d=>d.coordinate),i=1/0,s=1,o=a.length;s<o;s++){var c=a[s],u=a[s-1];i=Math.min((c.coordinate||0)-(u.coordinate||0),i)}return i===1/0?0:i}return r?void 0:0};function qS(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:a,name:i}=e;return ni(ni({},t),{},{dataKey:r,payload:n,value:a,name:i})}function wu(e,t){if(e)return String(e);if(typeof t=="string")return t}function p$(e,t,r,n,a){if(r==="horizontal"||r==="vertical"){var i=e>=a.left&&e<=a.left+a.width&&t>=a.top&&t<=a.top+a.height;return i?{x:e,y:t}:null}return n?Q9({x:e,y:t},n):null}var g$=(e,t,r,n)=>{var a=t.find(u=>u&&u.index===r);if(a){if(e==="horizontal")return{x:a.coordinate,y:n.y};if(e==="vertical")return{x:n.x,y:a.coordinate};if(e==="centric"){var i=a.coordinate,{radius:s}=n;return ni(ni(ni({},n),Ur(n.cx,n.cy,s,i)),{},{angle:i,radius:s})}var o=a.coordinate,{angle:c}=n;return ni(ni(ni({},n),Ur(n.cx,n.cy,o,c)),{},{angle:c,radius:o})}return{x:0,y:0}},x$=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,zs=e=>e.layout.width,Hs=e=>e.layout.height,y$=e=>e.layout.scale,e6=e=>e.layout.margin,jp=xe(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),$p=xe(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),t6="data-recharts-item-index",r6="data-recharts-item-data-key",$f=60;function XS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XS(Object(r),!0).forEach(function(n){v$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function v$(e,t,r){return(t=b$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b$(e){var t=w$(e,"string");return typeof t=="symbol"?t:t+""}function w$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var N$=e=>e.brush.height;function k$(e){var t=$p(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:$f;return r+a}return r},0)}function S$(e){var t=$p(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:$f;return r+a}return r},0)}function _$(e){var t=jp(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function C$(e){var t=jp(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var Qr=xe([zs,Hs,e6,N$,k$,S$,_$,C$,NP,G7],(e,t,r,n,a,i,s,o,c,u)=>{var d={left:(r.left||0)+a,right:(r.right||0)+i},f={top:(r.top||0)+s,bottom:(r.bottom||0)+o},m=$0($0({},f),d),p=m.bottom;m.bottom+=n,m=n$(m,c,u);var x=e-m.left-m.right,g=t-m.top-m.bottom;return $0($0({brushBottom:p},m),{},{width:Math.max(x,0),height:Math.max(g,0)})}),E$=xe(Qr,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),Gb=xe(zs,Hs,(e,t)=>({x:0,y:0,width:e,height:t})),A$=N.createContext(null),aa=()=>N.useContext(A$)!=null,Up=e=>e.brush,zp=xe([Up,Qr,e6],(e,t,r)=>({height:e.height,x:lt(e.x)?e.x:t.left,y:lt(e.y)?e.y:t.top+t.height+t.brushBottom-((r==null?void 0:r.bottom)||0),width:lt(e.width)?e.width:t.width})),n6={},a6={},i6={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:a,edges:i}={}){let s,o=null;const c=i!=null&&i.includes("leading"),u=i==null||i.includes("trailing"),d=()=>{o!==null&&(r.apply(s,o),s=void 0,o=null)},f=()=>{u&&d(),g()};let m=null;const p=()=>{m!=null&&clearTimeout(m),m=setTimeout(()=>{m=null,f()},n)},x=()=>{m!==null&&(clearTimeout(m),m=null)},g=()=>{x(),s=void 0,o=null},y=()=>{d()},v=function(...b){if(a!=null&&a.aborted)return;s=this,o=b;const w=m==null;p(),c&&w&&d()};return v.schedule=p,v.cancel=g,v.flush=y,a==null||a.addEventListener("abort",g,{once:!0}),v}e.debounce=t})(i6);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=i6;function r(n,a=0,i={}){typeof i!="object"&&(i={});const{leading:s=!1,trailing:o=!0,maxWait:c}=i,u=Array(2);s&&(u[0]="leading"),o&&(u[1]="trailing");let d,f=null;const m=t.debounce(function(...g){d=n.apply(this,g),f=null},a,{edges:u}),p=function(...g){return c!=null&&(f===null&&(f=Date.now()),Date.now()-f>=c)?(d=n.apply(this,g),f=Date.now(),m.cancel(),m.schedule(),d):(m.apply(this,g),d)},x=()=>(m.flush(),d);return p.cancel=m.cancel,p.flush=x,p}e.debounce=r})(a6);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=a6;function r(n,a=0,i={}){const{leading:s=!0,trailing:o=!0}=i;return t.debounce(n,a,{leading:s,maxWait:a,trailing:o})}e.throttle=r})(n6);var T$=n6.throttle;const P$=$s(T$);var gm=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]},s6=(e,t,r)=>{var{width:n="100%",height:a="100%",aspect:i,maxHeight:s}=r,o=Fs(n)?e:Number(n),c=Fs(a)?t:Number(a);return i&&i>0&&(o?c=o/i:c&&(o=c*i),s&&c>s&&(c=s)),{calculatedWidth:o,calculatedHeight:c}},O$={width:0,height:0,overflow:"visible"},D$={width:0,overflowX:"visible"},I$={height:0,overflowY:"visible"},R$={},F$=e=>{var{width:t,height:r}=e,n=Fs(t),a=Fs(r);return n&&a?O$:n?D$:a?I$:R$};function M$(e){var{width:t,height:r,aspect:n}=e,a=t,i=r;return a===void 0&&i===void 0?(a="100%",i="100%"):a===void 0?a=n&&n>0?void 0:"100%":i===void 0&&(i=n&&n>0?void 0:"100%"),{width:a,height:i}}function zn(e){return Number.isFinite(e)}function au(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function vv(){return vv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vv.apply(null,arguments)}function YS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function JS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YS(Object(r),!0).forEach(function(n){L$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function L$(e,t,r){return(t=B$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function B$(e){var t=j$(e,"string");return typeof t=="symbol"?t:t+""}function j$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var o6=N.createContext({width:-1,height:-1});function l6(e){var{children:t,width:r,height:n}=e,a=N.useMemo(()=>({width:r,height:n}),[r,n]);return r<=0||n<=0?null:N.createElement(o6.Provider,{value:a},t)}var Vb=()=>N.useContext(o6),$$=N.forwardRef((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a,height:i,minWidth:s=0,minHeight:o,maxHeight:c,children:u,debounce:d=0,id:f,className:m,onResize:p,style:x={}}=e,g=N.useRef(null),y=N.useRef();y.current=p,N.useImperativeHandle(t,()=>g.current);var[v,b]=N.useState({containerWidth:n.width,containerHeight:n.height}),w=N.useCallback((E,A)=>{b(T=>{var D=Math.round(E),I=Math.round(A);return T.containerWidth===D&&T.containerHeight===I?T:{containerWidth:D,containerHeight:I}})},[]);N.useEffect(()=>{var E=I=>{var z,{width:X,height:H}=I[0].contentRect;w(X,H),(z=y.current)===null||z===void 0||z.call(y,X,H)};d>0&&(E=P$(E,d,{trailing:!0,leading:!1}));var A=new ResizeObserver(E),{width:T,height:D}=g.current.getBoundingClientRect();return w(T,D),A.observe(g.current),()=>{A.disconnect()}},[w,d]);var{containerWidth:k,containerHeight:S}=v;gm(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:_,calculatedHeight:C}=s6(k,S,{width:a,height:i,aspect:r,maxHeight:c});return gm(_>0||C>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,_,C,a,i,s,o,r),N.createElement("div",{id:f?"".concat(f):void 0,className:Ft("recharts-responsive-container",m),style:JS(JS({},x),{},{width:a,height:i,minWidth:s,minHeight:o,maxHeight:c}),ref:g},N.createElement("div",{style:F$({width:a,height:i})},N.createElement(l6,{width:_,height:C},u)))}),tr=N.forwardRef((e,t)=>{var r=Vb();if(au(r.width)&&au(r.height))return e.children;var{width:n,height:a}=M$({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:i,calculatedHeight:s}=s6(void 0,void 0,{width:n,height:a,aspect:e.aspect,maxHeight:e.maxHeight});return lt(i)&&lt(s)?N.createElement(l6,{width:i,height:s},e.children):N.createElement($$,vv({},e,{width:n,height:a,ref:t}))}),Hp=()=>{var e,t=aa(),r=st(E$),n=st(zp),a=(e=st(Up))===null||e===void 0?void 0:e.padding;return!t||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},U$={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},c6=()=>{var e;return(e=st(Qr))!==null&&e!==void 0?e:U$},Kb=()=>st(zs),qb=()=>st(Hs),z$=()=>st(e=>e.layout.margin),Ot=e=>e.layout.layoutType,Wp=()=>st(Ot),Gp=e=>{var t=fr(),r=aa(),{width:n,height:a}=e,i=Vb(),s=n,o=a;return i&&(s=i.width>0?i.width:n,o=i.height>0?i.height:a),N.useEffect(()=>{!r&&au(s)&&au(o)&&t(U9({width:s,height:o}))},[t,r,s,o]),null},H$={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},u6=Ua({name:"legend",initialState:H$,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:Yn()},removeLegendPayload:{reducer(e,t){var r=_s(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)},prepare:Yn()}}}),{setLegendSize:QS,setLegendSettings:W$,addLegendPayload:d6,removeLegendPayload:f6}=u6.actions,G$=u6.reducer,V$=["contextPayload"];function bv(){return bv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bv.apply(null,arguments)}function ZS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function iu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZS(Object(r),!0).forEach(function(n){Xb(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Xb(e,t,r){return(t=K$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K$(e){var t=q$(e,"string");return typeof t=="symbol"?t:t+""}function q$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function X$(e,t){if(e==null)return{};var r,n,a=Y$(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Y$(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function J$(e){return e.value}function Q$(e){var{contextPayload:t}=e,r=X$(e,V$),n=dP(t,e.payloadUniqBy,J$),a=iu(iu({},r),{},{payload:n});return N.isValidElement(e.content)?N.cloneElement(e.content,a):typeof e.content=="function"?N.createElement(e.content,a):N.createElement(Eb,a)}function Z$(e,t,r,n,a,i){var{layout:s,align:o,verticalAlign:c}=t,u,d;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(o==="center"&&s==="vertical"?u={left:((n||0)-i.width)/2}:u=o==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(c==="middle"?d={top:((a||0)-i.height)/2}:d=c==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),iu(iu({},u),d)}function eU(e){var t=fr();return N.useEffect(()=>{t(W$(e))},[t,e]),null}function tU(e){var t=fr();return N.useEffect(()=>(t(QS(e)),()=>{t(QS({width:0,height:0}))}),[t,e]),null}function rU(e){var t=q7(),r=mj(),n=z$(),{width:a,height:i,wrapperStyle:s,portal:o}=e,[c,u]=kP([t]),d=Kb(),f=qb();if(d==null||f==null)return null;var m=d-(n.left||0)-(n.right||0),p=Gt.getWidthOrHeight(e.layout,i,a,m),x=o?s:iu(iu({position:"absolute",width:(p==null?void 0:p.width)||a||"auto",height:(p==null?void 0:p.height)||i||"auto"},Z$(s,e,n,d,f,c)),s),g=o??r;if(g==null)return null;var y=N.createElement("div",{className:"recharts-legend-wrapper",style:x,ref:u},N.createElement(eU,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),N.createElement(tU,{width:c.width,height:c.height}),N.createElement(Q$,bv({},e,p,{margin:n,chartWidth:d,chartHeight:f,contextPayload:t})));return ib.createPortal(y,g)}class Gt extends N.PureComponent{static getWidthOrHeight(t,r,n,a){return t==="vertical"&&lt(r)?{height:r}:t==="horizontal"?{width:n||a}:null}render(){return N.createElement(rU,this.props)}}Xb(Gt,"displayName","Legend");Xb(Gt,"defaultProps",{align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"});function wv(){return wv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},wv.apply(null,arguments)}function e_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function kx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?e_(Object(r),!0).forEach(function(n){nU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):e_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nU(e,t,r){return(t=aU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aU(e){var t=iU(e,"string");return typeof t=="symbol"?t:t+""}function iU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sU(e){return Array.isArray(e)&&ns(e[0])&&ns(e[1])?e.join(" ~ "):e}var oU=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:i,formatter:s,itemSorter:o,wrapperClassName:c,labelClassName:u,label:d,labelFormatter:f,accessibilityLayer:m=!1}=e,p=()=>{if(i&&i.length){var S={padding:0,margin:0},_=(o?Ip(i,o):i).map((C,E)=>{if(C.type==="none")return null;var A=C.formatter||s||sU,{value:T,name:D}=C,I=T,z=D;if(A){var X=A(T,D,C,E,i);if(Array.isArray(X))[I,z]=X;else if(X!=null)I=X;else return null}var H=kx({display:"block",paddingTop:4,paddingBottom:4,color:C.color||"#000"},n);return N.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(E),style:H},ns(z)?N.createElement("span",{className:"recharts-tooltip-item-name"},z):null,ns(z)?N.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,N.createElement("span",{className:"recharts-tooltip-item-value"},I),N.createElement("span",{className:"recharts-tooltip-item-unit"},C.unit||""))});return N.createElement("ul",{className:"recharts-tooltip-item-list",style:S},_)}return null},x=kx({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),g=kx({margin:0},a),y=!dr(d),v=y?d:"",b=Ft("recharts-default-tooltip",c),w=Ft("recharts-tooltip-label",u);y&&f&&i!==void 0&&i!==null&&(v=f(d,i));var k=m?{role:"status","aria-live":"assertive"}:{};return N.createElement("div",wv({className:b,style:x},k),N.createElement("p",{className:w,style:g},N.isValidElement(v)?v:"".concat(v)),p())},Yu="recharts-tooltip-wrapper",lU={visibility:"hidden"};function cU(e){var{coordinate:t,translateX:r,translateY:n}=e;return Ft(Yu,{["".concat(Yu,"-right")]:lt(r)&&t&&lt(t.x)&&r>=t.x,["".concat(Yu,"-left")]:lt(r)&&t&&lt(t.x)&&r<t.x,["".concat(Yu,"-bottom")]:lt(n)&&t&&lt(t.y)&&n>=t.y,["".concat(Yu,"-top")]:lt(n)&&t&&lt(t.y)&&n<t.y})}function t_(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:a,position:i,reverseDirection:s,tooltipDimension:o,viewBox:c,viewBoxDimension:u}=e;if(i&&lt(i[n]))return i[n];var d=r[n]-o-(a>0?a:0),f=r[n]+a;if(t[n])return s[n]?d:f;var m=c[n];if(m==null)return 0;if(s[n]){var p=d,x=m;return p<x?Math.max(f,m):Math.max(d,m)}if(u==null)return 0;var g=f+o,y=m+u;return g>y?Math.max(d,m):Math.max(f,m)}function uU(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function dU(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:i,tooltipBox:s,useTranslate3d:o,viewBox:c}=e,u,d,f;return s.height>0&&s.width>0&&r?(d=t_({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.width,viewBox:c,viewBoxDimension:c.width}),f=t_({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.height,viewBox:c,viewBoxDimension:c.height}),u=uU({translateX:d,translateY:f,useTranslate3d:o})):u=lU,{cssProperties:u,cssClasses:cU({translateX:d,translateY:f,coordinate:r})}}function r_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function U0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?r_(Object(r),!0).forEach(function(n){Nv(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):r_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Nv(e,t,r){return(t=fU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fU(e){var t=hU(e,"string");return typeof t=="symbol"?t:t+""}function hU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class mU extends N.PureComponent{constructor(){super(...arguments),Nv(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),Nv(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,a,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:i,coordinate:s,hasPayload:o,isAnimationActive:c,offset:u,position:d,reverseDirection:f,useTranslate3d:m,viewBox:p,wrapperStyle:x,lastBoundingBox:g,innerRef:y,hasPortalFromProps:v}=this.props,{cssClasses:b,cssProperties:w}=dU({allowEscapeViewBox:r,coordinate:s,offsetTopLeft:u,position:d,reverseDirection:f,tooltipBox:{height:g.height,width:g.width},useTranslate3d:m,viewBox:p}),k=v?{}:U0(U0({transition:c&&t?"transform ".concat(n,"ms ").concat(a):void 0},w),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&o?"visible":"hidden",position:"absolute",top:0,left:0}),S=U0(U0({},k),{},{visibility:!this.state.dismissed&&t&&o?"visible":"hidden"},x);return N.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:b,style:S,ref:y},i)}}var pU=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),$o={devToolsEnabled:!1,isSsr:pU()},h6=()=>st(e=>e.rootProps.accessibilityLayer);function kv(){return kv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kv.apply(null,arguments)}function n_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function a_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?n_(Object(r),!0).forEach(function(n){gU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gU(e,t,r){return(t=xU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xU(e){var t=yU(e,"string");return typeof t=="symbol"?t:t+""}function yU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var i_={curveBasisClosed:Ij,curveBasisOpen:Rj,curveBasis:Dj,curveBumpX:yj,curveBumpY:vj,curveLinearClosed:Fj,curveLinear:Cp,curveMonotoneX:Mj,curveMonotoneY:Lj,curveNatural:Bj,curveStep:jj,curveStepAfter:Uj,curveStepBefore:$j},z0=e=>zn(e.x)&&zn(e.y),Ju=e=>e.x,Qu=e=>e.y,vU=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(Mf(e));return(r==="curveMonotone"||r==="curveBump")&&t?i_["".concat(r).concat(t==="vertical"?"Y":"X")]:i_[r]||Cp},bU=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:a,connectNulls:i=!1}=e,s=vU(t,a),o=i?r.filter(z0):r,c;if(Array.isArray(n)){var u=i?n.filter(f=>z0(f)):n,d=o.map((f,m)=>a_(a_({},f),{},{base:u[m]}));return a==="vertical"?c=R0().y(Qu).x1(Ju).x0(f=>f.base.x):c=R0().x(Ju).y1(Qu).y0(f=>f.base.y),c.defined(z0).curve(s),c(d)}return a==="vertical"&&lt(n)?c=R0().y(Qu).x1(Ju).x0(n):lt(n)?c=R0().x(Ju).y1(Qu).y0(n):c=I3().x(Ju).y(Qu),c.defined(z0).curve(s),c(o)},Yb=e=>{var{className:t,points:r,path:n,pathRef:a}=e;if((!r||!r.length)&&!n)return null;var i=r&&r.length?bU(e):n;return N.createElement("path",kv({},Fa(e),_b(e),{className:Ft("recharts-curve",t),d:i===null?void 0:i,ref:a}))},wU=["x","y","top","left","width","height","className"];function Sv(){return Sv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Sv.apply(null,arguments)}function s_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function NU(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s_(Object(r),!0).forEach(function(n){kU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kU(e,t,r){return(t=SU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SU(e){var t=_U(e,"string");return typeof t=="symbol"?t:t+""}function _U(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CU(e,t){if(e==null)return{};var r,n,a=EU(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function EU(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var AU=(e,t,r,n,a,i)=>"M".concat(e,",").concat(a,"v").concat(n,"M").concat(i,",").concat(t,"h").concat(r),TU=e=>{var{x:t=0,y:r=0,top:n=0,left:a=0,width:i=0,height:s=0,className:o}=e,c=CU(e,wU),u=NU({x:t,y:r,top:n,left:a,width:i,height:s},c);return!lt(t)||!lt(r)||!lt(i)||!lt(s)||!lt(n)||!lt(a)?null:N.createElement("path",Sv({},ea(u),{className:Ft("recharts-cross",o),d:AU(t,r,i,s,n,a)}))};function PU(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function o_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function OU(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?o_(Object(r),!0).forEach(function(n){DU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DU(e,t,r){return(t=IU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IU(e){var t=RU(e,"string");return typeof t=="symbol"?t:t+""}function RU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kn(e,t){var r=OU({},e),n=t,a=Object.keys(t),i=a.reduce((s,o)=>(s[o]===void 0&&n[o]!==void 0&&(s[o]=n[o]),s),r);return i}function FU(){}function MU(e){return e!=null}function l_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function c_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?l_(Object(r),!0).forEach(function(n){LU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LU(e,t,r){return(t=BU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BU(e){var t=jU(e,"string");return typeof t=="symbol"?t:t+""}function jU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $U=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),m6=(e,t,r)=>e.map(n=>"".concat($U(n)," ").concat(t,"ms ").concat(r)).join(","),UU=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(a=>n.includes(a))),rf=(e,t)=>Object.keys(t).reduce((r,n)=>c_(c_({},r),{},{[n]:e(n,t[n])}),{});function u_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?u_(Object(r),!0).forEach(function(n){zU(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zU(e,t,r){return(t=HU(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HU(e){var t=WU(e,"string");return typeof t=="symbol"?t:t+""}function WU(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xm=(e,t,r)=>e+(t-e)*r,_v=e=>{var{from:t,to:r}=e;return t!==r},p6=(e,t,r)=>{var n=rf((a,i)=>{if(_v(i)){var[s,o]=e(i.from,i.to,i.velocity);return pn(pn({},i),{},{from:s,velocity:o})}return i},t);return r<1?rf((a,i)=>_v(i)?pn(pn({},i),{},{velocity:xm(i.velocity,n[a].velocity,r),from:xm(i.from,n[a].from,r)}):i,t):p6(e,n,r-1)};function GU(e,t,r,n,a,i){var s,o=n.reduce((m,p)=>pn(pn({},m),{},{[p]:{from:e[p],velocity:0,to:t[p]}}),{}),c=()=>rf((m,p)=>p.from,o),u=()=>!Object.values(o).filter(_v).length,d=null,f=m=>{s||(s=m);var p=m-s,x=p/r.dt;o=p6(r,o,x),a(pn(pn(pn({},e),t),c())),s=m,u()||(d=i.setTimeout(f))};return()=>(d=i.setTimeout(f),()=>{d()})}function VU(e,t,r,n,a,i,s){var o=null,c=a.reduce((f,m)=>pn(pn({},f),{},{[m]:[e[m],t[m]]}),{}),u,d=f=>{u||(u=f);var m=(f-u)/n,p=rf((g,y)=>xm(...y,r(m)),c);if(i(pn(pn(pn({},e),t),p)),m<1)o=s.setTimeout(d);else{var x=rf((g,y)=>xm(...y,r(1)),c);i(pn(pn(pn({},e),t),x))}};return()=>(o=s.setTimeout(d),()=>{o()})}const KU=(e,t,r,n,a,i)=>{var s=UU(e,t);return r.isStepper===!0?GU(e,t,r,s,a,i):VU(e,t,r,n,s,a,i)};var ym=1e-4,g6=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],x6=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),d_=(e,t)=>r=>{var n=g6(e,t);return x6(n,r)},qU=(e,t)=>r=>{var n=g6(e,t),a=[...n.map((i,s)=>i*s).slice(1),0];return x6(a,r)},f_=function(){for(var t,r,n,a,i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];if(s.length===1)switch(s[0]){case"linear":[t,n,r,a]=[0,0,1,1];break;case"ease":[t,n,r,a]=[.25,.1,.25,1];break;case"ease-in":[t,n,r,a]=[.42,0,1,1];break;case"ease-out":[t,n,r,a]=[.42,0,.58,1];break;case"ease-in-out":[t,n,r,a]=[0,0,.58,1];break;default:{var c=s[0].split("(");c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4&&([t,n,r,a]=c[1].split(")")[0].split(",").map(x=>parseFloat(x)))}}else s.length===4&&([t,n,r,a]=s);var u=d_(t,r),d=d_(n,a),f=qU(t,r),m=x=>x>1?1:x<0?0:x,p=x=>{for(var g=x>1?1:x,y=g,v=0;v<8;++v){var b=u(y)-g,w=f(y);if(Math.abs(b-g)<ym||w<ym)return d(y);y=m(y-b/w)}return d(y)};return p.isStepper=!1,p},XU=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=t,i=(s,o,c)=>{var u=-(s-o)*r,d=c*n,f=c+(u-d)*a/1e3,m=c*a/1e3+s;return Math.abs(m-o)<ym&&Math.abs(f)<ym?[o,0]:[m,f]};return i.isStepper=!0,i.dt=a,i},YU=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return f_(e);case"spring":return XU();default:if(e.split("(")[0]==="cubic-bezier")return f_(e)}return typeof e=="function"?e:null};function JU(e){var t,r=()=>null,n=!1,a=null,i=s=>{if(!n){if(Array.isArray(s)){if(!s.length)return;var o=s,[c,...u]=o;if(typeof c=="number"){a=e.setTimeout(i.bind(null,u),c);return}i(c),a=e.setTimeout(i.bind(null,u));return}typeof s=="string"&&(t=s,r(t)),typeof s=="object"&&(t=s,r(t)),typeof s=="function"&&s()}};return{stop:()=>{n=!0},start:s=>{n=!1,a&&(a(),a=null),i(s)},subscribe:s=>(r=s,()=>{r=()=>null}),getTimeoutController:()=>e}}class QU{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,i=s=>{s-n>=r?t(s):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(i))};return a=requestAnimationFrame(i),()=>{cancelAnimationFrame(a)}}}function ZU(){return JU(new QU)}var ez=N.createContext(ZU);function tz(e,t){var r=N.useContext(ez);return N.useMemo(()=>t??r(e),[e,t,r])}var rz={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},h_={t:0},Sx={t:1};function Uf(e){var t=kn(e,rz),{isActive:r,canBegin:n,duration:a,easing:i,begin:s,onAnimationEnd:o,onAnimationStart:c,children:u}=t,d=tz(t.animationId,t.animationManager),[f,m]=N.useState(r?h_:Sx),p=N.useRef(null);return N.useEffect(()=>{r||m(Sx)},[r]),N.useEffect(()=>{if(!r||!n)return FU;var x=KU(h_,Sx,YU(i),a,m,d.getTimeoutController()),g=()=>{p.current=x()};return d.start([c,s,g,a,o]),()=>{d.stop(),p.current&&p.current(),o()}},[r,n,a,i,s,c,o,d]),u(f.t)}function zf(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=N.useRef(Qd(t)),n=N.useRef(e);return n.current!==e&&(r.current=Qd(t),n.current=e),r.current}var nz=["radius"],az=["radius"];function m_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function p_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?m_(Object(r),!0).forEach(function(n){iz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iz(e,t,r){return(t=sz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sz(e){var t=oz(e,"string");return typeof t=="symbol"?t:t+""}function oz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vm(){return vm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vm.apply(null,arguments)}function g_(e,t){if(e==null)return{};var r,n,a=lz(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function lz(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var x_=(e,t,r,n,a)=>{var i=Math.min(Math.abs(r)/2,Math.abs(n)/2),s=n>=0?1:-1,o=r>=0?1:-1,c=n>=0&&r>=0||n<0&&r<0?1:0,u;if(i>0&&a instanceof Array){for(var d=[0,0,0,0],f=0,m=4;f<m;f++)d[f]=a[f]>i?i:a[f];u="M".concat(e,",").concat(t+s*d[0]),d[0]>0&&(u+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(c,",").concat(e+o*d[0],",").concat(t)),u+="L ".concat(e+r-o*d[1],",").concat(t),d[1]>0&&(u+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(c,`,
        `).concat(e+r,",").concat(t+s*d[1])),u+="L ".concat(e+r,",").concat(t+n-s*d[2]),d[2]>0&&(u+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(c,`,
        `).concat(e+r-o*d[2],",").concat(t+n)),u+="L ".concat(e+o*d[3],",").concat(t+n),d[3]>0&&(u+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(t+n-s*d[3])),u+="Z"}else if(i>0&&a===+a&&a>0){var p=Math.min(i,a);u="M ".concat(e,",").concat(t+s*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+o*p,",").concat(t,`
            L `).concat(e+r-o*p,",").concat(t,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+r,",").concat(t+s*p,`
            L `).concat(e+r,",").concat(t+n-s*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+r-o*p,",").concat(t+n,`
            L `).concat(e+o*p,",").concat(t+n,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e,",").concat(t+n-s*p," Z")}else u="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return u},cz={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},y6=e=>{var t=kn(e,cz),r=N.useRef(null),[n,a]=N.useState(-1);N.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var L=r.current.getTotalLength();L&&a(L)}catch{}},[]);var{x:i,y:s,width:o,height:c,radius:u,className:d}=t,{animationEasing:f,animationDuration:m,animationBegin:p,isAnimationActive:x,isUpdateAnimationActive:g}=t,y=N.useRef(o),v=N.useRef(c),b=N.useRef(i),w=N.useRef(s),k=N.useMemo(()=>({x:i,y:s,width:o,height:c,radius:u}),[i,s,o,c,u]),S=zf(k,"rectangle-");if(i!==+i||s!==+s||o!==+o||c!==+c||o===0||c===0)return null;var _=Ft("recharts-rectangle",d);if(!g){var C=ea(t),E=g_(C,nz);return N.createElement("path",vm({},E,{radius:typeof u=="number"?u:void 0,className:_,d:x_(i,s,o,c,u)}))}var A=y.current,T=v.current,D=b.current,I=w.current,z="0px ".concat(n===-1?1:n,"px"),X="".concat(n,"px 0px"),H=m6(["strokeDasharray"],m,typeof f=="string"?f:void 0);return N.createElement(Uf,{animationId:S,key:S,canBegin:n>0,duration:m,easing:f,isActive:g,begin:p},L=>{var W=_r(A,o,L),ie=_r(T,c,L),B=_r(D,i,L),ee=_r(I,s,L);r.current&&(y.current=W,v.current=ie,b.current=B,w.current=ee);var le;x?L>0?le={transition:H,strokeDasharray:X}:le={strokeDasharray:z}:le={strokeDasharray:X};var R=ea(t),j=g_(R,az);return N.createElement("path",vm({},j,{radius:typeof u=="number"?u:void 0,className:_,d:x_(B,ee,W,ie,u),ref:r,style:p_(p_({},le),t.style)}))})};function v6(e){var{cx:t,cy:r,radius:n,startAngle:a,endAngle:i}=e,s=Ur(t,r,n,a),o=Ur(t,r,n,i);return{points:[s,o],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function Cv(){return Cv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cv.apply(null,arguments)}var uz=(e,t)=>{var r=ln(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},H0=e=>{var{cx:t,cy:r,radius:n,angle:a,sign:i,isExternal:s,cornerRadius:o,cornerIsExternal:c}=e,u=o*(s?1:-1)+n,d=Math.asin(o/u)/pm,f=c?a:a+i*d,m=Ur(t,r,u,f),p=Ur(t,r,n,f),x=c?a-i*d:a,g=Ur(t,r,u*Math.cos(d*pm),x);return{center:m,circleTangency:p,lineTangency:g,theta:d}},b6=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:i,endAngle:s}=e,o=uz(i,s),c=i+o,u=Ur(t,r,a,i),d=Ur(t,r,a,c),f="M ".concat(u.x,",").concat(u.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(o)>180),",").concat(+(i>c),`,
    `).concat(d.x,",").concat(d.y,`
  `);if(n>0){var m=Ur(t,r,n,i),p=Ur(t,r,n,c);f+="L ".concat(p.x,",").concat(p.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(o)>180),",").concat(+(i<=c),`,
            `).concat(m.x,",").concat(m.y," Z")}else f+="L ".concat(t,",").concat(r," Z");return f},dz=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,cornerRadius:i,forceCornerRadius:s,cornerIsExternal:o,startAngle:c,endAngle:u}=e,d=ln(u-c),{circleTangency:f,lineTangency:m,theta:p}=H0({cx:t,cy:r,radius:a,angle:c,sign:d,cornerRadius:i,cornerIsExternal:o}),{circleTangency:x,lineTangency:g,theta:y}=H0({cx:t,cy:r,radius:a,angle:u,sign:-d,cornerRadius:i,cornerIsExternal:o}),v=o?Math.abs(c-u):Math.abs(c-u)-p-y;if(v<0)return s?"M ".concat(m.x,",").concat(m.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):b6({cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:c,endAngle:u});var b="M ".concat(m.x,",").concat(m.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(f.x,",").concat(f.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(v>180),",").concat(+(d<0),",").concat(x.x,",").concat(x.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(g.x,",").concat(g.y,`
  `);if(n>0){var{circleTangency:w,lineTangency:k,theta:S}=H0({cx:t,cy:r,radius:n,angle:c,sign:d,isExternal:!0,cornerRadius:i,cornerIsExternal:o}),{circleTangency:_,lineTangency:C,theta:E}=H0({cx:t,cy:r,radius:n,angle:u,sign:-d,isExternal:!0,cornerRadius:i,cornerIsExternal:o}),A=o?Math.abs(c-u):Math.abs(c-u)-S-E;if(A<0&&i===0)return"".concat(b,"L").concat(t,",").concat(r,"Z");b+="L".concat(C.x,",").concat(C.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(_.x,",").concat(_.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(A>180),",").concat(+(d>0),",").concat(w.x,",").concat(w.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(d<0),",").concat(k.x,",").concat(k.y,"Z")}else b+="L".concat(t,",").concat(r,"Z");return b},fz={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},w6=e=>{var t=kn(e,fz),{cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:c,startAngle:u,endAngle:d,className:f}=t;if(i<a||u===d)return null;var m=Ft("recharts-sector",f),p=i-a,x=Bn(s,p,0,!0),g;return x>0&&Math.abs(u-d)<360?g=dz({cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:Math.min(x,p/2),forceCornerRadius:o,cornerIsExternal:c,startAngle:u,endAngle:d}):g=b6({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:u,endAngle:d}),N.createElement("path",Cv({},ea(t),{className:m,d:g}))};function hz(e,t,r){var n,a,i,s;if(e==="horizontal")n=t.x,i=n,a=r.top,s=r.top+r.height;else if(e==="vertical")a=t.y,s=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:o,cy:c,innerRadius:u,outerRadius:d,angle:f}=t,m=Ur(o,c,u,f),p=Ur(o,c,d,f);n=m.x,a=m.y,i=p.x,s=p.y}else return v6(t);return[{x:n,y:a},{x:i,y:s}]}var N6={},k6={},S6={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Bb;function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(S6);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=S6;function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(k6);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=jb,r=k6;function n(a,i,s){s&&typeof s!="number"&&t.isIterateeCall(a,i,s)&&(i=s=void 0),a=r.toFinite(a),i===void 0?(i=a,a=0):i=r.toFinite(i),s=s===void 0?a<i?1:-1:r.toFinite(s);const o=Math.max(Math.ceil((i-a)/(s||1)),0),c=new Array(o);for(let u=0;u<o;u++)c[u]=a,a+=s;return c}e.range=n})(N6);var mz=N6.range;const _6=$s(mz);function ko(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function pz(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Jb(e){let t,r,n;e.length!==2?(t=ko,r=(o,c)=>ko(e(o),c),n=(o,c)=>e(o)-c):(t=e===ko||e===pz?e:gz,r=e,n=e);function a(o,c,u=0,d=o.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(o[f],c)<0?u=f+1:d=f}while(u<d)}return u}function i(o,c,u=0,d=o.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(o[f],c)<=0?u=f+1:d=f}while(u<d)}return u}function s(o,c,u=0,d=o.length){const f=a(o,c,u,d-1);return f>u&&n(o[f-1],c)>-n(o[f],c)?f-1:f}return{left:a,center:s,right:i}}function gz(){return 0}function C6(e){return e===null?NaN:+e}function*xz(e,t){if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(yield r);else{let r=-1;for(let n of e)(n=t(n,++r,e))!=null&&(n=+n)>=n&&(yield n)}}const yz=Jb(ko),vz=yz.right;Jb(C6).center;const Hf=vz;class y_ extends Map{constructor(t,r=Nz){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(v_(this,t))}has(t){return super.has(v_(this,t))}set(t,r){return super.set(bz(this,t),r)}delete(t){return super.delete(wz(this,t))}}function v_({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function bz({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function wz({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function Nz(e){return e!==null&&typeof e=="object"?e.valueOf():e}function kz(e=ko){if(e===ko)return E6;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function E6(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const Sz=Math.sqrt(50),_z=Math.sqrt(10),Cz=Math.sqrt(2);function bm(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=Sz?10:i>=_z?5:i>=Cz?2:1;let o,c,u;return a<0?(u=Math.pow(10,-a)/s,o=Math.round(e*u),c=Math.round(t*u),o/u<e&&++o,c/u>t&&--c,u=-u):(u=Math.pow(10,a)*s,o=Math.round(e/u),c=Math.round(t/u),o*u<e&&++o,c*u>t&&--c),c<o&&.5<=r&&r<2?bm(e,t,r*2):[o,c,u]}function Ev(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,s]=n?bm(t,e,r):bm(e,t,r);if(!(i>=a))return[];const o=i-a+1,c=new Array(o);if(n)if(s<0)for(let u=0;u<o;++u)c[u]=(i-u)/-s;else for(let u=0;u<o;++u)c[u]=(i-u)*s;else if(s<0)for(let u=0;u<o;++u)c[u]=(a+u)/-s;else for(let u=0;u<o;++u)c[u]=(a+u)*s;return c}function Av(e,t,r){return t=+t,e=+e,r=+r,bm(e,t,r)[2]}function Tv(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?Av(t,e,r):Av(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function b_(e,t){let r;if(t===void 0)for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let a of e)(a=t(a,++n,e))!=null&&(r<a||r===void 0&&a>=a)&&(r=a)}return r}function w_(e,t){let r;if(t===void 0)for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let a of e)(a=t(a,++n,e))!=null&&(r>a||r===void 0&&a>=a)&&(r=a)}return r}function A6(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?E6:kz(a);n>r;){if(n-r>600){const c=n-r+1,u=t-r+1,d=Math.log(c),f=.5*Math.exp(2*d/3),m=.5*Math.sqrt(d*f*(c-f)/c)*(u-c/2<0?-1:1),p=Math.max(r,Math.floor(t-u*f/c+m)),x=Math.min(n,Math.floor(t+(c-u)*f/c+m));A6(e,t,p,x,a)}const i=e[t];let s=r,o=n;for(Zu(e,r,t),a(e[n],i)>0&&Zu(e,r,n);s<o;){for(Zu(e,s,o),++s,--o;a(e[s],i)<0;)++s;for(;a(e[o],i)>0;)--o}a(e[r],i)===0?Zu(e,r,o):(++o,Zu(e,o,n)),o<=t&&(r=o+1),t<=o&&(n=o-1)}return e}function Zu(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function Ez(e,t,r){if(e=Float64Array.from(xz(e,r)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return w_(e);if(t>=1)return b_(e);var n,a=(n-1)*t,i=Math.floor(a),s=b_(A6(e,i).subarray(0,i+1)),o=w_(e.subarray(i+1));return s+(o-s)*(a-i)}}function Az(e,t,r=C6){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),s=+r(e[i],i,e),o=+r(e[i+1],i+1,e);return s+(o-s)*(a-i)}}function Tz(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function mi(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Ws(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Pv=Symbol("implicit");function Qb(){var e=new y_,t=[],r=[],n=Pv;function a(i){let s=e.get(i);if(s===void 0){if(n!==Pv)return n;e.set(i,s=t.push(i)-1)}return r[s%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new y_;for(const s of i)e.has(s)||e.set(s,t.push(s)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return Qb(t,r).unknown(n)},mi.apply(a,arguments),a}function Zb(){var e=Qb().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,s,o=!1,c=0,u=0,d=.5;delete e.unknown;function f(){var m=t().length,p=a<n,x=p?a:n,g=p?n:a;i=(g-x)/Math.max(1,m-c+u*2),o&&(i=Math.floor(i)),x+=(g-x-i*(m-c))*d,s=i*(1-c),o&&(x=Math.round(x),s=Math.round(s));var y=Tz(m).map(function(v){return x+i*v});return r(p?y.reverse():y)}return e.domain=function(m){return arguments.length?(t(m),f()):t()},e.range=function(m){return arguments.length?([n,a]=m,n=+n,a=+a,f()):[n,a]},e.rangeRound=function(m){return[n,a]=m,n=+n,a=+a,o=!0,f()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(m){return arguments.length?(o=!!m,f()):o},e.padding=function(m){return arguments.length?(c=Math.min(1,u=+m),f()):c},e.paddingInner=function(m){return arguments.length?(c=Math.min(1,m),f()):c},e.paddingOuter=function(m){return arguments.length?(u=+m,f()):u},e.align=function(m){return arguments.length?(d=Math.max(0,Math.min(1,m)),f()):d},e.copy=function(){return Zb(t(),[n,a]).round(o).paddingInner(c).paddingOuter(u).align(d)},mi.apply(f(),arguments)}function T6(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return T6(t())},e}function Pz(){return T6(Zb.apply(null,arguments).paddingInner(1))}function ew(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function P6(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Wf(){}var nf=.7,wm=1/nf,$c="\\s*([+-]?\\d+)\\s*",af="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Zi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Oz=/^#([0-9a-f]{3,8})$/,Dz=new RegExp(`^rgb\\(${$c},${$c},${$c}\\)$`),Iz=new RegExp(`^rgb\\(${Zi},${Zi},${Zi}\\)$`),Rz=new RegExp(`^rgba\\(${$c},${$c},${$c},${af}\\)$`),Fz=new RegExp(`^rgba\\(${Zi},${Zi},${Zi},${af}\\)$`),Mz=new RegExp(`^hsl\\(${af},${Zi},${Zi}\\)$`),Lz=new RegExp(`^hsla\\(${af},${Zi},${Zi},${af}\\)$`),N_={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ew(Wf,sf,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:k_,formatHex:k_,formatHex8:Bz,formatHsl:jz,formatRgb:S_,toString:S_});function k_(){return this.rgb().formatHex()}function Bz(){return this.rgb().formatHex8()}function jz(){return O6(this).formatHsl()}function S_(){return this.rgb().formatRgb()}function sf(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=Oz.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?__(t):r===3?new ua(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?W0(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?W0(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Dz.exec(e))?new ua(t[1],t[2],t[3],1):(t=Iz.exec(e))?new ua(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Rz.exec(e))?W0(t[1],t[2],t[3],t[4]):(t=Fz.exec(e))?W0(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Mz.exec(e))?A_(t[1],t[2]/100,t[3]/100,1):(t=Lz.exec(e))?A_(t[1],t[2]/100,t[3]/100,t[4]):N_.hasOwnProperty(e)?__(N_[e]):e==="transparent"?new ua(NaN,NaN,NaN,0):null}function __(e){return new ua(e>>16&255,e>>8&255,e&255,1)}function W0(e,t,r,n){return n<=0&&(e=t=r=NaN),new ua(e,t,r,n)}function $z(e){return e instanceof Wf||(e=sf(e)),e?(e=e.rgb(),new ua(e.r,e.g,e.b,e.opacity)):new ua}function Ov(e,t,r,n){return arguments.length===1?$z(e):new ua(e,t,r,n??1)}function ua(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}ew(ua,Ov,P6(Wf,{brighter(e){return e=e==null?wm:Math.pow(wm,e),new ua(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?nf:Math.pow(nf,e),new ua(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ua(gl(this.r),gl(this.g),gl(this.b),Nm(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:C_,formatHex:C_,formatHex8:Uz,formatRgb:E_,toString:E_}));function C_(){return`#${ll(this.r)}${ll(this.g)}${ll(this.b)}`}function Uz(){return`#${ll(this.r)}${ll(this.g)}${ll(this.b)}${ll((isNaN(this.opacity)?1:this.opacity)*255)}`}function E_(){const e=Nm(this.opacity);return`${e===1?"rgb(":"rgba("}${gl(this.r)}, ${gl(this.g)}, ${gl(this.b)}${e===1?")":`, ${e})`}`}function Nm(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function gl(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ll(e){return e=gl(e),(e<16?"0":"")+e.toString(16)}function A_(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Ci(e,t,r,n)}function O6(e){if(e instanceof Ci)return new Ci(e.h,e.s,e.l,e.opacity);if(e instanceof Wf||(e=sf(e)),!e)return new Ci;if(e instanceof Ci)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),s=NaN,o=i-a,c=(i+a)/2;return o?(t===i?s=(r-n)/o+(r<n)*6:r===i?s=(n-t)/o+2:s=(t-r)/o+4,o/=c<.5?i+a:2-i-a,s*=60):o=c>0&&c<1?0:s,new Ci(s,o,c,e.opacity)}function zz(e,t,r,n){return arguments.length===1?O6(e):new Ci(e,t,r,n??1)}function Ci(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}ew(Ci,zz,P6(Wf,{brighter(e){return e=e==null?wm:Math.pow(wm,e),new Ci(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?nf:Math.pow(nf,e),new Ci(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new ua(_x(e>=240?e-240:e+120,a,n),_x(e,a,n),_x(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new Ci(T_(this.h),G0(this.s),G0(this.l),Nm(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Nm(this.opacity);return`${e===1?"hsl(":"hsla("}${T_(this.h)}, ${G0(this.s)*100}%, ${G0(this.l)*100}%${e===1?")":`, ${e})`}`}}));function T_(e){return e=(e||0)%360,e<0?e+360:e}function G0(e){return Math.max(0,Math.min(1,e||0))}function _x(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const tw=e=>()=>e;function Hz(e,t){return function(r){return e+r*t}}function Wz(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function Gz(e){return(e=+e)==1?D6:function(t,r){return r-t?Wz(t,r,e):tw(isNaN(t)?r:t)}}function D6(e,t){var r=t-e;return r?Hz(e,r):tw(isNaN(e)?t:e)}const P_=function e(t){var r=Gz(t);function n(a,i){var s=r((a=Ov(a)).r,(i=Ov(i)).r),o=r(a.g,i.g),c=r(a.b,i.b),u=D6(a.opacity,i.opacity);return function(d){return a.r=s(d),a.g=o(d),a.b=c(d),a.opacity=u(d),a+""}}return n.gamma=e,n}(1);function Vz(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function Kz(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function qz(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=Nu(e[s],t[s]);for(;s<r;++s)i[s]=t[s];return function(o){for(s=0;s<n;++s)i[s]=a[s](o);return i}}function Xz(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function km(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function Yz(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=Nu(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var Dv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Cx=new RegExp(Dv.source,"g");function Jz(e){return function(){return e}}function Qz(e){return function(t){return e(t)+""}}function Zz(e,t){var r=Dv.lastIndex=Cx.lastIndex=0,n,a,i,s=-1,o=[],c=[];for(e=e+"",t=t+"";(n=Dv.exec(e))&&(a=Cx.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),o[s]?o[s]+=i:o[++s]=i),(n=n[0])===(a=a[0])?o[s]?o[s]+=a:o[++s]=a:(o[++s]=null,c.push({i:s,x:km(n,a)})),r=Cx.lastIndex;return r<t.length&&(i=t.slice(r),o[s]?o[s]+=i:o[++s]=i),o.length<2?c[0]?Qz(c[0].x):Jz(t):(t=c.length,function(u){for(var d=0,f;d<t;++d)o[(f=c[d]).i]=f.x(u);return o.join("")})}function Nu(e,t){var r=typeof t,n;return t==null||r==="boolean"?tw(t):(r==="number"?km:r==="string"?(n=sf(t))?(t=n,P_):Zz:t instanceof sf?P_:t instanceof Date?Xz:Kz(t)?Vz:Array.isArray(t)?qz:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Yz:km)(e,t)}function rw(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function eH(e,t){t===void 0&&(t=e,e=Nu);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(s){var o=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return i[o](s-o)}}function tH(e){return function(){return e}}function Sm(e){return+e}var O_=[0,1];function Qn(e){return e}function Iv(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:tH(isNaN(t)?NaN:.5)}function rH(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function nH(e,t,r){var n=e[0],a=e[1],i=t[0],s=t[1];return a<n?(n=Iv(a,n),i=r(s,i)):(n=Iv(n,a),i=r(i,s)),function(o){return i(n(o))}}function aH(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)a[s]=Iv(e[s],e[s+1]),i[s]=r(t[s],t[s+1]);return function(o){var c=Hf(e,o,1,n)-1;return i[c](a[c](o))}}function Gf(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Vp(){var e=O_,t=O_,r=Nu,n,a,i,s=Qn,o,c,u;function d(){var m=Math.min(e.length,t.length);return s!==Qn&&(s=rH(e[0],e[m-1])),o=m>2?aH:nH,c=u=null,f}function f(m){return m==null||isNaN(m=+m)?i:(c||(c=o(e.map(n),t,r)))(n(s(m)))}return f.invert=function(m){return s(a((u||(u=o(t,e.map(n),km)))(m)))},f.domain=function(m){return arguments.length?(e=Array.from(m,Sm),d()):e.slice()},f.range=function(m){return arguments.length?(t=Array.from(m),d()):t.slice()},f.rangeRound=function(m){return t=Array.from(m),r=rw,d()},f.clamp=function(m){return arguments.length?(s=m?!0:Qn,d()):s!==Qn},f.interpolate=function(m){return arguments.length?(r=m,d()):r},f.unknown=function(m){return arguments.length?(i=m,f):i},function(m,p){return n=m,a=p,d()}}function nw(){return Vp()(Qn,Qn)}function iH(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function _m(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function su(e){return e=_m(Math.abs(e)),e?e[1]:NaN}function sH(e,t){return function(r,n){for(var a=r.length,i=[],s=0,o=e[0],c=0;a>0&&o>0&&(c+o+1>n&&(o=Math.max(1,n-c)),i.push(r.substring(a-=o,a+o)),!((c+=o+1)>n));)o=e[s=(s+1)%e.length];return i.reverse().join(t)}}function oH(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var lH=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function of(e){if(!(t=lH.exec(e)))throw new Error("invalid format: "+e);var t;return new aw({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}of.prototype=aw.prototype;function aw(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}aw.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function cH(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var I6;function uH(e,t){var r=_m(e,t);if(!r)return e+"";var n=r[0],a=r[1],i=a-(I6=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+_m(e,Math.max(0,t+i-1))[0]}function D_(e,t){var r=_m(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const I_={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:iH,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>D_(e*100,t),r:D_,s:uH,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function R_(e){return e}var F_=Array.prototype.map,M_=["y","z","a","f","p","n","Âµ","m","","k","M","G","T","P","E","Z","Y"];function dH(e){var t=e.grouping===void 0||e.thousands===void 0?R_:sH(F_.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?R_:oH(F_.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"âˆ’":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(f){f=of(f);var m=f.fill,p=f.align,x=f.sign,g=f.symbol,y=f.zero,v=f.width,b=f.comma,w=f.precision,k=f.trim,S=f.type;S==="n"?(b=!0,S="g"):I_[S]||(w===void 0&&(w=12),k=!0,S="g"),(y||m==="0"&&p==="=")&&(y=!0,m="0",p="=");var _=g==="$"?r:g==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():"",C=g==="$"?n:/[%p]/.test(S)?s:"",E=I_[S],A=/[defgprs%]/.test(S);w=w===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function T(D){var I=_,z=C,X,H,L;if(S==="c")z=E(D)+z,D="";else{D=+D;var W=D<0||1/D<0;if(D=isNaN(D)?c:E(Math.abs(D),w),k&&(D=cH(D)),W&&+D==0&&x!=="+"&&(W=!1),I=(W?x==="("?x:o:x==="-"||x==="("?"":x)+I,z=(S==="s"?M_[8+I6/3]:"")+z+(W&&x==="("?")":""),A){for(X=-1,H=D.length;++X<H;)if(L=D.charCodeAt(X),48>L||L>57){z=(L===46?a+D.slice(X+1):D.slice(X))+z,D=D.slice(0,X);break}}}b&&!y&&(D=t(D,1/0));var ie=I.length+D.length+z.length,B=ie<v?new Array(v-ie+1).join(m):"";switch(b&&y&&(D=t(B+D,B.length?v-z.length:1/0),B=""),p){case"<":D=I+D+z+B;break;case"=":D=I+B+D+z;break;case"^":D=B.slice(0,ie=B.length>>1)+I+D+z+B.slice(ie);break;default:D=B+I+D+z;break}return i(D)}return T.toString=function(){return f+""},T}function d(f,m){var p=u((f=of(f),f.type="f",f)),x=Math.max(-8,Math.min(8,Math.floor(su(m)/3)))*3,g=Math.pow(10,-x),y=M_[8+x/3];return function(v){return p(g*v)+y}}return{format:u,formatPrefix:d}}var V0,iw,R6;fH({thousands:",",grouping:[3],currency:["$",""]});function fH(e){return V0=dH(e),iw=V0.format,R6=V0.formatPrefix,V0}function hH(e){return Math.max(0,-su(Math.abs(e)))}function mH(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(su(t)/3)))*3-su(Math.abs(e)))}function pH(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,su(t)-su(e))+1}function F6(e,t,r,n){var a=Tv(e,t,r),i;switch(n=of(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=mH(a,s))&&(n.precision=i),R6(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=pH(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=hH(a))&&(n.precision=i-(n.type==="%")*2);break}}return iw(n)}function Uo(e){var t=e.domain;return e.ticks=function(r){var n=t();return Ev(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return F6(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,s=n[a],o=n[i],c,u,d=10;for(o<s&&(u=s,s=o,o=u,u=a,a=i,i=u);d-- >0;){if(u=Av(s,o,r),u===c)return n[a]=s,n[i]=o,t(n);if(u>0)s=Math.floor(s/u)*u,o=Math.ceil(o/u)*u;else if(u<0)s=Math.ceil(s*u)/u,o=Math.floor(o*u)/u;else break;c=u}return e},e}function M6(){var e=nw();return e.copy=function(){return Gf(e,M6())},mi.apply(e,arguments),Uo(e)}function L6(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Sm),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return L6(e).unknown(t)},e=arguments.length?Array.from(e,Sm):[0,1],Uo(r)}function B6(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],s;return i<a&&(s=r,r=n,n=s,s=a,a=i,i=s),e[r]=t.floor(a),e[n]=t.ceil(i),e}function L_(e){return Math.log(e)}function B_(e){return Math.exp(e)}function gH(e){return-Math.log(-e)}function xH(e){return-Math.exp(-e)}function yH(e){return isFinite(e)?+("1e"+e):e<0?0:e}function vH(e){return e===10?yH:e===Math.E?Math.exp:t=>Math.pow(e,t)}function bH(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function j_(e){return(t,r)=>-e(-t,r)}function sw(e){const t=e(L_,B_),r=t.domain;let n=10,a,i;function s(){return a=bH(n),i=vH(n),r()[0]<0?(a=j_(a),i=j_(i),e(gH,xH)):e(L_,B_),t}return t.base=function(o){return arguments.length?(n=+o,s()):n},t.domain=function(o){return arguments.length?(r(o),s()):r()},t.ticks=o=>{const c=r();let u=c[0],d=c[c.length-1];const f=d<u;f&&([u,d]=[d,u]);let m=a(u),p=a(d),x,g;const y=o==null?10:+o;let v=[];if(!(n%1)&&p-m<y){if(m=Math.floor(m),p=Math.ceil(p),u>0){for(;m<=p;++m)for(x=1;x<n;++x)if(g=m<0?x/i(-m):x*i(m),!(g<u)){if(g>d)break;v.push(g)}}else for(;m<=p;++m)for(x=n-1;x>=1;--x)if(g=m>0?x/i(-m):x*i(m),!(g<u)){if(g>d)break;v.push(g)}v.length*2<y&&(v=Ev(u,d,y))}else v=Ev(m,p,Math.min(p-m,y)).map(i);return f?v.reverse():v},t.tickFormat=(o,c)=>{if(o==null&&(o=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=of(c)).precision==null&&(c.trim=!0),c=iw(c)),o===1/0)return c;const u=Math.max(1,n*o/t.ticks().length);return d=>{let f=d/i(Math.round(a(d)));return f*n<n-.5&&(f*=n),f<=u?c(d):""}},t.nice=()=>r(B6(r(),{floor:o=>i(Math.floor(a(o))),ceil:o=>i(Math.ceil(a(o)))})),t}function j6(){const e=sw(Vp()).domain([1,10]);return e.copy=()=>Gf(e,j6()).base(e.base()),mi.apply(e,arguments),e}function $_(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function U_(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function ow(e){var t=1,r=e($_(t),U_(t));return r.constant=function(n){return arguments.length?e($_(t=+n),U_(t)):t},Uo(r)}function $6(){var e=ow(Vp());return e.copy=function(){return Gf(e,$6()).constant(e.constant())},mi.apply(e,arguments)}function z_(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function wH(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function NH(e){return e<0?-e*e:e*e}function lw(e){var t=e(Qn,Qn),r=1;function n(){return r===1?e(Qn,Qn):r===.5?e(wH,NH):e(z_(r),z_(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},Uo(t)}function cw(){var e=lw(Vp());return e.copy=function(){return Gf(e,cw()).exponent(e.exponent())},mi.apply(e,arguments),e}function kH(){return cw.apply(null,arguments).exponent(.5)}function H_(e){return Math.sign(e)*e*e}function SH(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function U6(){var e=nw(),t=[0,1],r=!1,n;function a(i){var s=SH(e(i));return isNaN(s)?n:r?Math.round(s):s}return a.invert=function(i){return e.invert(H_(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,Sm)).map(H_)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return U6(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},mi.apply(a,arguments),Uo(a)}function z6(){var e=[],t=[],r=[],n;function a(){var s=0,o=Math.max(1,t.length);for(r=new Array(o-1);++s<o;)r[s-1]=Az(e,s/o);return i}function i(s){return s==null||isNaN(s=+s)?n:t[Hf(r,s)]}return i.invertExtent=function(s){var o=t.indexOf(s);return o<0?[NaN,NaN]:[o>0?r[o-1]:e[0],o<r.length?r[o]:e[e.length-1]]},i.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let o of s)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(ko),a()},i.range=function(s){return arguments.length?(t=Array.from(s),a()):t.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return z6().domain(e).range(t).unknown(n)},mi.apply(i,arguments)}function H6(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function s(c){return c!=null&&c<=c?a[Hf(n,c,0,r)]:i}function o(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return s}return s.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,o()):[e,t]},s.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,o()):a.slice()},s.invertExtent=function(c){var u=a.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},s.unknown=function(c){return arguments.length&&(i=c),s},s.thresholds=function(){return n.slice()},s.copy=function(){return H6().domain([e,t]).range(a).unknown(i)},mi.apply(Uo(s),arguments)}function W6(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[Hf(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var s=t.indexOf(i);return[e[s-1],e[s]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return W6().domain(e).range(t).unknown(r)},mi.apply(a,arguments)}const Ex=new Date,Ax=new Date;function Zr(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const s=a(i),o=a.ceil(i);return i-s<o-i?s:o},a.offset=(i,s)=>(t(i=new Date(+i),s==null?1:Math.floor(s)),i),a.range=(i,s,o)=>{const c=[];if(i=a.ceil(i),o=o==null?1:Math.floor(o),!(i<s)||!(o>0))return c;let u;do c.push(u=new Date(+i)),t(i,o),e(i);while(u<i&&i<s);return c},a.filter=i=>Zr(s=>{if(s>=s)for(;e(s),!i(s);)s.setTime(s-1)},(s,o)=>{if(s>=s)if(o<0)for(;++o<=0;)for(;t(s,-1),!i(s););else for(;--o>=0;)for(;t(s,1),!i(s););}),r&&(a.count=(i,s)=>(Ex.setTime(+i),Ax.setTime(+s),e(Ex),e(Ax),Math.floor(r(Ex,Ax))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?s=>n(s)%i===0:s=>a.count(0,s)%i===0):a)),a}const Cm=Zr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Cm.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Zr(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Cm);Cm.range;const bs=1e3,ii=bs*60,ws=ii*60,Ls=ws*24,uw=Ls*7,W_=Ls*30,Tx=Ls*365,cl=Zr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*bs)},(e,t)=>(t-e)/bs,e=>e.getUTCSeconds());cl.range;const dw=Zr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*bs)},(e,t)=>{e.setTime(+e+t*ii)},(e,t)=>(t-e)/ii,e=>e.getMinutes());dw.range;const fw=Zr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*ii)},(e,t)=>(t-e)/ii,e=>e.getUTCMinutes());fw.range;const hw=Zr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*bs-e.getMinutes()*ii)},(e,t)=>{e.setTime(+e+t*ws)},(e,t)=>(t-e)/ws,e=>e.getHours());hw.range;const mw=Zr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*ws)},(e,t)=>(t-e)/ws,e=>e.getUTCHours());mw.range;const Vf=Zr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*ii)/Ls,e=>e.getDate()-1);Vf.range;const Kp=Zr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ls,e=>e.getUTCDate()-1);Kp.range;const G6=Zr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ls,e=>Math.floor(e/Ls));G6.range;function Kl(e){return Zr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*ii)/uw)}const qp=Kl(0),Em=Kl(1),_H=Kl(2),CH=Kl(3),ou=Kl(4),EH=Kl(5),AH=Kl(6);qp.range;Em.range;_H.range;CH.range;ou.range;EH.range;AH.range;function ql(e){return Zr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/uw)}const Xp=ql(0),Am=ql(1),TH=ql(2),PH=ql(3),lu=ql(4),OH=ql(5),DH=ql(6);Xp.range;Am.range;TH.range;PH.range;lu.range;OH.range;DH.range;const pw=Zr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());pw.range;const gw=Zr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());gw.range;const Bs=Zr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Bs.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Zr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Bs.range;const js=Zr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());js.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Zr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});js.range;function V6(e,t,r,n,a,i){const s=[[cl,1,bs],[cl,5,5*bs],[cl,15,15*bs],[cl,30,30*bs],[i,1,ii],[i,5,5*ii],[i,15,15*ii],[i,30,30*ii],[a,1,ws],[a,3,3*ws],[a,6,6*ws],[a,12,12*ws],[n,1,Ls],[n,2,2*Ls],[r,1,uw],[t,1,W_],[t,3,3*W_],[e,1,Tx]];function o(u,d,f){const m=d<u;m&&([u,d]=[d,u]);const p=f&&typeof f.range=="function"?f:c(u,d,f),x=p?p.range(u,+d+1):[];return m?x.reverse():x}function c(u,d,f){const m=Math.abs(d-u)/f,p=Jb(([,,y])=>y).right(s,m);if(p===s.length)return e.every(Tv(u/Tx,d/Tx,f));if(p===0)return Cm.every(Math.max(Tv(u,d,f),1));const[x,g]=s[m/s[p-1][2]<s[p][2]/m?p-1:p];return x.every(g)}return[o,c]}const[IH,RH]=V6(js,gw,Xp,G6,mw,fw),[FH,MH]=V6(Bs,pw,qp,Vf,hw,dw);function Px(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Ox(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function ed(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function LH(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,s=e.shortDays,o=e.months,c=e.shortMonths,u=td(a),d=rd(a),f=td(i),m=rd(i),p=td(s),x=rd(s),g=td(o),y=rd(o),v=td(c),b=rd(c),w={a:W,A:ie,b:B,B:ee,c:null,d:Y_,e:Y_,f:sW,g:gW,G:yW,H:nW,I:aW,j:iW,L:K6,m:oW,M:lW,p:le,q:R,Q:Z_,s:eC,S:cW,u:uW,U:dW,V:fW,w:hW,W:mW,x:null,X:null,y:pW,Y:xW,Z:vW,"%":Q_},k={a:j,A:V,b:P,B:q,c:null,d:J_,e:J_,f:kW,g:IW,G:FW,H:bW,I:wW,j:NW,L:X6,m:SW,M:_W,p:O,q:K,Q:Z_,s:eC,S:CW,u:EW,U:AW,V:TW,w:PW,W:OW,x:null,X:null,y:DW,Y:RW,Z:MW,"%":Q_},S={a:T,A:D,b:I,B:z,c:X,d:q_,e:q_,f:ZH,g:K_,G:V_,H:X_,I:X_,j:XH,L:QH,m:qH,M:YH,p:A,q:KH,Q:tW,s:rW,S:JH,u:zH,U:HH,V:WH,w:UH,W:GH,x:H,X:L,y:K_,Y:V_,Z:VH,"%":eW};w.x=_(r,w),w.X=_(n,w),w.c=_(t,w),k.x=_(r,k),k.X=_(n,k),k.c=_(t,k);function _(G,te){return function(ce){var M=[],Le=-1,Te=0,je=G.length,ze,Ce,de;for(ce instanceof Date||(ce=new Date(+ce));++Le<je;)G.charCodeAt(Le)===37&&(M.push(G.slice(Te,Le)),(Ce=G_[ze=G.charAt(++Le)])!=null?ze=G.charAt(++Le):Ce=ze==="e"?" ":"0",(de=te[ze])&&(ze=de(ce,Ce)),M.push(ze),Te=Le+1);return M.push(G.slice(Te,Le)),M.join("")}}function C(G,te){return function(ce){var M=ed(1900,void 0,1),Le=E(M,G,ce+="",0),Te,je;if(Le!=ce.length)return null;if("Q"in M)return new Date(M.Q);if("s"in M)return new Date(M.s*1e3+("L"in M?M.L:0));if(te&&!("Z"in M)&&(M.Z=0),"p"in M&&(M.H=M.H%12+M.p*12),M.m===void 0&&(M.m="q"in M?M.q:0),"V"in M){if(M.V<1||M.V>53)return null;"w"in M||(M.w=1),"Z"in M?(Te=Ox(ed(M.y,0,1)),je=Te.getUTCDay(),Te=je>4||je===0?Am.ceil(Te):Am(Te),Te=Kp.offset(Te,(M.V-1)*7),M.y=Te.getUTCFullYear(),M.m=Te.getUTCMonth(),M.d=Te.getUTCDate()+(M.w+6)%7):(Te=Px(ed(M.y,0,1)),je=Te.getDay(),Te=je>4||je===0?Em.ceil(Te):Em(Te),Te=Vf.offset(Te,(M.V-1)*7),M.y=Te.getFullYear(),M.m=Te.getMonth(),M.d=Te.getDate()+(M.w+6)%7)}else("W"in M||"U"in M)&&("w"in M||(M.w="u"in M?M.u%7:"W"in M?1:0),je="Z"in M?Ox(ed(M.y,0,1)).getUTCDay():Px(ed(M.y,0,1)).getDay(),M.m=0,M.d="W"in M?(M.w+6)%7+M.W*7-(je+5)%7:M.w+M.U*7-(je+6)%7);return"Z"in M?(M.H+=M.Z/100|0,M.M+=M.Z%100,Ox(M)):Px(M)}}function E(G,te,ce,M){for(var Le=0,Te=te.length,je=ce.length,ze,Ce;Le<Te;){if(M>=je)return-1;if(ze=te.charCodeAt(Le++),ze===37){if(ze=te.charAt(Le++),Ce=S[ze in G_?te.charAt(Le++):ze],!Ce||(M=Ce(G,ce,M))<0)return-1}else if(ze!=ce.charCodeAt(M++))return-1}return M}function A(G,te,ce){var M=u.exec(te.slice(ce));return M?(G.p=d.get(M[0].toLowerCase()),ce+M[0].length):-1}function T(G,te,ce){var M=p.exec(te.slice(ce));return M?(G.w=x.get(M[0].toLowerCase()),ce+M[0].length):-1}function D(G,te,ce){var M=f.exec(te.slice(ce));return M?(G.w=m.get(M[0].toLowerCase()),ce+M[0].length):-1}function I(G,te,ce){var M=v.exec(te.slice(ce));return M?(G.m=b.get(M[0].toLowerCase()),ce+M[0].length):-1}function z(G,te,ce){var M=g.exec(te.slice(ce));return M?(G.m=y.get(M[0].toLowerCase()),ce+M[0].length):-1}function X(G,te,ce){return E(G,t,te,ce)}function H(G,te,ce){return E(G,r,te,ce)}function L(G,te,ce){return E(G,n,te,ce)}function W(G){return s[G.getDay()]}function ie(G){return i[G.getDay()]}function B(G){return c[G.getMonth()]}function ee(G){return o[G.getMonth()]}function le(G){return a[+(G.getHours()>=12)]}function R(G){return 1+~~(G.getMonth()/3)}function j(G){return s[G.getUTCDay()]}function V(G){return i[G.getUTCDay()]}function P(G){return c[G.getUTCMonth()]}function q(G){return o[G.getUTCMonth()]}function O(G){return a[+(G.getUTCHours()>=12)]}function K(G){return 1+~~(G.getUTCMonth()/3)}return{format:function(G){var te=_(G+="",w);return te.toString=function(){return G},te},parse:function(G){var te=C(G+="",!1);return te.toString=function(){return G},te},utcFormat:function(G){var te=_(G+="",k);return te.toString=function(){return G},te},utcParse:function(G){var te=C(G+="",!0);return te.toString=function(){return G},te}}}var G_={"-":"",_:" ",0:"0"},dn=/^\s*\d+/,BH=/^%/,jH=/[\\^$*+?|[\]().{}]/g;function Mt(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function $H(e){return e.replace(jH,"\\$&")}function td(e){return new RegExp("^(?:"+e.map($H).join("|")+")","i")}function rd(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function UH(e,t,r){var n=dn.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function zH(e,t,r){var n=dn.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function HH(e,t,r){var n=dn.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function WH(e,t,r){var n=dn.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function GH(e,t,r){var n=dn.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function V_(e,t,r){var n=dn.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function K_(e,t,r){var n=dn.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function VH(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function KH(e,t,r){var n=dn.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function qH(e,t,r){var n=dn.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function q_(e,t,r){var n=dn.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function XH(e,t,r){var n=dn.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function X_(e,t,r){var n=dn.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function YH(e,t,r){var n=dn.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function JH(e,t,r){var n=dn.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function QH(e,t,r){var n=dn.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function ZH(e,t,r){var n=dn.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function eW(e,t,r){var n=BH.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function tW(e,t,r){var n=dn.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function rW(e,t,r){var n=dn.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function Y_(e,t){return Mt(e.getDate(),t,2)}function nW(e,t){return Mt(e.getHours(),t,2)}function aW(e,t){return Mt(e.getHours()%12||12,t,2)}function iW(e,t){return Mt(1+Vf.count(Bs(e),e),t,3)}function K6(e,t){return Mt(e.getMilliseconds(),t,3)}function sW(e,t){return K6(e,t)+"000"}function oW(e,t){return Mt(e.getMonth()+1,t,2)}function lW(e,t){return Mt(e.getMinutes(),t,2)}function cW(e,t){return Mt(e.getSeconds(),t,2)}function uW(e){var t=e.getDay();return t===0?7:t}function dW(e,t){return Mt(qp.count(Bs(e)-1,e),t,2)}function q6(e){var t=e.getDay();return t>=4||t===0?ou(e):ou.ceil(e)}function fW(e,t){return e=q6(e),Mt(ou.count(Bs(e),e)+(Bs(e).getDay()===4),t,2)}function hW(e){return e.getDay()}function mW(e,t){return Mt(Em.count(Bs(e)-1,e),t,2)}function pW(e,t){return Mt(e.getFullYear()%100,t,2)}function gW(e,t){return e=q6(e),Mt(e.getFullYear()%100,t,2)}function xW(e,t){return Mt(e.getFullYear()%1e4,t,4)}function yW(e,t){var r=e.getDay();return e=r>=4||r===0?ou(e):ou.ceil(e),Mt(e.getFullYear()%1e4,t,4)}function vW(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Mt(t/60|0,"0",2)+Mt(t%60,"0",2)}function J_(e,t){return Mt(e.getUTCDate(),t,2)}function bW(e,t){return Mt(e.getUTCHours(),t,2)}function wW(e,t){return Mt(e.getUTCHours()%12||12,t,2)}function NW(e,t){return Mt(1+Kp.count(js(e),e),t,3)}function X6(e,t){return Mt(e.getUTCMilliseconds(),t,3)}function kW(e,t){return X6(e,t)+"000"}function SW(e,t){return Mt(e.getUTCMonth()+1,t,2)}function _W(e,t){return Mt(e.getUTCMinutes(),t,2)}function CW(e,t){return Mt(e.getUTCSeconds(),t,2)}function EW(e){var t=e.getUTCDay();return t===0?7:t}function AW(e,t){return Mt(Xp.count(js(e)-1,e),t,2)}function Y6(e){var t=e.getUTCDay();return t>=4||t===0?lu(e):lu.ceil(e)}function TW(e,t){return e=Y6(e),Mt(lu.count(js(e),e)+(js(e).getUTCDay()===4),t,2)}function PW(e){return e.getUTCDay()}function OW(e,t){return Mt(Am.count(js(e)-1,e),t,2)}function DW(e,t){return Mt(e.getUTCFullYear()%100,t,2)}function IW(e,t){return e=Y6(e),Mt(e.getUTCFullYear()%100,t,2)}function RW(e,t){return Mt(e.getUTCFullYear()%1e4,t,4)}function FW(e,t){var r=e.getUTCDay();return e=r>=4||r===0?lu(e):lu.ceil(e),Mt(e.getUTCFullYear()%1e4,t,4)}function MW(){return"+0000"}function Q_(){return"%"}function Z_(e){return+e}function eC(e){return Math.floor(+e/1e3)}var cc,J6,Q6;LW({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function LW(e){return cc=LH(e),J6=cc.format,cc.parse,Q6=cc.utcFormat,cc.utcParse,cc}function BW(e){return new Date(e)}function jW(e){return e instanceof Date?+e:+new Date(+e)}function xw(e,t,r,n,a,i,s,o,c,u){var d=nw(),f=d.invert,m=d.domain,p=u(".%L"),x=u(":%S"),g=u("%I:%M"),y=u("%I %p"),v=u("%a %d"),b=u("%b %d"),w=u("%B"),k=u("%Y");function S(_){return(c(_)<_?p:o(_)<_?x:s(_)<_?g:i(_)<_?y:n(_)<_?a(_)<_?v:b:r(_)<_?w:k)(_)}return d.invert=function(_){return new Date(f(_))},d.domain=function(_){return arguments.length?m(Array.from(_,jW)):m().map(BW)},d.ticks=function(_){var C=m();return e(C[0],C[C.length-1],_??10)},d.tickFormat=function(_,C){return C==null?S:u(C)},d.nice=function(_){var C=m();return(!_||typeof _.range!="function")&&(_=t(C[0],C[C.length-1],_??10)),_?m(B6(C,_)):d},d.copy=function(){return Gf(d,xw(e,t,r,n,a,i,s,o,c,u))},d}function $W(){return mi.apply(xw(FH,MH,Bs,pw,qp,Vf,hw,dw,cl,J6).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function UW(){return mi.apply(xw(IH,RH,js,gw,Xp,Kp,mw,fw,cl,Q6).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Yp(){var e=0,t=1,r,n,a,i,s=Qn,o=!1,c;function u(f){return f==null||isNaN(f=+f)?c:s(a===0?.5:(f=(i(f)-r)*a,o?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(f){return arguments.length?(o=!!f,u):o},u.interpolator=function(f){return arguments.length?(s=f,u):s};function d(f){return function(m){var p,x;return arguments.length?([p,x]=m,s=f(p,x),u):[s(0),s(1)]}}return u.range=d(Nu),u.rangeRound=d(rw),u.unknown=function(f){return arguments.length?(c=f,u):c},function(f){return i=f,r=f(e),n=f(t),a=r===n?0:1/(n-r),u}}function zo(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Z6(){var e=Uo(Yp()(Qn));return e.copy=function(){return zo(e,Z6())},Ws.apply(e,arguments)}function e5(){var e=sw(Yp()).domain([1,10]);return e.copy=function(){return zo(e,e5()).base(e.base())},Ws.apply(e,arguments)}function t5(){var e=ow(Yp());return e.copy=function(){return zo(e,t5()).constant(e.constant())},Ws.apply(e,arguments)}function yw(){var e=lw(Yp());return e.copy=function(){return zo(e,yw()).exponent(e.exponent())},Ws.apply(e,arguments)}function zW(){return yw.apply(null,arguments).exponent(.5)}function r5(){var e=[],t=Qn;function r(n){if(n!=null&&!isNaN(n=+n))return t((Hf(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(ko),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>Ez(e,i/n))},r.copy=function(){return r5(t).domain(e)},Ws.apply(r,arguments)}function Jp(){var e=0,t=.5,r=1,n=1,a,i,s,o,c,u=Qn,d,f=!1,m;function p(g){return isNaN(g=+g)?m:(g=.5+((g=+d(g))-i)*(n*g<n*i?o:c),u(f?Math.max(0,Math.min(1,g)):g))}p.domain=function(g){return arguments.length?([e,t,r]=g,a=d(e=+e),i=d(t=+t),s=d(r=+r),o=a===i?0:.5/(i-a),c=i===s?0:.5/(s-i),n=i<a?-1:1,p):[e,t,r]},p.clamp=function(g){return arguments.length?(f=!!g,p):f},p.interpolator=function(g){return arguments.length?(u=g,p):u};function x(g){return function(y){var v,b,w;return arguments.length?([v,b,w]=y,u=eH(g,[v,b,w]),p):[u(0),u(.5),u(1)]}}return p.range=x(Nu),p.rangeRound=x(rw),p.unknown=function(g){return arguments.length?(m=g,p):m},function(g){return d=g,a=g(e),i=g(t),s=g(r),o=a===i?0:.5/(i-a),c=i===s?0:.5/(s-i),n=i<a?-1:1,p}}function n5(){var e=Uo(Jp()(Qn));return e.copy=function(){return zo(e,n5())},Ws.apply(e,arguments)}function a5(){var e=sw(Jp()).domain([.1,1,10]);return e.copy=function(){return zo(e,a5()).base(e.base())},Ws.apply(e,arguments)}function i5(){var e=ow(Jp());return e.copy=function(){return zo(e,i5()).constant(e.constant())},Ws.apply(e,arguments)}function vw(){var e=lw(Jp());return e.copy=function(){return zo(e,vw()).exponent(e.exponent())},Ws.apply(e,arguments)}function HW(){return vw.apply(null,arguments).exponent(.5)}const ud=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Zb,scaleDiverging:n5,scaleDivergingLog:a5,scaleDivergingPow:vw,scaleDivergingSqrt:HW,scaleDivergingSymlog:i5,scaleIdentity:L6,scaleImplicit:Pv,scaleLinear:M6,scaleLog:j6,scaleOrdinal:Qb,scalePoint:Pz,scalePow:cw,scaleQuantile:z6,scaleQuantize:H6,scaleRadial:U6,scaleSequential:Z6,scaleSequentialLog:e5,scaleSequentialPow:yw,scaleSequentialQuantile:r5,scaleSequentialSqrt:zW,scaleSequentialSymlog:t5,scaleSqrt:kH,scaleSymlog:$6,scaleThreshold:W6,scaleTime:$W,scaleUtc:UW,tickFormat:F6},Symbol.toStringTag,{value:"Module"}));var Ho=e=>e.chartData,bw=xe([Ho],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),Qp=(e,t,r,n)=>n?bw(e):Ho(e);function Dl(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(zn(t)&&zn(r))return!0}return!1}function tC(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function s5(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,a,i;if(zn(r))a=r;else if(typeof r=="function")return;if(zn(n))i=n;else if(typeof n=="function")return;var s=[a,i];if(Dl(s))return s}}function WW(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(Dl(n))return tC(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[a,i]=e,s,o;if(a==="auto")t!=null&&(s=Math.min(...t));else if(lt(a))s=a;else if(typeof a=="function")try{t!=null&&(s=a(t==null?void 0:t[0]))}catch{}else if(typeof a=="string"&&VS.test(a)){var c=VS.exec(a);if(c==null||t==null)s=void 0;else{var u=+c[1];s=t[0]-u}}else s=t==null?void 0:t[0];if(i==="auto")t!=null&&(o=Math.max(...t));else if(lt(i))o=i;else if(typeof i=="function")try{t!=null&&(o=i(t==null?void 0:t[1]))}catch{}else if(typeof i=="string"&&KS.test(i)){var d=KS.exec(i);if(d==null||t==null)o=void 0;else{var f=+d[1];o=t[1]+f}}else o=t==null?void 0:t[1];var m=[s,o];if(Dl(m))return t==null?m:tC(m,t,r)}}}var ku=1e9,GW={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Nw,ur=!0,hi="[DecimalError] ",xl=hi+"Invalid argument: ",ww=hi+"Exponent out of range: ",Su=Math.floor,el=Math.pow,VW=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Sa,rn=1e7,nr=7,o5=9007199254740991,Tm=Su(o5/nr),rt={};rt.absoluteValue=rt.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};rt.comparedTo=rt.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};rt.decimalPlaces=rt.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*nr;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};rt.dividedBy=rt.div=function(e){return Cs(this,new this.constructor(e))};rt.dividedToIntegerBy=rt.idiv=function(e){var t=this,r=t.constructor;return Kt(Cs(t,new r(e),0,1),r.precision)};rt.equals=rt.eq=function(e){return!this.cmp(e)};rt.exponent=function(){return zr(this)};rt.greaterThan=rt.gt=function(e){return this.cmp(e)>0};rt.greaterThanOrEqualTo=rt.gte=function(e){return this.cmp(e)>=0};rt.isInteger=rt.isint=function(){return this.e>this.d.length-2};rt.isNegative=rt.isneg=function(){return this.s<0};rt.isPositive=rt.ispos=function(){return this.s>0};rt.isZero=function(){return this.s===0};rt.lessThan=rt.lt=function(e){return this.cmp(e)<0};rt.lessThanOrEqualTo=rt.lte=function(e){return this.cmp(e)<1};rt.logarithm=rt.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Sa))throw Error(hi+"NaN");if(r.s<1)throw Error(hi+(r.s?"NaN":"-Infinity"));return r.eq(Sa)?new n(0):(ur=!1,t=Cs(lf(r,i),lf(e,i),i),ur=!0,Kt(t,a))};rt.minus=rt.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?u5(t,e):l5(t,(e.s=-e.s,e))};rt.modulo=rt.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(hi+"NaN");return r.s?(ur=!1,t=Cs(r,e,0,1).times(e),ur=!0,r.minus(t)):Kt(new n(r),a)};rt.naturalExponential=rt.exp=function(){return c5(this)};rt.naturalLogarithm=rt.ln=function(){return lf(this)};rt.negated=rt.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};rt.plus=rt.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?l5(t,e):u5(t,(e.s=-e.s,e))};rt.precision=rt.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(xl+e);if(t=zr(a)+1,n=a.d.length-1,r=n*nr+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};rt.squareRoot=rt.sqrt=function(){var e,t,r,n,a,i,s,o=this,c=o.constructor;if(o.s<1){if(!o.s)return new c(0);throw Error(hi+"NaN")}for(e=zr(o),ur=!1,a=Math.sqrt(+o),a==0||a==1/0?(t=Ki(o.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=Su((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(a.toString()),r=c.precision,a=s=r+3;;)if(i=n,n=i.plus(Cs(o,i,s+2)).times(.5),Ki(i.d).slice(0,s)===(t=Ki(n.d)).slice(0,s)){if(t=t.slice(s-3,s+1),a==s&&t=="4999"){if(Kt(i,r+1,0),i.times(i).eq(o)){n=i;break}}else if(t!="9999")break;s+=4}return ur=!0,Kt(n,r)};rt.times=rt.mul=function(e){var t,r,n,a,i,s,o,c,u,d=this,f=d.constructor,m=d.d,p=(e=new f(e)).d;if(!d.s||!e.s)return new f(0);for(e.s*=d.s,r=d.e+e.e,c=m.length,u=p.length,c<u&&(i=m,m=p,p=i,s=c,c=u,u=s),i=[],s=c+u,n=s;n--;)i.push(0);for(n=u;--n>=0;){for(t=0,a=c+n;a>n;)o=i[a]+p[n]*m[a-n-1]+t,i[a--]=o%rn|0,t=o/rn|0;i[a]=(i[a]+t)%rn|0}for(;!i[--s];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,ur?Kt(e,f.precision):e};rt.toDecimalPlaces=rt.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(as(e,0,ku),t===void 0?t=n.rounding:as(t,0,8),Kt(r,e+zr(r)+1,t))};rt.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=Il(n,!0):(as(e,0,ku),t===void 0?t=a.rounding:as(t,0,8),n=Kt(new a(n),e+1,t),r=Il(n,!0,e+1)),r};rt.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?Il(a):(as(e,0,ku),t===void 0?t=i.rounding:as(t,0,8),n=Kt(new i(a),e+zr(a)+1,t),r=Il(n.abs(),!1,e+zr(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};rt.toInteger=rt.toint=function(){var e=this,t=e.constructor;return Kt(new t(e),zr(e)+1,t.rounding)};rt.toNumber=function(){return+this};rt.toPower=rt.pow=function(e){var t,r,n,a,i,s,o=this,c=o.constructor,u=12,d=+(e=new c(e));if(!e.s)return new c(Sa);if(o=new c(o),!o.s){if(e.s<1)throw Error(hi+"Infinity");return o}if(o.eq(Sa))return o;if(n=c.precision,e.eq(Sa))return Kt(o,n);if(t=e.e,r=e.d.length-1,s=t>=r,i=o.s,s){if((r=d<0?-d:d)<=o5){for(a=new c(Sa),t=Math.ceil(n/nr+4),ur=!1;r%2&&(a=a.times(o),nC(a.d,t)),r=Su(r/2),r!==0;)o=o.times(o),nC(o.d,t);return ur=!0,e.s<0?new c(Sa).div(a):Kt(a,n)}}else if(i<0)throw Error(hi+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,o.s=1,ur=!1,a=e.times(lf(o,n+u)),ur=!0,a=c5(a),a.s=i,a};rt.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=zr(a),n=Il(a,r<=i.toExpNeg||r>=i.toExpPos)):(as(e,1,ku),t===void 0?t=i.rounding:as(t,0,8),a=Kt(new i(a),e,t),r=zr(a),n=Il(a,e<=r||r<=i.toExpNeg,e)),n};rt.toSignificantDigits=rt.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(as(e,1,ku),t===void 0?t=n.rounding:as(t,0,8)),Kt(new n(r),e,t)};rt.toString=rt.valueOf=rt.val=rt.toJSON=rt[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=zr(e),r=e.constructor;return Il(e,t<=r.toExpNeg||t>=r.toExpPos)};function l5(e,t){var r,n,a,i,s,o,c,u,d=e.constructor,f=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),ur?Kt(t,f):t;if(c=e.d,u=t.d,s=e.e,a=t.e,c=c.slice(),i=s-a,i){for(i<0?(n=c,i=-i,o=u.length):(n=u,a=s,o=c.length),s=Math.ceil(f/nr),o=s>o?s+1:o+1,i>o&&(i=o,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(o=c.length,i=u.length,o-i<0&&(i=o,n=u,u=c,c=n),r=0;i;)r=(c[--i]=c[i]+u[i]+r)/rn|0,c[i]%=rn;for(r&&(c.unshift(r),++a),o=c.length;c[--o]==0;)c.pop();return t.d=c,t.e=a,ur?Kt(t,f):t}function as(e,t,r){if(e!==~~e||e<t||e>r)throw Error(xl+e)}function Ki(e){var t,r,n,a=e.length-1,i="",s=e[0];if(a>0){for(i+=s,t=1;t<a;t++)n=e[t]+"",r=nr-n.length,r&&(i+=to(r)),i+=n;s=e[t],n=s+"",r=nr-n.length,r&&(i+=to(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}var Cs=function(){function e(n,a){var i,s=0,o=n.length;for(n=n.slice();o--;)i=n[o]*a+s,n[o]=i%rn|0,s=i/rn|0;return s&&n.unshift(s),n}function t(n,a,i,s){var o,c;if(i!=s)c=i>s?1:-1;else for(o=c=0;o<i;o++)if(n[o]!=a[o]){c=n[o]>a[o]?1:-1;break}return c}function r(n,a,i){for(var s=0;i--;)n[i]-=s,s=n[i]<a[i]?1:0,n[i]=s*rn+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,s){var o,c,u,d,f,m,p,x,g,y,v,b,w,k,S,_,C,E,A=n.constructor,T=n.s==a.s?1:-1,D=n.d,I=a.d;if(!n.s)return new A(n);if(!a.s)throw Error(hi+"Division by zero");for(c=n.e-a.e,C=I.length,S=D.length,p=new A(T),x=p.d=[],u=0;I[u]==(D[u]||0);)++u;if(I[u]>(D[u]||0)&&--c,i==null?b=i=A.precision:s?b=i+(zr(n)-zr(a))+1:b=i,b<0)return new A(0);if(b=b/nr+2|0,u=0,C==1)for(d=0,I=I[0],b++;(u<S||d)&&b--;u++)w=d*rn+(D[u]||0),x[u]=w/I|0,d=w%I|0;else{for(d=rn/(I[0]+1)|0,d>1&&(I=e(I,d),D=e(D,d),C=I.length,S=D.length),k=C,g=D.slice(0,C),y=g.length;y<C;)g[y++]=0;E=I.slice(),E.unshift(0),_=I[0],I[1]>=rn/2&&++_;do d=0,o=t(I,g,C,y),o<0?(v=g[0],C!=y&&(v=v*rn+(g[1]||0)),d=v/_|0,d>1?(d>=rn&&(d=rn-1),f=e(I,d),m=f.length,y=g.length,o=t(f,g,m,y),o==1&&(d--,r(f,C<m?E:I,m))):(d==0&&(o=d=1),f=I.slice()),m=f.length,m<y&&f.unshift(0),r(g,f,y),o==-1&&(y=g.length,o=t(I,g,C,y),o<1&&(d++,r(g,C<y?E:I,y))),y=g.length):o===0&&(d++,g=[0]),x[u++]=d,o&&g[0]?g[y++]=D[k]||0:(g=[D[k]],y=1);while((k++<S||g[0]!==void 0)&&b--)}return x[0]||x.shift(),p.e=c,Kt(p,s?i+zr(p)+1:i)}}();function c5(e,t){var r,n,a,i,s,o,c=0,u=0,d=e.constructor,f=d.precision;if(zr(e)>16)throw Error(ww+zr(e));if(!e.s)return new d(Sa);for(t==null?(ur=!1,o=f):o=t,s=new d(.03125);e.abs().gte(.1);)e=e.times(s),u+=5;for(n=Math.log(el(2,u))/Math.LN10*2+5|0,o+=n,r=a=i=new d(Sa),d.precision=o;;){if(a=Kt(a.times(e),o),r=r.times(++c),s=i.plus(Cs(a,r,o)),Ki(s.d).slice(0,o)===Ki(i.d).slice(0,o)){for(;u--;)i=Kt(i.times(i),o);return d.precision=f,t==null?(ur=!0,Kt(i,f)):i}i=s}}function zr(e){for(var t=e.e*nr,r=e.d[0];r>=10;r/=10)t++;return t}function Dx(e,t,r){if(t>e.LN10.sd())throw ur=!0,r&&(e.precision=r),Error(hi+"LN10 precision limit exceeded");return Kt(new e(e.LN10),t)}function to(e){for(var t="";e--;)t+="0";return t}function lf(e,t){var r,n,a,i,s,o,c,u,d,f=1,m=10,p=e,x=p.d,g=p.constructor,y=g.precision;if(p.s<1)throw Error(hi+(p.s?"NaN":"-Infinity"));if(p.eq(Sa))return new g(0);if(t==null?(ur=!1,u=y):u=t,p.eq(10))return t==null&&(ur=!0),Dx(g,u);if(u+=m,g.precision=u,r=Ki(x),n=r.charAt(0),i=zr(p),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)p=p.times(e),r=Ki(p.d),n=r.charAt(0),f++;i=zr(p),n>1?(p=new g("0."+r),i++):p=new g(n+"."+r.slice(1))}else return c=Dx(g,u+2,y).times(i+""),p=lf(new g(n+"."+r.slice(1)),u-m).plus(c),g.precision=y,t==null?(ur=!0,Kt(p,y)):p;for(o=s=p=Cs(p.minus(Sa),p.plus(Sa),u),d=Kt(p.times(p),u),a=3;;){if(s=Kt(s.times(d),u),c=o.plus(Cs(s,new g(a),u)),Ki(c.d).slice(0,u)===Ki(o.d).slice(0,u))return o=o.times(2),i!==0&&(o=o.plus(Dx(g,u+2,y).times(i+""))),o=Cs(o,new g(f),u),g.precision=y,t==null?(ur=!0,Kt(o,y)):o;o=c,a+=2}}function rC(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=Su(r/nr),e.d=[],n=(r+1)%nr,r<0&&(n+=nr),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=nr;n<a;)e.d.push(+t.slice(n,n+=nr));t=t.slice(n),n=nr-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),ur&&(e.e>Tm||e.e<-Tm))throw Error(ww+r)}else e.s=0,e.e=0,e.d=[0];return e}function Kt(e,t,r){var n,a,i,s,o,c,u,d,f=e.d;for(s=1,i=f[0];i>=10;i/=10)s++;if(n=t-s,n<0)n+=nr,a=t,u=f[d=0];else{if(d=Math.ceil((n+1)/nr),i=f.length,d>=i)return e;for(u=i=f[d],s=1;i>=10;i/=10)s++;n%=nr,a=n-nr+s}if(r!==void 0&&(i=el(10,s-a-1),o=u/i%10|0,c=t<0||f[d+1]!==void 0||u%i,c=r<4?(o||c)&&(r==0||r==(e.s<0?3:2)):o>5||o==5&&(r==4||c||r==6&&(n>0?a>0?u/el(10,s-a):0:f[d-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(i=zr(e),f.length=1,t=t-i-1,f[0]=el(10,(nr-t%nr)%nr),e.e=Su(-t/nr)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=d,i=1,d--):(f.length=d+1,i=el(10,nr-n),f[d]=a>0?(u/el(10,s-a)%el(10,a)|0)*i:0),c)for(;;)if(d==0){(f[0]+=i)==rn&&(f[0]=1,++e.e);break}else{if(f[d]+=i,f[d]!=rn)break;f[d--]=0,i=1}for(n=f.length;f[--n]===0;)f.pop();if(ur&&(e.e>Tm||e.e<-Tm))throw Error(ww+zr(e));return e}function u5(e,t){var r,n,a,i,s,o,c,u,d,f,m=e.constructor,p=m.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new m(e),ur?Kt(t,p):t;if(c=e.d,f=t.d,n=t.e,u=e.e,c=c.slice(),s=u-n,s){for(d=s<0,d?(r=c,s=-s,o=f.length):(r=f,n=u,o=c.length),a=Math.max(Math.ceil(p/nr),o)+2,s>a&&(s=a,r.length=1),r.reverse(),a=s;a--;)r.push(0);r.reverse()}else{for(a=c.length,o=f.length,d=a<o,d&&(o=a),a=0;a<o;a++)if(c[a]!=f[a]){d=c[a]<f[a];break}s=0}for(d&&(r=c,c=f,f=r,t.s=-t.s),o=c.length,a=f.length-o;a>0;--a)c[o++]=0;for(a=f.length;a>s;){if(c[--a]<f[a]){for(i=a;i&&c[--i]===0;)c[i]=rn-1;--c[i],c[a]+=rn}c[a]-=f[a]}for(;c[--o]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,ur?Kt(t,p):t):new m(0)}function Il(e,t,r){var n,a=zr(e),i=Ki(e.d),s=i.length;return t?(r&&(n=r-s)>0?i=i.charAt(0)+"."+i.slice(1)+to(n):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+to(-a-1)+i,r&&(n=r-s)>0&&(i+=to(n))):a>=s?(i+=to(a+1-s),r&&(n=r-a-1)>0&&(i=i+"."+to(n))):((n=a+1)<s&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-s)>0&&(a+1===s&&(i+="."),i+=to(n))),e.s<0?"-"+i:i}function nC(e,t){if(e.length>t)return e.length=t,!0}function d5(e){var t,r,n;function a(i){var s=this;if(!(s instanceof a))return new a(i);if(s.constructor=a,i instanceof a){s.s=i.s,s.e=i.e,s.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(xl+i);if(i>0)s.s=1;else if(i<0)i=-i,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(i===~~i&&i<1e7){s.e=0,s.d=[i];return}return rC(s,i.toString())}else if(typeof i!="string")throw Error(xl+i);if(i.charCodeAt(0)===45?(i=i.slice(1),s.s=-1):s.s=1,VW.test(i))rC(s,i);else throw Error(xl+i)}if(a.prototype=rt,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=d5,a.config=a.set=KW,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function KW(e){if(!e||typeof e!="object")throw Error(hi+"Object expected");var t,r,n,a=["precision",1,ku,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(Su(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(xl+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(xl+r+": "+n);return this}var Nw=d5(GW);Sa=new Nw(1);const zt=Nw;var qW=e=>e,f5={"@@functional/placeholder":!0},h5=e=>e===f5,aC=e=>function t(){return arguments.length===0||arguments.length===1&&h5(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},m5=(e,t)=>e===1?t:aC(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var i=n.filter(s=>s!==f5).length;return i>=e?t(...n):m5(e-i,aC(function(){for(var s=arguments.length,o=new Array(s),c=0;c<s;c++)o[c]=arguments[c];var u=n.map(d=>h5(d)?o.shift():d);return t(...u,...o)}))}),Zp=e=>m5(e.length,e),Rv=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},XW=Zp((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),YW=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return qW;var a=r.reverse(),i=a[0],s=a.slice(1);return function(){return s.reduce((o,c)=>c(o),i(...arguments))}},Fv=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),p5=e=>{var t=null,r=null;return function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return t&&a.every((s,o)=>{var c;return s===((c=t)===null||c===void 0?void 0:c[o])})||(t=a,r=e(...a)),r}};function g5(e){var t;return e===0?t=1:t=Math.floor(new zt(e).abs().log(10).toNumber())+1,t}function x5(e,t,r){for(var n=new zt(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}Zp((e,t,r)=>{var n=+e,a=+t;return n+r*(a-n)});Zp((e,t,r)=>{var n=t-+e;return n=n||1/0,(r-e)/n});Zp((e,t,r)=>{var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});var y5=e=>{var[t,r]=e,[n,a]=[t,r];return t>r&&([n,a]=[r,t]),[n,a]},v5=(e,t,r)=>{if(e.lte(0))return new zt(0);var n=g5(e.toNumber()),a=new zt(10).pow(n),i=e.div(a),s=n!==1?.05:.1,o=new zt(Math.ceil(i.div(s).toNumber())).add(r).mul(s),c=o.mul(a);return t?new zt(c.toNumber()):new zt(Math.ceil(c.toNumber()))},JW=(e,t,r)=>{var n=new zt(1),a=new zt(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new zt(10).pow(g5(e)-1),a=new zt(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new zt(Math.floor(e)))}else e===0?a=new zt(Math.floor((t-1)/2)):r||(a=new zt(Math.floor(e)));var s=Math.floor((t-1)/2),o=YW(XW(c=>a.add(new zt(c-s).mul(n)).toNumber()),Rv);return o(0,t)},b5=function(t,r,n,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new zt(0),tickMin:new zt(0),tickMax:new zt(0)};var s=v5(new zt(r).sub(t).div(n-1),a,i),o;t<=0&&r>=0?o=new zt(0):(o=new zt(t).add(r).div(2),o=o.sub(new zt(o).mod(s)));var c=Math.ceil(o.sub(t).div(s).toNumber()),u=Math.ceil(new zt(r).sub(o).div(s).toNumber()),d=c+u+1;return d>n?b5(t,r,n,a,i+1):(d<n&&(u=r>0?u+(n-d):u,c=r>0?c:c+(n-d)),{step:s,tickMin:o.sub(new zt(c).mul(s)),tickMax:o.add(new zt(u).mul(s))})};function QW(e){var[t,r]=e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(n,2),[s,o]=y5([t,r]);if(s===-1/0||o===1/0){var c=o===1/0?[s,...Rv(0,n-1).map(()=>1/0)]:[...Rv(0,n-1).map(()=>-1/0),o];return t>r?Fv(c):c}if(s===o)return JW(s,n,a);var{step:u,tickMin:d,tickMax:f}=b5(s,o,i,a,0),m=x5(d,f.add(new zt(.1).mul(u)),u);return t>r?Fv(m):m}function ZW(e,t){var[r,n]=e,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[i,s]=y5([r,n]);if(i===-1/0||s===1/0)return[r,n];if(i===s)return[i];var o=Math.max(t,2),c=v5(new zt(s).sub(i).div(o-1),a,0),u=[...x5(new zt(i),new zt(s),c),s];return a===!1&&(u=u.map(d=>Math.round(d))),r>n?Fv(u):u}var eG=p5(QW),tG=p5(ZW),w5=e=>e.rootProps.maxBarSize,rG=e=>e.rootProps.barGap,N5=e=>e.rootProps.barCategoryGap,nG=e=>e.rootProps.barSize,Kf=e=>e.rootProps.stackOffset,kw=e=>e.options.chartName,Sw=e=>e.rootProps.syncId,k5=e=>e.rootProps.syncMethod,_w=e=>e.options.eventEmitter,ms={allowDuplicatedCategory:!0,angleAxisId:0,axisLine:!0,cx:0,cy:0,orientation:"outer",reversed:!1,scale:"auto",tick:!0,tickLine:!0,tickSize:8,type:"category"},ba={allowDataOverflow:!1,allowDuplicatedCategory:!0,angle:0,axisLine:!0,cx:0,cy:0,orientation:"right",radiusAxisId:0,scale:"auto",stroke:"#ccc",tick:!0,tickCount:5,type:"number"},eg=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},aG={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:ms.angleAxisId,includeHidden:!1,name:void 0,reversed:ms.reversed,scale:ms.scale,tick:ms.tick,tickCount:void 0,ticks:void 0,type:ms.type,unit:void 0},iG={allowDataOverflow:ba.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:ba.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:ba.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:ba.scale,tick:ba.tick,tickCount:ba.tickCount,ticks:void 0,type:ba.type,unit:void 0},sG={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:ms.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:ms.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:ms.scale,tick:ms.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},oG={allowDataOverflow:ba.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:ba.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:ba.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:ba.scale,tick:ba.tick,tickCount:ba.tickCount,ticks:void 0,type:"category",unit:void 0},Cw=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?sG:aG,Ew=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?oG:iG,tg=e=>e.polarOptions,Aw=xe([zs,Hs,Qr],YP),S5=xe([tg,Aw],(e,t)=>{if(e!=null)return Bn(e.innerRadius,t,0)}),_5=xe([tg,Aw],(e,t)=>{if(e!=null)return Bn(e.outerRadius,t,t*.8)}),lG=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},C5=xe([tg],lG);xe([Cw,C5],eg);var E5=xe([Aw,S5,_5],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});xe([Ew,E5],eg);var A5=xe([Ot,tg,S5,_5,zs,Hs],(e,t,r,n,a,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:s,cy:o,startAngle:c,endAngle:u}=t;return{cx:Bn(s,a,a/2),cy:Bn(o,i,i/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:u,clockWise:!1}}}),hr=(e,t)=>t,qf=(e,t,r)=>r;function Tw(e){return e==null?void 0:e.id}var en=e=>{var t=Ot(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},_u=e=>e.tooltip.settings.axisId,tn=e=>{var t=en(e),r=_u(e);return Xf(e,t,r)},T5=xe([tn],e=>e==null?void 0:e.dataKey);function P5(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:a,dataKey:i}=r,s=new Map;return e.forEach(o=>{var c,u=(c=o.data)!==null&&c!==void 0?c:n;if(!(u==null||u.length===0)){var d=Tw(o);u.forEach((f,m)=>{var p=i==null||a?m:String(Zt(f,i,null)),x=Zt(f,o.dataKey,0),g;s.has(p)?g=s.get(p):g={},Object.assign(g,{[d]:x}),s.set(p,g)})}}),Array.from(s.values())}function rg(e){return e.stackId!=null&&e.dataKey!=null}var ng=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function ag(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function iC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Pm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iC(Object(r),!0).forEach(function(n){cG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cG(e,t,r){return(t=uG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uG(e){var t=dG(e,"string");return typeof t=="symbol"?t:t+""}function dG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mv=[0,"auto"],xa={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},O5=(e,t)=>e.cartesianAxis.xAxis[t],Gs=(e,t)=>{var r=O5(e,t);return r??xa},ya={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:Mv,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:$f},D5=(e,t)=>e.cartesianAxis.yAxis[t],Vs=(e,t)=>{var r=D5(e,t);return r??ya},fG={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},Pw=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??fG},wr=(e,t,r)=>{switch(t){case"xAxis":return Gs(e,r);case"yAxis":return Vs(e,r);case"zAxis":return Pw(e,r);case"angleAxis":return Cw(e,r);case"radiusAxis":return Ew(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},hG=(e,t,r)=>{switch(t){case"xAxis":return Gs(e,r);case"yAxis":return Vs(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Xf=(e,t,r)=>{switch(t){case"xAxis":return Gs(e,r);case"yAxis":return Vs(e,r);case"angleAxis":return Cw(e,r);case"radiusAxis":return Ew(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},I5=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function Ow(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var ig=e=>e.graphicalItems.cartesianItems,mG=xe([hr,qf],Ow),Dw=(e,t,r)=>e.filter(r).filter(n=>(t==null?void 0:t.includeHidden)===!0?!0:!n.hide),Yf=xe([ig,wr,mG],Dw,{memoizeOptions:{resultEqualityCheck:ag}}),R5=xe([Yf],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(rg)),F5=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),pG=xe([Yf],F5),Iw=e=>e.map(t=>t.data).filter(Boolean).flat(1),gG=xe([Yf],Iw,{memoizeOptions:{resultEqualityCheck:ag}}),Rw=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=t;return e.length>0?e:r.slice(n,a+1)},Fw=xe([gG,Qp],Rw),Mw=(e,t,r)=>(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:Zt(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(a=>({value:Zt(a,n)}))):e.map(n=>({value:n})),sg=xe([Fw,wr,Yf],Mw);function M5(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function Sh(e){if(ns(e)||e instanceof Date){var t=Number(e);if(zn(t))return t}}function sC(e){if(Array.isArray(e)){var t=[Sh(e[0]),Sh(e[1])];return Dl(t)?t:void 0}var r=Sh(e);if(r!=null)return[r,r]}function Cu(e){return e.map(Sh).filter(MU)}function xG(e,t,r){return!r||typeof t!="number"||di(t)?[]:r.length?Cu(r.flatMap(n=>{var a=Zt(e,n.dataKey),i,s;if(Array.isArray(a)?[i,s]=a:i=s=a,!(!zn(i)||!zn(s)))return[t-i,t+s]})):[]}var yG=xe([R5,Qp,tn],P5),L5=(e,t,r)=>{var n={},a=t.reduce((i,s)=>(s.stackId==null||(i[s.stackId]==null&&(i[s.stackId]=[]),i[s.stackId].push(s)),i),n);return Object.fromEntries(Object.entries(a).map(i=>{var[s,o]=i,c=o.map(Tw);return[s,{stackedData:c$(e,c,r),graphicalItems:o}]}))},Lv=xe([yG,R5,Kf],L5),B5=(e,t,r,n)=>{var{dataStartIndex:a,dataEndIndex:i}=t;if(n==null&&r!=="zAxis"){var s=m$(e,a,i);if(!(s!=null&&s[0]===0&&s[1]===0))return s}},vG=xe([wr],e=>e.allowDataOverflow),Lw=e=>{var t;if(e==null||!("domain"in e))return Mv;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=Cu(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e==null?void 0:e.domain)!==null&&t!==void 0?t:Mv},Bw=xe([wr],Lw),jw=xe([Bw,vG],s5),bG=xe([Lv,Ho,hr,jw],B5,{memoizeOptions:{resultEqualityCheck:ng}}),og=e=>e.errorBars,wG=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>M5(r,n)),Om=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var i=a.flat(),s=Math.min(...i),o=Math.max(...i);return[s,o]}},$w=(e,t,r,n,a)=>{var i,s;if(r.length>0&&e.forEach(o=>{r.forEach(c=>{var u,d,f=(u=n[c.id])===null||u===void 0?void 0:u.filter(v=>M5(a,v)),m=Zt(o,(d=t.dataKey)!==null&&d!==void 0?d:c.dataKey),p=xG(o,m,f);if(p.length>=2){var x=Math.min(...p),g=Math.max(...p);(i==null||x<i)&&(i=x),(s==null||g>s)&&(s=g)}var y=sC(m);y!=null&&(i=i==null?y[0]:Math.min(i,y[0]),s=s==null?y[1]:Math.max(s,y[1]))})}),(t==null?void 0:t.dataKey)!=null&&e.forEach(o=>{var c=sC(Zt(o,t.dataKey));c!=null&&(i=i==null?c[0]:Math.min(i,c[0]),s=s==null?c[1]:Math.max(s,c[1]))}),zn(i)&&zn(s))return[i,s]},NG=xe([Fw,wr,pG,og,hr],$w,{memoizeOptions:{resultEqualityCheck:ng}});function kG(e){var{value:t}=e;if(ns(t)||t instanceof Date)return t}var SG=(e,t,r)=>{var n=e.map(kG).filter(a=>a!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&V3(n))?_6(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},j5=e=>e.referenceElements.dots,Eu=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),_G=xe([j5,hr,qf],Eu),$5=e=>e.referenceElements.areas,CG=xe([$5,hr,qf],Eu),U5=e=>e.referenceElements.lines,EG=xe([U5,hr,qf],Eu),z5=(e,t)=>{var r=Cu(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},AG=xe(_G,hr,z5),H5=(e,t)=>{var r=Cu(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},TG=xe([CG,hr],H5),W5=(e,t)=>{var r=Cu(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},PG=xe(EG,hr,W5),OG=xe(AG,PG,TG,(e,t,r)=>Om(e,r,t)),Uw=(e,t,r,n,a,i,s,o)=>{if(r!=null)return r;var c=s==="vertical"&&o==="xAxis"||s==="horizontal"&&o==="yAxis",u=c?Om(n,i,a):Om(i,a);return WW(t,u,e.allowDataOverflow)},DG=xe([wr,Bw,jw,bG,NG,OG,Ot,hr],Uw,{memoizeOptions:{resultEqualityCheck:ng}}),IG=[0,1],zw=(e,t,r,n,a,i,s)=>{if(!((e==null||r==null||r.length===0)&&s===void 0)){var{dataKey:o,type:c}=e,u=jo(t,i);return u&&o==null?_6(0,r.length):c==="category"?SG(n,e,u):a==="expand"?IG:s}},Hw=xe([wr,Ot,Fw,sg,Kf,hr,DG],zw),G5=(e,t,r,n,a)=>{if(e!=null){var{scale:i,type:s}=e;if(i==="auto")return t==="radial"&&a==="radiusAxis"?"band":t==="radial"&&a==="angleAxis"?"linear":s==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":s==="category"?"band":"linear";if(typeof i=="string"){var o="scale".concat(Mf(i));return o in ud?o:"point"}}},Au=xe([wr,Ot,I5,kw,hr],G5);function RG(e){if(e!=null){if(e in ud)return ud[e]();var t="scale".concat(Mf(e));if(t in ud)return ud[t]()}}function Ww(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var a=RG(t);if(a!=null){var i=a.domain(r).range(n);return a$(i),i}}}var Gw=(e,t,r)=>{var n=Lw(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&Dl(e))return eG(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&Dl(e))return tG(e,t.tickCount,t.allowDecimals)}},Vw=xe([Hw,Xf,Au],Gw),Kw=(e,t,r,n)=>{if(n!=="angleAxis"&&(e==null?void 0:e.type)==="number"&&Dl(t)&&Array.isArray(r)&&r.length>0){var a=t[0],i=r[0],s=t[1],o=r[r.length-1];return[Math.min(a,i),Math.max(s,o)]}return t},FG=xe([wr,Hw,Vw,hr],Kw),MG=xe(sg,wr,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(Cu(e.map(o=>o.value))).sort((o,c)=>o-c);if(n.length<2)return 1/0;var a=n[n.length-1]-n[0];if(a===0)return 1/0;for(var i=0;i<n.length-1;i++){var s=n[i+1]-n[i];r=Math.min(r,s)}return r/a}}),V5=xe(MG,Ot,N5,Qr,(e,t,r,n)=>n,(e,t,r,n,a)=>{if(!zn(e))return 0;var i=t==="vertical"?n.height:n.width;if(a==="gap")return e*i/2;if(a==="no-gap"){var s=Bn(r,e*i),o=e*i/2;return o-s-(o-s)/i*s}return 0}),LG=(e,t)=>{var r=Gs(e,t);return r==null||typeof r.padding!="string"?0:V5(e,"xAxis",t,r.padding)},BG=(e,t)=>{var r=Vs(e,t);return r==null||typeof r.padding!="string"?0:V5(e,"yAxis",t,r.padding)},jG=xe(Gs,LG,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:t,right:t}:{left:((r=a.left)!==null&&r!==void 0?r:0)+t,right:((n=a.right)!==null&&n!==void 0?n:0)+t}}),$G=xe(Vs,BG,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:t,bottom:t}:{top:((r=a.top)!==null&&r!==void 0?r:0)+t,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+t}}),UG=xe([Qr,jG,zp,Up,(e,t,r)=>r],(e,t,r,n,a)=>{var{padding:i}=n;return a?[i.left,r.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),zG=xe([Qr,Ot,$G,zp,Up,(e,t,r)=>r],(e,t,r,n,a,i)=>{var{padding:s}=a;return i?[n.height-s.bottom,s.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),Jf=(e,t,r,n)=>{var a;switch(t){case"xAxis":return UG(e,r,n);case"yAxis":return zG(e,r,n);case"zAxis":return(a=Pw(e,r))===null||a===void 0?void 0:a.range;case"angleAxis":return C5(e);case"radiusAxis":return E5(e,r);default:return}},K5=xe([wr,Jf],eg),Tu=xe([wr,Au,FG,K5],Ww);xe([Yf,og,hr],wG);function q5(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var lg=(e,t)=>t,cg=(e,t,r)=>r,HG=xe(jp,lg,cg,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(q5)),WG=xe($p,lg,cg,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(q5)),X5=(e,t)=>({width:e.width,height:t.height}),GG=(e,t)=>{var r=typeof t.width=="number"?t.width:$f;return{width:r,height:e.height}},Y5=xe(Qr,Gs,X5),VG=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},KG=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},qG=xe(Hs,Qr,HG,lg,cg,(e,t,r,n,a)=>{var i={},s;return r.forEach(o=>{var c=X5(t,o);s==null&&(s=VG(t,n,e));var u=n==="top"&&!a||n==="bottom"&&a;i[o.id]=s-Number(u)*c.height,s+=(u?-1:1)*c.height}),i}),XG=xe(zs,Qr,WG,lg,cg,(e,t,r,n,a)=>{var i={},s;return r.forEach(o=>{var c=GG(t,o);s==null&&(s=KG(t,n,e));var u=n==="left"&&!a||n==="right"&&a;i[o.id]=s-Number(u)*c.width,s+=(u?-1:1)*c.width}),i}),YG=(e,t)=>{var r=Gs(e,t);if(r!=null)return qG(e,r.orientation,r.mirror)},JG=xe([Qr,Gs,YG,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r==null?void 0:r[n];return a==null?{x:e.left,y:0}:{x:e.left,y:a}}}),QG=(e,t)=>{var r=Vs(e,t);if(r!=null)return XG(e,r.orientation,r.mirror)},ZG=xe([Qr,Vs,QG,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r==null?void 0:r[n];return a==null?{x:0,y:e.top}:{x:a,y:e.top}}}),J5=xe(Qr,Vs,(e,t)=>{var r=typeof t.width=="number"?t.width:$f;return{width:r,height:e.height}}),oC=(e,t,r)=>{switch(t){case"xAxis":return Y5(e,r).width;case"yAxis":return J5(e,r).height;default:return}},Q5=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:i,dataKey:s}=r,o=jo(e,n),c=t.map(u=>u.value);if(s&&o&&i==="category"&&a&&V3(c))return c}},qw=xe([Ot,sg,wr,hr],Q5),Z5=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:i}=r,s=jo(e,n);if(s&&(a==="number"||i!=="auto"))return t.map(o=>o.value)}},Xw=xe([Ot,sg,Xf,hr],Z5),lC=xe([Ot,hG,Au,Tu,qw,Xw,Jf,Vw,hr],(e,t,r,n,a,i,s,o,c)=>{if(t==null)return null;var u=jo(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:i,duplicateDomain:a,isCategorical:u,niceTicks:o,range:s,realScaleType:r,scale:n}}),eV=(e,t,r,n,a,i,s,o,c)=>{if(!(t==null||n==null)){var u=jo(e,c),{type:d,ticks:f,tickCount:m}=t,p=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,x=d==="category"&&n.bandwidth?n.bandwidth()/p:0;x=c==="angleAxis"&&i!=null&&i.length>=2?ln(i[0]-i[1])*2*x:x;var g=f||a;if(g){var y=g.map((v,b)=>{var w=s?s.indexOf(v):v;return{index:b,coordinate:n(w)+x,value:v,offset:x}});return y.filter(v=>!di(v.coordinate))}return u&&o?o.map((v,b)=>({coordinate:n(v)+x,value:v,index:b,offset:x})):n.ticks?n.ticks(m).map(v=>({coordinate:n(v)+x,value:v,offset:x})):n.domain().map((v,b)=>({coordinate:n(v)+x,value:s?s[v]:v,index:b,offset:x}))}},eO=xe([Ot,Xf,Au,Tu,Vw,Jf,qw,Xw,hr],eV),tV=(e,t,r,n,a,i,s)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var o=jo(e,s),{tickCount:c}=t,u=0;return u=s==="angleAxis"&&(n==null?void 0:n.length)>=2?ln(n[0]-n[1])*2*u:u,o&&i?i.map((d,f)=>({coordinate:r(d)+u,value:d,index:f,offset:u})):r.ticks?r.ticks(c).map(d=>({coordinate:r(d)+u,value:d,offset:u})):r.domain().map((d,f)=>({coordinate:r(d)+u,value:a?a[d]:d,index:f,offset:u}))}},Eo=xe([Ot,Xf,Tu,Jf,qw,Xw,hr],tV),Ao=xe(wr,Tu,(e,t)=>{if(!(e==null||t==null))return Pm(Pm({},e),{},{scale:t})}),rV=xe([wr,Au,Hw,K5],Ww);xe((e,t,r)=>Pw(e,r),rV,(e,t)=>{if(!(e==null||t==null))return Pm(Pm({},e),{},{scale:t})});var nV=xe([Ot,jp,$p],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),tO=e=>e.options.defaultTooltipEventType,rO=e=>e.options.validateTooltipEventTypes;function nO(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function Yw(e,t){var r=tO(e),n=rO(e);return nO(t,r,n)}function aV(e){return st(t=>Yw(t,e))}var aO=(e,t)=>{var r,n=Number(t);if(!(di(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},iV=e=>e.tooltip.settings,io={active:!1,index:null,dataKey:void 0,coordinate:void 0},sV={itemInteraction:{click:io,hover:io},axisInteraction:{click:io,hover:io},keyboardInteraction:io,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},iO=Ua({name:"tooltip",initialState:sV,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:Yn()},removeTooltipEntrySettings:{reducer(e,t){var r=_s(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},prepare:Yn()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:oV,removeTooltipEntrySettings:lV,setTooltipSettingsState:cV,setActiveMouseOverItemIndex:sO,mouseLeaveItem:uV,mouseLeaveChart:oO,setActiveClickItemIndex:dV,setMouseOverAxisIndex:lO,setMouseClickAxisIndex:fV,setSyncInteraction:Bv,setKeyboardInteraction:jv}=iO.actions,hV=iO.reducer;function cC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function K0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cC(Object(r),!0).forEach(function(n){mV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mV(e,t,r){return(t=pV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pV(e){var t=gV(e,"string");return typeof t=="symbol"?t:t+""}function gV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xV(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function yV(e){return e.index!=null}var cO=(e,t,r,n)=>{if(t==null)return io;var a=xV(e,t,r);if(a==null)return io;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(yV(a)){if(i)return K0(K0({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return K0(K0({},io),{},{coordinate:a.coordinate})},Jw=(e,t)=>{var r=e==null?void 0:e.index;if(r==null)return null;var n=Number(r);if(!zn(n))return r;var a=0,i=1/0;return t.length>0&&(i=t.length-1),String(Math.max(a,Math.min(n,i)))},uO=(e,t,r,n,a,i,s,o)=>{if(!(i==null||o==null)){var c=s[0],u=c==null?void 0:o(c.positions,i);if(u!=null)return u;var d=a==null?void 0:a[Number(i)];if(d)switch(r){case"horizontal":return{x:d.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:d.coordinate}}}},dO=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;return r==="hover"?a=e.itemInteraction.hover.dataKey:a=e.itemInteraction.click.dataKey,a==null&&n!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(i=>{var s;return((s=i.settings)===null||s===void 0?void 0:s.dataKey)===a})},Qf=e=>e.options.tooltipPayloadSearcher,Pu=e=>e.tooltip;function uC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function dC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uC(Object(r),!0).forEach(function(n){vV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vV(e,t,r){return(t=bV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bV(e){var t=wV(e,"string");return typeof t=="symbol"?t:t+""}function wV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function NV(e,t){return e??t}var fO=(e,t,r,n,a,i,s)=>{if(!(t==null||i==null)){var{chartData:o,computedData:c,dataStartIndex:u,dataEndIndex:d}=r,f=[];return e.reduce((m,p)=>{var x,{dataDefinedOnItem:g,settings:y}=p,v=NV(g,o),b=Array.isArray(v)?JP(v,u,d):v,w=(x=y==null?void 0:y.dataKey)!==null&&x!==void 0?x:n,k=y==null?void 0:y.nameKey,S;if(n&&Array.isArray(b)&&!Array.isArray(b[0])&&s==="axis"?S=K3(b,n,a):S=i(b,t,c,k),Array.isArray(S))S.forEach(C=>{var E=dC(dC({},y),{},{name:C.name,unit:C.unit,color:void 0,fill:void 0});m.push(qS({tooltipEntrySettings:E,dataKey:C.dataKey,payload:C.payload,value:Zt(C.payload,C.dataKey),name:C.name}))});else{var _;m.push(qS({tooltipEntrySettings:y,dataKey:w,payload:S,value:Zt(S,w),name:(_=Zt(S,k))!==null&&_!==void 0?_:y==null?void 0:y.name}))}return m},f)}},Qw=xe([tn,Ot,I5,kw,en],G5),kV=xe([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),SV=xe([en,_u],Ow),Zf=xe([kV,tn,SV],Dw,{memoizeOptions:{resultEqualityCheck:ag}}),_V=xe([Zf],e=>e.filter(rg)),CV=xe([Zf],Iw,{memoizeOptions:{resultEqualityCheck:ag}}),Ou=xe([CV,Ho],Rw),EV=xe([_V,Ho,tn],P5),Zw=xe([Ou,tn,Zf],Mw),hO=xe([tn],Lw),AV=xe([tn],e=>e.allowDataOverflow),mO=xe([hO,AV],s5),TV=xe([Zf],e=>e.filter(rg)),PV=xe([EV,TV,Kf],L5),OV=xe([PV,Ho,en,mO],B5),DV=xe([Zf],F5),IV=xe([Ou,tn,DV,og,en],$w,{memoizeOptions:{resultEqualityCheck:ng}}),RV=xe([j5,en,_u],Eu),FV=xe([RV,en],z5),MV=xe([$5,en,_u],Eu),LV=xe([MV,en],H5),BV=xe([U5,en,_u],Eu),jV=xe([BV,en],W5),$V=xe([FV,jV,LV],Om),UV=xe([tn,hO,mO,OV,IV,$V,Ot,en],Uw),pO=xe([tn,Ot,Ou,Zw,Kf,en,UV],zw),zV=xe([pO,tn,Qw],Gw),HV=xe([tn,pO,zV,en],Kw),gO=e=>{var t=en(e),r=_u(e),n=!1;return Jf(e,t,r,n)},xO=xe([tn,gO],eg),yO=xe([tn,Qw,HV,xO],Ww),WV=xe([Ot,Zw,tn,en],Q5),GV=xe([Ot,Zw,tn,en],Z5),VV=(e,t,r,n,a,i,s,o)=>{if(t){var{type:c}=t,u=jo(e,o);if(n){var d=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,f=c==="category"&&n.bandwidth?n.bandwidth()/d:0;return f=o==="angleAxis"&&a!=null&&(a==null?void 0:a.length)>=2?ln(a[0]-a[1])*2*f:f,u&&s?s.map((m,p)=>({coordinate:n(m)+f,value:m,index:p,offset:f})):n.domain().map((m,p)=>({coordinate:n(m)+f,value:i?i[m]:m,index:p,offset:f}))}}},Ks=xe([Ot,tn,Qw,yO,gO,WV,GV,en],VV),e2=xe([tO,rO,iV],(e,t,r)=>nO(r.shared,e,t)),vO=e=>e.tooltip.settings.trigger,t2=e=>e.tooltip.settings.defaultIndex,ug=xe([Pu,e2,vO,t2],cO),To=xe([ug,Ou],Jw),bO=xe([Ks,To],aO),wO=xe([ug],e=>{if(e)return e.dataKey}),NO=xe([Pu,e2,vO,t2],dO),KV=xe([zs,Hs,Ot,Qr,Ks,t2,NO,Qf],uO),qV=xe([ug,KV],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),XV=xe([ug],e=>e.active),YV=xe([NO,To,Ho,T5,bO,Qf,e2],fO),JV=xe([YV],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function fC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function hC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fC(Object(r),!0).forEach(function(n){QV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QV(e,t,r){return(t=ZV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZV(e){var t=eK(e,"string");return typeof t=="symbol"?t:t+""}function eK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tK=()=>st(tn),rK=()=>{var e=tK(),t=st(Ks),r=st(yO);return tf(hC(hC({},e),{},{scale:r}),t)},nK=()=>st(kw),r2=(e,t)=>t,kO=(e,t,r)=>r,n2=(e,t,r,n)=>n,aK=xe(Ks,e=>Ip(e,t=>t.coordinate)),a2=xe([Pu,r2,kO,n2],cO),SO=xe([a2,Ou],Jw),iK=(e,t,r)=>{if(t!=null){var n=Pu(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},_O=xe([Pu,r2,kO,n2],dO),Dm=xe([zs,Hs,Ot,Qr,Ks,n2,_O,Qf],uO),sK=xe([a2,Dm],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),CO=xe(Ks,SO,aO),oK=xe([_O,SO,Ho,T5,CO,Qf,r2],fO),lK=xe([a2],e=>({isActive:e.active,activeIndex:e.index})),cK=(e,t,r,n,a,i,s,o)=>{if(!(!e||!t||!n||!a||!i)){var c=p$(e.chartX,e.chartY,t,r,o);if(c){var u=x$(c,t),d=r$(u,s,i,n,a),f=g$(t,i,d,c);return{activeIndex:String(d),activeCoordinate:f}}}};function $v(){return $v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$v.apply(null,arguments)}function mC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function q0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mC(Object(r),!0).forEach(function(n){uK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uK(e,t,r){return(t=dK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dK(e){var t=fK(e,"string");return typeof t=="symbol"?t:t+""}function fK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hK(e){var{coordinate:t,payload:r,index:n,offset:a,tooltipAxisBandSize:i,layout:s,cursor:o,tooltipEventType:c,chartName:u}=e,d=t,f=r,m=n;if(!o||!d||u!=="ScatterChart"&&c!=="axis")return null;var p,x;if(u==="ScatterChart")p=d,x=TU;else if(u==="BarChart")p=PU(s,d,a,i),x=y6;else if(s==="radial"){var{cx:g,cy:y,radius:v,startAngle:b,endAngle:w}=v6(d);p={cx:g,cy:y,startAngle:b,endAngle:w,innerRadius:v,outerRadius:v},x=w6}else p={points:hz(s,d,a)},x=Yb;var k=typeof o=="object"&&"className"in o?o.className:void 0,S=q0(q0(q0(q0({stroke:"#ccc",pointerEvents:"none"},a),p),Al(o)),{},{payload:f,payloadIndex:m,className:Ft("recharts-tooltip-cursor",k)});return N.isValidElement(o)?N.cloneElement(o,S):N.createElement(x,S)}function mK(e){var t=rK(),r=c6(),n=Wp(),a=nK();return N.createElement(hK,$v({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:n,tooltipAxisBandSize:t,chartName:a}))}var EO=N.createContext(null),pK=()=>N.useContext(EO),AO={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function i(c,u,d,f,m){if(typeof d!="function")throw new TypeError("The listener must be a function");var p=new a(d,f||c,m),x=r?r+u:u;return c._events[x]?c._events[x].fn?c._events[x]=[c._events[x],p]:c._events[x].push(p):(c._events[x]=p,c._eventsCount++),c}function s(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)t.call(d,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},o.prototype.listeners=function(u){var d=r?r+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var m=0,p=f.length,x=new Array(p);m<p;m++)x[m]=f[m].fn;return x},o.prototype.listenerCount=function(u){var d=r?r+u:u,f=this._events[d];return f?f.fn?1:f.length:0},o.prototype.emit=function(u,d,f,m,p,x){var g=r?r+u:u;if(!this._events[g])return!1;var y=this._events[g],v=arguments.length,b,w;if(y.fn){switch(y.once&&this.removeListener(u,y.fn,void 0,!0),v){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,d),!0;case 3:return y.fn.call(y.context,d,f),!0;case 4:return y.fn.call(y.context,d,f,m),!0;case 5:return y.fn.call(y.context,d,f,m,p),!0;case 6:return y.fn.call(y.context,d,f,m,p,x),!0}for(w=1,b=new Array(v-1);w<v;w++)b[w-1]=arguments[w];y.fn.apply(y.context,b)}else{var k=y.length,S;for(w=0;w<k;w++)switch(y[w].once&&this.removeListener(u,y[w].fn,void 0,!0),v){case 1:y[w].fn.call(y[w].context);break;case 2:y[w].fn.call(y[w].context,d);break;case 3:y[w].fn.call(y[w].context,d,f);break;case 4:y[w].fn.call(y[w].context,d,f,m);break;default:if(!b)for(S=1,b=new Array(v-1);S<v;S++)b[S-1]=arguments[S];y[w].fn.apply(y[w].context,b)}}return!0},o.prototype.on=function(u,d,f){return i(this,u,d,f,!1)},o.prototype.once=function(u,d,f){return i(this,u,d,f,!0)},o.prototype.removeListener=function(u,d,f,m){var p=r?r+u:u;if(!this._events[p])return this;if(!d)return s(this,p),this;var x=this._events[p];if(x.fn)x.fn===d&&(!m||x.once)&&(!f||x.context===f)&&s(this,p);else{for(var g=0,y=[],v=x.length;g<v;g++)(x[g].fn!==d||m&&!x[g].once||f&&x[g].context!==f)&&y.push(x[g]);y.length?this._events[p]=y.length===1?y[0]:y:s(this,p)}return this},o.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&s(this,d)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o})(AO);var gK=AO.exports;const xK=$s(gK);var cf=new xK,Uv="recharts.syncEvent.tooltip",pC="recharts.syncEvent.brush";function i2(e,t){if(t){var r=Number.parseInt(t,10);if(!di(r))return e==null?void 0:e[r]}}var yK={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},TO=Ua({name:"options",initialState:yK,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),vK=TO.reducer,{createEventEmitter:bK}=TO.actions;function wK(e){return e.tooltip.syncInteraction}var NK={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},PO=Ua({name:"chartData",initialState:NK,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:gC,setDataStartEndIndexes:kK,setComputedData:r0e}=PO.actions,SK=PO.reducer,_K=["x","y"];function xC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function uc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xC(Object(r),!0).forEach(function(n){CK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CK(e,t,r){return(t=EK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EK(e){var t=AK(e,"string");return typeof t=="symbol"?t:t+""}function AK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function TK(e,t){if(e==null)return{};var r,n,a=PK(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function PK(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var OO=()=>{};function OK(){var e=st(Sw),t=st(_w),r=fr(),n=st(k5),a=st(Ks),i=Wp(),s=Hp(),o=st(c=>c.rootProps.className);N.useEffect(()=>{if(e==null)return OO;var c=(u,d,f)=>{if(t!==f&&e===u){if(n==="index"){var m;if(s&&d!==null&&d!==void 0&&(m=d.payload)!==null&&m!==void 0&&m.coordinate&&d.payload.sourceViewBox){var p=d.payload.coordinate,{x,y:g}=p,y=TK(p,_K),{x:v,y:b,width:w,height:k}=d.payload.sourceViewBox,S=uc(uc({},y),{},{x:s.x+(w?(x-v)/w:0)*s.width,y:s.y+(k?(g-b)/k:0)*s.height});r(uc(uc({},d),{},{payload:uc(uc({},d.payload),{},{coordinate:S})}))}else r(d);return}if(a!=null){var _;if(typeof n=="function"){var C={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},E=n(a,C);_=a[E]}else n==="value"&&(_=a.find(L=>String(L.value)===d.payload.label));var{coordinate:A}=d.payload;if(_==null||d.payload.active===!1||A==null||s==null){r(Bv({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0}));return}var{x:T,y:D}=A,I=Math.min(T,s.x+s.width),z=Math.min(D,s.y+s.height),X={x:i==="horizontal"?_.coordinate:I,y:i==="horizontal"?z:_.coordinate},H=Bv({active:d.payload.active,coordinate:X,dataKey:d.payload.dataKey,index:String(_.index),label:d.payload.label,sourceViewBox:d.payload.sourceViewBox});r(H)}}};return cf.on(Uv,c),()=>{cf.off(Uv,c)}},[o,r,t,e,n,a,i,s])}function DK(){var e=st(Sw),t=st(_w),r=fr();N.useEffect(()=>{if(e==null)return OO;var n=(a,i,s)=>{t!==s&&e===a&&r(kK(i))};return cf.on(pC,n),()=>{cf.off(pC,n)}},[r,t,e])}function IK(){var e=fr();N.useEffect(()=>{e(bK())},[e]),OK(),DK()}function RK(e,t,r,n,a,i){var s=st(p=>iK(p,e,t)),o=st(_w),c=st(Sw),u=st(k5),d=st(wK),f=d==null?void 0:d.active,m=Hp();N.useEffect(()=>{if(!f&&c!=null&&o!=null){var p=Bv({active:i,coordinate:r,dataKey:s,index:a,label:typeof n=="number"?String(n):n,sourceViewBox:m});cf.emit(Uv,c,p,o)}},[f,r,s,a,n,o,c,u,i,m])}function yC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function vC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yC(Object(r),!0).forEach(function(n){FK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function FK(e,t,r){return(t=MK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MK(e){var t=LK(e,"string");return typeof t=="symbol"?t:t+""}function LK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BK(e){return e.dataKey}function jK(e,t){return N.isValidElement(e)?N.cloneElement(e,t):typeof e=="function"?N.createElement(e,t):N.createElement(oU,t)}var bC=[],$K={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!$o.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function rr(e){var t=kn(e,$K),{active:r,allowEscapeViewBox:n,animationDuration:a,animationEasing:i,content:s,filterNull:o,isAnimationActive:c,offset:u,payloadUniqBy:d,position:f,reverseDirection:m,useTranslate3d:p,wrapperStyle:x,cursor:g,shared:y,trigger:v,defaultIndex:b,portal:w,axisId:k}=t,S=fr(),_=typeof b=="number"?String(b):b;N.useEffect(()=>{S(cV({shared:y,trigger:v,axisId:k,active:r,defaultIndex:_}))},[S,y,v,k,r,_]);var C=Hp(),E=h6(),A=aV(y),{activeIndex:T,isActive:D}=st(P=>lK(P,A,v,_)),I=st(P=>oK(P,A,v,_)),z=st(P=>CO(P,A,v,_)),X=st(P=>sK(P,A,v,_)),H=I,L=pK(),W=r??D,[ie,B]=kP([H,W]),ee=A==="axis"?z:void 0;RK(A,v,X,ee,T,W);var le=w??L;if(le==null)return null;var R=H??bC;W||(R=bC),o&&R.length&&(R=dP(H.filter(P=>P.value!=null&&(P.hide!==!0||t.includeHidden)),d,BK));var j=R.length>0,V=N.createElement(mU,{allowEscapeViewBox:n,animationDuration:a,animationEasing:i,isAnimationActive:c,active:W,coordinate:X,hasPayload:j,offset:u,position:f,reverseDirection:m,useTranslate3d:p,viewBox:C,wrapperStyle:x,lastBoundingBox:ie,innerRef:B,hasPortalFromProps:!!w},jK(s,vC(vC({},t),{},{payload:R,label:ee,active:W,coordinate:X,accessibilityLayer:E})));return N.createElement(N.Fragment,null,ib.createPortal(V,le),W&&N.createElement(mK,{cursor:g,tooltipEventType:A,coordinate:X,payload:H,index:T}))}var Gi=e=>null;Gi.displayName="Cell";function UK(e,t,r){return(t=zK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zK(e){var t=HK(e,"string");return typeof t=="symbol"?t:t+""}function HK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class WK{constructor(t){UK(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function wC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function GK(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wC(Object(r),!0).forEach(function(n){VK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VK(e,t,r){return(t=KK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KK(e){var t=qK(e,"string");return typeof t=="symbol"?t:t+""}function qK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XK={cacheSize:2e3,enableCache:!0},DO=GK({},XK),NC=new WK(DO.cacheSize),YK={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},kC="recharts_measurement_span";function JK(e,t){var r=t.fontSize||"",n=t.fontFamily||"",a=t.fontWeight||"",i=t.fontStyle||"",s=t.letterSpacing||"",o=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(i,"|").concat(s,"|").concat(o)}var SC=(e,t)=>{try{var r=document.getElementById(kC);r||(r=document.createElement("span"),r.setAttribute("id",kC),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,YK,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Sd=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||$o.isSsr)return{width:0,height:0};if(!DO.enableCache)return SC(t,r);var n=JK(t,r),a=NC.get(n);if(a)return a;var i=SC(t,r);return NC.set(n,i),i},_C=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,CC=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,QK=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,ZK=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,IO={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},eq=Object.keys(IO),Pc="NaN";function tq(e,t){return e*IO[t]}class ia{static parse(t){var r,[,n,a]=(r=ZK.exec(t))!==null&&r!==void 0?r:[];return new ia(parseFloat(n),a??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,di(t)&&(this.unit=""),r!==""&&!QK.test(r)&&(this.num=NaN,this.unit=""),eq.includes(r)&&(this.num=tq(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new ia(NaN,""):new ia(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new ia(NaN,""):new ia(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new ia(NaN,""):new ia(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new ia(NaN,""):new ia(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return di(this.num)}}function RO(e){if(e.includes(Pc))return Pc;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,a,i]=(r=_C.exec(t))!==null&&r!==void 0?r:[],s=ia.parse(n??""),o=ia.parse(i??""),c=a==="*"?s.multiply(o):s.divide(o);if(c.isNaN())return Pc;t=t.replace(_C,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var u,[,d,f,m]=(u=CC.exec(t))!==null&&u!==void 0?u:[],p=ia.parse(d??""),x=ia.parse(m??""),g=f==="+"?p.add(x):p.subtract(x);if(g.isNaN())return Pc;t=t.replace(CC,g.toString())}return t}var EC=/\(([^()]*)\)/;function rq(e){for(var t=e,r;(r=EC.exec(t))!=null;){var[,n]=r;t=t.replace(EC,RO(n))}return t}function nq(e){var t=e.replace(/\s+/g,"");return t=rq(t),t=RO(t),t}function aq(e){try{return nq(e)}catch{return Pc}}function Ix(e){var t=aq(e.slice(5,-1));return t===Pc?"":t}var iq=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],sq=["dx","dy","angle","className","breakAll"];function zv(){return zv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zv.apply(null,arguments)}function AC(e,t){if(e==null)return{};var r,n,a=oq(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function oq(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var FO=/[ \f\n\r\t\v\u2028\u2029]+/,MO=e=>{var{children:t,breakAll:r,style:n}=e;try{var a=[];dr(t)||(r?a=t.toString().split(""):a=t.toString().split(FO));var i=a.map(o=>({word:o,width:Sd(o,n).width})),s=r?0:Sd("Â ",n).width;return{wordsWithComputedWidth:i,spaceWidth:s}}catch{return null}},lq=(e,t,r,n,a)=>{var{maxLines:i,children:s,style:o,breakAll:c}=e,u=lt(i),d=s,f=function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return D.reduce((I,z)=>{var{word:X,width:H}=z,L=I[I.length-1];if(L&&(n==null||a||L.width+H+r<Number(n)))L.words.push(X),L.width+=H+r;else{var W={words:[X],width:H};I.push(W)}return I},[])},m=f(t),p=T=>T.reduce((D,I)=>D.width>I.width?D:I);if(!u||a)return m;var x=m.length>i||p(m).width>Number(n);if(!x)return m;for(var g="â€¦",y=T=>{var D=d.slice(0,T),I=MO({breakAll:c,style:o,children:D+g}).wordsWithComputedWidth,z=f(I),X=z.length>i||p(z).width>Number(n);return[X,z]},v=0,b=d.length-1,w=0,k;v<=b&&w<=d.length-1;){var S=Math.floor((v+b)/2),_=S-1,[C,E]=y(_),[A]=y(S);if(!C&&!A&&(v=S+1),C&&A&&(b=S-1),!C&&A){k=E;break}w++}return k||m},TC=e=>{var t=dr(e)?[]:e.toString().split(FO);return[{words:t}]},cq=e=>{var{width:t,scaleToFit:r,children:n,style:a,breakAll:i,maxLines:s}=e;if((t||r)&&!$o.isSsr){var o,c,u=MO({breakAll:i,children:n,style:a});if(u){var{wordsWithComputedWidth:d,spaceWidth:f}=u;o=d,c=f}else return TC(n);return lq({breakAll:i,children:n,maxLines:s,style:a},o,c,t,r)}return TC(n)},PC="#808080",dg=N.forwardRef((e,t)=>{var{x:r=0,y:n=0,lineHeight:a="1em",capHeight:i="0.71em",scaleToFit:s=!1,textAnchor:o="start",verticalAnchor:c="end",fill:u=PC}=e,d=AC(e,iq),f=N.useMemo(()=>cq({breakAll:d.breakAll,children:d.children,maxLines:d.maxLines,scaleToFit:s,style:d.style,width:d.width}),[d.breakAll,d.children,d.maxLines,s,d.style,d.width]),{dx:m,dy:p,angle:x,className:g,breakAll:y}=d,v=AC(d,sq);if(!ns(r)||!ns(n)||f.length===0)return null;var b=r+(lt(m)?m:0),w=n+(lt(p)?p:0),k;switch(c){case"start":k=Ix("calc(".concat(i,")"));break;case"middle":k=Ix("calc(".concat((f.length-1)/2," * -").concat(a," + (").concat(i," / 2))"));break;default:k=Ix("calc(".concat(f.length-1," * -").concat(a,")"));break}var S=[];if(s){var _=f[0].width,{width:C}=d;S.push("scale(".concat(lt(C)?C/_:1,")"))}return x&&S.push("rotate(".concat(x,", ").concat(b,", ").concat(w,")")),S.length&&(v.transform=S.join(" ")),N.createElement("text",zv({},ea(v),{ref:t,x:b,y:w,className:Ft("recharts-text",g),textAnchor:o,fill:u.includes("url")?PC:u}),f.map((E,A)=>{var T=E.words.join(y?"":" ");return N.createElement("tspan",{x:b,dy:A===0?k:a,key:"".concat(T,"-").concat(A)},T)}))});dg.displayName="Text";var uq=["labelRef"];function dq(e,t){if(e==null)return{};var r,n,a=fq(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function fq(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function OC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Pr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?OC(Object(r),!0).forEach(function(n){hq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):OC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hq(e,t,r){return(t=mq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mq(e){var t=pq(e,"string");return typeof t=="symbol"?t:t+""}function pq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ps(){return ps=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ps.apply(null,arguments)}var LO=N.createContext(null),gq=e=>{var{x:t,y:r,width:n,height:a,children:i}=e,s=N.useMemo(()=>({x:t,y:r,width:n,height:a}),[t,r,n,a]);return N.createElement(LO.Provider,{value:s},i)},BO=()=>{var e=N.useContext(LO),t=Hp();return e||t},xq=N.createContext(null),yq=()=>{var e=N.useContext(xq),t=st(A5);return e||t},vq=e=>{var{value:t,formatter:r}=e,n=dr(e.children)?t:e.children;return typeof r=="function"?r(n):n},s2=e=>e!=null&&typeof e=="function",bq=(e,t)=>{var r=ln(t-e),n=Math.min(Math.abs(t-e),360);return r*n},wq=(e,t,r,n,a)=>{var{offset:i,className:s}=e,{cx:o,cy:c,innerRadius:u,outerRadius:d,startAngle:f,endAngle:m,clockWise:p}=a,x=(u+d)/2,g=bq(f,m),y=g>=0?1:-1,v,b;switch(t){case"insideStart":v=f+y*i,b=p;break;case"insideEnd":v=m-y*i,b=!p;break;case"end":v=m+y*i,b=p;break;default:throw new Error("Unsupported position ".concat(t))}b=g<=0?b:!b;var w=Ur(o,c,x,v),k=Ur(o,c,x,v+(b?1:-1)*359),S="M".concat(w.x,",").concat(w.y,`
    A`).concat(x,",").concat(x,",0,1,").concat(b?0:1,`,
    `).concat(k.x,",").concat(k.y),_=dr(e.id)?Qd("recharts-radial-line-"):e.id;return N.createElement("text",ps({},n,{dominantBaseline:"central",className:Ft("recharts-radial-bar-label",s)}),N.createElement("defs",null,N.createElement("path",{id:_,d:S})),N.createElement("textPath",{xlinkHref:"#".concat(_)},r))},Nq=(e,t,r)=>{var{cx:n,cy:a,innerRadius:i,outerRadius:s,startAngle:o,endAngle:c}=e,u=(o+c)/2;if(r==="outside"){var{x:d,y:f}=Ur(n,a,s+t,u);return{x:d,y:f,textAnchor:d>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"end"};var m=(i+s)/2,{x:p,y:x}=Ur(n,a,m,u);return{x:p,y:x,textAnchor:"middle",verticalAnchor:"middle"}},jO=e=>"cx"in e&&lt(e.cx),kq=(e,t)=>{var{parentViewBox:r,offset:n,position:a}=e,i;r!=null&&!jO(r)&&(i=r);var{x:s,y:o,width:c,height:u}=t,d=u>=0?1:-1,f=d*n,m=d>0?"end":"start",p=d>0?"start":"end",x=c>=0?1:-1,g=x*n,y=x>0?"end":"start",v=x>0?"start":"end";if(a==="top"){var b={x:s+c/2,y:o-d*n,textAnchor:"middle",verticalAnchor:m};return Pr(Pr({},b),i?{height:Math.max(o-i.y,0),width:c}:{})}if(a==="bottom"){var w={x:s+c/2,y:o+u+f,textAnchor:"middle",verticalAnchor:p};return Pr(Pr({},w),i?{height:Math.max(i.y+i.height-(o+u),0),width:c}:{})}if(a==="left"){var k={x:s-g,y:o+u/2,textAnchor:y,verticalAnchor:"middle"};return Pr(Pr({},k),i?{width:Math.max(k.x-i.x,0),height:u}:{})}if(a==="right"){var S={x:s+c+g,y:o+u/2,textAnchor:v,verticalAnchor:"middle"};return Pr(Pr({},S),i?{width:Math.max(i.x+i.width-S.x,0),height:u}:{})}var _=i?{width:c,height:u}:{};return a==="insideLeft"?Pr({x:s+g,y:o+u/2,textAnchor:v,verticalAnchor:"middle"},_):a==="insideRight"?Pr({x:s+c-g,y:o+u/2,textAnchor:y,verticalAnchor:"middle"},_):a==="insideTop"?Pr({x:s+c/2,y:o+f,textAnchor:"middle",verticalAnchor:p},_):a==="insideBottom"?Pr({x:s+c/2,y:o+u-f,textAnchor:"middle",verticalAnchor:m},_):a==="insideTopLeft"?Pr({x:s+g,y:o+f,textAnchor:v,verticalAnchor:p},_):a==="insideTopRight"?Pr({x:s+c-g,y:o+f,textAnchor:y,verticalAnchor:p},_):a==="insideBottomLeft"?Pr({x:s+g,y:o+u-f,textAnchor:v,verticalAnchor:m},_):a==="insideBottomRight"?Pr({x:s+c-g,y:o+u-f,textAnchor:y,verticalAnchor:m},_):a&&typeof a=="object"&&(lt(a.x)||Fs(a.x))&&(lt(a.y)||Fs(a.y))?Pr({x:s+Bn(a.x,c),y:o+Bn(a.y,u),textAnchor:"end",verticalAnchor:"end"},_):Pr({x:s+c/2,y:o+u/2,textAnchor:"middle",verticalAnchor:"middle"},_)},Sq={offset:5};function ro(e){var t=kn(e,Sq),{viewBox:r,position:n,value:a,children:i,content:s,className:o="",textBreakAll:c,labelRef:u}=t,d=yq(),f=BO(),m=n==="center"?f:d??f,p=r||m;if(!p||dr(a)&&dr(i)&&!N.isValidElement(s)&&typeof s!="function")return null;var x=Pr(Pr({},t),{},{viewBox:p});if(N.isValidElement(s)){var g=dq(x,uq);return N.cloneElement(s,g)}var y;if(typeof s=="function"){if(y=N.createElement(s,x),N.isValidElement(y))return y}else y=vq(t);var v=jO(p),b=ea(t);if(v&&(n==="insideStart"||n==="insideEnd"||n==="end"))return wq(t,n,y,b,p);var w=v?Nq(p,t.offset,t.position):kq(t,p);return N.createElement(dg,ps({ref:u,className:Ft("recharts-label",o)},b,w,{breakAll:c}),y)}ro.displayName="Label";var _q=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?N.createElement(ro,ps({key:"label-implicit"},n)):ns(e)?N.createElement(ro,ps({key:"label-implicit",value:e},n)):N.isValidElement(e)?e.type===ro?N.cloneElement(e,Pr({key:"label-implicit"},n)):N.createElement(ro,ps({key:"label-implicit",content:e},n)):s2(e)?N.createElement(ro,ps({key:"label-implicit",content:e},n)):e&&typeof e=="object"?N.createElement(ro,ps({},e,{key:"label-implicit"},n)):null};function Cq(e){var{label:t,labelRef:r}=e,n=BO();return _q(t,n,r)||null}var $O={},UO={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(UO);var zO={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(zO);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=UO,r=zO,n=Op;function a(i){if(n.isArrayLike(i))return t.last(r.toArray(i))}e.last=a})($O);var Eq=$O.last;const Aq=$s(Eq);var Tq=["valueAccessor"],Pq=["dataKey","clockWise","id","textBreakAll"];function Im(){return Im=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Im.apply(null,arguments)}function DC(e,t){if(e==null)return{};var r,n,a=Oq(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Oq(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Dq=e=>Array.isArray(e.value)?Aq(e.value):e.value,HO=N.createContext(void 0),WO=HO.Provider,GO=N.createContext(void 0),Iq=GO.Provider;function Rq(){return N.useContext(HO)}function Fq(){return N.useContext(GO)}function _h(e){var{valueAccessor:t=Dq}=e,r=DC(e,Tq),{dataKey:n,clockWise:a,id:i,textBreakAll:s}=r,o=DC(r,Pq),c=Rq(),u=Fq(),d=c||u;return!d||!d.length?null:N.createElement(Nn,{className:"recharts-label-list"},d.map((f,m)=>{var p,x=dr(n)?t(f,m):Zt(f&&f.payload,n),g=dr(i)?{}:{id:"".concat(i,"-").concat(m)};return N.createElement(ro,Im({key:"label-".concat(m)},ea(f),o,g,{fill:(p=r.fill)!==null&&p!==void 0?p:f.fill,parentViewBox:f.parentViewBox,value:x,textBreakAll:s,viewBox:f.viewBox,index:m}))}))}_h.displayName="LabelList";function o2(e){var{label:t}=e;return t?t===!0?N.createElement(_h,{key:"labelList-implicit"}):N.isValidElement(t)||s2(t)?N.createElement(_h,{key:"labelList-implicit",content:t}):typeof t=="object"?N.createElement(_h,Im({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function Hv(){return Hv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Hv.apply(null,arguments)}var VO=e=>{var{cx:t,cy:r,r:n,className:a}=e,i=Ft("recharts-dot",a);return t===+t&&r===+r&&n===+n?N.createElement("circle",Hv({},Fa(e),_b(e),{className:i,cx:t,cy:r,r:n})):null},KO=e=>e.graphicalItems.polarItems,Mq=xe([hr,qf],Ow),fg=xe([KO,wr,Mq],Dw),Lq=xe([fg],Iw),hg=xe([Lq,bw],Rw),Bq=xe([hg,wr,fg],Mw);xe([hg,wr,fg],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(a=>{var i,s=Zt(n,(i=t.dataKey)!==null&&i!==void 0?i:a.dataKey);return{value:s,errorDomain:[]}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:Zt(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]})));var IC=()=>{},jq=xe([hg,wr,fg,og,hr],$w),$q=xe([wr,Bw,jw,IC,jq,IC,Ot,hr],Uw),qO=xe([wr,Ot,hg,Bq,Kf,hr,$q],zw),Uq=xe([qO,wr,Au],Gw);xe([wr,qO,Uq,hr],Kw);var zq={radiusAxis:{},angleAxis:{}},XO=Ua({name:"polarAxis",initialState:zq,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}});XO.actions;var Hq=XO.reducer;function RC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function FC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?RC(Object(r),!0).forEach(function(n){Wq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Wq(e,t,r){return(t=Gq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gq(e){var t=Vq(e,"string");return typeof t=="symbol"?t:t+""}function Vq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Kq=(e,t)=>t,l2=xe([KO,Kq],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),qq=[],c2=(e,t,r)=>(r==null?void 0:r.length)===0?qq:r,YO=xe([bw,l2,c2],(e,t,r)=>{var{chartData:n}=e;if(t!=null){var a;if((t==null?void 0:t.data)!=null&&t.data.length>0?a=t.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(i=>FC(FC({},t.presentationProps),i.props))),a!=null)return a}}),Xq=xe([YO,l2,c2],(e,t,r)=>{if(!(e==null||t==null))return e.map((n,a)=>{var i,s=Zt(n,t.nameKey,t.name),o;return r!=null&&(i=r[a])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?o=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?o=n.fill:o=t.fill,{value:wu(s,t.dataKey),color:o,payload:n,type:t.legendType}})}),Yq=xe([YO,l2,c2,Qr],(e,t,r,n)=>{if(!(t==null||e==null))return qX({offset:n,pieSettings:t,displayedData:e,cells:r})}),JO={exports:{}},Xt={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u2=Symbol.for("react.transitional.element"),d2=Symbol.for("react.portal"),mg=Symbol.for("react.fragment"),pg=Symbol.for("react.strict_mode"),gg=Symbol.for("react.profiler"),xg=Symbol.for("react.consumer"),yg=Symbol.for("react.context"),vg=Symbol.for("react.forward_ref"),bg=Symbol.for("react.suspense"),wg=Symbol.for("react.suspense_list"),Ng=Symbol.for("react.memo"),kg=Symbol.for("react.lazy"),Jq=Symbol.for("react.view_transition"),Qq=Symbol.for("react.client.reference");function pi(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case u2:switch(e=e.type,e){case mg:case gg:case pg:case bg:case wg:case Jq:return e;default:switch(e=e&&e.$$typeof,e){case yg:case vg:case kg:case Ng:return e;case xg:return e;default:return t}}case d2:return t}}}Xt.ContextConsumer=xg;Xt.ContextProvider=yg;Xt.Element=u2;Xt.ForwardRef=vg;Xt.Fragment=mg;Xt.Lazy=kg;Xt.Memo=Ng;Xt.Portal=d2;Xt.Profiler=gg;Xt.StrictMode=pg;Xt.Suspense=bg;Xt.SuspenseList=wg;Xt.isContextConsumer=function(e){return pi(e)===xg};Xt.isContextProvider=function(e){return pi(e)===yg};Xt.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===u2};Xt.isForwardRef=function(e){return pi(e)===vg};Xt.isFragment=function(e){return pi(e)===mg};Xt.isLazy=function(e){return pi(e)===kg};Xt.isMemo=function(e){return pi(e)===Ng};Xt.isPortal=function(e){return pi(e)===d2};Xt.isProfiler=function(e){return pi(e)===gg};Xt.isStrictMode=function(e){return pi(e)===pg};Xt.isSuspense=function(e){return pi(e)===bg};Xt.isSuspenseList=function(e){return pi(e)===wg};Xt.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===mg||e===gg||e===pg||e===bg||e===wg||typeof e=="object"&&e!==null&&(e.$$typeof===kg||e.$$typeof===Ng||e.$$typeof===yg||e.$$typeof===xg||e.$$typeof===vg||e.$$typeof===Qq||e.getModuleId!==void 0)};Xt.typeOf=pi;JO.exports=Xt;var Zq=JO.exports,MC=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",LC=null,Rx=null,QO=e=>{if(e===LC&&Array.isArray(Rx))return Rx;var t=[];return N.Children.forEach(e,r=>{dr(r)||(Zq.isFragment(r)?t=t.concat(QO(r.props.children)):t.push(r))}),Rx=t,LC=e,t};function f2(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(a=>MC(a)):n=[MC(t)],QO(e).forEach(a=>{var i=Tl(a,"type.displayName")||Tl(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}var ZO=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,eD={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var a;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const i=r[Symbol.toStringTag];return i==null||!((a=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&a.writable)?!1:r.toString()===`[object ${i}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t})(eD);var eX=eD.isPlainObject;const tX=$s(eX);function BC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function jC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BC(Object(r),!0).forEach(function(n){rX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rX(e,t,r){return(t=nX(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nX(e){var t=aX(e,"string");return typeof t=="symbol"?t:t+""}function aX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rm(){return Rm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rm.apply(null,arguments)}var $C=(e,t,r,n,a)=>{var i=r-n,s;return s="M ".concat(e,",").concat(t),s+="L ".concat(e+r,",").concat(t),s+="L ".concat(e+r-i/2,",").concat(t+a),s+="L ".concat(e+r-i/2-n,",").concat(t+a),s+="L ".concat(e,",").concat(t," Z"),s},iX={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},sX=e=>{var t=kn(e,iX),{x:r,y:n,upperWidth:a,lowerWidth:i,height:s,className:o}=t,{animationEasing:c,animationDuration:u,animationBegin:d,isUpdateAnimationActive:f}=t,m=N.useRef(null),[p,x]=N.useState(-1),g=N.useRef(a),y=N.useRef(i),v=N.useRef(s),b=N.useRef(r),w=N.useRef(n),k=zf(e,"trapezoid-");if(N.useEffect(()=>{if(m.current&&m.current.getTotalLength)try{var X=m.current.getTotalLength();X&&x(X)}catch{}},[]),r!==+r||n!==+n||a!==+a||i!==+i||s!==+s||a===0&&i===0||s===0)return null;var S=Ft("recharts-trapezoid",o);if(!f)return N.createElement("g",null,N.createElement("path",Rm({},ea(t),{className:S,d:$C(r,n,a,i,s)})));var _=g.current,C=y.current,E=v.current,A=b.current,T=w.current,D="0px ".concat(p===-1?1:p,"px"),I="".concat(p,"px 0px"),z=m6(["strokeDasharray"],u,c);return N.createElement(Uf,{animationId:k,key:k,canBegin:p>0,duration:u,easing:c,isActive:f,begin:d},X=>{var H=_r(_,a,X),L=_r(C,i,X),W=_r(E,s,X),ie=_r(A,r,X),B=_r(T,n,X);m.current&&(g.current=H,y.current=L,v.current=W,b.current=ie,w.current=B);var ee=X>0?{transition:z,strokeDasharray:I}:{strokeDasharray:D};return N.createElement("path",Rm({},ea(t),{className:S,d:$C(ie,B,H,L,W),ref:m,style:jC(jC({},ee),t.style)}))})},oX=["option","shapeType","propTransformer","activeClassName","isActive"];function lX(e,t){if(e==null)return{};var r,n,a=cX(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function cX(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function UC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Fm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?UC(Object(r),!0).forEach(function(n){uX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):UC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uX(e,t,r){return(t=dX(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dX(e){var t=fX(e,"string");return typeof t=="symbol"?t:t+""}function fX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hX(e,t){return Fm(Fm({},t),e)}function mX(e,t){return e==="symbols"}function zC(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return N.createElement(y6,r);case"trapezoid":return N.createElement(sX,r);case"sector":return N.createElement(w6,r);case"symbols":if(mX(t))return N.createElement(Sb,r);break;default:return null}}function pX(e){return N.isValidElement(e)?e.props:e}function tD(e){var{option:t,shapeType:r,propTransformer:n=hX,activeClassName:a="recharts-active-shape",isActive:i}=e,s=lX(e,oX),o;if(N.isValidElement(t))o=N.cloneElement(t,Fm(Fm({},s),pX(t)));else if(typeof t=="function")o=t(s);else if(tX(t)&&typeof t!="boolean"){var c=n(t,s);o=N.createElement(zC,{shapeType:r,elementProps:c})}else{var u=s;o=N.createElement(zC,{shapeType:r,elementProps:u})}return i?N.createElement(Nn,{className:a},o):o}var h2=(e,t)=>{var r=fr();return(n,a)=>i=>{e==null||e(n,a,i),r(sO({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}},m2=e=>{var t=fr();return(r,n)=>a=>{e==null||e(r,n,a),t(uV())}},p2=(e,t)=>{var r=fr();return(n,a)=>i=>{e==null||e(n,a,i),r(dV({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}};function g2(e){var{fn:t,args:r}=e,n=fr(),a=aa();return N.useLayoutEffect(()=>{if(!a){var i=t(r);return n(oV(i)),()=>{n(lV(i))}}},[t,r,n,a]),null}var rD=()=>{};function nD(e){var{legendPayload:t}=e,r=fr(),n=aa();return N.useLayoutEffect(()=>n?rD:(r(d6(t)),()=>{r(f6(t))}),[r,n,t]),null}function gX(e){var{legendPayload:t}=e,r=fr(),n=st(Ot);return N.useLayoutEffect(()=>n!=="centric"&&n!=="radial"?rD:(r(d6(t)),()=>{r(f6(t))}),[r,n,t]),null}var Fx,xX=()=>{var[e]=N.useState(()=>Qd("uid-"));return e},yX=(Fx=wF["useId".toString()])!==null&&Fx!==void 0?Fx:xX;function vX(e,t){var r=yX();return t||(e?"".concat(e,"-").concat(r):r)}var bX=N.createContext(void 0),x2=e=>{var{id:t,type:r,children:n}=e,a=vX("recharts-".concat(r),t);return N.createElement(bX.Provider,{value:a},n(a))},wX={cartesianItems:[],polarItems:[]},aD=Ua({name:"graphicalItems",initialState:wX,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:Yn()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:r,next:n}=t.payload,a=_s(e).cartesianItems.indexOf(r);a>-1&&(e.cartesianItems[a]=n)},prepare:Yn()},removeCartesianGraphicalItem:{reducer(e,t){var r=_s(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},prepare:Yn()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:Yn()},removePolarGraphicalItem:{reducer(e,t){var r=_s(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)},prepare:Yn()}}}),{addCartesianGraphicalItem:NX,replaceCartesianGraphicalItem:kX,removeCartesianGraphicalItem:SX,addPolarGraphicalItem:_X,removePolarGraphicalItem:CX}=aD.actions,EX=aD.reducer;function iD(e){var t=fr(),r=N.useRef(null);return N.useLayoutEffect(()=>{r.current===null?t(NX(e)):r.current!==e&&t(kX({prev:r.current,next:e})),r.current=e},[t,e]),N.useLayoutEffect(()=>()=>{r.current&&(t(SX(r.current)),r.current=null)},[t]),null}function AX(e){var t=fr();return N.useLayoutEffect(()=>(t(_X(e)),()=>{t(CX(e))}),[t,e]),null}var TX=["onMouseEnter","onClick","onMouseLeave"],PX=["id"],OX=["id"];function y2(e,t){if(e==null)return{};var r,n,a=DX(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function DX(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function HC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function lr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HC(Object(r),!0).forEach(function(n){IX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IX(e,t,r){return(t=RX(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RX(e){var t=FX(e,"string");return typeof t=="symbol"?t:t+""}function FX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Po(){return Po=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Po.apply(null,arguments)}function MX(e){var t=N.useMemo(()=>f2(e.children,Gi),[e.children]),r=st(n=>Xq(n,e.id,t));return r==null?null:N.createElement(gX,{legendPayload:r})}function LX(e){var{dataKey:t,nameKey:r,sectors:n,stroke:a,strokeWidth:i,fill:s,name:o,hide:c,tooltipType:u}=e;return{dataDefinedOnItem:n.map(d=>d.tooltipPayload),positions:n.map(d=>d.tooltipPosition),settings:{stroke:a,strokeWidth:i,fill:s,dataKey:t,nameKey:r,name:wu(o,t),hide:c,type:u,color:s,unit:""}}}var BX=(e,t)=>e>t?"start":e<t?"end":"middle",jX=(e,t,r)=>Bn(typeof t=="function"?t(e):t,r,r*.8),$X=(e,t,r)=>{var{top:n,left:a,width:i,height:s}=t,o=YP(i,s),c=a+Bn(e.cx,i,i/2),u=n+Bn(e.cy,s,s/2),d=Bn(e.innerRadius,o,0),f=jX(r,e.outerRadius,o),m=e.maxRadius||Math.sqrt(i*i+s*s)/2;return{cx:c,cy:u,innerRadius:d,outerRadius:f,maxRadius:m}},UX=(e,t)=>{var r=ln(t-e),n=Math.min(Math.abs(t-e),360);return r*n};function zX(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var HX=(e,t)=>{if(N.isValidElement(e))return N.cloneElement(e,t);if(typeof e=="function")return e(t);var r=Ft("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return N.createElement(Yb,Po({},t,{type:"linear",className:r}))},WX=(e,t,r)=>{if(N.isValidElement(e))return N.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),N.isValidElement(n)))return n;var a=Ft("recharts-pie-label-text",zX(e));return N.createElement(dg,Po({},t,{alignmentBaseline:"middle",className:a}),n)};function GX(e){var{sectors:t,props:r,showLabels:n}=e,{label:a,labelLine:i,dataKey:s}=r;if(!n||!a||!t)return null;var o=Fa(r),c=Al(a),u=Al(i),d=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,f=t.map((m,p)=>{var x=(m.startAngle+m.endAngle)/2,g=Ur(m.cx,m.cy,m.outerRadius+d,x),y=lr(lr(lr(lr({},o),m),{},{stroke:"none"},c),{},{index:p,textAnchor:BX(g.x,m.cx)},g),v=lr(lr(lr(lr({},o),m),{},{fill:"none",stroke:m.fill},u),{},{index:p,points:[Ur(m.cx,m.cy,m.outerRadius,x),g],key:"line"});return N.createElement(Nn,{key:"label-".concat(m.startAngle,"-").concat(m.endAngle,"-").concat(m.midAngle,"-").concat(p)},i&&HX(i,v),WX(a,y,Zt(m,s)))});return N.createElement(Nn,{className:"recharts-pie-labels"},f)}function VX(e){var{sectors:t,props:r,showLabels:n}=e,{label:a}=r;return typeof a=="object"&&a!=null&&"position"in a?N.createElement(o2,{label:a}):N.createElement(GX,{sectors:t,props:r,showLabels:n})}function KX(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:a}=e,i=st(To),{onMouseEnter:s,onClick:o,onMouseLeave:c}=a,u=y2(a,TX),d=h2(s,a.dataKey),f=m2(c),m=p2(o,a.dataKey);return t==null||t.length===0?null:N.createElement(N.Fragment,null,t.map((p,x)=>{if((p==null?void 0:p.startAngle)===0&&(p==null?void 0:p.endAngle)===0&&t.length!==1)return null;var g=r&&String(x)===i,y=i?n:null,v=g?r:y,b=lr(lr({},p),{},{stroke:p.stroke,tabIndex:-1,[t6]:x,[r6]:a.dataKey});return N.createElement(Nn,Po({key:"sector-".concat(p==null?void 0:p.startAngle,"-").concat(p==null?void 0:p.endAngle,"-").concat(p.midAngle,"-").concat(x),tabIndex:-1,className:"recharts-pie-sector"},Lf(u,p,x),{onMouseEnter:d(p,x),onMouseLeave:f(p,x),onClick:m(p,x)}),N.createElement(tD,Po({option:v,isActive:g,shapeType:"sector"},b)))}))}function qX(e){var t,{pieSettings:r,displayedData:n,cells:a,offset:i}=e,{cornerRadius:s,startAngle:o,endAngle:c,dataKey:u,nameKey:d,tooltipType:f}=r,m=Math.abs(r.minAngle),p=UX(o,c),x=Math.abs(p),g=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,y=n.filter(_=>Zt(_,u,0)!==0).length,v=(x>=360?y:y-1)*g,b=x-y*m-v,w=n.reduce((_,C)=>{var E=Zt(C,u,0);return _+(lt(E)?E:0)},0),k;if(w>0){var S;k=n.map((_,C)=>{var E=Zt(_,u,0),A=Zt(_,d,C),T=$X(r,i,_),D=(lt(E)?E:0)/w,I,z=lr(lr({},_),a&&a[C]&&a[C].props);C?I=S.endAngle+ln(p)*g*(E!==0?1:0):I=o;var X=I+ln(p)*((E!==0?m:0)+D*b),H=(I+X)/2,L=(T.innerRadius+T.outerRadius)/2,W=[{name:A,value:E,payload:z,dataKey:u,type:f}],ie=Ur(T.cx,T.cy,L,H);return S=lr(lr(lr(lr({},r.presentationProps),{},{percent:D,cornerRadius:s,name:A,tooltipPayload:W,midAngle:H,middleRadius:L,tooltipPosition:ie},z),T),{},{value:E,startAngle:I,endAngle:X,payload:z,paddingAngle:ln(p)*g}),S})}return k}function XX(e){var{showLabels:t,sectors:r,children:n}=e,a=N.useMemo(()=>!t||!r?[]:r.map(i=>({value:i.value,payload:i.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:i.cx,cy:i.cy,innerRadius:i.innerRadius,outerRadius:i.outerRadius,startAngle:i.startAngle,endAngle:i.endAngle,clockWise:!1},fill:i.fill})),[r,t]);return N.createElement(Iq,{value:t?a:void 0},n)}function YX(e){var{props:t,previousSectorsRef:r}=e,{sectors:n,isAnimationActive:a,animationBegin:i,animationDuration:s,animationEasing:o,activeShape:c,inactiveShape:u,onAnimationStart:d,onAnimationEnd:f}=t,m=zf(t,"recharts-pie-"),p=r.current,[x,g]=N.useState(!1),y=N.useCallback(()=>{typeof f=="function"&&f(),g(!1)},[f]),v=N.useCallback(()=>{typeof d=="function"&&d(),g(!0)},[d]);return N.createElement(XX,{showLabels:!x,sectors:n},N.createElement(Uf,{animationId:m,begin:i,duration:s,isActive:a,easing:o,onAnimationStart:v,onAnimationEnd:y,key:m},b=>{var w=[],k=n&&n[0],S=k==null?void 0:k.startAngle;return n==null||n.forEach((_,C)=>{var E=p&&p[C],A=C>0?Tl(_,"paddingAngle",0):0;if(E){var T=_r(E.endAngle-E.startAngle,_.endAngle-_.startAngle,b),D=lr(lr({},_),{},{startAngle:S+A,endAngle:S+T+A});w.push(D),S=D.endAngle}else{var{endAngle:I,startAngle:z}=_,X=_r(0,I-z,b),H=lr(lr({},_),{},{startAngle:S+A,endAngle:S+X+A});w.push(H),S=H.endAngle}}),r.current=w,N.createElement(Nn,null,N.createElement(KX,{sectors:w,activeShape:c,inactiveShape:u,allOtherPieProps:t}))}),N.createElement(VX,{showLabels:!x,sectors:n,props:t}),t.children)}var JX={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!$o.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function QX(e){var{id:t}=e,r=y2(e,PX),{hide:n,className:a,rootTabIndex:i}=e,s=N.useMemo(()=>f2(e.children,Gi),[e.children]),o=st(d=>Yq(d,t,s)),c=N.useRef(null),u=Ft("recharts-pie",a);return n||o==null?(c.current=null,N.createElement(Nn,{tabIndex:i,className:u})):N.createElement(N.Fragment,null,N.createElement(g2,{fn:LX,args:lr(lr({},e),{},{sectors:o})}),N.createElement(Nn,{tabIndex:i,className:u},N.createElement(YX,{props:lr(lr({},r),{},{sectors:o}),previousSectorsRef:c})))}function tl(e){var t=kn(e,JX),{id:r}=t,n=y2(t,OX),a=Fa(n);return N.createElement(x2,{id:r,type:"pie"},i=>N.createElement(N.Fragment,null,N.createElement(AX,{type:"pie",id:i,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:a,maxRadius:t.maxRadius}),N.createElement(MX,Po({},n,{id:i})),N.createElement(QX,Po({},n,{id:i}))))}tl.displayName="Pie";function WC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function GC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WC(Object(r),!0).forEach(function(n){ZX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):WC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZX(e,t,r){return(t=eY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eY(e){var t=tY(e,"string");return typeof t=="symbol"?t:t+""}function tY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rY={xAxis:{},yAxis:{},zAxis:{}},sD=Ua({name:"cartesianAxis",initialState:rY,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:Yn()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:Yn()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:Yn()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:Yn()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:Yn()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:Yn()},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload,a=e.yAxis[r];if(a){var i=a.widthHistory||[];if(i.length===3&&i[0]===i[2]&&n===i[1]&&n!==a.width&&Math.abs(n-i[0])<=1)return;var s=[...i,n].slice(-3);e.yAxis[r]=GC(GC({},e.yAxis[r]),{},{width:n,widthHistory:s})}}}}),{addXAxis:nY,removeXAxis:aY,addYAxis:iY,removeYAxis:sY,addZAxis:n0e,removeZAxis:a0e,updateYAxisWidth:oY}=sD.actions,lY=sD.reducer,cY=xe([Qr],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),uY=xe([cY,zs,Hs],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),v2=()=>st(uY),dY=()=>st(JV);function VC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function KC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VC(Object(r),!0).forEach(function(n){fY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fY(e,t,r){return(t=hY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hY(e){var t=mY(e,"string");return typeof t=="symbol"?t:t+""}function mY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pY=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:a,dataKey:i}=e;if(a===!1||t.x==null||t.y==null)return null;var s=KC(KC({index:r,dataKey:i,cx:t.x,cy:t.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},Al(a)),_b(a)),o;return N.isValidElement(a)?o=N.cloneElement(a,s):typeof a=="function"?o=a(s):o=N.createElement(VO,s),N.createElement(Nn,{className:"recharts-active-dot"},o)};function gY(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:a}=e,i=st(To),s=dY();if(t==null||s==null)return null;var o=t.find(c=>s.includes(c.payload));return dr(o)?null:pY({point:o,childIndex:Number(i),mainColor:r,dataKey:a,activeDot:n})}var xY=!0,Mx="Invariant failed";function yY(e,t){if(!e){if(xY)throw new Error(Mx);var r=typeof t=="function"?t():t,n=r?"".concat(Mx,": ").concat(r):Mx;throw new Error(n)}}var vY=["x","y"];function Wv(){return Wv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Wv.apply(null,arguments)}function qC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function nd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qC(Object(r),!0).forEach(function(n){bY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bY(e,t,r){return(t=wY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wY(e){var t=NY(e,"string");return typeof t=="symbol"?t:t+""}function NY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kY(e,t){if(e==null)return{};var r,n,a=SY(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function SY(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function _Y(e,t){var{x:r,y:n}=e,a=kY(e,vY),i="".concat(r),s=parseInt(i,10),o="".concat(n),c=parseInt(o,10),u="".concat(t.height||a.height),d=parseInt(u,10),f="".concat(t.width||a.width),m=parseInt(f,10);return nd(nd(nd(nd(nd({},t),a),s?{x:s}:{}),c?{y:c}:{}),{},{height:d,width:m,name:t.name,radius:t.radius})}function b2(e){return N.createElement(tD,Wv({shapeType:"rectangle",propTransformer:_Y,activeClassName:"recharts-active-bar"},e))}var CY=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(lt(t))return t;var i=lt(n)||dr(n);return i?t(n,a):(i||yY(!1),r)}},EY={},oD=Ua({name:"errorBars",initialState:EY,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:a}=t.payload;e[r]&&(e[r]=e[r].map(i=>i.dataKey===n.dataKey&&i.direction===n.direction?a:i))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}});oD.actions;var AY=oD.reducer,TY=["children"];function PY(e,t){if(e==null)return{};var r,n,a=OY(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function OY(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var DY={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},IY=N.createContext(DY);function lD(e){var{children:t}=e,r=PY(e,TY);return N.createElement(IY.Provider,{value:r},t)}function w2(e,t){var r,n,a=st(u=>Gs(u,e)),i=st(u=>Vs(u,t)),s=(r=a==null?void 0:a.allowDataOverflow)!==null&&r!==void 0?r:xa.allowDataOverflow,o=(n=i==null?void 0:i.allowDataOverflow)!==null&&n!==void 0?n:ya.allowDataOverflow,c=s||o;return{needClip:c,needClipX:s,needClipY:o}}function cD(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,a=v2(),{needClipX:i,needClipY:s,needClip:o}=w2(t,r);if(!o)return null;var{x:c,y:u,width:d,height:f}=a;return N.createElement("clipPath",{id:"clipPath-".concat(n)},N.createElement("rect",{x:i?c:c-d/2,y:s?u:u-f/2,width:i?d:d*2,height:s?f:f*2}))}var RY=["onMouseEnter","onMouseLeave","onClick"],FY=["value","background","tooltipPosition"],MY=["id"],LY=["onMouseEnter","onClick","onMouseLeave"];function Oo(){return Oo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Oo.apply(null,arguments)}function XC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Jn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XC(Object(r),!0).forEach(function(n){BY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function BY(e,t,r){return(t=jY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jY(e){var t=$Y(e,"string");return typeof t=="symbol"?t:t+""}function $Y(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Mm(e,t){if(e==null)return{};var r,n,a=UY(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function UY(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var zY=e=>{var{dataKey:t,name:r,fill:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:wu(r,t),payload:e}]};function HY(e){var{dataKey:t,stroke:r,strokeWidth:n,fill:a,name:i,hide:s,unit:o}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:t,nameKey:void 0,name:wu(i,t),hide:s,type:e.tooltipType,color:e.fill,unit:o}}}function WY(e){var t=st(To),{data:r,dataKey:n,background:a,allOtherBarProps:i}=e,{onMouseEnter:s,onMouseLeave:o,onClick:c}=i,u=Mm(i,RY),d=h2(s,n),f=m2(o),m=p2(c,n);if(!a||r==null)return null;var p=Al(a);return N.createElement(N.Fragment,null,r.map((x,g)=>{var{value:y,background:v,tooltipPosition:b}=x,w=Mm(x,FY);if(!v)return null;var k=d(x,g),S=f(x,g),_=m(x,g),C=Jn(Jn(Jn(Jn(Jn({option:a,isActive:String(g)===t},w),{},{fill:"#eee"},v),p),Lf(u,x,g)),{},{onMouseEnter:k,onMouseLeave:S,onClick:_,dataKey:n,index:g,className:"recharts-bar-background-rectangle"});return N.createElement(b2,Oo({key:"background-bar-".concat(g)},C))}))}function GY(e){var{showLabels:t,children:r,rects:n}=e,a=n==null?void 0:n.map(i=>{var s={x:i.x,y:i.y,width:i.width,height:i.height};return Jn(Jn({},s),{},{value:i.value,payload:i.payload,parentViewBox:i.parentViewBox,viewBox:s,fill:i.fill})});return N.createElement(WO,{value:t?a:void 0},r)}function VY(e){var{shape:t,activeBar:r,baseProps:n,entry:a,index:i,dataKey:s}=e,o=st(To),c=st(wO),u=r&&String(i)===o&&(c==null||s===c),d=u?r:t;return N.createElement(b2,Oo({},n,{name:String(n.name)},a,{isActive:u,option:d,index:i,dataKey:s}))}function KY(e){var{shape:t,baseProps:r,entry:n,index:a,dataKey:i}=e;return N.createElement(b2,Oo({},r,{name:String(r.name)},n,{isActive:!1,option:t,index:a,dataKey:i}))}function qY(e){var{data:t,props:r}=e,n=Fa(r),a=Mm(n,MY),{shape:i,dataKey:s,activeBar:o}=r,{onMouseEnter:c,onClick:u,onMouseLeave:d}=r,f=Mm(r,LY),m=h2(c,s),p=m2(d),x=p2(u,s);return t?N.createElement(N.Fragment,null,t.map((g,y)=>N.createElement(Nn,Oo({key:"rectangle-".concat(g==null?void 0:g.x,"-").concat(g==null?void 0:g.y,"-").concat(g==null?void 0:g.value,"-").concat(y),className:"recharts-bar-rectangle"},Lf(f,g,y),{onMouseEnter:m(g,y),onMouseLeave:p(g,y),onClick:x(g,y)}),o?N.createElement(VY,{shape:i,activeBar:o,baseProps:a,entry:g,index:y,dataKey:s}):N.createElement(KY,{shape:i,baseProps:a,entry:g,index:y,dataKey:s})))):null}function XY(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:a,isAnimationActive:i,animationBegin:s,animationDuration:o,animationEasing:c,onAnimationEnd:u,onAnimationStart:d}=t,f=r.current,m=zf(t,"recharts-bar-"),[p,x]=N.useState(!1),g=!p,y=N.useCallback(()=>{typeof u=="function"&&u(),x(!1)},[u]),v=N.useCallback(()=>{typeof d=="function"&&d(),x(!0)},[d]);return N.createElement(GY,{showLabels:g,rects:n},N.createElement(Uf,{animationId:m,begin:s,duration:o,isActive:i,easing:c,onAnimationEnd:y,onAnimationStart:v,key:m},b=>{var w=b===1?n:n==null?void 0:n.map((k,S)=>{var _=f&&f[S];if(_)return Jn(Jn({},k),{},{x:_r(_.x,k.x,b),y:_r(_.y,k.y,b),width:_r(_.width,k.width,b),height:_r(_.height,k.height,b)});if(a==="horizontal"){var C=_r(0,k.height,b);return Jn(Jn({},k),{},{y:k.y+k.height-C,height:C})}var E=_r(0,k.width,b);return Jn(Jn({},k),{},{width:E})});return b>0&&(r.current=w??null),w==null?null:N.createElement(Nn,null,N.createElement(qY,{props:t,data:w}))}),N.createElement(o2,{label:t.label}),t.children)}function YY(e){var t=N.useRef(null);return N.createElement(XY,{previousRectanglesRef:t,props:e})}var uD=0,JY=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:Zt(e,t)}};class QY extends N.PureComponent{render(){var{hide:t,data:r,dataKey:n,className:a,xAxisId:i,yAxisId:s,needClip:o,background:c,id:u}=this.props;if(t||r==null)return null;var d=Ft("recharts-bar",a),f=u;return N.createElement(Nn,{className:d,id:u},o&&N.createElement("defs",null,N.createElement(cD,{clipPathId:f,xAxisId:i,yAxisId:s})),N.createElement(Nn,{className:"recharts-bar-rectangles",clipPath:o?"url(#clipPath-".concat(f,")"):void 0},N.createElement(WY,{data:r,dataKey:n,background:c,allOtherBarProps:this.props}),N.createElement(YY,this.props)))}}var ZY={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!$o.isSsr,legendType:"rect",minPointSize:uD,xAxisId:0,yAxisId:0};function eJ(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:s,animationBegin:o,animationDuration:c,animationEasing:u,isAnimationActive:d}=e,{needClip:f}=w2(t,r),m=Wp(),p=aa(),x=f2(e.children,Gi),g=st(b=>AJ(b,t,r,p,e.id,x));if(m!=="vertical"&&m!=="horizontal")return null;var y,v=g==null?void 0:g[0];return v==null||v.height==null||v.width==null?y=0:y=m==="vertical"?v.height/2:v.width/2,N.createElement(lD,{xAxisId:t,yAxisId:r,data:g,dataPointFormatter:JY,errorBarOffset:y},N.createElement(QY,Oo({},e,{layout:m,needClip:f,data:g,xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:s,animationBegin:o,animationDuration:c,animationEasing:u,isAnimationActive:d})))}function tJ(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:i,xAxis:s,yAxis:o,xAxisTicks:c,yAxisTicks:u,stackedData:d,displayedData:f,offset:m,cells:p,parentViewBox:x}=e,g=t==="horizontal"?o:s,y=d?g.scale.domain():null,v=d$({numericAxis:g});return f.map((b,w)=>{var k,S,_,C,E,A;d?k=i$(d[w],y):(k=Zt(b,r),Array.isArray(k)||(k=[v,k]));var T=CY(n,uD)(k[1],w);if(t==="horizontal"){var D,[I,z]=[o.scale(k[0]),o.scale(k[1])];S=GS({axis:s,ticks:c,bandSize:i,offset:a.offset,entry:b,index:w}),_=(D=z??I)!==null&&D!==void 0?D:void 0,C=a.size;var X=I-z;if(E=di(X)?0:X,A={x:S,y:m.top,width:C,height:m.height},Math.abs(T)>0&&Math.abs(E)<Math.abs(T)){var H=ln(E||T)*(Math.abs(T)-Math.abs(E));_-=H,E+=H}}else{var[L,W]=[s.scale(k[0]),s.scale(k[1])];if(S=L,_=GS({axis:o,ticks:u,bandSize:i,offset:a.offset,entry:b,index:w}),C=W-L,E=a.size,A={x:m.left,y:_,width:m.width,height:E},Math.abs(T)>0&&Math.abs(C)<Math.abs(T)){var ie=ln(C||T)*(Math.abs(T)-Math.abs(C));C+=ie}}if(S==null||_==null||C==null||E==null)return null;var B=Jn(Jn({},b),{},{x:S,y:_,width:C,height:E,value:d?k:k[1],payload:b,background:A,tooltipPosition:{x:S+C/2,y:_+E/2},parentViewBox:x},p&&p[w]&&p[w].props);return B}).filter(Boolean)}function rJ(e){var t=kn(e,ZY),r=aa();return N.createElement(x2,{id:t.id,type:"bar"},n=>N.createElement(N.Fragment,null,N.createElement(nD,{legendPayload:zY(t)}),N.createElement(g2,{fn:HY,args:t}),N.createElement(iD,{type:"bar",id:n,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:u$(t.stackId),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:r}),N.createElement(eJ,Oo({},t,{id:n}))))}var Za=N.memo(rJ);Za.displayName="Bar";function YC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function X0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YC(Object(r),!0).forEach(function(n){nJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nJ(e,t,r){return(t=aJ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aJ(e){var t=iJ(e,"string");return typeof t=="symbol"?t:t+""}function iJ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sJ=(e,t)=>t,oJ=(e,t,r)=>r,lJ=(e,t,r,n)=>n,cJ=(e,t,r,n,a)=>a,e0=xe([ig,cJ],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),uJ=xe([e0],e=>e==null?void 0:e.maxBarSize),dJ=(e,t,r,n,a,i)=>i,JC=(e,t,r)=>{var n=r??e;if(!dr(n))return Bn(n,t,0)},fJ=xe([Ot,ig,sJ,oJ,lJ],(e,t,r,n,a)=>t.filter(i=>e==="horizontal"?i.xAxisId===r:i.yAxisId===n).filter(i=>i.isPanorama===a).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),hJ=(e,t,r,n)=>{var a=Ot(e);return a==="horizontal"?Lv(e,"yAxis",r,n):Lv(e,"xAxis",t,n)},mJ=(e,t,r)=>{var n=Ot(e);return n==="horizontal"?oC(e,"xAxis",t):oC(e,"yAxis",r)},pJ=(e,t,r)=>{var n={},a=e.filter(rg),i=e.filter(u=>u.stackId==null),s=a.reduce((u,d)=>(u[d.stackId]||(u[d.stackId]=[]),u[d.stackId].push(d),u),n),o=Object.entries(s).map(u=>{var[d,f]=u,m=f.map(x=>x.dataKey),p=JC(t,r,f[0].barSize);return{stackId:d,dataKeys:m,barSize:p}}),c=i.map(u=>{var d=[u.dataKey].filter(m=>m!=null),f=JC(t,r,u.barSize);return{stackId:void 0,dataKeys:d,barSize:f}});return[...o,...c]},gJ=xe([fJ,nG,mJ],pJ),xJ=(e,t,r,n,a)=>{var i,s,o=e0(e,t,r,n,a);if(o!=null){var c=Ot(e),u=w5(e),{maxBarSize:d}=o,f=dr(d)?u:d,m,p;return c==="horizontal"?(m=Ao(e,"xAxis",t,n),p=Eo(e,"xAxis",t,n)):(m=Ao(e,"yAxis",r,n),p=Eo(e,"yAxis",r,n)),(i=(s=tf(m,p,!0))!==null&&s!==void 0?s:f)!==null&&i!==void 0?i:0}},dD=(e,t,r,n)=>{var a=Ot(e),i,s;return a==="horizontal"?(i=Ao(e,"xAxis",t,n),s=Eo(e,"xAxis",t,n)):(i=Ao(e,"yAxis",r,n),s=Eo(e,"yAxis",r,n)),tf(i,s)};function yJ(e,t,r,n,a){var i=n.length;if(!(i<1)){var s=Bn(e,r,0,!0),o,c=[];if(zn(n[0].barSize)){var u=!1,d=r/i,f=n.reduce((v,b)=>v+(b.barSize||0),0);f+=(i-1)*s,f>=r&&(f-=(i-1)*s,s=0),f>=r&&d>0&&(u=!0,d*=.9,f=i*d);var m=(r-f)/2>>0,p={offset:m-s,size:0};o=n.reduce((v,b)=>{var w,k={stackId:b.stackId,dataKeys:b.dataKeys,position:{offset:p.offset+p.size+s,size:u?d:(w=b.barSize)!==null&&w!==void 0?w:0}},S=[...v,k];return p=S[S.length-1].position,S},c)}else{var x=Bn(t,r,0,!0);r-2*x-(i-1)*s<=0&&(s=0);var g=(r-2*x-(i-1)*s)/i;g>1&&(g>>=0);var y=zn(a)?Math.min(g,a):g;o=n.reduce((v,b,w)=>[...v,{stackId:b.stackId,dataKeys:b.dataKeys,position:{offset:x+(g+s)*w+(g-y)/2,size:y}}],c)}return o}}var vJ=(e,t,r,n,a,i,s)=>{var o=dr(s)?t:s,c=yJ(r,n,a!==i?a:i,e,o);return a!==i&&c!=null&&(c=c.map(u=>X0(X0({},u),{},{position:X0(X0({},u.position),{},{offset:u.position.offset-a/2})}))),c},bJ=xe([gJ,w5,rG,N5,xJ,dD,uJ],vJ),wJ=(e,t,r,n)=>Ao(e,"xAxis",t,n),NJ=(e,t,r,n)=>Ao(e,"yAxis",r,n),kJ=(e,t,r,n)=>Eo(e,"xAxis",t,n),SJ=(e,t,r,n)=>Eo(e,"yAxis",r,n),_J=xe([bJ,e0],(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),CJ=(e,t)=>{var r=Tw(t);if(!(!e||r==null||t==null)){var{stackId:n}=t;if(n!=null){var a=e[n];if(a){var{stackedData:i}=a;if(i)return i.find(s=>s.key===r)}}}},EJ=xe([hJ,e0],CJ),AJ=xe([Qr,Gb,wJ,NJ,kJ,SJ,_J,Ot,Qp,dD,EJ,e0,dJ],(e,t,r,n,a,i,s,o,c,u,d,f,m)=>{var{chartData:p,dataStartIndex:x,dataEndIndex:g}=c;if(!(f==null||s==null||t==null||o!=="horizontal"&&o!=="vertical"||r==null||n==null||a==null||i==null||u==null)){var{data:y}=f,v;if(y!=null&&y.length>0?v=y:v=p==null?void 0:p.slice(x,g+1),v!=null)return tJ({layout:o,barSettings:f,pos:s,parentViewBox:t,bandSize:u,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,stackedData:d,displayedData:v,offset:e,cells:m})}}),fD=e=>{var{chartData:t}=e,r=fr(),n=aa();return N.useEffect(()=>n?()=>{}:(r(gC(t)),()=>{r(gC(void 0))}),[t,r,n]),null},QC={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},hD=Ua({name:"brush",initialState:QC,reducers:{setBrushSettings(e,t){return t.payload==null?QC:t.payload}}});hD.actions;var TJ=hD.reducer;function PJ(e,t,r){return(t=OJ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OJ(e){var t=DJ(e,"string");return typeof t=="symbol"?t:t+""}function DJ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class N2{static create(t){return new N2(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+a}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+s}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],a=r[r.length-1];return n<=a?t>=n&&t<=a:t>=a&&t<=n}}PJ(N2,"EPS",1e-4);function IJ(e){return(e%180+180)%180}var RJ=function(t){var{width:r,height:n}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=IJ(a),s=i*Math.PI/180,o=Math.atan(n/r),c=s>o&&s<Math.PI-o?n/Math.sin(s):r/Math.cos(s);return Math.abs(c)},FJ={dots:[],areas:[],lines:[]},mD=Ua({name:"referenceElements",initialState:FJ,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=_s(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=_s(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=_s(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}});mD.actions;var MJ=mD.reducer,LJ=N.createContext(void 0),BJ=e=>{var{children:t}=e,[r]=N.useState("".concat(Qd("recharts"),"-clip")),n=v2();if(n==null)return null;var{x:a,y:i,width:s,height:o}=n;return N.createElement(LJ.Provider,{value:r},N.createElement("defs",null,N.createElement("clipPath",{id:r},N.createElement("rect",{x:a,y:i,height:o,width:s}))),t)};function cu(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function pD(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)if(r===void 0||r(e[a])===!0)n.push(e[a]);else return;return n}function jJ(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return RJ(n,r)}function $J(e,t,r){var n=r==="width",{x:a,y:i,width:s,height:o}=e;return t===1?{start:n?a:i,end:n?a+s:i+o}:{start:n?a+s:i+o,end:n?a:i}}function Lm(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function UJ(e,t){return pD(e,t+1)}function zJ(e,t,r,n,a){for(var i=(n||[]).slice(),{start:s,end:o}=t,c=0,u=1,d=s,f=function(){var x=n==null?void 0:n[c];if(x===void 0)return{v:pD(n,u)};var g=c,y,v=()=>(y===void 0&&(y=r(x,g)),y),b=x.coordinate,w=c===0||Lm(e,b,v,d,o);w||(c=0,d=s,u+=1),w&&(d=b+e*(v()/2+a),c+=u)},m;u<=i.length;)if(m=f(),m)return m.v;return[]}function ZC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Tn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZC(Object(r),!0).forEach(function(n){HJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HJ(e,t,r){return(t=WJ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WJ(e){var t=GJ(e,"string");return typeof t=="symbol"?t:t+""}function GJ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function VJ(e,t,r,n,a){for(var i=(n||[]).slice(),s=i.length,{start:o}=t,{end:c}=t,u=function(m){var p=i[m],x,g=()=>(x===void 0&&(x=r(p,m)),x);if(m===s-1){var y=e*(p.coordinate+e*g()/2-c);i[m]=p=Tn(Tn({},p),{},{tickCoord:y>0?p.coordinate-y*e:p.coordinate})}else i[m]=p=Tn(Tn({},p),{},{tickCoord:p.coordinate});var v=Lm(e,p.tickCoord,g,o,c);v&&(c=p.tickCoord-e*(g()/2+a),i[m]=Tn(Tn({},p),{},{isShow:!0}))},d=s-1;d>=0;d--)u(d);return i}function KJ(e,t,r,n,a,i){var s=(n||[]).slice(),o=s.length,{start:c,end:u}=t;if(i){var d=n[o-1],f=r(d,o-1),m=e*(d.coordinate+e*f/2-u);s[o-1]=d=Tn(Tn({},d),{},{tickCoord:m>0?d.coordinate-m*e:d.coordinate});var p=Lm(e,d.tickCoord,()=>f,c,u);p&&(u=d.tickCoord-e*(f/2+a),s[o-1]=Tn(Tn({},d),{},{isShow:!0}))}for(var x=i?o-1:o,g=function(b){var w=s[b],k,S=()=>(k===void 0&&(k=r(w,b)),k);if(b===0){var _=e*(w.coordinate-e*S()/2-c);s[b]=w=Tn(Tn({},w),{},{tickCoord:_<0?w.coordinate-_*e:w.coordinate})}else s[b]=w=Tn(Tn({},w),{},{tickCoord:w.coordinate});var C=Lm(e,w.tickCoord,S,c,u);C&&(c=w.tickCoord+e*(S()/2+a),s[b]=Tn(Tn({},w),{},{isShow:!0}))},y=0;y<x;y++)g(y);return s}function k2(e,t,r){var{tick:n,ticks:a,viewBox:i,minTickGap:s,orientation:o,interval:c,tickFormatter:u,unit:d,angle:f}=e;if(!a||!a.length||!n)return[];if(lt(c)||$o.isSsr){var m;return(m=UJ(a,lt(c)?c:0))!==null&&m!==void 0?m:[]}var p=[],x=o==="top"||o==="bottom"?"width":"height",g=d&&x==="width"?Sd(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},y=(w,k)=>{var S=typeof u=="function"?u(w.value,k):w.value;return x==="width"?jJ(Sd(S,{fontSize:t,letterSpacing:r}),g,f):Sd(S,{fontSize:t,letterSpacing:r})[x]},v=a.length>=2?ln(a[1].coordinate-a[0].coordinate):1,b=$J(i,v,x);return c==="equidistantPreserveStart"?zJ(v,b,y,a,s):(c==="preserveStart"||c==="preserveStartEnd"?p=KJ(v,b,y,a,s,c==="preserveStartEnd"):p=VJ(v,b,y,a,s),p.filter(w=>w.isShow))}var qJ=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:i=0}=e,s=0;if(t){Array.from(t).forEach(d=>{if(d){var f=d.getBoundingClientRect();f.width>s&&(s=f.width)}});var o=r?r.getBoundingClientRect().width:0,c=a+i,u=s+c+o+(r?n:0);return Math.round(u)}return 0},XJ=["axisLine","width","height","className","hide","ticks"],YJ=["viewBox"],JJ=["viewBox"];function Gv(e,t){if(e==null)return{};var r,n,a=QJ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function QJ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Rl(){return Rl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rl.apply(null,arguments)}function eE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Kr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eE(Object(r),!0).forEach(function(n){ZJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZJ(e,t,r){return(t=eQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eQ(e){var t=tQ(e,"string");return typeof t=="symbol"?t:t+""}function tQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var S2={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function rQ(e){var{x:t,y:r,width:n,height:a,orientation:i,mirror:s,axisLine:o,otherSvgProps:c}=e;if(!o)return null;var u=Kr(Kr(Kr({},c),Fa(o)),{},{fill:"none"});if(i==="top"||i==="bottom"){var d=+(i==="top"&&!s||i==="bottom"&&s);u=Kr(Kr({},u),{},{x1:t,y1:r+d*a,x2:t+n,y2:r+d*a})}else{var f=+(i==="left"&&!s||i==="right"&&s);u=Kr(Kr({},u),{},{x1:t+f*n,y1:r,x2:t+f*n,y2:r+a})}return N.createElement("line",Rl({},u,{className:Ft("recharts-cartesian-axis-line",Tl(o,"className"))}))}function nQ(e,t,r,n,a,i,s,o,c){var u,d,f,m,p,x,g=o?-1:1,y=e.tickSize||s,v=lt(e.tickCoord)?e.tickCoord:e.coordinate;switch(i){case"top":u=d=e.coordinate,m=r+ +!o*a,f=m-g*y,x=f-g*c,p=v;break;case"left":f=m=e.coordinate,d=t+ +!o*n,u=d-g*y,p=u-g*c,x=v;break;case"right":f=m=e.coordinate,d=t+ +o*n,u=d+g*y,p=u+g*c,x=v;break;default:u=d=e.coordinate,m=r+ +o*a,f=m+g*y,x=f+g*c,p=v;break}return{line:{x1:u,y1:f,x2:d,y2:m},tick:{x:p,y:x}}}function aQ(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function iQ(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function sQ(e){var{option:t,tickProps:r,value:n}=e,a,i=Ft(r.className,"recharts-cartesian-axis-tick-value");if(N.isValidElement(t))a=N.cloneElement(t,Kr(Kr({},r),{},{className:i}));else if(typeof t=="function")a=t(Kr(Kr({},r),{},{className:i}));else{var s="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(s=Ft(s,t==null?void 0:t.className)),a=N.createElement(dg,Rl({},r,{className:s}),n)}return a}function oQ(e){var{ticks:t=[],tick:r,tickLine:n,stroke:a,tickFormatter:i,unit:s,padding:o,tickTextProps:c,orientation:u,mirror:d,x:f,y:m,width:p,height:x,tickSize:g,tickMargin:y,fontSize:v,letterSpacing:b,getTicksConfig:w,events:k}=e,S=k2(Kr(Kr({},w),{},{ticks:t}),v,b),_=aQ(u,d),C=iQ(u,d),E=Fa(w),A=Al(r),T={};typeof n=="object"&&(T=n);var D=Kr(Kr({},E),{},{fill:"none"},T),I=S.map((z,X)=>{var{line:H,tick:L}=nQ(z,f,m,p,x,u,g,d,y),W=Kr(Kr(Kr(Kr({textAnchor:_,verticalAnchor:C},E),{},{stroke:"none",fill:a},A),L),{},{index:X,payload:z,visibleTicksCount:S.length,tickFormatter:i,padding:o},c);return N.createElement(Nn,Rl({className:"recharts-cartesian-axis-tick",key:"tick-".concat(z.value,"-").concat(z.coordinate,"-").concat(z.tickCoord)},Lf(k,z,X)),n&&N.createElement("line",Rl({},D,H,{className:Ft("recharts-cartesian-axis-tick-line",Tl(n,"className"))})),r&&N.createElement(sQ,{option:r,tickProps:W,value:"".concat(typeof i=="function"?i(z.value,X):z.value).concat(s||"")}))});return I.length>0?N.createElement("g",{className:"recharts-cartesian-axis-ticks"},I):null}var lQ=N.forwardRef((e,t)=>{var{axisLine:r,width:n,height:a,className:i,hide:s,ticks:o}=e,c=Gv(e,XJ),[u,d]=N.useState(""),[f,m]=N.useState(""),p=N.useRef(null);N.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var g;return qJ({ticks:p.current,label:(g=e.labelRef)===null||g===void 0?void 0:g.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var x=N.useCallback(g=>{if(g){var y=g.getElementsByClassName("recharts-cartesian-axis-tick-value");p.current=y;var v=y[0];if(v){var b=window.getComputedStyle(v),w=b.fontSize,k=b.letterSpacing;(w!==u||k!==f)&&(d(w),m(k))}}},[u,f]);return s||n!=null&&n<=0||a!=null&&a<=0?null:N.createElement(Nn,{className:Ft("recharts-cartesian-axis",i),ref:x},N.createElement(rQ,{x:e.x,y:e.y,width:n,height:a,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:Fa(e)}),N.createElement(oQ,{ticks:o,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:u,letterSpacing:f,getTicksConfig:e,events:c}),N.createElement(gq,{x:e.x,y:e.y,width:e.width,height:e.height},N.createElement(Cq,{label:e.label,labelRef:e.labelRef}),e.children))}),cQ=N.memo(lQ,(e,t)=>{var{viewBox:r}=e,n=Gv(e,YJ),{viewBox:a}=t,i=Gv(t,JJ);return cu(r,a)&&cu(n,i)}),_2=N.forwardRef((e,t)=>{var r=kn(e,S2);return N.createElement(cQ,Rl({},r,{ref:t}))});_2.displayName="CartesianAxis";var uQ=["x1","y1","x2","y2","key"],dQ=["offset"],fQ=["xAxisId","yAxisId"],hQ=["xAxisId","yAxisId"];function tE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function In(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tE(Object(r),!0).forEach(function(n){mQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mQ(e,t,r){return(t=pQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pQ(e){var t=gQ(e,"string");return typeof t=="symbol"?t:t+""}function gQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ul(){return ul=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ul.apply(null,arguments)}function Bm(e,t){if(e==null)return{};var r,n,a=xQ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function xQ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var yQ=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:a,width:i,height:s,ry:o}=e;return N.createElement("rect",{x:n,y:a,ry:o,width:i,height:s,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function gD(e,t){var r;if(N.isValidElement(e))r=N.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var{x1:n,y1:a,x2:i,y2:s,key:o}=t,c=Bm(t,uQ),u=Fa(c),d=Bm(u,dQ);r=N.createElement("line",ul({},d,{x1:n,y1:a,x2:i,y2:s,fill:"none",key:o}))}return r}function vQ(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:a}=e;if(!n||!a||!a.length)return null;var i=Bm(e,fQ),s=a.map((o,c)=>{var u=In(In({},i),{},{x1:t,y1:o,x2:t+r,y2:o,key:"line-".concat(c),index:c});return gD(n,u)});return N.createElement("g",{className:"recharts-cartesian-grid-horizontal"},s)}function bQ(e){var{y:t,height:r,vertical:n=!0,verticalPoints:a}=e;if(!n||!a||!a.length)return null;var i=Bm(e,hQ),s=a.map((o,c)=>{var u=In(In({},i),{},{x1:o,y1:t,x2:o,y2:t+r,key:"line-".concat(c),index:c});return gD(n,u)});return N.createElement("g",{className:"recharts-cartesian-grid-vertical"},s)}function wQ(e){var{horizontalFill:t,fillOpacity:r,x:n,y:a,width:i,height:s,horizontalPoints:o,horizontal:c=!0}=e;if(!c||!t||!t.length)return null;var u=o.map(f=>Math.round(f+a-a)).sort((f,m)=>f-m);a!==u[0]&&u.unshift(0);var d=u.map((f,m)=>{var p=!u[m+1],x=p?a+s-f:u[m+1]-f;if(x<=0)return null;var g=m%t.length;return N.createElement("rect",{key:"react-".concat(m),y:f,x:n,height:x,width:i,stroke:"none",fill:t[g],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return N.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function NQ(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:a,y:i,width:s,height:o,verticalPoints:c}=e;if(!t||!r||!r.length)return null;var u=c.map(f=>Math.round(f+a-a)).sort((f,m)=>f-m);a!==u[0]&&u.unshift(0);var d=u.map((f,m)=>{var p=!u[m+1],x=p?a+s-f:u[m+1]-f;if(x<=0)return null;var g=m%r.length;return N.createElement("rect",{key:"react-".concat(m),x:f,y:i,width:x,height:o,stroke:"none",fill:r[g],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return N.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var kQ=(e,t)=>{var{xAxis:r,width:n,height:a,offset:i}=e;return QP(k2(In(In(In({},S2),r),{},{ticks:ZP(r,!0),viewBox:{x:0,y:0,width:n,height:a}})),i.left,i.left+i.width,t)},SQ=(e,t)=>{var{yAxis:r,width:n,height:a,offset:i}=e;return QP(k2(In(In(In({},S2),r),{},{ticks:ZP(r,!0),viewBox:{x:0,y:0,width:n,height:a}})),i.top,i.top+i.height,t)},_Q={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function Lr(e){var t=Kb(),r=qb(),n=c6(),a=In(In({},kn(e,_Q)),{},{x:lt(e.x)?e.x:n.left,y:lt(e.y)?e.y:n.top,width:lt(e.width)?e.width:n.width,height:lt(e.height)?e.height:n.height}),{xAxisId:i,yAxisId:s,x:o,y:c,width:u,height:d,syncWithTicks:f,horizontalValues:m,verticalValues:p}=a,x=aa(),g=st(A=>lC(A,"xAxis",i,x)),y=st(A=>lC(A,"yAxis",s,x));if(!lt(u)||u<=0||!lt(d)||d<=0||!lt(o)||o!==+o||!lt(c)||c!==+c)return null;var v=a.verticalCoordinatesGenerator||kQ,b=a.horizontalCoordinatesGenerator||SQ,{horizontalPoints:w,verticalPoints:k}=a;if((!w||!w.length)&&typeof b=="function"){var S=m&&m.length,_=b({yAxis:y?In(In({},y),{},{ticks:S?m:y.ticks}):void 0,width:t,height:r,offset:n},S?!0:f);gm(Array.isArray(_),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof _,"]")),Array.isArray(_)&&(w=_)}if((!k||!k.length)&&typeof v=="function"){var C=p&&p.length,E=v({xAxis:g?In(In({},g),{},{ticks:C?p:g.ticks}):void 0,width:t,height:r,offset:n},C?!0:f);gm(Array.isArray(E),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof E,"]")),Array.isArray(E)&&(k=E)}return N.createElement("g",{className:"recharts-cartesian-grid"},N.createElement(yQ,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),N.createElement(wQ,ul({},a,{horizontalPoints:w})),N.createElement(NQ,ul({},a,{verticalPoints:k})),N.createElement(vQ,ul({},a,{offset:n,horizontalPoints:w,xAxis:g,yAxis:y})),N.createElement(bQ,ul({},a,{offset:n,verticalPoints:k,xAxis:g,yAxis:y})))}Lr.displayName="CartesianGrid";var xD=(e,t,r,n)=>Ao(e,"xAxis",t,n),yD=(e,t,r,n)=>Eo(e,"xAxis",t,n),vD=(e,t,r,n)=>Ao(e,"yAxis",r,n),bD=(e,t,r,n)=>Eo(e,"yAxis",r,n),CQ=xe([Ot,xD,vD,yD,bD],(e,t,r,n,a)=>jo(e,"xAxis")?tf(t,n,!1):tf(r,a,!1)),EQ=(e,t,r,n,a)=>a;function AQ(e){return e.type==="line"}var TQ=xe([ig,EQ],(e,t)=>e.filter(AQ).find(r=>r.id===t)),PQ=xe([Ot,xD,vD,yD,bD,TQ,CQ,Qp],(e,t,r,n,a,i,s,o)=>{var{chartData:c,dataStartIndex:u,dataEndIndex:d}=o;if(!(i==null||t==null||r==null||n==null||a==null||n.length===0||a.length===0||s==null)){var{dataKey:f,data:m}=i,p;if(m!=null&&m.length>0?p=m:p=c==null?void 0:c.slice(u,d+1),p!=null)return ZQ({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:a,dataKey:f,bandSize:s,displayedData:p})}});function OQ(e){var t=Al(e),r=3,n=2;if(t!=null){var{r:a,strokeWidth:i}=t,s=Number(a),o=Number(i);return(Number.isNaN(s)||s<0)&&(s=r),(Number.isNaN(o)||o<0)&&(o=n),{r:s,strokeWidth:o}}return{r,strokeWidth:n}}var DQ=["id"],IQ=["type","layout","connectNulls","needClip"],RQ=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function rE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function wa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rE(Object(r),!0).forEach(function(n){FQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function FQ(e,t,r){return(t=MQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MQ(e){var t=LQ(e,"string");return typeof t=="symbol"?t:t+""}function LQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function C2(e,t){if(e==null)return{};var r,n,a=BQ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function BQ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Fl(){return Fl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fl.apply(null,arguments)}var jQ=e=>{var{dataKey:t,name:r,stroke:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:wu(r,t),payload:e}]};function $Q(e){var{dataKey:t,data:r,stroke:n,strokeWidth:a,fill:i,name:s,hide:o,unit:c}=e;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:a,fill:i,dataKey:t,nameKey:void 0,name:wu(s,t),hide:o,type:e.tooltipType,color:e.stroke,unit:c}}}var wD=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function UQ(e,t){for(var r=e.length%2!==0?[...e,0]:e,n=[],a=0;a<t;++a)n=[...n,...r];return n}var zQ=(e,t,r)=>{var n=r.reduce((f,m)=>f+m);if(!n)return wD(t,e);for(var a=Math.floor(e/n),i=e%n,s=t-e,o=[],c=0,u=0;c<r.length;u+=r[c],++c)if(u+r[c]>i){o=[...r.slice(0,c),i-u];break}var d=o.length%2===0?[0,s]:[s];return[...UQ(r,a),...o,...d].map(f=>"".concat(f,"px")).join(", ")};function HQ(e,t){var r;if(N.isValidElement(e))r=N.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var n=Ft("recharts-line-dot",typeof e!="boolean"?e.className:"");r=N.createElement(VO,Fl({},t,{className:n}))}return r}function WQ(e,t){return e==null?!1:t?!0:e.length===1}function GQ(e){var{clipPathId:t,points:r,props:n}=e,{dot:a,dataKey:i,needClip:s}=n;if(!WQ(r,a))return null;var o=C2(n,DQ),c=ZO(a),u=Fa(o),d=oj(a),f=r.map((p,x)=>{var g=wa(wa(wa({key:"dot-".concat(x),r:3},u),d),{},{index:x,cx:p.x,cy:p.y,dataKey:i,value:p.value,payload:p.payload,points:r});return HQ(a,g)}),m={clipPath:s?"url(#clipPath-".concat(c?"":"dots-").concat(t,")"):void 0};return N.createElement(Nn,Fl({className:"recharts-line-dots",key:"dots"},m),f)}function VQ(e){var{showLabels:t,children:r,points:n}=e,a=N.useMemo(()=>n==null?void 0:n.map(i=>{var s={x:i.x,y:i.y,width:0,height:0};return wa(wa({},s),{},{value:i.value,payload:i.payload,viewBox:s,parentViewBox:void 0,fill:void 0})}),[n]);return N.createElement(WO,{value:t?a:null},r)}function nE(e){var{clipPathId:t,pathRef:r,points:n,strokeDasharray:a,props:i}=e,{type:s,layout:o,connectNulls:c,needClip:u}=i,d=C2(i,IQ),f=wa(wa({},ea(d)),{},{fill:"none",className:"recharts-line-curve",clipPath:u?"url(#clipPath-".concat(t,")"):void 0,points:n,type:s,layout:o,connectNulls:c,strokeDasharray:a??i.strokeDasharray});return N.createElement(N.Fragment,null,(n==null?void 0:n.length)>1&&N.createElement(Yb,Fl({},f,{pathRef:r})),N.createElement(GQ,{points:n,clipPathId:t,props:i}))}function KQ(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function qQ(e){var{clipPathId:t,props:r,pathRef:n,previousPointsRef:a,longestAnimatedLengthRef:i}=e,{points:s,strokeDasharray:o,isAnimationActive:c,animationBegin:u,animationDuration:d,animationEasing:f,animateNewValues:m,width:p,height:x,onAnimationEnd:g,onAnimationStart:y}=r,v=a.current,b=zf(r,"recharts-line-"),[w,k]=N.useState(!1),S=!w,_=N.useCallback(()=>{typeof g=="function"&&g(),k(!1)},[g]),C=N.useCallback(()=>{typeof y=="function"&&y(),k(!0)},[y]),E=KQ(n.current),A=i.current;return N.createElement(VQ,{points:s,showLabels:S},r.children,N.createElement(Uf,{animationId:b,begin:u,duration:d,isActive:c,easing:f,onAnimationEnd:_,onAnimationStart:C,key:b},T=>{var D=_r(A,E+A,T),I=Math.min(D,E),z;if(c)if(o){var X="".concat(o).split(/[,\s]+/gim).map(W=>parseFloat(W));z=zQ(I,E,X)}else z=wD(E,I);else z=o==null?void 0:String(o);if(v){var H=v.length/s.length,L=T===1?s:s.map((W,ie)=>{var B=Math.floor(ie*H);if(v[B]){var ee=v[B];return wa(wa({},W),{},{x:_r(ee.x,W.x,T),y:_r(ee.y,W.y,T)})}return m?wa(wa({},W),{},{x:_r(p*2,W.x,T),y:_r(x/2,W.y,T)}):wa(wa({},W),{},{x:W.x,y:W.y})});return a.current=L,N.createElement(nE,{props:r,points:L,clipPathId:t,pathRef:n,strokeDasharray:z})}return T>0&&E>0&&(a.current=s,i.current=I),N.createElement(nE,{props:r,points:s,clipPathId:t,pathRef:n,strokeDasharray:z})}),N.createElement(o2,{label:r.label}))}function XQ(e){var{clipPathId:t,props:r}=e,n=N.useRef(null),a=N.useRef(0),i=N.useRef(null);return N.createElement(qQ,{props:r,clipPathId:t,previousPointsRef:n,longestAnimatedLengthRef:a,pathRef:i})}var YQ=(e,t)=>({x:e.x,y:e.y,value:e.value,errorVal:Zt(e.payload,t)});class JQ extends N.Component{render(){var{hide:t,dot:r,points:n,className:a,xAxisId:i,yAxisId:s,top:o,left:c,width:u,height:d,id:f,needClip:m}=this.props;if(t)return null;var p=Ft("recharts-line",a),x=f,{r:g,strokeWidth:y}=OQ(r),v=ZO(r),b=g*2+y;return N.createElement(N.Fragment,null,N.createElement(Nn,{className:p},m&&N.createElement("defs",null,N.createElement(cD,{clipPathId:x,xAxisId:i,yAxisId:s}),!v&&N.createElement("clipPath",{id:"clipPath-dots-".concat(x)},N.createElement("rect",{x:c-b/2,y:o-b/2,width:u+b,height:d+b}))),N.createElement(lD,{xAxisId:i,yAxisId:s,data:n,dataPointFormatter:YQ,errorBarOffset:0},N.createElement(XQ,{props:this.props,clipPathId:x}))),N.createElement(gY,{activeDot:this.props.activeDot,points:n,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var ND={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!$o.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function QQ(e){var t=kn(e,ND),{activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:s,connectNulls:o,dot:c,hide:u,isAnimationActive:d,label:f,legendType:m,xAxisId:p,yAxisId:x,id:g}=t,y=C2(t,RQ),{needClip:v}=w2(p,x),b=v2(),w=Wp(),k=aa(),S=st(T=>PQ(T,p,x,k,g));if(w!=="horizontal"&&w!=="vertical"||S==null||b==null)return null;var{height:_,width:C,x:E,y:A}=b;return N.createElement(JQ,Fl({},y,{id:g,connectNulls:o,dot:c,activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:i,animationEasing:s,isAnimationActive:d,hide:u,label:f,legendType:m,xAxisId:p,yAxisId:x,points:S,layout:w,height:_,width:C,left:E,top:A,needClip:v}))}function ZQ(e){var{layout:t,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,dataKey:s,bandSize:o,displayedData:c}=e;return c.map((u,d)=>{var f=Zt(u,s);if(t==="horizontal"){var m=WS({axis:r,ticks:a,bandSize:o,entry:u,index:d}),p=dr(f)?null:n.scale(f);return{x:m,y:p,value:f,payload:u}}var x=dr(f)?null:r.scale(f),g=WS({axis:n,ticks:i,bandSize:o,entry:u,index:d});return x==null||g==null?null:{x,y:g,value:f,payload:u}}).filter(Boolean)}function eZ(e){var t=kn(e,ND),r=aa();return N.createElement(x2,{id:t.id,type:"line"},n=>N.createElement(N.Fragment,null,N.createElement(nD,{legendPayload:jQ(t)}),N.createElement(g2,{fn:$Q,args:t}),N.createElement(iD,{type:"line",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:r}),N.createElement(QQ,Fl({},t,{id:n}))))}var Ei=N.memo(eZ);Ei.displayName="Line";var tZ=["dangerouslySetInnerHTML","ticks"],rZ=["id"],nZ=["domain"],aZ=["domain"];function Vv(){return Vv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vv.apply(null,arguments)}function jm(e,t){if(e==null)return{};var r,n,a=iZ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function iZ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function sZ(e){var t=fr();return N.useLayoutEffect(()=>(t(nY(e)),()=>{t(aY(e))}),[e,t]),null}var oZ=e=>{var{xAxisId:t,className:r}=e,n=st(Gb),a=aa(),i="xAxis",s=st(p=>Tu(p,i,t,a)),o=st(p=>eO(p,i,t,a)),c=st(p=>Y5(p,t)),u=st(p=>JG(p,t)),d=st(p=>O5(p,t));if(c==null||u==null||d==null)return null;var f=jm(e,tZ),m=jm(d,rZ);return N.createElement(_2,Vv({},f,m,{scale:s,x:u.x,y:u.y,width:c.width,height:c.height,className:Ft("recharts-".concat(i," ").concat(i),r),viewBox:n,ticks:o}))},lZ={allowDataOverflow:xa.allowDataOverflow,allowDecimals:xa.allowDecimals,allowDuplicatedCategory:xa.allowDuplicatedCategory,height:xa.height,hide:!1,mirror:xa.mirror,orientation:xa.orientation,padding:xa.padding,reversed:xa.reversed,scale:xa.scale,tickCount:xa.tickCount,type:xa.type,xAxisId:0},cZ=e=>{var t,r,n,a,i,s=kn(e,lZ);return N.createElement(N.Fragment,null,N.createElement(sZ,{interval:(t=s.interval)!==null&&t!==void 0?t:"preserveEnd",id:s.xAxisId,scale:s.scale,type:s.type,padding:s.padding,allowDataOverflow:s.allowDataOverflow,domain:s.domain,dataKey:s.dataKey,allowDuplicatedCategory:s.allowDuplicatedCategory,allowDecimals:s.allowDecimals,tickCount:s.tickCount,includeHidden:(r=s.includeHidden)!==null&&r!==void 0?r:!1,reversed:s.reversed,ticks:s.ticks,height:s.height,orientation:s.orientation,mirror:s.mirror,hide:s.hide,unit:s.unit,name:s.name,angle:(n=s.angle)!==null&&n!==void 0?n:0,minTickGap:(a=s.minTickGap)!==null&&a!==void 0?a:5,tick:(i=s.tick)!==null&&i!==void 0?i:!0,tickFormatter:s.tickFormatter}),N.createElement(oZ,s))},uZ=(e,t)=>{var{domain:r}=e,n=jm(e,nZ),{domain:a}=t,i=jm(t,aZ);return cu(n,i)?Array.isArray(r)&&r.length===2&&Array.isArray(a)&&a.length===2?r[0]===a[0]&&r[1]===a[1]:cu({domain:r},{domain:a}):!1},Br=N.memo(cZ,uZ);Br.displayName="XAxis";var dZ=["dangerouslySetInnerHTML","ticks"],fZ=["id"],hZ=["domain"],mZ=["domain"];function Kv(){return Kv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Kv.apply(null,arguments)}function $m(e,t){if(e==null)return{};var r,n,a=pZ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function pZ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function gZ(e){var t=fr();return N.useLayoutEffect(()=>(t(iY(e)),()=>{t(sY(e))}),[e,t]),null}var xZ=e=>{var{yAxisId:t,className:r,width:n,label:a}=e,i=N.useRef(null),s=N.useRef(null),o=st(Gb),c=aa(),u=fr(),d="yAxis",f=st(b=>Tu(b,d,t,c)),m=st(b=>J5(b,t)),p=st(b=>ZG(b,t)),x=st(b=>eO(b,d,t,c)),g=st(b=>D5(b,t));if(N.useLayoutEffect(()=>{if(!(n!=="auto"||!m||s2(a)||N.isValidElement(a)||g==null)){var b=i.current;if(b){var w=b.getCalculatedWidth();Math.round(m.width)!==Math.round(w)&&u(oY({id:t,width:w}))}}},[x,m,u,a,t,n,g]),m==null||p==null||g==null)return null;var y=$m(e,dZ),v=$m(g,fZ);return N.createElement(_2,Kv({},y,v,{ref:i,labelRef:s,scale:f,x:p.x,y:p.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:m.width,height:m.height,className:Ft("recharts-".concat(d," ").concat(d),r),viewBox:o,ticks:x}))},yZ={allowDataOverflow:ya.allowDataOverflow,allowDecimals:ya.allowDecimals,allowDuplicatedCategory:ya.allowDuplicatedCategory,hide:!1,mirror:ya.mirror,orientation:ya.orientation,padding:ya.padding,reversed:ya.reversed,scale:ya.scale,tickCount:ya.tickCount,type:ya.type,width:ya.width,yAxisId:0},vZ=e=>{var t,r,n,a,i,s=kn(e,yZ);return N.createElement(N.Fragment,null,N.createElement(gZ,{interval:(t=s.interval)!==null&&t!==void 0?t:"preserveEnd",id:s.yAxisId,scale:s.scale,type:s.type,domain:s.domain,allowDataOverflow:s.allowDataOverflow,dataKey:s.dataKey,allowDuplicatedCategory:s.allowDuplicatedCategory,allowDecimals:s.allowDecimals,tickCount:s.tickCount,padding:s.padding,includeHidden:(r=s.includeHidden)!==null&&r!==void 0?r:!1,reversed:s.reversed,ticks:s.ticks,width:s.width,orientation:s.orientation,mirror:s.mirror,hide:s.hide,unit:s.unit,name:s.name,angle:(n=s.angle)!==null&&n!==void 0?n:0,minTickGap:(a=s.minTickGap)!==null&&a!==void 0?a:5,tick:(i=s.tick)!==null&&i!==void 0?i:!0,tickFormatter:s.tickFormatter}),N.createElement(xZ,s))},bZ=(e,t)=>{var{domain:r}=e,n=$m(e,hZ),{domain:a}=t,i=$m(t,mZ);return cu(n,i)?Array.isArray(r)&&r.length===2&&Array.isArray(a)&&a.length===2?r[0]===a[0]&&r[1]===a[1]:cu({domain:r},{domain:a}):!1},jr=N.memo(vZ,bZ);jr.displayName="YAxis";var wZ={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var t0=N;function NZ(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var kZ=typeof Object.is=="function"?Object.is:NZ,SZ=t0.useSyncExternalStore,_Z=t0.useRef,CZ=t0.useEffect,EZ=t0.useMemo,AZ=t0.useDebugValue;wZ.useSyncExternalStoreWithSelector=function(e,t,r,n,a){var i=_Z(null);if(i.current===null){var s={hasValue:!1,value:null};i.current=s}else s=i.current;i=EZ(function(){function c(p){if(!u){if(u=!0,d=p,p=n(p),a!==void 0&&s.hasValue){var x=s.value;if(a(x,p))return f=x}return f=p}if(x=f,kZ(d,p))return x;var g=n(p);return a!==void 0&&a(x,g)?(d=p,x):(d=p,f=g)}var u=!1,d,f,m=r===void 0?null:r;return[function(){return c(t())},m===null?void 0:function(){return c(m())}]},[t,r,n,a]);var o=SZ(e,i[0],i[1]);return CZ(function(){s.hasValue=!0,s.value=o},[o]),AZ(o),o};function TZ(e){e()}function PZ(){let e=null,t=null;return{clear(){e=null,t=null},notify(){TZ(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=t={callback:r,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!n||e===null||(n=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var aE={notify(){},get:()=>[]};function OZ(e,t){let r,n=aE,a=0,i=!1;function s(g){d();const y=n.subscribe(g);let v=!1;return()=>{v||(v=!0,y(),f())}}function o(){n.notify()}function c(){x.onStateChange&&x.onStateChange()}function u(){return i}function d(){a++,r||(r=t?t.addNestedSub(c):e.subscribe(c),n=PZ())}function f(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=aE)}function m(){i||(i=!0,d())}function p(){i&&(i=!1,f())}const x={addNestedSub:s,notifyNestedSubs:o,handleChangeWrapper:c,isSubscribed:u,trySubscribe:m,tryUnsubscribe:p,getListeners:()=>n};return x}var DZ=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",IZ=DZ(),RZ=()=>typeof navigator<"u"&&navigator.product==="ReactNative",FZ=RZ(),MZ=()=>IZ||FZ?N.useLayoutEffect:N.useEffect,LZ=MZ(),Lx=Symbol.for("react-redux-context"),Bx=typeof globalThis<"u"?globalThis:{};function BZ(){if(!N.createContext)return{};const e=Bx[Lx]??(Bx[Lx]=new Map);let t=e.get(N.createContext);return t||(t=N.createContext(null),e.set(N.createContext,t)),t}var jZ=BZ();function $Z(e){const{children:t,context:r,serverState:n,store:a}=e,i=N.useMemo(()=>{const c=OZ(a);return{store:a,subscription:c,getServerState:n?()=>n:void 0}},[a,n]),s=N.useMemo(()=>a.getState(),[a]);LZ(()=>{const{subscription:c}=i;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),s!==a.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[i,s]);const o=r||jZ;return N.createElement(o.Provider,{value:i},t)}var UZ=$Z,zZ=(e,t)=>t,E2=xe([zZ,Ot,A5,en,xO,Ks,aK,Qr],cK),A2=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},kD=fi("mouseClick"),SD=jf();SD.startListening({actionCreator:kD,effect:(e,t)=>{var r=e.payload,n=E2(t.getState(),A2(r));(n==null?void 0:n.activeIndex)!=null&&t.dispatch(fV({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var qv=fi("mouseMove"),_D=jf();_D.startListening({actionCreator:qv,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=Yw(n,n.tooltip.settings.shared),i=E2(n,A2(r));a==="axis"&&((i==null?void 0:i.activeIndex)!=null?t.dispatch(lO({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate})):t.dispatch(oO()))}});var iE={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},CD=Ua({name:"rootProps",initialState:iE,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:iE.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),HZ=CD.reducer,{updateOptions:WZ}=CD.actions,ED=Ua({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:GZ}=ED.actions,VZ=ED.reducer,AD=fi("keyDown"),TD=fi("focus"),T2=jf();T2.startListening({actionCreator:AD,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var s=Number(Jw(a,Ou(r))),o=Ks(r);if(i==="Enter"){var c=Dm(r,"axis","hover",String(a.index));t.dispatch(jv({active:!a.active,activeIndex:a.index,activeDataKey:a.dataKey,activeCoordinate:c}));return}var u=nV(r),d=u==="left-to-right"?1:-1,f=i==="ArrowRight"?1:-1,m=s+f*d;if(!(o==null||m>=o.length||m<0)){var p=Dm(r,"axis","hover",String(m));t.dispatch(jv({active:!0,activeIndex:m.toString(),activeDataKey:void 0,activeCoordinate:p}))}}}}});T2.startListening({actionCreator:TD,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var i="0",s=Dm(r,"axis","hover",String(i));t.dispatch(jv({activeDataKey:void 0,active:!0,activeIndex:i,activeCoordinate:s}))}}}});var qa=fi("externalEvent"),PD=jf();PD.startListening({actionCreator:qa,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),n={activeCoordinate:qV(r),activeDataKey:wO(r),activeIndex:To(r),activeLabel:bO(r),activeTooltipIndex:To(r),isTooltipActive:XV(r)};e.payload.handler(n,e.payload.reactEvent)}}});var KZ=xe([Pu],e=>e.tooltipItemPayloads),qZ=xe([KZ,Qf,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,n)=>{var a=e.find(o=>o.settings.dataKey===n);if(a!=null){var{positions:i}=a;if(i!=null){var s=t(i,r);return s}}}),OD=fi("touchMove"),DD=jf();DD.startListening({actionCreator:OD,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=Yw(n,n.tooltip.settings.shared);if(a==="axis"){var i=E2(n,A2({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));(i==null?void 0:i.activeIndex)!=null&&t.dispatch(lO({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if(a==="item"){var s,o=r.touches[0],c=document.elementFromPoint(o.clientX,o.clientY);if(!c||!c.getAttribute)return;var u=c.getAttribute(t6),d=(s=c.getAttribute(r6))!==null&&s!==void 0?s:void 0,f=qZ(t.getState(),u,d);t.dispatch(sO({activeDataKey:d,activeIndex:u,activeCoordinate:f}))}}});var XZ=_P({brush:TJ,cartesianAxis:lY,chartData:SK,errorBars:AY,graphicalItems:EX,layout:H9,legend:G$,options:vK,polarAxis:Hq,polarOptions:VZ,referenceElements:MJ,rootProps:HZ,tooltip:hV}),YZ=function(t){return m9({reducer:XZ,preloadedState:t,middleware:r=>r({serializableCheck:!1}).concat([SD.middleware,_D.middleware,T2.middleware,PD.middleware,DD.middleware]),enhancers:r=>{var n=r;return typeof r=="function"&&(n=r()),n.concat(LP({type:"raf"}))},devTools:$o.devToolsEnabled})};function ID(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,a=aa(),i=N.useRef(null);if(a)return r;i.current==null&&(i.current=YZ(t));var s=Lb;return N.createElement(UZ,{context:s,store:i.current},r)}function RD(e){var{layout:t,margin:r}=e,n=fr(),a=aa();return N.useEffect(()=>{a||(n($9(t)),n(j9(r)))},[n,a,t,r]),null}function FD(e){var t=fr();return N.useEffect(()=>{t(WZ(e))},[t,e]),null}var JZ=["children"];function QZ(e,t){if(e==null)return{};var r,n,a=ZZ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ZZ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Um(){return Um=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Um.apply(null,arguments)}var eee={width:"100%",height:"100%",display:"block"},tee=N.forwardRef((e,t)=>{var r=Kb(),n=qb(),a=h6();if(!au(r)||!au(n))return null;var{children:i,otherAttributes:s,title:o,desc:c}=e,u,d;return typeof s.tabIndex=="number"?u=s.tabIndex:u=a?0:void 0,typeof s.role=="string"?d=s.role:d=a?"application":void 0,N.createElement(vb,Um({},s,{title:o,desc:c,role:d,tabIndex:u,width:r,height:n,style:eee,ref:t}),i)}),ree=e=>{var{children:t}=e,r=st(zp);if(!r)return null;var{width:n,height:a,y:i,x:s}=r;return N.createElement(vb,{width:n,height:a,x:s,y:i},t)},sE=N.forwardRef((e,t)=>{var{children:r}=e,n=QZ(e,JZ),a=aa();return a?N.createElement(ree,null,r):N.createElement(tee,Um({ref:t},n),r)});function nee(){var e=fr(),[t,r]=N.useState(null),n=st(y$);return N.useEffect(()=>{if(t!=null){var a=t.getBoundingClientRect(),i=a.width/t.offsetWidth;zn(i)&&i!==n&&e(z9(i))}},[t,e,n]),r}function oE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function aee(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oE(Object(r),!0).forEach(function(n){iee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iee(e,t,r){return(t=see(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function see(e){var t=oee(e,"string");return typeof t=="symbol"?t:t+""}function oee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ml(){return Ml=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ml.apply(null,arguments)}var lee=()=>(IK(),null);function zm(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var cee=N.forwardRef((e,t)=>{var r,n,a=N.useRef(null),[i,s]=N.useState({containerWidth:zm((r=e.style)===null||r===void 0?void 0:r.width),containerHeight:zm((n=e.style)===null||n===void 0?void 0:n.height)}),o=N.useCallback((u,d)=>{s(f=>{var m=Math.round(u),p=Math.round(d);return f.containerWidth===m&&f.containerHeight===p?f:{containerWidth:m,containerHeight:p}})},[]),c=N.useCallback(u=>{if(typeof t=="function"&&t(u),u!=null){var{width:d,height:f}=u.getBoundingClientRect();o(d,f);var m=x=>{var{width:g,height:y}=x[0].contentRect;o(g,y)},p=new ResizeObserver(m);p.observe(u),a.current=p}},[t,o]);return N.useEffect(()=>()=>{var u=a.current;u!=null&&u.disconnect()},[o]),N.createElement(N.Fragment,null,N.createElement(Gp,{width:i.containerWidth,height:i.containerHeight}),N.createElement("div",Ml({ref:c},e)))}),uee=N.forwardRef((e,t)=>{var{width:r,height:n}=e,[a,i]=N.useState({containerWidth:zm(r),containerHeight:zm(n)}),s=N.useCallback((c,u)=>{i(d=>{var f=Math.round(c),m=Math.round(u);return d.containerWidth===f&&d.containerHeight===m?d:{containerWidth:f,containerHeight:m}})},[]),o=N.useCallback(c=>{if(typeof t=="function"&&t(c),c!=null){var{width:u,height:d}=c.getBoundingClientRect();s(u,d)}},[t,s]);return N.createElement(N.Fragment,null,N.createElement(Gp,{width:a.containerWidth,height:a.containerHeight}),N.createElement("div",Ml({ref:o},e)))}),dee=N.forwardRef((e,t)=>{var{width:r,height:n}=e;return N.createElement(N.Fragment,null,N.createElement(Gp,{width:r,height:n}),N.createElement("div",Ml({ref:t},e)))}),fee=N.forwardRef((e,t)=>{var{width:r,height:n}=e;return Fs(r)||Fs(n)?N.createElement(uee,Ml({},e,{ref:t})):N.createElement(dee,Ml({},e,{ref:t}))});function hee(e){return e===!0?cee:fee}var mee=N.forwardRef((e,t)=>{var{children:r,className:n,height:a,onClick:i,onContextMenu:s,onDoubleClick:o,onMouseDown:c,onMouseEnter:u,onMouseLeave:d,onMouseMove:f,onMouseUp:m,onTouchEnd:p,onTouchMove:x,onTouchStart:g,style:y,width:v,responsive:b,dispatchTouchEvents:w=!0}=e,k=N.useRef(null),S=fr(),[_,C]=N.useState(null),[E,A]=N.useState(null),T=nee(),D=Vb(),I=(D==null?void 0:D.width)>0?D.width:v,z=(D==null?void 0:D.height)>0?D.height:a,X=N.useCallback(G=>{T(G),typeof t=="function"&&t(G),C(G),A(G),G!=null&&(k.current=G)},[T,t,C,A]),H=N.useCallback(G=>{S(kD(G)),S(qa({handler:i,reactEvent:G}))},[S,i]),L=N.useCallback(G=>{S(qv(G)),S(qa({handler:u,reactEvent:G}))},[S,u]),W=N.useCallback(G=>{S(oO()),S(qa({handler:d,reactEvent:G}))},[S,d]),ie=N.useCallback(G=>{S(qv(G)),S(qa({handler:f,reactEvent:G}))},[S,f]),B=N.useCallback(()=>{S(TD())},[S]),ee=N.useCallback(G=>{S(AD(G.key))},[S]),le=N.useCallback(G=>{S(qa({handler:s,reactEvent:G}))},[S,s]),R=N.useCallback(G=>{S(qa({handler:o,reactEvent:G}))},[S,o]),j=N.useCallback(G=>{S(qa({handler:c,reactEvent:G}))},[S,c]),V=N.useCallback(G=>{S(qa({handler:m,reactEvent:G}))},[S,m]),P=N.useCallback(G=>{S(qa({handler:g,reactEvent:G}))},[S,g]),q=N.useCallback(G=>{w&&S(OD(G)),S(qa({handler:x,reactEvent:G}))},[S,w,x]),O=N.useCallback(G=>{S(qa({handler:p,reactEvent:G}))},[S,p]),K=hee(b);return N.createElement(EO.Provider,{value:_},N.createElement(E3.Provider,{value:E},N.createElement(K,{width:I??(y==null?void 0:y.width),height:z??(y==null?void 0:y.height),className:Ft("recharts-wrapper",n),style:aee({position:"relative",cursor:"default",width:I,height:z},y),onClick:H,onContextMenu:le,onDoubleClick:R,onFocus:B,onKeyDown:ee,onMouseDown:j,onMouseEnter:L,onMouseLeave:W,onMouseMove:ie,onMouseUp:V,onTouchEnd:O,onTouchMove:q,onTouchStart:P,ref:X},N.createElement(lee,null),r)))}),pee=["width","height","responsive","children","className","style","compact","title","desc"];function gee(e,t){if(e==null)return{};var r,n,a=xee(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function xee(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var MD=N.forwardRef((e,t)=>{var{width:r,height:n,responsive:a,children:i,className:s,style:o,compact:c,title:u,desc:d}=e,f=gee(e,pee),m=Fa(f);return c?N.createElement(N.Fragment,null,N.createElement(Gp,{width:r,height:n}),N.createElement(sE,{otherAttributes:m,title:u,desc:d},i)):N.createElement(mee,{className:s,style:o,width:r,height:n,responsive:a,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},N.createElement(sE,{otherAttributes:m,title:u,desc:d,ref:t},N.createElement(BJ,null,i)))});function Xv(){return Xv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xv.apply(null,arguments)}var yee={top:5,right:5,bottom:5,left:5},vee={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:yee,reverseStackOrder:!1,syncMethod:"index",responsive:!1},LD=N.forwardRef(function(t,r){var n,a=kn(t.categoricalChartProps,vee),{chartName:i,defaultTooltipEventType:s,validateTooltipEventTypes:o,tooltipPayloadSearcher:c,categoricalChartProps:u}=t,d={chartName:i,defaultTooltipEventType:s,validateTooltipEventTypes:o,tooltipPayloadSearcher:c,eventEmitter:void 0};return N.createElement(ID,{preloadedState:{options:d},reduxStoreName:(n=u.id)!==null&&n!==void 0?n:i},N.createElement(fD,{chartData:u.data}),N.createElement(RD,{layout:a.layout,margin:a.margin}),N.createElement(FD,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),N.createElement(MD,Xv({},a,{ref:r})))}),bee=["axis"],qi=N.forwardRef((e,t)=>N.createElement(LD,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:bee,tooltipPayloadSearcher:i2,categoricalChartProps:e,ref:t})),wee=["axis","item"],fs=N.forwardRef((e,t)=>N.createElement(LD,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:wee,tooltipPayloadSearcher:i2,categoricalChartProps:e,ref:t}));function Nee(e){var t=fr();return N.useEffect(()=>{t(GZ(e))},[t,e]),null}var kee=["layout"];function Yv(){return Yv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yv.apply(null,arguments)}function See(e,t){if(e==null)return{};var r,n,a=_ee(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function _ee(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Cee={top:5,right:5,bottom:5,left:5},Eee={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Cee,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1},Aee=N.forwardRef(function(t,r){var n,a=kn(t.categoricalChartProps,Eee),{layout:i}=a,s=See(a,kee),{chartName:o,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d}=t,f={chartName:o,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d,eventEmitter:void 0};return N.createElement(ID,{preloadedState:{options:f},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:o},N.createElement(fD,{chartData:a.data}),N.createElement(RD,{layout:i,margin:a.margin}),N.createElement(FD,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),N.createElement(Nee,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),N.createElement(MD,Yv({},s,{ref:r})))}),Tee=["item"],Pee={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},dc=N.forwardRef((e,t)=>{var r=kn(e,Pee);return N.createElement(Aee,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:Tee,tooltipPayloadSearcher:i2,categoricalChartProps:r,ref:t})});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var uf={};uf.version="0.18.5";var Da=1200,Ll=1252,Oee=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],P2={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Sg=function(e){Oee.indexOf(e)!=-1&&(Ll=P2[0]=e)};function Dee(){Sg(1252)}var si=function(e){Da=e,Sg(e)};function _g(){si(1200),Dee()}function Hm(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function Iee(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function BD(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Oc=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Iee(e.slice(2)):t==254&&r==255?BD(e.slice(2)):t==65279?e.slice(1):e},dd=function(t){return String.fromCharCode(t)},Jv=function(t){return String.fromCharCode(t)},Pt;function Ree(e){Pt=e,si=function(t){Da=t,Sg(t)},Oc=function(t){return t.charCodeAt(0)===255&&t.charCodeAt(1)===254?Pt.utils.decode(1200,Hm(t.slice(2))):t},dd=function(r){return Da===1200?String.fromCharCode(r):Pt.utils.decode(Da,[r&255,r>>8])[0]},Jv=function(r){return Pt.utils.decode(Ll,[r])[0]},mI()}var co="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function df(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),i=r>>2,n=e.charCodeAt(u++),s=(r&3)<<4|n>>4,a=e.charCodeAt(u++),o=(n&15)<<2|a>>6,c=a&63,isNaN(n)?o=c=64:isNaN(a)&&(c=64),t+=co.charAt(i)+co.charAt(s)+co.charAt(o)+co.charAt(c);return t}function La(e){var t="",r=0,n=0,a=0,i=0,s=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)i=co.indexOf(e.charAt(u++)),s=co.indexOf(e.charAt(u++)),r=i<<2|s>>4,t+=String.fromCharCode(r),o=co.indexOf(e.charAt(u++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=co.indexOf(e.charAt(u++)),a=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(a));return t}var kt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),qs=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Do(e){return kt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function lE(e){return kt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var _a=function(t){return kt?qs(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function r0(e){if(typeof ArrayBuffer>"u")return _a(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Wo(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Fee(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function O2(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return O2(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var on=kt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:qs(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function Mee(e){for(var t=[],r=0,n=e.length+250,a=Do(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++i)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|o>>6&15|(s&3)<<4,a[r++]=128|o&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Do(65535),n=65530)}return t.push(a.slice(0,r)),on(t)}var jn=/\u0000/g,fd=/[\u0001-\u0006]/g;function Uc(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ai(e,t){var r=""+e;return r.length>=t?r:Sr("0",t-r.length)+r}function D2(e,t){var r=""+e;return r.length>=t?r:Sr(" ",t-r.length)+r}function Wm(e,t){var r=""+e;return r.length>=t?r:r+Sr(" ",t-r.length)}function Lee(e,t){var r=""+Math.round(e);return r.length>=t?r:Sr("0",t-r.length)+r}function Bee(e,t){var r=""+e;return r.length>=t?r:Sr("0",t-r.length)+r}var cE=Math.pow(2,32);function fc(e,t){if(e>cE||e<-cE)return Lee(e,t);var r=Math.round(e);return Bee(r,t)}function Gm(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var uE=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],jx=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function jee(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "',e}var ut={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "'},dE={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},$ee={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Vm(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,o=0,c=1,u=0,d=0,f=Math.floor(a);u<t&&(f=Math.floor(a),o=f*s+i,d=f*u+c,!(a-f<5e-8));)a=1/(a-f),i=s,s=o,c=u,u=d;if(d>t&&(u>t?(d=c,o=i):(d=u,o=s)),!r)return[0,n*o,d];var m=Math.floor(n*o/d);return[m,n*o-m*d,d]}function uo(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=Vee(c,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var jD=new Date(1899,11,31,0,0,0),Uee=jD.getTime(),zee=new Date(1900,2,1,0,0,0);function $D(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=zee&&(r+=24*60*60*1e3),(r-(Uee+(e.getTimezoneOffset()-jD.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function I2(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Hee(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Wee(e){var t=e<0?12:11,r=I2(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Gee(e){var t=I2(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function ff(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Wee(e):t===10?r=e.toFixed(10).substr(0,12):r=Gee(e),I2(Hee(r.toUpperCase()))}function Bl(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):ff(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ba(14,$D(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Vee(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Kee(e,t,r,n){var a="",i=0,s=0,o=r.y,c,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return jx[r.m-1][1];case 5:return jx[r.m-1][0];default:return jx[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return uE[r.q][0];default:return uE[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Ai(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=Ai(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var d=u>0?Ai(c,u):"";return d}function fo(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var UD=/%/g;function qee(e,t,r){var n=t.replace(UD,""),a=t.length-n.length;return Es(e,n,r*Math.pow(10,2*a))+Sr("%",a)}function Xee(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Es(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function zD(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+zD(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(a+i)%a)+"."+d.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var HD=/# (\?+)( ?)\/( ?)(\d+)/;function Yee(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,o=n;return r+(i===0?"":""+i)+" "+(s===0?Sr(" ",e[1].length+1+e[4].length):D2(s,e[1].length)+e[2]+"/"+e[3]+Ai(o,e[4].length))}function Jee(e,t,r){return r+(t===0?"":""+t)+Sr(" ",e[1].length+2+e[4].length)}var WD=/^#*0*\.([0#]+)/,GD=/\).*[0#]/,VD=/\(###\) ###\\?-####/;function qn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function fE(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function hE(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Qee(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Zee(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Xa(e,t,r){if(e.charCodeAt(0)===40&&!t.match(GD)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Xa("n",n,r):"("+Xa("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Xee(e,t,r);if(t.indexOf("%")!==-1)return qee(e,t,r);if(t.indexOf("E")!==-1)return zD(t,r);if(t.charCodeAt(0)===36)return"$"+Xa(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+fc(c,t.length);if(t.match(/^[#?]+$/))return a=fc(r,0),a==="0"&&(a=""),a.length>t.length?a:qn(t.substr(0,t.length-a.length))+a;if(i=t.match(HD))return Yee(i,c,u);if(t.match(/^#+0+$/))return u+fc(c,t.length-t.indexOf("0"));if(i=t.match(WD))return a=fE(r,i[1].length).replace(/^([^\.]+)$/,"$1."+qn(i[1])).replace(/\.$/,"."+qn(i[1])).replace(/\.(\d*)$/,function(x,g){return"."+g+Sr("0",qn(i[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+fE(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+fo(fc(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Xa(e,t,-r):fo(""+(Math.floor(r)+Qee(r,i[1].length)))+"."+Ai(hE(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Xa(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Uc(Xa(e,t.replace(/[\\-]/g,""),r)),s=0,Uc(Uc(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return s<a.length?a.charAt(s++):x==="0"?"0":""}));if(t.match(VD))return a=Xa(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Vm(c,Math.pow(10,s)-1,!1),a=""+u,d=Es("n",i[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+i[2]+"/"+i[3],d=Wm(o[2],s),d.length<i[4].length&&(d=qn(i[4].substr(i[4].length-d.length))+d),a+=d,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=Vm(c,Math.pow(10,s)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?D2(o[1],s)+i[2]+"/"+i[3]+Wm(o[2],s):Sr(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=fc(r,0),t.length<=a.length?a:qn(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var f=t.indexOf(".")-s,m=t.length-a.length-f;return qn(t.substr(0,f)+a+t.substr(t.length-m))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=hE(r,i[1].length),r<0?"-"+Xa(e,t,-r):fo(Zee(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Ai(0,3-x.length):"")+x})+"."+Ai(s,i[1].length);switch(t){case"###,##0.00":return Xa(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=fo(fc(c,0));return p!=="0"?u+p:"";case"###,###.00":return Xa(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Xa(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function ete(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Es(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function tte(e,t,r){var n=t.replace(UD,""),a=t.length-n.length;return Es(e,n,r*Math.pow(10,2*a))+Sr("%",a)}function KD(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+KD(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(a+i)%a)+"."+d.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function zi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(GD)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?zi("n",n,r):"("+zi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return ete(e,t,r);if(t.indexOf("%")!==-1)return tte(e,t,r);if(t.indexOf("E")!==-1)return KD(t,r);if(t.charCodeAt(0)===36)return"$"+zi(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Ai(c,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:qn(t.substr(0,t.length-a.length))+a;if(i=t.match(HD))return Jee(i,c,u);if(t.match(/^#+0+$/))return u+Ai(c,t.length-t.indexOf("0"));if(i=t.match(WD))return a=(""+r).replace(/^([^\.]+)$/,"$1."+qn(i[1])).replace(/\.$/,"."+qn(i[1])),a=a.replace(/\.(\d*)$/,function(x,g){return"."+g+Sr("0",qn(i[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+fo(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+zi(e,t,-r):fo(""+r)+"."+Sr("0",i[1].length);if(i=t.match(/^#,#*,#0/))return zi(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Uc(zi(e,t.replace(/[\\-]/g,""),r)),s=0,Uc(Uc(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return s<a.length?a.charAt(s++):x==="0"?"0":""}));if(t.match(VD))return a=zi(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Vm(c,Math.pow(10,s)-1,!1),a=""+u,d=Es("n",i[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+i[2]+"/"+i[3],d=Wm(o[2],s),d.length<i[4].length&&(d=qn(i[4].substr(i[4].length-d.length))+d),a+=d,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=Vm(c,Math.pow(10,s)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?D2(o[1],s)+i[2]+"/"+i[3]+Wm(o[2],s):Sr(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:qn(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var f=t.indexOf(".")-s,m=t.length-a.length-f;return qn(t.substr(0,f)+a+t.substr(t.length-m))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+zi(e,t,-r):fo(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Ai(0,3-x.length):"")+x})+"."+Ai(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=fo(""+c);return p!=="0"?u+p:"";default:if(t.match(/\.[0#?]*$/))return zi(e,t.slice(0,t.lastIndexOf(".")),r)+qn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Es(e,t,r){return(r|0)===r?zi(e,t,r):Xa(e,t,r)}function rte(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var qD=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Xl(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Gm(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"ä¸Š":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="ä¸Šåˆ/ä¸‹åˆ")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(qD))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function nte(e,t,r,n){for(var a=[],i="",s=0,o="",c="t",u,d,f,m="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!Gm(e,s))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(f=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(f);a[a.length]={t:"t",v:i},++s;break;case"\\":var p=e.charAt(++s),x=p==="("||p===")"?p:"t";a[a.length]={t:x,v:p},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(u==null&&(u=uo(t,r,e.charAt(s+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},c=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=uo(t,r),u==null))return"";for(i=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),a[a.length]={t:o,v:i},c=o;break;case"A":case"a":case"ä¸Š":var g={t:o,v:o};if(u==null&&(u=uo(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",m="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",s+=5,m="h"):e.substr(s,5).toUpperCase()==="ä¸Šåˆ/ä¸‹åˆ"?(u!=null&&(g.v=u.H>=12?"ä¸‹åˆ":"ä¸Šåˆ"),g.t="T",s+=5,m="h"):(g.t="t",++s),u==null&&g.t==="T")return"";a[a.length]=g,c=o;break;case"[":for(i=o;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(qD)){if(u==null&&(u=uo(t,r),u==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Xl(e)||(a[a.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=o;++s<e.length&&(o=e.charAt(s))==="0";)i+=o;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)i+=o;a[a.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++s)===o;)i+=o;a[a.length]={t:o,v:i},c=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:o,v:o},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=â‚¬acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++s;break}var y=0,v=0,b;for(s=a.length-1,c="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=m,c="h",y<1&&(y=1);break;case"s":(b=a[s].v.match(/\.0+$/))&&(v=Math.max(v,b[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":c=a[s].t;break;case"m":c==="s"&&(a[s].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&a[s].v.match(/[Hh]/)&&(y=1),y<2&&a[s].v.match(/[Mm]/)&&(y=2),y<3&&a[s].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var w="",k;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=Kee(a[s].t.charCodeAt(0),a[s].v,u,v),a[s].t="t";break;case"n":case"?":for(k=s+1;a[k]!=null&&((o=a[k].t)==="?"||o==="D"||(o===" "||o==="t")&&a[k+1]!=null&&(a[k+1].t==="?"||a[k+1].t==="t"&&a[k+1].v==="/")||a[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[k].v==="/"||a[k].v===" "&&a[k+1]!=null&&a[k+1].t=="?"));)a[s].v+=a[k].v,a[k]={v:"",t:";"},++k;w+=a[s].v,s=k-1;break;case"G":a[s].t="t",a[s].v=Bl(t,r);break}var S="",_,C;if(w.length>0){w.charCodeAt(0)==40?(_=t<0&&w.charCodeAt(0)===45?-t:t,C=Es("n",w,_)):(_=t<0&&n>1?-t:t,C=Es("n",w,_),_<0&&a[0]&&a[0].t=="t"&&(C=C.substr(1),a[0].v="-"+a[0].v)),k=C.length-1;var E=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){E=s;break}var A=a.length;if(E===a.length&&C.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(k>=a[s].v.length-1?(k-=a[s].v.length,a[s].v=C.substr(k+1,a[s].v.length)):k<0?a[s].v="":(a[s].v=C.substr(0,k+1),k=-1),a[s].t="t",A=s);k>=0&&A<a.length&&(a[A].v=C.substr(0,k+1)+a[A].v)}else if(E!==a.length&&C.indexOf("E")===-1){for(k=C.indexOf(".")-1,s=E;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(d=a[s].v.indexOf(".")>-1&&s===E?a[s].v.indexOf(".")-1:a[s].v.length-1,S=a[s].v.substr(d+1);d>=0;--d)k>=0&&(a[s].v.charAt(d)==="0"||a[s].v.charAt(d)==="#")&&(S=C.charAt(k--)+S);a[s].v=S,a[s].t="t",A=s}for(k>=0&&A<a.length&&(a[A].v=C.substr(0,k+1)+a[A].v),k=C.indexOf(".")+1,s=E;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==E)){for(d=a[s].v.indexOf(".")>-1&&s===E?a[s].v.indexOf(".")+1:0,S=a[s].v.substr(0,d);d<a[s].v.length;++d)k<C.length&&(S+=C.charAt(k++));a[s].v=S,a[s].t="t",A=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(_=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=Es(a[s].t,a[s].v,_),a[s].t="t");var T="";for(s=0;s!==a.length;++s)a[s]!=null&&(T+=a[s].v);return T}var mE=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function pE(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function ate(e,t){var r=rte(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(mE),o=r[1].match(mE);return pE(t,s)?[n,r[0]]:pE(t,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,i]}function Ba(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ut)[e],n==null&&(n=r.table&&r.table[dE[e]]||ut[dE[e]]),n==null&&(n=$ee[e]||"General");break}if(Gm(n,0))return Bl(t,r);t instanceof Date&&(t=$D(t,r.date1904));var a=ate(n,t);if(Gm(a[1]))return Bl(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return nte(a[1],t,r,a[0])}function es(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ut[r]==null){t<0&&(t=r);continue}if(ut[r]==e){t=r;break}}t<0&&(t=391)}return ut[t]=e,t}function n0(e){for(var t=0;t!=392;++t)e[t]!==void 0&&es(e[t],t)}function Du(){ut=jee()}var XD={format:Ba,load:es,_table:ut,load_table:n0,parse_date_code:uo,is_date:Xl,get_table:function(){return XD._table=ut}},ite={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},YD=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function ste(e){var t=typeof e=="number"?ut[e]:e;return t=t.replace(YD,"(\\d+)"),new RegExp("^"+t+"$")}function ote(e,t,r){var n=-1,a=-1,i=-1,s=-1,o=-1,c=-1;(t.match(YD)||[]).forEach(function(f,m){var p=parseInt(r[m+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=p;break;case"d":i=p;break;case"h":s=p;break;case"s":c=p;break;case"m":s>=0?o=p:a=p;break}}),c>=0&&o==-1&&a>=0&&(o=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return s==-1&&o==-1&&c==-1?u:n==-1&&a==-1&&i==-1?d:u+"T"+d}var lte=function(){var e={};e.version="1.2.0";function t(){for(var C=0,E=new Array(256),A=0;A!=256;++A)C=A,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,E[A]=C;return typeof Int32Array<"u"?new Int32Array(E):E}var r=t();function n(C){var E=0,A=0,T=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(T=0;T!=256;++T)D[T]=C[T];for(T=0;T!=256;++T)for(A=C[T],E=256+T;E<4096;E+=256)A=D[E]=A>>>8^C[A&255];var I=[];for(T=1;T!=16;++T)I[T-1]=typeof Int32Array<"u"?D.subarray(T*256,T*256+256):D.slice(T*256,T*256+256);return I}var a=n(r),i=a[0],s=a[1],o=a[2],c=a[3],u=a[4],d=a[5],f=a[6],m=a[7],p=a[8],x=a[9],g=a[10],y=a[11],v=a[12],b=a[13],w=a[14];function k(C,E){for(var A=E^-1,T=0,D=C.length;T<D;)A=A>>>8^r[(A^C.charCodeAt(T++))&255];return~A}function S(C,E){for(var A=E^-1,T=C.length-15,D=0;D<T;)A=w[C[D++]^A&255]^b[C[D++]^A>>8&255]^v[C[D++]^A>>16&255]^y[C[D++]^A>>>24]^g[C[D++]]^x[C[D++]]^p[C[D++]]^m[C[D++]]^f[C[D++]]^d[C[D++]]^u[C[D++]]^c[C[D++]]^o[C[D++]]^s[C[D++]]^i[C[D++]]^r[C[D++]];for(T+=15;D<T;)A=A>>>8^r[(A^C[D++])&255];return~A}function _(C,E){for(var A=E^-1,T=0,D=C.length,I=0,z=0;T<D;)I=C.charCodeAt(T++),I<128?A=A>>>8^r[(A^I)&255]:I<2048?(A=A>>>8^r[(A^(192|I>>6&31))&255],A=A>>>8^r[(A^(128|I&63))&255]):I>=55296&&I<57344?(I=(I&1023)+64,z=C.charCodeAt(T++)&1023,A=A>>>8^r[(A^(240|I>>8&7))&255],A=A>>>8^r[(A^(128|I>>2&63))&255],A=A>>>8^r[(A^(128|z>>6&15|(I&3)<<4))&255],A=A>>>8^r[(A^(128|z&63))&255]):(A=A>>>8^r[(A^(224|I>>12&15))&255],A=A>>>8^r[(A^(128|I>>6&63))&255],A=A>>>8^r[(A^(128|I&63))&255]);return~A}return e.table=r,e.bstr=k,e.buf=S,e.str=_,e}(),ct=function(){var t={};t.version="1.2.1";function r(U,re){for(var J=U.split("/"),Q=re.split("/"),ne=0,ae=0,ye=Math.min(J.length,Q.length);ne<ye;++ne){if(ae=J[ne].length-Q[ne].length)return ae;if(J[ne]!=Q[ne])return J[ne]<Q[ne]?-1:1}return J.length-Q.length}function n(U){if(U.charAt(U.length-1)=="/")return U.slice(0,-1).indexOf("/")===-1?U:n(U.slice(0,-1));var re=U.lastIndexOf("/");return re===-1?U:U.slice(0,re+1)}function a(U){if(U.charAt(U.length-1)=="/")return a(U.slice(0,-1));var re=U.lastIndexOf("/");return re===-1?U:U.slice(re+1)}function i(U,re){typeof re=="string"&&(re=new Date(re));var J=re.getHours();J=J<<6|re.getMinutes(),J=J<<5|re.getSeconds()>>>1,U.write_shift(2,J);var Q=re.getFullYear()-1980;Q=Q<<4|re.getMonth()+1,Q=Q<<5|re.getDate(),U.write_shift(2,Q)}function s(U){var re=U.read_shift(2)&65535,J=U.read_shift(2)&65535,Q=new Date,ne=J&31;J>>>=5;var ae=J&15;J>>>=4,Q.setMilliseconds(0),Q.setFullYear(J+1980),Q.setMonth(ae-1),Q.setDate(ne);var ye=re&31;re>>>=5;var Ee=re&63;return re>>>=6,Q.setHours(re),Q.setMinutes(Ee),Q.setSeconds(ye<<1),Q}function o(U){xn(U,0);for(var re={},J=0;U.l<=U.length-4;){var Q=U.read_shift(2),ne=U.read_shift(2),ae=U.l+ne,ye={};switch(Q){case 21589:J=U.read_shift(1),J&1&&(ye.mtime=U.read_shift(4)),ne>5&&(J&2&&(ye.atime=U.read_shift(4)),J&4&&(ye.ctime=U.read_shift(4))),ye.mtime&&(ye.mt=new Date(ye.mtime*1e3));break}U.l=ae,re[Q]=ye}return re}var c;function u(){return c||(c={})}function d(U,re){if(U[0]==80&&U[1]==75)return Ie(U,re);if((U[0]|32)==109&&(U[1]|32)==105)return Lt(U,re);if(U.length<512)throw new Error("CFB file size "+U.length+" < 512");var J=3,Q=512,ne=0,ae=0,ye=0,Ee=0,ge=0,be=[],F=U.slice(0,512);xn(F,0);var Z=f(F);switch(J=Z[0],J){case 3:Q=512;break;case 4:Q=4096;break;case 0:if(Z[1]==0)return Ie(U,re);default:throw new Error("Major Version: Expected 3 or 4 saw "+J)}Q!==512&&(F=U.slice(0,Q),xn(F,28));var ue=U.slice(0,Q);m(F,J);var oe=F.read_shift(4,"i");if(J===3&&oe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+oe);F.l+=4,ye=F.read_shift(4,"i"),F.l+=4,F.chk("00100000","Mini Stream Cutoff Size: "),Ee=F.read_shift(4,"i"),ne=F.read_shift(4,"i"),ge=F.read_shift(4,"i"),ae=F.read_shift(4,"i");for(var se=-1,he=0;he<109&&(se=F.read_shift(4,"i"),!(se<0));++he)be[he]=se;var Se=p(U,Q);y(ge,ae,Se,Q,be);var Ve=b(Se,ye,be,Q);Ve[ye].name="!Directory",ne>0&&Ee!==z&&(Ve[Ee].name="!MiniFAT"),Ve[be[0]].name="!FAT",Ve.fat_addrs=be,Ve.ssz=Q;var Ze={},ot=[],Et=[],Bt=[];w(ye,Ve,Se,ot,ne,Ze,Et,Ee),x(Et,Bt,ot),ot.shift();var Yt={FileIndex:Et,FullPaths:Bt};return re&&re.raw&&(Yt.raw={header:ue,sectors:Se}),Yt}function f(U){if(U[U.l]==80&&U[U.l+1]==75)return[0,0];U.chk(X,"Header Signature: "),U.l+=16;var re=U.read_shift(2,"u");return[U.read_shift(2,"u"),re]}function m(U,re){var J=9;switch(U.l+=2,J=U.read_shift(2)){case 9:if(re!=3)throw new Error("Sector Shift: Expected 9 saw "+J);break;case 12:if(re!=4)throw new Error("Sector Shift: Expected 12 saw "+J);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+J)}U.chk("0600","Mini Sector Shift: "),U.chk("000000000000","Reserved: ")}function p(U,re){for(var J=Math.ceil(U.length/re)-1,Q=[],ne=1;ne<J;++ne)Q[ne-1]=U.slice(ne*re,(ne+1)*re);return Q[J-1]=U.slice(J*re),Q}function x(U,re,J){for(var Q=0,ne=0,ae=0,ye=0,Ee=0,ge=J.length,be=[],F=[];Q<ge;++Q)be[Q]=F[Q]=Q,re[Q]=J[Q];for(;Ee<F.length;++Ee)Q=F[Ee],ne=U[Q].L,ae=U[Q].R,ye=U[Q].C,be[Q]===Q&&(ne!==-1&&be[ne]!==ne&&(be[Q]=be[ne]),ae!==-1&&be[ae]!==ae&&(be[Q]=be[ae])),ye!==-1&&(be[ye]=Q),ne!==-1&&Q!=be[Q]&&(be[ne]=be[Q],F.lastIndexOf(ne)<Ee&&F.push(ne)),ae!==-1&&Q!=be[Q]&&(be[ae]=be[Q],F.lastIndexOf(ae)<Ee&&F.push(ae));for(Q=1;Q<ge;++Q)be[Q]===Q&&(ae!==-1&&be[ae]!==ae?be[Q]=be[ae]:ne!==-1&&be[ne]!==ne&&(be[Q]=be[ne]));for(Q=1;Q<ge;++Q)if(U[Q].type!==0){if(Ee=Q,Ee!=be[Ee])do Ee=be[Ee],re[Q]=re[Ee]+"/"+re[Q];while(Ee!==0&&be[Ee]!==-1&&Ee!=be[Ee]);be[Q]=-1}for(re[0]+="/",Q=1;Q<ge;++Q)U[Q].type!==2&&(re[Q]+="/")}function g(U,re,J){for(var Q=U.start,ne=U.size,ae=[],ye=Q;J&&ne>0&&ye>=0;)ae.push(re.slice(ye*I,ye*I+I)),ne-=I,ye=rl(J,ye*4);return ae.length===0?_e(0):on(ae).slice(0,U.size)}function y(U,re,J,Q,ne){var ae=z;if(U===z){if(re!==0)throw new Error("DIFAT chain shorter than expected")}else if(U!==-1){var ye=J[U],Ee=(Q>>>2)-1;if(!ye)return;for(var ge=0;ge<Ee&&(ae=rl(ye,ge*4))!==z;++ge)ne.push(ae);y(rl(ye,Q-4),re-1,J,Q,ne)}}function v(U,re,J,Q,ne){var ae=[],ye=[];ne||(ne=[]);var Ee=Q-1,ge=0,be=0;for(ge=re;ge>=0;){ne[ge]=!0,ae[ae.length]=ge,ye.push(U[ge]);var F=J[Math.floor(ge*4/Q)];if(be=ge*4&Ee,Q<4+be)throw new Error("FAT boundary crossed: "+ge+" 4 "+Q);if(!U[F])break;ge=rl(U[F],be)}return{nodes:ae,data:EE([ye])}}function b(U,re,J,Q){var ne=U.length,ae=[],ye=[],Ee=[],ge=[],be=Q-1,F=0,Z=0,ue=0,oe=0;for(F=0;F<ne;++F)if(Ee=[],ue=F+re,ue>=ne&&(ue-=ne),!ye[ue]){ge=[];var se=[];for(Z=ue;Z>=0;){se[Z]=!0,ye[Z]=!0,Ee[Ee.length]=Z,ge.push(U[Z]);var he=J[Math.floor(Z*4/Q)];if(oe=Z*4&be,Q<4+oe)throw new Error("FAT boundary crossed: "+Z+" 4 "+Q);if(!U[he]||(Z=rl(U[he],oe),se[Z]))break}ae[ue]={nodes:Ee,data:EE([ge])}}return ae}function w(U,re,J,Q,ne,ae,ye,Ee){for(var ge=0,be=Q.length?2:0,F=re[U].data,Z=0,ue=0,oe;Z<F.length;Z+=128){var se=F.slice(Z,Z+128);xn(se,64),ue=se.read_shift(2),oe=Tg(se,0,ue-be),Q.push(oe);var he={name:oe,type:se.read_shift(1),color:se.read_shift(1),L:se.read_shift(4,"i"),R:se.read_shift(4,"i"),C:se.read_shift(4,"i"),clsid:se.read_shift(16),state:se.read_shift(4,"i"),start:0,size:0},Se=se.read_shift(2)+se.read_shift(2)+se.read_shift(2)+se.read_shift(2);Se!==0&&(he.ct=k(se,se.l-8));var Ve=se.read_shift(2)+se.read_shift(2)+se.read_shift(2)+se.read_shift(2);Ve!==0&&(he.mt=k(se,se.l-8)),he.start=se.read_shift(4,"i"),he.size=se.read_shift(4,"i"),he.size<0&&he.start<0&&(he.size=he.type=0,he.start=z,he.name=""),he.type===5?(ge=he.start,ne>0&&ge!==z&&(re[ge].name="!StreamData")):he.size>=4096?(he.storage="fat",re[he.start]===void 0&&(re[he.start]=v(J,he.start,re.fat_addrs,re.ssz)),re[he.start].name=he.name,he.content=re[he.start].data.slice(0,he.size)):(he.storage="minifat",he.size<0?he.size=0:ge!==z&&he.start!==z&&re[ge]&&(he.content=g(he,re[ge].data,(re[Ee]||{}).data))),he.content&&xn(he.content,0),ae[oe]=he,ye.push(he)}}function k(U,re){return new Date((sn(U,re+4)/1e7*Math.pow(2,32)+sn(U,re)/1e7-11644473600)*1e3)}function S(U,re){return u(),d(c.readFileSync(U),re)}function _(U,re){var J=re&&re.type;switch(J||kt&&Buffer.isBuffer(U)&&(J="buffer"),J||"base64"){case"file":return S(U,re);case"base64":return d(_a(La(U)),re);case"binary":return d(_a(U),re)}return d(U,re)}function C(U,re){var J=re||{},Q=J.root||"Root Entry";if(U.FullPaths||(U.FullPaths=[]),U.FileIndex||(U.FileIndex=[]),U.FullPaths.length!==U.FileIndex.length)throw new Error("inconsistent CFB structure");U.FullPaths.length===0&&(U.FullPaths[0]=Q+"/",U.FileIndex[0]={name:Q,type:5}),J.CLSID&&(U.FileIndex[0].clsid=J.CLSID),E(U)}function E(U){var re="Sh33tJ5";if(!ct.find(U,"/"+re)){var J=_e(4);J[0]=55,J[1]=J[3]=50,J[2]=54,U.FileIndex.push({name:re,type:2,content:J,size:4,L:69,R:69,C:69}),U.FullPaths.push(U.FullPaths[0]+re),A(U)}}function A(U,re){C(U);for(var J=!1,Q=!1,ne=U.FullPaths.length-1;ne>=0;--ne){var ae=U.FileIndex[ne];switch(ae.type){case 0:Q?J=!0:(U.FileIndex.pop(),U.FullPaths.pop());break;case 1:case 2:case 5:Q=!0,isNaN(ae.R*ae.L*ae.C)&&(J=!0),ae.R>-1&&ae.L>-1&&ae.R==ae.L&&(J=!0);break;default:J=!0;break}}if(!(!J&&!re)){var ye=new Date(1987,1,19),Ee=0,ge=Object.create?Object.create(null):{},be=[];for(ne=0;ne<U.FullPaths.length;++ne)ge[U.FullPaths[ne]]=!0,U.FileIndex[ne].type!==0&&be.push([U.FullPaths[ne],U.FileIndex[ne]]);for(ne=0;ne<be.length;++ne){var F=n(be[ne][0]);Q=ge[F],Q||(be.push([F,{name:a(F).replace("/",""),type:1,clsid:L,ct:ye,mt:ye,content:null}]),ge[F]=!0)}for(be.sort(function(oe,se){return r(oe[0],se[0])}),U.FullPaths=[],U.FileIndex=[],ne=0;ne<be.length;++ne)U.FullPaths[ne]=be[ne][0],U.FileIndex[ne]=be[ne][1];for(ne=0;ne<be.length;++ne){var Z=U.FileIndex[ne],ue=U.FullPaths[ne];if(Z.name=a(ue).replace("/",""),Z.L=Z.R=Z.C=-(Z.color=1),Z.size=Z.content?Z.content.length:0,Z.start=0,Z.clsid=Z.clsid||L,ne===0)Z.C=be.length>1?1:-1,Z.size=0,Z.type=5;else if(ue.slice(-1)=="/"){for(Ee=ne+1;Ee<be.length&&n(U.FullPaths[Ee])!=ue;++Ee);for(Z.C=Ee>=be.length?-1:Ee,Ee=ne+1;Ee<be.length&&n(U.FullPaths[Ee])!=n(ue);++Ee);Z.R=Ee>=be.length?-1:Ee,Z.type=1}else n(U.FullPaths[ne+1]||"")==n(ue)&&(Z.R=ne+1),Z.type=2}}}function T(U,re){var J=re||{};if(J.fileType=="mad")return Ct(U,J);switch(A(U),J.fileType){case"zip":return Oe(U,J)}var Q=function(oe){for(var se=0,he=0,Se=0;Se<oe.FileIndex.length;++Se){var Ve=oe.FileIndex[Se];if(Ve.content){var Ze=Ve.content.length;Ze>0&&(Ze<4096?se+=Ze+63>>6:he+=Ze+511>>9)}}for(var ot=oe.FullPaths.length+3>>2,Et=se+7>>3,Bt=se+127>>7,Yt=Et+he+ot+Bt,Ir=Yt+127>>7,yi=Ir<=109?0:Math.ceil((Ir-109)/127);Yt+Ir+yi+127>>7>Ir;)yi=++Ir<=109?0:Math.ceil((Ir-109)/127);var Vn=[1,yi,Ir,Bt,ot,he,se,0];return oe.FileIndex[0].size=se<<6,Vn[7]=(oe.FileIndex[0].start=Vn[0]+Vn[1]+Vn[2]+Vn[3]+Vn[4]+Vn[5])+(Vn[6]+7>>3),Vn}(U),ne=_e(Q[7]<<9),ae=0,ye=0;{for(ae=0;ae<8;++ae)ne.write_shift(1,H[ae]);for(ae=0;ae<8;++ae)ne.write_shift(2,0);for(ne.write_shift(2,62),ne.write_shift(2,3),ne.write_shift(2,65534),ne.write_shift(2,9),ne.write_shift(2,6),ae=0;ae<3;++ae)ne.write_shift(2,0);for(ne.write_shift(4,0),ne.write_shift(4,Q[2]),ne.write_shift(4,Q[0]+Q[1]+Q[2]+Q[3]-1),ne.write_shift(4,0),ne.write_shift(4,4096),ne.write_shift(4,Q[3]?Q[0]+Q[1]+Q[2]-1:z),ne.write_shift(4,Q[3]),ne.write_shift(-4,Q[1]?Q[0]-1:z),ne.write_shift(4,Q[1]),ae=0;ae<109;++ae)ne.write_shift(-4,ae<Q[2]?Q[1]+ae:-1)}if(Q[1])for(ye=0;ye<Q[1];++ye){for(;ae<236+ye*127;++ae)ne.write_shift(-4,ae<Q[2]?Q[1]+ae:-1);ne.write_shift(-4,ye===Q[1]-1?z:ye+1)}var Ee=function(oe){for(ye+=oe;ae<ye-1;++ae)ne.write_shift(-4,ae+1);oe&&(++ae,ne.write_shift(-4,z))};for(ye=ae=0,ye+=Q[1];ae<ye;++ae)ne.write_shift(-4,W.DIFSECT);for(ye+=Q[2];ae<ye;++ae)ne.write_shift(-4,W.FATSECT);Ee(Q[3]),Ee(Q[4]);for(var ge=0,be=0,F=U.FileIndex[0];ge<U.FileIndex.length;++ge)F=U.FileIndex[ge],F.content&&(be=F.content.length,!(be<4096)&&(F.start=ye,Ee(be+511>>9)));for(Ee(Q[6]+7>>3);ne.l&511;)ne.write_shift(-4,W.ENDOFCHAIN);for(ye=ae=0,ge=0;ge<U.FileIndex.length;++ge)F=U.FileIndex[ge],F.content&&(be=F.content.length,!(!be||be>=4096)&&(F.start=ye,Ee(be+63>>6)));for(;ne.l&511;)ne.write_shift(-4,W.ENDOFCHAIN);for(ae=0;ae<Q[4]<<2;++ae){var Z=U.FullPaths[ae];if(!Z||Z.length===0){for(ge=0;ge<17;++ge)ne.write_shift(4,0);for(ge=0;ge<3;++ge)ne.write_shift(4,-1);for(ge=0;ge<12;++ge)ne.write_shift(4,0);continue}F=U.FileIndex[ae],ae===0&&(F.start=F.size?F.start-1:z);var ue=ae===0&&J.root||F.name;if(be=2*(ue.length+1),ne.write_shift(64,ue,"utf16le"),ne.write_shift(2,be),ne.write_shift(1,F.type),ne.write_shift(1,F.color),ne.write_shift(-4,F.L),ne.write_shift(-4,F.R),ne.write_shift(-4,F.C),F.clsid)ne.write_shift(16,F.clsid,"hex");else for(ge=0;ge<4;++ge)ne.write_shift(4,0);ne.write_shift(4,F.state||0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,F.start),ne.write_shift(4,F.size),ne.write_shift(4,0)}for(ae=1;ae<U.FileIndex.length;++ae)if(F=U.FileIndex[ae],F.size>=4096)if(ne.l=F.start+1<<9,kt&&Buffer.isBuffer(F.content))F.content.copy(ne,ne.l,0,F.size),ne.l+=F.size+511&-512;else{for(ge=0;ge<F.size;++ge)ne.write_shift(1,F.content[ge]);for(;ge&511;++ge)ne.write_shift(1,0)}for(ae=1;ae<U.FileIndex.length;++ae)if(F=U.FileIndex[ae],F.size>0&&F.size<4096)if(kt&&Buffer.isBuffer(F.content))F.content.copy(ne,ne.l,0,F.size),ne.l+=F.size+63&-64;else{for(ge=0;ge<F.size;++ge)ne.write_shift(1,F.content[ge]);for(;ge&63;++ge)ne.write_shift(1,0)}if(kt)ne.l=ne.length;else for(;ne.l<ne.length;)ne.write_shift(1,0);return ne}function D(U,re){var J=U.FullPaths.map(function(ge){return ge.toUpperCase()}),Q=J.map(function(ge){var be=ge.split("/");return be[be.length-(ge.slice(-1)=="/"?2:1)]}),ne=!1;re.charCodeAt(0)===47?(ne=!0,re=J[0].slice(0,-1)+re):ne=re.indexOf("/")!==-1;var ae=re.toUpperCase(),ye=ne===!0?J.indexOf(ae):Q.indexOf(ae);if(ye!==-1)return U.FileIndex[ye];var Ee=!ae.match(fd);for(ae=ae.replace(jn,""),Ee&&(ae=ae.replace(fd,"!")),ye=0;ye<J.length;++ye)if((Ee?J[ye].replace(fd,"!"):J[ye]).replace(jn,"")==ae||(Ee?Q[ye].replace(fd,"!"):Q[ye]).replace(jn,"")==ae)return U.FileIndex[ye];return null}var I=64,z=-2,X="d0cf11e0a1b11ae1",H=[208,207,17,224,161,177,26,225],L="00000000000000000000000000000000",W={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:z,FREESECT:-1,HEADER_SIGNATURE:X,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:L,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ie(U,re,J){u();var Q=T(U,J);c.writeFileSync(re,Q)}function B(U){for(var re=new Array(U.length),J=0;J<U.length;++J)re[J]=String.fromCharCode(U[J]);return re.join("")}function ee(U,re){var J=T(U,re);switch(re&&re.type||"buffer"){case"file":return u(),c.writeFileSync(re.filename,J),J;case"binary":return typeof J=="string"?J:B(J);case"base64":return df(typeof J=="string"?J:B(J));case"buffer":if(kt)return Buffer.isBuffer(J)?J:qs(J);case"array":return typeof J=="string"?_a(J):J}return J}var le;function R(U){try{var re=U.InflateRaw,J=new re;if(J._processChunk(new Uint8Array([3,0]),J._finishFlushFlag),J.bytesRead)le=U;else throw new Error("zlib does not expose bytesRead")}catch(Q){console.error("cannot use native zlib: "+(Q.message||Q))}}function j(U,re){if(!le)return fe(U,re);var J=le.InflateRaw,Q=new J,ne=Q._processChunk(U.slice(U.l),Q._finishFlushFlag);return U.l+=Q.bytesRead,ne}function V(U){return le?le.deflateRawSync(U):He(U)}var P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],O=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function K(U){var re=(U<<1|U<<11)&139536|(U<<5|U<<15)&558144;return(re>>16|re>>8|re)&255}for(var G=typeof Uint8Array<"u",te=G?new Uint8Array(256):[],ce=0;ce<256;++ce)te[ce]=K(ce);function M(U,re){var J=te[U&255];return re<=8?J>>>8-re:(J=J<<8|te[U>>8&255],re<=16?J>>>16-re:(J=J<<8|te[U>>16&255],J>>>24-re))}function Le(U,re){var J=re&7,Q=re>>>3;return(U[Q]|(J<=6?0:U[Q+1]<<8))>>>J&3}function Te(U,re){var J=re&7,Q=re>>>3;return(U[Q]|(J<=5?0:U[Q+1]<<8))>>>J&7}function je(U,re){var J=re&7,Q=re>>>3;return(U[Q]|(J<=4?0:U[Q+1]<<8))>>>J&15}function ze(U,re){var J=re&7,Q=re>>>3;return(U[Q]|(J<=3?0:U[Q+1]<<8))>>>J&31}function Ce(U,re){var J=re&7,Q=re>>>3;return(U[Q]|(J<=1?0:U[Q+1]<<8))>>>J&127}function de(U,re,J){var Q=re&7,ne=re>>>3,ae=(1<<J)-1,ye=U[ne]>>>Q;return J<8-Q||(ye|=U[ne+1]<<8-Q,J<16-Q)||(ye|=U[ne+2]<<16-Q,J<24-Q)||(ye|=U[ne+3]<<24-Q),ye&ae}function $e(U,re,J){var Q=re&7,ne=re>>>3;return Q<=5?U[ne]|=(J&7)<<Q:(U[ne]|=J<<Q&255,U[ne+1]=(J&7)>>8-Q),re+3}function Re(U,re,J){var Q=re&7,ne=re>>>3;return J=(J&1)<<Q,U[ne]|=J,re+1}function Fe(U,re,J){var Q=re&7,ne=re>>>3;return J<<=Q,U[ne]|=J&255,J>>>=8,U[ne+1]=J,re+8}function Me(U,re,J){var Q=re&7,ne=re>>>3;return J<<=Q,U[ne]|=J&255,J>>>=8,U[ne+1]=J&255,U[ne+2]=J>>>8,re+16}function Ge(U,re){var J=U.length,Q=2*J>re?2*J:re+5,ne=0;if(J>=re)return U;if(kt){var ae=lE(Q);if(U.copy)U.copy(ae);else for(;ne<U.length;++ne)ae[ne]=U[ne];return ae}else if(G){var ye=new Uint8Array(Q);if(ye.set)ye.set(U);else for(;ne<J;++ne)ye[ne]=U[ne];return ye}return U.length=Q,U}function Qe(U){for(var re=new Array(U),J=0;J<U;++J)re[J]=0;return re}function we(U,re,J){var Q=1,ne=0,ae=0,ye=0,Ee=0,ge=U.length,be=G?new Uint16Array(32):Qe(32);for(ae=0;ae<32;++ae)be[ae]=0;for(ae=ge;ae<J;++ae)U[ae]=0;ge=U.length;var F=G?new Uint16Array(ge):Qe(ge);for(ae=0;ae<ge;++ae)be[ne=U[ae]]++,Q<ne&&(Q=ne),F[ae]=0;for(be[0]=0,ae=1;ae<=Q;++ae)be[ae+16]=Ee=Ee+be[ae-1]<<1;for(ae=0;ae<ge;++ae)Ee=U[ae],Ee!=0&&(F[ae]=be[Ee+16]++);var Z=0;for(ae=0;ae<ge;++ae)if(Z=U[ae],Z!=0)for(Ee=M(F[ae],Q)>>Q-Z,ye=(1<<Q+4-Z)-1;ye>=0;--ye)re[Ee|ye<<Z]=Z&15|ae<<4;return Q}var pe=G?new Uint16Array(512):Qe(512),me=G?new Uint16Array(32):Qe(32);if(!G){for(var Ae=0;Ae<512;++Ae)pe[Ae]=0;for(Ae=0;Ae<32;++Ae)me[Ae]=0}(function(){for(var U=[],re=0;re<32;re++)U.push(5);we(U,me,32);var J=[];for(re=0;re<=143;re++)J.push(8);for(;re<=255;re++)J.push(9);for(;re<=279;re++)J.push(7);for(;re<=287;re++)J.push(8);we(J,pe,288)})();var Ke=function(){for(var re=G?new Uint8Array(32768):[],J=0,Q=0;J<O.length-1;++J)for(;Q<O[J+1];++Q)re[Q]=J;for(;Q<32768;++Q)re[Q]=29;var ne=G?new Uint8Array(259):[];for(J=0,Q=0;J<q.length-1;++J)for(;Q<q[J+1];++Q)ne[Q]=J;function ae(Ee,ge){for(var be=0;be<Ee.length;){var F=Math.min(65535,Ee.length-be),Z=be+F==Ee.length;for(ge.write_shift(1,+Z),ge.write_shift(2,F),ge.write_shift(2,~F&65535);F-- >0;)ge[ge.l++]=Ee[be++]}return ge.l}function ye(Ee,ge){for(var be=0,F=0,Z=G?new Uint16Array(32768):[];F<Ee.length;){var ue=Math.min(65535,Ee.length-F);if(ue<10){for(be=$e(ge,be,+(F+ue==Ee.length)),be&7&&(be+=8-(be&7)),ge.l=be/8|0,ge.write_shift(2,ue),ge.write_shift(2,~ue&65535);ue-- >0;)ge[ge.l++]=Ee[F++];be=ge.l*8;continue}be=$e(ge,be,+(F+ue==Ee.length)+2);for(var oe=0;ue-- >0;){var se=Ee[F];oe=(oe<<5^se)&32767;var he=-1,Se=0;if((he=Z[oe])&&(he|=F&-32768,he>F&&(he-=32768),he<F))for(;Ee[he+Se]==Ee[F+Se]&&Se<250;)++Se;if(Se>2){se=ne[Se],se<=22?be=Fe(ge,be,te[se+1]>>1)-1:(Fe(ge,be,3),be+=5,Fe(ge,be,te[se-23]>>5),be+=3);var Ve=se<8?0:se-4>>2;Ve>0&&(Me(ge,be,Se-q[se]),be+=Ve),se=re[F-he],be=Fe(ge,be,te[se]>>3),be-=3;var Ze=se<4?0:se-2>>1;Ze>0&&(Me(ge,be,F-he-O[se]),be+=Ze);for(var ot=0;ot<Se;++ot)Z[oe]=F&32767,oe=(oe<<5^Ee[F])&32767,++F;ue-=Se-1}else se<=143?se=se+48:be=Re(ge,be,1),be=Fe(ge,be,te[se]),Z[oe]=F&32767,++F}be=Fe(ge,be,0)-1}return ge.l=(be+7)/8|0,ge.l}return function(ge,be){return ge.length<8?ae(ge,be):ye(ge,be)}}();function He(U){var re=_e(50+Math.floor(U.length*1.1)),J=Ke(U,re);return re.slice(0,J)}var qe=G?new Uint16Array(32768):Qe(32768),xt=G?new Uint16Array(32768):Qe(32768),dt=G?new Uint16Array(128):Qe(128),Y=1,ve=1;function Je(U,re){var J=ze(U,re)+257;re+=5;var Q=ze(U,re)+1;re+=5;var ne=je(U,re)+4;re+=4;for(var ae=0,ye=G?new Uint8Array(19):Qe(19),Ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ge=1,be=G?new Uint8Array(8):Qe(8),F=G?new Uint8Array(8):Qe(8),Z=ye.length,ue=0;ue<ne;++ue)ye[P[ue]]=ae=Te(U,re),ge<ae&&(ge=ae),be[ae]++,re+=3;var oe=0;for(be[0]=0,ue=1;ue<=ge;++ue)F[ue]=oe=oe+be[ue-1]<<1;for(ue=0;ue<Z;++ue)(oe=ye[ue])!=0&&(Ee[ue]=F[oe]++);var se=0;for(ue=0;ue<Z;++ue)if(se=ye[ue],se!=0){oe=te[Ee[ue]]>>8-se;for(var he=(1<<7-se)-1;he>=0;--he)dt[oe|he<<se]=se&7|ue<<3}var Se=[];for(ge=1;Se.length<J+Q;)switch(oe=dt[Ce(U,re)],re+=oe&7,oe>>>=3){case 16:for(ae=3+Le(U,re),re+=2,oe=Se[Se.length-1];ae-- >0;)Se.push(oe);break;case 17:for(ae=3+Te(U,re),re+=3;ae-- >0;)Se.push(0);break;case 18:for(ae=11+Ce(U,re),re+=7;ae-- >0;)Se.push(0);break;default:Se.push(oe),ge<oe&&(ge=oe);break}var Ve=Se.slice(0,J),Ze=Se.slice(J);for(ue=J;ue<286;++ue)Ve[ue]=0;for(ue=Q;ue<30;++ue)Ze[ue]=0;return Y=we(Ve,qe,286),ve=we(Ze,xt,30),re}function pt(U,re){if(U[0]==3&&!(U[1]&3))return[Do(re),2];for(var J=0,Q=0,ne=lE(re||1<<18),ae=0,ye=ne.length>>>0,Ee=0,ge=0;!(Q&1);){if(Q=Te(U,J),J+=3,Q>>>1)Q>>1==1?(Ee=9,ge=5):(J=Je(U,J),Ee=Y,ge=ve);else{J&7&&(J+=8-(J&7));var be=U[J>>>3]|U[(J>>>3)+1]<<8;if(J+=32,be>0)for(!re&&ye<ae+be&&(ne=Ge(ne,ae+be),ye=ne.length);be-- >0;)ne[ae++]=U[J>>>3],J+=8;continue}for(;;){!re&&ye<ae+32767&&(ne=Ge(ne,ae+32767),ye=ne.length);var F=de(U,J,Ee),Z=Q>>>1==1?pe[F]:qe[F];if(J+=Z&15,Z>>>=4,!(Z>>>8&255))ne[ae++]=Z;else{if(Z==256)break;Z-=257;var ue=Z<8?0:Z-4>>2;ue>5&&(ue=0);var oe=ae+q[Z];ue>0&&(oe+=de(U,J,ue),J+=ue),F=de(U,J,ge),Z=Q>>>1==1?me[F]:xt[F],J+=Z&15,Z>>>=4;var se=Z<4?0:Z-2>>1,he=O[Z];for(se>0&&(he+=de(U,J,se),J+=se),!re&&ye<oe&&(ne=Ge(ne,oe+100),ye=ne.length);ae<oe;)ne[ae]=ne[ae-he],++ae}}}return re?[ne,J+7>>>3]:[ne.slice(0,ae),J+7>>>3]}function fe(U,re){var J=U.slice(U.l||0),Q=pt(J,re);return U.l+=Q[1],Q[0]}function De(U,re){if(U)typeof console<"u"&&console.error(re);else throw new Error(re)}function Ie(U,re){var J=U;xn(J,0);var Q=[],ne=[],ae={FileIndex:Q,FullPaths:ne};C(ae,{root:re.root});for(var ye=J.length-4;(J[ye]!=80||J[ye+1]!=75||J[ye+2]!=5||J[ye+3]!=6)&&ye>=0;)--ye;J.l=ye+4,J.l+=4;var Ee=J.read_shift(2);J.l+=6;var ge=J.read_shift(4);for(J.l=ge,ye=0;ye<Ee;++ye){J.l+=20;var be=J.read_shift(4),F=J.read_shift(4),Z=J.read_shift(2),ue=J.read_shift(2),oe=J.read_shift(2);J.l+=8;var se=J.read_shift(4),he=o(J.slice(J.l+Z,J.l+Z+ue));J.l+=Z+ue+oe;var Se=J.l;J.l=se+4,Ye(J,be,F,ae,he),J.l=Se}return ae}function Ye(U,re,J,Q,ne){U.l+=2;var ae=U.read_shift(2),ye=U.read_shift(2),Ee=s(U);if(ae&8257)throw new Error("Unsupported ZIP encryption");for(var ge=U.read_shift(4),be=U.read_shift(4),F=U.read_shift(4),Z=U.read_shift(2),ue=U.read_shift(2),oe="",se=0;se<Z;++se)oe+=String.fromCharCode(U[U.l++]);if(ue){var he=o(U.slice(U.l,U.l+ue));(he[21589]||{}).mt&&(Ee=he[21589].mt),((ne||{})[21589]||{}).mt&&(Ee=ne[21589].mt)}U.l+=ue;var Se=U.slice(U.l,U.l+be);switch(ye){case 8:Se=j(U,F);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ye)}var Ve=!1;ae&8&&(ge=U.read_shift(4),ge==134695760&&(ge=U.read_shift(4),Ve=!0),be=U.read_shift(4),F=U.read_shift(4)),be!=re&&De(Ve,"Bad compressed size: "+re+" != "+be),F!=J&&De(Ve,"Bad uncompressed size: "+J+" != "+F),Gn(Q,oe,Se,{unsafe:!0,mt:Ee})}function Oe(U,re){var J=re||{},Q=[],ne=[],ae=_e(1),ye=J.compression?8:0,Ee=0,ge=0,be=0,F=0,Z=0,ue=U.FullPaths[0],oe=ue,se=U.FileIndex[0],he=[],Se=0;for(ge=1;ge<U.FullPaths.length;++ge)if(oe=U.FullPaths[ge].slice(ue.length),se=U.FileIndex[ge],!(!se.size||!se.content||oe=="Sh33tJ5")){var Ve=F,Ze=_e(oe.length);for(be=0;be<oe.length;++be)Ze.write_shift(1,oe.charCodeAt(be)&127);Ze=Ze.slice(0,Ze.l),he[Z]=lte.buf(se.content,0);var ot=se.content;ye==8&&(ot=V(ot)),ae=_e(30),ae.write_shift(4,67324752),ae.write_shift(2,20),ae.write_shift(2,Ee),ae.write_shift(2,ye),se.mt?i(ae,se.mt):ae.write_shift(4,0),ae.write_shift(-4,he[Z]),ae.write_shift(4,ot.length),ae.write_shift(4,se.content.length),ae.write_shift(2,Ze.length),ae.write_shift(2,0),F+=ae.length,Q.push(ae),F+=Ze.length,Q.push(Ze),F+=ot.length,Q.push(ot),ae=_e(46),ae.write_shift(4,33639248),ae.write_shift(2,0),ae.write_shift(2,20),ae.write_shift(2,Ee),ae.write_shift(2,ye),ae.write_shift(4,0),ae.write_shift(-4,he[Z]),ae.write_shift(4,ot.length),ae.write_shift(4,se.content.length),ae.write_shift(2,Ze.length),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(4,0),ae.write_shift(4,Ve),Se+=ae.l,ne.push(ae),Se+=Ze.length,ne.push(Ze),++Z}return ae=_e(22),ae.write_shift(4,101010256),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,Z),ae.write_shift(2,Z),ae.write_shift(4,Se),ae.write_shift(4,F),ae.write_shift(2,0),on([on(Q),on(ne),ae])}var at={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Gr(U,re){if(U.ctype)return U.ctype;var J=U.name||"",Q=J.match(/\.([^\.]+)$/);return Q&&at[Q[1]]||re&&(Q=(J=re).match(/[\.\\]([^\.\\])+$/),Q&&at[Q[1]])?at[Q[1]]:"application/octet-stream"}function Nr(U){for(var re=df(U),J=[],Q=0;Q<re.length;Q+=76)J.push(re.slice(Q,Q+76));return J.join(`\r
`)+`\r
`}function xi(U){var re=U.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(be){var F=be.charCodeAt(0).toString(16).toUpperCase();return"="+(F.length==1?"0"+F:F)});re=re.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),re.charAt(0)==`
`&&(re="=0D"+re.slice(1)),re=re.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var J=[],Q=re.split(`\r
`),ne=0;ne<Q.length;++ne){var ae=Q[ne];if(ae.length==0){J.push("");continue}for(var ye=0;ye<ae.length;){var Ee=76,ge=ae.slice(ye,ye+Ee);ge.charAt(Ee-1)=="="?Ee--:ge.charAt(Ee-2)=="="?Ee-=2:ge.charAt(Ee-3)=="="&&(Ee-=3),ge=ae.slice(ye,ye+Ee),ye+=Ee,ye<ae.length&&(ge+="="),J.push(ge)}}return J.join(`\r
`)}function d0(U){for(var re=[],J=0;J<U.length;++J){for(var Q=U[J];J<=U.length&&Q.charAt(Q.length-1)=="=";)Q=Q.slice(0,Q.length-1)+U[++J];re.push(Q)}for(var ne=0;ne<re.length;++ne)re[ne]=re[ne].replace(/[=][0-9A-Fa-f]{2}/g,function(ae){return String.fromCharCode(parseInt(ae.slice(1),16))});return _a(re.join(`\r
`))}function Ko(U,re,J){for(var Q="",ne="",ae="",ye,Ee=0;Ee<10;++Ee){var ge=re[Ee];if(!ge||ge.match(/^\s*$/))break;var be=ge.match(/^(.*?):\s*([^\s].*)$/);if(be)switch(be[1].toLowerCase()){case"content-location":Q=be[2].trim();break;case"content-type":ae=be[2].trim();break;case"content-transfer-encoding":ne=be[2].trim();break}}switch(++Ee,ne.toLowerCase()){case"base64":ye=_a(La(re.slice(Ee).join("")));break;case"quoted-printable":ye=d0(re.slice(Ee));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ne)}var F=Gn(U,Q.slice(J.length),ye,{unsafe:!0});ae&&(F.ctype=ae)}function Lt(U,re){if(B(U.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var J=re&&re.root||"",Q=(kt&&Buffer.isBuffer(U)?U.toString("binary"):B(U)).split(`\r
`),ne=0,ae="";for(ne=0;ne<Q.length;++ne)if(ae=Q[ne],!!/^Content-Location:/i.test(ae)&&(ae=ae.slice(ae.indexOf("file")),J||(J=ae.slice(0,ae.lastIndexOf("/")+1)),ae.slice(0,J.length)!=J))for(;J.length>0&&(J=J.slice(0,J.length-1),J=J.slice(0,J.lastIndexOf("/")+1),ae.slice(0,J.length)!=J););var ye=(Q[1]||"").match(/boundary="(.*?)"/);if(!ye)throw new Error("MAD cannot find boundary");var Ee="--"+(ye[1]||""),ge=[],be=[],F={FileIndex:ge,FullPaths:be};C(F);var Z,ue=0;for(ne=0;ne<Q.length;++ne){var oe=Q[ne];oe!==Ee&&oe!==Ee+"--"||(ue++&&Ko(F,Q.slice(Z,ne),J),Z=ne)}return F}function Ct(U,re){var J=re||{},Q=J.boundary||"SheetJS";Q="------="+Q;for(var ne=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Q.slice(2)+'"',"","",""],ae=U.FullPaths[0],ye=ae,Ee=U.FileIndex[0],ge=1;ge<U.FullPaths.length;++ge)if(ye=U.FullPaths[ge].slice(ae.length),Ee=U.FileIndex[ge],!(!Ee.size||!Ee.content||ye=="Sh33tJ5")){ye=ye.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Se){return"_x"+Se.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Se){return"_u"+Se.charCodeAt(0).toString(16)+"_"});for(var be=Ee.content,F=kt&&Buffer.isBuffer(be)?be.toString("binary"):B(be),Z=0,ue=Math.min(1024,F.length),oe=0,se=0;se<=ue;++se)(oe=F.charCodeAt(se))>=32&&oe<128&&++Z;var he=Z>=ue*4/5;ne.push(Q),ne.push("Content-Location: "+(J.root||"file:///C:/SheetJS/")+ye),ne.push("Content-Transfer-Encoding: "+(he?"quoted-printable":"base64")),ne.push("Content-Type: "+Gr(Ee,ye)),ne.push(""),ne.push(he?xi(F):Nr(F))}return ne.push(Q+`--\r
`),ne.join(`\r
`)}function rc(U){var re={};return C(re,U),re}function Gn(U,re,J,Q){var ne=Q&&Q.unsafe;ne||C(U);var ae=!ne&&ct.find(U,re);if(!ae){var ye=U.FullPaths[0];re.slice(0,ye.length)==ye?ye=re:(ye.slice(-1)!="/"&&(ye+="/"),ye=(ye+re).replace("//","/")),ae={name:a(re),type:2},U.FileIndex.push(ae),U.FullPaths.push(ye),ne||ct.utils.cfb_gc(U)}return ae.content=J,ae.size=J?J.length:0,Q&&(Q.CLSID&&(ae.clsid=Q.CLSID),Q.mt&&(ae.mt=Q.mt),Q.ct&&(ae.ct=Q.ct)),ae}function za(U,re){C(U);var J=ct.find(U,re);if(J){for(var Q=0;Q<U.FileIndex.length;++Q)if(U.FileIndex[Q]==J)return U.FileIndex.splice(Q,1),U.FullPaths.splice(Q,1),!0}return!1}function Sn(U,re,J){C(U);var Q=ct.find(U,re);if(Q){for(var ne=0;ne<U.FileIndex.length;++ne)if(U.FileIndex[ne]==Q)return U.FileIndex[ne].name=a(J),U.FullPaths[ne]=J,!0}return!1}function Mu(U){A(U,!0)}return t.find=D,t.read=_,t.parse=d,t.write=ee,t.writeFile=ie,t.utils={cfb_new:rc,cfb_add:Gn,cfb_del:za,cfb_mov:Sn,cfb_gc:Mu,ReadShift:_d,CheckField:pI,prep_blob:xn,bconcat:on,use_zlib:R,_deflateRaw:He,_inflateRaw:fe,consts:W},t}();let ho;function cte(e){ho=e}function ute(e){return typeof e=="string"?r0(e):Array.isArray(e)?Fee(e):e}function a0(e,t,r){if(typeof ho<"u"&&ho.writeFileSync)return r?ho.writeFileSync(e,t,r):ho.writeFileSync(e,t);if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=r0(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Xi(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([ute(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Wo(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function dte(e){if(typeof ho<"u")return ho.readFileSync(e);if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Ar(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function gE(e,t){for(var r=[],n=Ar(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function Cg(e){for(var t=[],r=Ar(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Eg(e){for(var t=[],r=Ar(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function fte(e){for(var t=[],r=Ar(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Km=new Date(1899,11,30,0,0,0);function Jr(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var n=Km.getTime()+(e.getTimezoneOffset()-Km.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var JD=new Date,hte=Km.getTime()+(JD.getTimezoneOffset()-Km.getTimezoneOffset())*6e4,xE=JD.getTimezoneOffset();function Ag(e){var t=new Date;return t.setTime(e*24*60*60*1e3+hte),t.getTimezoneOffset()!==xE&&t.setTime(t.getTime()+(t.getTimezoneOffset()-xE)*6e4),t}function mte(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var yE=new Date("2017-02-19T19:06:09.000Z"),QD=isNaN(yE.getFullYear())?new Date("2/19/17"):yE,pte=QD.getFullYear()==2017;function or(e,t){var r=new Date(e);if(pte)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(QD.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function jl(e,t){if(kt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Xi(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Xi(BD(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Xi(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Xi(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"â‚¬":"Â€","â€š":"Â‚",Æ’:"Âƒ","â€ž":"Â„","â€¦":"Â…","â€ ":"Â†","â€¡":"Â‡","Ë†":"Âˆ","â€°":"Â‰",Å :"ÂŠ","â€¹":"Â‹",Å’:"ÂŒ",Å½:"ÂŽ","â€˜":"Â‘","â€™":"Â’","â€œ":"Â“","â€":"Â”","â€¢":"Â•","â€“":"Â–","â€”":"Â—","Ëœ":"Â˜","â„¢":"Â™",Å¡:"Âš","â€º":"Â›",Å“:"Âœ",Å¾:"Âž",Å¸:"ÂŸ"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[â‚¬â€šÆ’â€žâ€¦â€ â€¡Ë†â€°Å â€¹Å’Å½â€˜â€™â€œâ€â€¢â€“â€”Ëœâ„¢Å¡â€ºÅ“Å¾Å¸]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function qt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=qt(e[r]));return t}function Sr(e,t){for(var r="";r.length<t;)r+=e;return r}function Ri(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var gte=["january","february","march","april","may","june","july","august","september","october","november","december"];function uu(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&gte.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var xte=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),s=[i[0]],o=1;o<i.length;++o)s.push(a),s.push(i[o]);return s}}();function ZD(e){return e?e.content&&e.type?jl(e.content,!0):e.data?Oc(e.data):e.asNodeBuffer&&kt?Oc(e.asNodeBuffer().toString("binary")):e.asBinary?Oc(e.asBinary()):e._data&&e._data.getContent?Oc(jl(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function eI(e){if(!e)return null;if(e.data)return Hm(e.data);if(e.asNodeBuffer&&kt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Hm(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function yte(e){return e&&e.name.slice(-4)===".bin"?eI(e):ZD(e)}function Qa(e,t){for(var r=e.FullPaths||Ar(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var s=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function R2(e,t){var r=Qa(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Fr(e,t,r){if(!r)return yte(R2(e,t));if(!t)return null;try{return Fr(e,t)}catch{return null}}function Ca(e,t,r){if(!r)return ZD(R2(e,t));if(!t)return null;try{return Ca(e,t)}catch{return null}}function tI(e,t,r){if(!r)return eI(R2(e,t));if(!t)return null;try{return tI(e,t)}catch{return null}}function vE(e){for(var t=e.FullPaths||Ar(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function wt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return kt?n=qs(r):n=Mee(r),ct.utils.cfb_add(e,t,n)}ct.utils.cfb_add(e,t,r)}else e.file(t,r)}function F2(){return ct.utils.cfb_new()}function rI(e,t){switch(t.type){case"base64":return ct.read(e,{type:"base64"});case"binary":return ct.read(e,{type:"binary"});case"buffer":case"array":return ct.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function hd(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Dr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,vte=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,bE=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,bte=/<[^>]*>/g,Wn=Dr.match(bE)?bE:bte,wte=/<\w*:/,Nte=/<(\/?)\w+:/;function mt(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var s=e.match(vte),o=0,c="",u=0,d="",f="",m=1;if(s)for(u=0;u!=s.length;++u){for(f=s[u],i=0;i!=f.length&&f.charCodeAt(i)!==61;++i);for(d=f.slice(0,i).trim();f.charCodeAt(i+1)==32;)++i;for(m=(a=f.charCodeAt(i+1))==34||a==39?1:0,c=f.slice(i+1+m,f.length-m),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=c,r||(n[d.toLowerCase()]=c);else{var p=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[p]&&d.slice(o-3,o)=="ext")continue;n[p]=c,r||(n[p.toLowerCase()]=c)}}return n}function ss(e){return e.replace(Nte,"<$1")}var nI={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},M2=Cg(nI),It=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(o,c){return nI[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var s=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,s)+r(a.slice(s+3))}}(),L2=/[&<>'"]/g,kte=/[\u0000-\u0008\u000b-\u001f]/g;function Ht(e){var t=e+"";return t.replace(L2,function(r){return M2[r]}).replace(kte,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function wE(e){return Ht(e).replace(/ /g,"_x0020_")}var aI=/[\u0000-\u001f]/g;function B2(e){var t=e+"";return t.replace(L2,function(r){return M2[r]}).replace(/\n/g,"<br/>").replace(aI,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Ste(e){var t=e+"";return t.replace(L2,function(r){return M2[r]}).replace(aI,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var NE=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function _te(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function ar(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function $x(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function kE(e){var t=Do(2*e.length),r,n,a=1,i=0,s=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function SE(e){return qs(e,"binary").toString("utf8")}var Y0="foo bar bazÃ¢Â˜ÂƒÃ°ÂŸÂÂ£",Vt=kt&&(SE(Y0)==$x(Y0)&&SE||kE(Y0)==$x(Y0)&&kE)||$x,Xi=kt?function(e){return qs(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},hf=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),iI=function(){var e=[["nbsp"," "],["middot","Â·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),Cte=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Ete=/<\/?(?:vt:)?variant>/g,Ate=/<(?:vt:)([^>]*)>([\s\S]*)</;function _E(e,t){var r=mt(e),n=e.match(Cte(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var s=i.replace(Ete,"").match(Ate);s&&a.push({v:Vt(s[2]),t:s[1]})}),a}var sI=/(^\s|\s$|\n)/;function yn(e,t){return"<"+e+(t.match(sI)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function mf(e){return Ar(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ue(e,t,r){return"<"+e+(r!=null?mf(r):"")+(t!=null?(t.match(sI)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Qv(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function Tte(e,t){switch(typeof e){case"string":var r=Ue("vt:lpwstr",Ht(e));return t&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return Ue((e|0)==e?"vt:i4":"vt:r8",Ht(String(e)));case"boolean":return Ue("vt:bool",e?"true":"false")}if(e instanceof Date)return Ue("vt:filetime",Qv(e));throw new Error("Unable to serialize "+e)}function j2(e){if(kt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Vt(Wo(O2(e)));throw new Error("Bad input format: expected Buffer or string")}var pf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,qr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Yl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Na={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Pte(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function Ote(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var CE=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},EE=kt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:qs(t)})):CE(e)}:CE,AE=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Ns(e,a)));return n.join("").replace(jn,"")},Tg=kt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(jn,""):AE(e,t,r)}:AE,TE=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},oI=kt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):TE(e,t,r)}:TE,PE=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(pc(e,a)));return n.join("")},Iu=kt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):PE(t,r,n)}:PE,lI=function(e,t){var r=sn(e,t);return r>0?Iu(e,t+4,t+4+r-1):""},$2=lI,cI=function(e,t){var r=sn(e,t);return r>0?Iu(e,t+4,t+4+r-1):""},U2=cI,uI=function(e,t){var r=2*sn(e,t);return r>0?Iu(e,t+4,t+4+r-1):""},z2=uI,dI=function(t,r){var n=sn(t,r);return n>0?Tg(t,r+4,r+4+n):""},H2=dI,fI=function(e,t){var r=sn(e,t);return r>0?Iu(e,t+4,t+4+r):""},W2=fI,hI=function(e,t){return Pte(e,t)},qm=hI,G2=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};kt&&($2=function(t,r){if(!Buffer.isBuffer(t))return lI(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},U2=function(t,r){if(!Buffer.isBuffer(t))return cI(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},z2=function(t,r){if(!Buffer.isBuffer(t))return uI(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},H2=function(t,r){if(!Buffer.isBuffer(t))return dI(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},W2=function(t,r){if(!Buffer.isBuffer(t))return fI(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},qm=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):hI(t,r)},G2=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});function mI(){Tg=function(e,t,r){return Pt.utils.decode(1200,e.slice(t,r)).replace(jn,"")},Iu=function(e,t,r){return Pt.utils.decode(65001,e.slice(t,r))},$2=function(e,t){var r=sn(e,t);return r>0?Pt.utils.decode(Ll,e.slice(t+4,t+4+r-1)):""},U2=function(e,t){var r=sn(e,t);return r>0?Pt.utils.decode(Da,e.slice(t+4,t+4+r-1)):""},z2=function(e,t){var r=2*sn(e,t);return r>0?Pt.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},H2=function(e,t){var r=sn(e,t);return r>0?Pt.utils.decode(1200,e.slice(t+4,t+4+r)):""},W2=function(e,t){var r=sn(e,t);return r>0?Pt.utils.decode(65001,e.slice(t+4,t+4+r)):""}}typeof Pt<"u"&&mI();var pc=function(e,t){return e[t]},Ns=function(e,t){return e[t+1]*256+e[t]},Dte=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},sn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},rl=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Ite=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function _d(e,t){var r="",n,a,i=[],s,o,c,u;switch(t){case"dbcs":if(u=this.l,kt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Ns(this,u)),u+=2;e*=2;break;case"utf8":r=Iu(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Tg(this,this.l,this.l+e);break;case"wstr":if(typeof Pt<"u")r=Pt.utils.decode(Da,this.slice(this.l,this.l+2*e));else return _d.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":r=$2(this,this.l),e=4+sn(this,this.l);break;case"lpstr-cp":r=U2(this,this.l),e=4+sn(this,this.l);break;case"lpwstr":r=z2(this,this.l),e=4+2*sn(this,this.l);break;case"lpp4":e=4+sn(this,this.l),r=H2(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+sn(this,this.l),r=W2(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=pc(this,this.l+e++))!==0;)i.push(dd(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=Ns(this,this.l+e))!==0;)i.push(dd(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return s=pc(this,u),this.l=u+1,o=_d.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(dd(Ns(this,u))),u+=2}r=i.join(""),e*=2;break;case"cpstr":if(typeof Pt<"u"){r=Pt.utils.decode(Da,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return s=pc(this,u),this.l=u+1,o=_d.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(dd(pc(this,u))),u+=1}r=i.join("");break;default:switch(e){case 1:return n=pc(this,this.l),this.l++,n;case 2:return n=(t==="i"?Dte:Ns)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?rl:Ite)(this,this.l),this.l+=4,n):(a=sn(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=qm(this,this.l):a=qm([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=oI(this,this.l,e);break}}return this.l+=e,r}var Rte=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Fte=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Mte=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Lte(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)Mte(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){if(typeof Pt<"u"&&Ll==874)for(a=0;a!=t.length;++a){var i=Pt.utils.encode(Ll,t.charAt(a));this[this.l+a]=i[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,Rte(this,t,this.l);break;case 8:if(n=8,r==="f"){Ote(this,t,this.l);break}case 16:break;case-4:n=4,Fte(this,t,this.l);break}return this.l+=n,this}function pI(e,t){var r=oI(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function xn(e,t){e.l=t,e.read_shift=_d,e.chk=pI,e.write_shift=Lte}function Hn(e,t){e.l+=t}function _e(e){var t=Do(e);return xn(t,0),t}function Xs(e,t,r){if(e){var n,a,i;xn(e,e.l||0);for(var s=e.length,o=0,c=0;e.l<s;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=wf[o]||wf[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;c=e.l+i;var d=u.f&&u.f(e,i,r);if(e.l=c,t(d,u,o))return}}}function pa(){var e=[],t=kt?256:2048,r=function(u){var d=_e(u);return xn(d,0),d},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,t)))},s=function(){return a(),on(e)},o=function(u){a(),n=u,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:o,end:s,_bufs:e}}function Pe(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=wf[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=e.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,(a&127)+128),s.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&G2(r)&&e.push(r)}}function Cd(e,t,r){var n=qt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function OE(e,t,r){var n=qt(e);return n.s=Cd(n.s,t.s,r),n.e=Cd(n.e,t.s,r),n}function Ed(e,t){if(e.cRel&&e.c<0)for(e=qt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=qt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=ht(e);return!e.cRel&&e.cRel!=null&&(r=$te(r)),!e.rRel&&e.rRel!=null&&(r=Bte(r)),r}function Ux(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+sr(e.s.c)+":"+(e.e.cRel?"":"$")+sr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Cr(e.s.r)+":"+(e.e.rRel?"":"$")+Cr(e.e.r):Ed(e.s,t.biff)+":"+Ed(e.e,t.biff)}function V2(e){return parseInt(jte(e),10)-1}function Cr(e){return""+(e+1)}function Bte(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function jte(e){return e.replace(/\$(\d+)$/,"$1")}function K2(e){for(var t=Ute(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function sr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function $te(e){return e.replace(/^([A-Z])/,"$$$1")}function Ute(e){return e.replace(/^\$([A-Z])/,"$1")}function zte(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function yr(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function ht(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function ta(e){var t=e.indexOf(":");return t==-1?{s:yr(e),e:yr(e)}:{s:yr(e.slice(0,t)),e:yr(e.slice(t+1))}}function bt(e,t){return typeof t>"u"||typeof t=="number"?bt(e.s,e.e):(typeof e!="string"&&(e=ht(e)),typeof t!="string"&&(t=ht(t)),e==t?e:e+":"+t)}function Tt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function DE(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ba(e.z,r?Jr(t):t)}catch{}try{return e.w=Ba((e.XF||{}).numFmtId||(r?14:0),r?Jr(t):t)}catch{return""+t}}function is(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Ys[e.v]||e.v:t==null?DE(e,e.v):DE(e,t))}function Go(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function gI(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),s=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?yr(n.origin):n.origin;s=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=Tt(i["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),s==-1&&(u.e.r=s=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[f].length;++m)if(!(typeof t[f][m]>"u")){var p={v:t[f][m]},x=s+f,g=o+m;if(u.s.r>x&&(u.s.r=x),u.s.c>g&&(u.s.c=g),u.e.r<x&&(u.e.r=x),u.e.c<g&&(u.e.c=g),t[f][m]&&typeof t[f][m]=="object"&&!Array.isArray(t[f][m])&&!(t[f][m]instanceof Date))p=t[f][m];else if(Array.isArray(p.v)&&(p.f=t[f][m][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||ut[14],n.cellDates?(p.t="d",p.w=Ba(p.z,Jr(p.v))):(p.t="n",p.v=Jr(p.v),p.w=Ba(p.z,p.v))):p.t="s";if(a)i[x]||(i[x]=[]),i[x][g]&&i[x][g].z&&(p.z=i[x][g].z),i[x][g]=p;else{var y=ht({c:g,r:x});i[y]&&i[y].z&&(p.z=i[y].z),i[y]=p}}}return u.s.c<1e7&&(i["!ref"]=bt(u)),i}function Ru(e,t){return gI(null,e,t)}function Hte(e){return e.read_shift(4,"i")}function Fi(e,t){return t||(t=_e(4)),t.write_shift(4,e),t}function $n(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function cn(e,t){var r=!1;return t==null&&(r=!0,t=_e(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Wte(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Gte(e,t){return t||(t=_e(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0),t}function q2(e,t){var r=e.l,n=e.read_shift(1),a=$n(e),i=[],s={t:a,h:a};if(n&1){for(var o=e.read_shift(4),c=0;c!=o;++c)i.push(Wte(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function Vte(e,t){var r=!1;return t==null&&(r=!0,t=_e(15+4*e.t.length)),t.write_shift(1,0),cn(e.t,t),r?t.slice(0,t.l):t}var Kte=q2;function qte(e,t){var r=!1;return t==null&&(r=!0,t=_e(23+4*e.t.length)),t.write_shift(1,1),cn(e.t,t),t.write_shift(4,1),Gte({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function gi(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Jl(e,t){return t==null&&(t=_e(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Ql(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Zl(e,t){return t==null&&(t=_e(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Xte=$n,xI=cn;function X2(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Xm(e,t){var r=!1;return t==null&&(r=!0,t=_e(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Yte=$n,Zv=X2,Y2=Xm;function J2(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?qm([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):rl(t,0)>>2;return r?a/100:a}function yI(e,t){t==null&&(t=_e(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?n=1:a==(a|0)&&a>=-(1<<29)&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function vI(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Jte(e,t){return t||(t=_e(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var ec=vI,Fu=Jte;function Ln(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function $l(e,t){return(t||_e(8)).write_shift(8,e,"f")}function Qte(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var u=yl[a];u&&(t.rgb=xf(u));break;case 2:t.rgb=xf([s,o,c]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function Ym(e,t){if(t||(t=_e(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function Zte(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function ere(e,t){t||(t=_e(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function bI(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function tre(e){return bI(e,1)}function rre(e){return bI(e,2)}var Q2=2,sa=3,J0=11,IE=12,Jm=19,Q0=64,nre=65,are=71,ire=4108,sre=4126,nn=80,wI=81,ore=[nn,wI],e1={1:{n:"CodePage",t:Q2},2:{n:"Category",t:nn},3:{n:"PresentationFormat",t:nn},4:{n:"ByteCount",t:sa},5:{n:"LineCount",t:sa},6:{n:"ParagraphCount",t:sa},7:{n:"SlideCount",t:sa},8:{n:"NoteCount",t:sa},9:{n:"HiddenCount",t:sa},10:{n:"MultimediaClipCount",t:sa},11:{n:"ScaleCrop",t:J0},12:{n:"HeadingPairs",t:ire},13:{n:"TitlesOfParts",t:sre},14:{n:"Manager",t:nn},15:{n:"Company",t:nn},16:{n:"LinksUpToDate",t:J0},17:{n:"CharacterCount",t:sa},19:{n:"SharedDoc",t:J0},22:{n:"HyperlinksChanged",t:J0},23:{n:"AppVersion",t:sa,p:"version"},24:{n:"DigSig",t:nre},26:{n:"ContentType",t:nn},27:{n:"ContentStatus",t:nn},28:{n:"Language",t:nn},29:{n:"Version",t:nn},255:{},2147483648:{n:"Locale",t:Jm},2147483651:{n:"Behavior",t:Jm},1919054434:{}},t1={1:{n:"CodePage",t:Q2},2:{n:"Title",t:nn},3:{n:"Subject",t:nn},4:{n:"Author",t:nn},5:{n:"Keywords",t:nn},6:{n:"Comments",t:nn},7:{n:"Template",t:nn},8:{n:"LastAuthor",t:nn},9:{n:"RevNumber",t:nn},10:{n:"EditTime",t:Q0},11:{n:"LastPrinted",t:Q0},12:{n:"CreatedDate",t:Q0},13:{n:"ModifiedDate",t:Q0},14:{n:"PageCount",t:sa},15:{n:"WordCount",t:sa},16:{n:"CharCount",t:sa},17:{n:"Thumbnail",t:are},18:{n:"Application",t:nn},19:{n:"DocSecurity",t:sa},255:{},2147483648:{n:"Locale",t:Jm},2147483651:{n:"Behavior",t:Jm},1919054434:{}},RE={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},lre=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function cre(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var ure=cre([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),yl=qt(ure),Ys={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},NI={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},r1={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Z0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Z2(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function dre(e){var t=Z2();if(!e||!e.match)return t;var r={};if((e.match(Wn)||[]).forEach(function(n){var a=mt(n);switch(a[0].replace(wte,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[r1[a.ContentType]]!==void 0&&t[r1[a.ContentType]].push(a.PartName);break}}),t.xmlns!==qr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function kI(e,t){var r=fte(r1),n=[],a;n[n.length]=Dr,n[n.length]=Ue("Types",null,{xmlns:qr.CT,"xmlns:xsd":qr.xsd,"xmlns:xsi":qr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Ue("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(a=e[c][0],n[n.length]=Ue("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Z0[c][t.bookType]||Z0[c].xlsx}))},s=function(c){(e[c]||[]).forEach(function(u){n[n.length]=Ue("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Z0[c][t.bookType]||Z0[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=Ue("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return i("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var St={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function gf(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ad(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Wn)||[]).forEach(function(a){var i=mt(a);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:hd(i.Target,t);r[o]=s,n[i.Id]=s}}),r["!id"]=n,r}function zc(e){var t=[Dr,Ue("Relationships",null,{xmlns:qr.RELS})];return Ar(e["!id"]).forEach(function(r){t[t.length]=Ue("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ut(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,i?a.TargetMode=i:[St.HLINK,St.XPATH,St.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var fre="application/vnd.oasis.opendocument.spreadsheet";function hre(e,t){for(var r=j2(e),n,a;n=pf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=mt(n[0],!1),a.path=="/"&&a.type!==fre)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function mre(e){var t=[Dr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function FE(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function pre(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function gre(e){var t=[Dr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(FE(e[r][0],e[r][1])),t.push(pre("",e[r][0]));return t.push(FE("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function SI(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+uf.version+"</meta:generator></office:meta></office:document-meta>"}var li=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],xre=function(){for(var e=new Array(li.length),t=0;t<li.length;++t){var r=li[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function _I(e){var t={};e=Vt(e);for(var r=0;r<li.length;++r){var n=li[r],a=e.match(xre[r]);a!=null&&a.length>0&&(t[n[1]]=It(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=or(t[n[1]]))}return t}function zx(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=Ht(t),n[n.length]=r?Ue(e,t,r):yn(e,t))}function CI(e,t){var r=t||{},n=[Dr,Ue("cp:coreProperties",null,{"xmlns:cp":qr.CORE_PROPS,"xmlns:dc":qr.dc,"xmlns:dcterms":qr.dcterms,"xmlns:dcmitype":qr.dcmitype,"xmlns:xsi":qr.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&zx("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Qv(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&zx("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Qv(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=li.length;++i){var s=li[i],o=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&zx(s[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var vl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],EI=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function AI(e,t,r,n){var a=[];if(typeof e=="string")a=_E(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(d){return{v:d}}));var s=typeof t=="string"?_E(t,n).map(function(d){return d.v}):t,o=0,c=0;if(s.length>0)for(var u=0;u!==a.length;u+=2){switch(c=+a[u+1].v,a[u].v){case"Worksheets":case"å·¥ä½œè¡¨":case"Ð›Ð¸ÑÑ‚Ñ‹":case"Ø£ÙˆØ±Ø§Ù‚ Ø§Ù„Ø¹Ù…Ù„":case"ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆ":case"×’×œ×™×•× ×•×ª ×¢×‘×•×“×”":case"ArbeitsblÃ¤tter":case"Ã‡alÄ±ÅŸma SayfalarÄ±":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cÃ¡lculo":case"Planilhas":case"Regneark":case"Hojas de cÃ¡lculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=s.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"åå‰ä»˜ãä¸€è¦§":case"Benannte Bereiche":case"Navngivne omrÃ¥der":r.NamedRanges=c,r.DefinedNames=s.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=s.slice(o,o+c);break}o+=c}}function yre(e,t,r){var n={};return t||(t={}),e=Vt(e),vl.forEach(function(a){var i=(e.match(hf(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=It(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var s=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));s&&s.length>0&&(n[a[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&AI(n.HeadingPairs,n.TitlesOfParts,t,r),t}function TI(e){var t=[],r=Ue;return e||(e={}),e.Application="SheetJS",t[t.length]=Dr,t[t.length]=Ue("Properties",null,{xmlns:qr.EXT_PROPS,"xmlns:vt":qr.vt}),vl.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Ht(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Ht(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var vre=/<[^>]+>[^<]*/g;function bre(e,t){var r={},n="",a=e.match(vre);if(a)for(var i=0;i!=a.length;++i){var s=a[i],o=mt(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=It(o.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var c=s.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=It(d);break;case"bool":r[n]=ar(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=or(d);break;case"cy":case"error":r[n]=It(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,u,c)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return r}function PI(e){var t=[Dr,Ue("Properties",null,{xmlns:qr.CUST_PROPS,"xmlns:vt":qr.vt})];if(!e)return t.join("");var r=1;return Ar(e).forEach(function(a){++r,t[t.length]=Ue("property",Tte(e[a],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ht(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var n1={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Hx;function wre(e,t,r){Hx||(Hx=Cg(n1)),t=Hx[t]||t,e[t]=r}function Nre(e,t){var r=[];return Ar(n1).map(function(n){for(var a=0;a<li.length;++a)if(li[a][1]==n)return li[a];for(a=0;a<vl.length;++a)if(vl[a][1]==n)return vl[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(yn(n1[n[1]]||n[1],a))}}),Ue("DocumentProperties",r.join(""),{xmlns:Na.o})}function kre(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Ar(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<li.length;++s)if(i==li[s][1])return;for(s=0;s<vl.length;++s)if(i==vl[s][1])return;for(s=0;s<r.length;++s)if(i==r[s])return;var o=e[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),a.push(Ue(wE(i),o,{"dt:dt":c}))}}),t&&Ar(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=t[i],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),a.push(Ue(wE(i),s,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Na.o+'">'+a.join("")+"</"+n+">"}function eN(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Sre(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var s=_e(8);return s.write_shift(4,n),s.write_shift(4,a),s}function OI(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function DI(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function II(e,t,r){return t===31?DI(e):OI(e,t,r)}function a1(e,t,r){return II(e,t,r===!1?0:4)}function _re(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return II(e,t,0)}function Cre(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(jn,""),e.l-a&2&&(e.l+=2)}return r}function Ere(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(jn,"");return r}function Are(e){var t=e.l,r=Qm(e,wI);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Qm(e,sa);return[r,n]}function Tre(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(Are(e));return r}function ME(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),s=e.read_shift(4);n[i]=e.read_shift(s,t===1200?"utf16le":"utf8").replace(jn,"").replace(fd,"!"),t===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),n}function RI(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function Pre(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Qm(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==IE&&n!==t&&ore.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===IE?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return OI(e,n,4).replace(jn,"");case 31:return DI(e);case 64:return eN(e);case 65:return RI(e);case 71:return Pre(e);case 80:return a1(e,n,!i.raw).replace(jn,"");case 81:return _re(e,n).replace(jn,"");case 4108:return Tre(e);case 4126:case 4127:return n==4127?Cre(e):Ere(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function LE(e,t){var r=_e(4),n=_e(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=_e(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=Sre(t);break;case 31:case 80:for(n=_e(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return on([r,n])}function BE(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0,o=0,c=-1,u={};for(s=0;s!=a;++s){var d=e.read_shift(4),f=e.read_shift(4);i[s]=[d,f+r]}i.sort(function(b,w){return b[1]-w[1]});var m={};for(s=0;s!=a;++s){if(e.l!==i[s][1]){var p=!0;if(s>0&&t)switch(t[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,p=!1);break;case 80:e.l<=i[s][1]&&(e.l=i[s][1],p=!1);break;case 4108:e.l<=i[s][1]&&(e.l=i[s][1],p=!1);break}if((!t||s==0)&&e.l<=i[s][1]&&(p=!1,e.l=i[s][1]),p)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(t){var x=t[i[s][0]];if(m[x.n]=Qm(e,x.t,{raw:!0}),x.p==="version"&&(m[x.n]=String(m[x.n]>>16)+"."+("0000"+String(m[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(m[x.n]){case 0:m[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:si(o=m[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[x.n])}}else if(i[s][0]===1){if(o=m.CodePage=Qm(e,Q2),si(o),c!==-1){var g=e.l;e.l=i[c][1],u=ME(e,o),e.l=g}}else if(i[s][0]===0){if(o===0){c=s,e.l=i[s+1][1];continue}u=ME(e,o)}else{var y=u[i[s][0]],v;switch(e[e.l]){case 65:e.l+=4,v=RI(e);break;case 30:e.l+=4,v=a1(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=a1(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=Tr(e,4);break;case 64:e.l+=4,v=or(eN(e));break;default:throw new Error("unparsed value: "+e[e.l])}m[y]=v}}return e.l=r+n,m}var FI=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Ore(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function jE(e,t,r){var n=_e(8),a=[],i=[],s=8,o=0,c=_e(8),u=_e(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),i.push(c),a.push(u),s+=8+c.length,!t){u=_e(8),u.write_shift(4,0),a.unshift(u);var d=[_e(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(c=_e(4+4+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=on(d),i.unshift(c),s+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(FI.indexOf(e[o][0])>-1||EI.indexOf(e[o][0])>-1)&&e[o][1]!=null){var m=e[o][1],p=0;if(t){p=+t[e[o][0]];var x=r[p];if(x.p=="version"&&typeof m=="string"){var g=m.split(".");m=(+g[0]<<16)+(+g[1]||0)}c=LE(x.t,m)}else{var y=Ore(m);y==-1&&(y=31,m=String(m)),c=LE(y,m)}i.push(c),u=_e(8),u.write_shift(4,t?p:2+o),a.push(u),s+=8+c.length}var v=8*(i.length+1);for(o=0;o<i.length;++o)a[o].write_shift(4,v),v+=i[o].length;return n.write_shift(4,s),n.write_shift(4,i.length),on([n].concat(a).concat(i))}function $E(e,t,r){var n=e.content;if(!n)return{};xn(n,0);var a,i,s,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==ct.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(s=n.read_shift(16),c=n.read_shift(4));var f=BE(n,t),m={SystemIdentifier:u};for(var p in f)m[p]=f[p];if(m.FMTID=i,a===1)return m;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var x;try{x=BE(n,null)}catch{}for(p in x)m[p]=x[p];return m.FMTID=[i,s],m}function UE(e,t,r,n,a,i){var s=_e(a?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,ct.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var c=jE(e,r,n);if(o.push(c),a){var u=jE(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+c.length),o.push(u)}return on(o)}function Qs(e,t){return e.read_shift(t),null}function Dre(e,t){t||(t=_e(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function Ire(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Tr(e,t){return e.read_shift(t)===1}function Xn(e,t){return t||(t=_e(2)),t.write_shift(2,+!!e),t}function Mr(e){return e.read_shift(2,"u")}function ei(e,t){return t||(t=_e(2)),t.write_shift(2,e),t}function MI(e,t){return Ire(e,t,Mr)}function Rre(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function LI(e,t,r){return r||(r=_e(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function i0(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont",i=Da;if(r&&r.biff>=8&&(Da=1200),!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?e.read_shift(n,a):"";return Da=i,o}function Fre(e){var t=Da;Da=1200;var r=e.read_shift(2),n=e.read_shift(1),a=n&4,i=n&8,s=1+(n&1),o=0,c,u={};i&&(o=e.read_shift(2)),a&&(c=e.read_shift(4));var d=s==2?"dbcs-cont":"sbcs-cont",f=r===0?"":e.read_shift(r,d);return i&&(e.l+=4*o),a&&(e.l+=c),u.t=f,i||(u.raw="<t>"+u.t+"</t>",u.r=u.t),Da=t,u}function Mre(e){var t=e.t||"",r=_e(3+0);r.write_shift(2,t.length),r.write_shift(1,1);var n=_e(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return on(a)}function Ul(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function s0(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Ul(e,n,r)}function tc(e,t,r){if(r.biff>5)return s0(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function BI(e,t,r){return r||(r=_e(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Lre(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function Bre(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(jn,"");return n&&(e.l+=24),a}function jre(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(i>>1,"utf16le").replace(jn,"");return r+s}function $re(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return Bre(e);case"0303000000000000c000000000000046":return jre(e);default:throw new Error("Unsupported Moniker "+r)}}function eh(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(jn,""):"";return r}function zE(e,t){t||(t=_e(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function Ure(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,s,o,c,u="",d,f;a&16&&(i=eh(e,r-e.l)),a&128&&(s=eh(e,r-e.l)),(a&257)===257&&(o=eh(e,r-e.l)),(a&257)===1&&(c=$re(e,r-e.l)),a&8&&(u=eh(e,r-e.l)),a&32&&(d=e.read_shift(16)),a&64&&(f=eN(e)),e.l=r;var m=s||o||c||"";m&&u&&(m+="#"+u),m||(m="#"+u),a&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var p={Target:m};return d&&(p.guid=d),f&&(p.time=f),i&&(p.Tooltip=i),p}function zre(e){var t=_e(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(i==28)n=n.slice(1),zE(n,t);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),i&8&&zE(a>-1?n.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function jI(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function $I(e,t){var r=jI(e);return r[3]=0,r}function os(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function zl(e,t,r,n){return n||(n=_e(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function Hre(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function Wre(e,t,r){return t===0?"":tc(e,t,r)}function Gre(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function UI(e){var t=e.read_shift(2),r=J2(e);return[t,r]}function Vre(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=i0(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function Pg(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function zI(e,t){return t||(t=_e(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function HI(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var Kre=HI;function WI(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function qre(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function Xre(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function En(e){e.l+=2,e.l+=e.read_shift(2)}var Yre={0:En,4:En,5:En,6:En,7:Xre,8:En,9:En,10:En,11:En,12:En,13:qre,14:En,15:En,16:En,17:En,18:En,19:En,20:En,21:WI};function Jre(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(Yre[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function th(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function tN(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=_e(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function Qre(e,t){return t===0||e.read_shift(2),1200}function Zre(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=tc(e,0,r);return e.read_shift(t+n-e.l),a}function ene(e,t){var r=!t||t.biff==8,n=_e(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function tne(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function rne(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var s=i0(e,0,r);return s.length===0&&(s="Sheet1"),{pos:n,hs:a,dt:i,name:s}}function nne(e,t){var r=!t||t.biff>=8?2:1,n=_e(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function ane(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0;s!=a&&e.l<r;++s)i.push(Fre(e));return i.Count=n,i.Unique=a,i}function ine(e,t){var r=_e(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=Mre(e[a]);var i=on([r].concat(n));return i.parts=[r.length].concat(n.map(function(s){return s.length})),i}function sne(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function one(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function lne(e){var t=Hre(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function cne(e){return e.read_shift(2),e.read_shift(4)}function HE(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function une(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:s,FirstTab:o,Selected:c,TabRatio:u}}function dne(){var e=_e(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function fne(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function hne(e){var t=_e(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function mne(){}function pne(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=i0(e,0,r),n}function gne(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=_e(a);return i.write_shift(2,(e.sz||12)*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function xne(e){var t=os(e);return t.isst=e.read_shift(4),t}function yne(e,t,r,n){var a=_e(10);return zl(e,t,n,a),a.write_shift(4,r),a}function vne(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=os(e);r.biff==2&&e.l++;var i=s0(e,n-e.l,r);return a.val=i,a}function bne(e,t,r,n,a){var i=!a||a.biff==8,s=_e(6+2+ +i+(1+i)*r.length);return zl(e,t,n,s),s.write_shift(2,r.length),i&&s.write_shift(1,1),s.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),s}function wne(e,t,r){var n=e.read_shift(2),a=tc(e,0,r);return[n,a]}function Nne(e,t,r,n){var a=r&&r.biff==5;n||(n=_e(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var kne=tc;function WE(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:i,c:o},e:{r:s,c}}}function Sne(e,t){var r=t.biff==8||!t.biff?4:2,n=_e(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function _ne(e){var t=e.read_shift(2),r=e.read_shift(2),n=UI(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function Cne(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(UI(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:i}}function Ene(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:i}}function Ane(e,t,r,n){var a={},i=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return a.patternType=lre[o>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=s&15,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function Tne(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=Ane(e,t,n.fStyle,r),n}function GE(e,t,r,n){var a=r&&r.biff==5;n||(n=_e(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function Pne(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function One(e){var t=_e(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}function VE(e,t,r){var n=os(e);(r.biff==2||t==9)&&++e.l;var a=Rre(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function Dne(e,t,r,n,a,i){var s=_e(8);return zl(e,t,n,s),LI(r,i,s),s}function Ine(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=os(e),a=Ln(e);return n.val=a,n}function Rne(e,t,r,n){var a=_e(14);return zl(e,t,n,a),$l(r,a),a}var KE=Wre;function Fne(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=Ul(e,i),o=[];n>e.l;)o.push(s0(e));return[i,a,s,o]}function qE(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=Vre(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var Mne=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function XE(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=Ul(e,s,r);a&32&&(u=Mne[u.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var f=n==e.l||o===0||!(d>0)?[]:Joe(e,d,r,o);return{chKey:i,Name:u,itab:c,rgce:f}}function GI(e,t,r){if(r.biff<8)return Lne(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(Gre(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function Lne(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=i0(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Bne(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=Ul(e,n,r),s=Ul(e,a,r);return[i,s]}function jne(e,t,r){var n=HI(e);e.l++;var a=e.read_shift(1);return t-=8,[Qoe(e,t,r),a,n]}function YE(e,t,r){var n=Kre(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Xoe(e,t,r)]}function $ne(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function Une(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=tc(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,s,i]}}function zne(e,t,r){return Une(e,t,r)}function Hne(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Pg(e));return r}function Wne(e){var t=_e(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)zI(e[r],t);return t}function Gne(e,t,r){if(r&&r.biff<8)return Kne(e,t,r);var n=WI(e),a=Jre(e,t-22,n[1]);return{cmo:n,ft:a}}var Vne={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function Kne(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((Vne[n]||Hn)(e,t,r)),{cmo:[a,n,i],ft:s}}function qne(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:s=Lre(e,6,r);var o=e.read_shift(2);e.read_shift(2),Mr(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=Ul(e,e.lens[u+1]-e.lens[u]-1);if(a+=f,a.length>=(d?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function Xne(e,t){var r=Pg(e);e.l+=16;var n=Ure(e,t-24);return[r,n]}function Yne(e){var t=_e(24),r=yr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return on([t,zre(e[1])])}function Jne(e,t){e.read_shift(2);var r=Pg(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(jn,""),[r,n]}function Qne(e){var t=e[1].Tooltip,r=_e(10+2*(t.length+1));r.write_shift(2,2048);var n=yr(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function Zne(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=RE[r]||r,r=e.read_shift(2),t[1]=RE[r]||r,t}function eae(e){return e||(e=_e(4)),e.write_shift(2,1),e.write_shift(2,1),e}function tae(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push($I(e));return r}function rae(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push($I(e));return r}function nae(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function VI(e,t,r){if(!r.cellStyles)return Hn(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:i,w:s,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function aae(e,t){var r=_e(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function iae(e,t){var r={};return t<32||(e.l+=16,r.header=Ln(e),r.footer=Ln(e),e.l+=2),r}function sae(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function oae(e){for(var t=_e(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var lae=os,cae=MI,uae=s0;function dae(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function fae(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=os(e);++e.l;var a=tc(e,t-7,r);return n.t="str",n.val=a,n}function hae(e){var t=os(e);++e.l;var r=Ln(e);return t.t="n",t.val=r,t}function mae(e,t,r){var n=_e(15);return u0(n,e,t),n.write_shift(8,r,"f"),n}function pae(e){var t=os(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function gae(e,t,r){var n=_e(9);return u0(n,e,t),n.write_shift(2,r),n}function xae(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function yae(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function vae(e,t,r){var n=e.l+t,a=os(e),i=e.read_shift(2),s=Ul(e,i,r);return e.l=n,a.t="str",a.val=s,a}var bae=[2,3,48,49,131,139,140,245],i1=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Cg({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],d=Do(1);switch(c.type){case"base64":d=_a(La(o));break;case"binary":d=_a(o);break;case"buffer":case"array":d=o;break}xn(d,0);var f=d.read_shift(1),m=!!(f&136),p=!1,x=!1;switch(f){case 2:break;case 3:break;case 48:p=!0,m=!0;break;case 49:p=!0,m=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var g=0,y=521;f==2&&(g=d.read_shift(2)),d.l+=3,f!=2&&(g=d.read_shift(4)),g>1048576&&(g=1e6),f!=2&&(y=d.read_shift(2));var v=d.read_shift(2),b=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(b=e[d[d.l]]),d.l+=1,d.l+=2),x&&(d.l+=36);for(var w=[],k={},S=Math.min(d.length,f==2?521:y-10-(p?264:0)),_=x?32:11;d.l<S&&d[d.l]!=13;)switch(k={},k.name=Pt.utils.decode(b,d.slice(d.l,d.l+_)).replace(/[\u0000\r\n].*$/g,""),d.l+=_,k.type=String.fromCharCode(d.read_shift(1)),f!=2&&!x&&(k.offset=d.read_shift(4)),k.len=d.read_shift(1),f==2&&(k.offset=d.read_shift(2)),k.dec=d.read_shift(1),k.name.length&&w.push(k),f!=2&&(d.l+=x?13:14),k.type){case"B":(!p||k.len!=8)&&c.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(d[d.l]!==13&&(d.l=y-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=y;var C=0,E=0;for(u[0]=[],E=0;E!=w.length;++E)u[0][E]=w[E].name;for(;g-- >0;){if(d[d.l]===42){d.l+=v;continue}for(++d.l,u[++C]=[],E=0,E=0;E!=w.length;++E){var A=d.slice(d.l,d.l+w[E].len);d.l+=w[E].len,xn(A,0);var T=Pt.utils.decode(b,A);switch(w[E].type){case"C":T.trim().length&&(u[C][E]=T.replace(/\s+$/,""));break;case"D":T.length===8?u[C][E]=new Date(+T.slice(0,4),+T.slice(4,6)-1,+T.slice(6,8)):u[C][E]=T;break;case"F":u[C][E]=parseFloat(T.trim());break;case"+":case"I":u[C][E]=x?A.read_shift(-4,"i")^2147483648:A.read_shift(4,"i");break;case"L":switch(T.trim().toUpperCase()){case"Y":case"T":u[C][E]=!0;break;case"N":case"F":u[C][E]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+T+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[C][E]="##MEMO##"+(x?parseInt(T.trim(),10):A.read_shift(4));break;case"N":T=T.replace(/\u0000/g,"").trim(),T&&T!="."&&(u[C][E]=+T||0);break;case"@":u[C][E]=new Date(A.read_shift(-8,"f")-621356832e5);break;case"T":u[C][E]=new Date((A.read_shift(4)-2440588)*864e5+A.read_shift(4));break;case"Y":u[C][E]=A.read_shift(4,"i")/1e4+A.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[C][E]=-A.read_shift(-8,"f");break;case"B":if(p&&w[E].len==8){u[C][E]=A.read_shift(8,"f");break}case"G":case"P":A.l+=w[E].len;break;case"0":if(w[E].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[E].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=w,u}function n(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=Ru(r(o,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function a(o,c){try{return Go(n(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,c){var u=c||{};if(+u.codepage>=0&&si(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=pa(),f=tp(o,{header:1,raw:!0,cellDates:!0}),m=f[0],p=f.slice(1),x=o["!cols"]||[],g=0,y=0,v=0,b=1;for(g=0;g<m.length;++g){if(((x[g]||{}).DBF||{}).name){m[g]=x[g].DBF.name,++v;continue}if(m[g]!=null){if(++v,typeof m[g]=="number"&&(m[g]=m[g].toString(10)),typeof m[g]!="string")throw new Error("DBF Invalid column name "+m[g]+" |"+typeof m[g]+"|");if(m.indexOf(m[g])!==g){for(y=0;y<1024;++y)if(m.indexOf(m[g]+"_"+y)==-1){m[g]+="_"+y;break}}}}var w=Tt(o["!ref"]),k=[],S=[],_=[];for(g=0;g<=w.e.c-w.s.c;++g){var C="",E="",A=0,T=[];for(y=0;y<p.length;++y)p[y][g]!=null&&T.push(p[y][g]);if(T.length==0||m[g]==null){k[g]="?";continue}for(y=0;y<T.length;++y){switch(typeof T[y]){case"number":E="B";break;case"string":E="C";break;case"boolean":E="L";break;case"object":E=T[y]instanceof Date?"D":"C";break;default:E="C"}A=Math.max(A,String(T[y]).length),C=C&&C!=E?"C":E}A>250&&(A=250),E=((x[g]||{}).DBF||{}).type,E=="C"&&x[g].DBF.len>A&&(A=x[g].DBF.len),C=="B"&&E=="N"&&(C="N",_[g]=x[g].DBF.dec,A=x[g].DBF.len),S[g]=C=="C"||E=="N"?A:i[C]||0,b+=S[g],k[g]=C}var D=d.next(32);for(D.write_shift(4,318902576),D.write_shift(4,p.length),D.write_shift(2,296+32*v),D.write_shift(2,b),g=0;g<4;++g)D.write_shift(4,0);for(D.write_shift(4,0|(+t[Ll]||3)<<8),g=0,y=0;g<m.length;++g)if(m[g]!=null){var I=d.next(32),z=(m[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);I.write_shift(1,z,"sbcs"),I.write_shift(1,k[g]=="?"?"C":k[g],"sbcs"),I.write_shift(4,y),I.write_shift(1,S[g]||i[k[g]]||0),I.write_shift(1,_[g]||0),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(1,0),I.write_shift(4,0),I.write_shift(4,0),y+=S[g]||i[k[g]]||0}var X=d.next(264);for(X.write_shift(4,13),g=0;g<65;++g)X.write_shift(4,0);for(g=0;g<p.length;++g){var H=d.next(b);for(H.write_shift(1,0),y=0;y<m.length;++y)if(m[y]!=null)switch(k[y]){case"L":H.write_shift(1,p[g][y]==null?63:p[g][y]?84:70);break;case"B":H.write_shift(8,p[g][y]||0,"f");break;case"N":var L="0";for(typeof p[g][y]=="number"&&(L=p[g][y].toFixed(_[y]||0)),v=0;v<S[y]-L.length;++v)H.write_shift(1,32);H.write_shift(1,L,"sbcs");break;case"D":p[g][y]?(H.write_shift(4,("0000"+p[g][y].getFullYear()).slice(-4),"sbcs"),H.write_shift(2,("00"+(p[g][y].getMonth()+1)).slice(-2),"sbcs"),H.write_shift(2,("00"+p[g][y].getDate()).slice(-2),"sbcs")):H.write_shift(8,"00000000","sbcs");break;case"C":var W=String(p[g][y]!=null?p[g][y]:"").slice(0,S[y]);for(H.write_shift(1,W,"sbcs"),v=0;v<S[y]-W.length;++v)H.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}}(),KI=function(){var e={AA:"Ã€",BA:"Ã",CA:"Ã‚",DA:195,HA:"Ã„",JA:197,AE:"Ãˆ",BE:"Ã‰",CE:"ÃŠ",HE:"Ã‹",AI:"ÃŒ",BI:"Ã",CI:"ÃŽ",HI:"Ã",AO:"Ã’",BO:"Ã“",CO:"Ã”",DO:213,HO:"Ã–",AU:"Ã™",BU:"Ãš",CU:"Ã›",HU:"Ãœ",Aa:"Ã ",Ba:"Ã¡",Ca:"Ã¢",Da:227,Ha:"Ã¤",Ja:229,Ae:"Ã¨",Be:"Ã©",Ce:"Ãª",He:"Ã«",Ai:"Ã¬",Bi:"Ã­",Ci:"Ã®",Hi:"Ã¯",Ao:"Ã²",Bo:"Ã³",Co:"Ã´",Do:245,Ho:"Ã¶",Au:"Ã¹",Bu:"Ãº",Cu:"Ã»",Hu:"Ã¼",KC:"Ã‡",Kc:"Ã§",q:"Ã¦",z:"Å“",a:"Ã†",j:"Å’",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ar(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,p){var x=e[p];return typeof x=="number"?Jv(x):x},n=function(m,p,x){var g=p.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return g==59?m:Jv(g)};e["|"]=254;function a(m,p){switch(p.type){case"base64":return i(La(m),p);case"binary":return i(m,p);case"buffer":return i(kt&&Buffer.isBuffer(m)?m.toString("binary"):Wo(m),p);case"array":return i(jl(m),p)}throw new Error("Unrecognized type "+p.type)}function i(m,p){var x=m.split(/[\n\r]+/),g=-1,y=-1,v=0,b=0,w=[],k=[],S=null,_={},C=[],E=[],A=[],T=0,D;for(+p.codepage>=0&&si(+p.codepage);v!==x.length;++v){T=0;var I=x[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),z=I.replace(/;;/g,"\0").split(";").map(function(P){return P.replace(/\u0000/g,";")}),X=z[0],H;if(I.length>0)switch(X){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":z[1].charAt(0)=="P"&&k.push(I.slice(3).replace(/;;/g,";"));break;case"C":var L=!1,W=!1,ie=!1,B=!1,ee=-1,le=-1;for(b=1;b<z.length;++b)switch(z[b].charAt(0)){case"A":break;case"X":y=parseInt(z[b].slice(1))-1,W=!0;break;case"Y":for(g=parseInt(z[b].slice(1))-1,W||(y=0),D=w.length;D<=g;++D)w[D]=[];break;case"K":H=z[b].slice(1),H.charAt(0)==='"'?H=H.slice(1,H.length-1):H==="TRUE"?H=!0:H==="FALSE"?H=!1:isNaN(Ri(H))?isNaN(uu(H).getDate())||(H=or(H)):(H=Ri(H),S!==null&&Xl(S)&&(H=Ag(H))),typeof Pt<"u"&&typeof H=="string"&&(p||{}).type!="string"&&(p||{}).codepage&&(H=Pt.utils.decode(p.codepage,H)),L=!0;break;case"E":B=!0;var R=Hc(z[b].slice(1),{r:g,c:y});w[g][y]=[w[g][y],R];break;case"S":ie=!0,w[g][y]=[w[g][y],"S5S"];break;case"G":break;case"R":ee=parseInt(z[b].slice(1))-1;break;case"C":le=parseInt(z[b].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+I)}if(L&&(w[g][y]&&w[g][y].length==2?w[g][y][0]=H:w[g][y]=H,S=null),ie){if(B)throw new Error("SYLK shared formula cannot have own formula");var j=ee>-1&&w[ee][le];if(!j||!j[1])throw new Error("SYLK shared formula cannot find base");w[g][y][1]=dR(j[1],{r:g-ee,c:y-le})}break;case"F":var V=0;for(b=1;b<z.length;++b)switch(z[b].charAt(0)){case"X":y=parseInt(z[b].slice(1))-1,++V;break;case"Y":for(g=parseInt(z[b].slice(1))-1,D=w.length;D<=g;++D)w[D]=[];break;case"M":T=parseInt(z[b].slice(1))/20;break;case"F":break;case"G":break;case"P":S=k[parseInt(z[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(A=z[b].slice(1).split(" "),D=parseInt(A[0],10);D<=parseInt(A[1],10);++D)T=parseInt(A[2],10),E[D-1]=T===0?{hidden:!0}:{wch:T},Io(E[D-1]);break;case"C":y=parseInt(z[b].slice(1))-1,E[y]||(E[y]={});break;case"R":g=parseInt(z[b].slice(1))-1,C[g]||(C[g]={}),T>0?(C[g].hpt=T,C[g].hpx=fu(T)):T===0&&(C[g].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+I)}V<1&&(S=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+I)}}return C.length>0&&(_["!rows"]=C),E.length>0&&(_["!cols"]=E),p&&p.sheetRows&&(w=w.slice(0,p.sheetRows)),[w,_]}function s(m,p){var x=a(m,p),g=x[0],y=x[1],v=Ru(g,p);return Ar(y).forEach(function(b){v[b]=y[b]}),v}function o(m,p){return Go(s(m,p),p)}function c(m,p,x,g){var y="C;Y"+(x+1)+";X"+(g+1)+";K";switch(m.t){case"n":y+=m.v||0,m.f&&!m.F&&(y+=";E"+oN(m.f,{r:x,c:g}));break;case"b":y+=m.v?"TRUE":"FALSE";break;case"e":y+=m.w||m.v;break;case"d":y+='"'+(m.w||m.v)+'"';break;case"s":y+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function u(m,p){p.forEach(function(x,g){var y="F;W"+(g+1)+" "+(g+1)+" ";x.hidden?y+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=yf(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=vf(x.wpx)),typeof x.wch=="number"&&(y+=Math.round(x.wch))),y.charAt(y.length-1)!=" "&&m.push(y)})}function d(m,p){p.forEach(function(x,g){var y="F;";x.hidden?y+="M0;":x.hpt?y+="M"+20*x.hpt+";":x.hpx&&(y+="M"+20*bf(x.hpx)+";"),y.length>2&&m.push(y+"R"+(g+1))})}function f(m,p){var x=["ID;PWXL;N;E"],g=[],y=Tt(m["!ref"]),v,b=Array.isArray(m),w=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),m["!cols"]&&u(x,m["!cols"]),m["!rows"]&&d(x,m["!rows"]),x.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var k=y.s.r;k<=y.e.r;++k)for(var S=y.s.c;S<=y.e.c;++S){var _=ht({r:k,c:S});v=b?(m[k]||[])[S]:m[_],!(!v||v.v==null&&(!v.f||v.F))&&g.push(c(v,m,k,S))}return x.join(w)+w+g.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:s,from_sheet:f}}(),qI=function(){function e(i,s){switch(s.type){case"base64":return t(La(i),s);case"binary":return t(i,s);case"buffer":return t(kt&&Buffer.isBuffer(i)?i.toString("binary"):Wo(i),s);case"array":return t(jl(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){for(var o=i.split(`
`),c=-1,u=-1,d=0,f=[];d!==o.length;++d){if(o[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var m=o[d].trim().split(","),p=m[0],x=m[1];++d;for(var g=o[d]||"";(g.match(/["]/g)||[]).length&1&&d<o.length-1;)g+=`
`+o[++d];switch(g=g.trim(),+p){case-1:if(g==="BOT"){f[++c]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?f[c][u]=!0:g==="FALSE"?f[c][u]=!1:isNaN(Ri(x))?isNaN(uu(x).getDate())?f[c][u]=x:f[c][u]=or(x):f[c][u]=Ri(x),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),f[c][u++]=g!==""?g:null;break}if(g==="EOD")break}}return s&&s.sheetRows&&(f=f.slice(0,s.sheetRows)),f}function r(i,s){return Ru(e(i,s),s)}function n(i,s){return Go(r(i,s),s)}var a=function(){var i=function(c,u,d,f,m){c.push(u),c.push(d+","+f),c.push('"'+m.replace(/"/g,'""')+'"')},s=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=Tt(c["!ref"]),f,m=Array.isArray(c);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,d.e.r-d.s.r+1,""),i(u,"TUPLES",0,d.e.c-d.s.c+1,""),i(u,"DATA",0,0,"");for(var p=d.s.r;p<=d.e.r;++p){s(u,-1,0,"BOT");for(var x=d.s.c;x<=d.e.c;++x){var g=ht({r:p,c:x});if(f=m?(c[p]||[])[x]:c[g],!f){s(u,1,0,"");continue}switch(f.t){case"n":var y=f.w;!y&&f.v!=null&&(y=f.v),y==null?f.f&&!f.F?s(u,1,0,"="+f.f):s(u,1,0,""):s(u,0,y,"V");break;case"b":s(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":s(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Ba(f.z||ut[14],Jr(or(f.v)))),s(u,0,f.w,"V");break;default:s(u,1,0,"")}}}s(u,-1,0,"EOD");var v=`\r
`,b=u.join(v);return b}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),XI=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,m){for(var p=f.split(`
`),x=-1,g=-1,y=0,v=[];y!==p.length;++y){var b=p[y].trim().split(":");if(b[0]==="cell"){var w=yr(b[1]);if(v.length<=w.r)for(x=v.length;x<=w.r;++x)v[x]||(v[x]=[]);switch(x=w.r,g=w.c,b[2]){case"t":v[x][g]=e(b[3]);break;case"v":v[x][g]=+b[3];break;case"vtf":var k=b[b.length-1];case"vtc":switch(b[3]){case"nl":v[x][g]=!!+b[4];break;default:v[x][g]=+b[4];break}b[2]=="vtf"&&(v[x][g]=[v[x][g],k])}}}return m&&m.sheetRows&&(v=v.slice(0,m.sheetRows)),v}function n(f,m){return Ru(r(f,m),m)}function a(f,m){return Go(n(f,m),m)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var m=[],p=[],x,g="",y=ta(f["!ref"]),v=Array.isArray(f),b=y.s.r;b<=y.e.r;++b)for(var w=y.s.c;w<=y.e.c;++w)if(g=ht({r:b,c:w}),x=v?(f[b]||[])[w]:f[g],!(!x||x.v==null||x.t==="z")){switch(p=["cell",g,"t"],x.t){case"s":case"str":p.push(t(x.v));break;case"n":x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=t(x.f)):(p[2]="v",p[3]=x.v);break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var k=Jr(or(x.v));p[2]="vtc",p[3]="nd",p[4]=""+k,p[5]=x.w||Ba(x.z||ut[14],k);break;case"e":continue}m.push(p.join(":"))}return m.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function d(f){return[i,s,o,s,u(f),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:d}}(),du=function(){function e(d,f,m,p,x){x.raw?f[m][p]=d:d===""||(d==="TRUE"?f[m][p]=!0:d==="FALSE"?f[m][p]=!1:isNaN(Ri(d))?isNaN(uu(d).getDate())?f[m][p]=d:f[m][p]=or(d):f[m][p]=Ri(d))}function t(d,f){var m=f||{},p=[];if(!d||d.length===0)return p;for(var x=d.split(/[\r\n]/),g=x.length-1;g>=0&&x[g].length===0;)--g;for(var y=10,v=0,b=0;b<=g;++b)v=x[b].indexOf(" "),v==-1?v=x[b].length:v++,y=Math.max(y,v);for(b=0;b<=g;++b){p[b]=[];var w=0;for(e(x[b].slice(0,y).trim(),p,b,w,m),w=1;w<=(x[b].length-y)/10+1;++w)e(x[b].slice(y+(w-1)*10,y+w*10).trim(),p,b,w,m)}return m.sheetRows&&(p=p.slice(0,m.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(d){for(var f={},m=!1,p=0,x=0;p<d.length;++p)(x=d.charCodeAt(p))==34?m=!m:!m&&x in r&&(f[x]=(f[x]||0)+1);x=[];for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&x.push([f[p],p]);if(!x.length){f=n;for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&x.push([f[p],p])}return x.sort(function(g,y){return g[0]-y[0]||n[g[1]]-n[y[1]]}),r[x.pop()[1]]||44}function i(d,f){var m=f||{},p="",x=m.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(p=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(p=d.charAt(4),d=d.slice(6)):p=a(d.slice(0,1024)):m&&m.FS?p=m.FS:p=a(d.slice(0,1024));var y=0,v=0,b=0,w=0,k=0,S=p.charCodeAt(0),_=!1,C=0,E=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var A=m.dateNF!=null?ste(m.dateNF):null;function T(){var D=d.slice(w,k),I={};if(D.charAt(0)=='"'&&D.charAt(D.length-1)=='"'&&(D=D.slice(1,-1).replace(/""/g,'"')),D.length===0)I.t="z";else if(m.raw)I.t="s",I.v=D;else if(D.trim().length===0)I.t="s",I.v=D;else if(D.charCodeAt(0)==61)D.charCodeAt(1)==34&&D.charCodeAt(D.length-1)==34?(I.t="s",I.v=D.slice(2,-1).replace(/""/g,'"')):Fse(D)?(I.t="n",I.f=D.slice(1)):(I.t="s",I.v=D);else if(D=="TRUE")I.t="b",I.v=!0;else if(D=="FALSE")I.t="b",I.v=!1;else if(!isNaN(b=Ri(D)))I.t="n",m.cellText!==!1&&(I.w=D),I.v=b;else if(!isNaN(uu(D).getDate())||A&&D.match(A)){I.z=m.dateNF||ut[14];var z=0;A&&D.match(A)&&(D=ote(D,m.dateNF,D.match(A)||[]),z=1),m.cellDates?(I.t="d",I.v=or(D,z)):(I.t="n",I.v=Jr(or(D,z))),m.cellText!==!1&&(I.w=Ba(I.z,I.v instanceof Date?Jr(I.v):I.v)),m.cellNF||delete I.z}else I.t="s",I.v=D;if(I.t=="z"||(m.dense?(x[y]||(x[y]=[]),x[y][v]=I):x[ht({c:v,r:y})]=I),w=k+1,E=d.charCodeAt(w),g.e.c<v&&(g.e.c=v),g.e.r<y&&(g.e.r=y),C==S)++v;else if(v=0,++y,m.sheetRows&&m.sheetRows<=y)return!0}e:for(;k<d.length;++k)switch(C=d.charCodeAt(k)){case 34:E===34&&(_=!_);break;case S:case 10:case 13:if(!_&&T())break e;break}return k-w>0&&T(),x["!ref"]=bt(g),x}function s(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,f):Ru(t(d,f),f)}function o(d,f){var m="",p=f.type=="string"?[0,0,0,0]:gN(d,f);switch(f.type){case"base64":m=La(d);break;case"binary":m=d;break;case"buffer":f.codepage==65001?m=d.toString("utf8"):f.codepage&&typeof Pt<"u"?m=Pt.utils.decode(f.codepage,d):m=kt&&Buffer.isBuffer(d)?d.toString("binary"):Wo(d);break;case"array":m=jl(d);break;case"string":m=d;break;default:throw new Error("Unrecognized type "+f.type)}return p[0]==239&&p[1]==187&&p[2]==191?m=Vt(m.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?m=Vt(m):f.type=="binary"&&typeof Pt<"u"&&f.codepage&&(m=Pt.utils.decode(f.codepage,Pt.utils.encode(28591,m))),m.slice(0,19)=="socialcalc:version:"?XI.to_sheet(f.type=="string"?m:Vt(m),f):s(m,f)}function c(d,f){return Go(o(d,f),f)}function u(d){for(var f=[],m=Tt(d["!ref"]),p,x=Array.isArray(d),g=m.s.r;g<=m.e.r;++g){for(var y=[],v=m.s.c;v<=m.e.c;++v){var b=ht({r:g,c:v});if(p=x?(d[g]||[])[v]:d[b],!p||p.v==null){y.push("          ");continue}for(var w=(p.w||(is(p),p.w)||"").slice(0,10);w.length<10;)w+=" ";y.push(w+(v===0?" ":""))}f.push(y.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}}();function wae(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=KI.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return du.to_workbook(e,t)}}var bl=function(){function e(R,j,V){if(R){xn(R,R.l||0);for(var P=V.Enum||ee;R.l<R.length;){var q=R.read_shift(2),O=P[q]||P[65535],K=R.read_shift(2),G=R.l+K,te=O.f&&O.f(R,K,V);if(R.l=G,j(te,O,q))return}}}function t(R,j){switch(j.type){case"base64":return r(_a(La(R)),j);case"binary":return r(_a(R),j);case"buffer":case"array":return r(R,j)}throw"Unsupported type "+j.type}function r(R,j){if(!R)return R;var V=j||{},P=V.dense?[]:{},q="Sheet1",O="",K=0,G={},te=[],ce=[],M={s:{r:0,c:0},e:{r:0,c:0}},Le=V.sheetRows||0;if(R[2]==0&&(R[3]==8||R[3]==9)&&R.length>=16&&R[14]==5&&R[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(R[2]==2)V.Enum=ee,e(R,function(Ce,de,$e){switch($e){case 0:V.vers=Ce,Ce>=4096&&(V.qpro=!0);break;case 6:M=Ce;break;case 204:Ce&&(O=Ce);break;case 222:O=Ce;break;case 15:case 51:V.qpro||(Ce[1].v=Ce[1].v.slice(1));case 13:case 14:case 16:$e==14&&(Ce[2]&112)==112&&(Ce[2]&15)>1&&(Ce[2]&15)<15&&(Ce[1].z=V.dateNF||ut[14],V.cellDates&&(Ce[1].t="d",Ce[1].v=Ag(Ce[1].v))),V.qpro&&Ce[3]>K&&(P["!ref"]=bt(M),G[q]=P,te.push(q),P=V.dense?[]:{},M={s:{r:0,c:0},e:{r:0,c:0}},K=Ce[3],q=O||"Sheet"+(K+1),O="");var Re=V.dense?(P[Ce[0].r]||[])[Ce[0].c]:P[ht(Ce[0])];if(Re){Re.t=Ce[1].t,Re.v=Ce[1].v,Ce[1].z!=null&&(Re.z=Ce[1].z),Ce[1].f!=null&&(Re.f=Ce[1].f);break}V.dense?(P[Ce[0].r]||(P[Ce[0].r]=[]),P[Ce[0].r][Ce[0].c]=Ce[1]):P[ht(Ce[0])]=Ce[1];break}},V);else if(R[2]==26||R[2]==14)V.Enum=le,R[2]==14&&(V.qpro=!0,R.l=0),e(R,function(Ce,de,$e){switch($e){case 204:q=Ce;break;case 22:Ce[1].v=Ce[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ce[3]>K&&(P["!ref"]=bt(M),G[q]=P,te.push(q),P=V.dense?[]:{},M={s:{r:0,c:0},e:{r:0,c:0}},K=Ce[3],q="Sheet"+(K+1)),Le>0&&Ce[0].r>=Le)break;V.dense?(P[Ce[0].r]||(P[Ce[0].r]=[]),P[Ce[0].r][Ce[0].c]=Ce[1]):P[ht(Ce[0])]=Ce[1],M.e.c<Ce[0].c&&(M.e.c=Ce[0].c),M.e.r<Ce[0].r&&(M.e.r=Ce[0].r);break;case 27:Ce[14e3]&&(ce[Ce[14e3][0]]=Ce[14e3][1]);break;case 1537:ce[Ce[0]]=Ce[1],Ce[0]==K&&(q=Ce[1]);break}},V);else throw new Error("Unrecognized LOTUS BOF "+R[2]);if(P["!ref"]=bt(M),G[O||q]=P,te.push(O||q),!ce.length)return{SheetNames:te,Sheets:G};for(var Te={},je=[],ze=0;ze<ce.length;++ze)G[te[ze]]?(je.push(ce[ze]||te[ze]),Te[ce[ze]]=G[ce[ze]]||G[te[ze]]):(je.push(ce[ze]),Te[ce[ze]]={"!ref":"A1"});return{SheetNames:je,Sheets:Te}}function n(R,j){var V=j||{};if(+V.codepage>=0&&si(+V.codepage),V.type=="string")throw new Error("Cannot write WK1 to JS string");var P=pa(),q=Tt(R["!ref"]),O=Array.isArray(R),K=[];We(P,0,i(1030)),We(P,6,c(q));for(var G=Math.min(q.e.r,8191),te=q.s.r;te<=G;++te)for(var ce=Cr(te),M=q.s.c;M<=q.e.c;++M){te===q.s.r&&(K[M]=sr(M));var Le=K[M]+ce,Te=O?(R[te]||[])[M]:R[Le];if(!(!Te||Te.t=="z"))if(Te.t=="n")(Te.v|0)==Te.v&&Te.v>=-32768&&Te.v<=32767?We(P,13,p(te,M,Te.v)):We(P,14,g(te,M,Te.v));else{var je=is(Te);We(P,15,f(te,M,je.slice(0,239)))}}return We(P,1),P.end()}function a(R,j){var V=j||{};if(+V.codepage>=0&&si(+V.codepage),V.type=="string")throw new Error("Cannot write WK3 to JS string");var P=pa();We(P,0,s(R));for(var q=0,O=0;q<R.SheetNames.length;++q)(R.Sheets[R.SheetNames[q]]||{})["!ref"]&&We(P,27,B(R.SheetNames[q],O++));var K=0;for(q=0;q<R.SheetNames.length;++q){var G=R.Sheets[R.SheetNames[q]];if(!(!G||!G["!ref"])){for(var te=Tt(G["!ref"]),ce=Array.isArray(G),M=[],Le=Math.min(te.e.r,8191),Te=te.s.r;Te<=Le;++Te)for(var je=Cr(Te),ze=te.s.c;ze<=te.e.c;++ze){Te===te.s.r&&(M[ze]=sr(ze));var Ce=M[ze]+je,de=ce?(G[Te]||[])[ze]:G[Ce];if(!(!de||de.t=="z"))if(de.t=="n")We(P,23,T(Te,ze,K,de.v));else{var $e=is(de);We(P,22,C(Te,ze,K,$e.slice(0,239)))}}++K}}return We(P,1),P.end()}function i(R){var j=_e(2);return j.write_shift(2,R),j}function s(R){var j=_e(26);j.write_shift(2,4096),j.write_shift(2,4),j.write_shift(4,0);for(var V=0,P=0,q=0,O=0;O<R.SheetNames.length;++O){var K=R.SheetNames[O],G=R.Sheets[K];if(!(!G||!G["!ref"])){++q;var te=ta(G["!ref"]);V<te.e.r&&(V=te.e.r),P<te.e.c&&(P=te.e.c)}}return V>8191&&(V=8191),j.write_shift(2,V),j.write_shift(1,q),j.write_shift(1,P),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(1,1),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(4,0),j}function o(R,j,V){var P={s:{c:0,r:0},e:{c:0,r:0}};return j==8&&V.qpro?(P.s.c=R.read_shift(1),R.l++,P.s.r=R.read_shift(2),P.e.c=R.read_shift(1),R.l++,P.e.r=R.read_shift(2),P):(P.s.c=R.read_shift(2),P.s.r=R.read_shift(2),j==12&&V.qpro&&(R.l+=2),P.e.c=R.read_shift(2),P.e.r=R.read_shift(2),j==12&&V.qpro&&(R.l+=2),P.s.c==65535&&(P.s.c=P.e.c=P.s.r=P.e.r=0),P)}function c(R){var j=_e(8);return j.write_shift(2,R.s.c),j.write_shift(2,R.s.r),j.write_shift(2,R.e.c),j.write_shift(2,R.e.r),j}function u(R,j,V){var P=[{c:0,r:0},{t:"n",v:0},0,0];return V.qpro&&V.vers!=20768?(P[0].c=R.read_shift(1),P[3]=R.read_shift(1),P[0].r=R.read_shift(2),R.l+=2):(P[2]=R.read_shift(1),P[0].c=R.read_shift(2),P[0].r=R.read_shift(2)),P}function d(R,j,V){var P=R.l+j,q=u(R,j,V);if(q[1].t="s",V.vers==20768){R.l++;var O=R.read_shift(1);return q[1].v=R.read_shift(O,"utf8"),q}return V.qpro&&R.l++,q[1].v=R.read_shift(P-R.l,"cstr"),q}function f(R,j,V){var P=_e(7+V.length);P.write_shift(1,255),P.write_shift(2,j),P.write_shift(2,R),P.write_shift(1,39);for(var q=0;q<P.length;++q){var O=V.charCodeAt(q);P.write_shift(1,O>=128?95:O)}return P.write_shift(1,0),P}function m(R,j,V){var P=u(R,j,V);return P[1].v=R.read_shift(2,"i"),P}function p(R,j,V){var P=_e(7);return P.write_shift(1,255),P.write_shift(2,j),P.write_shift(2,R),P.write_shift(2,V,"i"),P}function x(R,j,V){var P=u(R,j,V);return P[1].v=R.read_shift(8,"f"),P}function g(R,j,V){var P=_e(13);return P.write_shift(1,255),P.write_shift(2,j),P.write_shift(2,R),P.write_shift(8,V,"f"),P}function y(R,j,V){var P=R.l+j,q=u(R,j,V);if(q[1].v=R.read_shift(8,"f"),V.qpro)R.l=P;else{var O=R.read_shift(2);k(R.slice(R.l,R.l+O),q),R.l+=O}return q}function v(R,j,V){var P=j&32768;return j&=-32769,j=(P?R:0)+(j>=8192?j-16384:j),(P?"":"$")+(V?sr(j):Cr(j))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(R,j){xn(R,0);for(var V=[],P=0,q="",O="",K="",G="";R.l<R.length;){var te=R[R.l++];switch(te){case 0:V.push(R.read_shift(8,"f"));break;case 1:O=v(j[0].c,R.read_shift(2),!0),q=v(j[0].r,R.read_shift(2),!1),V.push(O+q);break;case 2:{var ce=v(j[0].c,R.read_shift(2),!0),M=v(j[0].r,R.read_shift(2),!1);O=v(j[0].c,R.read_shift(2),!0),q=v(j[0].r,R.read_shift(2),!1),V.push(ce+M+":"+O+q)}break;case 3:if(R.l<R.length){console.error("WK1 premature formula end");return}break;case 4:V.push("("+V.pop()+")");break;case 5:V.push(R.read_shift(2));break;case 6:{for(var Le="";te=R[R.l++];)Le+=String.fromCharCode(te);V.push('"'+Le.replace(/"/g,'""')+'"')}break;case 8:V.push("-"+V.pop());break;case 23:V.push("+"+V.pop());break;case 22:V.push("NOT("+V.pop()+")");break;case 20:case 21:G=V.pop(),K=V.pop(),V.push(["AND","OR"][te-20]+"("+K+","+G+")");break;default:if(te<32&&w[te])G=V.pop(),K=V.pop(),V.push(K+w[te]+G);else if(b[te]){if(P=b[te][1],P==69&&(P=R[R.l++]),P>V.length){console.error("WK1 bad formula parse 0x"+te.toString(16)+":|"+V.join("|")+"|");return}var Te=V.slice(-P);V.length-=P,V.push(b[te][0]+"("+Te.join(",")+")")}else return te<=7?console.error("WK1 invalid opcode "+te.toString(16)):te<=24?console.error("WK1 unsupported op "+te.toString(16)):te<=30?console.error("WK1 invalid opcode "+te.toString(16)):te<=115?console.error("WK1 unsupported function opcode "+te.toString(16)):console.error("WK1 unrecognized opcode "+te.toString(16))}}V.length==1?j[1].f=""+V[0]:console.error("WK1 bad formula parse |"+V.join("|")+"|")}function S(R){var j=[{c:0,r:0},{t:"n",v:0},0];return j[0].r=R.read_shift(2),j[3]=R[R.l++],j[0].c=R[R.l++],j}function _(R,j){var V=S(R);return V[1].t="s",V[1].v=R.read_shift(j-4,"cstr"),V}function C(R,j,V,P){var q=_e(6+P.length);q.write_shift(2,R),q.write_shift(1,V),q.write_shift(1,j),q.write_shift(1,39);for(var O=0;O<P.length;++O){var K=P.charCodeAt(O);q.write_shift(1,K>=128?95:K)}return q.write_shift(1,0),q}function E(R,j){var V=S(R);V[1].v=R.read_shift(2);var P=V[1].v>>1;if(V[1].v&1)switch(P&7){case 0:P=(P>>3)*5e3;break;case 1:P=(P>>3)*500;break;case 2:P=(P>>3)/20;break;case 3:P=(P>>3)/200;break;case 4:P=(P>>3)/2e3;break;case 5:P=(P>>3)/2e4;break;case 6:P=(P>>3)/16;break;case 7:P=(P>>3)/64;break}return V[1].v=P,V}function A(R,j){var V=S(R),P=R.read_shift(4),q=R.read_shift(4),O=R.read_shift(2);if(O==65535)return P===0&&q===3221225472?(V[1].t="e",V[1].v=15):P===0&&q===3489660928?(V[1].t="e",V[1].v=42):V[1].v=0,V;var K=O&32768;return O=(O&32767)-16446,V[1].v=(1-K*2)*(q*Math.pow(2,O+32)+P*Math.pow(2,O)),V}function T(R,j,V,P){var q=_e(14);if(q.write_shift(2,R),q.write_shift(1,V),q.write_shift(1,j),P==0)return q.write_shift(4,0),q.write_shift(4,0),q.write_shift(2,65535),q;var O=0,K=0,G=0,te=0;return P<0&&(O=1,P=-P),K=Math.log2(P)|0,P/=Math.pow(2,K-31),te=P>>>0,te&2147483648||(P/=2,++K,te=P>>>0),P-=te,te|=2147483648,te>>>=0,P*=Math.pow(2,32),G=P>>>0,q.write_shift(4,G),q.write_shift(4,te),K+=16383+(O?32768:0),q.write_shift(2,K),q}function D(R,j){var V=A(R);return R.l+=j-14,V}function I(R,j){var V=S(R),P=R.read_shift(4);return V[1].v=P>>6,V}function z(R,j){var V=S(R),P=R.read_shift(8,"f");return V[1].v=P,V}function X(R,j){var V=z(R);return R.l+=j-10,V}function H(R,j){return R[R.l+j-1]==0?R.read_shift(j,"cstr"):""}function L(R,j){var V=R[R.l++];V>j-1&&(V=j-1);for(var P="";P.length<V;)P+=String.fromCharCode(R[R.l++]);return P}function W(R,j,V){if(!(!V.qpro||j<21)){var P=R.read_shift(1);R.l+=17,R.l+=1,R.l+=2;var q=R.read_shift(j-21,"cstr");return[P,q]}}function ie(R,j){for(var V={},P=R.l+j;R.l<P;){var q=R.read_shift(2);if(q==14e3){for(V[q]=[0,""],V[q][0]=R.read_shift(2);R[R.l];)V[q][1]+=String.fromCharCode(R[R.l]),R.l++;R.l++}}return V}function B(R,j){var V=_e(5+R.length);V.write_shift(2,14e3),V.write_shift(2,j);for(var P=0;P<R.length;++P){var q=R.charCodeAt(P);V[V.l++]=q>127?95:q}return V[V.l++]=0,V}var ee={0:{n:"BOF",f:Mr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:H},222:{n:"SHEETNAMELP",f:L},65535:{n:""}},le={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:_},23:{n:"NUMBER17",f:A},24:{n:"NUMBER18",f:E},25:{n:"FORMULA19",f:D},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ie},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:I},38:{n:"??"},39:{n:"NUMBER27",f:z},40:{n:"FORMULA28",f:X},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:H},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:W},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function Nae(e){var t={},r=e.match(Wn),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=mt(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=P2[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var kae=function(){var e=hf("t"),t=hf("rPr");function r(i){var s=i.match(e);if(!s)return{t:"s",v:""};var o={t:"s",v:It(s[1])},c=i.match(t);return c&&(o.s=Nae(c[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(a).map(r).filter(function(o){return o.v})}}(),Sae=function(){var t=/(\r\n|\n)/g;function r(a,i,s){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),a.b&&(i.push("<b>"),s.push("</b>")),a.i&&(i.push("<i>"),s.push("</i>")),a.strike&&(i.push("<s>"),s.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),s.push("</"+c+">")),s.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),_ae=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Cae=/<(?:\w+:)?r>/,Eae=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function rN(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=It(Vt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Vt(e),r&&(n.h=B2(n.t))):e.match(Cae)&&(n.r=Vt(e),n.t=It(Vt((e.replace(Eae,"").match(_ae)||[]).join("").replace(Wn,""))),r&&(n.h=Sae(kae(n.r)))),n):{t:""}}var Aae=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Tae=/<(?:\w+:)?(?:si|sstItem)>/g,Pae=/<\/(?:\w+:)?(?:si|sstItem)>/;function Oae(e,t){var r=[],n="";if(!e)return r;var a=e.match(Aae);if(a){n=a[2].replace(Tae,"").split(Pae);for(var i=0;i!=n.length;++i){var s=rN(n[i].trim(),t);s!=null&&(r[r.length]=s)}a=mt(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var Dae=/^\s|\s$|[\t\n\r]/;function YI(e,t){if(!t.bookSST)return"";var r=[Dr];r[r.length]=Ue("sst",null,{xmlns:Yl[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(Dae)&&(i+=' xml:space="preserve"'),i+=">"+Ht(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Iae(e){return[e.read_shift(4),e.read_shift(4)]}function Rae(e,t){var r=[],n=!1;return Xs(e,function(i,s,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function Fae(e,t){return t||(t=_e(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var Mae=Vte;function Lae(e){var t=pa();Pe(t,159,Fae(e));for(var r=0;r<e.length;++r)Pe(t,19,Mae(e[r]));return Pe(t,160),t.end()}function JI(e){if(typeof Pt<"u")return Pt.utils.encode(Ll,e);for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function As(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Bae(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=As(e,4),t.U=As(e,4),t.W=As(e,4),t}function jae(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function $ae(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(jae(e));return t}function Uae(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function zae(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=As(e,4),t.U=As(e,4),t.W=As(e,4),t}function Hae(e){var t=zae(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function QI(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function ZI(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function Wae(e){var t=As(e);switch(t.Minor){case 2:return[t.Minor,Gae(e)];case 3:return[t.Minor,Vae()];case 4:return[t.Minor,Kae(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Gae(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=QI(e,r),a=ZI(e,e.length-e.l);return{t:"Std",h:n,v:a}}function Vae(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Kae(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Wn,function(i){var s=mt(i);switch(ss(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=s[o]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function qae(e,t){var r={},n=r.EncryptionVersionInfo=As(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=QI(e,a),t-=a,r.EncryptionVerifier=ZI(e,t),r}function Xae(e){var t={},r=t.EncryptionVersionInfo=As(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function nN(e){var t=0,r,n=JI(e),a=n.length+1,i,s,o,c,u;for(r=Do(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)s=r[i],o=t&16384?1:0,c=t<<1&32767,u=o|c,t=u^s;return t^52811}var eR=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},a=function(s,o){return n(s^o)},i=function(s){for(var o=t[s.length-1],c=104,u=s.length-1;u>=0;--u)for(var d=s[u],f=0;f!=7;++f)d&64&&(o^=r[c]),d*=2,--c;return o};return function(s){for(var o=JI(s),c=i(o),u=o.length,d=Do(16),f=0;f!=16;++f)d[f]=0;var m,p,x;for((u&1)===1&&(m=c>>8,d[u]=a(e[0],m),--u,m=c&255,p=o[o.length-1],d[u]=a(p,m));u>0;)--u,m=c>>8,d[u]=a(o[u],m),--u,m=c&255,d[u]=a(o[u],m);for(u=15,x=15-o.length;x>0;)m=c>>8,d[u]=a(e[x],m),--u,--x,m=c&255,d[u]=a(o[u],m),--u,--x;return d}}(),Yae=function(e,t,r,n,a){a||(a=t),n||(n=eR(e));var i,s;for(i=0;i!=t.length;++i)s=t[i],s^=n[r],s=(s>>5|s<<3)&255,a[i]=s,++r;return[a,r,n]},Jae=function(e){var t=0,r=eR(e);return function(n){var a=Yae("",n,t,r);return t=a[1],a[0]}};function Qae(e,t,r,n){var a={key:Mr(e),verificationBytes:Mr(e)};return r.password&&(a.verifier=nN(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=Jae(r.password)),a}function Zae(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Xae(e):n.Data=qae(e,t),n}function eie(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?Zae(e,t-2,n):Qae(e,r.biff>=8?t:t-2,r,n),n}var tR=function(){function e(a,i){switch(i.type){case"base64":return t(La(a),i);case"binary":return t(a,i);case"buffer":return t(kt&&Buffer.isBuffer(a)?a.toString("binary"):Wo(a),i);case"array":return t(jl(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var s=i||{},o=s.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(o)&&(o[f]=[]);for(var m=/\\\w+\b/g,p=0,x,g=-1;x=m.exec(d);){switch(x[0]){case"\\cell":var y=d.slice(p,m.lastIndex-x[0].length);if(y[0]==" "&&(y=y.slice(1)),++g,y.length){var v={v:y,t:"s"};Array.isArray(o)?o[f][g]=v:o[ht({r:f,c:g})]=v}break}p=m.lastIndex}g>u.e.c&&(u.e.c=g)}),o["!ref"]=bt(u),o}function r(a,i){return Go(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=Tt(a["!ref"]),o,c=Array.isArray(a),u=s.s.r;u<=s.e.r;++u){i.push("\\trowd\\trautofit1");for(var d=s.s.c;d<=s.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=s.s.c;d<=s.e.c;++d){var f=ht({r:u,c:d});o=c?(a[u]||[])[d]:a[f],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(is(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function tie(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function xf(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function rie(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),s=a-i;if(s===0)return[0,0,t];var o=0,c=0,u=a+i;switch(c=s/(u>1?2-u:u),a){case t:o=((r-n)/s+6)%6;break;case r:o=(n-t)/s+2;break;case n:o=(t-r)/s+4;break}return[o/6,c,u/2]}function nie(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,s=[i,i,i],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=a*o,s[0]+=a,s[1]+=c;break;case 1:c=a*(2-o),s[0]+=c,s[1]+=a;break;case 2:c=a*(o-2),s[1]+=a,s[2]+=c;break;case 3:c=a*(4-o),s[1]+=c,s[2]+=a;break;case 4:c=a*(o-4),s[2]+=a,s[0]+=c;break;case 5:c=a*(6-o),s[2]+=c,s[0]+=a;break}for(var u=0;u!=3;++u)s[u]=Math.round(s[u]*255);return s}function Zm(e,t){if(t===0)return e;var r=rie(tie(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),xf(nie(r))}var rR=6,aie=15,iie=1,Rn=rR;function yf(e){return Math.floor((e+Math.round(128/Rn)/256)*Rn)}function vf(e){return Math.floor((e-5)/Rn*100+.5)/100}function ep(e){return Math.round((e*Rn+5)/Rn*256)/256}function Wx(e){return ep(vf(yf(e)))}function aN(e){var t=Math.abs(e-Wx(e)),r=Rn;if(t>.005)for(Rn=iie;Rn<aie;++Rn)Math.abs(e-Wx(e))<=t&&(t=Math.abs(e-Wx(e)),r=Rn);Rn=r}function Io(e){e.width?(e.wpx=yf(e.width),e.wch=vf(e.wpx),e.MDW=Rn):e.wpx?(e.wch=vf(e.wpx),e.width=ep(e.wch),e.MDW=Rn):typeof e.wch=="number"&&(e.width=ep(e.wch),e.wpx=yf(e.width),e.MDW=Rn),e.customWidth&&delete e.customWidth}var sie=96,nR=sie;function bf(e){return e*96/nR}function fu(e){return e*nR/96}var oie={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function lie(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(Wn)||[]).forEach(function(s){var o=mt(s);switch(ss(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=ar(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=ar(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function cie(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(Wn)||[]).forEach(function(s){var o=mt(s);switch(ss(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function uie(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(Wn)||[]).forEach(function(s){var o=mt(s);switch(ss(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=Vt(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?ar(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?ar(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?ar(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?ar(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?ar(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?ar(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?ar(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=P2[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=ar(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var c=yl[a.color.index];a.color.index==81&&(c=yl[1]),c||(c=yl[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Zm(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function die(e,t,r){t.NumberFmt=[];for(var n=Ar(ut),a=0;a<n.length;++a)t.NumberFmt[n[a]]=ut[n[a]];var i=e[0].match(Wn);if(i)for(a=0;a<i.length;++a){var s=mt(i[a]);switch(ss(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=It(Vt(s.formatCode)),c=parseInt(s.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}es(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function fie(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Ue("numFmt",null,{numFmtId:n,formatCode:Ht(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ue("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var rh=["numFmtId","fillId","fontId","borderId","xfId"],nh=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function hie(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Wn)||[]).forEach(function(i){var s=mt(i),o=0;switch(ss(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],o=0;o<rh.length;++o)n[rh[o]]&&(n[rh[o]]=parseInt(n[rh[o]],10));for(o=0;o<nh.length;++o)n[nh[o]]&&(n[nh[o]]=ar(n[nh[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};s.vertical&&(c.vertical=s.vertical),s.horizontal&&(c.horizontal=s.horizontal),s.textRotation!=null&&(c.textRotation=s.textRotation),s.indent&&(c.indent=s.indent),s.wrapText&&(c.wrapText=ar(s.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}function mie(e){var t=[];return t[t.length]=Ue("cellXfs",null),e.forEach(function(r){t[t.length]=Ue("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ue("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var pie=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,u){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&die(f,d,u),(f=o.match(a))&&uie(f,d,c,u),(f=o.match(n))&&cie(f,d,c,u),(f=o.match(i))&&lie(f,d,c,u),(f=o.match(r))&&hie(f,d,u),d}}();function aR(e,t){var r=[Dr,Ue("styleSheet",null,{xmlns:Yl[0],"xmlns:vt":qr.vt})],n;return e.SSF&&(n=fie(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=mie(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function gie(e,t){var r=e.read_shift(2),n=$n(e);return[r,n]}function xie(e,t,r){r||(r=_e(6+4*t.length)),r.write_shift(2,e),cn(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function yie(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=Zte(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=Qte(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=$n(e),n}function vie(e,t){t||(t=_e(25+4*32)),t.write_shift(2,e.sz*20),ere(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Ym(e.color,t);var n=0;return e.scheme=="major"&&(n=1),e.scheme=="minor"&&(n=2),t.write_shift(1,n),cn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var bie=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Gx,wie=Hn;function JE(e,t){t||(t=_e(4*3+8*7+16*1)),Gx||(Gx=Cg(bie));var r=Gx[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Ym({auto:1},t),Ym({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Nie(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function iR(e,t,r){r||(r=_e(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function ad(e,t){return t||(t=_e(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var kie=Hn;function Sie(e,t){return t||(t=_e(51)),t.write_shift(1,0),ad(null,t),ad(null,t),ad(null,t),ad(null,t),ad(null,t),t.length>t.l?t.slice(0,t.l):t}function _ie(e,t){return t||(t=_e(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),Xm(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function Cie(e,t,r){var n=_e(2052);return n.write_shift(4,e),Xm(t,n),Xm(r,n),n.length>n.l?n.slice(0,n.l):n}function Eie(e,t,r){var n={};n.NumberFmt=[];for(var a in ut)n.NumberFmt[a]=ut[a];n.CellXf=[],n.Fonts=[];var i=[],s=!1;return Xs(e,function(c,u,d){switch(d){case 44:n.NumberFmt[c[0]]=c[1],es(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=Zm(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(d),s=!0;break;case 38:i.pop(),s=!1;break;default:if(u.T>0)i.push(d);else if(u.T<0)i.pop();else if(!s||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function Aie(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(Pe(e,615,Fi(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Pe(e,44,xie(a,t[a]))}),Pe(e,616))}}function Tie(e){var t=1;Pe(e,611,Fi(t)),Pe(e,43,vie({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Pe(e,612)}function Pie(e){var t=2;Pe(e,603,Fi(t)),Pe(e,45,JE({patternType:"none"})),Pe(e,45,JE({patternType:"gray125"})),Pe(e,604)}function Oie(e){var t=1;Pe(e,613,Fi(t)),Pe(e,46,Sie()),Pe(e,614)}function Die(e){var t=1;Pe(e,626,Fi(t)),Pe(e,47,iR({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Pe(e,627)}function Iie(e,t){Pe(e,617,Fi(t.length)),t.forEach(function(r){Pe(e,47,iR(r,0))}),Pe(e,618)}function Rie(e){var t=1;Pe(e,619,Fi(t)),Pe(e,48,_ie({xfId:0,builtinId:0,name:"Normal"})),Pe(e,620)}function Fie(e){var t=0;Pe(e,505,Fi(t)),Pe(e,506)}function Mie(e){var t=0;Pe(e,508,Cie(t,"TableStyleMedium9","PivotStyleMedium4")),Pe(e,509)}function Lie(e,t){var r=pa();return Pe(r,278),Aie(r,e.SSF),Tie(r),Pie(r),Oie(r),Die(r),Iie(r,t.cellXfs),Rie(r),Fie(r),Mie(r),Pe(r,279),r.end()}var Bie=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function jie(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Wn)||[]).forEach(function(a){var i=mt(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[Bie.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function $ie(){}function Uie(){}var zie=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Hie=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Wie=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Gie(e,t,r){t.themeElements={};var n;[["clrScheme",zie,jie],["fontScheme",Hie,$ie],["fmtScheme",Wie,Uie]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var Vie=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function sR(e,t){(!e||e.length===0)&&(e=iN());var r,n={};if(!(r=e.match(Vie)))throw new Error("themeElements not found in theme");return Gie(r[0],n,t),n.raw=e,n}function iN(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Dr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',r[r.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',r[r.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',r[r.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',r[r.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',r[r.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',r[r.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Kie(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var s;try{s=rI(i,{type:"array"})}catch{return}var o=Ca(s,"theme/theme/theme1.xml",!0);if(o)return sR(o,r)}}function qie(e){return e.read_shift(4)}function Xie(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Yie(e,4);break;case 2:t.xclrValue=jI(e);break;case 3:t.xclrValue=qie(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Yie(e,t){return Hn(e,t)}function Jie(e,t){return Hn(e,t)}function Qie(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Xie(e);break;case 6:n[1]=Jie(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Zie(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(Qie(e,r-e.l));return{ixfe:n,ext:i}}function ese(e,t){t.forEach(function(r){switch(r[0]){}})}function tse(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:$n(e)}}function rse(e){var t=_e(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),cn(e.name,t),t.slice(0,t.l)}function nse(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function ase(e){var t=_e(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function ise(e,t){var r=_e(8+2*t.length);return r.write_shift(4,e),cn(t,r),r.slice(0,r.l)}function sse(e){return e.l+=4,e.read_shift(4)!=0}function ose(e,t){var r=_e(8);return r.write_shift(4,e),r.write_shift(4,t?1:0),r}function lse(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],s=!1,o=2;return Xs(e,function(c,u,d){switch(d){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:i.push(d),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!u.T){if(!s||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function cse(){var e=pa();return Pe(e,332),Pe(e,334,Fi(1)),Pe(e,335,rse({name:"XLDAPR",version:12e4,flags:3496657072})),Pe(e,336),Pe(e,339,ise(1,"XLDAPR")),Pe(e,52),Pe(e,35,Fi(514)),Pe(e,4096,Fi(0)),Pe(e,4097,ei(1)),Pe(e,36),Pe(e,53),Pe(e,340),Pe(e,337,ose(1,!0)),Pe(e,51,ase([[1,0]])),Pe(e,338),Pe(e,333),e.end()}function use(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,s;return e.replace(Wn,function(o){var c=mt(o);switch(ss(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(s=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):i==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+c.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function oR(){var e=[Dr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function dse(e){var t=[];if(!e)return t;var r=1;return(e.match(Wn)||[]).forEach(function(n){var a=mt(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function fse(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=ht(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function hse(e,t,r){var n=[];return Xs(e,function(i,s,o){switch(o){case 63:n.push(i);break;default:if(!s.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function mse(e,t,r,n){if(!e)return e;var a=n||{},i=!1;Xs(e,function(o,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},a)}function pse(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Dc=1024;function lR(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Ue("xml",null,{"xmlns:v":Na.v,"xmlns:o":Na.o,"xmlns:x":Na.x,"xmlns:mv":Na.mv}).replace(/\/>/,">"),Ue("o:shapelayout",Ue("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ue("v:shapetype",[Ue("v:stroke",null,{joinstyle:"miter"}),Ue("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Dc<e*1e3;)Dc+=1e3;return t.forEach(function(i){var s=yr(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?Ue("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Ue("v:fill",c,o),d={on:"t",obscured:"t"};++Dc,a=a.concat(["<v:shape"+mf({id:"_x0000_s"+Dc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Ue("v:shadow",null,d),Ue("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",yn("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),yn("x:AutoFill","False"),yn("x:Row",String(s.r)),yn("x:Column",String(s.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function QE(e,t,r,n){var a=Array.isArray(e),i;t.forEach(function(s){var o=yr(s.ref);if(a?(e[o.r]||(e[o.r]=[]),i=e[o.r][o.c]):i=e[s.ref],!i){i={t:"z"},a?e[o.r][o.c]=i:e[s.ref]=i;var c=Tt(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var u=bt(c);u!==e["!ref"]&&(e["!ref"]=u)}i.c||(i.c=[]);var d={a:s.author,t:s.t,r:s.r,T:r};s.h&&(d.h=s.h);for(var f=i.c.length-1;f>=0;--f){if(!r&&i.c[f].T)return;r&&!i.c[f].T&&i.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}i.c.push(d)})}function gse(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=mt(o[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=yr(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!f&&!!f[1]&&rN(f[1])||{r:"",t:"",h:""};u.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),u.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=m.h),n.push(u)}}}}),n}function cR(e){var t=[Dr,Ue("comments",null,{xmlns:Yl[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=Ht(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=r.indexOf(Ht(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)t.push(yn("t",Ht(i[0]||"")));else{for(var s=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)s+=`Reply:
    `+i[o]+`
`;t.push(yn("t",Ht(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function xse(e,t){var r=[],n=!1,a={},i=0;return e.replace(Wn,function(o,c){var u=mt(o);switch(ss(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=c+o.length;break;case"</text>":a.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function yse(e,t,r){var n=[Dr,Ue("ThreadedComments",null,{xmlns:qr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=c.id:c.parentId=i,s.ID=c.id,s.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(Ue("threadedComment",yn("text",s.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function vse(e,t){var r=[],n=!1;return e.replace(Wn,function(i){var s=mt(i);switch(ss(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),r}function bse(e){var t=[Dr,Ue("personList",null,{xmlns:qr.TCMNT,"xmlns:x":Yl[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Ue("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function wse(e){var t={};t.iauthor=e.read_shift(4);var r=ec(e);return t.rfx=r.s,t.ref=ht(r.s),e.l+=16,t}function Nse(e,t){return t==null&&(t=_e(36)),t.write_shift(4,e[1].iauthor),Fu(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var kse=$n;function Sse(e){return cn(e.slice(0,54))}function _se(e,t){var r=[],n=[],a={},i=!1;return Xs(e,function(o,c,u){switch(u){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function Cse(e){var t=pa(),r=[];return Pe(t,628),Pe(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Pe(t,632,Sse(a.a)))})}),Pe(t,631),Pe(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:yr(n[0]),e:yr(n[0])};Pe(t,635,Nse([i,a])),a.t&&a.t.length>0&&Pe(t,637,qte(a)),Pe(t,636),delete a.iauthor})}),Pe(t,634),Pe(t,629),t.end()}var Ese="application/vnd.ms-office.vbaProject";function Ase(e){var t=ct.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");ct.utils.cfb_add(t,a,e.FileIndex[n].content)}}),ct.write(t)}function Tse(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&ct.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var uR=["xlsb","xlsm","xlam","biff8","xla"];function Pse(){return{"!type":"dialog"}}function Ose(){return{"!type":"dialog"}}function Dse(){return{"!type":"macro"}}function Ise(){return{"!type":"macro"}}var Hc=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,s){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,d=s.length>0?parseInt(s,10)|0:0;return o?d+=t.c:--d,c?u+=t.r:--u,a+(o?"":"$")+sr(d)+(c?"":"$")+Cr(u)}return function(a,i){return t=i,a.replace(e,r)}}(),sN=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,oN=function(){return function(t,r){return t.replace(sN,function(n,a,i,s,o,c){var u=K2(s)-(i?0:r.c),d=V2(c)-(o?0:r.r),f=d==0?"":o?d+1:"["+d+"]",m=u==0?"":i?u+1:"["+u+"]";return a+"R"+f+"C"+m})}}();function dR(e,t){return e.replace(sN,function(r,n,a,i,s,o){return n+(a=="$"?a+i:sr(K2(i)+t.c))+(s=="$"?s+o:Cr(V2(o)+t.r))})}function Rse(e,t,r){var n=ta(t),a=n.s,i=yr(r),s={r:i.r-a.r,c:i.c-a.c};return dR(e,s)}function Fse(e){return e.length!=1}function ZE(e){return e.replace(/_xlfn\./g,"")}function Rr(e){e.l+=1}function Ro(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function fR(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return hR(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=Ro(e,2),o=Ro(e,2);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function hR(e){var t=Ro(e,2),r=Ro(e,2),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function Mse(e,t,r){if(r.biff<8)return hR(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=Ro(e,2),s=Ro(e,2);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function mR(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Lse(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Ro(e,2);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function Lse(e){var t=Ro(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Bse(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function jse(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return $se(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:o}}function $se(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function Use(e,t,r){var n=(e[e.l++]&96)>>5,a=fR(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function zse(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=fR(e,i,r);return[n,a,s]}function Hse(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Wse(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function Gse(e,t,r){var n=(e[e.l++]&96)>>5,a=Mse(e,t-1,r);return[n,a]}function Vse(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function e4(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Kse(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function qse(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Xse(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Yse(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Jse(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function pR(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Qse(e){return e.read_shift(2),pR(e)}function Zse(e){return e.read_shift(2),pR(e)}function eoe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=mR(e,0,r);return[n,a]}function toe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=jse(e,0,r);return[n,a]}function roe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=mR(e,0,r);return[n,a,i]}function noe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[sle[a],yR[a],n]}function aoe(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:ioe(e);return[a,(i[0]===0?yR:ile)[i[1]]]}function ioe(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function soe(e,t,r){e.l+=r&&r.biff==2?3:4}function ooe(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function loe(e){return e.l++,Ys[e.read_shift(1)]}function coe(e){return e.l++,e.read_shift(2)}function uoe(e){return e.l++,e.read_shift(1)!==0}function doe(e){return e.l++,Ln(e)}function foe(e,t,r){return e.l++,i0(e,t-1,r)}function hoe(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Tr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Ys[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Ln(e);break;case 2:r[1]=tc(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function moe(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?ec:Pg)(e));return a}function poe(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=hoe(e,r.biff);return s}function goe(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function xoe(e,t,r){if(r.biff==5)return yoe(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function yoe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function voe(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function boe(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function woe(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Noe(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var koe=Hn,Soe=Hn,_oe=Hn;function o0(e,t,r){return e.l+=2,[Bse(e)]}function lN(e){return e.l+=6,[]}var Coe=o0,Eoe=lN,Aoe=lN,Toe=o0;function gR(e){return e.l+=2,[Mr(e),e.read_shift(2)&1]}var Poe=o0,Ooe=gR,Doe=lN,Ioe=o0,Roe=o0,Foe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Moe(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=Foe[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:i}}function Loe(e){return e.l+=2,[e.read_shift(4)]}function Boe(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function joe(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function $oe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Uoe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function zoe(e){return e.l+=4,[0,0]}var t4={1:{n:"PtgExp",f:ooe},2:{n:"PtgTbl",f:_oe},3:{n:"PtgAdd",f:Rr},4:{n:"PtgSub",f:Rr},5:{n:"PtgMul",f:Rr},6:{n:"PtgDiv",f:Rr},7:{n:"PtgPower",f:Rr},8:{n:"PtgConcat",f:Rr},9:{n:"PtgLt",f:Rr},10:{n:"PtgLe",f:Rr},11:{n:"PtgEq",f:Rr},12:{n:"PtgGe",f:Rr},13:{n:"PtgGt",f:Rr},14:{n:"PtgNe",f:Rr},15:{n:"PtgIsect",f:Rr},16:{n:"PtgUnion",f:Rr},17:{n:"PtgRange",f:Rr},18:{n:"PtgUplus",f:Rr},19:{n:"PtgUminus",f:Rr},20:{n:"PtgPercent",f:Rr},21:{n:"PtgParen",f:Rr},22:{n:"PtgMissArg",f:Rr},23:{n:"PtgStr",f:foe},26:{n:"PtgSheet",f:Boe},27:{n:"PtgEndSheet",f:joe},28:{n:"PtgErr",f:loe},29:{n:"PtgBool",f:uoe},30:{n:"PtgInt",f:coe},31:{n:"PtgNum",f:doe},32:{n:"PtgArray",f:Vse},33:{n:"PtgFunc",f:noe},34:{n:"PtgFuncVar",f:aoe},35:{n:"PtgName",f:goe},36:{n:"PtgRef",f:eoe},37:{n:"PtgArea",f:Use},38:{n:"PtgMemArea",f:voe},39:{n:"PtgMemErr",f:koe},40:{n:"PtgMemNoMem",f:Soe},41:{n:"PtgMemFunc",f:boe},42:{n:"PtgRefErr",f:woe},43:{n:"PtgAreaErr",f:Hse},44:{n:"PtgRefN",f:toe},45:{n:"PtgAreaN",f:Gse},46:{n:"PtgMemAreaN",f:$oe},47:{n:"PtgMemNoMemN",f:Uoe},57:{n:"PtgNameX",f:xoe},58:{n:"PtgRef3d",f:roe},59:{n:"PtgArea3d",f:zse},60:{n:"PtgRefErr3d",f:Noe},61:{n:"PtgAreaErr3d",f:Wse},255:{}},Hoe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Woe={1:{n:"PtgElfLel",f:gR},2:{n:"PtgElfRw",f:Ioe},3:{n:"PtgElfCol",f:Coe},6:{n:"PtgElfRwV",f:Roe},7:{n:"PtgElfColV",f:Toe},10:{n:"PtgElfRadical",f:Poe},11:{n:"PtgElfRadicalS",f:Doe},13:{n:"PtgElfColS",f:Eoe},15:{n:"PtgElfColSV",f:Aoe},16:{n:"PtgElfRadicalLel",f:Ooe},25:{n:"PtgList",f:Moe},29:{n:"PtgSxName",f:Loe},255:{}},Goe={0:{n:"PtgAttrNoop",f:zoe},1:{n:"PtgAttrSemi",f:Jse},2:{n:"PtgAttrIf",f:Xse},4:{n:"PtgAttrChoose",f:Kse},8:{n:"PtgAttrGoto",f:qse},16:{n:"PtgAttrSum",f:soe},32:{n:"PtgAttrBaxcel",f:e4},33:{n:"PtgAttrBaxcel",f:e4},64:{n:"PtgAttrSpace",f:Qse},65:{n:"PtgAttrSpaceSemi",f:Zse},128:{n:"PtgAttrIfError",f:Yse},255:{}};function l0(e,t,r,n){if(n.biff<8)return Hn(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=poe(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=moe(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&i.push(Hn(e,t)),i}function c0(e,t,r){for(var n=e.l+t,a,i,s=[];n!=e.l;)t=n-e.l,i=e[e.l],a=t4[i]||t4[Hoe[i]],(i===24||i===25)&&(a=(i===24?Woe:Goe)[e[e.l+1]]),!a||!a.f?Hn(e,t):s.push([a.n,a.f(e,t,r)]);return s}function Voe(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var Koe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function qoe(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function xR(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function r4(e,t,r){var n=xR(e,t,r);return n=="#REF"?n:qoe(n,r)}function On(e,t,r,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},o=[],c,u,d,f=0,m=0,p,x="";if(!e[0]||!e[0][0])return"";for(var g=-1,y="",v=0,b=e[0].length;v<b;++v){var w=e[0][v];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),g>=0){switch(e[0][g][1][0]){case 0:y=Sr(" ",e[0][g][1][1]);break;case 1:y=Sr("\r",e[0][g][1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}u=u+y,g=-1}o.push(u+Koe[w[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Cd(w[1][1],s,a),o.push(Ed(d,i));break;case"PtgRefN":d=r?Cd(w[1][1],r,a):w[1][1],o.push(Ed(d,i));break;case"PtgRef3d":f=w[1][1],d=Cd(w[1][2],s,a),x=r4(n,f,a),o.push(x+"!"+Ed(d,i));break;case"PtgFunc":case"PtgFuncVar":var k=w[1][0],S=w[1][1];k||(k=0),k&=127;var _=k==0?[]:o.slice(-k);o.length-=k,S==="User"&&(S=_.shift()),o.push(S+"("+_.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":p=OE(w[1][1],r?{s:r}:s,a),o.push(Ux(p,a));break;case"PtgArea":p=OE(w[1][1],s,a),o.push(Ux(p,a));break;case"PtgArea3d":f=w[1][1],p=w[1][2],x=r4(n,f,a),o.push(x+"!"+Ux(p,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=w[1][2];var C=(n.names||[])[m-1]||(n[0]||[])[m],E=C?C.Name:"SH33TJSNAME"+String(m);E&&E.slice(0,6)=="_xlfn."&&!a.xlfn&&(E=E.slice(6)),o.push(E);break;case"PtgNameX":var A=w[1][1];m=w[1][2];var T;if(a.biff<=5)A<0&&(A=-A),n[A]&&(T=n[A][m]);else{var D="";if(((n[A]||[])[0]||[])[0]==14849||(((n[A]||[])[0]||[])[0]==1025?n[A][m]&&n[A][m].itab>0&&(D=n.SheetNames[n[A][m].itab-1]+"!"):D=n.SheetNames[m-1]+"!"),n[A]&&n[A][m])D+=n[A][m].Name;else if(n[0]&&n[0][m])D+=n[0][m].Name;else{var I=(xR(n,A,a)||"").split(";;");I[m-1]?D=I[m-1]:D+="SH33TJSERRX"}o.push(D);break}T||(T={Name:"SH33TJSERRY"}),o.push(T.Name);break;case"PtgParen":var z="(",X=")";if(g>=0){switch(y="",e[0][g][1][0]){case 2:z=Sr(" ",e[0][g][1][1])+z;break;case 3:z=Sr("\r",e[0][g][1][1])+z;break;case 4:X=Sr(" ",e[0][g][1][1])+X;break;case 5:X=Sr("\r",e[0][g][1][1])+X;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}o.push(z+o.pop()+X);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:w[1][1],r:w[1][0]};var H={c:r.c,r:r.r};if(n.sharedf[ht(d)]){var L=n.sharedf[ht(d)];o.push(On(L,s,H,n,a))}else{var W=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push(On(u[1],s,H,n,a)),W=!0;break}W||o.push(w[1])}break;case"PtgArray":o.push("{"+Voe(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var ie=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&g>=0&&ie.indexOf(e[0][v][0])==-1){w=e[0][g];var B=!0;switch(w[1][0]){case 4:B=!1;case 0:y=Sr(" ",w[1][1]);break;case 5:B=!1;case 1:y=Sr("\r",w[1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((B?y:"")+o.pop()+(B?"":y)),g=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function Xoe(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],Hn(e,t-2)];var o=c0(e,s,r);return t!==s+a&&(i=l0(e,t-s-a,o,r)),e.l=n,[o,i]}function Yoe(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],Hn(e,t-2)];var o=c0(e,s,r);return t!==s+a&&(i=l0(e,t-s-a,o,r)),e.l=n,[o,i]}function Joe(e,t,r,n){var a=e.l+t,i=c0(e,n,r),s;return a!==e.l&&(s=l0(e,a-e.l,i,r)),[i,s]}function Qoe(e,t,r){var n=e.l+t,a,i=e.read_shift(2),s=c0(e,i,r);return i==65535?[[],Hn(e,t-2)]:(t!==i+2&&(a=l0(e,n-i-2,s,r)),[s,a])}function Zoe(e){var t;if(Ns(e,e.l+6)!==65535)return[Ln(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function ele(e){if(e==null){var t=_e(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return $l(e);return $l(0)}function Vx(e,t,r){var n=e.l+t,a=os(e);r.biff==2&&++e.l;var i=Zoe(e),s=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=Yoe(e,n-e.l,r);return{cell:a,val:i[0],formula:o,shared:s>>3&1,tt:i[1]}}function tle(e,t,r,n,a){var i=zl(t,r,a),s=ele(e.v),o=_e(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=_e(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=on([i,s,o,u]);return f}function Og(e,t,r){var n=e.read_shift(4),a=c0(e,n,r),i=e.read_shift(4),s=i>0?l0(e,i,a,r):null;return[a,s]}var rle=Og,Dg=Og,nle=Og,ale=Og,ile={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},yR={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},sle={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function n4(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function ole(e){var t="of:="+e.replace(sN,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Kx(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function lle(e){return e.replace(/\./,"!")}var Td={},Wc={},Pd=typeof Map<"u";function cN(e,t,r){var n=0,a=e.length;if(r){if(Pd?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Pd?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Pd?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function Ig(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Rn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=vf(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=ep(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function wl(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Vo(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){es(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function vR(e,t,r,n,a,i){try{n.cellNF&&(e.z=ut[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=or(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(ut[t]==null&&es(ite[t]||"General",t),e.t==="e")e.w=e.w||Ys[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ff(e.v);else if(e.t==="d"){var s=Jr(e.v);(s|0)===s?e.w=s.toString(10):e.w=ff(s)}else{if(e.v===void 0)return"";e.w=Bl(e.v,Wc)}else e.t==="d"?e.w=Ba(t,Jr(e.v),Wc):e.w=Ba(t,e.v,Wc)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Zm(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Zm(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function cle(e,t,r){if(e&&e["!ref"]){var n=Tt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function ule(e,t){var r=Tt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=bt(r))}var dle=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,fle=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,hle=/<(?:\w:)?hyperlink [^>]*>/mg,mle=/"(\w*:\w*)"/,ple=/<(?:\w:)?col\b[^>]*[\/]?>/g,gle=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,xle=/<(?:\w:)?pageMargins[^>]*\/>/g,bR=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,yle=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,vle=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function ble(e,t,r,n,a,i,s){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(fle);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var m=u.match(bR);m?uN(m[0],o,a,r):(m=u.match(yle))&&Nle(m[0],m[1]||"",o,a,r);var p=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var x=u.slice(p,p+50).match(mle);x&&ule(o,x[1])}var g=u.match(vle);g&&g[1]&&Fle(g[1],a);var y=[];if(t.cellStyles){var v=u.match(ple);v&&Ple(y,v)}f&&Ble(f[1],o,t,c,i,s);var b=d.match(gle);b&&(o["!autofilter"]=Dle(b[0]));var w=[],k=d.match(dle);if(k)for(p=0;p!=k.length;++p)w[p]=Tt(k[p].slice(k[p].indexOf('"')+1));var S=d.match(hle);S&&Ele(o,S,n);var _=d.match(xle);if(_&&(o["!margins"]=Ale(mt(_[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=bt(c)),t.sheetRows>0&&o["!ref"]){var C=Tt(o["!ref"]);t.sheetRows<=+C.e.r&&(C.e.r=t.sheetRows-1,C.e.r>c.e.r&&(C.e.r=c.e.r),C.e.r<C.s.r&&(C.s.r=C.e.r),C.e.c>c.e.c&&(C.e.c=c.e.c),C.e.c<C.s.c&&(C.s.c=C.e.c),o["!fullref"]=o["!ref"],o["!ref"]=bt(C))}return y.length>0&&(o["!cols"]=y),w.length>0&&(o["!merges"]=w),o}function wle(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+bt(e[r])+'"/>';return t+"</mergeCells>"}function uN(e,t,r,n){var a=mt(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=It(Vt(a.codeName)))}function Nle(e,t,r,n,a){uN(e.slice(0,e.indexOf(">")),r,n,a)}function kle(e,t,r,n,a){var i=!1,s={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,s.codeName=Xi(Ht(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+Ue("outlinePr",null,u)}!i&&!o||(a[a.length]=Ue("sheetPr",o,s))}var Sle=["objects","scenarios","selectLockedCells","selectUnlockedCells"],_le=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Cle(e){var t={sheet:1};return Sle.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),_le.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=nN(e.password).toString(16).toUpperCase()),Ue("sheetProtection",null,t)}function Ele(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=mt(Vt(t[a]),!0);if(!i.ref)return;var s=((r||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+It(i.location))):(i.Target="#"+It(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Tt(i.ref),c=o.s.r;c<=o.e.r;++c)for(var u=o.s.c;u<=o.e.c;++u){var d=ht({c:u,r:c});n?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=i):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=i)}}}function Ale(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function Tle(e){return wl(e),Ue("pageMargins",null,e)}function Ple(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=mt(t[n],!0);a.hidden&&(a.hidden=ar(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,aN(a.width)),Io(a);i<=s;)e[i++]=qt(a)}}function Ole(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Ue("col",null,Ig(a,n)));return r[r.length]="</cols>",r.join("")}function Dle(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function Ile(e,t,r,n){var a=typeof e.ref=="string"?e.ref:bt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,s=ta(a);s.s.r==s.e.r&&(s.e.r=ta(t["!ref"]).e.r,a=bt(s));for(var o=0;o<i.length;++o){var c=i[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Ue("autoFilter",null,{ref:a})}var Rle=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Fle(e,t){t.Views||(t.Views=[{}]),(e.match(Rle)||[]).forEach(function(r,n){var a=mt(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),ar(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function Mle(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ue("sheetViews",Ue("sheetView",null,a),{})}function Lle(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",i=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=Ys[e.v];break;case"d":n&&n.cellDates?a=or(e.v,-1).toISOString():(e=qt(e),e.t="n",a=""+(e.v=Jr(or(e.v)))),typeof e.z>"u"&&(e.z=ut[14]);break;default:a=e.v;break}var o=yn("v",Ht(a)),c={r:t},u=Vo(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=yn("v",""+cN(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=s),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Ue("f",Ht(e.f),d)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Ue("c",o,c)}var Ble=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=hf("v"),s=hf("f");return function(c,u,d,f,m,p){for(var x=0,g="",y=[],v=[],b=0,w=0,k=0,S="",_,C,E=0,A=0,T,D,I=0,z=0,X=Array.isArray(p.CellXf),H,L=[],W=[],ie=Array.isArray(u),B=[],ee={},le=!1,R=!!d.sheetStubs,j=c.split(t),V=0,P=j.length;V!=P;++V){g=j[V].trim();var q=g.length;if(q!==0){var O=0;e:for(x=0;x<q;++x)switch(g[x]){case">":if(g[x-1]!="/"){++x;break e}if(d&&d.cellStyles){if(C=mt(g.slice(O,x),!0),E=C.r!=null?parseInt(C.r,10):E+1,A=-1,d.sheetRows&&d.sheetRows<E)continue;ee={},le=!1,C.ht&&(le=!0,ee.hpt=parseFloat(C.ht),ee.hpx=fu(ee.hpt)),C.hidden=="1"&&(le=!0,ee.hidden=!0),C.outlineLevel!=null&&(le=!0,ee.level=+C.outlineLevel),le&&(B[E-1]=ee)}break;case"<":O=x;break}if(O>=x)break;if(C=mt(g.slice(O,x),!0),E=C.r!=null?parseInt(C.r,10):E+1,A=-1,!(d.sheetRows&&d.sheetRows<E)){f.s.r>E-1&&(f.s.r=E-1),f.e.r<E-1&&(f.e.r=E-1),d&&d.cellStyles&&(ee={},le=!1,C.ht&&(le=!0,ee.hpt=parseFloat(C.ht),ee.hpx=fu(ee.hpt)),C.hidden=="1"&&(le=!0,ee.hidden=!0),C.outlineLevel!=null&&(le=!0,ee.level=+C.outlineLevel),le&&(B[E-1]=ee)),y=g.slice(x).split(e);for(var K=0;K!=y.length&&y[K].trim().charAt(0)=="<";++K);for(y=y.slice(K),x=0;x!=y.length;++x)if(g=y[x].trim(),g.length!==0){if(v=g.match(r),b=x,w=0,k=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,v!=null&&v.length===2){for(b=0,S=v[1],w=0;w!=S.length&&!((k=S.charCodeAt(w)-64)<1||k>26);++w)b=26*b+k;--b,A=b}else++A;for(w=0;w!=g.length&&g.charCodeAt(w)!==62;++w);if(++w,C=mt(g.slice(0,w),!0),C.r||(C.r=ht({r:E-1,c:A})),S=g.slice(w),_={t:""},(v=S.match(i))!=null&&v[1]!==""&&(_.v=It(v[1])),d.cellFormula){if((v=S.match(s))!=null&&v[1]!==""){if(_.f=It(Vt(v[1])).replace(/\r\n/g,`
`),d.xlfn||(_.f=ZE(_.f)),v[0].indexOf('t="array"')>-1)_.F=(S.match(a)||[])[1],_.F.indexOf(":")>-1&&L.push([Tt(_.F),_.F]);else if(v[0].indexOf('t="shared"')>-1){D=mt(v[0]);var G=It(Vt(v[1]));d.xlfn||(G=ZE(G)),W[parseInt(D.si,10)]=[D,G,C.r]}}else(v=S.match(/<f[^>]*\/>/))&&(D=mt(v[0]),W[D.si]&&(_.f=Rse(W[D.si][1],W[D.si][2],C.r)));var te=yr(C.r);for(w=0;w<L.length;++w)te.r>=L[w][0].s.r&&te.r<=L[w][0].e.r&&te.c>=L[w][0].s.c&&te.c<=L[w][0].e.c&&(_.F=L[w][1])}if(C.t==null&&_.v===void 0)if(_.f||_.F)_.v=0,_.t="n";else if(R)_.t="z";else continue;else _.t=C.t||"n";switch(f.s.c>A&&(f.s.c=A),f.e.c<A&&(f.e.c=A),_.t){case"n":if(_.v==""||_.v==null){if(!R)continue;_.t="z"}else _.v=parseFloat(_.v);break;case"s":if(typeof _.v>"u"){if(!R)continue;_.t="z"}else T=Td[parseInt(_.v,10)],_.v=T.t,_.r=T.r,d.cellHTML&&(_.h=T.h);break;case"str":_.t="s",_.v=_.v!=null?Vt(_.v):"",d.cellHTML&&(_.h=B2(_.v));break;case"inlineStr":v=S.match(n),_.t="s",v!=null&&(T=rN(v[1]))?(_.v=T.t,d.cellHTML&&(_.h=T.h)):_.v="";break;case"b":_.v=ar(_.v);break;case"d":d.cellDates?_.v=or(_.v,1):(_.v=Jr(or(_.v,1)),_.t="n");break;case"e":(!d||d.cellText!==!1)&&(_.w=_.v),_.v=NI[_.v];break}if(I=z=0,H=null,X&&C.s!==void 0&&(H=p.CellXf[C.s],H!=null&&(H.numFmtId!=null&&(I=H.numFmtId),d.cellStyles&&H.fillId!=null&&(z=H.fillId))),vR(_,I,z,d,m,p),d.cellDates&&X&&_.t=="n"&&Xl(ut[I])&&(_.t="d",_.v=Ag(_.v)),C.cm&&d.xlmeta){var ce=(d.xlmeta.Cell||[])[+C.cm-1];ce&&ce.type=="XLDAPR"&&(_.D=!0)}if(ie){var M=yr(C.r);u[M.r]||(u[M.r]=[]),u[M.r][M.c]=_}else u[C.r]=_}}}}B.length>0&&(u["!rows"]=B)}}();function jle(e,t,r,n){var a=[],i=[],s=Tt(e["!ref"]),o="",c,u="",d=[],f=0,m=0,p=e["!rows"],x=Array.isArray(e),g={r:u},y,v=-1;for(m=s.s.c;m<=s.e.c;++m)d[m]=sr(m);for(f=s.s.r;f<=s.e.r;++f){for(i=[],u=Cr(f),m=s.s.c;m<=s.e.c;++m){c=d[m]+u;var b=x?(e[f]||[])[m]:e[c];b!==void 0&&(o=Lle(b,c,e,t))!=null&&i.push(o)}(i.length>0||p&&p[f])&&(g={r:u},p&&p[f]&&(y=p[f],y.hidden&&(g.hidden=1),v=-1,y.hpx?v=bf(y.hpx):y.hpt&&(v=y.hpt),v>-1&&(g.ht=v,g.customHeight=1),y.level&&(g.outlineLevel=y.level)),a[a.length]=Ue("row",i.join(""),g))}if(p)for(;f<p.length;++f)p&&p[f]&&(g={r:f+1},y=p[f],y.hidden&&(g.hidden=1),v=-1,y.hpx?v=bf(y.hpx):y.hpt&&(v=y.hpt),v>-1&&(g.ht=v,g.customHeight=1),y.level&&(g.outlineLevel=y.level),a[a.length]=Ue("row","",g));return a.join("")}function wR(e,t,r,n){var a=[Dr,Ue("worksheet",null,{xmlns:Yl[0],"xmlns:r":qr.r})],i=r.SheetNames[e],s=0,o="",c=r.Sheets[i];c==null&&(c={});var u=c["!ref"]||"A1",d=Tt(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=bt(d)}n||(n={}),c["!comments"]=[];var f=[];kle(c,r,e,t,a),a[a.length]=Ue("dimension",null,{ref:u}),a[a.length]=Mle(c,t,e,r),t.sheetFormat&&(a[a.length]=Ue("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=Ole(c,c["!cols"])),a[s=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=jle(c,t),o.length>0&&(a[a.length]=o)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),c["!protect"]&&(a[a.length]=Cle(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=Ile(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=wle(c["!merges"]));var m=-1,p,x=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(g){g[1].Target&&(p={ref:g[0]},g[1].Target.charAt(0)!="#"&&(x=Ut(n,-1,Ht(g[1].Target).replace(/#.*$/,""),St.HLINK),p["r:id"]="rId"+x),(m=g[1].Target.indexOf("#"))>-1&&(p.location=Ht(g[1].Target.slice(m+1))),g[1].Tooltip&&(p.tooltip=Ht(g[1].Tooltip)),a[a.length]=Ue("hyperlink",null,p))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=Tle(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=yn("ignoredErrors",Ue("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(x=Ut(n,-1,"../drawings/drawing"+(e+1)+".xml",St.DRAW),a[a.length]=Ue("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=f),c["!comments"].length>0&&(x=Ut(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",St.VML),a[a.length]=Ue("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function $le(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function Ule(e,t,r){var n=_e(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=bf(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,m=-1,p=d<<10;p<d+1<<10;++p){u.c=p;var x=Array.isArray(r)?(r[u.r]||[])[u.c]:r[ht(u)];x&&(f<0&&(f=p),m=p)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,m))}var g=n.l;return n.l=c,n.write_shift(4,o),n.l=g,n.length>n.l?n.slice(0,n.l):n}function zle(e,t,r,n){var a=Ule(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&Pe(e,0,a)}var Hle=ec,Wle=Fu;function Gle(){}function Vle(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Xte(e),r}function Kle(e,t,r){r==null&&(r=_e(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return Ym({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),xI(e,r),r.slice(0,r.l)}function qle(e){var t=gi(e);return[t]}function Xle(e,t,r){return r==null&&(r=_e(8)),Jl(t,r)}function Yle(e){var t=Ql(e);return[t]}function Jle(e,t,r){return r==null&&(r=_e(4)),Zl(t,r)}function Qle(e){var t=gi(e),r=e.read_shift(1);return[t,r,"b"]}function Zle(e,t,r){return r==null&&(r=_e(9)),Jl(t,r),r.write_shift(1,e.v?1:0),r}function ece(e){var t=Ql(e),r=e.read_shift(1);return[t,r,"b"]}function tce(e,t,r){return r==null&&(r=_e(5)),Zl(t,r),r.write_shift(1,e.v?1:0),r}function rce(e){var t=gi(e),r=e.read_shift(1);return[t,r,"e"]}function nce(e,t,r){return r==null&&(r=_e(9)),Jl(t,r),r.write_shift(1,e.v),r}function ace(e){var t=Ql(e),r=e.read_shift(1);return[t,r,"e"]}function ice(e,t,r){return r==null&&(r=_e(8)),Zl(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function sce(e){var t=gi(e),r=e.read_shift(4);return[t,r,"s"]}function oce(e,t,r){return r==null&&(r=_e(12)),Jl(t,r),r.write_shift(4,t.v),r}function lce(e){var t=Ql(e),r=e.read_shift(4);return[t,r,"s"]}function cce(e,t,r){return r==null&&(r=_e(8)),Zl(t,r),r.write_shift(4,t.v),r}function uce(e){var t=gi(e),r=Ln(e);return[t,r,"n"]}function dce(e,t,r){return r==null&&(r=_e(16)),Jl(t,r),$l(e.v,r),r}function NR(e){var t=Ql(e),r=Ln(e);return[t,r,"n"]}function fce(e,t,r){return r==null&&(r=_e(12)),Zl(t,r),$l(e.v,r),r}function hce(e){var t=gi(e),r=J2(e);return[t,r,"n"]}function mce(e,t,r){return r==null&&(r=_e(12)),Jl(t,r),yI(e.v,r),r}function pce(e){var t=Ql(e),r=J2(e);return[t,r,"n"]}function gce(e,t,r){return r==null&&(r=_e(8)),Zl(t,r),yI(e.v,r),r}function xce(e){var t=gi(e),r=q2(e);return[t,r,"is"]}function yce(e){var t=gi(e),r=$n(e);return[t,r,"str"]}function vce(e,t,r){return r==null&&(r=_e(12+4*e.v.length)),Jl(t,r),cn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function bce(e){var t=Ql(e),r=$n(e);return[t,r,"str"]}function wce(e,t,r){return r==null&&(r=_e(8+4*e.v.length)),Zl(t,r),cn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Nce(e,t,r){var n=e.l+t,a=gi(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(r.cellFormula){e.l+=2;var o=Dg(e,n-e.l,r);s[3]=On(o,null,a,r.supbooks,r)}else e.l=n;return s}function kce(e,t,r){var n=e.l+t,a=gi(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(r.cellFormula){e.l+=2;var o=Dg(e,n-e.l,r);s[3]=On(o,null,a,r.supbooks,r)}else e.l=n;return s}function Sce(e,t,r){var n=e.l+t,a=gi(e);a.r=r["!row"];var i=Ln(e),s=[a,i,"n"];if(r.cellFormula){e.l+=2;var o=Dg(e,n-e.l,r);s[3]=On(o,null,a,r.supbooks,r)}else e.l=n;return s}function _ce(e,t,r){var n=e.l+t,a=gi(e);a.r=r["!row"];var i=$n(e),s=[a,i,"str"];if(r.cellFormula){e.l+=2;var o=Dg(e,n-e.l,r);s[3]=On(o,null,a,r.supbooks,r)}else e.l=n;return s}var Cce=ec,Ece=Fu;function Ace(e,t){return t==null&&(t=_e(4)),t.write_shift(4,e),t}function Tce(e,t){var r=e.l+t,n=ec(e),a=X2(e),i=$n(e),s=$n(e),o=$n(e);e.l=r;var c={rfx:n,relId:a,loc:i,display:o};return s&&(c.Tooltip=s),c}function Pce(e,t){var r=_e(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Fu({s:yr(e[0]),e:yr(e[0])},r),Y2("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return cn(a||"",r),cn(e[1].Tooltip||"",r),cn("",r),r.slice(0,r.l)}function Oce(){}function Dce(e,t,r){var n=e.l+t,a=vI(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var o=rle(e,n-e.l,r);s[1]=o}else e.l=n;return s}function Ice(e,t,r){var n=e.l+t,a=ec(e),i=[a];if(r.cellFormula){var s=ale(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}function Rce(e,t,r){r==null&&(r=_e(18));var n=Ig(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var kR=["left","right","top","bottom","header","footer"];function Fce(e){var t={};return kR.forEach(function(r){t[r]=Ln(e)}),t}function Mce(e,t){return t==null&&(t=_e(6*8)),wl(e),kR.forEach(function(r){$l(e[r],t)}),t}function Lce(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Bce(e,t,r){r==null&&(r=_e(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function jce(e){var t=_e(24);return t.write_shift(4,4),t.write_shift(4,1),Fu(e,t),t}function $ce(e,t){return t==null&&(t=_e(16*4+2)),t.write_shift(2,e.password?nN(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Uce(){}function zce(){}function Hce(e,t,r,n,a,i,s){if(!e)return e;var o=t||{};n||(n={"!id":{}});var c=o.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,m=!1,p,x,g,y,v,b,w,k,S,_=[];o.biff=12,o["!row"]=0;var C=0,E=!1,A=[],T={},D=o.supbooks||a.supbooks||[[]];if(D.sharedf=T,D.arrayf=A,D.SheetNames=a.SheetNames||a.Sheets.map(function(ie){return ie.name}),!o.supbooks&&(o.supbooks=D,a.Names))for(var I=0;I<a.Names.length;++I)D[0][I+1]=a.Names[I];var z=[],X=[],H=!1;wf[16]={n:"BrtShortReal",f:NR};var L;if(Xs(e,function(B,ee,le){if(!m)switch(le){case 148:u=B;break;case 0:p=B,o.sheetRows&&o.sheetRows<=p.r&&(m=!0),k=Cr(y=p.r),o["!row"]=p.r,(B.hidden||B.hpt||B.level!=null)&&(B.hpt&&(B.hpx=fu(B.hpt)),X[B.r]=B);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:B[2]},B[2]){case"n":x.v=B[1];break;case"s":w=Td[B[1]],x.v=w.t,x.r=w.r;break;case"b":x.v=!!B[1];break;case"e":x.v=B[1],o.cellText!==!1&&(x.w=Ys[x.v]);break;case"str":x.t="s",x.v=B[1];break;case"is":x.t="s",x.v=B[1].t;break}if((g=s.CellXf[B[0].iStyleRef])&&vR(x,g.numFmtId,null,o,i,s),v=B[0].c==-1?v+1:B[0].c,o.dense?(c[y]||(c[y]=[]),c[y][v]=x):c[sr(v)+k]=x,o.cellFormula){for(E=!1,C=0;C<A.length;++C){var R=A[C];p.r>=R[0].s.r&&p.r<=R[0].e.r&&v>=R[0].s.c&&v<=R[0].e.c&&(x.F=bt(R[0]),E=!0)}!E&&B.length>3&&(x.f=B[3])}if(d.s.r>p.r&&(d.s.r=p.r),d.s.c>v&&(d.s.c=v),d.e.r<p.r&&(d.e.r=p.r),d.e.c<v&&(d.e.c=v),o.cellDates&&g&&x.t=="n"&&Xl(ut[g.numFmtId])){var j=uo(x.v);j&&(x.t="d",x.v=new Date(j.y,j.m-1,j.d,j.H,j.M,j.S,j.u))}L&&(L.type=="XLDAPR"&&(x.D=!0),L=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;x={t:"z",v:void 0},v=B[0].c==-1?v+1:B[0].c,o.dense?(c[y]||(c[y]=[]),c[y][v]=x):c[sr(v)+k]=x,d.s.r>p.r&&(d.s.r=p.r),d.s.c>v&&(d.s.c=v),d.e.r<p.r&&(d.e.r=p.r),d.e.c<v&&(d.e.c=v),L&&(L.type=="XLDAPR"&&(x.D=!0),L=void 0);break;case 176:_.push(B);break;case 49:L=((o.xlmeta||{}).Cell||[])[B-1];break;case 494:var V=n["!id"][B.relId];for(V?(B.Target=V.Target,B.loc&&(B.Target+="#"+B.loc),B.Rel=V):B.relId==""&&(B.Target="#"+B.loc),y=B.rfx.s.r;y<=B.rfx.e.r;++y)for(v=B.rfx.s.c;v<=B.rfx.e.c;++v)o.dense?(c[y]||(c[y]=[]),c[y][v]||(c[y][v]={t:"z",v:void 0}),c[y][v].l=B):(b=ht({c:v,r:y}),c[b]||(c[b]={t:"z",v:void 0}),c[b].l=B);break;case 426:if(!o.cellFormula)break;A.push(B),S=o.dense?c[y][v]:c[sr(v)+k],S.f=On(B[1],d,{r:p.r,c:v},D,o),S.F=bt(B[0]);break;case 427:if(!o.cellFormula)break;T[ht(B[0].s)]=B[1],S=o.dense?c[y][v]:c[sr(v)+k],S.f=On(B[1],d,{r:p.r,c:v},D,o);break;case 60:if(!o.cellStyles)break;for(;B.e>=B.s;)z[B.e--]={width:B.w/256,hidden:!!(B.flags&1),level:B.level},H||(H=!0,aN(B.w/256)),Io(z[B.e+1]);break;case 161:c["!autofilter"]={ref:bt(B)};break;case 476:c["!margins"]=B;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),B.name&&(a.Sheets[r].CodeName=B.name),(B.above||B.left)&&(c["!outline"]={above:B.above,left:B.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),B.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!ee.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+le.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=bt(u||d)),o.sheetRows&&c["!ref"]){var W=Tt(c["!ref"]);o.sheetRows<=+W.e.r&&(W.e.r=o.sheetRows-1,W.e.r>d.e.r&&(W.e.r=d.e.r),W.e.r<W.s.r&&(W.s.r=W.e.r),W.e.c>d.e.c&&(W.e.c=d.e.c),W.e.c<W.s.c&&(W.s.c=W.e.c),c["!fullref"]=c["!ref"],c["!ref"]=bt(W))}return _.length>0&&(c["!merges"]=_),z.length>0&&(c["!cols"]=z),X.length>0&&(c["!rows"]=X),c}function Wce(e,t,r,n,a,i,s){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=qt(t),t.z=t.z||ut[14],t.v=Jr(or(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:n};switch(c.s=Vo(a.cellXfs,t,a),t.l&&i["!links"].push([ht(c),t.l]),t.c&&i["!comments"].push([ht(c),t.c]),t.t){case"s":case"str":return a.bookSST?(o=cN(a.Strings,t.v,a.revStrings),c.t="s",c.v=o,s?Pe(e,18,cce(t,c)):Pe(e,7,oce(t,c))):(c.t="str",s?Pe(e,17,wce(t,c)):Pe(e,6,vce(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?Pe(e,13,gce(t,c)):Pe(e,2,mce(t,c)):s?Pe(e,16,fce(t,c)):Pe(e,5,dce(t,c)),!0;case"b":return c.t="b",s?Pe(e,15,tce(t,c)):Pe(e,4,Zle(t,c)),!0;case"e":return c.t="e",s?Pe(e,14,ice(t,c)):Pe(e,3,nce(t,c)),!0}return s?Pe(e,12,Jle(t,c)):Pe(e,1,Xle(t,c)),!0}function Gce(e,t,r,n){var a=Tt(t["!ref"]||"A1"),i,s="",o=[];Pe(e,145);var c=Array.isArray(t),u=a.e.r;t["!rows"]&&(u=Math.max(a.e.r,t["!rows"].length-1));for(var d=a.s.r;d<=u;++d){s=Cr(d),zle(e,t,a,d);var f=!1;if(d<=a.e.r)for(var m=a.s.c;m<=a.e.c;++m){d===a.s.r&&(o[m]=sr(m)),i=o[m]+s;var p=c?(t[d]||[])[m]:t[i];if(!p){f=!1;continue}f=Wce(e,p,d,m,n,t,f)}}Pe(e,146)}function Vce(e,t){!t||!t["!merges"]||(Pe(e,177,Ace(t["!merges"].length)),t["!merges"].forEach(function(r){Pe(e,176,Ece(r))}),Pe(e,178))}function Kce(e,t){!t||!t["!cols"]||(Pe(e,390),t["!cols"].forEach(function(r,n){r&&Pe(e,60,Rce(n,r))}),Pe(e,391))}function qce(e,t){!t||!t["!ref"]||(Pe(e,648),Pe(e,649,jce(Tt(t["!ref"]))),Pe(e,650))}function Xce(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=Ut(r,-1,n[1].Target.replace(/#.*$/,""),St.HLINK);Pe(e,494,Pce(n,a))}}),delete t["!links"]}function Yce(e,t,r,n){if(t["!comments"].length>0){var a=Ut(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",St.VML);Pe(e,551,Y2("rId"+a)),t["!legacy"]=a}}function Jce(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:bt(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=ta(i);o.s.r==o.e.r&&(o.e.r=ta(t["!ref"]).e.r,i=bt(o));for(var c=0;c<s.length;++c){var u=s[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+i;break}}c==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Pe(e,161,Fu(Tt(i))),Pe(e,162)}}function Qce(e,t,r){Pe(e,133),Pe(e,137,Bce(t,r)),Pe(e,138),Pe(e,134)}function Zce(e,t){t["!protect"]&&Pe(e,535,$ce(t["!protect"]))}function eue(e,t,r,n){var a=pa(),i=r.SheetNames[e],s=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=Tt(s["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],Pe(a,129),(r.vbaraw||s["!outline"])&&Pe(a,147,Kle(o,s["!outline"])),Pe(a,148,Wle(c)),Qce(a,s,r.Workbook),Kce(a,s),Gce(a,s,e,t),Zce(a,s),Jce(a,s,r,e),Vce(a,s),Xce(a,s,n),s["!margins"]&&Pe(a,476,Mce(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&qce(a,s),Yce(a,s,e,n),Pe(a,130),a.end()}function tue(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=r?+s[2]:s[2])});var a=It((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function rue(e,t,r,n,a,i){var s=i||{"!type":"chart"};if(!e)return i;var o=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var m=tue(f);d.s.r=d.s.c=0,d.e.c=o,u=sr(o),m[0].forEach(function(p,x){s[u+Cr(x)]={t:"n",v:p,z:m[1]},c=x}),d.e.r<c&&(d.e.r=c),++o}),o>0&&(s["!ref"]=bt(d)),s}function nue(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,o=e.match(bR);return o&&uN(o[0],i,a,r),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function aue(e,t){e.l+=10;var r=$n(e);return{name:r}}function iue(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=!1;return Xs(e,function(c,u,d){switch(d){case 550:i["!rel"]=c;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),c.name&&(a.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var dN=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],sue=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],oue=[],lue=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function a4(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=ar(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function i4(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=ar(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function SR(e){i4(e.WBProps,dN),i4(e.CalcPr,lue),a4(e.WBView,sue),a4(e.Sheets,oue),Wc.date1904=ar(e.WBProps.date1904)}function cue(e){return!e.Workbook||!e.Workbook.WBProps?"false":ar(e.Workbook.WBProps.date1904)?"true":"false"}var uue="][*?/\\".split("");function _R(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return uue.forEach(function(n){if(e.indexOf(n)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}function due(e,t,r){e.forEach(function(n,a){_R(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[a]&&t[a].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function CR(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];due(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)cle(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var fue=/<\w+:workbook/;function hue(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},s=0;if(e.replace(Wn,function(c,u){var d=mt(c);switch(ss(d[0])){case"<?xml":break;case"<workbook":c.match(fue)&&(a="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[a];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":dN.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=ar(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=Vt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=It(Vt(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Vt(d.name),d.comment&&(i.Comment=d.comment),d.localSheetId&&(i.Sheet=+d.localSheetId),ar(d.hidden||"0")&&(i.Hidden=!0),s=u+c.length;break;case"</definedName>":i.Ref=It(Vt(e.slice(s,u))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),Yl.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return SR(r),r}function ER(e){var t=[Dr];t[t.length]=Ue("workbook",null,{xmlns:Yl[0],"xmlns:r":qr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(dN.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Ue("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:Ht(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=Ue("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=Ue("definedName",Ht(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function mue(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Zv(e),r.name=$n(e),r}function pue(e,t){return t||(t=_e(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Y2(e.strRelID,t),cn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function gue(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?$n(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function xue(e,t){t||(t=_e(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),xI(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function yue(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function vue(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=Yte(e),s=nle(e,0,r),o=X2(e);e.l=n;var c={Name:i,Ptg:s};return a<268435455&&(c.Sheet=a),o&&(c.Comment=o),c}function bue(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],wf[16]={n:"BrtFRTArchID$",f:yue},Xs(e,function(c,u,d){switch(d){case 156:s.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=On(c.Ptg,null,null,s,t),delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([d,c]):s[0]=[d,c],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(c),s.XTI=s.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(d),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!u.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),SR(r),r.Names=i,r.supbooks=s,r}function wue(e,t){Pe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Pe(e,156,pue(a))}Pe(e,144)}function Nue(e,t){t||(t=_e(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return cn("SheetJS",t),cn(uf.version,t),cn(uf.version,t),cn("7262",t),t.length>t.l?t.slice(0,t.l):t}function kue(e,t){t||(t=_e(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function Sue(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(Pe(e,135),Pe(e,158,kue(a)),Pe(e,136))}}function _ue(e,t){var r=pa();return Pe(r,131),Pe(r,128,Nue()),Pe(r,153,xue(e.Workbook&&e.Workbook.WBProps||null)),Sue(r,e),wue(r,e),Pe(r,132),r.end()}function Cue(e,t,r){return t.slice(-4)===".bin"?bue(e,r):hue(e,r)}function Eue(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?Hce(e,n,r,a,i,s,o):ble(e,n,r,a,i,s,o)}function Aue(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?iue(e,n,r,a,i):nue(e,n,r,a,i)}function Tue(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?Dse():Ise()}function Pue(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?Pse():Ose()}function Oue(e,t,r,n){return t.slice(-4)===".bin"?Eie(e,r,n):pie(e,r,n)}function Due(e,t,r){return sR(e,r)}function Iue(e,t,r){return t.slice(-4)===".bin"?Rae(e,r):Oae(e,r)}function Rue(e,t,r){return t.slice(-4)===".bin"?_se(e,r):gse(e,r)}function Fue(e,t,r){return t.slice(-4)===".bin"?hse(e):dse(e)}function Mue(e,t,r,n){return r.slice(-4)===".bin"?mse(e,t,r,n):void 0}function Lue(e,t,r){return t.slice(-4)===".bin"?lse(e,t,r):use(e,t,r)}function Bue(e,t,r){return(t.slice(-4)===".bin"?_ue:ER)(e)}function jue(e,t,r,n,a){return(t.slice(-4)===".bin"?eue:wR)(e,r,n,a)}function $ue(e,t,r){return(t.slice(-4)===".bin"?Lie:aR)(e,r)}function Uue(e,t,r){return(t.slice(-4)===".bin"?Lae:YI)(e,r)}function zue(e,t,r){return(t.slice(-4)===".bin"?Cse:cR)(e)}function Hue(e){return(e.slice(-4)===".bin"?cse:oR)()}var AR=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,TR=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function wi(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),r.length===1)return n;var a=e.match(AR),i,s,o,c;if(a)for(c=0;c!=a.length;++c)i=a[c].match(TR),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),n[o]=i[2].slice(1,i[2].length-1));return n}function Wue(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(AR),a,i,s,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(TR),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(i+1),r[s]=a[2].slice(1,a[2].length-1));return r}var Od;function Gue(e,t){var r=Od[e]||It(e);return r==="General"?Bl(t):Ba(r,t)}function Vue(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=ar(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=or(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[It(t)]=a}function Kue(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Ys[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ff(e.v):e.w=Bl(e.v):e.w=Gue(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=Od[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Xl(n)){var a=uo(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function que(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=oie[n.Pattern]||n.Pattern)}e[t.ID]=t}function Xue(e,t,r,n,a,i,s,o,c,u){var d="General",f=n.StyleID,m={};u=u||{};var p=[],x=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&s&&(f=s.StyleID);i[f]!==void 0&&(i[f].nf&&(d=i[f].nf),i[f].Interior&&p.push(i[f].Interior),!!i[f].Parent);)f=i[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=ar(e);break;case"String":n.t="s",n.r=NE(It(e)),n.v=e.indexOf("<")>-1?It(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(or(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=It(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=NI[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=NE(t||e));break}if(Kue(n,d,u),u.cellFormula!==!1)if(n.Formula){var g=It(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=Hc(g,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Hc("RC:RC",a):n.ArrayRange&&(n.F=Hc(n.ArrayRange,a),c.push([Tt(n.F),n.F]))}else for(x=0;x<c.length;++x)a.r>=c[x][0].s.r&&a.r<=c[x][0].e.r&&a.c>=c[x][0].s.c&&a.c<=c[x][0].e.c&&(n.F=c[x][1]);u.cellStyles&&(p.forEach(function(y){!m.patternType&&y.patternType&&(m.patternType=y.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Yue(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function qx(e,t){var r=t||{};Du();var n=Oc(j2(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(typeof Pt<"u"?n=Pt.utils.decode(65001,Hm(n)):n=Vt(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var s=qt(r);return s.type="string",du.to_workbook(n,s)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(de){a.indexOf("<"+de)>=0&&(i=!0)}),i)return Dde(n,r);Od={"General Number":"General","General Date":ut[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ut[15],"Short Date":ut[14],"Long Time":ut[19],"Medium Time":ut[18],"Short Time":ut[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ut[2],Standard:ut[4],Percent:ut[10],Scientific:ut[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],u,d={},f=[],m=r.dense?[]:{},p="",x={},g={},y=wi('<Data ss:Type="String">'),v=0,b=0,w=0,k={s:{r:2e6,c:2e6},e:{r:0,c:0}},S={},_={},C="",E=0,A=[],T={},D={},I=0,z=[],X=[],H={},L=[],W,ie=!1,B=[],ee=[],le={},R=0,j=0,V={Sheets:[],WBProps:{date1904:!1}},P={};pf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var q="";o=pf.exec(n);)switch(o[3]=(q=o[3]).toLowerCase()){case"data":if(q=="data"){if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?Xue(n.slice(v,o.index),C,y,c[c.length-1][0]=="comment"?H:x,{c:b,r:w},S,L[b],g,B,r):(C="",y=wi(o[0]),v=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(X.length>0&&(x.c=X),(!r.sheetRows||r.sheetRows>w)&&x.v!==void 0&&(r.dense?(m[w]||(m[w]=[]),m[w][b]=x):m[sr(b)+Cr(w)]=x),x.HRef&&(x.l={Target:It(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(R=b+(parseInt(x.MergeAcross,10)|0),j=w+(parseInt(x.MergeDown,10)|0),A.push({s:{c:b,r:w},e:{c:R,r:j}})),!r.sheetStubs)x.MergeAcross?b=R+1:++b;else if(x.MergeAcross||x.MergeDown){for(var O=b;O<=R;++O)for(var K=w;K<=j;++K)(O>b||K>w)&&(r.dense?(m[K]||(m[K]=[]),m[K][O]={t:"z"}):m[sr(O)+Cr(K)]={t:"z"});b=R+1}else++b;else x=Wue(o[0]),x.Index&&(b=+x.Index-1),b<k.s.c&&(k.s.c=b),b>k.e.c&&(k.e.c=b),o[0].slice(-2)==="/>"&&++b,X=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(w<k.s.r&&(k.s.r=w),w>k.e.r&&(k.e.r=w),o[0].slice(-2)==="/>"&&(g=wi(o[0]),g.Index&&(w=+g.Index-1)),b=0,++w):(g=wi(o[0]),g.Index&&(w=+g.Index-1),le={},(g.AutoFitHeight=="0"||g.Height)&&(le.hpx=parseInt(g.Height,10),le.hpt=bf(le.hpx),ee[w]=le),g.Hidden=="1"&&(le.hidden=!0,ee[w]=le));break;case"worksheet":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));f.push(p),k.s.r<=k.e.r&&k.s.c<=k.e.c&&(m["!ref"]=bt(k),r.sheetRows&&r.sheetRows<=k.e.r&&(m["!fullref"]=m["!ref"],k.e.r=r.sheetRows-1,m["!ref"]=bt(k))),A.length&&(m["!merges"]=A),L.length>0&&(m["!cols"]=L),ee.length>0&&(m["!rows"]=ee),d[p]=m}else k={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=b=0,c.push([o[3],!1]),u=wi(o[0]),p=It(u.Name),m=r.dense?[]:{},A=[],B=[],ee=[],P={name:p,Hidden:0},V.Sheets.push(P);break;case"table":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),L=[],ie=!1}break;case"style":o[1]==="/"?que(S,_,r):_=wi(o[0]);break;case"numberformat":_.nf=It(wi(o[0]).Format||"General"),Od[_.nf]&&(_.nf=Od[_.nf]);for(var G=0;G!=392&&ut[G]!=_.nf;++G);if(G==392){for(G=57;G!=392;++G)if(ut[G]==null){es(_.nf,G);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(W=wi(o[0]),W.Hidden&&(W.hidden=!0,delete W.Hidden),W.Width&&(W.wpx=parseInt(W.Width,10)),!ie&&W.wpx>10){ie=!0,Rn=rR;for(var te=0;te<L.length;++te)L[te]&&Io(L[te])}ie&&Io(W),L[W.Index-1||L.length]=W;for(var ce=0;ce<+W.Span;++ce)L[L.length]=qt(W);break;case"namedrange":if(o[1]==="/")break;V.Names||(V.Names=[]);var M=mt(o[0]),Le={Name:M.Name,Ref:Hc(M.RefersTo.slice(1),{r:0,c:0})};V.Sheets.length>0&&(Le.Sheet=V.Sheets.length-1),V.Names.push(Le);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?C+=n.slice(E,o.index):E=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;_.Interior=wi(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?wre(T,q,n.slice(I,o.index)):I=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));Yue(H),X.push(H)}else c.push([o[3],!1]),u=wi(o[0]),H={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Te=wi(o[0]);m["!autofilter"]={ref:Hc(Te.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return u4(n,r);var je=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:je=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:je=!1}break;case"excelworkbook":switch(o[3]){case"date1904":V.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:je=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:je=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(I,o.index)){case"SheetHidden":P.Hidden=1;break;case"SheetVeryHidden":P.Hidden=2;break}else I=o.index+o[0].length;break;case"header":m["!margins"]||wl(m["!margins"]={},"xlml"),isNaN(+mt(o[0]).Margin)||(m["!margins"].header=+mt(o[0]).Margin);break;case"footer":m["!margins"]||wl(m["!margins"]={},"xlml"),isNaN(+mt(o[0]).Margin)||(m["!margins"].footer=+mt(o[0]).Margin);break;case"pagemargins":var ze=mt(o[0]);m["!margins"]||wl(m["!margins"]={},"xlml"),isNaN(+ze.Top)||(m["!margins"].top=+ze.Top),isNaN(+ze.Left)||(m["!margins"].left=+ze.Left),isNaN(+ze.Right)||(m["!margins"].right=+ze.Right),isNaN(+ze.Bottom)||(m["!margins"].bottom=+ze.Bottom);break;case"displayrighttoleft":V.Views||(V.Views=[]),V.Views[0]||(V.Views[0]={}),V.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:je=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:je=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:je=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:je=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:je=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:je=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:je=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:je=!1}break;case"smarttags":break;default:je=!1;break}if(je||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?Vue(D,q,z,n.slice(I,o.index)):(z=o,I=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var Ce={};return!r.bookSheets&&!r.bookProps&&(Ce.Sheets=d),Ce.SheetNames=f,Ce.Workbook=V,Ce.SSF=qt(ut),Ce.Props=T,Ce.Custprops=D,Ce}function s1(e,t){switch(mN(t=t||{}),t.type||"base64"){case"base64":return qx(La(e),t);case"binary":case"buffer":case"file":return qx(e,t);case"array":return qx(Wo(e),t)}}function Jue(e,t){var r=[];return e.Props&&r.push(Nre(e.Props,t)),e.Custprops&&r.push(kre(e.Props,e.Custprops)),r.join("")}function Que(){return""}function Zue(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(Ue("NumberFormat",null,{"ss:Format":Ht(ut[n.numFmtId])}));var s={"ss:ID":"s"+(21+a)};r.push(Ue("Style",i.join(""),s))}),Ue("Styles",r.join(""))}function PR(e){return Ue("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+oN(e.Ref,{r:0,c:0})})}function ede(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(PR(a)))}return Ue("Names",r.join(""))}function tde(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],s=0;s<a.length;++s){var o=a[s];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(PR(o)))}return i.join("")}function rde(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Ue("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Ue("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Ue("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Ue("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(yn("ProtectContents","True")),e["!protect"].objects&&a.push(yn("ProtectObjects","True")),e["!protect"].scenarios&&a.push(yn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(yn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(yn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&a.push("<"+s[1]+"/>")})),a.length==0?"":Ue("WorksheetOptions",a.join(""),{xmlns:Na.x})}function nde(e){return e.map(function(t){var r=_te(t.t||""),n=Ue("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ue("Comment",n,{"ss:Author":t.a})}).join("")}function ade(e,t,r,n,a,i,s){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Ht(oN(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var c=yr(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==s.r?"":"["+(c.r-s.r)+"]")+"C"+(c.c==s.c?"":"["+(c.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Ht(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Ht(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=s.c||u[d].s.r!=s.r||(u[d].e.c>u[d].s.c&&(o["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(o["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",m="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",m=String(e.v);break;case"b":f="Boolean",m=e.v?"1":"0";break;case"e":f="Error",m=Ys[e.v];break;case"d":f="DateTime",m=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||ut[14]);break;case"s":f="String",m=Ste(e.v||"");break}var p=Vo(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=s.c+1;var x=e.v!=null?m:"",g=e.t=="z"?"":'<Data ss:Type="'+f+'">'+x+"</Data>";return(e.c||[]).length>0&&(g+=nde(e.c)),Ue("Cell",g,o)}function ide(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=fu(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function sde(e,t,r,n){if(!e["!ref"])return"";var a=Tt(e["!ref"]),i=e["!merges"]||[],s=0,o=[];e["!cols"]&&e["!cols"].forEach(function(y,v){Io(y);var b=!!y.width,w=Ig(v,y),k={"ss:Index":v+1};b&&(k["ss:Width"]=yf(w.width)),y.hidden&&(k["ss:Hidden"]="1"),o.push(Ue("Column",null,k))});for(var c=Array.isArray(e),u=a.s.r;u<=a.e.r;++u){for(var d=[ide(u,(e["!rows"]||[])[u])],f=a.s.c;f<=a.e.c;++f){var m=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>f)&&!(i[s].s.r>u)&&!(i[s].e.c<f)&&!(i[s].e.r<u)){(i[s].s.c!=f||i[s].s.r!=u)&&(m=!0);break}if(!m){var p={r:u,c:f},x=ht(p),g=c?(e[u]||[])[f]:e[x];d.push(ade(g,x,e,t,r,n,p))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function ode(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],s=i?tde(i,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=i?sde(i,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(rde(i,t,e,r)),n.join("")}function lde(e,t){t||(t={}),e.SSF||(e.SSF=qt(ut)),e.SSF&&(Du(),n0(e.SSF),t.revssf=Eg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Vo(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Jue(e,t)),r.push(Que()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Ue("Worksheet",ode(n,t,e),{"ss:Name":Ht(e.SheetNames[n])}));return r[2]=Zue(e,t),r[3]=ede(e),Dr+Ue("Workbook",r.join(""),{xmlns:Na.ss,"xmlns:o":Na.o,"xmlns:x":Na.x,"xmlns:ss":Na.ss,"xmlns:dt":Na.dt,"xmlns:html":Na.html})}function cde(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=tre(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=rre(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var ude=[60,1084,2066,2165,2175];function dde(e,t,r,n,a){var i=n,s=[],o=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}s.push(o),r.l+=i;for(var c=Ns(r,r.l),u=o1[c],d=0;u!=null&&ude.indexOf(c)>-1;)i=Ns(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),o=r.slice(d,r.l+4+i),s.push(o),r.l+=4+i,u=o1[c=Ns(r,r.l)];var f=on(s);xn(f,0);var m=0;f.lens=[];for(var p=0;p<s.length;++p)f.lens.push(m),m+=s[p].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,a)}function Ui(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ut[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ys[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ff(e.v):e.w=Bl(e.v):e.w=Ba(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&Xl(ut[n]||String(n))){var a=uo(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function ah(e,t,r){return{v:e,ixfe:t,t:r}}function fde(e,t){var r={opts:{}},n={},a=t.dense?[]:{},i={},s={},o=null,c=[],u="",d={},f,m="",p,x,g,y,v={},b=[],w,k,S=[],_=[],C={Sheets:[],WBProps:{date1904:!1},Views:[{}]},E={},A=function(He){return He<8?yl[He]:He<64&&_[He-8]||yl[He]},T=function(He,qe,xt){var dt=qe.XF.data;if(!(!dt||!dt.patternType||!xt||!xt.cellStyles)){qe.s={},qe.s.patternType=dt.patternType;var Y;(Y=xf(A(dt.icvFore)))&&(qe.s.fgColor={rgb:Y}),(Y=xf(A(dt.icvBack)))&&(qe.s.bgColor={rgb:Y})}},D=function(He,qe,xt){if(!(le>1)&&!(xt.sheetRows&&He.r>=xt.sheetRows)){if(xt.cellStyles&&qe.XF&&qe.XF.data&&T(He,qe,xt),delete qe.ixfe,delete qe.XF,f=He,m=ht(He),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),He.r<s.s.r&&(s.s.r=He.r),He.c<s.s.c&&(s.s.c=He.c),He.r+1>s.e.r&&(s.e.r=He.r+1),He.c+1>s.e.c&&(s.e.c=He.c+1),xt.cellFormula&&qe.f){for(var dt=0;dt<b.length;++dt)if(!(b[dt][0].s.c>He.c||b[dt][0].s.r>He.r)&&!(b[dt][0].e.c<He.c||b[dt][0].e.r<He.r)){qe.F=bt(b[dt][0]),(b[dt][0].s.c!=He.c||b[dt][0].s.r!=He.r)&&delete qe.f,qe.f&&(qe.f=""+On(b[dt][1],s,He,B,I));break}}xt.dense?(a[He.r]||(a[He.r]=[]),a[He.r][He.c]=qe):a[m]=qe}},I={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:b,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(I.password=t.password);var z,X=[],H=[],L=[],W=[],ie=!1,B=[];B.SheetNames=I.snames,B.sharedf=I.sharedf,B.arrayf=I.arrayf,B.names=[],B.XTI=[];var ee=0,le=0,R=0,j=[],V=[],P;I.codepage=1200,si(1200);for(var q=!1;e.l<e.length-1;){var O=e.l,K=e.read_shift(2);if(K===0&&ee===10)break;var G=e.l===e.length?0:e.read_shift(2),te=o1[K];if(te&&te.f){if(t.bookSheets&&ee===133&&K!==133)break;if(ee=K,te.r===2||te.r==12){var ce=e.read_shift(2);if(G-=2,!I.enc&&ce!==K&&((ce&255)<<8|ce>>8)!==K)throw new Error("rt mismatch: "+ce+"!="+K);te.r==12&&(e.l+=10,G-=10)}var M={};if(K===10?M=te.f(e,G,I):M=dde(K,te,e,G,I),le==0&&[9,521,1033,2057].indexOf(ee)===-1)continue;switch(K){case 34:r.opts.Date1904=C.WBProps.date1904=M;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(I.enc||(e.l=0),I.enc=M,!t.password)throw new Error("File is password-protected");if(M.valid==null)throw new Error("Encryption scheme unsupported");if(!M.valid)throw new Error("Password is incorrect");break;case 92:I.lastuser=M;break;case 66:var Le=Number(M);switch(Le){case 21010:Le=1200;break;case 32768:Le=1e4;break;case 32769:Le=1252;break}si(I.codepage=Le),q=!0;break;case 317:I.rrtabid=M;break;case 25:I.winlocked=M;break;case 439:r.opts.RefreshAll=M;break;case 12:r.opts.CalcCount=M;break;case 16:r.opts.CalcDelta=M;break;case 17:r.opts.CalcIter=M;break;case 13:r.opts.CalcMode=M;break;case 14:r.opts.CalcPrecision=M;break;case 95:r.opts.CalcSaveRecalc=M;break;case 15:I.CalcRefMode=M;break;case 2211:r.opts.FullCalc=M;break;case 129:M.fDialog&&(a["!type"]="dialog"),M.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),M.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:S.push(M);break;case 430:B.push([M]),B[B.length-1].XTI=[];break;case 35:case 547:B[B.length-1].push(M);break;case 24:case 536:P={Name:M.Name,Ref:On(M.rgce,s,null,B,I)},M.itab>0&&(P.Sheet=M.itab-1),B.names.push(P),B[0]||(B[0]=[],B[0].XTI=[]),B[B.length-1].push(M),M.Name=="_xlnm._FilterDatabase"&&M.itab>0&&M.rgce&&M.rgce[0]&&M.rgce[0][0]&&M.rgce[0][0][0]=="PtgArea3d"&&(V[M.itab-1]={ref:bt(M.rgce[0][0][1][2])});break;case 22:I.ExternCount=M;break;case 23:B.length==0&&(B[0]=[],B[0].XTI=[]),B[B.length-1].XTI=B[B.length-1].XTI.concat(M),B.XTI=B.XTI.concat(M);break;case 2196:if(I.biff<8)break;P!=null&&(P.Comment=M[1]);break;case 18:a["!protect"]=M;break;case 19:M!==0&&I.WTF&&console.error("Password verifier: "+M);break;case 133:i[M.pos]=M,I.snames.push(M.name);break;case 10:{if(--le)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=bt(s),t.sheetRows&&t.sheetRows<=s.e.r){var Te=s.e.r;s.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=bt(s),s.e.r=Te}s.e.r++,s.e.c++}X.length>0&&(a["!merges"]=X),H.length>0&&(a["!objects"]=H),L.length>0&&(a["!cols"]=L),W.length>0&&(a["!rows"]=W),C.Sheets.push(E)}u===""?d=a:n[u]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(I.biff===8&&(I.biff={9:2,521:3,1033:4}[K]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[M.BIFFVer]||8),I.biffguess=M.BIFFVer==0,M.BIFFVer==0&&M.dt==4096&&(I.biff=5,q=!0,si(I.codepage=28591)),I.biff==8&&M.BIFFVer==0&&M.dt==16&&(I.biff=2),le++)break;if(a=t.dense?[]:{},I.biff<8&&!q&&(q=!0,si(I.codepage=t.codepage||1252)),I.biff<5||M.BIFFVer==0&&M.dt==4096){u===""&&(u="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var je={pos:e.l-G,name:u};i[je.pos]=je,I.snames.push(u)}else u=(i[O]||{name:""}).name;M.dt==32&&(a["!type"]="chart"),M.dt==64&&(a["!type"]="macro"),X=[],H=[],I.arrayf=b=[],L=[],W=[],ie=!1,E={Hidden:(i[O]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[M.r]||[])[M.c]:a[ht({c:M.c,r:M.r})])&&++M.c,w={ixfe:M.ixfe,XF:S[M.ixfe]||{},v:M.val,t:"n"},R>0&&(w.z=j[w.ixfe>>8&63]),Ui(w,t,r.opts.Date1904),D({c:M.c,r:M.r},w,t);break;case 5:case 517:w={ixfe:M.ixfe,XF:S[M.ixfe],v:M.val,t:M.t},R>0&&(w.z=j[w.ixfe>>8&63]),Ui(w,t,r.opts.Date1904),D({c:M.c,r:M.r},w,t);break;case 638:w={ixfe:M.ixfe,XF:S[M.ixfe],v:M.rknum,t:"n"},R>0&&(w.z=j[w.ixfe>>8&63]),Ui(w,t,r.opts.Date1904),D({c:M.c,r:M.r},w,t);break;case 189:for(var ze=M.c;ze<=M.C;++ze){var Ce=M.rkrec[ze-M.c][0];w={ixfe:Ce,XF:S[Ce],v:M.rkrec[ze-M.c][1],t:"n"},R>0&&(w.z=j[w.ixfe>>8&63]),Ui(w,t,r.opts.Date1904),D({c:ze,r:M.r},w,t)}break;case 6:case 518:case 1030:{if(M.val=="String"){o=M;break}if(w=ah(M.val,M.cell.ixfe,M.tt),w.XF=S[w.ixfe],t.cellFormula){var de=M.formula;if(de&&de[0]&&de[0][0]&&de[0][0][0]=="PtgExp"){var $e=de[0][0][1][0],Re=de[0][0][1][1],Fe=ht({r:$e,c:Re});v[Fe]?w.f=""+On(M.formula,s,M.cell,B,I):w.F=((t.dense?(a[$e]||[])[Re]:a[Fe])||{}).F}else w.f=""+On(M.formula,s,M.cell,B,I)}R>0&&(w.z=j[w.ixfe>>8&63]),Ui(w,t,r.opts.Date1904),D(M.cell,w,t),o=M}break;case 7:case 519:if(o)o.val=M,w=ah(M,o.cell.ixfe,"s"),w.XF=S[w.ixfe],t.cellFormula&&(w.f=""+On(o.formula,s,o.cell,B,I)),R>0&&(w.z=j[w.ixfe>>8&63]),Ui(w,t,r.opts.Date1904),D(o.cell,w,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{b.push(M);var Me=ht(M[0].s);if(p=t.dense?(a[M[0].s.r]||[])[M[0].s.c]:a[Me],t.cellFormula&&p){if(!o||!Me||!p)break;p.f=""+On(M[1],s,M[0],B,I),p.F=bt(M[0])}}break;case 1212:{if(!t.cellFormula)break;if(m){if(!o)break;v[ht(o.cell)]=M[0],p=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[ht(o.cell)],(p||{}).f=""+On(M[0],s,f,B,I)}}break;case 253:w=ah(c[M.isst].t,M.ixfe,"s"),c[M.isst].h&&(w.h=c[M.isst].h),w.XF=S[w.ixfe],R>0&&(w.z=j[w.ixfe>>8&63]),Ui(w,t,r.opts.Date1904),D({c:M.c,r:M.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:M.ixfe,XF:S[M.ixfe],t:"z"},R>0&&(w.z=j[w.ixfe>>8&63]),Ui(w,t,r.opts.Date1904),D({c:M.c,r:M.r},w,t));break;case 190:if(t.sheetStubs)for(var Ge=M.c;Ge<=M.C;++Ge){var Qe=M.ixfe[Ge-M.c];w={ixfe:Qe,XF:S[Qe],t:"z"},R>0&&(w.z=j[w.ixfe>>8&63]),Ui(w,t,r.opts.Date1904),D({c:Ge,r:M.r},w,t)}break;case 214:case 516:case 4:w=ah(M.val,M.ixfe,"s"),w.XF=S[w.ixfe],R>0&&(w.z=j[w.ixfe>>8&63]),Ui(w,t,r.opts.Date1904),D({c:M.c,r:M.r},w,t);break;case 0:case 512:le===1&&(s=M);break;case 252:c=M;break;case 1054:if(I.biff==4){j[R++]=M[1];for(var we=0;we<R+163&&ut[we]!=M[1];++we);we>=163&&es(M[1],R+163)}else es(M[1],M[0]);break;case 30:{j[R++]=M;for(var pe=0;pe<R+163&&ut[pe]!=M;++pe);pe>=163&&es(M,R+163)}break;case 229:X=X.concat(M);break;case 93:H[M.cmo[0]]=I.lastobj=M;break;case 438:I.lastobj.TxO=M;break;case 127:I.lastobj.ImData=M;break;case 440:for(y=M[0].s.r;y<=M[0].e.r;++y)for(g=M[0].s.c;g<=M[0].e.c;++g)p=t.dense?(a[y]||[])[g]:a[ht({c:g,r:y})],p&&(p.l=M[1]);break;case 2048:for(y=M[0].s.r;y<=M[0].e.r;++y)for(g=M[0].s.c;g<=M[0].e.c;++g)p=t.dense?(a[y]||[])[g]:a[ht({c:g,r:y})],p&&p.l&&(p.l.Tooltip=M[1]);break;case 28:{if(I.biff<=5&&I.biff>=2)break;p=t.dense?(a[M[0].r]||[])[M[0].c]:a[ht(M[0])];var me=H[M[2]];p||(t.dense?(a[M[0].r]||(a[M[0].r]=[]),p=a[M[0].r][M[0].c]={t:"z"}):p=a[ht(M[0])]={t:"z"},s.e.r=Math.max(s.e.r,M[0].r),s.s.r=Math.min(s.s.r,M[0].r),s.e.c=Math.max(s.e.c,M[0].c),s.s.c=Math.min(s.s.c,M[0].c)),p.c||(p.c=[]),x={a:M[1],t:me.TxO.t},p.c.push(x)}break;case 2173:ese(S[M.ixfe],M.ext);break;case 125:{if(!I.cellStyles)break;for(;M.e>=M.s;)L[M.e--]={width:M.w/256,level:M.level||0,hidden:!!(M.flags&1)},ie||(ie=!0,aN(M.w/256)),Io(L[M.e+1])}break;case 520:{var Ae={};M.level!=null&&(W[M.r]=Ae,Ae.level=M.level),M.hidden&&(W[M.r]=Ae,Ae.hidden=!0),M.hpt&&(W[M.r]=Ae,Ae.hpt=M.hpt,Ae.hpx=fu(M.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||wl(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[K]]=M;break;case 161:a["!margins"]||wl(a["!margins"]={}),a["!margins"].header=M.header,a["!margins"].footer=M.footer;break;case 574:M.RTL&&(C.Views[0].RTL=!0);break;case 146:_=M;break;case 2198:z=M;break;case 140:k=M;break;case 442:u?E.CodeName=M||E.name:C.WBProps.CodeName=M||"ThisWorkbook";break}}else te||console.error("Missing Info for XLS Record 0x"+K.toString(16)),e.l+=G}return r.SheetNames=Ar(i).sort(function(Ke,He){return Number(Ke)-Number(He)}).map(function(Ke){return i[Ke].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&V.forEach(function(Ke,He){r.Sheets[r.SheetNames[He]]["!autofilter"]=Ke}),r.Strings=c,r.SSF=qt(ut),I.enc&&(r.Encryption=I.enc),z&&(r.Themes=z),r.Metadata={},k!==void 0&&(r.Metadata.Country=k),B.names.length>0&&(C.Names=B.names),r.Workbook=C,r}var Dd={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function hde(e,t,r){var n=ct.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=$E(n,e1,Dd.DSI);for(var i in a)t[i]=a[i]}catch(u){if(r.WTF)throw u}var s=ct.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=$E(s,t1,Dd.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(AI(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function mde(e,t){var r=[],n=[],a=[],i=0,s,o=gE(e1,"n"),c=gE(t1,"n");if(e.Props)for(s=Ar(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(c,s[i])?n:a).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=Ar(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(c,s[i])?n:a).push([s[i],e.Custprops[s[i]]]);var u=[];for(i=0;i<a.length;++i)FI.indexOf(a[i][0])>-1||EI.indexOf(a[i][0])>-1||a[i][1]!=null&&u.push(a[i]);n.length&&ct.utils.cfb_add(t,"/SummaryInformation",UE(n,Dd.SI,c,t1)),(r.length||u.length)&&ct.utils.cfb_add(t,"/DocumentSummaryInformation",UE(r,Dd.DSI,o,e1,u.length?u:null,Dd.UDI))}function fN(e,t){t||(t={}),mN(t),_g(),t.codepage&&Sg(t.codepage);var r,n;if(e.FullPaths){if(ct.find(e,"/encryption"))throw new Error("File is password-protected");r=ct.find(e,"!CompObj"),n=ct.find(e,"/Workbook")||ct.find(e,"/Book")}else{switch(t.type){case"base64":e=_a(La(e));break;case"binary":e=_a(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}xn(e,0),n={content:e}}var a,i;if(r&&cde(r),t.bookProps&&!t.bookSheets)a={};else{var s=kt?"buffer":"array";if(n&&n.content)a=fde(n.content,t);else if((i=ct.find(e,"PerfectOffice_MAIN"))&&i.content)a=bl.to_workbook(i.content,(t.type=s,t));else if((i=ct.find(e,"NativeContent_MAIN"))&&i.content)a=bl.to_workbook(i.content,(t.type=s,t));else throw(i=ct.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&ct.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=Ase(e))}var o={};return e.FullPaths&&hde(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}function pde(e,t){var r=t||{},n=ct.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return ct.utils.cfb_add(n,a,OR(e,r)),r.biff==8&&(e.Props||e.Custprops)&&mde(e,n),r.biff==8&&e.vbaraw&&Tse(n,ct.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var wf={0:{f:$le},1:{f:qle},2:{f:hce},3:{f:rce},4:{f:Qle},5:{f:uce},6:{f:yce},7:{f:sce},8:{f:_ce},9:{f:Sce},10:{f:Nce},11:{f:kce},12:{f:Yle},13:{f:pce},14:{f:ace},15:{f:ece},16:{f:NR},17:{f:bce},18:{f:lce},19:{f:q2},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:vue},40:{},42:{},43:{f:yie},44:{f:gie},45:{f:wie},46:{f:kie},47:{f:Nie},48:{},49:{f:Hte},50:{},51:{f:nse},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:VI},62:{f:xce},63:{f:fse},64:{f:Uce},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Hn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Lce},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Vle},148:{f:Hle,p:16},151:{f:Oce},152:{},153:{f:gue},154:{},155:{},156:{f:mue},157:{},158:{},159:{T:1,f:Iae},160:{T:-1},161:{T:1,f:ec},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Cce},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:tse},336:{T:-1},337:{f:sse,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Zv},357:{},358:{},359:{},360:{T:1},361:{},362:{f:GI},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Dce},427:{f:Ice},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Fce},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Gle},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Tce},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Zv},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:kse},633:{T:1},634:{T:-1},635:{T:1,f:wse},636:{T:-1},637:{f:Kte},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:aue},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:zce},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},o1={6:{f:Vx},10:{f:Qs},12:{f:Mr},13:{f:Mr},14:{f:Tr},15:{f:Tr},16:{f:Ln},17:{f:Tr},18:{f:Tr},19:{f:Mr},20:{f:KE},21:{f:KE},23:{f:GI},24:{f:XE},25:{f:Tr},26:{},27:{},28:{f:zne},29:{},34:{f:Tr},35:{f:qE},38:{f:Ln},39:{f:Ln},40:{f:Ln},41:{f:Ln},42:{f:Tr},43:{f:Tr},47:{f:eie},49:{f:pne},51:{f:Mr},60:{},61:{f:une},64:{f:Tr},65:{f:mne},66:{f:Mr},77:{},80:{},81:{},82:{},85:{f:Mr},89:{},90:{},91:{},92:{f:Zre},93:{f:Gne},94:{},95:{f:Tr},96:{},97:{},99:{f:Tr},125:{f:VI},128:{f:Pne},129:{f:tne},130:{f:Mr},131:{f:Tr},132:{f:Tr},133:{f:rne},134:{},140:{f:Zne},141:{f:Mr},144:{},146:{f:rae},151:{},152:{},153:{},154:{},155:{},156:{f:Mr},157:{},158:{},160:{f:cae},161:{f:iae},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Cne},190:{f:Ene},193:{f:Qs},197:{},198:{},199:{},200:{},201:{},202:{f:Tr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Mr},220:{},221:{f:Tr},222:{},224:{f:Tne},225:{f:Qre},226:{f:Qs},227:{},229:{f:Hne},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:ane},253:{f:xne},255:{f:sne},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:MI},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Tr},353:{f:Qs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Fne},431:{f:Tr},432:{},433:{},434:{},437:{},438:{f:qne},439:{f:Tr},440:{f:Xne},441:{},442:{f:s0},443:{},444:{f:Mr},445:{},446:{},448:{f:Qs},449:{f:cne,r:2},450:{f:Qs},512:{f:WE},513:{f:lae},515:{f:Ine},516:{f:vne},517:{f:VE},519:{f:uae},520:{f:one},523:{},545:{f:YE},549:{f:HE},566:{},574:{f:fne},638:{f:_ne},659:{},1048:{},1054:{f:wne},1084:{},1212:{f:jne},2048:{f:Jne},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:th},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Qs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:nae,r:12},2173:{f:Zie,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Tr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Bne,r:12},2197:{},2198:{f:Kie,r:12},2199:{},2200:{},2201:{},2202:{f:$ne,r:12},2203:{f:Qs},2204:{},2205:{},2206:{},2207:{},2211:{f:lne},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Mr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:sae},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:tae},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:WE},1:{},2:{f:pae},3:{f:hae},4:{f:fae},5:{f:VE},7:{f:xae},8:{},9:{f:th},11:{},22:{f:Mr},30:{f:kne},31:{},32:{},33:{f:YE},36:{},37:{f:HE},50:{f:yae},62:{},52:{},67:{},68:{f:Mr},69:{},86:{},126:{},127:{f:dae},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:vae},223:{},234:{},354:{},421:{},518:{f:Vx},521:{f:th},536:{f:XE},547:{f:qE},561:{},579:{},1030:{f:Vx},1033:{f:th},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function We(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&G2(r)&&e.push(r)}}function gde(e,t,r,n){var a=n||(r||[]).length||0;if(a<=8224)return We(e,t,r,a);var i=t;if(!isNaN(i)){for(var s=r.parts||[],o=0,c=0,u=0;u+(s[o]||8224)<=8224;)u+=s[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,i),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<a;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(s[o]||8224)<=8224;)u+=s[o]||8224,o++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function u0(e,t,r){return e||(e=_e(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function xde(e,t,r,n){var a=_e(9);return u0(a,e,t),LI(r,n||"b",a),a}function yde(e,t,r){var n=_e(8+2*r.length);return u0(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function vde(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?Jr(or(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?We(e,2,gae(r,n,a)):We(e,3,mae(r,n,a));return;case"b":case"e":We(e,5,xde(r,n,t.v,t.t));return;case"s":case"str":We(e,4,yde(r,n,(t.v||"").slice(0,255)));return}We(e,1,u0(null,r,n))}function bde(e,t,r,n){var a=Array.isArray(t),i=Tt(t["!ref"]||"A1"),s,o="",c=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=bt(i)}for(var u=i.s.r;u<=i.e.r;++u){o=Cr(u);for(var d=i.s.c;d<=i.e.c;++d){u===i.s.r&&(c[d]=sr(d)),s=c[d]+o;var f=a?(t[u]||[])[d]:t[s];f&&vde(e,f,u,d)}}}function wde(e,t){for(var r=t||{},n=pa(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return We(n,r.biff==4?1033:r.biff==3?521:9,tN(e,16,r)),bde(n,e.Sheets[e.SheetNames[a]],a,r),We(n,10),n.end()}function Nde(e,t,r){We(e,49,gne({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function kde(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&We(e,1054,Nne(a,t[a],r))})}function Sde(e,t){var r=_e(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),We(e,2151,r),r=_e(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),zI(Tt(t["!ref"]||"A1"),r),r.write_shift(4,4),We(e,2152,r)}function _de(e,t){for(var r=0;r<16;++r)We(e,224,GE({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){We(e,224,GE(n,0,t))})}function Cde(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];We(e,440,Yne(n)),n[1].Tooltip&&We(e,2048,Qne(n))}delete t["!links"]}function Ede(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&We(e,125,aae(Ig(a,n),a))})}}function Ade(e,t,r,n,a){var i=16+Vo(a.cellXfs,t,a);if(t.v==null&&!t.bf){We(e,513,zl(r,n,i));return}if(t.bf)We(e,6,tle(t,r,n,a,i));else switch(t.t){case"d":case"n":var s=t.t=="d"?Jr(or(t.v)):t.v;We(e,515,Rne(r,n,s,i));break;case"b":case"e":We(e,517,Dne(r,n,t.v,i,a,t.t));break;case"s":case"str":if(a.bookSST){var o=cN(a.Strings,t.v,a.revStrings);We(e,253,yne(r,n,o,i))}else We(e,516,bne(r,n,(t.v||"").slice(0,255),i,a));break;default:We(e,513,zl(r,n,i))}}function Tde(e,t,r){var n=pa(),a=r.SheetNames[e],i=r.Sheets[a]||{},s=(r||{}).Workbook||{},o=(s.Sheets||[])[e]||{},c=Array.isArray(i),u=t.biff==8,d,f="",m=[],p=Tt(i["!ref"]||"A1"),x=u?65536:16384;if(p.e.c>255||p.e.r>=x){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,x-1)}We(n,2057,tN(r,16,t)),We(n,13,ei(1)),We(n,12,ei(100)),We(n,15,Xn(!0)),We(n,17,Xn(!1)),We(n,16,$l(.001)),We(n,95,Xn(!0)),We(n,42,Xn(!1)),We(n,43,Xn(!1)),We(n,130,ei(1)),We(n,128,One([0,0])),We(n,131,Xn(!1)),We(n,132,Xn(!1)),u&&Ede(n,i["!cols"]),We(n,512,Sne(p,t)),u&&(i["!links"]=[]);for(var g=p.s.r;g<=p.e.r;++g){f=Cr(g);for(var y=p.s.c;y<=p.e.c;++y){g===p.s.r&&(m[y]=sr(y)),d=m[y]+f;var v=c?(i[g]||[])[y]:i[d];v&&(Ade(n,v,g,y,t),u&&v.l&&i["!links"].push([d,v.l]))}}var b=o.CodeName||o.name||a;return u&&We(n,574,hne((s.Views||[])[0])),u&&(i["!merges"]||[]).length&&We(n,229,Wne(i["!merges"])),u&&Cde(n,i),We(n,442,BI(b)),u&&Sde(n,i),We(n,10),n.end()}function Pde(e,t,r){var n=pa(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},o=r.biff==8,c=r.biff==5;if(We(n,2057,tN(e,5,r)),r.bookType=="xla"&&We(n,135),We(n,225,o?ei(1200):null),We(n,193,Dre(2)),c&&We(n,191),c&&We(n,192),We(n,226),We(n,92,ene("SheetJS",r)),We(n,66,ei(o?1200:1252)),o&&We(n,353,ei(0)),o&&We(n,448),We(n,317,oae(e.SheetNames.length)),o&&e.vbaraw&&We(n,211),o&&e.vbaraw){var u=s.CodeName||"ThisWorkbook";We(n,442,BI(u))}We(n,156,ei(17)),We(n,25,Xn(!1)),We(n,18,Xn(!1)),We(n,19,ei(0)),o&&We(n,431,Xn(!1)),o&&We(n,444,ei(0)),We(n,61,dne()),We(n,64,Xn(!1)),We(n,141,ei(0)),We(n,34,Xn(cue(e)=="true")),We(n,14,Xn(!0)),o&&We(n,439,Xn(!1)),We(n,218,ei(0)),Nde(n,e,r),kde(n,e.SSF,r),_de(n,r),o&&We(n,352,Xn(!1));var d=n.end(),f=pa();o&&We(f,140,eae()),o&&r.Strings&&gde(f,252,ine(r.Strings)),We(f,10);var m=f.end(),p=pa(),x=0,g=0;for(g=0;g<e.SheetNames.length;++g)x+=(o?12:11)+(o?2:1)*e.SheetNames[g].length;var y=d.length+x+m.length;for(g=0;g<e.SheetNames.length;++g){var v=i[g]||{};We(p,133,nne({pos:y,hs:v.Hidden||0,dt:0,name:e.SheetNames[g]},r)),y+=t[g].length}var b=p.end();if(x!=b.length)throw new Error("BS8 "+x+" != "+b.length);var w=[];return d.length&&w.push(d),b.length&&w.push(b),m.length&&w.push(m),on(w)}function Ode(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=qt(ut)),e&&e.SSF&&(Du(),n0(e.SSF),r.revssf=Eg(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,pN(r),r.cellXfs=[],Vo(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=Tde(a,r,e);return n.unshift(Pde(e,n,r)),on(n)}function OR(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=ta(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return Ode(e,t);case 4:case 3:case 2:return wde(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function s4(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=a.index,o=i&&i.index||e.length,c=xte(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,m=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(s=0;s<c.length;++s){var g=c[s].trim(),y=g.slice(0,3).toLowerCase();if(y=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(y!="<td"&&y!="<th")){var v=g.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var b=v[o].trim();if(b.match(/<t[dh]/i)){for(var w=b,k=0;w.charAt(0)=="<"&&(k=w.indexOf(">"))>-1;)w=w.slice(k+1);for(var S=0;S<x.length;++S){var _=x[S];_.s.c==d&&_.s.r<u&&u<=_.e.r&&(d=_.e.c+1,S=-1)}var C=mt(b.slice(0,b.indexOf(">")));m=C.colspan?+C.colspan:1,((f=+C.rowspan)>1||m>1)&&x.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+m-1}});var E=C.t||C["data-t"]||"";if(!w.length){d+=m;continue}if(w=iI(w),p.s.r>u&&(p.s.r=u),p.e.r<u&&(p.e.r=u),p.s.c>d&&(p.s.c=d),p.e.c<d&&(p.e.c=d),!w.length){d+=m;continue}var A={t:"s",v:w};r.raw||!w.trim().length||E=="s"||(w==="TRUE"?A={t:"b",v:!0}:w==="FALSE"?A={t:"b",v:!1}:isNaN(Ri(w))?isNaN(uu(w).getDate())||(A={t:"d",v:or(w)},r.cellDates||(A={t:"n",v:Jr(A.v)}),A.z=r.dateNF||ut[14]):A={t:"n",v:Ri(w)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=A):n[ht({r:u,c:d})]=A,d+=m}}}}return n["!ref"]=bt(p),x.length&&(n["!merges"]=x),n}function DR(e,t,r,n){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,c=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>s)&&!(a[u].e.r<r||a[u].e.c<s)){if(a[u].s.r<r||a[u].s.c<s){o=-1;break}o=a[u].e.r-a[u].s.r+1,c=a[u].e.c-a[u].s.c+1;break}if(!(o<0)){var d=ht({r,c:s}),f=n.dense?(e[r]||[])[s]:e[d],m=f&&f.v!=null&&(f.h||B2(f.w||(is(f),f.w)||""))||"",p={};o>1&&(p.rowspan=o),c>1&&(p.colspan=c),n.editable?m='<span contenteditable="true">'+m+"</span>":f&&(p["data-t"]=f&&f.t||"z",f.v!=null&&(p["data-v"]=f.v),f.z!=null&&(p["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+f.l.Target+'">'+m+"</a>")),p.id=(n.id||"sjs")+"-"+d,i.push(Ue("td",m,p))}}var x="<tr>";return x+i.join("")+"</tr>"}var IR='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',RR="</body></html>";function Dde(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Go(s4(r[0],t),t);var n=bN();return r.forEach(function(a,i){wN(n,s4(a,t),"Sheet"+(i+1))}),n}function FR(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function MR(e,t){var r=t||{},n=r.header!=null?r.header:IR,a=r.footer!=null?r.footer:RR,i=[n],s=ta(e["!ref"]);r.dense=Array.isArray(e),i.push(FR(e,s,r));for(var o=s.s.r;o<=s.e.r;++o)i.push(DR(e,s,o,r));return i.push("</table>"+a),i.join("")}function LR(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?yr(n.origin):n.origin;a=s.r,i=s.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var d=ta(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),a==-1&&(u.e.r=a=d.e.r+1)}var f=[],m=0,p=e["!rows"]||(e["!rows"]=[]),x=0,g=0,y=0,v=0,b=0,w=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&g<c;++x){var k=o[x];if(o4(k)){if(n.display)continue;p[g]={hidden:!0}}var S=k.children;for(y=v=0;y<S.length;++y){var _=S[y];if(!(n.display&&o4(_))){var C=_.hasAttribute("data-v")?_.getAttribute("data-v"):_.hasAttribute("v")?_.getAttribute("v"):iI(_.innerHTML),E=_.getAttribute("data-z")||_.getAttribute("z");for(m=0;m<f.length;++m){var A=f[m];A.s.c==v+i&&A.s.r<g+a&&g+a<=A.e.r&&(v=A.e.c+1-i,m=-1)}w=+_.getAttribute("colspan")||1,((b=+_.getAttribute("rowspan")||1)>1||w>1)&&f.push({s:{r:g+a,c:v+i},e:{r:g+a+(b||1)-1,c:v+i+(w||1)-1}});var T={t:"s",v:C},D=_.getAttribute("data-t")||_.getAttribute("t")||"";C!=null&&(C.length==0?T.t=D||"z":n.raw||C.trim().length==0||D=="s"||(C==="TRUE"?T={t:"b",v:!0}:C==="FALSE"?T={t:"b",v:!1}:isNaN(Ri(C))?isNaN(uu(C).getDate())||(T={t:"d",v:or(C)},n.cellDates||(T={t:"n",v:Jr(T.v)}),T.z=n.dateNF||ut[14]):T={t:"n",v:Ri(C)})),T.z===void 0&&E!=null&&(T.z=E);var I="",z=_.getElementsByTagName("A");if(z&&z.length)for(var X=0;X<z.length&&!(z[X].hasAttribute("href")&&(I=z[X].getAttribute("href"),I.charAt(0)!="#"));++X);I&&I.charAt(0)!="#"&&(T.l={Target:I}),n.dense?(e[g+a]||(e[g+a]=[]),e[g+a][v+i]=T):e[ht({c:v+i,r:g+a})]=T,u.e.c<v+i&&(u.e.c=v+i),v+=w}}++g}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,g-1+a),e["!ref"]=bt(u),g>=c&&(e["!fullref"]=bt((u.e.r=o.length-x+g-1+a,u))),e}function BR(e,t){var r=t||{},n=r.dense?[]:{};return LR(n,e,t)}function Ide(e,t){return Go(BR(e,t),t)}function o4(e){var t="",r=Rde(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Rde(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Fde(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=It(t.replace(/<[^>]*>/g,""));return[r]}var l4={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function jR(e,t){var r=t||{},n=j2(e),a=[],i,s,o={name:""},c="",u=0,d,f,m={},p=[],x=r.dense?[]:{},g,y,v={value:""},b="",w=0,k=[],S=-1,_=-1,C={s:{r:1e6,c:1e7},e:{r:0,c:0}},E=0,A={},T=[],D={},I=0,z=0,X=[],H=1,L=1,W=[],ie={Names:[]},B={},ee=["",""],le=[],R={},j="",V=0,P=!1,q=!1,O=0;for(pf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=pf.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"å·¥ä½œè¡¨":g[1]==="/"?(C.e.c>=C.s.c&&C.e.r>=C.s.r?x["!ref"]=bt(C):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=C.e.r&&(x["!fullref"]=x["!ref"],C.e.r=r.sheetRows-1,x["!ref"]=bt(C)),T.length&&(x["!merges"]=T),X.length&&(x["!rows"]=X),d.name=d.åç§°||d.name,typeof JSON<"u"&&JSON.stringify(d),p.push(d.name),m[d.name]=x,q=!1):g[0].charAt(g[0].length-2)!=="/"&&(d=mt(g[0],!1),S=_=-1,C.s.r=C.s.c=1e7,C.e.r=C.e.c=0,x=r.dense?[]:{},T=[],X=[],q=!0);break;case"table-row-group":g[1]==="/"?--E:++E;break;case"table-row":case"è¡Œ":if(g[1]==="/"){S+=H,H=1;break}if(f=mt(g[0],!1),f.è¡Œå·?S=f.è¡Œå·-1:S==-1&&(S=0),H=+f["number-rows-repeated"]||1,H<10)for(O=0;O<H;++O)E>0&&(X[S+O]={level:E});_=-1;break;case"covered-table-cell":g[1]!=="/"&&++_,r.sheetStubs&&(r.dense?(x[S]||(x[S]=[]),x[S][_]={t:"z"}):x[ht({r:S,c:_})]={t:"z"}),b="",k=[];break;case"table-cell":case"æ•°æ®":if(g[0].charAt(g[0].length-2)==="/")++_,v=mt(g[0],!1),L=parseInt(v["number-columns-repeated"]||"1",10),y={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(y.f=n4(It(v.formula))),(v.æ•°æ®ç±»åž‹||v["value-type"])=="string"&&(y.t="s",y.v=It(v["string-value"]||""),r.dense?(x[S]||(x[S]=[]),x[S][_]=y):x[ht({r:S,c:_})]=y),_+=L-1;else if(g[1]!=="/"){++_,b="",w=0,k=[],L=1;var K=H?S+H-1:S;if(_>C.e.c&&(C.e.c=_),_<C.s.c&&(C.s.c=_),S<C.s.r&&(C.s.r=S),K>C.e.r&&(C.e.r=K),v=mt(g[0],!1),le=[],R={},y={t:v.æ•°æ®ç±»åž‹||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=It(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(I=parseInt(v["number-matrix-rows-spanned"],10)||0,z=parseInt(v["number-matrix-columns-spanned"],10)||0,D={s:{r:S,c:_},e:{r:S+I-1,c:_+z-1}},y.F=bt(D),W.push([D,y.F])),v.formula)y.f=n4(v.formula);else for(O=0;O<W.length;++O)S>=W[O][0].s.r&&S<=W[O][0].e.r&&_>=W[O][0].s.c&&_<=W[O][0].e.c&&(y.F=W[O][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(I=parseInt(v["number-rows-spanned"],10)||0,z=parseInt(v["number-columns-spanned"],10)||0,D={s:{r:S,c:_},e:{r:S+I-1,c:_+z-1}},T.push(D)),v["number-columns-repeated"]&&(L=parseInt(v["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=ar(v["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(v.value);break;case"percentage":y.t="n",y.v=parseFloat(v.value);break;case"currency":y.t="n",y.v=parseFloat(v.value);break;case"date":y.t="d",y.v=or(v["date-value"]),r.cellDates||(y.t="n",y.v=Jr(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=mte(v["time-value"])/86400,r.cellDates&&(y.t="d",y.v=Ag(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(v.æ•°æ®æ•°å€¼);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",v["string-value"]!=null&&(b=It(v["string-value"]),k=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(P=!1,y.t==="s"&&(y.v=b||"",k.length&&(y.R=k),P=w==0),B.Target&&(y.l=B),le.length>0&&(y.c=le,le=[]),b&&r.cellText!==!1&&(y.w=b),P&&(y.t="z",delete y.v),(!P||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=S))for(var G=0;G<H;++G){if(L=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(x[S+G]||(x[S+G]=[]),x[S+G][_]=G==0?y:qt(y);--L>0;)x[S+G][_+L]=qt(y);else for(x[ht({r:S+G,c:_})]=y;--L>0;)x[ht({r:S+G,c:_+L})]=qt(y);C.e.c<=_&&(C.e.c=_)}L=parseInt(v["number-columns-repeated"]||"1",10),_+=L-1,L=0,y={},b="",k=[]}B={};break;case"document":case"document-content":case"ç”µå­è¡¨æ ¼æ–‡æ¡£":case"spreadsheet":case"ä¸»ä½“":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((i=a.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((i=a.pop())[0]!==g[3])throw"Bad state: "+i;R.t=b,k.length&&(R.R=k),R.a=j,le.push(R)}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!1]);j="",V=0,b="",w=0,k=[];break;case"creator":g[1]==="/"?j=n.slice(V,g.index):V=g.index+g[0].length;break;case"meta":case"å…ƒæ•°æ®":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((i=a.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!1]);b="",w=0,k=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(A[o.name]=c,(i=a.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&(c="",o=mt(g[0],!1),a.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":s=mt(g[0],!1),c+=l4[g[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":s=mt(g[0],!1),c+=l4[g[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,g.index);break}else u=g.index+g[0].length;break;case"named-range":s=mt(g[0],!1),ee=Kx(s["cell-range-address"]);var te={Name:s.name,Ref:ee[0]+"!"+ee[1]};q&&(te.Sheet=p.length),ie.Names.push(te);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"ç”µå­è¡¨æ ¼":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"æ–‡æœ¬ä¸²":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(g[1]==="/"&&(!v||!v["string-value"])){var ce=Fde(n.slice(w,g.index));b=(b.length>0?b+`
`:"")+ce[0]}else mt(g[0],!1),w=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{ee=Kx(mt(g[0])["target-range-address"]),m[ee[0]]["!autofilter"]={ref:ee[1]}}catch{}break;case"date":break;case"object":break;case"title":case"æ ‡é¢˜":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(B=mt(g[0],!1),!B.href)break;B.Target=It(B.href),delete B.href,B.Target.charAt(0)=="#"&&B.Target.indexOf(".")>-1?(ee=Kx(B.Target.slice(1)),B.Target="#"+ee[0]+"!"+ee[1]):B.Target.match(/^\.\.[\\\/]/)&&(B.Target=B.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"è¡¨:":case"å­—:":break;default:if(r.WTF)throw new Error(g)}}var M={Sheets:m,SheetNames:p,Workbook:ie};return r.bookSheets&&delete M.Sheets,M}function c4(e,t){t=t||{},Qa(e,"META-INF/manifest.xml")&&hre(Fr(e,"META-INF/manifest.xml"),t);var r=Ca(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=jR(Vt(r),t);return Qa(e,"meta.xml")&&(n.Props=_I(Fr(e,"meta.xml"))),n}function u4(e,t){return jR(e,t)}var Mde=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+mf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Dr+t}}(),d4=function(){var e=function(i){return Ht(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,s,o){var c=[];c.push('      <table:table table:name="'+Ht(s.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,d=0,f=ta(i["!ref"]||"A1"),m=i["!merges"]||[],p=0,x=Array.isArray(i);if(i["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(i["!cols"][d]?' table:style-name="co'+i["!cols"][d].ods+'"':"")+`></table:table-column>
`);var g="",y=i["!rows"]||[];for(u=0;u<f.s.r;++u)g=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+g+`></table:table-row>
`);for(;u<=f.e.r;++u){for(g=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+g+`>
`),d=0;d<f.s.c;++d)c.push(t);for(;d<=f.e.c;++d){var v=!1,b={},w="";for(p=0;p!=m.length;++p)if(!(m[p].s.c>d)&&!(m[p].s.r>u)&&!(m[p].e.c<d)&&!(m[p].e.r<u)){(m[p].s.c!=d||m[p].s.r!=u)&&(v=!0),b["table:number-columns-spanned"]=m[p].e.c-m[p].s.c+1,b["table:number-rows-spanned"]=m[p].e.r-m[p].s.r+1;break}if(v){c.push(r);continue}var k=ht({r:u,c:d}),S=x?(i[u]||[])[d]:i[k];if(S&&S.f&&(b["table:formula"]=Ht(ole(S.f)),S.F&&S.F.slice(0,k.length)==k)){var _=ta(S.F);b["table:number-matrix-columns-spanned"]=_.e.c-_.s.c+1,b["table:number-matrix-rows-spanned"]=_.e.r-_.s.r+1}if(!S){c.push(t);continue}switch(S.t){case"b":w=S.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=S.v?"true":"false";break;case"n":w=S.w||String(S.v||0),b["office:value-type"]="float",b["office:value"]=S.v||0;break;case"s":case"str":w=S.v==null?"":S.v,b["office:value-type"]="string";break;case"d":w=S.w||or(S.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=or(S.v).toISOString(),b["table:style-name"]="ce1";break;default:c.push(t);continue}var C=e(w);if(S.l&&S.l.Target){var E=S.l.Target;E=E.charAt(0)=="#"?"#"+lle(E.slice(1)):E,E.charAt(0)!="#"&&!E.match(/^\w+:/)&&(E="../"+E),C=Ue("text:a",C,{"xlink:href":E.replace(/&/g,"&amp;")})}c.push("          "+Ue("table:table-cell",Ue("text:p",C,{}),b)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(i,s){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Io(f),f.ods=o;var m=u["!cols"][d].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),i.push(`  </style:style>
`),++o}}});var c=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(s,o){var c=[Dr],u=mf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=mf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(SI().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),a(c,s),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=s.SheetNames.length;++f)c.push(n(s.Sheets[s.SheetNames[f]],s,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function $R(e,t){if(t.bookType=="fods")return d4(e,t);var r=F2(),n="",a=[],i=[];return n="mimetype",wt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",wt(r,n,d4(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",wt(r,n,Mde(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",wt(r,n,Dr+SI()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",wt(r,n,gre(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",wt(r,n,mre(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Hl(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function l1(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Vt(Wo(e))}function Lde(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):_a(Xi(e))}function Bde(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Fo(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function f4(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function jde(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function $de(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function Nf(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function $t(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Er(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Rt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Nf(e,r),i=a&7;a=Math.floor(a/8);var s=0,o;if(a==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:s=4,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=Nf(e,r),o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var u={data:o,type:i};t[a]==null?t[a]=[u]:t[a].push(u)}return t}function fn(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push($t(n*8+a.type)),a.type==2&&t.push($t(a.data.length)),t.push(a.data))})}),Fo(t)}function hN(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Ya(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Nf(e,n),i=Rt(e.slice(n[0],n[0]+a));n[0]+=a;var s={id:Er(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=Rt(o.data),u=Er(c[3][0].data);s.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=i[3])!=null&&t[0]&&(s.merge=Er(i[3][0].data)>>>0>0),r.push(s)}return r}function hc(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:$t(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:$t(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(s){a.push(s.data),s.meta[3]=[{type:0,data:$t(s.data.length)}],n[2].push({data:fn(s.meta),type:2})});var i=fn(n);t.push($t(i.length)),t.push(i),a.forEach(function(s){return t.push(s)})}),Fo(t)}function Ude(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Nf(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[r[0]],o>1&&(s|=t[r[0]+1]<<8),o>2&&(s|=t[r[0]+2]<<16),o>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}a.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var c=0,u=0;if(i==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Fo(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(a.push(a[0].slice(-c)),u-=c;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-c,-c+u))}}var d=Fo(a);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Ja(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Ude(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Fo(t)}function mc(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=$t(n),s=i.length;t.push(i),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),s+=n,a[0]=0,a[1]=s&255,a[2]=s>>8&255,a[3]=s>>16&255,r+=n}return Fo(t)}function zde(e,t,r,n){var a=Hl(e),i=a.getUint32(4,!0),s=(n>1?12:8)+f4(i&(n>1?3470:398))*4,o=-1,c=-1,u=NaN,d=new Date(2001,0,1);i&512&&(o=a.getUint32(s,!0),s+=4),s+=f4(i&(n>1?12288:4096))*4,i&16&&(c=a.getUint32(s,!0),s+=4),i&32&&(u=a.getFloat64(s,!0),s+=8),i&64&&(d.setTime(d.getTime()+a.getFloat64(s,!0)*1e3),s+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function Hde(e,t,r){var n=Hl(e),a=n.getUint32(8,!0),i=12,s=-1,o=-1,c=NaN,u=NaN,d=new Date(2001,0,1);a&1&&(c=jde(e,i),i+=16),a&2&&(u=n.getFloat64(i,!0),i+=8),a&4&&(d.setTime(d.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(o=n.getUint32(i,!0),i+=4),a&16&&(s=n.getUint32(i,!0),i+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(s>-1)f={t:"s",v:r[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return f}function Xx(e,t){var r=new Uint8Array(32),n=Hl(r),a=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,$de(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,a)}function Yx(e,t){var r=new Uint8Array(32),n=Hl(r),a=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,a)}function Wde(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return zde(e,t,r,e[0]);case 5:return Hde(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Pn(e){var t=Rt(e);return Nf(t[1][0].data)}function h4(e,t){var r=Rt(t.data),n=Er(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(s){var o=Rt(s.data),c=Er(o[1][0].data)>>>0;switch(n){case 1:i[c]=l1(o[3][0].data);break;case 8:{var u=e[Pn(o[9][0].data)][0],d=Rt(u.data),f=e[Pn(d[1][0].data)][0],m=Er(f.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var p=Rt(f.data);i[c]=p[3].map(function(x){return l1(x.data)}).join("")}break}}),i}function Gde(e,t){var r,n,a,i,s,o,c,u,d,f,m,p,x,g,y=Rt(e),v=Er(y[1][0].data)>>>0,b=Er(y[2][0].data)>>>0,w=((n=(r=y[8])==null?void 0:r[0])==null?void 0:n.data)&&Er(y[8][0].data)>0||!1,k,S;if((i=(a=y[7])==null?void 0:a[0])!=null&&i.data&&t!=0)k=(o=(s=y[7])==null?void 0:s[0])==null?void 0:o.data,S=(u=(c=y[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=y[4])==null?void 0:d[0])!=null&&f.data&&t!=1)k=(p=(m=y[4])==null?void 0:m[0])==null?void 0:p.data,S=(g=(x=y[3])==null?void 0:x[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var _=w?4:1,C=Hl(k),E=[],A=0;A<k.length/2;++A){var T=C.getUint16(A*2,!0);T<65535&&E.push([A,T])}if(E.length!=b)throw"Expected ".concat(b," cells, found ").concat(E.length);var D=[];for(A=0;A<E.length-1;++A)D[E[A][0]]=S.subarray(E[A][1]*_,E[A+1][1]*_);return E.length>=1&&(D[E[E.length-1][0]]=S.subarray(E[E.length-1][1]*_)),{R:v,cells:D}}function Vde(e,t){var r,n=Rt(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Er(n[7][0].data)>>>0>0?1:0:-1,i=hN(n[5],function(s){return Gde(s,a)});return{nrows:Er(n[4][0].data)>>>0,data:i.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(c,u){if(s[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));s[o.R][u]=c}),s},[])}}function Kde(e,t,r){var n,a=Rt(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Er(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(Er(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=bt(i);var s=Rt(a[4][0].data),o=h4(e,e[Pn(s[4][0].data)][0]),c=(n=s[17])!=null&&n[0]?h4(e,e[Pn(s[17][0].data)][0]):[],u=Rt(s[3][0].data),d=0;u[1].forEach(function(f){var m=Rt(f.data),p=e[Pn(m[2][0].data)][0],x=Er(p.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var g=Vde(e,p);g.data.forEach(function(y,v){y.forEach(function(b,w){var k=ht({r:d+v,c:w}),S=Wde(b,o,c);S&&(r[k]=S)})}),d+=g.nrows})}function qde(e,t){var r=Rt(t.data),n={"!ref":"A1"},a=e[Pn(r[2][0].data)],i=Er(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return Kde(e,a[0],n),n}function Xde(e,t){var r,n=Rt(t.data),a={name:(r=n[1])!=null&&r[0]?l1(n[1][0].data):"",sheets:[]},i=hN(n[2],Pn);return i.forEach(function(s){e[s].forEach(function(o){var c=Er(o.meta[1][0].data);c==6e3&&a.sheets.push(qde(e,o))})}),a}function Yde(e,t){var r=bN(),n=Rt(t.data),a=hN(n[1],Pn);if(a.forEach(function(i){e[i].forEach(function(s){var o=Er(s.meta[1][0].data);if(o==2){var c=Xde(e,s);c.sheets.forEach(function(u,d){wN(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Jx(e){var t,r,n,a,i={},s=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=Ja(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=Ya(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){i[f.id]=f.messages,s.push(f.id)})}}),!s.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Er(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||s.forEach(function(c){i[c].forEach(function(u){var d=Er(u.meta[1][0].data)>>>0;if(d==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return Yde(i,o)}function Jde(e,t,r){var n,a,i,s;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(i=e[8])==null?void 0:i[0])==null?void 0:s.data)&&Er(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,u=Hl(e[7][0].data),d=0,f=[],m=Hl(e[4][0].data),p=0,x=[],g=0;g<t.length;++g){if(t[g]==null){u.setUint16(g*2,65535,!0),m.setUint16(g*2,65535);continue}u.setUint16(g*2,d,!0),m.setUint16(g*2,p,!0);var y,v;switch(typeof t[g]){case"string":y=Xx({t:"s",v:t[g]},r),v=Yx({t:"s",v:t[g]},r);break;case"number":y=Xx({t:"n",v:t[g]},r),v=Yx({t:"n",v:t[g]},r);break;case"boolean":y=Xx({t:"b",v:t[g]},r),v=Yx({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}f.push(y),d+=y.length,x.push(v),p+=v.length,++c}for(e[2][0].data=$t(c);g<e[7][0].data.length/2;++g)u.setUint16(g*2,65535,!0),m.setUint16(g*2,65535,!0);return e[6][0].data=Fo(f),e[3][0].data=Fo(x),c}function Qde(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=ta(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(bt(n)));var i=tp(r,{range:n,header:1}),s=["~Sh33tJ5~"];i.forEach(function(j){return j.forEach(function(V){typeof V=="string"&&s.push(V)})});var o={},c=[],u=ct.read(t.numbers,{type:"base64"});u.FileIndex.map(function(j,V){return[j,u.FullPaths[V]]}).forEach(function(j){var V=j[0],P=j[1];if(V.type==2&&V.name.match(/\.iwa/)){var q=V.content,O=Ja(q),K=Ya(O);K.forEach(function(G){c.push(G.id),o[G.id]={deps:[],location:P,type:Er(G.messages[0].meta[1][0].data)}})}}),c.sort(function(j,V){return j-V});var d=c.filter(function(j){return j>1}).map(function(j){return[j,$t(j)]});u.FileIndex.map(function(j,V){return[j,u.FullPaths[V]]}).forEach(function(j){var V=j[0];if(j[1],!!V.name.match(/\.iwa/)){var P=Ya(Ja(V.content));P.forEach(function(q){q.messages.forEach(function(O){d.forEach(function(K){q.messages.some(function(G){return Er(G.meta[1][0].data)!=11006&&Bde(G.data,K[1])})&&o[K[0]].deps.push(q.id)})})})}});for(var f=ct.find(u,o[1].location),m=Ya(Ja(f.content)),p,x=0;x<m.length;++x){var g=m[x];g.id==1&&(p=g)}var y=Pn(Rt(p.messages[0].data)[1][0].data);for(f=ct.find(u,o[y].location),m=Ya(Ja(f.content)),x=0;x<m.length;++x)g=m[x],g.id==y&&(p=g);for(y=Pn(Rt(p.messages[0].data)[2][0].data),f=ct.find(u,o[y].location),m=Ya(Ja(f.content)),x=0;x<m.length;++x)g=m[x],g.id==y&&(p=g);for(y=Pn(Rt(p.messages[0].data)[2][0].data),f=ct.find(u,o[y].location),m=Ya(Ja(f.content)),x=0;x<m.length;++x)g=m[x],g.id==y&&(p=g);var v=Rt(p.messages[0].data);{v[6][0].data=$t(n.e.r+1),v[7][0].data=$t(n.e.c+1);var b=Pn(v[46][0].data),w=ct.find(u,o[b].location),k=Ya(Ja(w.content));{for(var S=0;S<k.length&&k[S].id!=b;++S);if(k[S].id!=b)throw"Bad ColumnRowUIDMapArchive";var _=Rt(k[S].messages[0].data);_[1]=[],_[2]=[],_[3]=[];for(var C=0;C<=n.e.c;++C){var E=[];E[1]=E[2]=[{type:0,data:$t(C+420690)}],_[1].push({type:2,data:fn(E)}),_[2].push({type:0,data:$t(C)}),_[3].push({type:0,data:$t(C)})}_[4]=[],_[5]=[],_[6]=[];for(var A=0;A<=n.e.r;++A)E=[],E[1]=E[2]=[{type:0,data:$t(A+726270)}],_[4].push({type:2,data:fn(E)}),_[5].push({type:0,data:$t(A)}),_[6].push({type:0,data:$t(A)});k[S].messages[0].data=fn(_)}w.content=mc(hc(k)),w.size=w.content.length,delete v[46];var T=Rt(v[4][0].data);{T[7][0].data=$t(n.e.r+1);var D=Rt(T[1][0].data),I=Pn(D[2][0].data);w=ct.find(u,o[I].location),k=Ya(Ja(w.content));{if(k[0].id!=I)throw"Bad HeaderStorageBucket";var z=Rt(k[0].messages[0].data);for(A=0;A<i.length;++A){var X=Rt(z[2][0].data);X[1][0].data=$t(A),X[4][0].data=$t(i[A].length),z[2][A]={type:z[2][0].type,data:fn(X)}}k[0].messages[0].data=fn(z)}w.content=mc(hc(k)),w.size=w.content.length;var H=Pn(T[2][0].data);w=ct.find(u,o[H].location),k=Ya(Ja(w.content));{if(k[0].id!=H)throw"Bad HeaderStorageBucket";for(z=Rt(k[0].messages[0].data),C=0;C<=n.e.c;++C)X=Rt(z[2][0].data),X[1][0].data=$t(C),X[4][0].data=$t(n.e.r+1),z[2][C]={type:z[2][0].type,data:fn(X)};k[0].messages[0].data=fn(z)}w.content=mc(hc(k)),w.size=w.content.length;var L=Pn(T[4][0].data);(function(){for(var j=ct.find(u,o[L].location),V=Ya(Ja(j.content)),P,q=0;q<V.length;++q){var O=V[q];O.id==L&&(P=O)}var K=Rt(P.messages[0].data);{K[3]=[];var G=[];s.forEach(function(M,Le){G[1]=[{type:0,data:$t(Le)}],G[2]=[{type:0,data:$t(1)}],G[3]=[{type:2,data:Lde(M)}],K[3].push({type:2,data:fn(G)})})}P.messages[0].data=fn(K);var te=hc(V),ce=mc(te);j.content=ce,j.size=j.content.length})();var W=Rt(T[3][0].data);{var ie=W[1][0];delete W[2];var B=Rt(ie.data);{var ee=Pn(B[2][0].data);(function(){for(var j=ct.find(u,o[ee].location),V=Ya(Ja(j.content)),P,q=0;q<V.length;++q){var O=V[q];O.id==ee&&(P=O)}var K=Rt(P.messages[0].data);{delete K[6],delete W[7];var G=new Uint8Array(K[5][0].data);K[5]=[];for(var te=0,ce=0;ce<=n.e.r;++ce){var M=Rt(G);te+=Jde(M,i[ce],s),M[1][0].data=$t(ce),K[5].push({data:fn(M),type:2})}K[1]=[{type:0,data:$t(n.e.c+1)}],K[2]=[{type:0,data:$t(n.e.r+1)}],K[3]=[{type:0,data:$t(te)}],K[4]=[{type:0,data:$t(n.e.r+1)}]}P.messages[0].data=fn(K);var Le=hc(V),Te=mc(Le);j.content=Te,j.size=j.content.length})()}ie.data=fn(B)}T[3][0].data=fn(W)}v[4][0].data=fn(T)}p.messages[0].data=fn(v);var le=hc(m),R=mc(le);return f.content=R,f.size=f.content.length,u}function UR(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function mN(e){UR([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function pN(e){UR([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Zde(e){return St.WS.indexOf(e)>-1?"sheet":e==St.CS?"chart":e==St.DS?"dialog":e==St.MS?"macro":e&&e.length?e:"sheet"}function efe(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Zde(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function tfe(e,t,r,n,a,i,s,o,c,u,d,f){try{i[n]=Ad(Ca(e,r,!0),t);var m=Fr(e,t),p;switch(o){case"sheet":p=Eue(m,t,a,c,i[n],u,d,f);break;case"chart":if(p=Aue(m,t,a,c,i[n],u,d,f),!p||!p["!drawel"])break;var x=hd(p["!drawel"].Target,t),g=gf(x),y=pse(Ca(e,x,!0),Ad(Ca(e,g,!0),x)),v=hd(y,x),b=gf(v);p=rue(Ca(e,v,!0),v,c,Ad(Ca(e,b,!0),v),u,p);break;case"macro":p=Tue(m,t,a,c,i[n],u,d,f);break;case"dialog":p=Pue(m,t,a,c,i[n],u,d,f);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=p;var w=[];i&&i[n]&&Ar(i[n]).forEach(function(k){var S="";if(i[n][k].Type==St.CMNT){S=hd(i[n][k].Target,t);var _=Rue(Fr(e,S,!0),S,c);if(!_||!_.length)return;QE(p,_,!1)}i[n][k].Type==St.TCMNT&&(S=hd(i[n][k].Target,t),w=w.concat(xse(Fr(e,S,!0),c)))}),w&&w.length&&QE(p,w,!0,c.people||[])}catch(k){if(c.WTF)throw k}}function Va(e){return e.charAt(0)=="/"?e.slice(1):e}function zR(e,t){if(Du(),t=t||{},mN(t),Qa(e,"META-INF/manifest.xml")||Qa(e,"objectdata.xml"))return c4(e,t);if(Qa(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Jx<"u"){if(e.FileIndex)return Jx(e);var r=ct.utils.cfb_new();return vE(e).forEach(function(X){wt(r,X,tI(e,X))}),Jx(r)}throw new Error("Unsupported NUMBERS file")}if(!Qa(e,"[Content_Types].xml"))throw Qa(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Qa(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=vE(e),a=dre(Ca(e,"[Content_Types].xml")),i=!1,s,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",Fr(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!Fr(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(Td=[],a.sst)try{Td=Iue(Fr(e,Va(a.sst)),a.sst,t)}catch(X){if(t.WTF)throw X}t.cellStyles&&a.themes.length&&(c=Due(Ca(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(u=Oue(Fr(e,Va(a.style)),a.style,c,t))}a.links.map(function(X){try{var H=Ad(Ca(e,gf(Va(X))),X);return Mue(Fr(e,Va(X)),H,X,t)}catch{}});var d=Cue(Fr(e,Va(a.workbooks[0])),a.workbooks[0],t),f={},m="";a.coreprops.length&&(m=Fr(e,Va(a.coreprops[0]),!0),m&&(f=_I(m)),a.extprops.length!==0&&(m=Fr(e,Va(a.extprops[0]),!0),m&&yre(m,f,t)));var p={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(m=Ca(e,Va(a.custprops[0]),!0),m&&(p=bre(m,t)));var x={};if((t.bookSheets||t.bookProps)&&(d.Sheets?s=d.Sheets.map(function(H){return H.name}):f.Worksheets&&f.SheetNames.length>0&&(s=f.SheetNames),t.bookProps&&(x.Props=f,x.Custprops=p),t.bookSheets&&typeof s<"u"&&(x.SheetNames=s),t.bookSheets?x.SheetNames:t.bookProps))return x;s={};var g={};t.bookDeps&&a.calcchain&&(g=Fue(Fr(e,Va(a.calcchain)),a.calcchain));var y=0,v={},b,w;{var k=d.Sheets;f.Worksheets=k.length,f.SheetNames=[];for(var S=0;S!=k.length;++S)f.SheetNames[S]=k[S].name}var _=i?"bin":"xml",C=a.workbooks[0].lastIndexOf("/"),E=(a.workbooks[0].slice(0,C+1)+"_rels/"+a.workbooks[0].slice(C+1)+".rels").replace(/^\//,"");Qa(e,E)||(E="xl/_rels/workbook."+_+".rels");var A=Ad(Ca(e,E,!0),E.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=Lue(Fr(e,Va(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=vse(Fr(e,Va(a.people[0])),t)),A&&(A=efe(A,d.Sheets));var T=Fr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=f.Worksheets;++y){var D="sheet";if(A&&A[y]?(b="xl/"+A[y][1].replace(/[\/]?xl\//,""),Qa(e,b)||(b=A[y][1]),Qa(e,b)||(b=E.replace(/_rels\/.*$/,"")+A[y][1]),D=A[y][2]):(b="xl/worksheets/sheet"+(y+1-T)+"."+_,b=b.replace(/sheet0\./,"sheet.")),w=b.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(f.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var I=!1,z=0;z!=t.sheets.length;++z)typeof t.sheets[z]=="number"&&t.sheets[z]==y&&(I=1),typeof t.sheets[z]=="string"&&t.sheets[z].toLowerCase()==f.SheetNames[y].toLowerCase()&&(I=1);if(!I)continue e}}tfe(e,b,w,f.SheetNames[y],y,v,s,D,t,d,c,u)}return x={Directory:a,Workbook:d,Props:f,Custprops:p,Deps:g,Sheets:s,SheetNames:f.SheetNames,Strings:Td,Styles:u,Themes:c,SSF:qt(ut)},t&&t.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(X,H){X=X.replace(/^Root Entry[\/]/,""),x.keys.push(X),x.files[X]=e.FileIndex[H]}))),t&&t.bookVBA&&(a.vba.length>0?x.vbaraw=Fr(e,Va(a.vba[0]),!0):a.defaults&&a.defaults.bin===Ese&&(x.vbaraw=Fr(e,"xl/vbaProject.bin",!0))),x}function rfe(e,t){var r=t||{},n="Workbook",a=ct.find(e,n);try{if(n="/!DataSpaces/Version",a=ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Bae(a.content),n="/!DataSpaces/DataSpaceMap",a=ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=$ae(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=Uae(a.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);Hae(a.content)}catch{}if(n="/EncryptionInfo",a=ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Wae(a.content);if(n="/EncryptedPackage",a=ct.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function nfe(e,t){return t.bookType=="ods"?$R(e,t):t.bookType=="numbers"?Qde(e,t):t.bookType=="xlsb"?afe(e,t):HR(e,t)}function afe(e,t){Dc=1024,e&&!e.SSF&&(e.SSF=qt(ut)),e&&e.SSF&&(Du(),n0(e.SSF),t.revssf=Eg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Pd?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=uR.indexOf(t.bookType)>-1,a=Z2();pN(t=t||{});var i=F2(),s="",o=0;if(t.cellXfs=[],Vo(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",wt(i,s,CI(e.Props,t)),a.coreprops.push(s),Ut(t.rels,2,s,St.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,wt(i,s,TI(e.Props)),a.extprops.push(s),Ut(t.rels,3,s,St.EXT_PROPS),e.Custprops!==e.Props&&Ar(e.Custprops||{}).length>0&&(s="docProps/custom.xml",wt(i,s,PI(e.Custprops)),a.custprops.push(s),Ut(t.rels,4,s,St.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],m=(f||{})["!type"]||"sheet";switch(m){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,wt(i,s,jue(o-1,s,t,e,d)),a.sheets.push(s),Ut(t.wbrels,-1,"worksheets/sheet"+o+"."+r,St.WS[0])}if(f){var p=f["!comments"],x=!1,g="";p&&p.length>0&&(g="xl/comments"+o+"."+r,wt(i,g,zue(p,g)),a.comments.push(g),Ut(d,-1,"../comments"+o+"."+r,St.CMNT),x=!0),f["!legacy"]&&x&&wt(i,"xl/drawings/vmlDrawing"+o+".vml",lR(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&wt(i,gf(s),zc(d))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,wt(i,s,Uue(t.Strings,s,t)),a.strs.push(s),Ut(t.wbrels,-1,"sharedStrings."+r,St.SST)),s="xl/workbook."+r,wt(i,s,Bue(e,s)),a.workbooks.push(s),Ut(t.rels,1,s,St.WB),s="xl/theme/theme1.xml",wt(i,s,iN(e.Themes,t)),a.themes.push(s),Ut(t.wbrels,-1,"theme/theme1.xml",St.THEME),s="xl/styles."+r,wt(i,s,$ue(e,s,t)),a.styles.push(s),Ut(t.wbrels,-1,"styles."+r,St.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",wt(i,s,e.vbaraw),a.vba.push(s),Ut(t.wbrels,-1,"vbaProject.bin",St.VBA)),s="xl/metadata."+r,wt(i,s,Hue(s)),a.metadata.push(s),Ut(t.wbrels,-1,"metadata."+r,St.XLMETA),wt(i,"[Content_Types].xml",kI(a,t)),wt(i,"_rels/.rels",zc(t.rels)),wt(i,"xl/_rels/workbook."+r+".rels",zc(t.wbrels)),delete t.revssf,delete t.ssf,i}function HR(e,t){Dc=1024,e&&!e.SSF&&(e.SSF=qt(ut)),e&&e.SSF&&(Du(),n0(e.SSF),t.revssf=Eg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Pd?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=uR.indexOf(t.bookType)>-1,a=Z2();pN(t=t||{});var i=F2(),s="",o=0;if(t.cellXfs=[],Vo(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",wt(i,s,CI(e.Props,t)),a.coreprops.push(s),Ut(t.rels,2,s,St.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,wt(i,s,TI(e.Props)),a.extprops.push(s),Ut(t.rels,3,s,St.EXT_PROPS),e.Custprops!==e.Props&&Ar(e.Custprops||{}).length>0&&(s="docProps/custom.xml",wt(i,s,PI(e.Custprops)),a.custprops.push(s),Ut(t.rels,4,s,St.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},m=e.Sheets[e.SheetNames[o-1]],p=(m||{})["!type"]||"sheet";switch(p){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,wt(i,s,wR(o-1,t,e,f)),a.sheets.push(s),Ut(t.wbrels,-1,"worksheets/sheet"+o+"."+r,St.WS[0])}if(m){var x=m["!comments"],g=!1,y="";if(x&&x.length>0){var v=!1;x.forEach(function(b){b[1].forEach(function(w){w.T==!0&&(v=!0)})}),v&&(y="xl/threadedComments/threadedComment"+o+"."+r,wt(i,y,yse(x,d,t)),a.threadedcomments.push(y),Ut(f,-1,"../threadedComments/threadedComment"+o+"."+r,St.TCMNT)),y="xl/comments"+o+"."+r,wt(i,y,cR(x)),a.comments.push(y),Ut(f,-1,"../comments"+o+"."+r,St.CMNT),g=!0}m["!legacy"]&&g&&wt(i,"xl/drawings/vmlDrawing"+o+".vml",lR(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}f["!id"].rId1&&wt(i,gf(s),zc(f))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,wt(i,s,YI(t.Strings,t)),a.strs.push(s),Ut(t.wbrels,-1,"sharedStrings."+r,St.SST)),s="xl/workbook."+r,wt(i,s,ER(e)),a.workbooks.push(s),Ut(t.rels,1,s,St.WB),s="xl/theme/theme1.xml",wt(i,s,iN(e.Themes,t)),a.themes.push(s),Ut(t.wbrels,-1,"theme/theme1.xml",St.THEME),s="xl/styles."+r,wt(i,s,aR(e,t)),a.styles.push(s),Ut(t.wbrels,-1,"styles."+r,St.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",wt(i,s,e.vbaraw),a.vba.push(s),Ut(t.wbrels,-1,"vbaProject.bin",St.VBA)),s="xl/metadata."+r,wt(i,s,oR()),a.metadata.push(s),Ut(t.wbrels,-1,"metadata."+r,St.XLMETA),d.length>1&&(s="xl/persons/person.xml",wt(i,s,bse(d)),a.people.push(s),Ut(t.wbrels,-1,"persons/person.xml",St.PEOPLE)),wt(i,"[Content_Types].xml",kI(a,t)),wt(i,"_rels/.rels",zc(t.rels)),wt(i,"xl/_rels/workbook."+r+".rels",zc(t.wbrels)),delete t.revssf,delete t.ssf,i}function gN(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=La(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function ife(e,t){return ct.find(e,"EncryptedPackage")?rfe(e,t):fN(e,t)}function sfe(e,t){var r,n=e,a=t||{};return a.type||(a.type=kt&&Buffer.isBuffer(e)?"buffer":"base64"),r=rI(n,a),zR(r,a)}function WR(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return s1(e.slice(r),t);default:break e}return du.to_workbook(e,t)}function ofe(e,t){var r="",n=gN(e,t);switch(t.type){case"base64":r=La(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=jl(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Vt(r)),t.type="binary",WR(r,t)}function lfe(e,t){var r=e;return t.type=="base64"&&(r=La(r)),r=Pt.utils.decode(1200,r.slice(2),"str"),t.type="binary",WR(r,t)}function cfe(e){return e.match(/[^\x00-\x7F]/)?Xi(e):e}function Qx(e,t,r,n){return n?(r.type="string",du.to_workbook(e,r)):du.to_workbook(t,r)}function hu(e,t){_g();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return hu(new Uint8Array(e),(r=qt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Wc={},r.dateNF&&(Wc.dateNF=r.dateNF),r.type||(r.type=kt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=kt?"buffer":"binary",n=dte(e),typeof Uint8Array<"u"&&!kt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=cfe(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return r=qt(r),r.type="array",hu(O2(n),r)}switch((a=gN(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return ife(ct.read(n,r),r);break;case 9:if(a[1]<=8)return fN(n,r);break;case 60:return s1(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return wae(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return qI.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?sfe(n,r):Qx(e,n,r,i);case 239:return a[3]===60?s1(n,r):Qx(e,n,r,i);case 255:if(a[1]===254)return lfe(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return bl.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return bl.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return i1.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return tR.to_workbook(n,r);break;case 10:case 13:case 32:return ofe(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return bae.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?i1.to_workbook(n,r):Qx(e,n,r,i)}function m4(e,t){var r=t||{};return r.type="file",hu(e,r)}function GR(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return a0(t.file,ct.write(e,{type:kt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return ct.write(e,t)}function ufe(e,t){var r=qt(t||{}),n=nfe(e,r);return VR(n,r)}function dfe(e,t){var r=qt(t||{}),n=HR(e,r);return VR(n,r)}function VR(e,t){var r={},n=kt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?ct.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(r0(a))}return t.password&&typeof encrypt_agile<"u"?GR(encrypt_agile(a,t.password),t):t.type==="file"?a0(t.file,a):t.type=="string"?Vt(a):a}function ffe(e,t){var r=t||{},n=pde(e,r);return GR(n,r)}function Hi(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return df(Xi(n));case"binary":return Xi(n);case"string":return e;case"file":return a0(t.file,n,"utf8");case"buffer":return kt?qs(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Hi(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function hfe(e,t){switch(t.type){case"base64":return df(e);case"binary":return e;case"string":return e;case"file":return a0(t.file,e,"binary");case"buffer":return kt?qs(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function ih(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?df(r):t.type=="string"?Vt(r):r;case"file":return a0(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function xN(e,t){_g(),CR(e);var r=qt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=xN(e,r);return r.type="array",r0(n)}return dfe(e,r)}function Rg(e,t){_g(),CR(e);var r=qt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Rg(e,r);return r.type="array",r0(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Hi(lde(e,r),r);case"slk":case"sylk":return Hi(KI.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return Hi(MR(e.Sheets[e.SheetNames[a]],r),r);case"txt":return hfe(XR(e.Sheets[e.SheetNames[a]],r),r);case"csv":return Hi(vN(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return Hi(qI.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return ih(i1.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return Hi(du.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return Hi(tR.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return Hi(XI.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return Hi($R(e,r),r);case"wk1":return ih(bl.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return ih(bl.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),ih(OR(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),ffe(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return ufe(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function yN(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function mu(e,t,r){var n=r||{};return n.type="file",n.file=t,yN(n),Rg(e,n)}function mfe(e,t,r){var n=r||{};return n.type="file",n.file=t,yN(n),xN(e,n)}function pfe(e,t,r,n){var a=r||{};a.type="file",a.file=e,yN(a),a.type="buffer";var i=n;return i instanceof Function||(i=r),ho.writeFile(e,Rg(t,a),i)}function KR(e,t,r,n,a,i,s,o){var c=Cr(r),u=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,m=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!s||e[r])for(var p=t.s.c;p<=t.e.c;++p){var x=s?e[r][p]:e[n[p]+c];if(x===void 0||x.t===void 0){if(u===void 0)continue;i[p]!=null&&(m[i[p]]=u);continue}var g=x.v;switch(x.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(i[p]!=null){if(g==null)if(x.t=="e"&&g===null)m[i[p]]=null;else if(u!==void 0)m[i[p]]=u;else if(d&&g===null)m[i[p]]=null;else continue;else m[i[p]]=d&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?g:is(x,g,o);g!=null&&(f=!1)}}return{row:m,isempty:f}}function tp(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=Tt(d);break;case"number":c=Tt(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(a=0);var f=Cr(c.s.r),m=[],p=[],x=0,g=0,y=Array.isArray(e),v=c.s.r,b=0,w={};y&&!e[v]&&(e[v]=[]);var k=u.skipHidden&&e["!cols"]||[],S=u.skipHidden&&e["!rows"]||[];for(b=c.s.c;b<=c.e.c;++b)if(!(k[b]||{}).hidden)switch(m[b]=sr(b),r=y?e[v][b]:e[m[b]+f],n){case 1:i[b]=b-c.s.c;break;case 2:i[b]=m[b];break;case 3:i[b]=u.header[b-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=is(r,null,u),g=w[s]||0,!g)w[s]=1;else{do o=s+"_"+g++;while(w[o]);w[s]=g,w[o]=1}i[b]=o}for(v=c.s.r+a;v<=c.e.r;++v)if(!(S[v]||{}).hidden){var _=KR(e,c,v,m,n,i,y,u);(_.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(p[x++]=_.row)}return p.length=x,p}var p4=/"/g;function qR(e,t,r,n,a,i,s,o){for(var c=!0,u=[],d="",f=Cr(r),m=t.s.c;m<=t.e.c;++m)if(n[m]){var p=o.dense?(e[r]||[])[m]:e[n[m]+f];if(p==null)d="";else if(p.v!=null){c=!1,d=""+(o.rawNumbers&&p.t=="n"?p.v:is(p,null,o));for(var x=0,g=0;x!==d.length;++x)if((g=d.charCodeAt(x))===a||g===i||g===34||o.forceQuotes){d='"'+d.replace(p4,'""')+'"';break}d=="ID"&&(d='"ID"')}else p.f!=null&&!p.F?(c=!1,d="="+p.f,d.indexOf(",")>=0&&(d='"'+d.replace(p4,'""')+'"')):d="";u.push(d)}return o.blankrows===!1&&c?null:u.join(s)}function vN(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=Tt(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var m=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],x=a.s.c;x<=a.e.c;++x)(m[x]||{}).hidden||(f[x]=sr(x));for(var g=0,y=a.s.r;y<=a.e.r;++y)(p[y]||{}).hidden||(d=qR(e,a,y,f,s,c,i,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((g++?o:"")+d)));return delete n.dense,r.join("")}function XR(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=vN(e,t);if(typeof Pt>"u"||t.type=="string")return r;var n=Pt.utils.encode(1200,r,"str");return String.fromCharCode(255)+String.fromCharCode(254)+n}function gfe(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=Tt(e["!ref"]),i="",s=[],o,c=[],u=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)s[o]=sr(o);for(var d=a.s.r;d<=a.e.r;++d)for(i=Cr(d),o=a.s.c;o<=a.e.c;++o)if(t=s[o]+i,r=u?(e[d]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function YR(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},s=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?yr(n.origin):n.origin;s=c.r,o=c.c}var u,d={s:{c:0,r:0},e:{c:o,r:s+t.length-1+a}};if(i["!ref"]){var f=Tt(i["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),s==-1&&(s=f.e.r+1,d.e.r=s+t.length-1+a)}else s==-1&&(s=0,d.e.r=t.length-1+a);var m=n.header||[],p=0;t.forEach(function(g,y){Ar(g).forEach(function(v){(p=m.indexOf(v))==-1&&(m[p=m.length]=v);var b=g[v],w="z",k="",S=ht({c:o+p,r:s+y+a});u=kf(i,S),b&&typeof b=="object"&&!(b instanceof Date)?i[S]=b:(typeof b=="number"?w="n":typeof b=="boolean"?w="b":typeof b=="string"?w="s":b instanceof Date?(w="d",n.cellDates||(w="n",b=Jr(b)),k=n.dateNF||ut[14]):b===null&&n.nullError&&(w="e",b=0),u?(u.t=w,u.v=b,delete u.w,delete u.R,k&&(u.z=k)):i[S]=u={t:w,v:b},k&&(u.z=k))})}),d.e.c=Math.max(d.e.c,o+m.length-1);var x=Cr(s);if(a)for(p=0;p<m.length;++p)i[sr(p+o)+x]={t:"s",v:m[p]};return i["!ref"]=bt(d),i}function xfe(e,t){return YR(null,e,t)}function kf(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=yr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?kf(e,ht(t)):kf(e,ht({r:t,c:r||0}))}function yfe(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function bN(){return{SheetNames:[],Sheets:{}}}function wN(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if(_R(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function vfe(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=yfe(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function bfe(e,t){return e.z=t,e}function JR(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function wfe(e,t,r){return JR(e,"#"+t,r)}function Nfe(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function kfe(e,t,r,n){for(var a=typeof t!="string"?t:Tt(t),i=typeof t=="string"?t:bt(t),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var c=kf(e,s,o);c.t="n",c.F=i,delete c.v,s==a.s.r&&o==a.s.c&&(c.f=r,n&&(c.D=!0))}return e}var jt={encode_col:sr,encode_row:Cr,encode_cell:ht,encode_range:bt,decode_col:K2,decode_row:V2,split_cell:zte,decode_cell:yr,decode_range:ta,format_cell:is,sheet_add_aoa:gI,sheet_add_json:YR,sheet_add_dom:LR,aoa_to_sheet:Ru,json_to_sheet:xfe,table_to_sheet:BR,table_to_book:Ide,sheet_to_csv:vN,sheet_to_txt:XR,sheet_to_json:tp,sheet_to_html:MR,sheet_to_formulae:gfe,sheet_to_row_object_array:tp,sheet_get_cell:kf,book_new:bN,book_append_sheet:wN,book_set_sheet_visibility:vfe,cell_set_number_format:bfe,cell_set_hyperlink:JR,cell_set_internal_link:wfe,cell_add_comment:Nfe,sheet_set_array_formula:kfe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},Fg;function Sfe(e){Fg=e}function _fe(e,t){var r=Fg(),n=t??{};if(e==null||e["!ref"]==null)return r.push(null),r;var a=Tt(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var m=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],x=a.s.c;x<=a.e.c;++x)(m[x]||{}).hidden||(f[x]=sr(x));var g=a.s.r,y=!1,v=0;return r._read=function(){if(!y)return y=!0,r.push("\uFEFF");for(;g<=a.e.r;)if(++g,!(p[g-1]||{}).hidden&&(d=qR(e,a,g-1,f,s,c,i,n),d!=null&&(n.strip&&(d=d.replace(u,"")),d||n.blankrows!==!1)))return r.push((v++?o:"")+d);return r.push(null)},r}function Cfe(e,t){var r=Fg(),n=t||{},a=n.header!=null?n.header:IR,i=n.footer!=null?n.footer:RR;r.push(a);var s=ta(e["!ref"]);n.dense=Array.isArray(e),r.push(FR(e,s,n));var o=s.s.r,c=!1;return r._read=function(){if(o>s.e.r)return c||(c=!0,r.push("</table>"+i)),r.push(null);for(;o<=s.e.r;){r.push(DR(e,s,o,n)),++o;break}},r}function Efe(e,t){var r=Fg({objectMode:!0});if(e==null||e["!ref"]==null)return r.push(null),r;var n={t:"n",v:0},a=0,i=1,s=[],o=0,c="",u={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},f=d.range!=null?d.range:e["!ref"];switch(d.header===1?a=1:d.header==="A"?a=2:Array.isArray(d.header)&&(a=3),typeof f){case"string":u=Tt(f);break;case"number":u=Tt(e["!ref"]),u.s.r=f;break;default:u=f}a>0&&(i=0);var m=Cr(u.s.r),p=[],x=0,g=Array.isArray(e),y=u.s.r,v=0,b={};g&&!e[y]&&(e[y]=[]);var w=d.skipHidden&&e["!cols"]||[],k=d.skipHidden&&e["!rows"]||[];for(v=u.s.c;v<=u.e.c;++v)if(!(w[v]||{}).hidden)switch(p[v]=sr(v),n=g?e[y][v]:e[p[v]+m],a){case 1:s[v]=v-u.s.c;break;case 2:s[v]=p[v];break;case 3:s[v]=d.header[v-u.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),c=o=is(n,null,d),x=b[o]||0,!x)b[o]=1;else{do c=o+"_"+x++;while(b[c]);b[o]=x,b[c]=1}s[v]=c}return y=u.s.r+i,r._read=function(){for(;y<=u.e.r;)if(!(k[y-1]||{}).hidden){var S=KR(e,u,y,p,a,s,g,d);if(++y,S.isempty===!1||(a===1?d.blankrows!==!1:d.blankrows)){r.push(S.row);return}}return r.push(null)},r}var Afe={to_json:Efe,to_html:Cfe,to_csv:_fe,set_readable:Sfe};const Tfe=uf.version,NN=Object.freeze(Object.defineProperty({__proto__:null,CFB:ct,SSF:XD,parse_xlscfb:fN,parse_zip:zR,read:hu,readFile:m4,readFileSync:m4,set_cptable:Ree,set_fs:cte,stream:Afe,utils:jt,version:Tfe,write:Rg,writeFile:mu,writeFileAsync:pfe,writeFileSync:mu,writeFileXLSX:mfe,writeXLSX:xN},Symbol.toStringTag,{value:"Module"})),Pfe=(e,t=[])=>{if(!e||e.length===0)return"";const r=c=>{const u=t.find(d=>d.id===Number(c));return u?u.name:c},n=c=>{const u=t.find(f=>f.id===Number(c.category_id));if(!u)return"Unknown";const d={CPU:["CPU","Procie Only","Pro & Mobo - Amd","Pro & Mobo - Intel"],Motherboard:["Motherboard","Mobo","Pro & Mobo - Amd","Pro & Mobo - Intel"],GPU:["GPU"],RAM:["RAM","Ram 3200mhz"],Storage:["Storage","Ssd Nvme"],PSU:["PSU","Psu - Tr"],Case:["Case","Case Gaming"],Cooler:["Cooler","Aio"]};for(const[f,m]of Object.entries(d))if(m.includes(u.name))return f;return u.name},a=c=>{const u=c.stock_quantity??c.stock,d=Number(c.price);return u===0?"Out of Stock":d===0?"No Price":u>0&&u<=5?"Low Stock":"In Stock"},i=["ID","Name","Category","Main Category","Brand","Price","Stock Quantity","Stock Status","Description","Image URL","Created At","Updated At"],s=e.map(c=>[c.id||"",`"${(c.name||"").replace(/"/g,'""')}"`,`"${r(c.category_id)}"`,`"${n(c)}"`,`"${(c.brand||"").replace(/"/g,'""')}"`,c.price||"0",c.stock_quantity??c.stock??"0",`"${a(c)}"`,`"${(c.description||"").replace(/"/g,'""')}"`,`"${c.image_url||""}"`,`"${c.created_at||""}"`,`"${c.updated_at||""}"`]);return[i.join(","),...s.map(c=>c.join(","))].join(`
`)},c1=(e,t=[],r="inventory-export.csv")=>{if(typeof window>"u"){console.error("CSV export requires browser environment.");return}const n=Pfe(e,t);if(!n){alert("No data to export");return}const a=new Blob([n],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a");if(i.download!==void 0){const s=URL.createObjectURL(a);i.setAttribute("href",s),i.setAttribute("download",r),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(s)}},Ofe=(e,t=[],r="inventory-export.xlsx")=>{if(typeof NN>"u"||!jt||!mu){console.error("SheetJS library not loaded. Please include xlsx library for Excel export."),alert("Excel export requires SheetJS library. Falling back to CSV export."),c1(e,t,r.replace(".xlsx",".csv"));return}if(typeof window>"u"){console.error("Excel export requires browser environment.");return}if(!e||e.length===0){alert("No data to export");return}const n=o=>{const c=t.find(u=>u.id===Number(o));return c?c.name:o},a=o=>{const c=t.find(d=>d.id===Number(o.category_id));if(!c)return"Unknown";const u={CPU:["CPU","Procie Only","Pro & Mobo - Amd","Pro & Mobo - Intel"],Motherboard:["Motherboard","Mobo","Pro & Mobo - Amd","Pro & Mobo - Intel"],GPU:["GPU"],RAM:["RAM","Ram 3200mhz"],Storage:["Storage","Ssd Nvme"],PSU:["PSU","Psu - Tr"],Case:["Case","Case Gaming"],Cooler:["Cooler","Aio"]};for(const[d,f]of Object.entries(u))if(f.includes(c.name))return d;return c.name},i=o=>{const c=o.stock_quantity??o.stock,u=Number(o.price);return c===0?"Out of Stock":u===0?"No Price":c>0&&c<=5?"Low Stock":"In Stock"},s=e.map(o=>({ID:o.id||"",Name:o.name||"",Category:n(o.category_id),"Main Category":a(o),Brand:o.brand||"",Price:Number(o.price)||0,"Stock Quantity":Number(o.stock_quantity??o.stock)||0,"Stock Status":i(o),Description:o.description||"","Image URL":o.image_url||"","Created At":o.created_at||"","Updated At":o.updated_at||""}));try{const o=jt.book_new(),c=jt.json_to_sheet(s),u=[{wch:8},{wch:30},{wch:15},{wch:15},{wch:12},{wch:10},{wch:12},{wch:12},{wch:40},{wch:30},{wch:20},{wch:20}];c["!cols"]=u,jt.book_append_sheet(o,c,"Inventory"),mu(o,r)}catch(o){console.error("Error creating Excel file:",o),alert(`Failed to create Excel file: ${o.message}. Falling back to CSV export.`),c1(e,t,r.replace(".xlsx",".csv"))}},QR=(e,t,r,n,a,i="csv",s=null)=>{const o=[{key:"CPU",names:["CPU","Procie Only","Pro & Mobo - Amd","Pro & Mobo - Intel"]},{key:"Motherboard",names:["Motherboard","Mobo","Pro & Mobo - Amd","Pro & Mobo - Intel"]},{key:"GPU",names:["GPU"]},{key:"RAM",names:["RAM","Ram 3200mhz"]},{key:"Storage",names:["Storage","Ssd Nvme"]},{key:"PSU",names:["PSU","Psu - Tr"]},{key:"Case",names:["Case","Case Gaming"]},{key:"Cooler",names:["Cooler","Aio"]}],c=p=>{const x=a.find(g=>g.id===Number(p.category_id));if(!x)return null;for(const g of o)if(g.names.includes(x.name))return g.key;return null};let u=e.filter(p=>{const x=c(p);if(!x||r!=="all"&&x!==r)return!1;if(n!=="all"){if(!p.brand)return!1;if(n.toLowerCase()==="amd"||n.toLowerCase()==="intel"){if(p.brand.toLowerCase()!==n.toLowerCase())return!1}else if(p.brand.toLowerCase()!==n.toLowerCase())return!1}return!0});t.trim()!==""&&(u=u.filter(p=>p.name.toLowerCase().includes(t.toLowerCase())||p.brand&&p.brand.toLowerCase().includes(t.toLowerCase())));const f=`inventory-export-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.${i==="excel"?"xlsx":"csv"}`,m=s||f;return i==="excel"?Ofe(u,a,m):c1(u,a,m),u.length},Dfe=(e={},t=null)=>{if(typeof NN>"u"||!jt||!mu){console.error("SheetJS library not loaded. Please include xlsx library for Excel export."),alert("Excel export requires SheetJS library. Please install xlsx package.");return}if(typeof window>"u"){console.error("Excel export requires browser environment.");return}const{monthly_sales:r=[],daily_sales:n=[],weekly_sales:a=[],top_selling_products:i=[],revenue_per_category:s=[],revenue_per_brand:o=[],deadstock:c=[],stock_movement:u=[],order_status_breakdown:d=[],average_order_value:f={}}=e,m=r.length>0||n.length>0||a.length>0||i.length>0||s.length>0||o.length>0||c.length>0||u.length>0||d.length>0;try{const p=jt.book_new(),x=k=>!k||k===0?"â‚±0.00":`â‚±${Number(k).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`;if(r.length>0){const k=r.map(_=>({Month:_.month||"","Total Sales":Number(_.total_sales)||0,"Total Sales (Formatted)":x(_.total_sales||0),"Order Count":Number(_.order_count)||0})),S=jt.json_to_sheet(k);S["!cols"]=[{wch:20},{wch:15},{wch:20},{wch:12}],jt.book_append_sheet(p,S,"Monthly Sales")}if(a.length>0){const k=a.map(_=>({Week:_.week||"","Total Sales":Number(_.total_sales)||0,"Total Sales (Formatted)":x(_.total_sales||0),"Order Count":Number(_.order_count)||0})),S=jt.json_to_sheet(k);S["!cols"]=[{wch:20},{wch:15},{wch:20},{wch:12}],jt.book_append_sheet(p,S,"Weekly Sales")}if(n.length>0){const k=n.map(_=>({Day:_.day||"","Total Sales":Number(_.total_sales)||0,"Total Sales (Formatted)":x(_.total_sales||0),"Order Count":Number(_.order_count)||0})),S=jt.json_to_sheet(k);S["!cols"]=[{wch:20},{wch:15},{wch:20},{wch:12}],jt.book_append_sheet(p,S,"Daily Sales")}if(i.length>0){const k=i.map(_=>({"Product Name":_.name||"",Brand:_.brand||"","Total Quantity Sold":Number(_.total_quantity)||0,"Total Revenue":Number(_.total_revenue)||0,"Total Revenue (Formatted)":x(_.total_revenue||0)})),S=jt.json_to_sheet(k);S["!cols"]=[{wch:40},{wch:15},{wch:18},{wch:15},{wch:20}],jt.book_append_sheet(p,S,"Top Selling Products")}if(s.length>0){const k=s.map(_=>({Category:_.category||"","Total Revenue":Number(_.total_revenue)||0,"Total Revenue (Formatted)":x(_.total_revenue||0),"Order Count":Number(_.order_count)||0})),S=jt.json_to_sheet(k);S["!cols"]=[{wch:20},{wch:15},{wch:20},{wch:12}],jt.book_append_sheet(p,S,"Revenue by Category")}if(o.length>0){const k=o.map(_=>({Brand:_.brand||"","Total Revenue":Number(_.total_revenue)||0,"Total Revenue (Formatted)":x(_.total_revenue||0),"Order Count":Number(_.order_count)||0})),S=jt.json_to_sheet(k);S["!cols"]=[{wch:20},{wch:15},{wch:20},{wch:12}],jt.book_append_sheet(p,S,"Revenue by Brand")}if(d.length>0){const k=d.map(_=>({Status:_.status||"",Count:Number(_.count)||0,Percentage:`${(Number(_.count)/d.reduce((C,E)=>C+Number(E.count),0)*100).toFixed(2)}%`})),S=jt.json_to_sheet(k);S["!cols"]=[{wch:20},{wch:12},{wch:12}],jt.book_append_sheet(p,S,"Order Status")}if(c.length>0){const k=c.map(_=>({"Component Name":_.name||"",Brand:_.brand||"","Stock Quantity":Number(_.stock_quantity)||0,Price:Number(_.price)||0,"Price (Formatted)":x(_.price||0),"Total Value":Number(_.price||0)*Number(_.stock_quantity||0),"Total Value (Formatted)":x(Number(_.price||0)*Number(_.stock_quantity||0)),"Last Sold Date":_.last_sold_date?new Date(_.last_sold_date).toLocaleDateString():"Never"})),S=jt.json_to_sheet(k);S["!cols"]=[{wch:40},{wch:15},{wch:15},{wch:15},{wch:18},{wch:15},{wch:20},{wch:18}],jt.book_append_sheet(p,S,"Deadstock")}if(u.length>0){const k=u.map(_=>({"Component Name":_.name||"",Brand:_.brand||"","Sold (Last 30 Days)":Number(_.sold_last_30_days)||0})),S=jt.json_to_sheet(k);S["!cols"]=[{wch:40},{wch:15},{wch:20}],jt.book_append_sheet(p,S,"Stock Movement")}const g=[{Metric:"Report Status",Value:m?"Data Available":"No Data Available"},{Metric:"Average Order Value",Value:x((f==null?void 0:f.avg_order_value)||0)},{Metric:"Total Monthly Sales Records",Value:r.length},{Metric:"Total Weekly Sales Records",Value:a.length},{Metric:"Total Daily Sales Records",Value:n.length},{Metric:"Top Selling Products Count",Value:i.length},{Metric:"Categories with Revenue",Value:s.length},{Metric:"Brands with Revenue",Value:o.length},{Metric:"Deadstock Items",Value:c.length},{Metric:"Order Status Records",Value:d.length},{Metric:"Report Generated",Value:new Date().toLocaleString()},{Metric:"Note",Value:m?"This report contains sales analytics data.":"No sales data is currently available. This may be because there are no completed orders yet or the system is still collecting data."}],y=jt.json_to_sheet(g);if(y["!cols"]=[{wch:30},{wch:50}],jt.book_append_sheet(p,y,"Summary"),!m){const k=jt.json_to_sheet([{Message:"No Sales Data Available"},{Message:""},{Message:"The following sheets are empty because there is no sales data to report:"},{Message:""},{Message:"â€¢ Monthly Sales"},{Message:"â€¢ Weekly Sales"},{Message:"â€¢ Daily Sales"},{Message:"â€¢ Top Selling Products"},{Message:"â€¢ Revenue by Category"},{Message:"â€¢ Revenue by Brand"},{Message:"â€¢ Order Status Breakdown"},{Message:"â€¢ Deadstock"},{Message:"â€¢ Stock Movement"},{Message:""},{Message:"Please ensure there are completed orders in the system to generate sales reports."}]);k["!cols"]=[{wch:60}],jt.book_append_sheet(p,k,"Info")}const b=`sales-report-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.xlsx`;mu(p,t||b)}catch(p){console.error("Error creating sales report file:",p),alert(`Failed to create sales report: ${p.message}`)}},Ife=e=>{if(!e||e.trim()==="")return[];const r=e.replace(/\r\n/g,`
`).replace(/\r/g,`
`).split(`
`).filter(s=>s.trim());if(r.length<2)return[];const a=g4(r[0]).map(s=>s.trim().replace(/^"|"$/g,"")),i=[];for(let s=1;s<r.length;s++){const o=g4(r[s]);if(o.length===a.length||o.length>0&&a.length>0){const c={};a.forEach((u,d)=>{let f=o[d]||"";f=f.trim().replace(/^"|"$/g,""),c[u]=f}),Object.values(c).some(u=>u!=="")&&i.push(c)}}return i},g4=e=>{const t=[];let r="",n=!1;for(let a=0;a<e.length;a++){const i=e[a],s=e[a+1];i==='"'&&n&&s==='"'?(r+='"',a++):i==='"'?n=!n:i===","&&!n?(t.push(r),r=""):r+=i}return t.push(r),t},Rfe=async e=>{if(typeof NN>"u"||!hu)throw new Error("SheetJS library not loaded. Please include xlsx library for Excel import.");return new Promise((t,r)=>{const n=new FileReader;n.onload=a=>{try{const i=new Uint8Array(a.target.result),s=hu(i,{type:"array",cellDates:!1,cellText:!1});if(!s.SheetNames||s.SheetNames.length===0){r(new Error("Excel file contains no sheets"));return}const o=s.SheetNames[0],c=s.Sheets[o];if(!c){r(new Error(`Sheet "${o}" not found or is empty`));return}const u=jt.sheet_to_json(c,{defval:"",raw:!1});if(!u||u.length===0){r(new Error("Excel sheet contains no data"));return}t(u)}catch(i){r(new Error(`Failed to parse Excel file: ${i.message}`))}},n.onerror=()=>{r(new Error("Failed to read file. Please ensure the file is not corrupted."))},n.readAsArrayBuffer(e)})},Ffe=(e,t=[])=>{if(!Array.isArray(e)||e.length===0)return[];const r=i=>{if(!i)return null;if(i.match(/^\d+$/)){const c=parseInt(i,10);return t.find(d=>d.id===c)?c:null}const o=t.find(c=>c.name.toLowerCase()===i.toLowerCase().trim());return o?o.id:null},n=i=>{if(i.Category){const s=r(i.Category);if(s)return s}if(i["Main Category"]){const s=i["Main Category"].toLowerCase().trim(),o={cpu:["CPU","Procie Only","Pro & Mobo - Amd","Pro & Mobo - Intel"],motherboard:["Motherboard","Mobo","Pro & Mobo - Amd","Pro & Mobo - Intel"],gpu:["GPU"],ram:["RAM","Ram 3200mhz"],storage:["Storage","Ssd Nvme"],psu:["PSU","Psu - Tr"],"power supply":["PSU","Psu - Tr"],case:["Case","Case Gaming"],cooler:["Cooler","Aio"]};for(const[c,u]of Object.entries(o))if(c===s||u.some(d=>d.toLowerCase()===s))for(const d of u){const f=t.find(m=>m.name===d);if(f)return f.id}}return null},a=[];for(const i of e){if(!i.Name&&!i.name)continue;const s=i.Name||i.name||"",o=n(i);if(!s.trim()||!o)continue;const c={name:s.trim(),category_id:o,brand:(i.Brand||i.brand||"").trim()||null,price:parseFloat(i.Price||i.price||0)||0,stock_quantity:parseInt(i["Stock Quantity"]||i.stock_quantity||i.Stock||i.stock||0,10)||0,image_url:(i["Image URL"]||i.image_url||i.Image||i.image||"").trim()||null};a.push(c)}return a},Mfe=e=>{const t=[];return(!e.name||e.name.trim()==="")&&t.push("Name is required"),(!e.category_id||e.category_id<=0)&&t.push("Valid category is required"),e.price<0&&t.push("Price must be non-negative"),e.stock_quantity<0&&t.push("Stock quantity must be non-negative"),{isValid:t.length===0,errors:t}},ZR=async(e,t=[])=>{if(!e)throw new Error("No file provided");const r=e.name.split(".").pop().toLowerCase();if(!["csv","xlsx","xls"].includes(r))throw new Error(`Unsupported file type: ${r}. Please use CSV or Excel (.xlsx, .xls) files.`);const a=10*1024*1024;if(e.size>a)throw new Error(`File size (${(e.size/1024/1024).toFixed(2)}MB) exceeds maximum allowed size of 10MB.`);if(e.size===0)throw new Error("File is empty. Please select a valid file.");let i=[];try{if(r==="csv"){const d=await e.text();if(!d||d.trim()==="")throw new Error("CSV file is empty or contains no readable content.");i=Ife(d)}else(r==="xlsx"||r==="xls")&&(i=await Rfe(e));if(!i||i.length===0)throw new Error("No data found in file. Please ensure the file has a header row and at least one data row.");const s=Ffe(i,t);if(s.length===0)throw new Error("No valid data rows found after parsing. Please check that your file contains columns like: Name, Category (or Main Category), Brand, Price, Stock Quantity.");const o=s.map(d=>({...d,validation:Mfe(d)})),c=o.filter(d=>d.validation.isValid),u=o.filter(d=>!d.validation.isValid);return{success:!0,total:s.length,valid:c.map(({validation:d,...f})=>f),invalid:u.map(({validation:d,...f})=>({...f,errors:d.errors})),rawData:i}}catch(s){return{success:!1,error:s.message||"Unknown error occurred while importing file",total:0,valid:[],invalid:[]}}},kN=({user:e})=>{const[t,r]=N.useState([]),[n,a]=N.useState(!0),[i,s]=N.useState(!1),[o,c]=N.useState(null),[u,d]=N.useState(""),[f,m]=N.useState("all"),[p,x]=N.useState([]),[g,y]=N.useState([]),[v,b]=N.useState("prebuilts"),[w,k]=N.useState([]),[S,_]=N.useState(!1),[C,E]=N.useState(1),[A,T]=N.useState(1),[D,I]=N.useState([]),[z,X]=N.useState({pending:0,approved:0,rejected:0}),[H,L]=N.useState(!1),[W,ie]=N.useState(null),[B,ee]=N.useState(""),[le,R]=N.useState(!1),[j,V]=N.useState("pending"),[P,q]=N.useState(1),[O,K]=N.useState(1),[G,te]=N.useState([]);N.useEffect(()=>{const fe=De=>De?Array.isArray(De)?De:typeof De=="string"?De.split(",").map(Ie=>Ie.trim()).filter(Boolean):[]:[];try{let De=fe(e==null?void 0:e.roles);if(De.length===0){const Ie=localStorage.getItem("user");if(Ie)try{const Ye=JSON.parse(Ie);De=fe(Ye==null?void 0:Ye.roles)}catch{}}if(De.length===0){const Ie=localStorage.getItem("token");if(Ie&&Ie.split(".").length===3){let Oe=Ie.split(".")[1].replace(/-/g,"+").replace(/_/g,"/");for(;Oe.length%4;)Oe+="=";try{const at=JSON.parse(atob(Oe));De=fe(at==null?void 0:at.roles)}catch{}}}te(De)}catch{te([])}},[e]);const ce=G.includes("Admin")||G.includes("Super Admin"),[M,Le]=N.useState({name:"",category:"gaming",description:"",price:"",performance:{gaming:"",streaming:""},features:[""],component_ids:{cpu:"",motherboard:"",gpu:"",ram:"",storage:"",psu:"",case:"",cooler:""},in_stock:!0,is_hidden:!1}),Te=async()=>{try{if(!await gr(!1)){console.log("No valid token for fetchPrebuilts"),a(!1);return}console.log("Fetching prebuilts...");const De=await tt(An("prebuilts")+"?all=1");if(De.status===401){console.log("Authentication failed for prebuilts"),a(!1);return}const Ie=await De.json();Array.isArray(Ie)?(r(Ie),console.log("Prebuilts loaded successfully")):console.error("Invalid prebuilts data:",Ie)}catch(fe){console.error("Error fetching prebuilts:",fe)}finally{a(!1)}},je=(fe,De)=>{try{if(fe==null)return De;if(typeof fe=="string"){const Ie=fe.trim();return Ie===""?De:JSON.parse(Ie)}return typeof fe=="object"?fe:De}catch{return De}},ze=async()=>{try{const De=await(await fetch(An("get_all_components"))).json();De.success&&x(De.data)}catch(fe){console.error("Error fetching components:",fe)}},Ce=async()=>{try{const De=await(await fetch(An("get_all_categories"))).json();De.success&&y(De.data)}catch(fe){console.error("Error fetching categories:",fe)}};N.useEffect(()=>{Te(),ze(),Ce()},[]);const de=()=>{Le({name:"",category:"gaming",description:"",price:"",performance:{gaming:"",streaming:""},features:[""],component_ids:{cpu:"",motherboard:"",gpu:"",ram:"",storage:"",psu:"",case:"",cooler:""},in_stock:!0,is_hidden:!1}),c(null)},$e=(fe=null)=>{fe?(Le({name:fe.name,category:fe.category,description:fe.description||"",price:fe.price,performance:je(fe.performance,{gaming:"",streaming:""}),features:je(fe.features,[""]),component_ids:je(fe.component_ids,{cpu:"",motherboard:"",gpu:"",ram:"",storage:"",psu:"",case:"",cooler:""}),in_stock:fe.in_stock==="1",is_hidden:fe.is_hidden==="1"}),c(fe)):de(),s(!0)},Re=()=>{s(!1),de()},Fe=async fe=>{fe.preventDefault();const De=Object.fromEntries(Object.entries(M.component_ids||{}).map(([Oe,at])=>[String(Oe).toLowerCase(),at])),Ye=["cpu","motherboard","gpu","ram","storage","psu","case"].filter(Oe=>!De[Oe]);if(Ye.length>0){alert("Please select all required components before saving this prebuilt. Missing: "+Ye.join(", "));return}try{const Oe=(M.description||"").trim();let at={...M};if(Oe.length===0){const Lt=new Map((p||[]).map(Sn=>[String(Sn.id),Sn.name])),Ct=Sn=>(Sn||"").split(",")[0].split("(")[0].trim(),rc=M.component_ids||{},Gn=[],za=Sn=>{const Mu=rc[Sn],U=Lt.get(String(Mu));U&&Gn.push(Ct(U))};za("cpu"),za("motherboard"),za("gpu"),za("ram"),za("storage"),za("psu"),za("case"),za("cooler"),at={...at,description:Gn.join(", ")}}if(!await gr(!1)){alert("Session expired. Please log in again.");return}const Nr=o?An("prebuilts")+`?id=${o.id}`:An("prebuilts"),Ko=await(await tt(Nr,{method:o?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(at)})).json();Ko.success?(Re(),Te(),alert(o?"Prebuilt updated successfully!":"Prebuilt created successfully!")):alert(Ko.error||"An error occurred")}catch(Oe){console.error("Error saving prebuilt:",Oe),alert("An error occurred while saving")}},Me=async fe=>{if(window.confirm("Are you sure you want to delete this prebuilt?"))try{if(!await gr(!1)){alert("Session expired. Please log in again.");return}const Ye=await(await tt(An("prebuilts")+`?id=${fe}`,{method:"DELETE"})).json();Ye.success?(Te(),alert("Prebuilt deleted successfully!")):alert(Ye.error||"An error occurred")}catch(De){console.error("Error deleting prebuilt:",De),alert("An error occurred while deleting")}},Ge=(fe,De)=>{Le(Ie=>({...Ie,[fe]:De}))},Qe=(fe,De,Ie)=>{Le(Ye=>({...Ye,[fe]:{...Ye[fe],[De]:Ie}}))},we=()=>{Le(fe=>({...fe,features:[...fe.features,""]}))},pe=fe=>{Le(De=>({...De,features:De.features.filter((Ie,Ye)=>Ye!==fe)}))},me=(fe,De)=>{Le(Ie=>({...Ie,features:Ie.features.map((Ye,Oe)=>Oe===fe?De:Ye)}))},Ae=t.filter(fe=>{const De=fe.name.toLowerCase().includes(u.toLowerCase()),Ie=f==="all"||fe.category===f;return De&&Ie}),Ke=fe=>{if(!fe)return"";const De=p.find(Ie=>Ie.id==fe);return De?De.name:`Component ${fe}`},He=fe=>{switch(fe){case"gaming":return l(rs,{className:"w-5 h-5"});case"workstation":return l(db,{className:"w-5 h-5"});case"cooling":return l(Rs,{className:"w-5 h-5"});default:return l(nt,{className:"w-5 h-5"})}},qe=fe=>{try{return new Date(fe).toLocaleString()}catch{return String(fe||"")}},xt=fe=>{const De=Number(fe)||0;return De>=90?{label:"Excellent",color:"text-green-600",bg:"bg-green-100",icon:l(At,{className:"w-4 h-4"})}:De>=70?{label:"Good",color:"text-yellow-600",bg:"bg-yellow-100",icon:l(ts,{className:"w-4 h-4"})}:{label:"Issues",color:"text-red-600",bg:"bg-red-100",icon:l(ts,{className:"w-4 h-4"})}},dt=async()=>{try{if(!await gr(!1))return;const Ie=await(await tt(An("community_management",{action:"stats"}))).json();if(Ie&&Ie.success){const Ye={pending:0,approved:0,rejected:0};(Ie.data||[]).forEach(Oe=>{Ye[Oe.status]=Number(Oe.count)||0}),X(Ye)}}catch(fe){console.error("Error fetching submission stats:",fe)}},Y=async(fe=1)=>{try{if(!await gr(!1))return;_(!0);const Ye=await(await tt(An("builds",{public:"1",page:String(fe)}))).json();if(Ye&&Ye.success){k(Array.isArray(Ye.data)?Ye.data:[]);const Oe=Ye.pagination||{};T(Number(Oe.pages)||1)}else k([]),T(1)}catch(De){console.error("Error fetching public builds:",De),k([]),T(1)}finally{_(!1)}},ve=async(fe="pending",De=1)=>{try{if(!await gr(!1))return;L(!0);const Oe=await(await tt(An("community_management",{action:"submissions",status:fe,page:String(De)}))).json();if(Oe&&Oe.success){I(Array.isArray(Oe.data)?Oe.data:[]);const at=Oe.pagination||{};K(Number(at.pages)||1)}else I([]),K(1)}catch(Ie){console.error("Error fetching community submissions:",Ie),I([]),K(1)}finally{L(!1)}};N.useEffect(()=>{dt()},[]),N.useEffect(()=>{ve(j,P)},[j,P]),N.useEffect(()=>{v==="community"&&Y(C)},[v,C]);const Je=async(fe,De)=>{R(!0);try{if(!await gr(!1)){alert("You must be logged in to review submissions.");return}const Oe=await(await tt(An("community_management",{action:"review"}),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({submission_id:fe,status:De,admin_notes:B})})).json();Oe&&Oe.success?(alert(`Submission ${De} successfully!`),ie(null),ee(""),ve(j,P),dt()):alert("Error reviewing submission: "+(Oe&&Oe.error?Oe.error:"Unknown error"))}catch(Ie){console.error("Error reviewing submission:",Ie),alert("Error reviewing submission. Please try again.")}finally{R(!1)}},pt=async(fe,De)=>{if(confirm(`Are you sure you want to delete the submission "${De}"? This action cannot be undone.`))try{if(!await gr(!1)){alert("You must be logged in to delete submissions.");return}const Oe=await(await tt(`${An("community_management",{action:"delete"})}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({submission_id:fe})})).json();Oe&&Oe.success?(alert("Submission deleted successfully!"),ve(j,P),dt()):alert("Error deleting submission: "+(Oe&&Oe.error?Oe.error:"Unknown error"))}catch(Ie){console.error("Error deleting submission:",Ie),alert("Error deleting submission. Please try again.")}};return n?l("div",{className:"flex items-center justify-center h-64",children:h("div",{className:"text-center",children:[l("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),l("p",{children:"Loading prebuilts..."})]})}):h("div",{className:"page-container space-y-6",children:[h("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l("h2",{className:"page-title",children:"Prebuilt PC"}),ce&&v==="prebuilts"&&l("div",{className:"flex gap-2",children:h("button",{onClick:()=>$e(),className:"btn btn-primary shadow",children:[l(wn,{className:"h-4 w-4"}),"Add Prebuilt"]})})]}),h("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg",children:[l("button",{onClick:()=>b("prebuilts"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${v==="prebuilts"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Prebuilt PCs"}),ce&&l("button",{onClick:()=>b("management"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${v==="management"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"PC Build Sharing"})]}),!ce&&l("div",{className:"text-sm text-gray-600",children:"Note: Curated Prebuilt actions are limited to Admins. You can still manage PC Build Sharing submissions below."}),v==="prebuilts"&&h(gt,{children:[l("div",{className:"card",children:h("div",{className:"flex flex-col md:flex-row gap-4",children:[h("div",{className:"flex-1 relative",children:[l(Di,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),l("input",{type:"text",placeholder:"Search prebuilts...",value:u,onChange:fe=>d(fe.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),h("select",{value:f,onChange:fe=>m(fe.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[l("option",{value:"all",children:"All Categories"}),l("option",{value:"gaming",children:"Gaming"}),l("option",{value:"workstation",children:"Workstation"}),l("option",{value:"cooling",children:"Cooling"})]})]})}),l("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Ae.map(fe=>h("div",{className:"card overflow-hidden",children:[l("div",{className:"relative",children:h("div",{className:"absolute top-2 left-2 flex gap-2",children:[fe.is_hidden==="1"&&l("span",{className:"chip chip-gray",children:"HIDDEN"}),fe.in_stock==="0"&&l("span",{className:"chip chip-red",children:"OUT OF STOCK"})]})}),h("div",{className:"p-6 text-left",children:[h("div",{className:"flex items-start justify-between mb-2",children:[l("h3",{className:"text-lg font-semibold text-gray-900 text-left",children:fe.name}),ce&&h("div",{className:"flex gap-1",children:[l("button",{onClick:()=>$e(fe),className:"btn btn-outline px-2 py-1",title:"Edit",children:l(Oi,{className:"w-4 h-4"})}),l("button",{onClick:()=>Me(fe.id),className:"btn btn-outline px-2 py-1 text-red-600 border-red-200 hover:bg-red-50",title:"Delete",children:l(Hr,{className:"w-4 h-4"})})]})]}),h("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-2 text-left",children:[He(fe.category),l("span",{className:"capitalize",children:fe.category})]}),l("div",{className:"text-lg font-bold text-green-600 mb-2 text-left",children:it(fe.price)}),fe.description&&l("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2 break-words text-left",children:fe.description}),l("div",{className:"text-xs text-gray-500 space-y-1 text-left",children:(()=>{const De=je(fe.component_ids,{});return h(gt,{children:[h("div",{className:"text-left",children:["CPU: ",Ke(De.cpu)]}),h("div",{className:"text-left",children:["GPU: ",Ke(De.gpu)]}),h("div",{className:"text-left",children:["RAM: ",Ke(De.ram)]})]})})()})]})]},fe.id))}),Ae.length===0&&h("div",{className:"card empty-state",children:[l(nt,{className:"w-10 h-10 text-gray-400 mx-auto mb-2"}),l("p",{children:"No prebuilts found"})]})]}),v==="management"&&h("div",{className:"card",children:[h("div",{className:"flex items-center justify-between mb-4",children:[h("div",{className:"flex items-center gap-2",children:[l(kd,{className:"w-5 h-5 text-green-600"}),l("h3",{className:"text-lg font-semibold text-gray-900",children:"PC Build Sharing"})]}),h("div",{className:"flex gap-2 text-sm",children:[h("span",{className:"px-2 py-1 rounded-full bg-gray-100 text-gray-700",children:["Pending: ",z.pending||0]}),h("span",{className:"px-2 py-1 rounded-full bg-green-100 text-green-700",children:["Approved: ",z.approved||0]}),h("span",{className:"px-2 py-1 rounded-full bg-red-100 text-red-700",children:["Rejected: ",z.rejected||0]})]})]}),l("div",{className:"flex items-center gap-2 mb-4",children:["pending","approved","rejected"].map(fe=>h("button",{onClick:()=>{V(fe),q(1)},className:`px-4 py-2 rounded-md border ${j===fe?"bg-white text-green-600 border-green-300":"text-gray-600 hover:text-gray-900 border-gray-200"}`,children:[fe.charAt(0).toUpperCase()+fe.slice(1),fe==="pending"&&(z.pending||0)>0&&l("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white bg-red-600 rounded-full",children:z.pending})]},fe))}),h("div",{className:"border rounded-lg overflow-hidden",children:[h("div",{className:"bg-gray-50 px-4 py-2 text-sm text-gray-600 flex items-center gap-2",children:[l(Co,{className:"w-4 h-4"}),H?"Loading submissions...":`${D.length} ${j} submission(s)`]}),D.length===0&&!H&&h("div",{className:"p-6 text-center text-gray-500",children:["No ",j," submissions found."]}),D.length>0&&l("div",{className:"divide-y",children:D.map(fe=>{var Ie;const De=xt(fe.compatibility);return h("div",{className:"p-4 flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[h("div",{className:"flex-1 min-w-0",children:[h("div",{className:"flex items-center gap-2 flex-wrap",children:[l("span",{className:"font-semibold text-gray-900 truncate",children:fe.build_name}),h("span",{className:`inline-flex items-center gap-1 text-xs px-2 py-0.5 rounded-full ${De.bg} ${De.color}`,children:[De.icon,De.label]}),h("span",{className:"text-xs text-gray-500",children:["â‚±",Number(fe.total_price||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),h("div",{className:"text-xs text-gray-600 mt-1 flex flex-wrap gap-2",children:[h("span",{children:["By: ",l("span",{className:"font-medium",children:fe.submitter_name||"Unknown"})]}),fe.submitter_email&&h("span",{children:["(",fe.submitter_email,")"]}),h("span",{children:["Submitted: ",qe(fe.submitted_at)]}),fe.reviewer_name&&fe.reviewed_at&&h("span",{children:["Reviewed by ",fe.reviewer_name," on ",qe(fe.reviewed_at)]})]}),fe.build_description&&l("p",{className:"text-sm text-gray-700 mt-2 line-clamp-2",children:fe.build_description})]}),l("div",{className:"flex items-center gap-2",children:j==="pending"?l("button",{onClick:()=>{ie(fe),ee(fe.admin_notes||"")},className:"px-4 py-2 rounded-md bg-green-600 hover:bg-green-700 text-white",children:"Review"}):h("div",{className:"flex items-center gap-2",children:[l("span",{className:"text-xs text-gray-500",children:(Ie=fe.status)==null?void 0:Ie.toUpperCase()}),l("button",{onClick:()=>pt(fe.id,fe.build_name),className:"px-3 py-1 rounded-md bg-red-600 hover:bg-red-700 text-white text-sm",children:"Delete"})]})})]},fe.id)})}),h("div",{className:"flex items-center justify-between px-4 py-3 bg-gray-50 text-sm text-gray-600",children:[l("button",{onClick:()=>q(fe=>Math.max(1,fe-1)),disabled:P<=1,className:`px-3 py-1 rounded border ${P<=1?"opacity-50 cursor-not-allowed":"hover:bg-white"}`,children:"Prev"}),h("span",{children:["Page ",P," of ",O]}),l("button",{onClick:()=>q(fe=>Math.min(O,fe+1)),disabled:P>=O,className:`px-3 py-1 rounded border ${P>=O?"opacity-50 cursor-not-allowed":"hover:bg-white"}`,children:"Next"})]})]})]}),W&&l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:h("div",{className:"bg-white rounded-xl max-w-2xl w-full",children:[h("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[l("h3",{className:"text-xl font-semibold text-gray-900",children:"Review Submission"}),l("button",{onClick:()=>ie(null),className:"text-gray-400 hover:text-gray-600",children:l(Yr,{className:"w-6 h-6"})})]}),h("div",{className:"p-6 space-y-4",children:[h("div",{children:[l("div",{className:"text-sm text-gray-500",children:"Build Name"}),l("div",{className:"text-base font-semibold text-gray-900",children:W.build_name})]}),h("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-700",children:[h("div",{children:["Submitter: ",l("span",{className:"font-medium",children:W.submitter_name})]}),h("div",{children:["Submitted: ",qe(W.submitted_at)]}),h("div",{children:["Compatibility: ",W.compatibility,"%"]}),h("div",{children:["Total Price: â‚±",Number(W.total_price||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),W.build_description&&h("div",{children:[l("div",{className:"text-sm text-gray-500 mb-1",children:"Description"}),l("p",{className:"text-sm text-gray-800 whitespace-pre-wrap",children:W.build_description})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Admin Notes (optional)"}),l("textarea",{value:B,onChange:fe=>ee(fe.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Add a note to the submitter (optional)"})]})]}),h("div",{className:"p-6 border-t border-gray-200 flex items-center justify-end gap-2",children:[l("button",{onClick:()=>ie(null),className:"px-4 py-2 rounded-md border",children:"Cancel"}),l("button",{disabled:le,onClick:()=>Je(W.id,"rejected"),className:`px-4 py-2 rounded-md bg-red-600 hover:bg-red-700 text-white ${le?"opacity-60 cursor-not-allowed":""}`,children:"Reject"}),l("button",{disabled:le,onClick:()=>Je(W.id,"approved"),className:`px-4 py-2 rounded-md bg-green-600 hover:bg-green-700 text-white ${le?"opacity-60 cursor-not-allowed":""}`,children:"Approve"})]})]})}),i&&l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:h("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[l("div",{className:"p-6 border-b border-gray-200",children:h("div",{className:"flex items-center justify-between",children:[l("h3",{className:"text-xl font-semibold text-gray-900",children:o?"Edit Prebuilt":"Add New Prebuilt"}),l("button",{onClick:Re,className:"text-gray-400 hover:text-gray-600",children:l(Yr,{className:"w-6 h-6"})})]})}),h("form",{onSubmit:Fe,className:"p-6 space-y-6",children:[h("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name"}),l("input",{type:"text",value:M.name,onChange:fe=>Ge("name",fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),h("select",{value:M.category,onChange:fe=>Ge("category",fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[l("option",{value:"gaming",children:"Gaming"}),l("option",{value:"workstation",children:"Workstation"}),l("option",{value:"cooling",children:"Cooling"})]})]})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),l("textarea",{value:M.description,onChange:fe=>Ge("description",fe.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price (â‚±)"}),l("input",{type:"number",value:M.price,onChange:fe=>Ge("price",fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Performance (optional)"}),h("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h("div",{children:[l("label",{className:"block text-xs text-gray-600 mb-1",children:"Gaming (%)"}),l("input",{type:"number",min:"0",max:"100",value:M.performance.gaming,onChange:fe=>Qe("performance","gaming",fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),h("div",{children:[l("label",{className:"block text-xs text-gray-600 mb-1",children:"Streaming (%)"}),l("input",{type:"number",min:"0",max:"100",value:M.performance.streaming,onChange:fe=>Qe("performance","streaming",fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})]})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Features"}),h("div",{className:"space-y-2",children:[M.features.map((fe,De)=>h("div",{className:"flex gap-2",children:[l("input",{type:"text",value:fe,onChange:Ie=>me(De,Ie.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Enter feature"}),l("button",{type:"button",onClick:()=>pe(De),className:"px-3 py-2 text-red-500 hover:text-red-700",children:l(Yr,{className:"w-4 h-4"})})]},De)),h("button",{type:"button",onClick:we,className:"text-green-600 hover:text-green-700 text-sm flex items-center gap-1",children:[l(wn,{className:"w-4 h-4"}),"Add Feature"]})]})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Components"}),l("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(M.component_ids).map(([fe,De])=>h("div",{children:[l("label",{className:"block text-xs text-gray-600 mb-1 capitalize",children:fe}),h("select",{value:De,onChange:Ie=>Qe("component_ids",fe,Ie.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[h("option",{value:"",children:["Select ",fe]}),p.filter(Ie=>{const Ye=g.find(at=>at.id==Ie.category_id);if(!Ye)return!1;const Oe=Ye.name.toLowerCase();switch(fe){case"cpu":return Oe.includes("cpu")||Oe.includes("procie")||Oe.includes("processor");case"motherboard":return Oe.includes("mobo")||Oe.includes("motherboard");case"gpu":return Oe.includes("gpu")||Oe.includes("graphics");case"ram":return Oe.includes("ram")||Oe.includes("memory");case"storage":return Oe.includes("storage")||Oe.includes("ssd")||Oe.includes("hdd")||Oe.includes("hard drive");case"psu":return Oe.includes("psu")||Oe.includes("power supply");case"case":return Oe.includes("case")||Oe.includes("chassis");case"cooler":return Oe.includes("cooler")||Oe.includes("aio")||Oe.includes("fan")||Oe.includes("heatsink");default:return!1}}).map(Ie=>h("option",{value:Ie.id,children:[Ie.name," - ",it(Ie.price)]},Ie.id))]})]},fe))})]}),h("div",{className:"flex gap-4",children:[h("label",{className:"flex items-center",children:[l("input",{type:"checkbox",checked:M.in_stock,onChange:fe=>Ge("in_stock",fe.target.checked),className:"mr-2"}),l("span",{className:"text-sm text-gray-700",children:"In Stock"})]}),h("label",{className:"flex items-center",children:[l("input",{type:"checkbox",checked:M.is_hidden,onChange:fe=>Ge("is_hidden",fe.target.checked),className:"mr-2"}),l("span",{className:"text-sm text-gray-700",children:"Hidden"})]})]}),h("div",{className:"flex justify-end gap-4 pt-6 border-t border-gray-200",children:[l("button",{type:"button",onClick:Re,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),h("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2",children:[l(yh,{className:"w-4 h-4"}),o?"Update":"Create"]})]})]})]})})]})},eF=()=>h("div",{children:[l("h2",{children:"Admin Reports"}),l("p",{children:"This is a placeholder for Admin Reports. Please implement report logic as needed."})]}),Ka=["#6366F1","#10B981","#F59E0B","#EF4444","#8B5CF6","#06B6D4","#EC4899","#F97316","#84CC16","#14B8A6"],SN=({reports:e={},inventory:t=[],categories:r=[],formalCategoryNames:n={},deadstockPeriod:a=90,onDeadstockPeriodChange:i,isLoading:s})=>{var V,P;if(s)return h("div",{className:"flex flex-col items-center justify-center min-h-[300px] py-12",children:[l("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500 mb-4"}),l("div",{className:"text-gray-500 text-lg",children:"Loading Sales Reports..."})]});const{monthly_sales:o=[],daily_sales:c=[],weekly_sales:u=[],top_selling_products:d=[],revenue_per_category:f=[],revenue_per_brand:m=[],deadstock:p=[],stock_movement:x=[],order_status_breakdown:g=[],average_order_value:y={}}=e,[v,b]=N.useState("all"),[w,k]=N.useState("monthly"),[S,_]=N.useState(!0),[C,E]=N.useState(""),[A,T]=N.useState(1),[D,I]=N.useState(null),z=10,X=["CPU","Motherboard","GPU","RAM","Storage","PSU","Case","Cooler","Procie Only","Mobo","Ram 3200mhz","Ssd Nvme","Psu - Tr","Case Gaming","Aio"],H=(r||[]).filter(q=>X.includes(q.name)),L=p||[],W=Array.from(new Set(L.map(q=>{const O=t.find(K=>K.id===q.id);return O!=null&&O.category_id?String(O.category_id):null}).filter(Boolean))),ie=H.filter(q=>W.includes(String(q.id))),B=(v==="all"?L:L.filter(q=>{var K;const O=(K=t.find(G=>G.id===q.id))==null?void 0:K.category_id;return String(O)===String(v)})).filter(q=>{var te,ce;const O=C.trim().toLowerCase();if(!O)return!0;const K=((te=q.name)==null?void 0:te.toLowerCase())||"",G=((ce=q.brand)==null?void 0:ce.toLowerCase())||"";return K.includes(O)||G.includes(O)});let ee=[],le="",R=null;return w==="monthly"?(ee=o,le="Monthly Sales",R=l(tr,{width:"100%",height:250,children:h(qi,{data:o,margin:{top:10,right:20,left:0,bottom:0},children:[l(Lr,{strokeDasharray:"3 3"}),l(Br,{dataKey:"month",label:{value:"Month",position:"insideBottomRight",offset:0}}),l(jr,{}),l(rr,{}),l(Gt,{}),l(Ei,{type:"monotone",dataKey:"total_sales",stroke:"#6366F1",strokeWidth:3})]})})):w==="weekly"?(ee=u,le="Weekly Sales",R=l(tr,{width:"100%",height:250,children:h(qi,{data:u,margin:{top:10,right:20,left:0,bottom:0},children:[l(Lr,{strokeDasharray:"3 3"}),l(Br,{dataKey:"week",label:{value:"Week",position:"insideBottomRight",offset:0}}),l(jr,{}),l(rr,{}),l(Gt,{}),l(Ei,{type:"monotone",dataKey:"total_sales",stroke:"#22D3EE",strokeWidth:3})]})})):w==="daily"&&(ee=c,le="Daily Sales (Last 30 Days)",R=l(tr,{width:"100%",height:250,children:h(fs,{data:c,margin:{top:10,right:20,left:0,bottom:0},children:[l(Lr,{strokeDasharray:"3 3"}),l(Br,{dataKey:"day",label:{value:"Day",position:"insideBottomRight",offset:0}}),l(jr,{}),l(rr,{}),l(Gt,{}),l(Za,{dataKey:"total_sales",fill:"#F59E42"})]})})),h("div",{className:"page-container space-y-8",children:[h("div",{className:"flex items-center justify-between",children:[l("h2",{className:"page-title",children:"Sales Reports & Analytics"}),h("button",{onClick:()=>{Dfe(e)},className:"btn btn-primary flex items-center gap-2",title:"Download Sales Report as Excel",children:[l(Ss,{className:"h-4 w-4"}),"Download Report"]})]}),h("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[h("div",{className:"card",children:[l("div",{className:"text-sm text-gray-500",children:"Average Order Value"}),l("div",{className:"text-2xl font-bold text-gray-900",children:it((y==null?void 0:y.avg_order_value)||0)})]}),h("div",{className:"card",children:[l("div",{className:"text-sm text-gray-500",children:"Top Category"}),l("div",{className:"text-2xl font-bold text-gray-900",children:((V=f==null?void 0:f[0])==null?void 0:V.category)||"â€”"})]}),h("div",{className:"card",children:[l("div",{className:"text-sm text-gray-500",children:"Top Product"}),l("div",{className:"text-2xl font-bold text-gray-900",children:((P=d==null?void 0:d[0])==null?void 0:P.name)||"â€”"})]})]}),h("div",{className:"space-y-6",children:[h("div",{className:"card chart-card relative",children:[h("div",{className:"flex items-center justify-between mb-6",children:[l("h3",{className:"text-lg font-semibold text-gray-900",children:"Sales Overview"}),h("div",{className:"flex items-center gap-2",children:[l("label",{htmlFor:"sales-chart-type",className:"text-sm text-gray-600",children:"View:"}),h("select",{id:"sales-chart-type",className:"text-sm border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",value:w,onChange:q=>k(q.target.value),children:[l("option",{value:"monthly",children:"Monthly"}),l("option",{value:"weekly",children:"Weekly"}),l("option",{value:"daily",children:"Daily"})]}),ee&&ee.length>0&&l("button",{onClick:()=>I("sales-overview"),className:"p-1.5 hover:bg-gray-100 rounded transition-colors ml-2",title:"Expand chart",children:l(sc,{className:"h-4 w-4 text-gray-600"})})]})]}),l("div",{className:"h-[320px]",children:ee&&ee.length>0?R:h("div",{className:"flex flex-col items-center justify-center h-full p-6",children:[l(nt,{className:"w-12 h-12 text-gray-300 mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-2 text-center",children:"No data available"}),l("p",{className:"text-gray-400 text-sm max-w-md text-center",children:"This could be because there are no completed orders yet or the system is still collecting data."})]})})]}),l("div",{className:"flex justify-end",children:h("button",{className:`btn ${S?"btn-primary":"btn-secondary"}`,onClick:()=>_(q=>!q),children:[S?l(zT,{className:"h-4 w-4"}):l(hl,{className:"h-4 w-4"}),S?"Hide Deadstock":"Show Deadstock"]})}),S&&h("div",{className:"card",children:[l("div",{className:"p-6 border-b border-gray-200",children:h("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[h("h3",{className:"text-lg font-semibold text-gray-900",children:["Deadstock (No Sales in ",a," Days)"]}),h("div",{className:"flex gap-2",children:[l("input",{type:"text",className:"border rounded px-3 py-1.5 text-sm w-full sm:w-64",placeholder:"Search by name or brand...",value:C,onChange:q=>E(q.target.value)}),h("select",{className:"border rounded px-3 py-1.5 text-sm",value:v,onChange:q=>{b(q.target.value),T(1)},children:[l("option",{value:"all",children:"All Categories"}),ie.map(q=>l("option",{value:q.id,children:q.name},q.id))]})]})]})}),l("div",{className:"overflow-x-auto",children:B.length>0?h("div",{children:[l("div",{className:"min-w-full divide-y divide-gray-200",children:h("table",{className:"min-w-full",children:[l("thead",{className:"bg-gray-50",children:h("tr",{children:[l("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Component"}),l("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Qty"}),l("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Price"}),l("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Total Value"}),l("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Last Sold"})]})}),l("tbody",{className:"bg-white divide-y divide-gray-200",children:B.slice((A-1)*z,A*z).map(q=>h("tr",{className:"hover:bg-gray-50",children:[l("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:q.name}),l("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:q.stock_quantity}),l("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:it(q.price)}),l("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:it(Number(q.price)*Number(q.stock_quantity))}),l("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:q.last_sold_date?new Date(q.last_sold_date).toLocaleDateString():"Never"})]},q.id))})]})}),B.length>z&&h("div",{className:"flex items-center justify-between mt-4 px-4 py-3 bg-white border-t border-gray-200 sm:px-6",children:[h("div",{className:"flex-1 flex justify-between sm:hidden",children:[l("button",{onClick:()=>T(q=>Math.max(1,q-1)),disabled:A===1,className:`relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md ${A===1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"Previous"}),l("button",{onClick:()=>T(q=>Math.min(Math.ceil(B.length/z),q+1)),disabled:A===Math.ceil(B.length/z),className:`ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md ${A===Math.ceil(B.length/z)?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"Next"})]}),h("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[l("div",{children:h("p",{className:"text-sm text-gray-700",children:["Showing ",l("span",{className:"font-medium",children:(A-1)*z+1})," to"," ",l("span",{className:"font-medium",children:Math.min(A*z,B.length)})," ","of ",l("span",{className:"font-medium",children:B.length})," results"]})}),l("div",{children:h("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[h("button",{onClick:()=>T(q=>Math.max(1,q-1)),disabled:A===1,className:`relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium ${A===1?"text-gray-300 cursor-not-allowed":"text-gray-500 hover:bg-gray-50"}`,children:[l("span",{className:"sr-only",children:"Previous"}),l("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:l("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})})]}),Array.from({length:Math.ceil(B.length/z)},(q,O)=>O+1).map(q=>l("button",{onClick:()=>T(q),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${A===q?"z-10 bg-indigo-50 border-indigo-500 text-indigo-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:q},q)),h("button",{onClick:()=>T(q=>Math.min(Math.ceil(B.length/z),q+1)),disabled:A===Math.ceil(B.length/z),className:`relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium ${A===Math.ceil(B.length/z)?"text-gray-300 cursor-not-allowed":"text-gray-500 hover:bg-gray-50"}`,children:[l("span",{className:"sr-only",children:"Next"}),l("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:l("path",{fillRule:"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z",clipRule:"evenodd"})})]})]})})]})]})]}):h("div",{className:"text-center py-8 w-full",children:[l(nt,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-2 text-center",children:"No deadstock data available"}),l("div",{className:"text-center w-full",children:l("p",{className:"text-gray-400 text-sm max-w-md mx-auto text-center leading-relaxed",style:{textAlign:"center",marginLeft:"auto",marginRight:"auto"},children:"This could be because there are no components with no sales in the specified period, or the system is still collecting data."})})]})})]}),h("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h("div",{className:"card chart-card relative",children:[h("div",{className:"flex items-center justify-between mb-2",children:[l("h3",{className:"text-lg font-semibold text-gray-900",children:"Top-Selling Products"}),h("div",{className:"flex items-center gap-2",children:[l("span",{className:"text-xs text-gray-500",children:"Qty vs Revenue"}),d&&d.length>0&&l("button",{onClick:()=>I("top-selling"),className:"p-1.5 hover:bg-gray-100 rounded transition-colors",title:"Expand chart",children:l(sc,{className:"h-4 w-4 text-gray-600"})})]})]}),l("div",{className:"h-[320px]",children:d&&d.length>0?l(tr,{width:"100%",height:320,children:h(fs,{data:d,layout:"vertical",margin:{top:10,right:20,left:0,bottom:0},children:[l(Lr,{strokeDasharray:"3 3"}),l(Br,{type:"number"}),l(jr,{dataKey:"name",type:"category",width:140,tick:{fontSize:9},angle:0,textAnchor:"end",interval:0}),l(rr,{contentStyle:{fontSize:"12px"},formatter:(q,O)=>O==="Quantity Sold"?[q,"Quantity"]:O==="Revenue"?[it(q),"Revenue"]:[q,O]}),l(Gt,{wrapperStyle:{fontSize:12}}),l(Za,{dataKey:"total_quantity",fill:"#6366F1",name:"Quantity Sold"}),l(Za,{dataKey:"total_revenue",fill:"#F59E42",name:"Revenue"})]})}):h("div",{className:"flex flex-col items-center justify-center h-full p-6",children:[l(nt,{className:"w-12 h-12 text-gray-300 mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-2 text-center",children:"No data available"}),l("p",{className:"text-gray-400 text-sm max-w-md text-center",children:"This could be because there are no completed orders yet or the system is still collecting data."})]})})]}),h("div",{className:"card chart-card relative",children:[h("div",{className:"flex items-center justify-between mb-4",children:[l("h3",{className:"text-lg font-semibold text-gray-900",children:"Revenue by Category"}),f&&f.length>0&&l("button",{onClick:()=>I("revenue-category"),className:"p-1.5 hover:bg-gray-100 rounded transition-colors",title:"Expand chart",children:l(sc,{className:"h-4 w-4 text-gray-600"})})]}),l("div",{className:"h-[300px]",children:f&&f.length>0?(()=>{const q=[...f].map(K=>({...K,total_revenue:Number(K.total_revenue)||0})).sort((K,G)=>G.total_revenue-K.total_revenue),O=q.reduce((K,G)=>K+G.total_revenue,0);return l(tr,{width:"100%",height:300,children:h(dc,{children:[l(tl,{data:q,dataKey:"total_revenue",nameKey:"category",cx:"50%",cy:"45%",innerRadius:40,outerRadius:90,label:!1,children:q.map((K,G)=>l(Gi,{fill:Ka[G%Ka.length],stroke:"#fff",strokeWidth:2},`cell-${G}`))}),l(rr,{formatter:(K,G,te)=>[it(K),`${te.payload.category}: ${(K/O*100).toFixed(1)}%`]}),l(Gt,{verticalAlign:"bottom",height:36,formatter:(K,G,te)=>{const ce=q[te],M=O>0?(ce.total_revenue/O*100).toFixed(1):"0";return`${K} (${M}%)`},wrapperStyle:{fontSize:"11px",paddingTop:"10px"}})]})})})():h("div",{className:"flex flex-col items-center justify-center h-full p-6",children:[l(nt,{className:"w-12 h-12 text-gray-300 mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-2 text-center",children:"No data available"}),l("p",{className:"text-gray-400 text-sm max-w-md text-center",children:"This could be because there are no completed orders yet or the system is still collecting data."})]})})]}),h("div",{className:"card chart-card relative",children:[h("div",{className:"flex items-center justify-between mb-4",children:[h("div",{className:"flex items-center gap-2",children:[l(nt,{className:"h-5 w-5 text-blue-500"}),l("h3",{className:"text-lg font-bold text-gray-900",children:"Revenue by Brand"})]}),m&&m.length>0&&l("button",{onClick:()=>I("revenue-brand"),className:"p-1.5 hover:bg-gray-100 rounded transition-colors",title:"Expand chart",children:l(sc,{className:"h-4 w-4 text-gray-600"})})]}),l("div",{className:"h-[250px]",children:m&&m.length>0?(()=>{const q=te=>te?te.trim().toUpperCase().replace(/\s+/g," "):"",O=new Map;m.forEach(te=>{const ce=q(te.brand),M=O.get(ce);M?M.total_revenue=(Number(M.total_revenue)||0)+(Number(te.total_revenue)||0):O.set(ce,{...te,brand:te.brand,total_revenue:Number(te.total_revenue)||0})});const K=Array.from(O.values()).sort((te,ce)=>ce.total_revenue-te.total_revenue),G=K.reduce((te,ce)=>te+ce.total_revenue,0);return l(tr,{width:"100%",height:250,children:h(dc,{children:[l(tl,{data:K,dataKey:"total_revenue",nameKey:"brand",cx:"50%",cy:"45%",innerRadius:35,outerRadius:80,label:!1,children:K.map((te,ce)=>l(Gi,{fill:Ka[ce%Ka.length],stroke:"#fff",strokeWidth:2},`brand-${ce}`))}),l(rr,{formatter:(te,ce,M)=>[it(te),`${M.payload.brand}: ${(te/G*100).toFixed(1)}%`]}),l(Gt,{verticalAlign:"bottom",height:36,formatter:(te,ce,M)=>{const Le=K[M],Te=G>0?(Le.total_revenue/G*100).toFixed(1):"0";return`${te} (${Te}%)`},wrapperStyle:{fontSize:"11px",paddingTop:"10px"}})]})})})():h("div",{className:"flex flex-col items-center justify-center h-full p-6",children:[l(nt,{className:"w-12 h-12 text-gray-300 mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-2 text-center",children:"No data available"}),l("p",{className:"text-gray-400 text-sm max-w-md text-center",children:"This could be because there are no completed orders yet or the system is still collecting data."})]})})]}),h("div",{className:"card chart-card relative",children:[h("div",{className:"flex items-center justify-between mb-4",children:[h("div",{className:"flex items-center gap-2",children:[l(Uk,{className:"h-5 w-5 text-green-500"}),l("h3",{className:"text-lg font-bold text-gray-900",children:"Order Status Breakdown"})]}),g&&g.length>0&&l("button",{onClick:()=>I("order-status"),className:"p-1.5 hover:bg-gray-100 rounded transition-colors",title:"Expand chart",children:l(sc,{className:"h-4 w-4 text-gray-600"})})]}),l("div",{className:"h-[250px]",children:g&&g.length>0?(()=>{const q=[...g].map(K=>({...K,count:Number(K.count)||0})).sort((K,G)=>G.count-K.count),O=q.reduce((K,G)=>K+G.count,0);return l(tr,{width:"100%",height:250,children:h(dc,{children:[l(tl,{data:q,dataKey:"count",nameKey:"status",cx:"50%",cy:"45%",innerRadius:35,outerRadius:80,label:!1,children:q.map((K,G)=>l(Gi,{fill:Ka[G%Ka.length],stroke:"#fff",strokeWidth:2},`status-${G}`))}),l(rr,{formatter:(K,G,te)=>[`${K} orders`,`${te.payload.status}: ${(K/O*100).toFixed(1)}%`]}),l(Gt,{verticalAlign:"bottom",height:36,formatter:(K,G,te)=>{const ce=q[te],M=O>0?(ce.count/O*100).toFixed(1):"0";return`${K} (${ce.count}, ${M}%)`},wrapperStyle:{fontSize:"11px",paddingTop:"10px"}})]})})})():h("div",{className:"flex flex-col items-center justify-center h-full p-6",children:[l(nt,{className:"w-12 h-12 text-gray-300 mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-2 text-center",children:"No data available"}),l("p",{className:"text-gray-400 text-sm max-w-md text-center",children:"This could be because there are no completed orders yet or the system is still collecting data."})]})})]})]}),l("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mt-8",children:h("div",{className:"card chart-card relative",children:[h("div",{className:"flex items-center justify-between mb-4",children:[h("div",{className:"flex items-center gap-2",children:[l(Qc,{className:"h-5 w-5 text-teal-500"}),l("h3",{className:"text-lg font-bold text-gray-900",children:"Stock Movement (Last 30 Days)"})]}),x&&x.length>0&&l("button",{onClick:()=>I("stock-movement"),className:"p-1.5 hover:bg-gray-100 rounded transition-colors",title:"Expand chart",children:l(sc,{className:"h-4 w-4 text-gray-600"})})]}),l("div",{className:"h-[250px]",children:x&&x.length>0?l(tr,{width:"100%",height:250,children:h(fs,{data:x,layout:"vertical",margin:{top:10,right:20,left:0,bottom:0},children:[l(Lr,{strokeDasharray:"3 3"}),l(Br,{type:"number"}),l(jr,{dataKey:"name",type:"category",width:140,tick:{fontSize:9},angle:0,textAnchor:"end",interval:0}),l(rr,{contentStyle:{fontSize:"12px"}}),l(Gt,{}),l(Za,{dataKey:"sold_last_30_days",fill:"#22D3EE",name:"Sold (30d)"})]})}):h("div",{className:"flex flex-col items-center justify-center h-full p-6",children:[l(nt,{className:"w-12 h-12 text-gray-300 mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-2 text-center",children:"No data available"}),l("p",{className:"text-gray-400 text-sm max-w-md text-center",children:"This could be because there are no completed orders in the last 30 days or the system is still collecting data."})]})})]})}),h("div",{className:"card p-8 max-w-md mx-auto mt-10 flex flex-col items-center",children:[h("div",{className:"flex items-center gap-2 mb-2",children:[l(Uk,{className:"h-7 w-7 text-indigo-500"}),l("h3",{className:"text-lg font-bold text-gray-900",children:"Average Order Value"})]}),l("div",{className:"text-4xl font-extrabold text-green-700",children:it((y==null?void 0:y.avg_order_value)||0)})]})]}),D&&l("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",onClick:()=>I(null),children:h("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-6xl max-h-[90vh] overflow-y-auto relative",onClick:q=>q.stopPropagation(),children:[l("button",{onClick:()=>I(null),className:"absolute top-4 right-4 bg-gray-100 hover:bg-red-100 text-gray-500 hover:text-red-600 rounded-full p-2 transition-colors shadow z-10",title:"Close",children:l(Yr,{className:"h-5 w-5"})}),h("div",{className:"p-8",children:[D==="top-selling"&&d&&d.length>0&&h(gt,{children:[l("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Top-Selling Products"}),l("p",{className:"text-sm text-gray-500 mb-6",children:"Qty vs Revenue"}),l("div",{className:"h-[600px]",children:l(tr,{width:"100%",height:600,children:h(fs,{data:d,layout:"vertical",margin:{top:10,right:30,left:0,bottom:20},children:[l(Lr,{strokeDasharray:"3 3"}),l(Br,{type:"number"}),l(jr,{dataKey:"name",type:"category",width:180,tick:{fontSize:11},angle:0,textAnchor:"end",interval:0}),l(rr,{contentStyle:{fontSize:"14px"},formatter:(q,O)=>O==="Quantity Sold"?[q,"Quantity"]:O==="Revenue"?[it(q),"Revenue"]:[q,O]}),l(Gt,{wrapperStyle:{fontSize:14}}),l(Za,{dataKey:"total_quantity",fill:"#6366F1",name:"Quantity Sold"}),l(Za,{dataKey:"total_revenue",fill:"#F59E42",name:"Revenue"})]})})})]}),D==="revenue-category"&&f&&f.length>0&&(()=>{const q=[...f].map(K=>({...K,total_revenue:Number(K.total_revenue)||0})).sort((K,G)=>G.total_revenue-K.total_revenue),O=q.reduce((K,G)=>K+G.total_revenue,0);return h(gt,{children:[l("h3",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Revenue by Category"}),l("div",{className:"h-[600px]",children:l(tr,{width:"100%",height:600,children:h(dc,{children:[l(tl,{data:q,dataKey:"total_revenue",nameKey:"category",cx:"50%",cy:"45%",innerRadius:80,outerRadius:180,label:!1,children:q.map((K,G)=>l(Gi,{fill:Ka[G%Ka.length],stroke:"#fff",strokeWidth:2},`cell-${G}`))}),l(rr,{formatter:(K,G,te)=>[it(K),`${te.payload.category}: ${(K/O*100).toFixed(1)}%`]}),l(Gt,{verticalAlign:"bottom",height:50,formatter:(K,G,te)=>{const ce=q[te],M=O>0?(ce.total_revenue/O*100).toFixed(1):"0";return`${K} (${M}%)`},wrapperStyle:{fontSize:"14px",paddingTop:"20px"}})]})})})]})})(),D==="revenue-brand"&&m&&m.length>0&&(()=>{const q=te=>te?te.trim().toUpperCase().replace(/\s+/g," "):"",O=new Map;m.forEach(te=>{const ce=q(te.brand),M=O.get(ce);M?M.total_revenue=(Number(M.total_revenue)||0)+(Number(te.total_revenue)||0):O.set(ce,{...te,brand:te.brand,total_revenue:Number(te.total_revenue)||0})});const K=Array.from(O.values()).sort((te,ce)=>ce.total_revenue-te.total_revenue),G=K.reduce((te,ce)=>te+ce.total_revenue,0);return h(gt,{children:[l("h3",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Revenue by Brand"}),l("div",{className:"h-[600px]",children:l(tr,{width:"100%",height:600,children:h(dc,{children:[l(tl,{data:K,dataKey:"total_revenue",nameKey:"brand",cx:"50%",cy:"45%",innerRadius:80,outerRadius:180,label:!1,children:K.map((te,ce)=>l(Gi,{fill:Ka[ce%Ka.length],stroke:"#fff",strokeWidth:2},`brand-${ce}`))}),l(rr,{formatter:(te,ce,M)=>[it(te),`${M.payload.brand}: ${(te/G*100).toFixed(1)}%`]}),l(Gt,{verticalAlign:"bottom",height:50,formatter:(te,ce,M)=>{const Le=K[M],Te=G>0?(Le.total_revenue/G*100).toFixed(1):"0";return`${te} (${Te}%)`},wrapperStyle:{fontSize:"14px",paddingTop:"20px"}})]})})})]})})(),D==="order-status"&&g&&g.length>0&&(()=>{const q=[...g].map(K=>({...K,count:Number(K.count)||0})).sort((K,G)=>G.count-K.count),O=q.reduce((K,G)=>K+G.count,0);return h(gt,{children:[l("h3",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Order Status Breakdown"}),l("div",{className:"h-[600px]",children:l(tr,{width:"100%",height:600,children:h(dc,{children:[l(tl,{data:q,dataKey:"count",nameKey:"status",cx:"50%",cy:"45%",innerRadius:80,outerRadius:180,label:!1,children:q.map((K,G)=>l(Gi,{fill:Ka[G%Ka.length],stroke:"#fff",strokeWidth:2},`status-${G}`))}),l(rr,{formatter:(K,G,te)=>[`${K} orders`,`${te.payload.status}: ${(K/O*100).toFixed(1)}%`]}),l(Gt,{verticalAlign:"bottom",height:50,formatter:(K,G,te)=>{const ce=q[te],M=O>0?(ce.count/O*100).toFixed(1):"0";return`${K} (${ce.count}, ${M}%)`},wrapperStyle:{fontSize:"14px",paddingTop:"20px"}})]})})})]})})(),D==="stock-movement"&&x&&x.length>0&&h(gt,{children:[l("h3",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Stock Movement (Last 30 Days)"}),l("div",{className:"h-[600px]",children:l(tr,{width:"100%",height:600,children:h(fs,{data:x,layout:"vertical",margin:{top:10,right:30,left:0,bottom:20},children:[l(Lr,{strokeDasharray:"3 3"}),l(Br,{type:"number"}),l(jr,{dataKey:"name",type:"category",width:180,tick:{fontSize:11},angle:0,textAnchor:"end",interval:0}),l(rr,{contentStyle:{fontSize:"14px"}}),l(Gt,{wrapperStyle:{fontSize:14}}),l(Za,{dataKey:"sold_last_30_days",fill:"#22D3EE",name:"Sold (30d)"})]})})})]}),D==="sales-overview"&&ee&&ee.length>0&&h(gt,{children:[h("h3",{className:"text-2xl font-bold text-gray-900 mb-6",children:["Sales Overview - ",le]}),h("div",{className:"h-[600px]",children:[w==="monthly"&&l(tr,{width:"100%",height:600,children:h(qi,{data:o,margin:{top:10,right:30,left:0,bottom:20},children:[l(Lr,{strokeDasharray:"3 3"}),l(Br,{dataKey:"month",label:{value:"Month",position:"insideBottomRight",offset:0}}),l(jr,{}),l(rr,{}),l(Gt,{}),l(Ei,{type:"monotone",dataKey:"total_sales",stroke:"#6366F1",strokeWidth:3})]})}),w==="weekly"&&l(tr,{width:"100%",height:600,children:h(qi,{data:u,margin:{top:10,right:30,left:0,bottom:20},children:[l(Lr,{strokeDasharray:"3 3"}),l(Br,{dataKey:"week",label:{value:"Week",position:"insideBottomRight",offset:0}}),l(jr,{}),l(rr,{}),l(Gt,{}),l(Ei,{type:"monotone",dataKey:"total_sales",stroke:"#22D3EE",strokeWidth:3})]})}),w==="daily"&&l(tr,{width:"100%",height:600,children:h(fs,{data:c,margin:{top:10,right:30,left:0,bottom:20},children:[l(Lr,{strokeDasharray:"3 3"}),l(Br,{dataKey:"day",label:{value:"Day",position:"insideBottomRight",offset:0}}),l(jr,{}),l(rr,{}),l(Gt,{}),l(Za,{dataKey:"total_sales",fill:"#F59E42"})]})})]})]})]})]})})]})},_N=({value:e="",onChange:t,inventory:r=[],categories:n=[],placeholder:a="Search components...",className:i="",disabled:s=!1})=>{const[o,c]=N.useState(""),[u,d]=N.useState(!1),[f,m]=N.useState(!1),[p,x]=N.useState(null),[g,y]=N.useState("all"),v=N.useRef(null),b=N.useRef(null),w=[{key:"all",name:"All",icon:null},{key:"CPU",name:"CPU",icon:Ra},{key:"Motherboard",name:"Motherboard",icon:ub},{key:"GPU",name:"GPU",icon:Is},{key:"RAM",name:"RAM",icon:lo},{key:"Storage",name:"Storage",icon:Of},{key:"PSU",name:"PSU",icon:rs},{key:"Case",name:"Case",icon:nt},{key:"Cooler",name:"Cooler",icon:Rs}];N.useEffect(()=>{if(e&&r.length>0){const I=r.find(z=>z.id.toString()===e.toString());I&&(x(I),c(I.name))}},[e,r]);const k=I=>{if(!n.length)return null;const z=n.find(H=>H.id===Number(I.category_id));return z&&{CPU:"CPU","Procie Only":"CPU","Pro & Mobo - Amd":"CPU","Pro & Mobo - Intel":"CPU",Motherboard:"Motherboard",Mobo:"Motherboard",GPU:"GPU",RAM:"RAM","Ram 3200mhz":"RAM",Storage:"Storage","Ssd Nvme":"Storage",PSU:"PSU","Psu - Tr":"PSU",Case:"Case","Case Gaming":"Case",Cooler:"Cooler",Aio:"Cooler"}[z.name]||null},S=r.filter(I=>{const z=o===""||I.name.toLowerCase().includes(o.toLowerCase())||I.brand&&I.brand.toLowerCase().includes(o.toLowerCase()),X=g==="all"||k(I)===g;return z&&X}).slice(0,20),_=S.reduce((I,z)=>{const X=k(z)||"Other";return I[X]||(I[X]=[]),I[X].push(z),I},{}),C=I=>{const z=I.target.value;c(z),d(z.length>0),p&&z!==p.name&&(x(null),t(""))},E=I=>{x(I),c(I.name),d(!1),m(!1),t(I.id.toString())},A=()=>{var I;x(null),c(""),d(!1),m(!1),t(""),(I=v.current)==null||I.focus()},T=I=>{setTimeout(()=>{var z;(z=b.current)!=null&&z.contains(I.relatedTarget)||d(!1)},150)},D=I=>{var z;I.key==="Escape"&&(d(!1),m(!1),(z=v.current)==null||z.blur())};return h("div",{className:`relative ${i}`,children:[h("div",{className:"relative",children:[l(Di,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),l("input",{ref:v,type:"text",value:o,onChange:C,onFocus:()=>{d(!0),m(!1)},onBlur:T,onKeyDown:D,placeholder:a,disabled:s,className:`w-full pl-10 pr-10 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent ${s?"bg-gray-50 cursor-not-allowed":"bg-white"}`}),l("button",{type:"button",onClick:()=>{m(!f),d(!1)},disabled:s,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:l(Pf,{className:"w-4 h-4"})}),p&&!s&&l("button",{type:"button",onClick:A,className:"absolute right-8 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:l(Yr,{className:"w-4 h-4"})})]}),l("div",{className:"mb-4",children:l("div",{className:"flex flex-wrap gap-2",children:w.map(I=>{const z=I.icon;return h("button",{type:"button",onClick:()=>y(I.key),disabled:s,className:`flex items-center gap-2 px-4 py-2 text-sm rounded-lg border transition-colors ${g===I.key?"bg-blue-100 text-blue-700 border-blue-300 shadow-sm":"bg-gray-100 text-gray-600 border-gray-300 hover:bg-gray-200 hover:shadow-sm"} ${s?"cursor-not-allowed opacity-50":"cursor-pointer"}`,children:[z&&l(z,{className:"w-4 h-4"}),I.name]},I.key)})})}),(u||f)&&!s&&h("div",{ref:b,className:"absolute z-[9999] w-full mt-2 bg-white border border-gray-300 rounded-lg shadow-2xl max-h-[32rem] overflow-y-auto",style:{maxHeight:"32rem",minHeight:"12rem"},children:[l("div",{onClick:()=>{x(null),c(""),t(""),d(!1),m(!1)},className:"px-6 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 text-gray-500 font-medium",children:"Select Component"}),Object.entries(_).map(([I,z])=>{const X=w.find(L=>L.key===I),H=X==null?void 0:X.icon;return h("div",{children:[h("div",{className:"px-6 py-3 bg-gray-50 border-b border-gray-200 flex items-center gap-3 text-sm font-semibold text-gray-700",children:[H&&l(H,{className:"w-5 h-5"}),I," (",z.length,")"]}),z.map(L=>h("div",{onClick:()=>E(L),className:"px-6 py-4 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0 flex items-center justify-between transition-colors",children:[h("div",{className:"flex-1",children:[l("div",{className:"font-medium text-gray-900 text-base",children:L.name}),L.brand&&l("div",{className:"text-sm text-gray-500 mt-1",children:L.brand}),L.price&&h("div",{className:"text-sm text-green-600 font-semibold mt-1",children:["â‚±",L.price.toLocaleString()]})]}),p&&p.id===L.id&&l(sb,{className:"w-5 h-5 text-green-500 flex-shrink-0"})]},L.id))]},I)}),S.length===0&&h("div",{className:"px-6 py-8 text-gray-500 text-center",children:[l("div",{className:"text-lg font-medium mb-2",children:"No components found"}),l("div",{className:"text-sm",children:"Try adjusting your search terms or category filter"})]})]})]})},Zx={Aio:"CPU Cooler (AIO)","Case Gaming":"PC Case (Gaming)",GPU:"Graphics Card (GPU)",Mobo:"Motherboard","Procie Only":"Processor (CPU)",PSU:"Power Supply (PSU)","Psu - Tr":"Power Supply (PSU, True Rated)","Ram 3200mhz":"Memory (RAM, 3200MHz)","Ssd Nvme":"Storage (SSD NVMe)",Cooler:"CPU Cooler",RAM:"Memory (RAM)",Storage:"Storage",Case:"PC Case",Motherboard:"Motherboard",CPU:"Processor (CPU)"},Lfe=()=>{const[e,t]=N.useState([]),[r,n]=N.useState(!0),[a,i]=N.useState(null);N.useEffect(()=>{s()},[]);const s=async()=>{n(!0);try{const d=await(await tt(An("view_feedback"))).json();d.success&&t(d.data)}catch(u){console.error("Error fetching feedback:",u)}finally{n(!1)}},o=u=>{switch(u){case"new":return"bg-blue-100 text-blue-800";case"in_progress":return"bg-yellow-100 text-yellow-800";case"resolved":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},c=u=>new Date(u).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return r?h("div",{className:"text-center py-12",children:[l("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),l("p",{className:"text-gray-600",children:"Loading feedback..."})]}):h("div",{className:"space-y-6",children:[h("div",{className:"flex items-center justify-between",children:[l("h2",{className:"text-2xl font-bold text-gray-900",children:"Contact Feedback"}),l("button",{onClick:s,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Refresh"})]}),e.length===0?h("div",{className:"text-center py-12",children:[l(ca,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No feedback received"}),l("p",{className:"text-gray-600",children:"Contact form submissions will appear here."})]}):l("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:l("div",{className:"overflow-x-auto",children:h("table",{className:"min-w-full divide-y divide-gray-200",children:[l("thead",{className:"bg-gray-50",children:h("tr",{children:[l("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),l("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),l("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject"}),l("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rating"}),l("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),l("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),l("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),l("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(u=>h("tr",{className:"hover:bg-gray-50",children:[l("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:u.name}),l("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:u.email}),l("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:u.subject}),l("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:u.rating>0?`${u.rating}/5`:"No rating"}),l("td",{className:"px-6 py-4 whitespace-nowrap",children:l("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${o(u.status)}`,children:u.status.replace("_"," ").toUpperCase()})}),l("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:c(u.created_at)}),l("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:l("button",{onClick:()=>i(u),className:"text-green-600 hover:text-green-900 mr-3",children:"View"})})]},u.id))})]})})}),a&&l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:h("div",{className:"p-6",children:[h("div",{className:"flex items-center justify-between mb-4",children:[l("h3",{className:"text-xl font-semibold text-gray-900",children:"Feedback Details"}),l("button",{onClick:()=>i(null),className:"text-gray-400 hover:text-gray-600",children:l(Yr,{className:"w-6 h-6"})})]}),h("div",{className:"space-y-4",children:[h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),l("p",{className:"mt-1 text-sm text-gray-900",children:a.name})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),l("p",{className:"mt-1 text-sm text-gray-900",children:a.email})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Subject"}),l("p",{className:"mt-1 text-sm text-gray-900",children:a.subject})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Rating"}),l("p",{className:"mt-1 text-sm text-gray-900",children:a.rating>0?`${a.rating}/5`:"No rating provided"})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Message"}),l("div",{className:"mt-1 p-3 bg-gray-50 rounded-lg",children:l("p",{className:"text-sm text-gray-900 whitespace-pre-wrap",children:a.message})})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Submitted"}),l("p",{className:"mt-1 text-sm text-gray-900",children:c(a.created_at)})]})]}),l("div",{className:"mt-6 flex justify-end",children:l("button",{onClick:()=>i(null),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors",children:"Close"})})]})})})]})},Xo=({initialTab:e,user:t})=>{const[r,n]=N.useState(e||"dashboard"),[a,i]=N.useState([]),[s,o]=N.useState([]);N.useState([]);const[c,u]=N.useState({}),[d,f]=N.useState(!0),[m,p]=N.useState(!0),[x,g]=N.useState(null),[y,v]=N.useState("monthly"),[b,w]=N.useState([]);N.useState([]),N.useState(!1);const[k,S]=N.useState(!1),[_,C]=N.useState(null),[E,A]=N.useState(null),[T,D]=N.useState(null),[I,z]=N.useState(90);N.useState({});const[X,H]=N.useState(null),L=async j=>{if(window.confirm("Are you sure you want to delete this order?"))try{const V=await tt(`${ke}/index.php?endpoint=orders&id=${j}`,{method:"DELETE",headers:{"Content-Type":"application/json"}}),P=await V.json();if(!V.ok||!P.success)throw new Error(P.error||"Failed to delete order");o(q=>q.filter(O=>O.id!==j)),alert("Order deleted successfully")}catch(V){console.error("Delete order error:",V),alert(`Failed to delete order: ${V.message}`)}};N.useEffect(()=>{e&&e!==r&&n(e)},[e]),N.useEffect(()=>{const j=async(P=!1)=>{P&&f(!0),g(null);try{if(!await L8()){g("Session expired. Please log in again."),P&&f(!1);return}const O=await tt(`${ke}/index.php?endpoint=dashboard&period=${I}${X?`&branch=${X}`:""}`);if(O.status===401){g("Authentication failed. Please log in again."),P&&f(!1);return}const K=await O.text();let G;try{G=JSON.parse(K)}catch(te){console.error("JSON parse error:",te),g("Server returned invalid JSON.");return}if(G.success){const te=G.data;i(te.inventory||[]),o(te.orders||[]),u(te.reports||{})}else console.error("API error:",G.error),g(G.error||"API call was not successful")}catch(q){console.error("Error fetching admin dashboard data:",q),g("Error fetching admin dashboard data.")}finally{P&&f(!1)}};j(!0);const V=setInterval(()=>{j(!1)},3e4);return()=>{clearInterval(V)}},[]),N.useEffect(()=>{(async()=>{if(!await gr()){g("Session expired. Please log in again.");return}tt(`${ke}/index.php?endpoint=dashboard&period=${I}${X?`&branch=${X}`:""}`).then(V=>V.text()).then(V=>{let P;try{P=JSON.parse(V)}catch{g("Server returned invalid JSON.");return}if(P.success){const q=P.data;i(q.inventory||[]),o(q.orders||[]),u(q.reports||{})}else g(P.error||"API call was not successful")}).catch(()=>g("Error fetching dashboard data."))})()},[I,X]),N.useEffect(()=>{(async()=>{p(!0);try{const P=await(await tt(`${ke}/index.php?endpoint=categories`)).json();P.success&&Array.isArray(P.data)?w(P.data):(console.error("Failed to load categories:",P),w([]))}catch(V){console.error("Error fetching categories:",V),w([])}finally{p(!1)}})()},[]);const W=()=>{var G,te,ce,M,Le,Te;const j=((te=(G=c==null?void 0:c.monthly_sales)==null?void 0:G[0])==null?void 0:te.total_sales)||0,V=((ce=c==null?void 0:c.deadstock)==null?void 0:ce.length)||0,P=((Le=(M=c==null?void 0:c.top_selling_products)==null?void 0:M[0])==null?void 0:Le.name)||"N/A";let q=[],O="",K=null;return y==="monthly"?(q=(c==null?void 0:c.monthly_sales)||[],O="Monthly Sales",K=q.length>0?l(tr,{width:"100%",height:200,children:h(qi,{data:q,margin:{top:10,right:20,left:0,bottom:0},children:[l(Lr,{strokeDasharray:"3 3"}),l(Br,{dataKey:"month",label:{value:"Month",position:"insideBottomRight",offset:0}}),l(jr,{}),l(rr,{}),l(Gt,{}),l(Ei,{type:"monotone",dataKey:"total_sales",stroke:"#A020F0",strokeWidth:3})]})}):l("div",{className:"h-[280px] flex items-center justify-center p-6",children:h("div",{className:"text-center max-w-md",children:[l(nt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-3",children:"No data available"}),l("p",{className:"text-gray-400 text-sm leading-relaxed",children:"This could be because there are no completed orders yet or the system is still collecting data."})]})})):y==="weekly"?(q=(c==null?void 0:c.weekly_sales)||[],O="Weekly Sales",K=q.length>0?l(tr,{width:"100%",height:200,children:h(qi,{data:q,margin:{top:10,right:20,left:0,bottom:0},children:[l(Lr,{strokeDasharray:"3 3"}),l(Br,{dataKey:"week",label:{value:"Week",position:"insideBottomRight",offset:0}}),l(jr,{}),l(rr,{}),l(Gt,{}),l(Ei,{type:"monotone",dataKey:"total_sales",stroke:"#36A2EB",strokeWidth:3})]})}):l("div",{className:"h-[280px] flex items-center justify-center p-6",children:h("div",{className:"text-center max-w-md",children:[l(nt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-3",children:"No data available"}),l("p",{className:"text-gray-400 text-sm leading-relaxed",children:"This could be because there are no completed orders yet or the system is still collecting data."})]})})):y==="daily"&&(q=(c==null?void 0:c.daily_sales)||[],O="Daily Sales (Last 30 Days)",K=q.length>0?l(tr,{width:"100%",height:200,children:h(fs,{data:q,margin:{top:10,right:20,left:0,bottom:0},children:[l(Lr,{strokeDasharray:"3 3"}),l(Br,{dataKey:"day",label:{value:"Day",position:"insideBottomRight",offset:0}}),l(jr,{}),l(rr,{}),l(Gt,{}),l(Za,{dataKey:"total_sales",fill:"#36A2EB"})]})}):l("div",{className:"h-[280px] flex items-center justify-center p-6",children:h("div",{className:"text-center max-w-md",children:[l(nt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-3",children:"No data available"}),l("p",{className:"text-gray-400 text-sm leading-relaxed",children:"This could be because there are no completed orders yet or the system is still collecting data."})]})})),h("div",{className:"space-y-6",children:[h("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[l("div",{className:"card p-6",children:h("div",{className:"flex items-center",children:[l("div",{className:"p-3 bg-green-100 rounded-lg flex items-center justify-center",children:l("span",{className:"text-2xl font-extrabold text-green-600",children:"â‚±"})}),h("div",{className:"ml-4",children:[l("p",{className:"text-sm font-medium text-gray-600",children:"Sales This Month"}),h("p",{className:"text-2xl font-bold text-gray-900",children:["â‚±",Number(j).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})}),l("div",{className:"card p-6",children:h("div",{className:"flex items-center",children:[l("div",{className:"p-3 bg-yellow-100 rounded-lg",children:l(nt,{className:"h-6 w-6 text-yellow-600"})}),h("div",{className:"ml-4",children:[l("p",{className:"text-sm font-medium text-gray-600",children:"Deadstock Items"}),h("div",{children:[l("p",{className:"text-2xl font-bold text-gray-900",children:V}),h("p",{className:"text-sm text-gray-600",children:["Total: â‚±",((Te=c==null?void 0:c.deadstock_total_value)==null?void 0:Te.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}))||"0.00"]})]})]})]})}),l("div",{className:"card p-6",children:h("div",{className:"flex items-center",children:[l("div",{className:"p-3 bg-blue-100 rounded-lg",children:l(Qc,{className:"h-6 w-6 text-blue-600"})}),h("div",{className:"ml-4",children:[l("p",{className:"text-sm font-medium text-gray-600",children:"Top Seller"}),l("p",{className:"text-base font-bold text-gray-900 break-words leading-tight",title:P,children:P})]})]})})]}),h("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4",children:[h("div",{children:[l("label",{htmlFor:"dashboard-sales-chart-type",className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Sales Chart:"}),h("select",{id:"dashboard-sales-chart-type",className:"border rounded px-4 py-2 text-base focus:ring-2 focus:ring-purple-400 focus:border-purple-400 transition",value:y,onChange:je=>v(je.target.value),children:[l("option",{value:"monthly",children:"Monthly Sales"}),l("option",{value:"weekly",children:"Weekly Sales"}),l("option",{value:"daily",children:"Daily Sales"})]})]}),l("div",{className:"flex-1 flex items-end justify-end",children:h("span",{className:"text-gray-500 text-sm italic",children:["Showing: ",l("span",{className:"font-semibold text-gray-800",children:O})]})})]}),h("div",{className:"card p-6 mb-8",children:[l("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:O}),K]}),h("div",{className:"card p-6",children:[l("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Orders"}),l("div",{className:"overflow-x-auto",children:h("table",{className:"table-ui",children:[l("thead",{children:h("tr",{children:[l("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Order ID"}),l("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Customer ID"}),l("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Total"}),l("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Status"}),l("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Date"})]})}),l("tbody",{children:s&&s.length>0?s.slice(0,5).map(je=>h("tr",{children:[h("td",{className:"px-4 py-2 whitespace-nowrap text-sm font-medium text-gray-900",children:["#",je.id]}),l("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900",children:je.user_id}),h("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900",children:["â‚±",je.total_price]}),l("td",{className:"px-4 py-2 whitespace-nowrap",children:l("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${je.status==="Completed"?"bg-green-100 text-green-800":je.status==="Processing"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:je.status})}),l("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-900",children:je.order_date})]},je.id)):l("tr",{children:l("td",{colSpan:"5",className:"text-center py-4",children:"No order data available."})})})]})})]})]})},ie=()=>{const[j,V]=N.useState(""),[P,q]=N.useState("all"),[O,K]=N.useState("all"),[G,te]=N.useState("name"),[ce,M]=N.useState(!1),[Le,Te]=N.useState(!1),je=N.useRef(null);N.useEffect(()=>{const me=Ae=>{ce&&!Ae.target.closest(".export-dropdown")&&M(!1)};return document.addEventListener("mousedown",me),()=>{document.removeEventListener("mousedown",me)}},[ce]);const ze=me=>{const Ae=QR(a,j,P,O,b,me);Ae>0?alert(`Successfully exported ${Ae} items to ${me.toUpperCase()} format.`):alert("No items match the current filters to export.")},Ce=async me=>{if(me){Te(!0);try{const Ae=await ZR(me,b);if(!Ae.success){alert(`Import failed: ${Ae.error}`),Te(!1);return}if(Ae.valid.length===0){alert("No valid items found in the file. Please check the file format."),Te(!1);return}const Ke=`Found ${Ae.total} items:
- ${Ae.valid.length} valid items
- ${Ae.invalid.length} invalid items

`+(Ae.invalid.length>0?`Invalid items:
${Ae.invalid.map((dt,Y)=>{var ve;return`  ${Y+1}. ${dt.name||"Unknown"}: ${((ve=dt.errors)==null?void 0:ve.join(", "))||"Error"}`}).join(`
`)}

`:"")+"Continue with import?";if(!confirm(Ke)){Te(!1);return}const qe=await(await tt(`${ke}/index.php?endpoint=import_components`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({components:Ae.valid})})).json();if(!qe.success){alert(`Import failed: ${qe.error||"Unknown error"}`),Te(!1);return}const xt=`Import completed!

Total: ${qe.total}
Created: ${qe.created}
Updated: ${qe.updated}
Failed: ${qe.failed}

`+(qe.errors.length>0?`Errors:
${qe.errors.map((dt,Y)=>`  ${Y+1}. ${dt.name}: ${dt.error}`).join(`
`)}`:"");alert(xt);try{const Y=await(await tt(`${ke}/index.php?endpoint=dashboard`)).json();Y.success&&Y.data&&i(Y.data.inventory||[])}catch(dt){console.error("Error refreshing inventory:",dt)}}catch(Ae){console.error("Import error:",Ae),alert(`Import failed: ${Ae.message||"Unknown error"}`)}finally{Te(!1),je.current&&(je.current.value="")}}},de=me=>{var qe;const Ae=(qe=me.target.files)==null?void 0:qe[0];if(!Ae)return;const Ke=Ae.name.split(".").pop().toLowerCase();if(!["csv","xlsx","xls"].includes(Ke)){alert(`Invalid file type: .${Ke}

Please select a CSV or Excel file (.csv, .xlsx, .xls)`),je.current&&(je.current.value="");return}Ce(Ae)},$e=[{key:"CPU",names:["CPU","Procie Only","Pro & Mobo - Amd","Pro & Mobo - Intel"]},{key:"Motherboard",names:["Motherboard","Mobo","Pro & Mobo - Amd","Pro & Mobo - Intel"]},{key:"GPU",names:["GPU"]},{key:"RAM",names:["RAM","Ram 3200mhz"]},{key:"Storage",names:["Storage","Ssd Nvme"]},{key:"PSU",names:["PSU","Psu - Tr"]},{key:"Case",names:["Case","Case Gaming"]},{key:"Cooler",names:["Cooler","Aio"]}],Re={};$e.forEach(me=>{Re[me.key]=b.filter(Ae=>me.names.includes(Ae.name)).map(Ae=>String(Ae.id))});const Fe=me=>{const Ae=b.find(Ke=>Ke.id===Number(me.category_id));if(!Ae)return null;for(const Ke of $e)if(Ke.names.includes(Ae.name))return Ke.key;return null},Me=a.filter(me=>Fe(me)),Ge=Array.from(new Set(Me.map(me=>(me.brand||"").trim()).filter(Boolean).map(me=>me.toLowerCase()))),Qe=Ge.map(me=>me.charAt(0).toUpperCase()+me.slice(1)),we=["all"];Ge.includes("amd")&&we.push("AMD"),Ge.includes("intel")&&we.push("Intel"),we.push(...Qe.filter(me=>me!=="Amd"&&me!=="Intel"));let pe=a.filter(me=>{const Ae=Fe(me);if(!Ae||P!=="all"&&Ae!==P)return!1;if(O!=="all"){if(!me.brand)return!1;if(O.toLowerCase()==="amd"||O.toLowerCase()==="intel"){if(me.brand.toLowerCase()!==O.toLowerCase())return!1}else if(me.brand.toLowerCase()!==O.toLowerCase())return!1}return!0});return j.trim()!==""&&(pe=pe.filter(me=>me.name.toLowerCase().includes(j.toLowerCase())||me.brand&&me.brand.toLowerCase().includes(j.toLowerCase()))),pe=[...pe].sort((me,Ae)=>G==="name"?me.name.localeCompare(Ae.name):G==="price"?Number(Ae.price)-Number(me.price):G==="stock"?Number(me.stock_quantity||me.stock)-Number(Ae.stock_quantity||Ae.stock):G==="category"?(Fe(me)||"").localeCompare(Fe(Ae)||""):0),h("div",{className:"space-y-6",children:[h("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l("h2",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:"Inventory"}),h("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3",children:[h("div",{className:"flex items-center gap-2",children:[l("span",{className:"text-sm text-gray-600",children:"Branch:"}),h("div",{className:"inline-flex rounded-lg border overflow-hidden",children:[l("button",{className:`px-3 py-1 text-sm ${X===null?"bg-indigo-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,onClick:()=>H(null),children:"All"}),l("button",{className:`px-3 py-1 text-sm border-l ${X==="BULACAN"?"bg-indigo-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,onClick:()=>H("BULACAN"),children:"Bulacan"}),l("button",{className:`px-3 py-1 text-sm border-l ${X==="MARIKINA"?"bg-indigo-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,onClick:()=>H("MARIKINA"),children:"Marikina"})]})]}),h("div",{className:"flex items-center gap-2",children:[h("div",{className:"relative",children:[l("input",{ref:je,type:"file",accept:".csv,.xlsx,.xls,text/csv,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel",onChange:de,className:"hidden",id:"import-file-input"}),l("label",{htmlFor:"import-file-input",children:h("button",{className:`btn btn-outline shadow flex items-center gap-2 ${Le?"opacity-50 cursor-not-allowed":""}`,disabled:Le,onClick:()=>{var me;return!Le&&((me=je.current)==null?void 0:me.click())},children:[l(WT,{className:"h-4 w-4"}),Le?"Importing...":"Import"]})})]}),h("div",{className:"relative export-dropdown",children:[h("button",{className:"btn btn-outline shadow flex items-center gap-2",onClick:()=>M(!ce),children:[l(Ss,{className:"h-4 w-4"}),"Export"]}),ce&&l("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border z-10",children:h("div",{className:"py-1",children:[h("button",{onClick:()=>{ze("csv"),M(!1)},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[l(Ss,{className:"h-4 w-4"}),"Export as CSV"]}),h("button",{onClick:()=>{ze("excel"),M(!1)},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[l(Ss,{className:"h-4 w-4"}),"Export as Excel"]})]})})]}),h("button",{className:"btn btn-primary shadow",onClick:()=>D({}),children:[l(wn,{className:"h-4 w-4"}),"Add Product"]})]})]})]}),l("div",{className:"mb-2",children:h("div",{className:"flex flex-col gap-3",children:[l("div",{className:"w-full",children:l("input",{type:"text",placeholder:"Search by name or brand...",value:j,onChange:me=>V(me.target.value),className:"px-4 py-2 border rounded-lg w-full",style:{minHeight:"42px"}})}),h("div",{className:"flex flex-col sm:flex-row gap-2",children:[h("select",{value:P,onChange:me=>q(me.target.value),className:"px-4 py-2 border rounded-lg flex-1",style:{minHeight:"42px"},children:[l("option",{value:"all",children:"All Components"}),$e.map(me=>l("option",{value:me.key,children:me.key},me.key))]}),h("select",{value:O,onChange:me=>K(me.target.value),className:"px-4 py-2 border rounded-lg flex-1",style:{minHeight:"42px"},children:[l("option",{value:"all",children:"All Brands"}),we.filter(me=>me!=="all").map(me=>l("option",{value:me,children:me},me))]})]}),l("div",{className:"flex flex-col sm:flex-row gap-2",children:h("select",{value:G,onChange:me=>te(me.target.value),className:"px-4 py-2 border rounded-lg w-full sm:w-48",style:{minHeight:"42px"},children:[l("option",{value:"name",children:"Sort by Name"}),l("option",{value:"price",children:"Sort by Price"}),l("option",{value:"stock",children:"Sort by Stock"}),l("option",{value:"category",children:"Sort by Category"})]})})]})}),l("div",{className:"bg-white rounded-2xl shadow-lg border overflow-x-auto",children:h("table",{className:"min-w-full table-fixed divide-y divide-gray-200",children:[l("thead",{className:"bg-gray-50",children:h("tr",{children:[l("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Product"}),l("th",{className:"px-2 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Category"}),l("th",{className:"px-2 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Stock"}),l("th",{className:"px-2 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Price"}),l("th",{className:"px-2 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Status"}),l("th",{className:"px-2 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),l("tbody",{className:"bg-white divide-y divide-gray-200",children:pe&&pe.length>0?pe.map(me=>{const Ae=b.find(qe=>String(qe.id)===String(me.category_id)),Ke=Ae?Zx[Ae.name]||Ae.name:me.category_id,He=me.image_url&&me.image_url.trim()!==""?me.image_url:xr(me.name);return h("tr",{className:"hover:shadow-2xl",children:[l("td",{className:"px-4 py-4 whitespace-nowrap align-middle",children:h("div",{className:"flex items-center gap-3 max-w-md",style:{maxWidth:"320px"},title:me.name,children:[l("img",{src:He,alt:me.name,className:"w-12 h-12 object-contain rounded border cursor-pointer hover:shadow-lg transition duration-150",onClick:()=>A(me),onError:qe=>{qe.target.onerror=null;const xt=xr(me.name);xt!==He?qe.target.src=xt:qe.target.src="/images/components/default.png"}}),l("span",{className:"text-sm font-medium text-gray-900 break-words truncate",children:me.name})]})}),l("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-900 truncate max-w-xs",title:Ke,children:Ke}),l("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-900",children:me.stock_quantity??me.stock}),h("td",{className:"px-2 py-4 whitespace-nowrap text-sm text-gray-900",children:["â‚±",me.price]}),l("td",{className:"px-2 py-4 whitespace-nowrap",children:(()=>{const qe=me.stock_quantity??me.stock,xt=Number(me.price);return qe===0?l("span",{className:"chip chip-red",children:"Out of Stock"}):xt===0?l("span",{className:"chip chip-gray",children:"No Price"}):qe>0&&qe<=5?l("span",{className:"chip chip-yellow",children:"Low Stock"}):l("span",{className:"chip chip-green",children:"In Stock"})})()}),h("td",{className:"px-2 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[l("button",{className:"text-blue-600 hover:text-blue-900",onClick:()=>D(me),title:"Edit",children:l(Oi,{className:"h-4 w-4"})}),(()=>{const qe=Array.isArray(t==null?void 0:t.roles)?t.roles:typeof(t==null?void 0:t.roles)=="string"?t.roles.split(",").map(xt=>xt.trim()).filter(xt=>xt.length>0):[];return qe.includes("Super Admin")||qe.includes("Admin")})()&&l("button",{className:"text-red-600 hover:text-red-900",onClick:async()=>{if(window.confirm(`Delete '${me.name}'?`))try{const xt=await(await tt(`${ke}/index.php?endpoint=delete_component&id=${encodeURIComponent(me.id)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:me.id})})).json();xt.success?(i(dt=>dt.filter(Y=>Y.id!==me.id)),A(null),alert("Deleted successfully")):alert(xt.error||"Failed to delete item")}catch(qe){console.error(qe),alert("Error deleting item")}},title:"Delete",children:l(Hr,{className:"h-4 w-4"})})]})]},me.id)}):l("tr",{children:l("td",{colSpan:"7",className:"text-center py-4",children:"No inventory data available."})})})]})}),E&&l("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:()=>A(null),children:h("div",{className:"bg-white rounded-2xl shadow-2xl p-0 relative w-full max-w-4xl flex flex-col md:flex-row items-stretch",onClick:me=>me.stopPropagation(),children:[h("button",{className:"absolute top-4 right-4 bg-gray-100 hover:bg-red-100 text-gray-500 hover:text-red-600 rounded-full p-3 transition-colors shadow text-2xl",onClick:()=>A(null),"aria-label":"Close modal",children:[l("span",{className:"sr-only",children:"Close"}),"Ã—"]}),l("div",{className:"flex-shrink-0 flex items-center justify-center bg-gray-50 rounded-l-2xl md:rounded-l-2xl md:rounded-r-none p-10 md:w-1/2 w-full border-b md:border-b-0 md:border-r",children:l("div",{className:"flex items-center justify-center w-full max-w-[500px] max-h-[400px] bg-white rounded border overflow-hidden",children:l("img",{src:E.image_url||xr(E.name),alt:E.name,className:"max-w-full max-h-[400px] object-contain",onError:me=>{me.target.onerror=null,me.target.src=xr(E.name)}})})}),h("div",{className:"flex-1 flex flex-col justify-center p-10 md:w-1/2 w-full",children:[l("div",{className:"text-3xl font-extrabold text-gray-900 mb-4 text-center md:text-left",children:E.name}),h("div",{className:"mb-6 flex flex-wrap gap-3 justify-center md:justify-start",children:[h("span",{className:"inline-block bg-gray-100 text-gray-700 rounded px-3 py-1 text-base font-semibold",children:["ID: ",E.id]}),l("span",{className:"inline-block bg-blue-100 text-blue-700 rounded px-3 py-1 text-base font-semibold",children:(()=>{const me=b.find(Ae=>String(Ae.id)===String(E.category_id));return me?Zx[me.name]||me.name:E.category_id})()}),h("span",{className:"inline-block bg-green-100 text-green-700 rounded px-3 py-1 text-base font-semibold",children:["Brand: ",E.brand||"-"]})]}),h("div",{className:"grid grid-cols-2 gap-x-6 gap-y-4 text-lg text-gray-700 mb-6",children:[h("div",{className:"flex items-center font-semibold",children:[l("span",{className:"mr-2 text-blue-600 text-2xl font-bold align-middle",children:"â‚±"}),"Price:"]}),h("div",{className:"font-bold text-green-700 text-xl",children:["â‚±",E.price]}),h("div",{className:"flex items-center font-semibold",children:[l("span",{className:"mr-2",children:h("svg",{className:"w-5 h-5 text-yellow-500 inline",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[l("circle",{cx:"12",cy:"12",r:"10"}),l("path",{d:"M12 8v4l3 3"})]})}),"Stock:"]}),l("div",{className:"text-lg",children:E.stock_quantity??E.stock})]}),E.specs&&typeof E.specs=="object"&&Object.keys(E.specs).length>0&&h("div",{className:"mb-2",children:[l("div",{className:"font-semibold text-gray-800 mb-2 text-lg",children:"Specs:"}),l("ul",{className:"list-disc list-inside text-base text-gray-600",children:Object.entries(E.specs).map(([me,Ae])=>h("li",{children:[h("span",{className:"font-medium capitalize",children:[me.replace(/_/g," "),":"]})," ",String(Ae)]},me))})]})]})]})}),T!==null&&l("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:()=>D(null),children:h("div",{className:"bg-white rounded-2xl shadow-lg p-6 max-w-2xl w-full relative",onClick:me=>me.stopPropagation(),children:[l("button",{className:"absolute top-4 right-4 text-gray-500 hover:text-gray-800",onClick:()=>D(null),children:"Ã—"}),l("h3",{className:"text-xl font-bold mb-4",children:T.id?"Edit Product":"Add Product"}),l(jfe,{item:T,categories:b,onCancel:()=>D(null),onSave:me=>{me&&i(Ae=>T.id?Ae.map(Ke=>Ke.id===me.id?me:Ke):[me,...Ae]),D(null)}})]})})]})},B=()=>h("div",{className:"page-container space-y-6",children:[h("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l("h2",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:"Orders"}),h("button",{className:"btn btn-primary shadow",onClick:()=>{C(null),S(!0)},children:[l(wn,{className:"h-4 w-4"}),"Add Order"]})]}),l("div",{className:"card overflow-x-auto",children:h("table",{className:"table-ui",children:[l("thead",{children:h("tr",{children:[l("th",{children:"Order ID"}),l("th",{children:"Customer"}),l("th",{children:"Total"}),l("th",{children:"Status"}),l("th",{children:"Date"}),l("th",{children:"Actions"})]})}),l("tbody",{children:s&&s.length>0?s.map(j=>h("tr",{children:[h("td",{className:"text-sm font-semibold text-gray-900",children:["#",j.id]}),l("td",{className:"text-sm text-gray-900",children:j.user_id}),h("td",{className:"text-sm text-gray-900",children:["â‚±",j.total_price]}),l("td",{children:l("span",{className:`chip ${j.status==="Completed"?"chip-green":j.status==="Processing"?"chip-yellow":"chip-gray"}`,children:j.status})}),l("td",{className:"text-sm text-gray-900",children:j.order_date}),h("td",{className:"text-sm font-medium space-x-2",children:[l("button",{className:"btn btn-outline btn-icon",onClick:()=>{C(j),S(!0)},title:"Edit Order",children:l(Oi,{className:"h-4 w-4"})}),l("button",{className:"btn btn-outline btn-icon text-red-600 border-red-200 hover:bg-red-50",onClick:()=>L(j.id),title:"Delete Order",children:l(Hr,{className:"h-4 w-4"})})]})]},j.id)):l("tr",{children:l("td",{colSpan:"6",className:"empty-state",children:"No order data available."})})})]})}),k&&l("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-6",onClick:()=>{S(!1),C(null)},children:h("div",{className:"bg-white rounded-3xl shadow-2xl p-8 max-w-6xl w-full max-h-[95vh] overflow-y-auto relative modal-scrollbar",onClick:j=>j.stopPropagation(),children:[l("button",{className:"absolute top-6 right-6 text-gray-500 hover:text-gray-800 z-10 text-2xl font-bold",onClick:()=>{S(!1),C(null)},children:"Ã—"}),l("h3",{className:"text-2xl font-bold mb-6 text-gray-800",children:_?"Edit Order":"Create Order"}),l(Bfe,{user:t,inventory:a,categories:b,editingOrder:_,onCancel:()=>{S(!1),C(null)},onCreated:()=>{S(!1),C(null),tt(`${ke}/index.php?endpoint=orders`).then(j=>j.json()).then(j=>{j&&j.success&&o(j.data||[])}).catch(()=>{})}})]})})]}),ee=()=>l(w3,{inventory:a,categories:b,user:t}),le=()=>l(kN,{user:t});return l("div",{className:"p-4 sm:p-6 lg:p-8",children:d||m?l("div",{className:"text-center py-12",children:l("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto"})}):x?l("div",{className:"text-center text-red-600 py-8",children:x}):(()=>{switch(r){case"dashboard":return l(W,{});case"inventory":return t.can_access_inventory===0||t.can_access_inventory==="0"||t.can_access_inventory===!1||t.can_access_inventory==="false"?h("div",{className:"bg-yellow-100 border border-yellow-300 text-yellow-800 px-6 py-4 rounded-2xl text-center max-w-lg mx-auto mt-24",children:[l("h2",{className:"text-2xl font-bold mb-2",children:"Inventory Access Disabled"}),l("p",{className:"text-lg",children:"Your access to Inventory Management has been disabled by a Super Admin. If you believe this is a mistake, please contact your administrator."})]}):l(ie,{});case"orders":case"orders-management":return t.can_access_orders===0||t.can_access_orders==="0"||t.can_access_orders===!1||t.can_access_orders==="false"?h("div",{className:"bg-yellow-100 border border-yellow-300 text-yellow-800 px-6 py-4 rounded-2xl text-center max-w-lg mx-auto mt-24",children:[l("h2",{className:"text-2xl font-bold mb-2",children:"Orders Access Disabled"}),l("p",{className:"text-lg",children:"Your access to Orders Management has been disabled by a Super Admin. If you believe this is a mistake, please contact your administrator."})]}):l(B,{});case"feedback":return l(Lfe,{});case"pc-assembly":return l(ee,{});case"prebuilt-management":return l(le,{});case"sales-reports":return l(eF,{reports:c,orders:s});case"notifications":return l(rm,{user:t});case"system-reports":return l(SN,{reports:c,inventory:a,categories:b,formalCategoryNames:Zx,isLoading:d||m});default:return l(W,{})}})()})};function Bfe({user:e,inventory:t=[],categories:r=[],editingOrder:n=null,onCancel:a=()=>{},onCreated:i=()=>{}}){const[s,o]=ft.useState([{component_id:"",quantity:1}]),[c,u]=ft.useState("pending"),[d,f]=ft.useState(!1),[m,p]=ft.useState(""),[x,g]=ft.useState(""),[y,v]=ft.useState(""),[b,w]=ft.useState(""),k=()=>o(E=>[...E,{component_id:"",quantity:1}]),S=(E,A)=>o(T=>T.map((D,I)=>I===E?{...D,...A}:D)),_=E=>o(A=>A.filter((T,D)=>D!==E));return ft.useEffect(()=>{if(n){if(u(n.status||"pending"),p(n.notes||""),g(n.purchase_date||""),v(n.customer_name||""),w(n.customer_phone||""),!n.id){console.error("Cannot fetch order details: order ID is missing",n),alert("Error: Order ID is missing. Cannot load order details."),o([{component_id:"",quantity:1}]);return}(async()=>{try{const A=`${ke}/index.php?endpoint=orders&id=${n.id}`;console.log("Fetching order details from:",A);const T=await tt(A);if(!T.ok){const I=await T.text();let z;try{z=JSON.parse(I)}catch{z={error:I||`HTTP ${T.status}`}}console.error("Failed to fetch order details:",T.status,z),alert(`Failed to load order details: ${z.error||`HTTP ${T.status}`}`),o([{component_id:"",quantity:1}]);return}const D=await T.json();if(D.success&&D.data){if(D.data.items&&Array.isArray(D.data.items)&&D.data.items.length>0){const I=D.data.items.map(z=>({component_id:z.component_id?z.component_id.toString():"",quantity:z.quantity||1}));o(I)}else console.warn("Order found but has no items"),o([{component_id:"",quantity:1}]);v(D.data.customer_name||""),w(D.data.customer_phone||"")}else console.error("API returned unsuccessful response:",D),alert(`Failed to load order: ${D.error||"Unknown error"}`),o([{component_id:"",quantity:1}])}catch(A){console.error("Error fetching order details:",A),alert(`Error loading order details: ${A.message||"Network error"}`),o([{component_id:"",quantity:1}])}})()}else o([{component_id:"",quantity:1}]),u("pending"),p(""),g("")},[n]),h("form",{onSubmit:async E=>{if(E.preventDefault(),!Array.isArray(s)||s.length===0)return;if(s.filter(D=>!D.component_id||D.component_id==="").length>0){alert('Please select a component for all items or remove empty slots using the "Remove" button.');return}if(!x){alert("Please select a purchase date.");return}if(b&&!/^63\d{10}$/.test(String(b).replace(/[^\d]/g,""))){alert("Customer phone must start with 63 followed by 10 digits.");return}const T=s.filter(D=>D.component_id&&Number(D.quantity)>0).map(D=>({component_id:Number(D.component_id),quantity:Number(D.quantity)}));if(T.length!==0){f(!0);try{const D=!!n,I=D?`${ke}/index.php?endpoint=orders&id=${n.id}`:`${ke}/index.php?endpoint=orders`,X=await tt(I,{method:D?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:T,status:c,notes:m?String(m).toUpperCase():void 0,purchase_date:x,customer_name:y||void 0,customer_phone:b||void 0})}),H=await X.json().catch(()=>({}));!X.ok||!H.success?alert(H.error||`Failed to ${D?"update":"create"} order`):i(H.order_id||(n==null?void 0:n.id))}catch(D){console.error(D),alert(`Network error ${n?"updating":"creating"} order`)}finally{f(!1)}}},className:"space-y-8",children:[h("div",{className:"bg-gray-50 rounded-2xl p-6",children:[l("h4",{className:"text-lg font-semibold text-gray-800 mb-6",children:"Component Selection"}),h("div",{className:"space-y-6",children:[s.map((E,A)=>l("div",{className:`bg-white rounded-xl p-6 shadow-sm border-2 ${!E.component_id||E.component_id===""?"border-red-200 bg-red-50":"border-gray-200"}`,children:h("div",{className:"grid grid-cols-12 gap-4 items-end",children:[h("div",{className:"col-span-7",children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Component"}),l(_N,{value:E.component_id,onChange:T=>S(A,{component_id:T}),inventory:t,categories:r,placeholder:"Search components...",className:`w-full ${!E.component_id||E.component_id===""?"border-red-300":""}`}),(!E.component_id||E.component_id==="")&&l("p",{className:"text-red-600 text-sm mt-2 font-medium",children:"Please select a component or remove this item"})]}),h("div",{className:"col-span-3",children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Quantity"}),l("input",{type:"number",min:1,className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors",value:E.quantity,onChange:T=>S(A,{quantity:T.target.value})})]}),l("div",{className:"col-span-2 flex justify-end",children:l("button",{type:"button",className:"text-red-600 hover:text-red-800 font-semibold text-sm py-3 px-4 border-2 border-red-300 rounded-lg hover:bg-red-50 transition-colors whitespace-nowrap",onClick:()=>_(A),children:"Remove"})})]})},A)),h("button",{type:"button",className:"w-full text-green-600 hover:text-green-800 font-semibold flex items-center justify-center gap-3 py-4 px-6 border-2 border-dashed border-green-300 rounded-xl hover:bg-green-50 transition-colors",onClick:k,children:[l(wn,{className:"h-5 w-5"}),"Add Another Component"]})]})]}),h("div",{className:"bg-gray-50 rounded-2xl p-6",children:[l("h4",{className:"text-lg font-semibold text-gray-800 mb-6",children:"Order Details"}),h("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[h("div",{children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Status"}),h("select",{className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors",value:c,onChange:E=>u(E.target.value),children:[l("option",{value:"Pending",children:"Pending"}),l("option",{value:"Processing",children:"Processing"}),l("option",{value:"Completed",children:"Completed"}),l("option",{value:"Cancelled",children:"Cancelled"})]})]}),h("div",{children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Purchase Date *"}),l("input",{type:"date",className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors",value:x,onChange:E=>g(E.target.value),required:!0})]}),h("div",{children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Notes (COMMENTS)"}),l("input",{className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors",value:m,onChange:E=>p(E.target.value),placeholder:"OPTIONAL"})]})]}),h("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6",children:[h("div",{children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Customer Full Name"}),l("input",{className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors",value:y,onChange:E=>v(E.target.value),placeholder:"Juan Dela Cruz"})]}),h("div",{children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Customer Contact Number"}),l("input",{className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors",value:b,onChange:E=>w(E.target.value),placeholder:"639XXXXXXXXX"}),l("p",{className:"text-xs text-gray-500 mt-1",children:"PH format: 63 + 10 digits"})]})]})]}),h("div",{className:"flex justify-end gap-4 pt-6 border-t-2 border-gray-200",children:[l("button",{type:"button",onClick:a,className:"px-8 py-3 border-2 border-gray-300 rounded-xl hover:bg-gray-50 transition-colors font-semibold text-gray-700",children:"Cancel"}),l("button",{type:"submit",className:"px-8 py-3 bg-green-600 text-white rounded-xl hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-semibold text-lg",disabled:d,children:d?n?"Updating...":"Creating...":n?"Update Order":"Create Order"})]})]})}function jfe({item:e={},categories:t=[],onCancel:r=()=>{},onSave:n=()=>{}}){const[a,i]=ft.useState({id:e.id||null,name:e.name||"",brand:e.brand||"",price:e.price||0,stock_quantity:e.stock_quantity??e.stock??0,category_id:e.category_id||t[0]&&t[0].id||"",image_url:e.image_url||""}),[s,o]=ft.useState(!1),[c,u]=ft.useState({BULACAN:"",MARIKINA:""}),[d,f]=ft.useState(!1),m=ft.useRef(null),[p,x]=ft.useState(null),[g,y]=ft.useState(null),v=(k,S)=>{k==="image_url"&&y(null),i(_=>({..._,[k]:S}))},b=async k=>{const S=k.target.files&&k.target.files[0];if(!S)return;if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(S.type)){y("Invalid file type. Please select a JPEG, PNG, GIF, or WebP image.");return}const C=5*1024*1024;if(S.size>C){y("File too large. Maximum size is 5MB.");return}y(null);try{const E=new FileReader;E.onload=A=>{const T=A.target.result;v("image_url",T);const D=new Image;D.onload=()=>{x({sizeBytes:S.size,width:D.naturalWidth,height:D.naturalHeight})},D.onerror=()=>{x({sizeBytes:S.size,width:null,height:null})},D.src=T},E.onerror=()=>{y("Error reading file. Please try again.")},E.readAsDataURL(S)}catch(E){console.error("File conversion error:",E),y("Error processing file. Please try again.")}};return ft.useEffect(()=>{(async()=>{if(a.id){f(!0);try{const S=await tt(`${ke}/index.php?endpoint=component_stock&component_id=${a.id}`),_=await S.json().catch(()=>({}));if(S.ok&&_&&_.success&&_.data&&Array.isArray(_.data.branches)){const C={BULACAN:"",MARIKINA:""};_.data.branches.forEach(E=>{String(E.code).toUpperCase()==="BULACAN"&&(C.BULACAN=String(E.stock_quantity??"")),String(E.code).toUpperCase()==="MARIKINA"&&(C.MARIKINA=String(E.stock_quantity??""))}),u(C)}}catch{}f(!1)}})()},[a.id]),h("form",{onSubmit:async k=>{k.preventDefault(),o(!0);try{let S=a.image_url;if(S&&S.startsWith("blob:"))try{const ie=await(await fetch(S)).blob();S=await new Promise((B,ee)=>{const le=new FileReader;le.onload=()=>B(le.result),le.onerror=ee,le.readAsDataURL(ie)})}catch{console.warn("Could not convert blob URL, clearing image"),S=null}const _=a.id?"update_component":"create_component",C={...a,image_url:S},A=await(await tt(`${ke}/index.php?endpoint=${_}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)})).json();if(!A.success){alert(A.error||"Save failed"),o(!1);return}let T=A.data||{...a,id:a.id||A.data&&A.data.id};const D=T.id||a.id,I=W=>W===""||W===null||W===void 0?null:parseInt(W,10),z=I(c.BULACAN),X=I(c.MARIKINA),H={"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},L=[];if(D&&(z!==null&&!Number.isNaN(z)&&L.push(fetch(`${ke}/update_component_stock.php`,{method:"POST",headers:H,body:JSON.stringify({component_id:D,branch:"BULACAN",stock_quantity:z})})),X!==null&&!Number.isNaN(X)&&L.push(fetch(`${ke}/update_component_stock.php`,{method:"POST",headers:H,body:JSON.stringify({component_id:D,branch:"MARIKINA",stock_quantity:X})}))),L.length){await Promise.allSettled(L);const W=(Number.isFinite(z)?z:0)+(Number.isFinite(X)?X:0);T={...T,stock_quantity:W}}n(T)}catch(S){console.error(S),alert("Error saving item")}finally{o(!1)}},className:"space-y-4",children:[h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),l("input",{required:!0,value:a.name,onChange:k=>v("name",k.target.value),className:"mt-1 block w-full border rounded px-3 py-2"})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Brand"}),l("input",{value:a.brand,onChange:k=>v("brand",k.target.value),className:"mt-1 block w-full border rounded px-3 py-2"})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Image"}),h("div",{className:"flex items-center gap-3",children:[l("input",{type:"text",placeholder:"Image URL (optional)",value:a.image_url&&!a.image_url.startsWith("data:")?a.image_url:"",onChange:k=>v("image_url",k.target.value),className:"mt-1 block w-full border rounded px-3 py-2"}),l("input",{ref:m,type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif,image/webp",onChange:b,className:"mt-1"})]}),g&&l("div",{className:"mt-2 text-xs text-red-600",children:g}),l("div",{className:"mt-2",children:a.image_url?h("div",{className:"flex items-center gap-3",children:[l("img",{src:a.image_url,alt:"Preview",className:"w-20 h-20 object-contain border rounded",onError:k=>{k.currentTarget.style.display="none"}}),p&&h("span",{className:"text-xs text-gray-600",children:[p.width&&p.height?`${p.width}Ã—${p.height} px, `:"",(p.sizeBytes/1024).toFixed(1)," KB"]})]}):l("span",{className:"text-xs text-gray-500",children:"Optional: provide a URL or pick a file"})})]}),h("div",{className:"grid grid-cols-2 gap-4",children:[h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Price"}),l("input",{type:"number",step:"0.01",value:a.price,onChange:k=>v("price",k.target.value),className:"mt-1 block w-full border rounded px-3 py-2"})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Stock Quantity"}),l("input",{type:"number",value:a.stock_quantity,onChange:k=>v("stock_quantity",k.target.value),className:"mt-1 block w-full border rounded px-3 py-2"})]})]}),a.id&&h("div",{className:"grid grid-cols-2 gap-4",children:[h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Bulacan Stock"}),l("input",{type:"number",value:c.BULACAN,onChange:k=>u(S=>({...S,BULACAN:k.target.value})),className:"mt-1 block w-full border rounded px-3 py-2",disabled:d})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Marikina Stock"}),l("input",{type:"number",value:c.MARIKINA,onChange:k=>u(S=>({...S,MARIKINA:k.target.value})),className:"mt-1 block w-full border rounded px-3 py-2",disabled:d})]})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Category"}),l("select",{value:a.category_id,onChange:k=>v("category_id",k.target.value),className:"mt-1 block w-full border rounded px-3 py-2",children:t.map(k=>l("option",{value:k.id,children:k.name},k.id))})]}),h("div",{className:"flex justify-end gap-2",children:[l("button",{type:"button",onClick:r,className:"px-4 py-2 border rounded",children:"Cancel"}),l("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded",disabled:s,children:s?"Saving...":"Save"})]})]})}const Wl=({id:e,name:t,value:r,onChange:n,placeholder:a,autoComplete:i,required:s=!1,className:o="",showStrengthIndicator:c=!1,strengthScore:u=0,strengthLabel:d=""})=>{const[f,m]=N.useState(!1);N.useEffect(()=>{const x="password-input-hide-browser-icons";if(document.getElementById(x))return;const g=document.createElement("style");return g.id=x,g.textContent=`
      input.password-input-custom[type="password"]::-webkit-credentials-auto-fill-button,
      input.password-input-custom[type="password"]::-webkit-strong-password-auto-fill-button {
        display: none !important;
        visibility: hidden !important;
        pointer-events: none !important;
      }
      input.password-input-custom[type="password"]::-ms-reveal,
      input.password-input-custom[type="password"]::-ms-clear {
        display: none !important;
        visibility: hidden !important;
        width: 0 !important;
        height: 0 !important;
      }
    `,document.head.appendChild(g),()=>{}},[]);const p=()=>{m(!f)};return h("div",{children:[h("div",{className:"relative",children:[l("input",{id:e,name:t,type:f?"text":"password",autoComplete:i,required:s,className:`${o} pr-10 password-input-custom`,placeholder:a,value:r,onChange:n}),l("button",{type:"button",onClick:p,className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 focus:outline-none z-10",children:f?l(zT,{className:"h-5 w-5"}):l(hl,{className:"h-5 w-5"})})]}),c&&h(gt,{children:[l("div",{className:"mt-1 h-2 w-full bg-gray-200 rounded",children:l("div",{className:`h-2 rounded ${u>=3?"bg-green-600":u===2?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(100,u*25)}%`}})}),h("p",{className:"text-xs text-gray-600 mt-1",children:["Strength: ",d]})]})]})};function $fe({item:e={},categories:t=[],onCancel:r=()=>{},onSave:n=()=>{}}){const[a,i]=ft.useState({id:e.id||null,name:e.name||"",brand:e.brand||"",price:e.price||0,stock_quantity:e.stock_quantity??e.stock??0,category_id:e.category_id||t[0]&&t[0].id||"",image_url:e.image_url||""}),[s,o]=ft.useState(!1),c=ft.useRef(null),[u,d]=ft.useState(null),[f,m]=ft.useState(null),p=(y,v)=>{y==="image_url"&&m(null),i(b=>({...b,[y]:v}))},x=async y=>{const v=y.target.files&&y.target.files[0];if(!v)return;if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(v.type)){m("Invalid file type. Please select a JPEG, PNG, GIF, or WebP image.");return}const w=5*1024*1024;if(v.size>w){m("File too large. Maximum size is 5MB.");return}m(null);try{const k=new FileReader;k.onload=S=>{const _=S.target.result;p("image_url",_);const C=new Image;C.onload=()=>{d({sizeBytes:v.size,width:C.naturalWidth,height:C.naturalHeight})},C.onerror=()=>{d({sizeBytes:v.size,width:null,height:null})},C.src=_},k.onerror=()=>{m("Error reading file. Please try again.")},k.readAsDataURL(v)}catch(k){console.error("File conversion error:",k),m("Error processing file. Please try again.")}};return h("form",{onSubmit:async y=>{y.preventDefault(),o(!0);try{let v=a.image_url;if(v&&v.startsWith("blob:"))try{const C=await(await fetch(v)).blob();v=await new Promise((E,A)=>{const T=new FileReader;T.onload=()=>E(T.result),T.onerror=A,T.readAsDataURL(C)})}catch{console.warn("Could not convert blob URL, clearing image"),v=null}const b=a.id?"update_component":"create_component",w={...a,image_url:v},S=await(await tt(`${ke}/index.php?endpoint=${b}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)})).json();S.success?n(S.data||a):alert(S.error||"Save failed")}catch(v){console.error(v),alert("Error saving item")}finally{o(!1)}},className:"space-y-4",children:[h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),l("input",{required:!0,value:a.name,onChange:y=>p("name",y.target.value),className:"mt-1 block w-full border rounded px-3 py-2"})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Brand"}),l("input",{value:a.brand,onChange:y=>p("brand",y.target.value),className:"mt-1 block w-full border rounded px-3 py-2"})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Image"}),h("div",{className:"flex items-center gap-3",children:[l("input",{type:"text",placeholder:"Image URL (optional)",value:a.image_url&&!a.image_url.startsWith("data:")?a.image_url:"",onChange:y=>p("image_url",y.target.value),className:"mt-1 block w-full border rounded px-3 py-2"}),l("input",{ref:c,type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif,image/webp",onChange:x,className:"mt-1"})]}),f&&l("div",{className:"mt-2 text-xs text-red-600",children:f}),l("div",{className:"mt-2",children:a.image_url?h("div",{className:"flex items-center gap-3",children:[l("img",{src:a.image_url,alt:"Preview",className:"w-20 h-20 object-contain border rounded",onError:y=>{y.currentTarget.style.display="none"}}),u&&h("span",{className:"text-xs text-gray-600",children:[u.width&&u.height?`${u.width}Ã—${u.height} px, `:"",(u.sizeBytes/1024).toFixed(1)," KB"]})]}):l("span",{className:"text-xs text-gray-500",children:"Optional: provide a URL or pick a file"})})]}),h("div",{className:"grid grid-cols-2 gap-4",children:[h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Price"}),l("input",{type:"number",step:"0.01",value:a.price,onChange:y=>p("price",y.target.value),className:"mt-1 block w-full border rounded px-3 py-2"})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Stock Quantity"}),l("input",{type:"number",value:a.stock_quantity,onChange:y=>p("stock_quantity",y.target.value),className:"mt-1 block w-full border rounded px-3 py-2"})]})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Category"}),l("select",{value:a.category_id,onChange:y=>p("category_id",y.target.value),className:"mt-1 block w-full border rounded px-3 py-2",children:t.map(y=>l("option",{value:y.id,children:y.name},y.id))})]}),h("div",{className:"flex justify-end gap-2",children:[l("button",{type:"button",onClick:r,className:"px-4 py-2 border rounded",children:"Cancel"}),l("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded",disabled:s,children:s?"Saving...":"Save"})]})]})}const Ufe=({inventory:e,categories:t,user:r,setInventory:n,branch:a,setBranch:i})=>{const[s,o]=N.useState(""),[c,u]=N.useState("all"),[d,f]=N.useState("all"),[m,p]=N.useState("name"),[x,g]=N.useState(null),[y,v]=N.useState(null),[b,w]=N.useState(!1),[k,S]=N.useState(!1),[_,C]=N.useState("active"),[E,A]=N.useState([]),[T,D]=N.useState(!1),I=N.useRef(null);N.useEffect(()=>{const O=K=>{b&&!K.target.closest(".export-dropdown")&&w(!1)};return document.addEventListener("mousedown",O),()=>{document.removeEventListener("mousedown",O)}},[b]);const z=[{key:"CPU",names:["CPU","Procie Only","Pro & Mobo - Amd","Pro & Mobo - Intel"]},{key:"Motherboard",names:["Motherboard","Mobo","Pro & Mobo - Amd","Pro & Mobo - Intel"]},{key:"GPU",names:["GPU"]},{key:"RAM",names:["RAM","Ram 3200mhz"]},{key:"Storage",names:["Storage","Ssd Nvme"]},{key:"PSU",names:["PSU","Psu - Tr"]},{key:"Case",names:["Case","Case Gaming"]},{key:"Cooler",names:["Cooler","Aio"]}],X={};z.forEach(O=>{X[O.key]=t.filter(K=>O.names.includes(K.name)).map(K=>String(K.id))});const H=O=>{const K=t.find(G=>G.id===Number(O.category_id));if(!K)return null;for(const G of z)if(G.names.includes(K.name))return G.key;return null},L=e.filter(O=>H(O)),W=Array.from(new Set(L.map(O=>(O.brand||"").trim()).filter(Boolean).map(O=>O.toLowerCase()))),ie=W.map(O=>O.charAt(0).toUpperCase()+O.slice(1)),B=["all"];W.includes("amd")&&B.push("AMD"),W.includes("intel")&&B.push("Intel"),B.push(...ie.filter(O=>O!=="Amd"&&O!=="Intel"));let ee=e.filter(O=>{const K=H(O);if(!K||c!=="all"&&K!==c)return!1;if(d!=="all"){if(!O.brand)return!1;if(d.toLowerCase()==="amd"||d.toLowerCase()==="intel"){if(O.brand.toLowerCase()!==d.toLowerCase())return!1}else if(O.brand.toLowerCase()!==d.toLowerCase())return!1}return!0});s.trim()!==""&&(ee=ee.filter(O=>O.name.toLowerCase().includes(s.toLowerCase())||O.brand&&O.brand.toLowerCase().includes(s.toLowerCase()))),ee=[...ee].sort((O,K)=>m==="name"?O.name.localeCompare(K.name):m==="price"?Number(K.price)-Number(O.price):m==="stock"?Number(O.stock_quantity||O.stock)-Number(K.stock_quantity||K.stock):m==="category"?(H(O)||"").localeCompare(H(K)||""):0);const le=O=>{const K=QR(e,s,c,d,t,O);K>0?alert(`Successfully exported ${K} items to ${O.toUpperCase()} format.`):alert("No items match the current filters to export.")},R=async O=>{if(O){S(!0);try{const K=await ZR(O,t);if(!K.success){alert(`Import failed: ${K.error}`),S(!1);return}if(K.valid.length===0){alert("No valid items found in the file. Please check the file format."),S(!1);return}const G=`Found ${K.total} items:
- ${K.valid.length} valid items
- ${K.invalid.length} invalid items

`+(K.invalid.length>0?`Invalid items:
${K.invalid.map((Le,Te)=>{var je;return`  ${Te+1}. ${Le.name||"Unknown"}: ${((je=Le.errors)==null?void 0:je.join(", "))||"Error"}`}).join(`
`)}

`:"")+"Continue with import?";if(!confirm(G)){S(!1);return}const ce=await(await tt(`${ke}/index.php?endpoint=import_components`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({components:K.valid})})).json();if(!ce.success){alert(`Import failed: ${ce.error||"Unknown error"}`),S(!1);return}const M=`Import completed!

Total: ${ce.total}
Created: ${ce.created}
Updated: ${ce.updated}
Failed: ${ce.failed}

`+(ce.errors.length>0?`Errors:
${ce.errors.map((Le,Te)=>`  ${Te+1}. ${Le.name}: ${Le.error}`).join(`
`)}`:"");alert(M);try{const Te=await(await tt(`${ke}/index.php?endpoint=dashboard`)).json();Te.success&&Te.data&&n&&n(Te.data.inventory||[])}catch(Le){console.error("Error refreshing inventory:",Le)}}catch(K){console.error("Import error:",K),alert(`Import failed: ${K.message||"Unknown error"}`)}finally{S(!1),I.current&&(I.current.value="")}}},j=O=>{var ce;const K=(ce=O.target.files)==null?void 0:ce[0];if(!K)return;const G=K.name.split(".").pop().toLowerCase();if(!["csv","xlsx","xls"].includes(G)){alert(`Invalid file type: .${G}

Please select a CSV or Excel file (.csv, .xlsx, .xls)`),I.current&&(I.current.value="");return}R(K)},V=async()=>{D(!0);try{const K=await(await tt(`${ke}/index.php?endpoint=archived_components`)).json();K.success?A(K.data||[]):(console.error("Failed to fetch archived components:",K.error),A([]))}catch(O){console.error("Error fetching archived components:",O),A([])}finally{D(!1)}};N.useEffect(()=>{_==="archive"&&V()},[_]);const P=async O=>{if(window.confirm("Are you sure you want to restore this component to the active inventory?"))try{const G=await(await tt(`${ke}/index.php?endpoint=restore_component`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:O})})).json();if(G.success){alert("Component restored successfully!"),V();try{const ce=await(await tt(`${ke}/index.php?endpoint=dashboard`)).json();ce.success&&ce.data&&n&&n(ce.data.inventory||[])}catch(te){console.error("Error refreshing inventory:",te)}C("active")}else alert(G.error||"Failed to restore component")}catch(K){console.error("Error restoring component:",K),alert("Error restoring component")}},q=E.filter(O=>{if(s.trim()!==""){const K=s.toLowerCase();return O.name.toLowerCase().includes(K)||O.brand&&O.brand.toLowerCase().includes(K)||O.category_name&&O.category_name.toLowerCase().includes(K)}return!0}).sort((O,K)=>m==="name"?O.name.localeCompare(K.name):m==="price"?Number(K.price)-Number(O.price):m==="stock"?Number(O.stock_quantity||0)-Number(K.stock_quantity||0):m==="category"?(O.category_name||"").localeCompare(K.category_name||""):m==="deleted"?new Date(K.deleted_at)-new Date(O.deleted_at):0);return h("div",{className:"page-container space-y-6",children:[h("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[h("div",{className:"flex items-center gap-4",children:[l("h2",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:"Inventory"}),h("div",{className:"flex items-center gap-2 bg-gray-100 p-1 rounded-lg",children:[l("button",{onClick:()=>C("active"),className:`px-4 py-2 rounded-md font-medium transition-colors ${_==="active"?"bg-green-600 text-white shadow":"text-gray-600 hover:text-gray-900"}`,children:"Active"}),h("button",{onClick:()=>C("archive"),className:`px-4 py-2 rounded-md font-medium transition-colors flex items-center gap-2 ${_==="archive"?"bg-gray-800 text-white shadow":"text-gray-600 hover:text-gray-900"}`,children:[l(U8,{className:"h-4 w-4"}),"Archive"]})]})]}),_==="active"&&h("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3",children:[h("div",{className:"flex items-center gap-2",children:[l("span",{className:"text-sm text-gray-600",children:"Branch:"}),h("div",{className:"inline-flex rounded-lg border overflow-hidden",children:[l("button",{className:`px-3 py-1 text-sm ${a===null?"bg-indigo-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,onClick:()=>i(null),children:"All"}),l("button",{className:`px-3 py-1 text-sm border-l ${a==="BULACAN"?"bg-indigo-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,onClick:()=>i("BULACAN"),children:"Bulacan"}),l("button",{className:`px-3 py-1 text-sm border-l ${a==="MARIKINA"?"bg-indigo-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,onClick:()=>i("MARIKINA"),children:"Marikina"})]})]}),h("div",{className:"flex items-center gap-2",children:[h("div",{className:"relative",children:[l("input",{ref:I,type:"file",accept:".csv,.xlsx,.xls,text/csv,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel",onChange:j,className:"hidden",id:"import-file-input-superadmin"}),l("label",{htmlFor:"import-file-input-superadmin",children:h("button",{className:`btn btn-outline shadow flex items-center gap-2 ${k?"opacity-50 cursor-not-allowed":""}`,disabled:k,onClick:()=>{var O;return!k&&((O=I.current)==null?void 0:O.click())},children:[l(WT,{className:"h-4 w-4"}),k?"Importing...":"Import"]})})]}),h("div",{className:"relative export-dropdown",children:[h("button",{className:"btn btn-outline shadow flex items-center gap-2",onClick:()=>w(!b),children:[l(Ss,{className:"h-4 w-4"}),"Export"]}),b&&l("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border z-10",children:h("div",{className:"py-1",children:[h("button",{onClick:()=>{le("csv"),w(!1)},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[l(Ss,{className:"h-4 w-4"}),"Export as CSV"]}),h("button",{onClick:()=>{le("excel"),w(!1)},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[l(Ss,{className:"h-4 w-4"}),"Export as Excel"]})]})})]}),h("button",{className:"btn btn-primary shadow",onClick:()=>v({}),children:[l(wn,{className:"h-4 w-4"}),"Add Product"]})]})]})]}),l("div",{className:"card",children:h("div",{className:"flex flex-col gap-3",children:[l("div",{className:"w-full",children:l("input",{type:"text",placeholder:"Search by name or brand...",value:s,onChange:O=>o(O.target.value),className:"px-4 py-2 border rounded-lg w-full",style:{minHeight:"42px"}})}),_==="active"&&l(gt,{children:h("div",{className:"flex flex-col sm:flex-row gap-2",children:[h("select",{value:c,onChange:O=>u(O.target.value),className:"px-4 py-2 border rounded-lg flex-1",style:{minHeight:"42px"},children:[l("option",{value:"all",children:"All Components"}),z.map(O=>l("option",{value:O.key,children:O.key},O.key))]}),h("select",{value:d,onChange:O=>f(O.target.value),className:"px-4 py-2 border rounded-lg flex-1",style:{minHeight:"42px"},children:[l("option",{value:"all",children:"All Brands"}),B.filter(O=>O!=="all").map(O=>l("option",{value:O,children:O},O))]})]})}),l("div",{className:"flex flex-col sm:flex-row gap-2",children:h("select",{value:m,onChange:O=>p(O.target.value),className:"px-4 py-2 border rounded-lg w-full sm:w-48",style:{minHeight:"42px"},children:[l("option",{value:"name",children:"Sort by Name"}),l("option",{value:"price",children:"Sort by Price"}),l("option",{value:"stock",children:"Sort by Stock"}),l("option",{value:"category",children:"Sort by Category"}),_==="archive"&&l("option",{value:"deleted",children:"Sort by Deleted Date"})]})})]})}),l("div",{className:"card overflow-x-auto",children:h("table",{className:"table-ui",children:[l("thead",{children:h("tr",{children:[l("th",{children:"Product"}),l("th",{children:"Category"}),l("th",{children:"Stock"}),l("th",{children:"Price"}),l("th",{children:"Status"}),_==="archive"&&l("th",{children:"Deleted At"}),l("th",{children:"Actions"})]})}),l("tbody",{children:_==="active"?ee.length>0?ee.map(O=>{const K=O.image_url&&O.image_url.trim()!==""?O.image_url:xr(O.name);return h("tr",{children:[h("td",{className:"text-sm font-medium text-gray-900 break-words max-w-xs flex items-center gap-3",style:{maxWidth:"320px"},title:O.name,children:[l("img",{src:K,alt:O.name,className:"w-12 h-12 object-contain rounded border cursor-pointer hover:shadow-lg transition duration-150",onClick:()=>g(O),onError:G=>{G.target.onerror=null;const te=xr(O.name);te!==K?G.target.src=te:G.target.src="/images/components/default.png"}}),l("span",{className:"align-middle",children:O.name})]}),l("td",{className:"text-sm text-gray-900",children:H(O)}),l("td",{className:"text-sm text-gray-900",children:O.stock_quantity??O.stock}),h("td",{className:"text-sm text-gray-900",children:["â‚±",O.price]}),l("td",{children:(()=>{const G=O.stock_quantity??O.stock,te=Number(O.price);return G===0?l("span",{className:"chip chip-red",children:"Out of Stock"}):te===0?l("span",{className:"chip chip-gray",children:"No Price"}):G>0&&G<=5?l("span",{className:"chip chip-yellow",children:"Low Stock"}):l("span",{className:"chip chip-green",children:"In Stock"})})()}),h("td",{className:"text-sm font-medium space-x-2",children:[l("button",{className:"btn btn-outline btn-icon",onClick:()=>v(O),title:"Edit",children:l(Oi,{className:"h-4 w-4"})}),l("button",{className:"btn btn-outline btn-icon text-red-600 border-red-200 hover:bg-red-50",onClick:async()=>{if(window.confirm(`Delete '${O.name}'?`))try{const te=await(await tt(`${ke}/index.php?endpoint=delete_component&id=${encodeURIComponent(O.id)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:O.id})})).json();te.success?window.location.reload():alert(te.error||"Failed to delete item")}catch(G){console.error(G),alert("Error deleting item")}},title:"Delete",children:l(Hr,{className:"h-4 w-4"})})]})]},O.id)}):l("tr",{children:l("td",{colSpan:"6",className:"empty-state",children:"No inventory data available."})}):T?l("tr",{children:h("td",{colSpan:_==="archive"?"7":"6",className:"empty-state text-center py-8",children:[l("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto mb-2"}),"Loading archived components..."]})}):q.length>0?q.map(O=>{const K=O.image_url&&O.image_url.trim()!==""?O.image_url:xr(O.name),G=O.deleted_at?new Date(O.deleted_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Unknown";return h("tr",{children:[h("td",{className:"text-sm font-medium text-gray-900 break-words max-w-xs flex items-center gap-3",style:{maxWidth:"320px"},title:O.name,children:[l("img",{src:K,alt:O.name,className:"w-12 h-12 object-contain rounded border cursor-pointer hover:shadow-lg transition duration-150",onClick:()=>g(O),onError:te=>{te.target.onerror=null;const ce=xr(O.name);ce!==K?te.target.src=ce:te.target.src="/images/components/default.png"}}),l("span",{className:"align-middle",children:O.name})]}),l("td",{className:"text-sm text-gray-900",children:O.category_name||"N/A"}),l("td",{className:"text-sm text-gray-900",children:O.stock_quantity??0}),h("td",{className:"text-sm text-gray-900",children:["â‚±",O.price]}),l("td",{children:l("span",{className:"chip chip-gray",children:"Archived"})}),_==="archive"&&l("td",{className:"text-sm text-gray-500",children:G}),l("td",{className:"text-sm font-medium space-x-2",children:l("button",{className:"btn btn-outline btn-icon text-green-600 border-green-200 hover:bg-green-50",onClick:()=>P(O.id),title:"Restore Component",children:l(rL,{className:"h-4 w-4"})})})]},O.id)}):l("tr",{children:l("td",{colSpan:_==="archive"?"7":"6",className:"empty-state",children:"No archived components found."})})})]})}),x&&l("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:()=>g(null),children:h("div",{className:"bg-white rounded-2xl shadow-2xl p-0 relative w-full max-w-4xl flex flex-col md:flex-row items-stretch",onClick:O=>O.stopPropagation(),children:[h("button",{className:"absolute top-4 right-4 bg-gray-100 hover:bg-green-100 text-gray-500 hover:text-green-600 rounded-full p-3 transition-colors shadow text-2xl",onClick:()=>g(null),"aria-label":"Close modal",children:[l("span",{className:"sr-only",children:"Close"}),"Ã—"]}),l("div",{className:"flex-shrink-0 flex items-center justify-center bg-gray-50 rounded-l-2xl md:rounded-l-2xl md:rounded-r-none p-10 md:w-1/2 w-full border-b md:border-b-0 md:border-r",children:l("div",{className:"flex items-center justify-center w-full max-w-[500px] max-h-[400px] bg-white rounded border overflow-hidden",children:l("img",{src:x.image_url||xr(x.name),alt:x.name,className:"max-w-full max-h-[400px] object-contain",onError:O=>{O.target.onerror=null,O.target.src=xr(x.name)}})})}),h("div",{className:"flex-1 flex flex-col justify-center p-10 md:w-1/2 w-full",children:[l("div",{className:"text-3xl font-extrabold text-gray-900 mb-4 text-center md:text-left",children:x.name}),h("div",{className:"mb-6 flex flex-wrap gap-3 justify-center md:justify-start",children:[h("span",{className:"inline-block bg-gray-100 text-gray-700 rounded px-3 py-1 text-base font-semibold",children:["ID: ",x.id]}),l("span",{className:"inline-block bg-blue-100 text-blue-700 rounded px-3 py-1 text-base font-semibold",children:H(x)}),h("span",{className:"inline-block bg-green-100 text-green-700 rounded px-3 py-1 text-base font-semibold",children:["Brand: ",x.brand||"-"]})]}),h("div",{className:"grid grid-cols-2 gap-x-6 gap-y-4 text-lg text-gray-700 mb-6",children:[h("div",{className:"flex items-center font-semibold",children:[l("span",{className:"mr-2 text-blue-600 text-2xl font-bold align-middle",children:"â‚±"}),"Price:"]}),h("div",{className:"font-bold text-green-700 text-xl",children:["â‚±",x.price]}),h("div",{className:"flex items-center font-semibold",children:[l("span",{className:"mr-2",children:h("svg",{className:"w-5 h-5 text-yellow-500 inline",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[l("circle",{cx:"12",cy:"12",r:"10"}),l("path",{d:"M12 8v4l3 3"})]})}),"Stock:"]}),l("div",{className:"text-lg",children:x.stock_quantity??x.stock})]}),x.specs&&typeof x.specs=="object"&&Object.keys(x.specs).length>0&&h("div",{className:"mb-2",children:[l("div",{className:"font-semibold text-gray-800 mb-2 text-lg",children:"Specs:"}),l("ul",{className:"list-disc list-inside text-xs text-gray-700 bg-green-50 rounded p-2 border border-green-100 mt-1",children:Object.entries(x.specs).map(([O,K])=>h("li",{children:[h("span",{className:"font-medium capitalize",children:[O.replace(/_/g," "),":"]})," ",String(K)]},O))})]})]})]})}),y!==null&&l("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:()=>v(null),children:h("div",{className:"bg-white rounded-2xl shadow-lg p-6 max-w-2xl w-full relative",onClick:O=>O.stopPropagation(),children:[l("button",{className:"absolute top-4 right-4 text-gray-500 hover:text-gray-800",onClick:()=>v(null),children:"Ã—"}),l("h3",{className:"text-xl font-bold mb-4",children:y.id?"Edit Product":"Add Product"}),l($fe,{item:y,categories:t,onCancel:()=>v(null),onSave:O=>{O&&window.location.reload(),v(null)}})]})})]})},zfe=({orders:e,inventory:t,categories:r=[],onRefetch:n})=>{const[a,i]=N.useState(!1),[s,o]=N.useState(null),c=async d=>{if(window.confirm("Are you sure you want to delete this order?"))try{const f=localStorage.getItem("token"),m=await fetch(`${ke}/index.php?endpoint=orders&id=${d}&action=delete`,{method:"POST",headers:{Authorization:`Bearer ${f}`,"Content-Type":"application/json"}});if(!m.ok){const p=await m.json();throw new Error(p.error||"Failed to delete order")}alert("Order deleted successfully"),n&&n()}catch(f){console.error("Delete order error:",f),alert(`Failed to delete order: ${f.message}`)}},u=d=>{o(d),i(!0)};return h("div",{className:"page-container space-y-6",children:[h("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l("h2",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:"Orders"}),h("button",{className:"btn btn-primary shadow",onClick:()=>{o(null),i(!0)},children:[l(wn,{className:"h-4 w-4"}),"Add Order"]})]}),l("div",{className:"card overflow-x-auto",children:h("table",{className:"table-ui",children:[l("thead",{children:h("tr",{children:[l("th",{children:"Order ID"}),l("th",{children:"Customer"}),l("th",{children:"Total"}),l("th",{children:"Status"}),l("th",{children:"Date"}),l("th",{children:"Actions"})]})}),l("tbody",{children:e&&e.length>0?e.map(d=>h("tr",{children:[h("td",{className:"text-sm font-semibold text-gray-900",children:["#",d.id]}),l("td",{className:"text-sm text-gray-900",children:d.user_id}),h("td",{className:"text-sm text-gray-900",children:["â‚±",d.total_price]}),l("td",{children:l("span",{className:`chip ${d.status==="Completed"?"chip-green":d.status==="Processing"?"chip-yellow":"chip-gray"}`,children:d.status})}),l("td",{className:"text-sm text-gray-900",children:d.order_date}),h("td",{className:"text-sm font-medium space-x-2",children:[l("button",{className:"btn btn-outline btn-icon",onClick:()=>u(d),title:"Edit Order",children:l(Oi,{className:"h-4 w-4"})}),l("button",{className:"btn btn-outline btn-icon text-red-600 border-red-200 hover:bg-red-50",onClick:()=>c(d.id),title:"Delete Order",children:l(Hr,{className:"h-4 w-4"})})]})]},d.id)):l("tr",{children:l("td",{colSpan:"6",className:"empty-state",children:"No order data available."})})})]})}),a&&l("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-6",onClick:()=>i(!1),children:h("div",{className:"bg-white rounded-3xl shadow-2xl p-8 max-w-6xl w-full max-h-[95vh] overflow-y-auto relative modal-scrollbar",onClick:d=>d.stopPropagation(),children:[l("button",{className:"absolute top-6 right-6 text-gray-500 hover:text-gray-800 z-10 text-2xl font-bold",onClick:()=>i(!1),children:"Ã—"}),l("h3",{className:"text-2xl font-bold mb-6 text-gray-800",children:s?"Edit Order":"Create Order"}),l(Wfe,{inventory:t,categories:r,editingOrder:s,onCancel:()=>{i(!1),o(null)},onCreated:()=>{i(!1),o(null),n&&n()}})]})})]})},Hfe=()=>{const{notifications:e,loading:t,markAsRead:r,markAllAsRead:n,deleteNotification:a,deleteAllNotifications:i,unreadCount:s}=yp(),[o,c]=N.useState("all");N.useState({});const u=e.filter(m=>o==="unread"?!m.read:o==="read"?m.read:!0),d=m=>m.type==="stock"&&(m.title==="Low Stock: Multiple Components"||m.title==="Out of Stock: Multiple Components"),f=m=>{const p={},x=m.split(`
`);let g=null;return x.forEach(y=>{const v=y.trim(),b=v.match(/^â€¢\s*(.+?)\s*\((\d+)\s*items?\):/);if(b){g=b[1].trim(),p[g]=[];return}const w=v.match(/^-\s*(.+)$/);if(w&&g){const k=w[1].trim();p[g].push(k)}}),p};return t?l("div",{className:"flex items-center justify-center h-40",children:l("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"})}):h("div",{className:"p-6 w-full",children:[h("div",{className:"flex items-center justify-between mb-6",children:[h("div",{className:"flex items-center space-x-3",children:[l("div",{className:"w-10 h-10 bg-green-600 rounded-lg flex items-center justify-center",children:l(Aa,{className:"w-6 h-6 text-white"})}),h("div",{children:[l("h1",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:"Notifications"}),h("p",{className:"text-sm text-gray-500",children:[s," unread notification",s!==1?"s":""]})]})]}),h("div",{className:"flex items-center space-x-3",children:[h("select",{value:o,onChange:m=>c(m.target.value),className:"border rounded px-3 py-2 text-sm focus:ring-2 focus:ring-purple-400 focus:border-purple-400 transition",children:[l("option",{value:"all",children:"All Notifications"}),l("option",{value:"unread",children:"Unread"}),l("option",{value:"read",children:"Read"})]}),s>0&&l("button",{onClick:n,className:"px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-md hover:bg-green-700 transition-colors",children:"Mark All as Read"}),e.length>0&&l("button",{onClick:()=>{window.confirm("Are you sure you want to delete all notifications?")&&i()},className:"px-4 py-2 bg-gray-300 text-gray-800 text-sm font-medium rounded-md hover:bg-gray-400 transition-colors",children:"Delete All"})]})]}),l("div",{className:"space-y-4",children:u.length===0?h("div",{className:"text-center py-12",children:[l(Aa,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:o==="all"?"No notifications yet":`No ${o} notifications`}),l("p",{className:"text-gray-500",children:o==="all"?"You'll see important updates here when they arrive.":`You have no ${o} notifications at the moment.`})]}):u.map(m=>{const p=d(m),x=p?f(m.message):{};return l("div",{className:`bg-white rounded-2xl shadow-lg border p-6 transition-all duration-200 hover:shadow-2xl ${m.read?"":"border-l-4 border-red-500 bg-red-50"}`,children:h("div",{className:"flex items-start space-x-4",children:[l("div",{className:"flex-shrink-0 mt-1",children:l(Aa,{className:`w-6 h-6 ${m.read?"text-gray-400":"text-red-600"}`})}),l("div",{className:"flex-1 min-w-0",children:h("div",{className:"flex items-start justify-between",children:[h("div",{className:"flex-1",children:[l("h3",{className:`text-base font-semibold mb-3 ${m.read?"text-gray-700":"text-gray-900"}`,children:m.title}),!p&&l("div",{className:"mt-3 mb-4",children:l("p",{className:"text-sm text-gray-600 leading-relaxed whitespace-pre-line",children:m.message})}),p&&Object.keys(x).length>0&&h("div",{className:"mt-4 mb-4 bg-red-50 rounded-lg p-4 border border-red-100",children:[l("div",{className:"text-sm font-semibold text-red-800 mb-3",children:"Affected Components:"}),l("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:Object.entries(x).map(([g,y])=>h("div",{className:"bg-white rounded-lg p-3 border border-red-200",children:[h("div",{className:"text-sm font-medium text-red-700 mb-2 flex items-center",children:[l("span",{className:"w-2 h-2 bg-red-500 rounded-full mr-2"}),g," (",y.length," items)"]}),l("div",{className:"space-y-1 max-h-60 overflow-y-auto",children:y.map((v,b)=>l("div",{className:"text-xs text-red-600 bg-red-50 rounded px-2 py-1 border border-red-100",children:v},b))})]},g))})]}),l("div",{className:"flex items-center mt-4 text-sm text-gray-500",children:m.timestamp&&new Date(m.timestamp).toLocaleString()})]}),h("div",{className:"flex items-center space-x-3 ml-6",children:[!m.read&&l("button",{onClick:()=>r(m.id),className:"p-2 text-gray-400 hover:text-red-600 transition-colors rounded-lg hover:bg-red-50",title:"Mark as read",children:l(sb,{className:"w-5 h-5"})}),l("button",{onClick:()=>a(m.id),className:"p-2 text-gray-400 hover:text-red-600 transition-colors rounded-lg hover:bg-red-50",title:"Delete notification",children:l(Hr,{className:"w-5 h-5"})})]})]})})]})},m.id)})})]})},ey=({initialTab:e="dashboard",user:t,setUser:r})=>{const[n,a]=N.useState(e),[i,s]=N.useState([]),[o,c]=N.useState({}),[u,d]=N.useState(!0),[f,m]=N.useState([]),[p,x]=N.useState(!1),[g,y]=N.useState({username:"",email:"",password:"",role:"employee",first_name:"",last_name:""}),[v,b]=N.useState({min_length:8,max_length:null,require_uppercase:!0,require_lowercase:!0,require_numbers:!0,require_special:!0}),[w,k]=N.useState(!1),[S,_]=N.useState(!1),[C,E]=N.useState(null),[A,T]=N.useState(""),[D,I]=N.useState(!1),[z,X]=N.useState([]),[H,L]=N.useState({}),[W,ie]=N.useState([]),[B,ee]=N.useState("monthly"),[le,R]=N.useState(null);let j=[],V="",P=null;B==="monthly"?(j=(H==null?void 0:H.monthly_sales)||[],V="Monthly Sales",P=j.length>0?l(tr,{width:"100%",height:200,children:h(qi,{data:j,margin:{top:10,right:20,left:0,bottom:0},children:[l(Lr,{strokeDasharray:"3 3"}),l(Br,{dataKey:"month",label:{value:"Month",position:"insideBottomRight",offset:0}}),l(jr,{}),l(rr,{}),l(Gt,{}),l(Ei,{type:"monotone",dataKey:"total_sales",stroke:"#A020F0",strokeWidth:3})]})}):l("div",{className:"h-[280px] flex items-center justify-center p-6",children:h("div",{className:"text-center max-w-md",children:[l(nt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-3",children:"No data available"}),l("p",{className:"text-gray-400 text-sm leading-relaxed",children:"This could be because there are no completed orders yet or the system is still collecting data."})]})})):B==="weekly"?(j=(H==null?void 0:H.weekly_sales)||[],V="Weekly Sales",P=j.length>0?l(tr,{width:"100%",height:200,children:h(qi,{data:j,margin:{top:10,right:20,left:0,bottom:0},children:[l(Lr,{strokeDasharray:"3 3"}),l(Br,{dataKey:"week",label:{value:"Week",position:"insideBottomRight",offset:0}}),l(jr,{}),l(rr,{}),l(Gt,{}),l(Ei,{type:"monotone",dataKey:"total_sales",stroke:"#36A2EB",strokeWidth:3})]})}):l("div",{className:"h-[280px] flex items-center justify-center p-6",children:h("div",{className:"text-center max-w-md",children:[l(nt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-3",children:"No data available"}),l("p",{className:"text-gray-400 text-sm leading-relaxed",children:"This could be because there are no completed orders yet or the system is still collecting data."})]})})):B==="daily"&&(j=(H==null?void 0:H.daily_sales)||[],V="Daily Sales (Last 30 Days)",P=j.length>0?l(tr,{width:"100%",height:250,children:h(fs,{data:j,margin:{top:10,right:20,left:0,bottom:0},children:[l(Lr,{strokeDasharray:"3 3"}),l(Br,{dataKey:"day",label:{value:"Day",position:"insideBottomRight",offset:0}}),l(jr,{}),l(rr,{}),l(Gt,{}),l(Za,{dataKey:"total_sales",fill:"#36A2EB"})]})}):l("div",{className:"h-[320px] flex items-center justify-center p-6",children:h("div",{className:"text-center max-w-md",children:[l(nt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-3",children:"No data available"}),l("p",{className:"text-gray-400 text-sm leading-relaxed",children:"This could be because there are no completed orders yet or the system is still collecting data."})]})})),N.useEffect(()=>{a(e)},[e]),N.useEffect(()=>{(async()=>{try{const Me=await(await fetch(`${ke}/index.php?endpoint=password_requirements`)).json();Me.success&&Me.requirements&&b(Me.requirements)}catch(Fe){console.error("Failed to fetch password requirements:",Fe)}})()},[]),N.useEffect(()=>{const Re=async(Me=!1)=>{Me&&d(!0);try{const Ge=await tt(`${ke}/index.php?endpoint=dashboard${le?`&branch=${le}`:""}`,{method:"GET"});if(!Ge.ok)throw new Error("Failed to fetch dashboard data");const Qe=await Ge.json();if(Qe.success){const we=Qe.data;s(we.users||[]),c(we.system_stats||{}),m(we.inventory||[]),X(we.orders||[]),L(we.reports||{})}else throw new Error(Qe.error||"API call was not successful")}catch(Ge){console.error("Error fetching dashboard data:",Ge)}finally{Me&&d(!1)}};Re(!0);const Fe=setInterval(()=>{Re(!1)},6e4);return()=>clearInterval(Fe)},[le]),N.useEffect(()=>{(async()=>{try{const Me=await(await tt(`${ke}/index.php?endpoint=categories`)).json();Me.success&&ie(Me.data)}catch{}})()},[]),N.useEffect(()=>{const Fe=setTimeout(async()=>{try{if(!await gr())return;const Ge=await tt(`${ke}/index.php?endpoint=profile`,{method:"GET",suppressUnauthorizedEvent:!0});if(Ge.status===401)return;const Qe=await Ge.json().catch(()=>({}));Qe.success&&Qe.user&&r&&r(Qe.user)}catch(Me){console.error("SuperAdminDashboard: Error fetching profile:",Me)}},500);return()=>clearTimeout(Fe)},[r]);const q=async({username:Re,email:Fe,password:Me,first_name:Ge,last_name:Qe,role:we})=>{var pe,me;try{const Ae=await tt(`${ke}/index.php?endpoint=register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:Re,email:Fe,password:Me,first_name:Ge,last_name:Qe,role:we,otp_code:"ADMIN_OVERRIDE"})}),Ke=await Ae.json();if(!Ae.ok||!Ke.success||!((pe=Ke.user)!=null&&pe.id)){const qe=Ke.details||Ke.error||"Registration failed";throw new Error(qe)}const He=((me=Ke.user)==null?void 0:me.roles)||[];He.includes(we)||console.warn(`Warning: User created but role assignment may have failed. Expected: ${we}, Got: ${He.join(", ")}`),alert(`âœ… User created successfully as ${we}!

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ“‹ LOGIN CREDENTIALS:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ðŸ‘¤ Username: ${Re}
ðŸ”‘ Password: ${Me}

âš ï¸ IMPORTANT:
â€¢ Use the USERNAME (not email) to login
â€¢ Copy these credentials now - you cannot retrieve them later
â€¢ Share them securely with the user

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”`)}catch(Ae){throw alert(`âŒ Failed to create user:
${Ae.message}`),Ae}},O=async()=>{k(!0);try{const Fe=await(await tt(`${ke}/index.php?endpoint=generate_password`)).json();Fe.success&&Fe.password?y(Me=>({...Me,password:Fe.password})):alert("Failed to generate password")}catch(Re){console.error("Error generating password:",Re),alert("Error generating password")}finally{k(!1)}},K=()=>{y({username:"",email:"",password:"",role:"employee",first_name:"",last_name:""}),x(!0)},G=()=>{g.password&&navigator.clipboard.writeText(g.password).then(()=>{alert("Password copied to clipboard!")}).catch(()=>{alert("Failed to copy password")})},te=async Re=>{if(Re.preventDefault(),!g.username||!g.email||!g.password||!g.first_name||!g.last_name){alert("Please complete all required fields.");return}if(!/.+@.+\..+/.test(String(g.email))){alert("Please enter a valid email address.");return}const Me=String(g.password).length,Ge=[];if(Me<v.min_length&&Ge.push(`Password must be at least ${v.min_length} characters long`),v.max_length&&Me>v.max_length&&Ge.push(`Password must be no more than ${v.max_length} characters long`),v.require_uppercase&&!/[A-Z]/.test(g.password)&&Ge.push("Password must contain at least one uppercase letter"),v.require_lowercase&&!/[a-z]/.test(g.password)&&Ge.push("Password must contain at least one lowercase letter"),v.require_numbers&&!/\d/.test(g.password)&&Ge.push("Password must contain at least one number"),v.require_special&&!/[^A-Za-z0-9]/.test(g.password)&&Ge.push("Password must contain at least one special character"),Ge.length>0){alert(Ge.join(`
`));return}const we={employee:"Employee",admin:"Admin"}[String(g.role||"").toLowerCase()]||"Employee";await q({username:g.username,email:g.email,password:g.password,first_name:g.first_name,last_name:g.last_name,role:we}),x(!1),y({username:"",email:"",password:"",role:"employee",first_name:"",last_name:""});try{const me=await(await tt(`${ke}/index.php?endpoint=get_users`)).json();me&&me.success&&s(me.data||[])}catch{}},ce=Re=>{E(Re),T(""),_(!0)},M=async()=>{k(!0);try{const Fe=await(await tt(`${ke}/index.php?endpoint=generate_password`)).json();Fe.success&&Fe.password?T(Fe.password):alert("Failed to generate password")}catch(Re){console.error("Error generating password:",Re),alert("Error generating password")}finally{k(!1)}},Le=()=>{A&&navigator.clipboard.writeText(A).then(()=>{alert("Password copied to clipboard!")}).catch(()=>{alert("Failed to copy password")})},Te=async Re=>{if(Re.preventDefault(),!A||!C){alert("Please generate a password first");return}const Fe=String(A).length,Me=[];if(Fe<v.min_length&&Me.push(`Password must be at least ${v.min_length} characters long`),v.max_length&&Fe>v.max_length&&Me.push(`Password must be no more than ${v.max_length} characters long`),v.require_uppercase&&!/[A-Z]/.test(A)&&Me.push("Password must contain at least one uppercase letter"),v.require_lowercase&&!/[a-z]/.test(A)&&Me.push("Password must contain at least one lowercase letter"),v.require_numbers&&!/\d/.test(A)&&Me.push("Password must contain at least one number"),v.require_special&&!/[^A-Za-z0-9]/.test(A)&&Me.push("Password must contain at least one special character"),Me.length>0){alert(Me.join(`
`));return}I(!0);try{const Qe=await(await tt(`${ke}/index.php?endpoint=admin_change_password`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:C.id,new_password:A})})).json();Qe.success?(alert(`Password changed successfully for ${C.username}`),_(!1),E(null),T("")):alert(Qe.error||"Failed to change password")}catch(Ge){console.error("Error changing password:",Ge),alert("Error changing password")}finally{I(!1)}},je=async(Re,Fe)=>{try{const Ge=await(await tt(`${ke}/index.php?endpoint=update_inventory_access`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:Re,can_access_inventory:Fe?0:1})})).json();if(Ge.success){s(Qe=>Qe.map(we=>we.id===Re?{...we,can_access_inventory:Fe?0:1}:we));try{const we=await(await tt(`${ke}/index.php?endpoint=get_users`)).json();we&&we.success&&s(we.data||[])}catch{}}else alert(Ge.error||"Failed to update inventory access")}catch{alert("Error updating inventory access")}},ze=async(Re,Fe)=>{try{const Ge=await(await tt(`${ke}/index.php?endpoint=update_order_access`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:Re,can_access_orders:Fe?0:1})})).json();if(Ge.success){s(Qe=>Qe.map(we=>we.id===Re?{...we,can_access_orders:Fe?0:1}:we));try{const we=await(await tt(`${ke}/index.php?endpoint=get_users`)).json();we&&we.success&&s(we.data||[])}catch{}}else alert(Ge.error||"Failed to update order access")}catch{alert("Error updating order access")}},Ce=async(Re,Fe)=>{try{const Ge=await(await tt(`${ke}/index.php?endpoint=update_chat_support_access`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:Re,can_access_chat_support:Fe?0:1})})).json();if(Ge.success){s(Qe=>Qe.map(we=>we.id===Re?{...we,can_access_chat_support:Fe?0:1}:we));try{const we=await(await tt(`${ke}/index.php?endpoint=get_users`)).json();we&&we.success&&s(we.data||[])}catch{}}else alert(Ge.error||"Failed to update chat support access")}catch{alert("Error updating chat support access")}},de=async Re=>{try{const Me=await(await tt(`${ke}/index.php?endpoint=delete_user`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:Re})})).json();Me.success?(s(Ge=>Ge.filter(Qe=>Qe.id!==Re)),alert("User deleted successfully")):alert(Me.error||"Failed to delete user")}catch{alert("Error deleting user")}};return u?l("div",{className:"flex min-h-[50vh] items-center justify-center",children:h("div",{className:"text-center",children:[l("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),l("p",{className:"text-gray-600",children:"Loading dashboard..."})]})}):l("div",{className:"min-h-[70vh]",children:(()=>{var Re,Fe,Me,Ge,Qe;switch(n){case"notifications":return l(Hfe,{});case"system-reports":return l(SN,{reports:H});case"inventory":return l(Ufe,{inventory:f,categories:W,user:t,setInventory:m,branch:le,setBranch:R});case"orders-management":return l(zfe,{orders:z,inventory:f,categories:W,onRefetch:()=>{tt(`${ke}/index.php?endpoint=orders`).then(we=>we.json()).then(we=>{we&&we.success&&X(we.data||[])}).catch(()=>{})}});case"pc-assembly":return l(N3,{user:t,setUser:()=>{}});case"prebuilt-management":return l(kN,{});case"user-management":return h("div",{className:"p-6 space-y-6",children:[h("div",{className:"flex items-center gap-4",children:[l(Df,{className:"h-10 w-10 text-green-500"}),h("div",{children:[l("h2",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:"Users"}),l("p",{className:"text-gray-500 text-base mt-1",children:"Create and manage users, roles, status, and access permissions."})]})]}),h("div",{className:"flex items-center justify-between",children:[h("div",{className:"text-sm text-gray-600",children:["Total users: ",Array.isArray(i)?i.length:0]}),h("button",{className:"bg-green-600 text-white px-5 py-2.5 rounded-xl hover:bg-green-700 transition-colors shadow-lg hover:shadow-xl flex items-center gap-2 font-semibold",onClick:K,children:[l(sL,{className:"h-4 w-4"}),"Create User"]})]}),l("div",{className:"card overflow-x-auto",children:h("table",{className:"table-ui",children:[l("thead",{children:h("tr",{children:[l("th",{children:"User"}),l("th",{children:"Email"}),l("th",{children:"Roles"}),l("th",{children:"Online"}),l("th",{children:"Status"}),l("th",{children:"Inventory"}),l("th",{children:"Orders"}),l("th",{children:"Chat Support"}),l("th",{children:"Actions"})]})}),l("tbody",{children:Array.isArray(i)&&i.length>0?i.map(we=>h("tr",{children:[h("td",{className:"text-sm font-medium text-gray-900",children:[we.username||`User #${we.id}`,l("div",{className:"text-xs text-gray-500",children:[we.first_name,we.last_name].filter(Boolean).join(" ")})]}),l("td",{className:"text-sm text-gray-900",children:we.email}),l("td",{className:"text-sm text-gray-900",children:(Array.isArray(we.roles)?we.roles:typeof we.roles=="string"?we.roles.split(","):[]).map(pe=>pe.trim()).filter(Boolean).map((pe,me)=>l("span",{className:"inline-block bg-gray-100 text-gray-700 px-2 py-0.5 rounded-full text-xs font-semibold mr-1 mb-1",children:pe},me))}),l("td",{children:(()=>{const pe=we.last_login?new Date(we.last_login):null,me=!!(pe&&Date.now()-pe.getTime()<=30*60*1e3);return l("span",{className:`chip ${me?"chip-green":"chip-gray"}`,children:me?"Online":"Offline"})})()}),l("td",{children:l("span",{className:`chip ${we.is_active?"chip-green":"chip-red"}`,children:we.is_active?"Active":"Disabled"})}),l("td",{children:(()=>{const pe=Number(we.can_access_inventory)===1;return l("button",{className:`px-3 py-1.5 rounded-lg text-sm font-semibold ${pe?"bg-green-50 text-green-700 border border-green-200 hover:bg-green-100":"bg-green-600 text-white hover:bg-green-700"}`,onClick:()=>{const me=pe?"disable":"enable",Ae=we.username||`User #${we.id}`;(typeof window>"u"||window.confirm(`Are you sure you want to ${me} Inventory access for ${Ae}?`))&&je(we.id,pe)},title:pe?"Disable Inventory Access":"Enable Inventory Access",children:pe?"Disable":"Enable"})})()}),l("td",{children:(()=>{const pe=Number(we.can_access_orders)===1;return l("button",{className:`px-3 py-1.5 rounded-lg text-sm font-semibold ${pe?"bg-green-50 text-green-700 border border-green-200 hover:bg-green-100":"bg-green-600 text-white hover:bg-green-700"}`,onClick:()=>{const me=pe?"disable":"enable",Ae=we.username||`User #${we.id}`;(typeof window>"u"||window.confirm(`Are you sure you want to ${me} Orders access for ${Ae}?`))&&ze(we.id,pe)},title:pe?"Disable Orders Access":"Enable Orders Access",children:pe?"Disable":"Enable"})})()}),l("td",{children:(()=>{const pe=Number(we.can_access_chat_support)===1;return l("button",{className:`px-3 py-1.5 rounded-lg text-sm font-semibold ${pe?"bg-green-50 text-green-700 border border-green-200 hover:bg-green-100":"bg-green-600 text-white hover:bg-green-700"}`,onClick:()=>{const me=pe?"disable":"enable",Ae=we.username||`User #${we.id}`;(typeof window>"u"||window.confirm(`Are you sure you want to ${me} Chat Support access for ${Ae}?`))&&Ce(we.id,pe)},title:pe?"Disable Chat Support":"Enable Chat Support",children:pe?"Disable":"Enable"})})()}),l("td",{children:l("div",{className:"flex gap-2",children:(()=>{const me=(Array.isArray(we.roles)?we.roles:typeof we.roles=="string"?we.roles.split(","):[]).some(Ae=>["Admin","Employee"].includes(Ae.trim()));return h(gt,{children:[l("button",{className:"px-3 py-1.5 bg-blue-600 text-white rounded-lg text-sm font-semibold hover:bg-blue-700 transition-colors",onClick:()=>ce(we),title:"Change Password",children:"Change Password"}),me?l("button",{className:"px-3 py-1.5 bg-green-600 text-white rounded-lg text-sm font-semibold hover:bg-green-700 transition-colors",onClick:()=>{const Ae=we.username||`User #${we.id}`;window.confirm(`Are you sure you want to delete user "${Ae}"? This action cannot be undone.`)&&de(we.id)},title:"Delete User",children:"Delete"}):l("span",{className:"text-gray-400 text-sm px-3 py-1.5",children:"Protected"})]})})()})})]},we.id)):l("tr",{children:l("td",{colSpan:"8",className:"empty-state",children:"No users found."})})})]})}),p&&l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>{x(!1),y({username:"",email:"",password:"",role:"employee",first_name:"",last_name:""})},children:h("div",{className:"bg-white rounded-xl p-6 w-full max-w-lg shadow-2xl",onClick:we=>we.stopPropagation(),children:[h("div",{className:"flex items-center justify-between mb-4",children:[l("h3",{className:"text-xl font-bold",children:"Create User"}),l("button",{className:"text-gray-500 hover:text-gray-800 text-2xl",onClick:()=>{x(!1),y({username:"",email:"",password:"",role:"employee",first_name:"",last_name:""})},children:"Ã—"})]}),h("form",{onSubmit:te,className:"space-y-3",children:[h("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[h("div",{children:[h("label",{className:"block text-sm font-medium text-gray-700",children:["Username ",l("span",{className:"text-red-600",children:"*"})]}),l("input",{required:!0,value:g.username,onChange:we=>y(pe=>({...pe,username:we.target.value})),className:"mt-1 block w-full border-2 border-blue-300 rounded px-3 py-2 focus:border-blue-500",placeholder:"e.g., john.doe"}),l("p",{className:"text-xs text-blue-600 mt-1",children:"ðŸ‘† Use this to login, not email"})]}),h("div",{children:[h("label",{className:"block text-sm font-medium text-gray-700",children:["Email ",l("span",{className:"text-red-600",children:"*"})]}),l("input",{required:!0,type:"email",value:g.email,onChange:we=>y(pe=>({...pe,email:we.target.value})),className:"mt-1 block w-full border rounded px-3 py-2",placeholder:"e.g., john.doe@company.com"}),l("p",{className:"text-xs text-gray-500 mt-1",children:"For notifications only"})]})]}),h("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"First name"}),l("input",{value:g.first_name,onChange:we=>y(pe=>({...pe,first_name:we.target.value})),className:"mt-1 block w-full border rounded px-3 py-2"})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Last name"}),l("input",{value:g.last_name,onChange:we=>y(pe=>({...pe,last_name:we.target.value})),className:"mt-1 block w-full border rounded px-3 py-2"})]})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Role"}),h("select",{value:g.role,onChange:we=>y(pe=>({...pe,role:we.target.value})),className:"mt-1 block w-full border rounded px-3 py-2",children:[l("option",{value:"employee",children:"Employee"}),l("option",{value:"admin",children:"Admin"})]})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),h("div",{className:"flex gap-2 mt-1",children:[l("div",{className:"flex-1",children:l(Wl,{required:!0,value:g.password||"",onChange:we=>y(pe=>({...pe,password:we.target.value})),className:"block w-full border rounded px-3 py-2",placeholder:"Click Generate to create password"})}),l("button",{type:"button",onClick:O,disabled:w,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-gray-400 whitespace-nowrap",children:w?"Generating...":"Generate"}),g.password&&l("button",{type:"button",onClick:G,className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 whitespace-nowrap",title:"Copy password",children:"Copy"})]}),g.password&&h("div",{className:"mt-2 p-4 bg-green-50 border-2 border-green-300 rounded-lg",children:[h("p",{className:"text-xs font-semibold text-green-800 mb-2 flex items-center gap-2",children:[l("span",{children:"ðŸ”‘"}),l("span",{children:"Generated Password (SAVE THIS!):"})]}),l("p",{className:"text-lg font-mono font-bold text-green-700 break-all bg-white p-2 rounded border border-green-200",children:g.password}),l("p",{className:"text-xs text-green-700 mt-2",children:"âš ï¸ You cannot retrieve this password later!"})]})]}),h("div",{className:"flex justify-end gap-2 pt-2",children:[l("button",{type:"button",onClick:()=>{x(!1),y({username:"",email:"",password:"",role:"employee",first_name:"",last_name:""})},className:"px-4 py-2 border rounded",children:"Cancel"}),l("button",{type:"submit",className:"px-5 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"Create"})]})]})]})}),S&&C&&l("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>_(!1),children:h("div",{className:"bg-white rounded-xl p-6 w-full max-w-md shadow-2xl",onClick:we=>we.stopPropagation(),children:[h("div",{className:"flex items-center justify-between mb-4",children:[l("h3",{className:"text-xl font-bold",children:"Change Password"}),l("button",{className:"text-gray-500 hover:text-gray-800 text-2xl",onClick:()=>_(!1),children:"Ã—"})]}),h("div",{className:"mb-4",children:[l("p",{className:"text-sm text-gray-600",children:"Changing password for:"}),l("p",{className:"text-base font-semibold text-gray-900",children:C.username}),l("p",{className:"text-sm text-gray-500",children:C.email})]}),h("form",{onSubmit:Te,className:"space-y-4",children:[h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password"}),h("div",{className:"flex gap-2",children:[l(Wl,{required:!0,value:A,onChange:we=>T(we.target.value),className:"block w-full border rounded px-3 py-2",placeholder:"Enter new password"}),l("button",{type:"button",onClick:M,disabled:w,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-gray-400 whitespace-nowrap",children:w?"Generating...":"Generate"}),A&&l("button",{type:"button",onClick:Le,className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 whitespace-nowrap",title:"Copy password",children:"Copy"})]}),A&&h("div",{className:"mt-3 p-3 bg-green-50 border border-green-200 rounded",children:[l("p",{className:"text-xs text-gray-600 mb-1",children:"New Password (save this!):"}),l("p",{className:"text-sm font-mono font-bold text-green-700 break-all",children:A})]})]}),h("div",{className:"flex justify-end gap-2 pt-2",children:[l("button",{type:"button",onClick:()=>_(!1),className:"px-4 py-2 border rounded hover:bg-gray-50",disabled:D,children:"Cancel"}),l("button",{type:"submit",className:"px-5 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:bg-gray-400",disabled:D||!A,children:D?"Changing...":"Change Password"})]})]})]})})]});case"dashboard":default:{const we=((Fe=(Re=H==null?void 0:H.monthly_sales)==null?void 0:Re[0])==null?void 0:Fe.total_sales)||0,pe=((Me=H==null?void 0:H.deadstock)==null?void 0:Me.length)||0,me=((Qe=(Ge=H==null?void 0:H.top_selling_products)==null?void 0:Ge[0])==null?void 0:Qe.name)||"N/A",Ae=(H==null?void 0:H.deadstock_total_value)??0;return h("div",{className:"p-6 space-y-6",children:[h("div",{children:[l("h2",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:"Super Admin Dashboard"}),l("p",{className:"text-gray-600",children:"Overview of key metrics and recent activity."})]}),h("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[l("div",{className:"bg-white p-6 rounded-2xl shadow-lg border",children:h("div",{className:"flex items-center",children:[l("div",{className:"p-3 bg-green-100 rounded-lg flex items-center justify-center",children:l("span",{className:"text-2xl font-extrabold text-green-600",children:"â‚±"})}),h("div",{className:"ml-4",children:[l("p",{className:"text-sm font-medium text-gray-600",children:"Sales This Month"}),l("p",{className:"text-2xl font-bold text-gray-900",children:it(we)})]})]})}),l("div",{className:"bg-white p-6 rounded-2xl shadow-lg border",children:h("div",{className:"flex items-center",children:[l("div",{className:"p-3 bg-yellow-100 rounded-lg",children:l(nt,{className:"h-6 w-6 text-yellow-600"})}),h("div",{className:"ml-4",children:[l("p",{className:"text-sm font-medium text-gray-600",children:"Deadstock Items"}),h("div",{children:[l("p",{className:"text-2xl font-bold text-gray-900",children:pe}),h("p",{className:"text-sm text-gray-600",children:["Total: ",it(Ae)]})]})]})]})}),l("div",{className:"bg-white p-6 rounded-2xl shadow-lg border",children:h("div",{className:"flex items-center",children:[l("div",{className:"p-3 bg-blue-100 rounded-lg",children:l(Qc,{className:"h-6 w-6 text-blue-600"})}),h("div",{className:"ml-4 flex-1 min-w-0",children:[l("p",{className:"text-sm font-medium text-gray-600",children:"Top Seller"}),l("p",{className:"text-base font-bold text-gray-900 break-words leading-tight",title:me,children:me})]})]})})]}),h("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4",children:[h("div",{children:[l("label",{htmlFor:"dashboard-sales-chart-type",className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Sales Chart:"}),h("select",{id:"dashboard-sales-chart-type",className:"border rounded px-4 py-2 text-base focus:ring-2 focus:ring-green-400 focus:border-green-400 transition",value:B,onChange:Ke=>ee(Ke.target.value),children:[l("option",{value:"monthly",children:"Monthly Sales"}),l("option",{value:"weekly",children:"Weekly Sales"}),l("option",{value:"daily",children:"Daily Sales"})]})]}),l("div",{className:"flex-1 flex items-end justify-end",children:h("span",{className:"text-gray-500 text-sm italic",children:["Showing: ",l("span",{className:"font-semibold text-gray-800",children:V})]})})]}),h("div",{className:"card p-6 mb-8",children:[l("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:V}),P]}),h("div",{className:"card p-6",children:[l("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Orders"}),l("div",{className:"overflow-x-auto",children:h("table",{className:"table-ui",children:[l("thead",{children:h("tr",{children:[l("th",{children:"Order ID"}),l("th",{children:"Customer"}),l("th",{children:"Total"}),l("th",{children:"Status"}),l("th",{children:"Date"})]})}),l("tbody",{children:z&&z.length>0?z.slice(0,5).map(Ke=>h("tr",{children:[h("td",{className:"whitespace-nowrap text-sm font-medium text-gray-900",children:["#",Ke.id]}),l("td",{className:"whitespace-nowrap text-sm text-gray-900",children:Ke.user_id}),h("td",{className:"whitespace-nowrap text-sm text-gray-900",children:["â‚±",Ke.total_price]}),l("td",{className:"whitespace-nowrap text-sm text-gray-900",children:Ke.status}),l("td",{className:"whitespace-nowrap text-sm text-gray-900",children:Ke.order_date})]},Ke.id)):l("tr",{children:l("td",{colSpan:"5",className:"text-center py-4",children:"No recent orders."})})})]})})]})]})}}})()})};function Wfe({inventory:e=[],categories:t=[],editingOrder:r=null,onCancel:n=()=>{},onCreated:a=()=>{}}){const[i,s]=ft.useState([{component_id:"",quantity:1}]),[o,c]=ft.useState("pending"),[u,d]=ft.useState(!1),[f,m]=ft.useState(""),[p,x]=ft.useState(""),[g,y]=ft.useState(""),[v,b]=ft.useState(""),w=()=>s(C=>[...C,{component_id:"",quantity:1}]),k=(C,E)=>s(A=>A.map((T,D)=>D===C?{...T,...E}:T)),S=C=>s(E=>E.filter((A,T)=>T!==C));return ft.useEffect(()=>{if(r){if(c(r.status||"pending"),m(r.notes||""),x(r.purchase_date||""),y(r.customer_name||""),b(r.customer_phone||""),!r.id){console.error("Cannot fetch order details: order ID is missing",r),alert("Error: Order ID is missing. Cannot load order details."),s([{component_id:"",quantity:1}]);return}(async()=>{try{const E=`${ke}/index.php?endpoint=orders&id=${r.id}`;console.log("Fetching order details from:",E);const A=await tt(E);if(!A.ok){const D=await A.text();let I;try{I=JSON.parse(D)}catch{I={error:D||`HTTP ${A.status}`}}console.error("Failed to fetch order details:",A.status,I),alert(`Failed to load order details: ${I.error||`HTTP ${A.status}`}`),s([{component_id:"",quantity:1}]);return}const T=await A.json();if(T.success&&T.data){if(T.data.items&&Array.isArray(T.data.items)&&T.data.items.length>0){const D=T.data.items.map(I=>({component_id:I.component_id?I.component_id.toString():"",quantity:I.quantity||1}));s(D)}else console.warn("Order found but has no items"),s([{component_id:"",quantity:1}]);y(T.data.customer_name||""),b(T.data.customer_phone||"")}else console.error("API returned unsuccessful response:",T),alert(`Failed to load order: ${T.error||"Unknown error"}`),s([{component_id:"",quantity:1}])}catch(E){console.error("Error fetching order details:",E),alert(`Error loading order details: ${E.message||"Network error"}`),s([{component_id:"",quantity:1}])}})()}else s([{component_id:"",quantity:1}]),c("pending"),m(""),x("")},[r]),h("form",{onSubmit:async C=>{if(C.preventDefault(),i.filter(T=>!T.component_id||T.component_id==="").length>0){alert('Please select a component for all items or remove empty slots using the "Remove" button.');return}if(!p){alert("Please select a purchase date.");return}if(v&&!/^63\d{10}$/.test(String(v).replace(/[^\d]/g,""))){alert("Customer phone must start with 63 followed by 10 digits.");return}const A=i.filter(T=>T.component_id&&Number(T.quantity)>0).map(T=>({component_id:Number(T.component_id),quantity:Number(T.quantity)}));if(A.length===0){alert("Add at least one item.");return}d(!0);try{const T=!!r,D=T?`${ke}/index.php?endpoint=orders&id=${r.id}`:`${ke}/index.php?endpoint=orders`,z=await tt(D,{method:T?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:A,status:o,notes:f?String(f).toUpperCase():void 0,purchase_date:p,customer_name:g||void 0,customer_phone:v||void 0})}),X=await z.json().catch(()=>({}));!z.ok||!X.success?alert(X.error||`Failed to ${T?"update":"create"} order`):a(X.order_id||(r==null?void 0:r.id))}catch(T){console.error(T),alert(`Network error ${r?"updating":"creating"} order`)}finally{d(!1)}},className:"space-y-8",children:[h("div",{className:"bg-gray-50 rounded-2xl p-6",children:[l("h4",{className:"text-lg font-semibold text-gray-800 mb-6",children:"Component Selection"}),h("div",{className:"space-y-6",children:[i.map((C,E)=>l("div",{className:`bg-white rounded-xl p-6 shadow-sm border-2 ${!C.component_id||C.component_id===""?"border-red-200 bg-red-50":"border-gray-200"}`,children:h("div",{className:"grid grid-cols-12 gap-4 items-end",children:[h("div",{className:"col-span-7",children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Component"}),l(_N,{value:C.component_id,onChange:A=>k(E,{component_id:A}),inventory:e,categories:t,placeholder:"Search components...",className:`w-full ${!C.component_id||C.component_id===""?"border-red-300":""}`}),(!C.component_id||C.component_id==="")&&l("p",{className:"text-red-600 text-sm mt-2 font-medium",children:"Please select a component or remove this item"})]}),h("div",{className:"col-span-3",children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Quantity"}),l("input",{type:"number",min:1,className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors",value:C.quantity,onChange:A=>k(E,{quantity:A.target.value})})]}),l("div",{className:"col-span-2 flex justify-end",children:l("button",{type:"button",className:"text-red-600 hover:text-red-800 font-semibold text-sm py-3 px-4 border-2 border-red-300 rounded-lg hover:bg-red-50 transition-colors whitespace-nowrap",onClick:()=>S(E),children:"Remove"})})]})},E)),h("button",{type:"button",className:"w-full text-green-600 hover:text-green-800 font-semibold flex items-center justify-center gap-3 py-4 px-6 border-2 border-dashed border-green-300 rounded-xl hover:bg-green-50 transition-colors",onClick:w,children:[l(wn,{className:"h-5 w-5"}),"Add Another Component"]})]})]}),h("div",{className:"bg-gray-50 rounded-2xl p-6",children:[l("h4",{className:"text-lg font-semibold text-gray-800 mb-6",children:"Order Details"}),h("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[h("div",{children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Status"}),h("select",{className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors",value:o,onChange:C=>c(C.target.value),children:[l("option",{value:"Pending",children:"Pending"}),l("option",{value:"Processing",children:"Processing"}),l("option",{value:"Completed",children:"Completed"}),l("option",{value:"Cancelled",children:"Cancelled"})]})]}),h("div",{children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Purchase Date *"}),l("input",{type:"date",className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors",value:p,onChange:C=>x(C.target.value),required:!0})]}),h("div",{children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Notes (COMMENTS)"}),l("input",{className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors",value:f,onChange:C=>m(C.target.value),placeholder:"OPTIONAL"})]})]}),h("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6",children:[h("div",{children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Customer Full Name"}),l("input",{className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors",value:g,onChange:C=>y(C.target.value),placeholder:"Juan Dela Cruz"})]}),h("div",{children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Customer Contact Number"}),l("input",{className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors",value:v,onChange:C=>b(C.target.value),placeholder:"639XXXXXXXXX"}),l("p",{className:"text-xs text-gray-500 mt-1",children:"PH format: 63 + 10 digits"})]})]})]}),h("div",{className:"flex justify-end gap-4 pt-6 border-t-2 border-gray-200",children:[l("button",{type:"button",onClick:n,className:"px-8 py-3 border-2 border-gray-300 rounded-xl hover:bg-gray-50 transition-colors font-semibold text-gray-700",children:"Cancel"}),l("button",{type:"submit",className:"px-8 py-3 bg-green-600 text-white rounded-xl hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-semibold text-lg",disabled:u,children:u?r?"Updating...":"Creating...":r?"Update Order":"Create Order"})]})]})}const ty={Aio:"CPU Cooler (AIO)","Case Gaming":"PC Case (Gaming)",GPU:"Graphics Card (GPU)",Mobo:"Motherboard","Procie Only":"Processor (CPU)",PSU:"Power Supply (PSU)","Psu - Tr":"Power Supply (PSU, True Rated)","Ram 3200mhz":"Memory (RAM, 3200MHz)","Ssd Nvme":"Storage (SSD NVMe)",Cooler:"CPU Cooler",RAM:"Memory (RAM)",Storage:"Storage",Case:"PC Case",Motherboard:"Motherboard",CPU:"Processor (CPU)"},x4=({initialTab:e,user:t,setUser:r})=>{const[n,a]=N.useState(e||"employee-dashboard");N.useEffect(()=>{e&&e!==n&&a(e)},[e,n]);const[i,s]=N.useState([]),[o,c]=N.useState([]),[u,d]=N.useState({}),[f,m]=N.useState(!0),[p,x]=N.useState(null),[g,y]=N.useState("monthly"),[v,b]=N.useState([]),[w,k]=N.useState(null),[S,_]=N.useState(null),[C,E]=N.useState(""),[A,T]=N.useState("all"),[D,I]=N.useState("all"),[z,X]=N.useState("name"),[H,L]=N.useState(null);yp();const[W,ie]=N.useState(t==null?void 0:t.can_access_inventory),[B,ee]=N.useState(!1),[le,R]=N.useState(null);N.useEffect(()=>{const de=async(Fe=!1)=>{Fe&&m(!0),x(null);try{if(!await gr()){x("Session expired. Please log in again."),s([]),c([]),d({});return}const Ge=await tt(`${ke}/index.php?endpoint=dashboard${H?`&branch=${H}`:""}`,{method:"GET"});if(Ge.status===401){x("Invalid token"),s([]),c([]),d({});return}const Qe=await Ge.json().catch(()=>({}));if(Qe&&Qe.success){const we=Qe.data||{};s(we.inventory||[]),c(we.orders||[]),d(we.reports||{})}else x(Qe&&Qe.error||"API call was not successful")}catch(Me){x("Error fetching dashboard data."),console.error("Error fetching dashboard data:",Me)}finally{Fe&&m(!1)}},$e=setTimeout(()=>de(!0),200),Re=setInterval(()=>de(!1),6e4);return()=>{clearTimeout($e),clearInterval(Re)}},[H]),N.useEffect(()=>{(async()=>{try{const Re=await(await tt(`${ke}/index.php?endpoint=categories`)).json();Re.success&&b(Re.data)}catch{}})()},[]);const j=[{key:"CPU",names:["CPU","Procie Only","Pro & Mobo - Amd","Pro & Mobo - Intel"]},{key:"Motherboard",names:["Motherboard","Mobo","Pro & Mobo - Amd","Pro & Mobo - Intel"]},{key:"GPU",names:["GPU"]},{key:"RAM",names:["RAM","Ram 3200mhz"]},{key:"Storage",names:["Storage","Ssd Nvme"]},{key:"PSU",names:["PSU","Psu - Tr"]},{key:"Case",names:["Case","Case Gaming"]},{key:"Cooler",names:["Cooler","Aio"]}],V={};j.forEach(de=>{V[de.key]=v.filter($e=>de.names.includes($e.name)).map($e=>String($e.id))});const P=de=>{const $e=v.find(Re=>Re.id===Number(de.category_id));if(!$e)return null;for(const Re of j)if(Re.names.includes($e.name))return Re.key;return null},q=i.filter(de=>P(de)),O=Array.from(new Set(q.map(de=>(de.brand||"").trim()).filter(Boolean).map(de=>de.toLowerCase()))),K=O.map(de=>de.charAt(0).toUpperCase()+de.slice(1)),G=["all"];O.includes("amd")&&G.push("AMD"),O.includes("intel")&&G.push("Intel"),G.push(...K.filter(de=>de!=="Amd"&&de!=="Intel"));let te=i.filter(de=>{const $e=P(de);if(!$e||A!=="all"&&$e!==A)return!1;if(D!=="all"){if(!de.brand)return!1;if(D.toLowerCase()==="amd"||D.toLowerCase()==="intel"){if(de.brand.toLowerCase()!==D.toLowerCase())return!1}else if(de.brand.toLowerCase()!==D.toLowerCase())return!1}return!0});C.trim()!==""&&(te=te.filter(de=>de.name.toLowerCase().includes(C.toLowerCase())||de.brand&&de.brand.toLowerCase().includes(C.toLowerCase()))),te=[...te].sort((de,$e)=>z==="name"?de.name.localeCompare($e.name):z==="price"?Number($e.price)-Number(de.price):z==="stock"?Number(de.stock_quantity||de.stock)-Number($e.stock_quantity||$e.stock):z==="category"?(P(de)||"").localeCompare(P($e)||""):0);const ce=()=>{var Qe,we,pe,me,Ae;const de=((we=(Qe=u==null?void 0:u.monthly_sales)==null?void 0:Qe[0])==null?void 0:we.total_sales)||0,$e=((pe=u==null?void 0:u.deadstock)==null?void 0:pe.length)||0,Re=((Ae=(me=u==null?void 0:u.top_selling_products)==null?void 0:me[0])==null?void 0:Ae.name)||"N/A";let Fe=[],Me="",Ge=null;return g==="monthly"?(Fe=(u==null?void 0:u.monthly_sales)||[],Me="Monthly Sales",Ge=Fe.length>0?l(tr,{width:"100%",height:200,children:h(qi,{data:Fe,margin:{top:10,right:20,left:0,bottom:0},children:[l(Lr,{strokeDasharray:"3 3"}),l(Br,{dataKey:"month",label:{value:"Month",position:"insideBottomRight",offset:0}}),l(jr,{}),l(rr,{}),l(Gt,{}),l(Ei,{type:"monotone",dataKey:"total_sales",stroke:"#A020F0",strokeWidth:3})]})}):l("div",{className:"h-[280px] flex items-center justify-center p-6",children:h("div",{className:"text-center max-w-md",children:[l(nt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-3",children:"No data available"}),l("p",{className:"text-gray-400 text-sm leading-relaxed",children:"This could be because there are no completed orders yet or the system is still collecting data."})]})})):g==="weekly"?(Fe=(u==null?void 0:u.weekly_sales)||[],Me="Weekly Sales",Ge=Fe.length>0?l(tr,{width:"100%",height:200,children:h(qi,{data:Fe,margin:{top:10,right:20,left:0,bottom:0},children:[l(Lr,{strokeDasharray:"3 3"}),l(Br,{dataKey:"week",label:{value:"Week",position:"insideBottomRight",offset:0}}),l(jr,{}),l(rr,{}),l(Gt,{}),l(Ei,{type:"monotone",dataKey:"total_sales",stroke:"#36A2EB",strokeWidth:3})]})}):l("div",{className:"h-[280px] flex items-center justify-center p-6",children:h("div",{className:"text-center max-w-md",children:[l(nt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-3",children:"No data available"}),l("p",{className:"text-gray-400 text-sm leading-relaxed",children:"This could be because there are no completed orders yet or the system is still collecting data."})]})})):g==="daily"&&(Fe=(u==null?void 0:u.daily_sales)||[],Me="Daily Sales (Last 30 Days)",Ge=Fe.length>0?l(tr,{width:"100%",height:200,children:h(fs,{data:Fe,margin:{top:10,right:20,left:0,bottom:0},children:[l(Lr,{strokeDasharray:"3 3"}),l(Br,{dataKey:"day",label:{value:"Day",position:"insideBottomRight",offset:0}}),l(jr,{}),l(rr,{}),l(Gt,{}),l(Za,{dataKey:"total_sales",fill:"#36A2EB"})]})}):l("div",{className:"h-[280px] flex items-center justify-center p-6",children:h("div",{className:"text-center max-w-md",children:[l(nt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-500 mb-3",children:"No data available"}),l("p",{className:"text-gray-400 text-sm leading-relaxed",children:"This could be because there are no completed orders yet or the system is still collecting data."})]})})),h("div",{className:"space-y-6",children:[h("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[l("div",{className:"bg-white p-6 rounded-2xl shadow-lg border",children:h("div",{className:"flex items-center",children:[l("div",{className:"p-3 bg-green-100 rounded-lg flex items-center justify-center",children:l("span",{className:"text-2xl font-extrabold text-green-600",children:"â‚±"})}),h("div",{className:"ml-4",children:[l("p",{className:"text-sm font-medium text-gray-600",children:"Sales This Month"}),l("p",{className:"text-2xl font-bold text-gray-900",children:it(de)})]})]})}),l("div",{className:"bg-white p-6 rounded-2xl shadow-lg border",children:h("div",{className:"flex items-center",children:[l("div",{className:"p-3 bg-yellow-100 rounded-lg",children:l(nt,{className:"h-6 w-6 text-yellow-600"})}),h("div",{className:"ml-4",children:[l("p",{className:"text-sm font-medium text-gray-600",children:"Deadstock Items"}),h("div",{children:[l("p",{className:"text-2xl font-bold text-gray-900",children:$e}),h("p",{className:"text-sm text-gray-600",children:["Total: ",it((u==null?void 0:u.deadstock_total_value)||0)]})]})]})]})}),l("div",{className:"bg-white p-6 rounded-2xl shadow-lg border",children:h("div",{className:"flex items-center",children:[l("div",{className:"p-3 bg-blue-100 rounded-lg",children:l(Qc,{className:"h-6 w-6 text-blue-600"})}),h("div",{className:"ml-4",children:[l("p",{className:"text-sm font-medium text-gray-600",children:"Top Seller"}),l("p",{className:"text-base font-bold text-gray-900 break-words leading-tight",title:Re,children:Re})]})]})})]}),h("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4",children:[h("div",{children:[l("label",{htmlFor:"dashboard-sales-chart-type",className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Sales Chart:"}),h("select",{id:"dashboard-sales-chart-type",className:"border rounded px-4 py-2 text-base focus:ring-2 focus:ring-indigo-400 focus:border-indigo-400 transition",value:g,onChange:Ke=>y(Ke.target.value),children:[l("option",{value:"monthly",children:"Monthly Sales"}),l("option",{value:"weekly",children:"Weekly Sales"}),l("option",{value:"daily",children:"Daily Sales"})]})]}),l("div",{className:"flex-1 flex items-end justify-end",children:h("span",{className:"text-gray-500 text-sm italic",children:["Showing: ",l("span",{className:"font-semibold text-gray-800",children:Me})]})})]}),h("div",{className:"card p-6 mb-8",children:[l("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:Me}),Ge]}),h("div",{className:"card p-6",children:[l("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Orders"}),l("div",{className:"overflow-x-auto",children:h("table",{className:"table-ui",children:[l("thead",{children:h("tr",{children:[l("th",{children:"Order ID"}),l("th",{children:"Customer ID"}),l("th",{children:"Total"}),l("th",{children:"Status"}),l("th",{children:"Date"})]})}),l("tbody",{children:o&&o.length>0?o.slice(0,5).map(Ke=>h("tr",{children:[h("td",{className:"whitespace-nowrap text-sm font-medium text-gray-900",children:["#",Ke.id]}),l("td",{className:"whitespace-nowrap text-sm text-gray-900",children:Ke.user_id}),l("td",{className:"whitespace-nowrap text-sm text-gray-900",children:it(Ke.total_price)}),l("td",{className:"whitespace-nowrap",children:l("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${Ke.status==="Completed"?"bg-green-100 text-green-800":Ke.status==="Processing"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:Ke.status})}),l("td",{className:"whitespace-nowrap text-sm text-gray-900",children:Ke.order_date})]},Ke.id)):l("tr",{children:l("td",{colSpan:"5",className:"text-center py-4",children:"No order data available."})})})]})})]})]})},M=()=>h("div",{className:"space-y-6",children:[h("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l("h2",{className:"page-title",children:"Inventory"}),h("div",{className:"flex items-center gap-2",children:[l("span",{className:"text-sm text-gray-600",children:"Branch:"}),h("div",{className:"inline-flex rounded-lg border overflow-hidden",children:[l("button",{className:`px-3 py-1 text-sm ${H===null?"bg-indigo-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,onClick:()=>L(null),children:"All"}),l("button",{className:`px-3 py-1 text-sm border-l ${H==="BULACAN"?"bg-indigo-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,onClick:()=>L("BULACAN"),children:"Bulacan"}),l("button",{className:`px-3 py-1 text-sm border-l ${H==="MARIKINA"?"bg-indigo-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,onClick:()=>L("MARIKINA"),children:"Marikina"})]})]}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")&&h("button",{className:"bg-indigo-600 text-white px-5 py-2 rounded-xl hover:bg-indigo-700 flex items-center gap-2 shadow-lg",onClick:()=>_({}),children:[l(wn,{className:"h-4 w-4"}),"Add Product"]})]}),l("div",{className:"mb-2",children:h("div",{className:"flex flex-col gap-3",children:[l("div",{className:"w-full",children:l("input",{type:"text",placeholder:"Search by name or brand...",value:C,onChange:de=>E(de.target.value),className:"px-4 py-2 border rounded-lg w-full",style:{minHeight:"42px"}})}),h("div",{className:"flex flex-col sm:flex-row gap-2",children:[h("select",{value:A,onChange:de=>T(de.target.value),className:"px-4 py-2 border rounded-lg flex-1",style:{minHeight:"42px"},children:[l("option",{value:"all",children:"All Components"}),j.map(de=>l("option",{value:de.key,children:de.key},de.key))]}),h("select",{value:D,onChange:de=>I(de.target.value),className:"px-4 py-2 border rounded-lg flex-1",style:{minHeight:"42px"},children:[l("option",{value:"all",children:"All Brands"}),G.filter(de=>de!=="all").map(de=>l("option",{value:de,children:de},de))]})]}),l("div",{className:"flex flex-col sm:flex-row gap-2",children:h("select",{value:z,onChange:de=>X(de.target.value),className:"px-4 py-2 border rounded-lg w-full sm:w-48",style:{minHeight:"42px"},children:[l("option",{value:"name",children:"Sort by Name"}),l("option",{value:"price",children:"Sort by Price"}),l("option",{value:"stock",children:"Sort by Stock"}),l("option",{value:"category",children:"Sort by Category"})]})})]})}),l("div",{className:"bg-white rounded-2xl shadow-lg border overflow-x-auto",children:h("table",{className:"min-w-full divide-y divide-gray-200",children:[l("thead",{className:"bg-gray-50",children:h("tr",{children:[l("th",{className:"w-20 px-4 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Image"}),l("th",{className:"w-1/5 px-2 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Name"}),l("th",{className:"w-1/6 px-2 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Category"}),l("th",{className:"w-1/6 px-2 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Brand"}),l("th",{className:"w-1/12 px-2 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Price"}),l("th",{className:"w-1/12 px-2 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Stock"}),l("th",{className:"w-1/12 px-2 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),l("tbody",{className:"bg-white divide-y divide-gray-200",children:te&&te.length>0?te.map(de=>{const $e=v.find(Me=>String(Me.id)===String(de.category_id)),Re=$e?ty[$e.name]||$e.name:de.category_id,Fe=de.image_url&&de.image_url.trim()!==""?de.image_url:xr(de.name);return h("tr",{children:[l("td",{className:"w-20 px-4 py-4 whitespace-nowrap align-middle",children:l("img",{src:Fe,alt:de.name,className:"w-14 h-14 object-contain rounded border cursor-pointer hover:shadow-lg transition duration-150",onClick:()=>k(de),onError:Me=>{Me.target.onerror=null;const Ge=xr(de.name);Ge!==Fe?Me.target.src=Ge:Me.target.src="/images/components/default.png"}})}),l("td",{className:"px-2 py-4 whitespace-normal text-sm font-medium text-gray-900 break-words max-w-md flex items-center gap-3 truncate",style:{maxWidth:"320px"},title:de.name,children:de.name}),l("td",{className:"w-1/6 px-2 py-4 whitespace-nowrap text-sm text-gray-900 truncate max-w-xs",title:Re,children:Re}),l("td",{className:"w-1/6 px-2 py-4 whitespace-nowrap text-sm text-gray-900 truncate max-w-[80px]",title:de.brand,children:de.brand}),l("td",{className:"w-1/12 px-2 py-4 whitespace-nowrap text-sm text-gray-900 max-w-[80px]",children:it(de.price)}),l("td",{className:"w-1/12 px-2 py-4 whitespace-nowrap text-sm text-gray-900",children:de.stock_quantity||de.stock}),h("td",{className:"w-1/12 px-2 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[l("button",{className:"text-blue-600 hover:text-blue-900",onClick:()=>_(de),title:"Edit",children:l(Oi,{className:"h-4 w-4"})}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="superadmin")&&l("button",{className:"text-red-600 hover:text-red-900",onClick:async()=>{if(window.confirm(`Delete '${de.name}'?`))try{const Ge=await(await tt(`${ke}/index.php?endpoint=delete_component&id=${encodeURIComponent(de.id)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:de.id})})).json();Ge.success?(s(Qe=>Qe.filter(we=>we.id!==de.id)),k(null),alert("Deleted successfully")):alert(Ge.error||"Failed to delete item")}catch(Me){console.error(Me),alert("Error deleting item")}},title:"Delete",children:l(Hr,{className:"h-4 w-4"})})]})]},de.id)}):l("tr",{children:l("td",{colSpan:"7",className:"text-center py-4",children:"No inventory data available."})})})]})}),w&&l("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:()=>k(null),children:h("div",{className:"bg-white rounded-2xl shadow-lg p-8 max-w-2xl w-full relative flex flex-col md:flex-row gap-8",children:[h("button",{className:"absolute top-4 right-4 bg-gray-100 hover:bg-red-100 text-gray-500 hover:text-red-600 rounded-full p-3 transition-colors shadow text-2xl",onClick:()=>k(null),"aria-label":"Close modal",children:[l("span",{className:"sr-only",children:"Close"}),"Ã—"]}),l("div",{className:"flex-shrink-0 flex items-center justify-center bg-gray-50 rounded-l-2xl md:rounded-l-2xl md:rounded-r-none p-10 md:w-1/2 w-full border-b md:border-b-0 md:border-r",children:l("div",{className:"flex items-center justify-center w-full max-w-[500px] max-h-[400px] bg-white rounded border overflow-hidden",children:l("img",{src:w.image_url||xr(w.name),alt:w.name,className:"max-w-full max-h-[400px] object-contain",onError:de=>{de.target.onerror=null,de.target.src=xr(w.name)}})})}),h("div",{className:"flex-1 flex flex-col justify-center p-10 md:w-1/2 w-full",children:[l("div",{className:"text-3xl font-extrabold text-gray-900 mb-4 text-center md:text-left",children:w.name}),h("div",{className:"mb-6 flex flex-wrap gap-3 justify-center md:justify-start",children:[h("span",{className:"inline-block bg-gray-100 text-gray-700 rounded px-3 py-1 text-base font-semibold",children:["ID: ",w.id]}),l("span",{className:"inline-block bg-blue-100 text-blue-700 rounded px-3 py-1 text-base font-semibold",children:(()=>{const de=v.find($e=>String($e.id)===String(w.category_id));return de?ty[de.name]||de.name:w.category_id})()}),h("span",{className:"inline-block bg-green-100 text-green-700 rounded px-3 py-1 text-base font-semibold",children:["Brand: ",w.brand||"-"]})]}),h("div",{className:"grid grid-cols-2 gap-x-6 gap-y-4 text-lg text-gray-700 mb-6",children:[h("div",{className:"flex items-center font-semibold",children:[l("span",{className:"mr-2 text-blue-600 text-2xl font-bold align-middle",children:"â‚±"}),"Price:"]}),h("div",{className:"font-bold text-green-700 text-xl",children:["â‚±",w.price]}),h("div",{className:"flex items-center font-semibold",children:[l("span",{className:"mr-2",children:h("svg",{className:"w-5 h-5 text-yellow-500 inline",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:[l("circle",{cx:"12",cy:"12",r:"10"}),l("path",{d:"M12 8v4l3 3"})]})}),"Stock:"]}),l("div",{className:"text-lg",children:w.stock_quantity??w.stock})]}),w.specs&&typeof w.specs=="object"&&Object.keys(w.specs).length>0&&h("div",{className:"mb-2",children:[l("div",{className:"font-semibold text-gray-800 mb-2 text-lg",children:"Specs:"}),l("ul",{className:"list-disc list-inside text-base text-gray-600",children:Object.entries(w.specs).map(([de,$e])=>h("li",{children:[h("span",{className:"font-medium capitalize",children:[de.replace(/_/g," "),":"]})," ",String($e)]},de))})]})]})]})}),S!==null&&l("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:()=>_(null),children:h("div",{className:"bg-white rounded-2xl shadow-lg p-6 max-w-2xl w-full relative",onClick:de=>de.stopPropagation(),children:[l("button",{className:"absolute top-4 right-4 text-gray-500 hover:text-gray-800",onClick:()=>_(null),children:"Ã—"}),l("h3",{className:"text-xl font-bold mb-4",children:S.id?"Edit Product":"Add Product"}),l(Vfe,{item:S,categories:v,onCancel:()=>_(null),onSave:async de=>{de&&s($e=>S.id?$e.map(Re=>Re.id===de.id?de:Re):[de,...$e]),_(null)}})]})})]}),Le=()=>h("div",{className:"space-y-6",children:[h("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l("h2",{className:"page-title",children:"Orders"}),h("button",{className:"btn btn-primary shadow",onClick:()=>ee(!0),children:[l(wn,{className:"h-4 w-4"}),"Add Order"]})]}),l("div",{className:"bg-white rounded-2xl shadow-lg border overflow-x-auto",children:h("table",{className:"min-w-full divide-y divide-gray-200",children:[l("thead",{className:"bg-gray-50",children:h("tr",{children:[l("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Order ID"}),l("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Customer"}),l("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Total"}),l("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Status"}),l("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Date"}),l("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),l("tbody",{className:"bg-white divide-y divide-gray-200",children:o&&o.length>0?o.map(de=>h("tr",{children:[h("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:["#",de.id]}),l("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:de.user_id}),l("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:it(de.total_price)}),l("td",{className:"px-6 py-4 whitespace-nowrap",children:l("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${de.status==="Completed"?"bg-green-100 text-green-800":de.status==="Processing"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:de.status})}),l("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:de.order_date}),l("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:l("button",{className:"text-blue-600 hover:text-blue-900",onClick:()=>{R(de),ee(!0)},title:"Edit Order",children:l(Oi,{className:"h-4 w-4"})})})]},de.id)):l("tr",{children:l("td",{colSpan:"6",className:"text-center py-4",children:"No order data available."})})})]})}),B&&l("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-6",onClick:()=>{ee(!1),R(null)},children:h("div",{className:"bg-white rounded-3xl shadow-2xl p-8 max-w-6xl w-full max-h-[95vh] overflow-y-auto relative modal-scrollbar",onClick:de=>de.stopPropagation(),children:[l("button",{className:"absolute top-6 right-6 text-gray-500 hover:text-gray-800 z-10 text-2xl font-bold",onClick:()=>{ee(!1),R(null)},children:"Ã—"}),l("h3",{className:"text-2xl font-bold mb-6 text-gray-800",children:le?"Edit Order":"Create Order"}),l(Gfe,{user:t,inventory:i,categories:v,editingOrder:le,onCancel:()=>{ee(!1),R(null)},onCreated:()=>{ee(!1),R(null),tt(`${ke}/index.php?endpoint=orders`).then(de=>de.json()).then(de=>{de&&de.success&&c(de.data||[])}).catch(()=>{})}})]})})]}),Te=de=>l("div",{children:l(eu,{...de})}),je=de=>l("div",{children:l(kN,{...de})}),ze=()=>{switch(n){case"employee-dashboard":return l(ce,{});case"inventory":return t.can_access_inventory===0||t.can_access_inventory==="0"||t.can_access_inventory===!1||t.can_access_inventory==="false"?h("div",{className:"bg-yellow-100 border border-yellow-300 text-yellow-800 px-6 py-4 rounded-2xl text-center max-w-lg mx-auto mt-24",children:[l("h2",{className:"text-2xl font-bold mb-2",children:"Inventory Access Disabled"}),l("p",{className:"text-lg",children:"Your access to Inventory Management has been disabled by a Super Admin. If you believe this is a mistake, please contact your administrator."})]}):l(M,{});case"orders-management":return t.can_access_orders===0||t.can_access_orders==="0"||t.can_access_orders===!1||t.can_access_orders==="false"?h("div",{className:"bg-yellow-100 border border-yellow-300 text-yellow-800 px-6 py-4 rounded-2xl text-center max-w-lg mx-auto mt-24",children:[l("h2",{className:"text-2xl font-bold mb-2",children:"Orders Access Disabled"}),l("p",{className:"text-lg",children:"Your access to Orders Management has been disabled by a Super Admin. If you believe this is a mistake, please contact your administrator."})]}):l(Le,{});case"admin-chat-support":return t.can_access_chat_support===0||t.can_access_chat_support==="0"||t.can_access_chat_support===!1||t.can_access_chat_support==="false"?h("div",{className:"bg-yellow-100 border border-yellow-300 text-yellow-800 px-6 py-4 rounded-2xl text-center max-w-lg mx-auto mt-24",children:[l("h2",{className:"text-2xl font-bold mb-2",children:"Chat Support Access Disabled"}),l("p",{className:"text-lg",children:"Your access to Chat Support Management has been disabled by a Super Admin. If you believe this is a mistake, please contact your administrator."})]}):l(Tc,{user:t,fullScreen:!0});case"notifications":return l(rm,{user:t});case"pc-assembly":return l(Te,{user:t});case"prebuilt-management":return l(je,{user:t});case"sales-reports":return l(eF,{reports:u,orders:o});case"system-reports":return l(SN,{reports:u,inventory:i,categories:v,formalCategoryNames:ty});default:return l(ce,{})}};return N.useEffect(()=>{localStorage.getItem("token")||(window.location.href="/")},[]),N.useEffect(()=>{const $e=setTimeout(async()=>{try{if(!await gr())return;const Fe=await tt(`${ke}/index.php?endpoint=profile`,{method:"GET",suppressUnauthorizedEvent:!0});if(Fe.status===401)return;const Me=await Fe.json().catch(()=>({}));Me.success&&Me.user&&r&&r(Me.user)}catch(Re){console.error("EmployeeDashboard: Error fetching profile:",Re)}},500);return()=>clearTimeout($e)},[n,r]),N.useEffect(()=>{const de=setInterval(async()=>{try{if(!await gr())return;const Re=await tt(`${ke}/index.php?endpoint=profile`,{method:"GET",suppressUnauthorizedEvent:!0});if(Re.status===401)return;const Fe=await Re.json().catch(()=>({}));Fe.success&&Fe.user&&(typeof W<"u"&&Fe.user.can_access_inventory!==W&&window.location.reload(),r&&r(Fe.user))}catch($e){console.error("EmployeeDashboard: Error in profile interval fetch:",$e)}},3e4);return()=>clearInterval(de)},[r,W]),t?t.can_access_inventory===0&&n==="inventory"?l("div",{className:"flex flex-col items-center justify-center h-full",children:h("div",{className:"bg-yellow-100 border border-yellow-300 text-yellow-800 px-6 py-4 rounded-2xl text-center max-w-lg mx-auto",children:[l("h2",{className:"text-2xl font-bold mb-2",children:"Inventory Access Disabled"}),l("p",{className:"text-lg",children:"Your access to Inventory Management has been disabled by a Super Admin. If you believe this is a mistake, please contact your administrator."})]})}):n==="admin-chat-support"?l(gt,{children:ze()}):l("div",{className:"p-4 sm:p-6 lg:p-8",children:f?l("div",{className:"flex items-center justify-center h-64",children:l("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):p?l("div",{className:"text-center text-red-600 py-8",children:p}):ze()}):l("div",{className:"flex items-center justify-center h-screen",children:l("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})};function Gfe({user:e,inventory:t=[],categories:r=[],editingOrder:n=null,onCancel:a=()=>{},onCreated:i=()=>{}}){const[s,o]=ft.useState([]),[c,u]=ft.useState("pending"),[d,f]=ft.useState(!1),[m,p]=ft.useState(""),[x,g]=ft.useState(""),[y,v]=ft.useState(""),[b,w]=ft.useState(""),k=()=>o(E=>[...E,{component_id:"",quantity:1}]),S=(E,A)=>o(T=>T.map((D,I)=>I===E?{...D,...A}:D)),_=E=>o(A=>A.filter((T,D)=>D!==E));return ft.useEffect(()=>{s.length===0&&k()},[]),ft.useEffect(()=>{if(n){if(u(n.status||"pending"),p(n.notes||""),g(n.purchase_date||""),v(n.customer_name||""),w(n.customer_phone||""),!n.id){console.error("Cannot fetch order details: order ID is missing",n),alert("Error: Order ID is missing. Cannot load order details."),o([{component_id:"",quantity:1}]);return}(async()=>{try{const A=`${ke}/index.php?endpoint=orders&id=${n.id}`;console.log("Fetching order details from:",A);const T=await tt(A);if(!T.ok){const I=await T.text();let z;try{z=JSON.parse(I)}catch{z={error:I||`HTTP ${T.status}`}}console.error("Failed to fetch order details:",T.status,z),alert(`Failed to load order details: ${z.error||`HTTP ${T.status}`}`),o([{component_id:"",quantity:1}]);return}const D=await T.json();if(D.success&&D.data){if(D.data.items&&Array.isArray(D.data.items)&&D.data.items.length>0){const I=D.data.items.map(z=>({component_id:z.component_id?z.component_id.toString():"",quantity:z.quantity||1}));o(I)}else console.warn("Order found but has no items"),o([{component_id:"",quantity:1}]);v(D.data.customer_name||""),w(D.data.customer_phone||"")}else console.error("API returned unsuccessful response:",D),alert(`Failed to load order: ${D.error||"Unknown error"}`),o([{component_id:"",quantity:1}])}catch(A){console.error("Error fetching order details:",A),alert(`Error loading order details: ${A.message||"Network error"}`),o([{component_id:"",quantity:1}])}})()}else o([{component_id:"",quantity:1}]),u("pending"),p(""),g("")},[n]),h("form",{onSubmit:async E=>{if(E.preventDefault(),!Array.isArray(s)||s.length===0)return;if(s.filter(D=>!D.component_id||D.component_id==="").length>0){alert('Please select a component for all items or remove empty slots using the "Remove" button.');return}if(!x){alert("Please select a purchase date.");return}if(b&&!/^63\d{10}$/.test(String(b).replace(/[^\d]/g,""))){alert("Customer phone must start with 63 followed by 10 digits.");return}const T=s.filter(D=>D.component_id&&Number(D.quantity)>0).map(D=>({component_id:Number(D.component_id),quantity:Number(D.quantity)}));if(T.length!==0){f(!0);try{const D=!!n,I=D?`${ke}/index.php?endpoint=orders&id=${n.id}`:`${ke}/index.php?endpoint=orders`,X=await tt(I,{method:D?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:T,status:c,notes:m?String(m).toUpperCase():void 0,purchase_date:x,customer_name:y||void 0,customer_phone:b||void 0})}),H=await X.json().catch(()=>({}));!X.ok||!H.success?alert(H.error||`Failed to ${D?"update":"create"} order`):i(H.order_id||(n==null?void 0:n.id))}catch(D){console.error(D),alert("Network error creating order")}finally{f(!1)}}},className:"space-y-8",children:[h("div",{className:"bg-gray-50 rounded-2xl p-6",children:[l("h4",{className:"text-lg font-semibold text-gray-800 mb-6",children:"Component Selection"}),h("div",{className:"space-y-6",children:[s.map((E,A)=>l("div",{className:`bg-white rounded-xl p-6 shadow-sm border-2 ${!E.component_id||E.component_id===""?"border-red-200 bg-red-50":"border-gray-200"}`,children:h("div",{className:"grid grid-cols-12 gap-4 items-end",children:[h("div",{className:"col-span-7",children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Component"}),l(_N,{value:E.component_id,onChange:T=>S(A,{component_id:T}),inventory:t,categories:r,placeholder:"Search components...",className:`w-full ${!E.component_id||E.component_id===""?"border-red-300":""}`}),(!E.component_id||E.component_id==="")&&l("p",{className:"text-red-600 text-sm mt-2 font-medium",children:"Please select a component or remove this item"})]}),h("div",{className:"col-span-3",children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Quantity"}),l("input",{type:"number",min:1,className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",value:E.quantity,onChange:T=>S(A,{quantity:T.target.value})})]}),l("div",{className:"col-span-2 flex justify-end",children:l("button",{type:"button",className:"text-red-600 hover:text-red-800 font-semibold text-sm py-3 px-4 border-2 border-red-300 rounded-lg hover:bg-red-50 transition-colors whitespace-nowrap",onClick:()=>_(A),children:"Remove"})})]})},A)),h("button",{type:"button",className:"w-full text-indigo-600 hover:text-indigo-800 font-semibold flex items-center justify-center gap-3 py-4 px-6 border-2 border-dashed border-indigo-300 rounded-xl hover:bg-indigo-50 transition-colors",onClick:k,children:[l(wn,{className:"h-5 w-5"}),"Add Another Component"]})]})]}),h("div",{className:"bg-gray-50 rounded-2xl p-6",children:[l("h4",{className:"text-lg font-semibold text-gray-800 mb-6",children:"Order Details"}),h("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[h("div",{children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Status"}),h("select",{className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",value:c,onChange:E=>u(E.target.value),children:[l("option",{value:"Pending",children:"Pending"}),l("option",{value:"Processing",children:"Processing"}),l("option",{value:"Completed",children:"Completed"}),l("option",{value:"Cancelled",children:"Cancelled"})]})]}),h("div",{children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Purchase Date *"}),l("input",{type:"date",className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",value:x,onChange:E=>g(E.target.value),required:!0})]}),h("div",{children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Notes (COMMENTS)"}),l("input",{className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",value:m,onChange:E=>p(E.target.value),placeholder:"OPTIONAL"})]})]}),h("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6",children:[h("div",{children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Customer Full Name"}),l("input",{className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",value:y,onChange:E=>v(E.target.value),placeholder:"Juan Dela Cruz"})]}),h("div",{children:[l("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Customer Contact Number"}),l("input",{className:"w-full border-2 border-gray-300 rounded-lg px-4 py-3 text-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors",value:b,onChange:E=>w(E.target.value),placeholder:"639XXXXXXXXX"}),l("p",{className:"text-xs text-gray-500 mt-1",children:"PH format: 63 + 10 digits"})]})]})]}),h("div",{className:"flex justify-end gap-4 pt-6 border-t-2 border-gray-200",children:[l("button",{type:"button",onClick:a,className:"px-8 py-3 border-2 border-gray-300 rounded-xl hover:bg-gray-50 transition-colors font-semibold text-gray-700",children:"Cancel"}),l("button",{type:"submit",className:"px-8 py-3 bg-indigo-600 text-white rounded-xl hover:bg-indigo-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-semibold text-lg",disabled:d,children:d?n?"Updating...":"Creating...":n?"Update Order":"Create Order"})]})]})}function Vfe({item:e={},categories:t=[],onCancel:r=()=>{},onSave:n=()=>{}}){const[a,i]=ft.useState({id:e.id||null,name:e.name||"",brand:e.brand||"",price:e.price||0,stock_quantity:e.stock_quantity??e.stock??0,category_id:e.category_id||t[0]&&t[0].id||"",image_url:e.image_url||""}),[s,o]=ft.useState(!1),[c,u]=ft.useState({BULACAN:"",MARIKINA:""}),[d,f]=ft.useState(!1),m=ft.useRef(null),[p,x]=ft.useState(null),[g,y]=ft.useState(null),v=(k,S)=>{k==="image_url"&&y(null),i(_=>({..._,[k]:S}))},b=async k=>{const S=k.target.files&&k.target.files[0];if(!S)return;if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(S.type)){y("Invalid file type. Please select a JPEG, PNG, GIF, or WebP image.");return}const C=5*1024*1024;if(S.size>C){y("File too large. Maximum size is 5MB.");return}y(null);try{const E=new FileReader;E.onload=A=>{const T=A.target.result;v("image_url",T);const D=new Image;D.onload=()=>{x({sizeBytes:S.size,width:D.naturalWidth,height:D.naturalHeight})},D.onerror=()=>{x({sizeBytes:S.size,width:null,height:null})},D.src=T},E.onerror=()=>{y("Error reading file. Please try again.")},E.readAsDataURL(S)}catch(E){console.error("File conversion error:",E),y("Error processing file. Please try again.")}};return h("form",{onSubmit:async k=>{k.preventDefault(),o(!0);try{let S=a.image_url;if(S&&S.startsWith("blob:"))try{const ie=await(await fetch(S)).blob();S=await new Promise((B,ee)=>{const le=new FileReader;le.onload=()=>B(le.result),le.onerror=ee,le.readAsDataURL(ie)})}catch{console.warn("Could not convert blob URL, clearing image"),S=null}const _=a.id?"update_component":"create_component",C={...a,image_url:S},A=await(await tt(`${ke}/index.php?endpoint=${_}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)})).json();if(!A.success){alert(A.error||"Save failed"),o(!1);return}let T=A.data||{...a,id:a.id||A.data&&A.data.id};const D=T.id||a.id,I={"Content-Type":"application/json",Authorization:`Bearer ${token}`},z=W=>W===""||W===null||W===void 0?null:parseInt(W,10),X=z(c.BULACAN),H=z(c.MARIKINA),L=[];if(D&&(X!==null&&!Number.isNaN(X)&&L.push(fetch(`${ke}/update_component_stock.php`,{method:"POST",headers:I,body:JSON.stringify({component_id:D,branch:"BULACAN",stock_quantity:X})})),H!==null&&!Number.isNaN(H)&&L.push(fetch(`${ke}/update_component_stock.php`,{method:"POST",headers:I,body:JSON.stringify({component_id:D,branch:"MARIKINA",stock_quantity:H})}))),L.length){await Promise.allSettled(L);const W=(Number.isFinite(X)?X:0)+(Number.isFinite(H)?H:0);T={...T,stock_quantity:W}}n(T)}catch(S){console.error(S),alert("Error saving item")}finally{o(!1)}},className:"space-y-4",children:[h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),l("input",{required:!0,value:a.name,onChange:k=>v("name",k.target.value),className:"mt-1 block w-full border rounded px-3 py-2"})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Brand"}),l("input",{value:a.brand,onChange:k=>v("brand",k.target.value),className:"mt-1 block w-full border rounded px-3 py-2"})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Image"}),h("div",{className:"flex items-center gap-3",children:[l("input",{type:"text",placeholder:"Image URL (optional)",value:a.image_url&&!a.image_url.startsWith("data:")?a.image_url:"",onChange:k=>v("image_url",k.target.value),className:"mt-1 block w-full border rounded px-3 py-2"}),l("input",{ref:m,type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif,image/webp",onChange:b,className:"mt-1"})]}),g&&l("div",{className:"mt-2 text-xs text-red-600",children:g}),l("div",{className:"mt-2",children:a.image_url?h("div",{className:"flex items-center gap-3",children:[l("img",{src:a.image_url,alt:"Preview",className:"w-20 h-20 object-contain border rounded",onError:k=>{k.currentTarget.style.display="none"}}),p&&h("span",{className:"text-xs text-gray-600",children:[p.width&&p.height?`${p.width}Ã—${p.height} px, `:"",(p.sizeBytes/1024).toFixed(1)," KB"]})]}):l("span",{className:"text-xs text-gray-500",children:"Optional: provide a URL or pick a file"})})]}),h("div",{className:"grid grid-cols-2 gap-4",children:[h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Price"}),l("input",{type:"number",step:"0.01",value:a.price,onChange:k=>v("price",k.target.value),className:"mt-1 block w-full border rounded px-3 py-2"})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Stock Quantity"}),l("input",{type:"number",value:a.stock_quantity,onChange:k=>v("stock_quantity",k.target.value),className:"mt-1 block w-full border rounded px-3 py-2"})]})]}),a.id&&h("div",{className:"grid grid-cols-2 gap-4",children:[h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Bulacan Stock"}),l("input",{type:"number",value:c.BULACAN,onChange:k=>u(S=>({...S,BULACAN:k.target.value})),className:"mt-1 block w-full border rounded px-3 py-2",disabled:d})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Marikina Stock"}),l("input",{type:"number",value:c.MARIKINA,onChange:k=>u(S=>({...S,MARIKINA:k.target.value})),className:"mt-1 block w-full border rounded px-3 py-2",disabled:d})]})]}),h("div",{children:[l("label",{className:"block text-sm font-medium text-gray-700",children:"Category"}),l("select",{value:a.category_id,onChange:k=>v("category_id",k.target.value),className:"mt-1 block w-full border rounded px-3 py-2",children:t.map(k=>l("option",{value:k.id,children:k.name},k.id))})]}),h("div",{className:"flex justify-end gap-2",children:[l("button",{type:"button",onClick:r,className:"px-4 py-2 border rounded",children:"Cancel"}),l("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded",disabled:s,children:s?"Saving...":"Save"})]})]})}const Kfe=()=>{const[e,t]=N.useState([]),[r,n]=N.useState(""),a=N.useRef(null),i=N.useRef(null);N.useEffect(()=>{const c=[];for(let u=1;u<=20;u++)c.push({id:u,message:`This is test message number ${u}. This message is long enough to test scrolling functionality. It should wrap to multiple lines and create enough content to make the scroll bar appear.`,sender:u%2===0?"user":"support",sent_at:new Date(Date.now()-(20-u)*6e4).toISOString()});t(c)},[]),N.useEffect(()=>{var c;if(i.current){const u=i.current;u.scrollHeight-u.scrollTop<=u.clientHeight+100&&((c=a.current)==null||c.scrollIntoView({behavior:"smooth"}))}},[e]);const s=()=>{if(!r.trim())return;const c={id:e.length+1,message:r,sender:"user",sent_at:new Date().toISOString()};t([...e,c]),n("")},o=c=>new Date(c).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return h("div",{className:"flex flex-col h-full bg-white rounded-lg shadow-sm overflow-hidden",children:[l("div",{className:"bg-white border-b border-gray-200 p-4 flex-shrink-0",children:l("div",{className:"flex items-center justify-between",children:h("div",{className:"flex items-center gap-3",children:[l("div",{className:"w-10 h-10 rounded-full bg-green-600 flex items-center justify-center text-white",children:l("span",{className:"text-sm font-bold",children:"T"})}),h("div",{children:[l("h3",{className:"font-semibold text-gray-900",children:"Scroll Test"}),l("p",{className:"text-xs text-gray-500",children:"Testing scroll functionality"})]})]})})}),h("div",{ref:i,className:"flex-1 overflow-y-auto overflow-x-hidden p-4 space-y-3 chat-messages-container",style:{minHeight:"0",maxHeight:"calc(100vh - 200px)",scrollbarWidth:"thin",scrollbarColor:"#9ca3af #f1f5f9"},children:[e.map(c=>l("div",{className:`flex ${c.sender==="user"?"justify-end":"justify-start"}`,children:h("div",{className:`max-w-[80%] rounded-xl px-4 py-2 ${c.sender==="user"?"bg-green-600 text-white rounded-br-none":"bg-gray-100 text-gray-800 rounded-bl-none"}`,children:[l("div",{className:"text-sm whitespace-pre-wrap break-words",children:c.message}),l("div",{className:`text-xs mt-1 text-right ${c.sender==="user"?"text-green-200":"text-gray-500"}`,children:o(c.sent_at)})]})},c.id)),l("div",{ref:a,className:"min-h-[1px]"})]}),l("div",{className:"border-t border-gray-200 p-3 bg-white flex-shrink-0",children:h("div",{className:"flex gap-2",children:[l("input",{type:"text",className:"flex-1 p-2 border rounded-lg focus:outline-none focus:ring-1 focus:ring-green-500 focus:border-green-500",placeholder:"Type your message...",value:r,onChange:c=>n(c.target.value),onKeyDown:c=>c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),s())}),l("button",{onClick:s,disabled:!r.trim(),className:`p-2 rounded-lg ${r.trim()?"bg-green-600 text-white hover:bg-green-700":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,title:"Send message",children:l(yu,{className:"w-5 h-5"})})]})})]})},y4=()=>l("div",{className:"min-h-screen bg-gray-100 p-8",children:h("div",{className:"max-w-4xl mx-auto",children:[l("h1",{className:"text-3xl font-bold text-gray-800 mb-8",children:"Chat Scroll Bar Test"}),h("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[h("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[l("h2",{className:"text-xl font-semibold mb-4",children:"Scroll Test Component"}),l("div",{className:"h-96",children:l(Kfe,{})})]}),h("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[l("h2",{className:"text-xl font-semibold mb-4",children:"Manual Scroll Test"}),l("div",{className:"h-96 overflow-y-scroll chat-messages-container border border-gray-200 rounded-lg p-4",style:{scrollbarWidth:"thin",scrollbarColor:"#9ca3af #f1f5f9"},children:Array.from({length:50},(e,t)=>h("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[h("div",{className:"font-medium text-gray-800",children:["Message ",t+1]}),l("div",{className:"text-sm text-gray-600 mt-1",children:"This is a test message to verify scroll bar functionality. This message is long enough to wrap to multiple lines and create enough content to make the scroll bar appear."}),l("div",{className:"text-xs text-gray-400 mt-2",children:new Date(Date.now()-t*6e4).toLocaleTimeString()})]},t))})]})]}),h("div",{className:"mt-8 bg-white rounded-lg shadow-lg p-6",children:[l("h2",{className:"text-xl font-semibold mb-4",children:"Scroll Bar Status"}),h("div",{className:"space-y-2 text-sm",children:[h("div",{className:"flex items-center gap-2",children:[l("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),l("span",{children:"Scroll bar should be visible on the right side"})]}),h("div",{className:"flex items-center gap-2",children:[l("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),l("span",{children:"Scroll bar should be gray with rounded corners"})]}),h("div",{className:"flex items-center gap-2",children:[l("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),l("span",{children:"You should be able to scroll up and down"})]}),h("div",{className:"flex items-center gap-2",children:[l("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),l("span",{children:"Auto-scroll should work when new messages arrive"})]})]})]})]})}),v4=({setCurrentPage:e})=>h("div",{className:"min-h-screen bg-gray-50",children:[l("div",{className:"bg-white shadow-sm",children:l("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:h("div",{className:"flex items-center justify-between h-16",children:[h("button",{onClick:()=>e("home"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[l(Tf,{className:"w-5 h-5"}),"Back to Home"]}),l("h1",{className:"text-2xl font-bold text-gray-900",children:"About SIMS"}),l("div",{})]})})}),h("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[h("div",{className:"text-center mb-16",children:[l("h2",{className:"text-4xl font-bold text-gray-900 mb-6",children:"About SIMS"}),l("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"SIMS (System Inventory Management System) is a comprehensive PC building platform designed to make computer assembly accessible, reliable, and enjoyable for everyone."})]}),h("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-16",children:[h("div",{className:"bg-white rounded-lg shadow-sm p-8",children:[h("div",{className:"flex items-center gap-3 mb-4",children:[l(HT,{className:"w-8 h-8 text-green-600"}),l("h3",{className:"text-2xl font-semibold text-gray-900",children:"Our Mission"})]}),l("p",{className:"text-gray-600 leading-relaxed",children:"To democratize PC building by providing an intuitive platform that eliminates compatibility concerns and makes custom computer assembly accessible to users of all technical skill levels."})]}),h("div",{className:"bg-white rounded-lg shadow-sm p-8",children:[h("div",{className:"flex items-center gap-3 mb-4",children:[l(Yh,{className:"w-8 h-8 text-green-600"}),l("h3",{className:"text-2xl font-semibold text-gray-900",children:"Our Vision"})]}),l("p",{className:"text-gray-600 leading-relaxed",children:"To become the leading platform for PC building education and component compatibility, empowering users to build their dream computers with confidence."})]})]}),h("div",{className:"mb-16",children:[l("h3",{className:"text-3xl font-bold text-gray-900 text-center mb-12",children:"What Makes SIMS Special"}),h("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[h("div",{className:"text-center",children:[l("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l(Df,{className:"w-8 h-8 text-green-600"})}),l("h4",{className:"text-xl font-semibold text-gray-900 mb-3",children:"User-Friendly"}),l("p",{className:"text-gray-600",children:"Intuitive interface designed for both beginners and experts"})]}),h("div",{className:"text-center",children:[l("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l(Yh,{className:"w-8 h-8 text-green-600"})}),l("h4",{className:"text-xl font-semibold text-gray-900 mb-3",children:"Reliable"}),l("p",{className:"text-gray-600",children:"Advanced compatibility checking ensures your build will work"})]}),h("div",{className:"text-center",children:[l("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l(G8,{className:"w-8 h-8 text-green-600"})}),l("h4",{className:"text-xl font-semibold text-gray-900 mb-3",children:"Community-Driven"}),l("p",{className:"text-gray-600",children:"Built by PC enthusiasts, for PC enthusiasts"})]})]})]}),h("div",{className:"bg-white rounded-lg shadow-sm p-8",children:[l("h3",{className:"text-3xl font-bold text-gray-900 text-center mb-8",children:"Our Team"}),l("p",{className:"text-gray-600 text-center max-w-2xl mx-auto",children:"SIMS is developed by a passionate team of computer science students and PC building enthusiasts who understand the challenges of building custom computers. We're committed to making PC building accessible and enjoyable for everyone."})]}),l("div",{className:"text-center mt-12",children:l("button",{onClick:()=>e("pc-assembly"),className:"bg-green-600 text-white px-8 py-3 rounded-lg font-semibold text-lg hover:bg-green-700 transition-colors",children:"Start Building Your PC"})})]})]}),CN=()=>"6LfVeQAsAAAAAMqw5OZ0mbNLGTBXtrWydNCW30VC";let mr=null;const EN=()=>{if(typeof window>"u"||typeof document>"u"||window.grecaptcha)return Promise.resolve();if(mr)return mr;const e=document.querySelector('script[src*="recaptcha"]');if(e)return mr=new Promise(r=>{if(window.grecaptcha)mr=null,r();else{const n=setInterval(()=>{window.grecaptcha&&(clearInterval(n),mr=null,r())},100);e.onload=()=>{clearInterval(n),mr=null,r()}}}),mr;const t=CN();return console.log("[reCAPTCHA] Loading v2 script with Site Key:",`${t.substring(0,10)}...`),mr=new Promise((r,n)=>{const a=`onRecaptchaLoad_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;let i=!1,s=!1;window[a]=()=>{if(i){console.log("[reCAPTCHA] Callback already called, ignoring duplicate call");return}i=!0,console.log("[reCAPTCHA] v2 Script loaded and ready via callback"),setTimeout(()=>{window[a]&&delete window[a]},1e4),s||(s=!0,mr&&(mr=null),r())},setTimeout(()=>{const o=document.createElement("script");o.src=`https://www.google.com/recaptcha/api.js?render=explicit&onload=${a}`,o.async=!0,o.defer=!0,o.onload=()=>{const c=setInterval(()=>{if(window.grecaptcha)if(clearInterval(c),console.log("[reCAPTCHA] Successfully initialized!"),!i&&window[a]&&typeof window[a]=="function")try{window[a]()}catch(u){console.error("[reCAPTCHA] Error calling callback:",u),s||(s=!0,mr&&(mr=null),r())}else i||console.warn("[reCAPTCHA] Callback not found but grecaptcha is ready"),s||(s=!0,mr&&(mr=null),r())},100);setTimeout(()=>{if(clearInterval(c),window.grecaptcha)if(console.log("[reCAPTCHA] Successfully initialized (timeout)!"),!i&&window[a]&&typeof window[a]=="function")try{window[a]()}catch(u){console.error("[reCAPTCHA] Error calling callback (timeout):",u),s||(s=!0,mr&&(mr=null),r())}else s||(s=!0,mr&&(mr=null),r());else console.error("[reCAPTCHA] Failed to initialize - grecaptcha not ready after 5 seconds"),window[a]&&delete window[a],mr=null,n(new Error("reCAPTCHA failed to load"))},5e3)},o.onerror=c=>{console.error("[reCAPTCHA] Script loading error:",c),window[a]&&delete window[a],mr=null,n(c)},document.head.appendChild(o),console.log("[reCAPTCHA] Script tag added to document head with callback:",a)},0)}),mr},tF=(e,t,r={})=>{if(!window.grecaptcha)throw new Error("reCAPTCHA is not initialized. Call initializeRecaptcha() first.");if(!window.grecaptcha.render||typeof window.grecaptcha.render!="function")throw new Error("reCAPTCHA render method is not available. Wait for script to fully load.");const a={sitekey:CN(),callback:t,"expired-callback":r["expired-callback"]||(()=>{console.log("[reCAPTCHA] Token expired")}),"error-callback":r["error-callback"]||(()=>{console.error("[reCAPTCHA] Error occurred")}),theme:r.theme||"light",size:r.size||"normal"};return window.grecaptcha.render(e,a)},rF=e=>window.grecaptcha?window.grecaptcha.getResponse(e):null,hs=e=>{window.grecaptcha&&e!==null&&e!==void 0&&window.grecaptcha.reset(e)},qfe=async(e="submit")=>{console.warn("[reCAPTCHA] executeRecaptcha is deprecated. Use renderRecaptcha for v2.");try{if(await EN(),!window.grecaptcha)throw new Error("reCAPTCHA is not ready");return null}catch(t){throw console.error("reCAPTCHA initialization error:",t),t}},gn=()=>{const e=CN(),t=e.trim()!=="";return typeof window<"u"&&console.log("[reCAPTCHA] Configuration check:",{siteKey:`${e.substring(0,10)}...`,isConfigured:t,envVar:`${"6LfVeQAsAAAAAMqw5OZ0mbNLGTBXtrWydNCW30VC".substring(0,10)}...`,windowKey:window.RECAPTCHA_SITE_KEY?`${window.RECAPTCHA_SITE_KEY.substring(0,10)}...`:"NOT SET"}),t},b4=({setCurrentPage:e})=>{const[t,r]=N.useState({name:"",email:"",subject:"",message:""}),[n,a]=N.useState(!1),[i,s]=N.useState(null),o=async u=>{u.preventDefault(),a(!0),s(null);try{let d=null;if(gn())try{d=await qfe("contact")}catch(x){console.error("reCAPTCHA error:",x)}const f={...t};d&&(f.recaptcha_token=d);const p=await(await fetch(`${ke}/submit_feedback.php`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)})).json();p.success?(s("success"),r({name:"",email:"",subject:"",message:""}),setTimeout(()=>s(null),5e3)):(s("error"),console.error("Contact form error:",p.error))}catch(d){console.error("Contact form error:",d),s("error")}finally{a(!1)}},c=u=>{r({...t,[u.target.name]:u.target.value})};return h("div",{className:"min-h-screen bg-gray-50",children:[l("div",{className:"bg-white shadow-sm",children:l("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:h("div",{className:"flex items-center justify-between h-16",children:[h("button",{onClick:()=>e("home"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[l(Tf,{className:"w-5 h-5"}),"Back to Home"]}),l("h1",{className:"text-2xl font-bold text-gray-900",children:"Contact Us"}),l("div",{})]})})}),h("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[h("div",{className:"text-center mb-12",children:[l("h2",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Get in Touch"}),l("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Have questions about SIMS? Need help with your PC build? We're here to help you every step of the way."})]}),h("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12",children:[h("div",{className:"space-y-8",children:[h("div",{children:[l("h3",{className:"text-2xl font-semibold text-gray-900 mb-6",children:"Contact Information"}),h("div",{className:"space-y-6",children:[h("div",{className:"flex items-start gap-4",children:[l("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0",children:l(X8,{className:"w-6 h-6 text-green-600"})}),h("div",{children:[l("h4",{className:"font-semibold text-gray-900",children:"Email"}),l("p",{className:"text-gray-600",children:"support@builditpc.com"}),l("p",{className:"text-gray-600",children:"info@builditpc.com"})]})]}),h("div",{className:"flex items-start gap-4",children:[l("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0",children:l(eL,{className:"w-6 h-6 text-green-600"})}),h("div",{children:[l("h4",{className:"font-semibold text-gray-900",children:"Phone"}),l("p",{className:"text-gray-600",children:"+63 912 345 6789"}),l("p",{className:"text-gray-600",children:"Mon-Fri: 9AM-6PM (PST)"})]})]}),h("div",{className:"flex items-start gap-4",children:[l("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0",children:l(Y8,{className:"w-6 h-6 text-green-600"})}),h("div",{children:[l("h4",{className:"font-semibold text-gray-900",children:"Address"}),l("p",{className:"text-gray-600",children:"Ground flr JSP Bldg. 9109 National rd. Cay Pombo, Santa Maria, Philippines"}),l("p",{className:"text-gray-600",children:"SIMS Development Center"})]})]})]})]}),h("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[l("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Help"}),h("div",{className:"space-y-2",children:[l("button",{onClick:()=>e("faq"),className:"block w-full text-left text-green-600 hover:text-green-700 transition-colors",children:"â†’ Frequently Asked Questions"}),l("button",{onClick:()=>e("compatibility-guide"),className:"block w-full text-left text-green-600 hover:text-green-700 transition-colors",children:"â†’ Compatibility Guide"}),l("button",{onClick:()=>e("troubleshooting"),className:"block w-full text-left text-green-600 hover:text-green-700 transition-colors",children:"â†’ Troubleshooting Guide"})]})]})]}),h("div",{className:"bg-white rounded-lg shadow-sm p-8",children:[l("h3",{className:"text-2xl font-semibold text-gray-900 mb-6",children:"Send us a Message"}),i==="success"&&h("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:[h("div",{className:"flex items-center gap-2",children:[l("div",{className:"w-5 h-5 bg-green-100 rounded-full flex items-center justify-center",children:l("span",{className:"text-green-600 text-sm",children:"âœ“"})}),l("p",{className:"text-green-800 font-medium",children:"Message sent successfully!"})]}),l("p",{className:"text-green-700 text-sm mt-1",children:"Thank you for your message. We will get back to you soon."})]}),i==="error"&&h("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:[h("div",{className:"flex items-center gap-2",children:[l("div",{className:"w-5 h-5 bg-red-100 rounded-full flex items-center justify-center",children:l("span",{className:"text-red-600 text-sm",children:"âœ—"})}),l("p",{className:"text-red-800 font-medium",children:"Failed to send message"})]}),l("p",{className:"text-red-700 text-sm mt-1",children:"Please try again later or contact us directly."})]}),h("form",{onSubmit:o,className:"space-y-6",children:[h("div",{children:[l("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name *"}),l("input",{type:"text",id:"name",name:"name",value:t.name,onChange:c,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Your full name"})]}),h("div",{children:[l("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address *"}),l("input",{type:"email",id:"email",name:"email",value:t.email,onChange:c,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"your.email@example.com"})]}),h("div",{children:[l("label",{htmlFor:"subject",className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject *"}),h("select",{id:"subject",name:"subject",value:t.subject,onChange:c,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[l("option",{value:"",children:"Select a subject"}),l("option",{value:"general",children:"General Inquiry"}),l("option",{value:"technical",children:"Technical Support"}),l("option",{value:"billing",children:"Billing Question"}),l("option",{value:"feature",children:"Feature Request"}),l("option",{value:"bug",children:"Bug Report"}),l("option",{value:"other",children:"Other"})]})]}),h("div",{children:[l("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700 mb-2",children:"Message *"}),l("textarea",{id:"message",name:"message",value:t.message,onChange:c,required:!0,rows:"5",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none",placeholder:"Tell us how we can help you..."})]}),l("button",{type:"submit",disabled:n,className:"w-full bg-green-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-green-700 transition-colors flex items-center justify-center gap-2 disabled:bg-gray-400 disabled:cursor-not-allowed",children:n?h(gt,{children:[l("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Sending..."]}):h(gt,{children:[l(yu,{className:"w-5 h-5"}),"Send Message"]})})]})]})]})]})]})},w4=({setCurrentPage:e})=>{const[t,r]=N.useState(null),[n,a]=N.useState(""),s=[{id:1,question:"How does SIMS's compatibility checker work?",answer:"Our advanced compatibility checker uses a sophisticated algorithm that analyzes multiple aspects of your selected components in real-time. It checks CPU socket compatibility with motherboards (ensuring AM5 CPUs work with AM5 motherboards, LGA1700 with LGA1700, etc.), validates RAM type matching (DDR4 vs DDR5), calculates power supply wattage requirements based on component TDP ratings, and verifies case form factor compatibility. The system also considers physical dimensions, cooling requirements, and expansion slot availability. When you select components, the checker immediately updates the compatibility score and provides specific feedback on any issues, helping you make informed decisions before purchasing.",category:"Compatibility"},{id:2,question:"Can I save my PC build for later?",answer:"Currently, SIMS operates as a real-time building and compatibility checking platform. While we don't have a persistent save feature yet, you can easily recreate your build by selecting the same components from our comprehensive database. We're actively developing build saving, sharing, and export features that will allow you to save multiple builds, share them with friends, export parts lists to retailers, and even receive notifications when component prices change. These features will be available in upcoming updates, making it easier to plan and compare different build configurations over time.",category:"Features"},{id:3,question:"Are the component prices on SIMS accurate?",answer:"The prices shown on SIMS are carefully researched market prices in Philippine Peso (â‚±) based on current retail data from major Philippine retailers and online marketplaces. However, actual prices may vary due to factors like regional availability, seasonal fluctuations, import duties, and retailer-specific promotions. We recommend using our prices as a baseline for budgeting and comparison, then checking with local retailers like PCHub, DynaQuest, EasyPC, or online platforms like Lazada and Shopee for the most current pricing. Our price estimates are updated regularly to reflect market trends and new product releases.",category:"Pricing"},{id:4,question:"How often is the component database updated?",answer:"Our component database is continuously updated through multiple channels. We add new CPU and GPU releases within 24-48 hours of their official announcement, update motherboard specifications as manufacturers release new models, and refresh pricing data weekly. Our team monitors major tech announcements, manufacturer websites, and retailer catalogs to ensure comprehensive coverage. We also update component specifications, compatibility rules, and performance benchmarks based on the latest reviews and testing data. This ensures you always have access to the most current information when making your build decisions, including the latest Intel 14th gen, AMD Ryzen 7000 series, and NVIDIA RTX 4000 series components.",category:"Database"},{id:5,question:"What if the compatibility checker shows issues with my build?",answer:"When compatibility issues are detected, our system provides detailed analysis and actionable solutions. For CPU-motherboard mismatches, we'll suggest compatible alternatives or explain the socket requirements. RAM compatibility issues include recommendations for the correct DDR4/DDR5 modules and supported speeds. Power supply warnings show your estimated power draw and suggest appropriate wattage ratings. Case compatibility issues detail form factor requirements and suggest suitable alternatives. The system also provides performance impact assessments, helping you understand how different component choices affect your build's capabilities. You can use our 'Find Compatible' feature to automatically suggest alternatives that resolve the conflicts while maintaining your performance goals.",category:"Troubleshooting"},{id:6,question:"Can I use SIMS on mobile devices?",answer:"SIMS is fully responsive and optimized for all devices, including smartphones and tablets. The interface automatically adapts to your screen size, with touch-friendly buttons, swipe gestures for component browsing, and optimized layouts for smaller screens. While the desktop experience offers the most comprehensive view with side-by-side component comparison and detailed specifications, the mobile version provides full functionality for building and checking compatibility. You can browse components, check compatibility, view prebuilt recommendations, and access the FAQ section seamlessly on any device. The mobile interface prioritizes essential features while maintaining the same accuracy and reliability as the desktop version.",category:"Mobile"},{id:7,question:"How accurate are the prebuilt PC recommendations?",answer:"Our prebuilt PC recommendations are meticulously curated by a team of PC building experts who analyze market trends, performance benchmarks, and user requirements. Each system is tested for compatibility, performance, and value-for-money across different use cases. Gaming builds are optimized for frame rates and graphics performance, streaming builds balance CPU and GPU requirements for content creation, and workstation builds prioritize multi-core performance and reliability. We regularly update these recommendations based on new component releases, price changes, and performance improvements. Each prebuilt includes detailed specifications, estimated performance metrics, and upgrade paths, helping you understand exactly what you're getting and how it can be improved over time.",category:"Prebuilts"},{id:8,question:"Does SIMS provide assembly instructions?",answer:"While SIMS primarily focuses on component selection and compatibility checking, we provide comprehensive guidance throughout the PC building process. Our platform includes general assembly tips, component installation order recommendations, and common troubleshooting advice. For detailed step-by-step assembly instructions, we recommend consulting the manufacturer manuals that come with each component, as they contain specific installation procedures and safety guidelines. We also provide links to trusted assembly guides and video tutorials from reputable sources. For users who prefer professional assembly, we can recommend local PC building services and provide guidance on what to look for when choosing an assembler. Our goal is to make the entire PC building journey as smooth as possible, from planning to completion.",category:"Assembly"},{id:9,question:"Can I compare different component options side by side?",answer:"Yes! SIMS offers comprehensive component comparison features. You can preview individual components to see detailed specifications, performance benchmarks, and user reviews. The compatibility checker helps you understand how different component combinations work together, showing the impact of each choice on your overall build performance and compatibility. You can compare multiple CPUs, GPUs, or other components side-by-side to see differences in specifications, power consumption, and performance metrics. The system also provides performance estimates for different combinations, helping you make informed decisions based on your specific needs and budget. Whether you're choosing between AMD and Intel processors, different GPU tiers, or various storage options, our comparison tools help you understand the trade-offs and make the best choice for your build.",category:"Comparison"},{id:10,question:"Is SIMS free to use?",answer:"Yes, SIMS is completely free to use! All our core features are available at no cost, including the advanced compatibility checker, comprehensive component database, prebuilt PC recommendations, and all platform tools. We believe that PC building should be accessible to everyone, regardless of budget constraints. Our business model is supported through partnerships with retailers and manufacturers, allowing us to provide accurate pricing and product information while keeping the platform free for users. We're committed to maintaining this free access while continuously improving our features and expanding our component database. There are no hidden fees, premium tiers, or paid features - everything you need to build your perfect PC is available completely free of charge.",category:"Pricing"}].filter(c=>c.question.toLowerCase().includes(n.toLowerCase())||c.answer.toLowerCase().includes(n.toLowerCase())),o=c=>{r(t===c?null:c)};return h("div",{className:"min-h-screen bg-gray-50",children:[l("div",{className:"bg-white shadow-sm",children:l("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:h("div",{className:"flex items-center justify-between h-16",children:[h("button",{onClick:()=>e("home"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[l(Tf,{className:"w-5 h-5"}),"Back to Home"]}),l("h1",{className:"text-2xl font-bold text-gray-900",children:"FAQ"}),l("div",{})]})})}),h("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[h("div",{className:"text-center mb-12",children:[h("div",{className:"flex items-center justify-center gap-3 mb-4",children:[l(Yy,{className:"w-8 h-8 text-green-600"}),l("h2",{className:"text-4xl font-bold text-gray-900",children:"Frequently Asked Questions"})]}),l("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Find answers to common questions about SIMS and PC building. Can't find what you're looking for? Contact us for personalized help."})]}),l("div",{className:"mb-8",children:h("div",{className:"relative max-w-2xl mx-auto",children:[l(Di,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),l("input",{type:"text",placeholder:"Search FAQ...",value:n,onChange:c=>a(c.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})}),l("div",{className:"space-y-4",children:s.map(c=>h("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[h("button",{onClick:()=>o(c.id),className:"w-full px-6 py-4 text-left flex items-center justify-between hover:bg-gray-50 transition-colors",children:[h("div",{className:"flex items-center gap-3",children:[l("span",{className:"text-lg font-medium text-gray-900",children:c.question}),l("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full",children:c.category})]}),t===c.id?l(cb,{className:"w-5 h-5 text-gray-500"}):l(Pf,{className:"w-5 h-5 text-gray-500"})]}),t===c.id&&l("div",{className:"px-6 pb-4",children:l("p",{className:"text-gray-600 leading-relaxed",children:c.answer})})]},c.id))}),s.length===0&&h("div",{className:"text-center py-12",children:[l(Yy,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No FAQs found"}),l("p",{className:"text-gray-600 mb-4",children:"Try adjusting your search terms or browse all FAQs."}),l("button",{onClick:()=>a(""),className:"text-green-600 hover:text-green-700 font-medium",children:"Clear search"})]}),l("div",{className:"mt-12 text-center",children:h("div",{className:"bg-green-50 rounded-lg p-8",children:[l("h3",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Still have questions?"}),l("p",{className:"text-gray-600 mb-6",children:"Can't find the answer you're looking for? Our support team is here to help."}),h("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[l("button",{onClick:()=>e("contact"),className:"bg-green-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-700 transition-colors",children:"Contact Support"}),l("button",{onClick:()=>e("chat-support"),className:"border-2 border-green-600 text-green-600 px-6 py-3 rounded-lg font-semibold hover:bg-green-50 transition-colors",children:"Live Chat"})]})]})})]})]})},N4=({setCurrentPage:e})=>{const[t,r]=N.useState("cpu-motherboard"),n=[{id:"cpu-motherboard",title:"CPU & Motherboard",icon:l(Ra,{className:"w-6 h-6"}),critical:!0,content:{description:"The most critical compatibility check - ensuring your CPU and motherboard have matching sockets.",checks:[{name:"Socket Compatibility",description:"CPU socket must match motherboard socket exactly",examples:[{cpu:"Intel Core i5-12400F",socket:"LGA1700",compatible:!0},{cpu:"AMD Ryzen 5 5600X",socket:"AM4",compatible:!0},{cpu:"Intel Core i7-12700K",socket:"LGA1700",compatible:!0}],tips:["Intel LGA1700 works with 12th and 13th gen Intel CPUs","AMD AM4 works with Ryzen 3000, 4000, and 5000 series","AMD AM5 works with Ryzen 7000 series and newer","Always check the exact socket before purchasing"]}]}},{id:"ram-motherboard",title:"RAM & Motherboard",icon:l(lo,{className:"w-6 h-6"}),critical:!0,content:{description:"Ensuring your RAM type and speed are supported by your motherboard.",checks:[{name:"RAM Type Compatibility",description:"RAM type (DDR4/DDR5) must match motherboard support",examples:[{ram:"DDR4-3200",motherboard:"DDR4 Support",compatible:!0},{ram:"DDR5-5600",motherboard:"DDR5 Support",compatible:!0},{ram:"DDR4-3200",motherboard:"DDR5 Only",compatible:!1}],tips:["DDR4 and DDR5 are not interchangeable","Check motherboard specifications for supported RAM types","Higher speed RAM may run at lower speeds if not supported","Consider future upgradeability when choosing RAM type"]},{name:"RAM Speed Support",description:"Motherboard must support the RAM speed you choose",examples:[{ram:"DDR4-3600",motherboard:"DDR4-3200 Max",compatible:!1},{ram:"DDR4-3200",motherboard:"DDR4-3600 Max",compatible:!0}],tips:["RAM will run at the lowest supported speed","Check motherboard QVL (Qualified Vendor List)","XMP/DOCP profiles may be required for higher speeds"]}]}},{id:"storage-interface",title:"Storage & Motherboard",icon:l(Of,{className:"w-6 h-6"}),critical:!0,content:{description:"Ensuring your storage drives are compatible with motherboard interfaces.",checks:[{name:"Storage Interface Support",description:"Motherboard must have the right connectors for your storage",examples:[{storage:"NVMe SSD",interface:"M.2 NVMe",compatible:!0},{storage:"SATA SSD",interface:"SATA",compatible:!0},{storage:"NVMe SSD",interface:"SATA Only",compatible:!1}],tips:["M.2 slots can support both SATA and NVMe drives","Check motherboard specifications for M.2 slot types","Some M.2 slots share bandwidth with SATA ports","Consider future storage needs when choosing motherboard"]}]}},{id:"psu-power",title:"Power Supply",icon:l(rs,{className:"w-6 h-6"}),critical:!0,content:{description:"Ensuring your power supply can handle all your components safely.",checks:[{name:"Wattage Requirements",description:"PSU must provide enough power for all components",examples:[{components:"RTX 4080 + i7-12700K",psu:"850W",compatible:!0},{components:"RTX 4090 + i9-13900K",psu:"750W",compatible:!1},{components:"RTX 3060 + i5-12400",psu:"650W",compatible:!0}],tips:["Add 20-30% buffer to calculated power requirements","High-end GPUs require more power than CPUs","Consider future upgrades when choosing PSU wattage","Efficiency rating (80+ Gold, etc.) affects actual power delivery"]},{name:"PSU Form Factor",description:"PSU must fit in your case",examples:[{psu:"ATX PSU",case:"ATX Case",compatible:!0},{psu:"SFX PSU",case:"Mini-ITX Case",compatible:!0},{psu:"ATX PSU",case:"Mini-ITX Case",compatible:!1}],tips:["Check case specifications for supported PSU sizes","SFX PSUs are smaller but more expensive","Modular PSUs help with cable management","Consider cable length for larger cases"]}]}},{id:"case-motherboard",title:"Case & Motherboard",icon:l(nt,{className:"w-6 h-6"}),critical:!0,content:{description:"Ensuring your case can accommodate your motherboard and components.",checks:[{name:"Form Factor Compatibility",description:"Case must support your motherboard form factor",examples:[{motherboard:"ATX",case:"ATX Case",compatible:!0},{motherboard:"Micro-ATX",case:"ATX Case",compatible:!0},{motherboard:"ATX",case:"Micro-ATX Case",compatible:!1}],tips:["Larger cases can accommodate smaller motherboards","Check case specifications for supported form factors","Consider future motherboard upgrades","Smaller cases may have limited expansion options"]},{name:"GPU Length Support",description:"Case must have enough space for your graphics card",examples:[{gpu:"RTX 4090 (304mm)",case:"ATX Case (350mm)",compatible:!0},{gpu:"RTX 4090 (304mm)",case:"Mini-ITX (280mm)",compatible:!1}],tips:["Check case specifications for maximum GPU length","Consider drive cages and other obstructions","Some cases have removable drive cages for longer GPUs","Measure twice, buy once!"]}]}},{id:"cooling",title:"CPU Cooling",icon:l(Rs,{className:"w-6 h-6"}),critical:!1,content:{description:"Ensuring your CPU cooler fits and provides adequate cooling.",checks:[{name:"Socket Compatibility",description:"Cooler must support your CPU socket",examples:[{cooler:"Noctua NH-D15",socket:"LGA1700",compatible:!0},{cooler:"AMD Wraith Prism",socket:"AM4",compatible:!0},{cooler:"Intel Stock Cooler",socket:"AM4",compatible:!1}],tips:["Most coolers support multiple sockets with different mounting kits","Check cooler specifications for supported sockets","Some coolers may need separate mounting hardware","AIO coolers have different mounting requirements"]},{name:"Height Clearance",description:"Cooler must fit within case height limits",examples:[{cooler:"Noctua NH-D15 (165mm)",case:"ATX Case (170mm)",compatible:!0},{cooler:"Noctua NH-D15 (165mm)",case:"Mini-ITX (160mm)",compatible:!1}],tips:["Check case specifications for maximum cooler height","Tower coolers are generally taller than low-profile coolers","AIO coolers may have different clearance requirements","Consider RAM height when choosing air coolers"]}]}}],a=s=>s?l(At,{className:"w-5 h-5 text-green-600"}):l(ka,{className:"w-5 h-5 text-red-600"}),i=s=>s?"text-green-600":"text-red-600";return h("div",{className:"min-h-screen bg-gray-50",children:[l("div",{className:"bg-white shadow-sm",children:l("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:h("div",{className:"flex items-center justify-between h-16",children:[h("button",{onClick:()=>e("home"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[l(Tf,{className:"w-5 h-5"}),"Back to Home"]}),l("h1",{className:"text-2xl font-bold text-gray-900",children:"Compatibility Guide"}),l("div",{})]})})}),h("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[h("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[l("div",{className:"lg:col-span-1",children:h("div",{className:"bg-white rounded-lg shadow-sm p-6 sticky top-8",children:[l("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Compatibility Checks"}),l("nav",{className:"space-y-2",children:n.map(s=>h("button",{onClick:()=>r(s.id),className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg text-left transition-colors ${t===s.id?"bg-green-100 text-green-700":"text-gray-600 hover:bg-gray-100"}`,children:[s.icon,l("span",{className:"font-medium",children:s.title}),s.critical&&l(Fn,{className:"w-4 h-4 text-red-500 ml-auto"})]},s.id))})]})}),l("div",{className:"lg:col-span-3",children:n.map(s=>t===s.id&&h("div",{className:"bg-white rounded-lg shadow-sm p-8",children:[h("div",{className:"flex items-center gap-3 mb-6",children:[s.icon,l("h2",{className:"text-2xl font-bold text-gray-900",children:s.title}),s.critical&&l("span",{className:"px-2 py-1 bg-red-100 text-red-700 text-xs font-medium rounded-full",children:"Critical"})]}),l("p",{className:"text-gray-600 text-lg mb-8",children:s.content.description}),l("div",{className:"space-y-8",children:s.content.checks.map((o,c)=>h("div",{className:"border border-gray-200 rounded-lg p-6",children:[l("h3",{className:"text-xl font-semibold text-gray-900 mb-3",children:o.name}),l("p",{className:"text-gray-600 mb-6",children:o.description}),o.examples&&h("div",{className:"mb-6",children:[l("h4",{className:"font-semibold text-gray-900 mb-3",children:"Examples:"}),l("div",{className:"space-y-2",children:o.examples.map((u,d)=>h("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[a(u.compatible),h("div",{className:"flex-1",children:[h("span",{className:"font-medium",children:[Object.keys(u)[0],": "]}),l("span",{className:"text-gray-700",children:Object.values(u)[0]}),l("span",{className:"mx-2 text-gray-400",children:"â†’"}),h("span",{className:"font-medium",children:[Object.keys(u)[1],": "]}),l("span",{className:"text-gray-700",children:Object.values(u)[1]})]}),l("span",{className:`text-sm font-medium ${i(u.compatible)}`,children:u.compatible?"Compatible":"Incompatible"})]},d))})]}),o.tips&&h("div",{children:[l("h4",{className:"font-semibold text-gray-900 mb-3",children:"Tips:"}),l("ul",{className:"space-y-2",children:o.tips.map((u,d)=>h("li",{className:"flex items-start gap-2",children:[l(Ac,{className:"w-4 h-4 text-blue-500 mt-1 flex-shrink-0"}),l("span",{className:"text-gray-600",children:u})]},d))})]})]},c))})]},s.id))})]}),l("div",{className:"mt-12 text-center",children:h("div",{className:"bg-green-50 rounded-lg p-8",children:[l("h3",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Ready to Build?"}),l("p",{className:"text-gray-600 mb-6",children:"Now that you understand compatibility, start building your perfect PC with our guided interface."}),l("button",{onClick:()=>e("pc-assembly"),className:"bg-green-600 text-white px-8 py-3 rounded-lg font-semibold text-lg hover:bg-green-700 transition-colors",children:"Start PC Assembly"})]})})]})]})},k4=({setCurrentPage:e})=>{const[t,r]=N.useState(""),[n,a]=N.useState("all"),i=[{id:"all",name:"All Issues",icon:null},{id:"compatibility",name:"Compatibility",icon:null},{id:"performance",name:"Performance",icon:null},{id:"hardware",name:"Hardware",icon:null},{id:"software",name:"Software",icon:null},{id:"build",name:"Build Process",icon:null}],o=[{id:1,title:"Components show as incompatible when they should work",category:"compatibility",severity:"high",symptoms:["Compatibility checker shows red X for components that should work","Components are from same generation but marked incompatible","Socket types match but still showing as incompatible"],solutions:["Check if component specifications are complete in database","Verify exact model numbers match manufacturer specifications","Update component database with latest specifications","Contact support if issue persists with specific components"],prevention:["Always double-check component specifications before purchasing","Use official manufacturer websites for verification","Keep component database updated with latest information"]},{id:2,title:"PC Assembly page loads slowly or times out",category:"performance",severity:"medium",symptoms:["Page takes more than 5 seconds to load","Components list shows loading spinner indefinitely","Browser shows timeout errors"],solutions:["Check internet connection stability","Clear browser cache and cookies","Try refreshing the page","Disable browser extensions temporarily","Try using a different browser"],prevention:["Use a stable internet connection","Keep browser updated to latest version","Clear browser cache regularly"]},{id:3,title:"Selected components disappear after page refresh",category:"software",severity:"high",symptoms:["Components selected in PC Assembly disappear on refresh","Build progress resets to zero","Selected components not saved"],solutions:["Ensure you are logged in to your account","Check if browser has JavaScript enabled","Try saving your build before refreshing","Clear browser cache and try again"],prevention:["Always log in before starting a build","Save your build periodically during selection","Use a supported browser with JavaScript enabled"]},{id:4,title:"Chat support not working or messages not sending",category:"software",severity:"medium",symptoms:["Chat window opens but messages don't send","Floating chat button not visible","Messages appear to send but don't reach support"],solutions:["Check internet connection","Refresh the page and try again","Clear browser cache","Try using incognito/private browsing mode","Contact support through alternative methods"],prevention:["Use a stable internet connection","Keep browser updated","Avoid using multiple chat sessions simultaneously"]},{id:5,title:"Cannot access admin dashboard or features",category:"software",severity:"high",symptoms:["Admin login works but dashboard doesn't load","Admin features show access denied errors","Cannot see admin sidebar or navigation"],solutions:["Verify admin account has correct permissions","Check if account role is properly set in database","Log out and log back in","Contact system administrator","Check browser console for error messages"],prevention:["Ensure admin accounts are properly configured","Regularly verify user permissions","Keep user roles updated in database"]},{id:6,title:"Component images not loading or showing placeholders",category:"hardware",severity:"low",symptoms:["Component cards show placeholder images","Images load slowly or not at all","Broken image icons appear"],solutions:["Check internet connection speed","Refresh the page","Clear browser cache","Try loading images in a new tab","Contact support if issue persists"],prevention:["Use a stable internet connection","Keep browser updated","Avoid ad blockers that might block images"]},{id:7,title:"Build compatibility score shows incorrect percentage",category:"compatibility",severity:"medium",symptoms:["Compatibility score doesn't match actual compatibility","Score shows 0% when components should be compatible","Score doesn't update when components change"],solutions:["Refresh the page to recalculate compatibility","Remove and re-add components","Check if all required components are selected","Verify component specifications are complete","Contact support with specific component details"],prevention:["Ensure all component data is accurate and complete","Regularly update compatibility checking algorithms","Test compatibility calculations with known good builds"]},{id:8,title:"Cannot save or submit PC build",category:"build",severity:"high",symptoms:["Save button doesn't work or is disabled","Build submission fails with error message","Build appears to save but doesn't persist"],solutions:["Ensure you are logged in to your account","Check if all required fields are filled","Verify internet connection is stable","Try saving with a different build name","Check browser console for error messages","Contact support if issue persists"],prevention:["Always log in before starting a build","Fill in all required information","Use a stable internet connection","Save builds regularly during the process"]}].filter(d=>{const f=d.title.toLowerCase().includes(t.toLowerCase())||d.symptoms.some(p=>p.toLowerCase().includes(t.toLowerCase()))||d.solutions.some(p=>p.toLowerCase().includes(t.toLowerCase())),m=n==="all"||d.category===n;return f&&m}),c=d=>{switch(d){case"high":return"text-red-600 bg-red-100";case"medium":return"text-yellow-600 bg-yellow-100";case"low":return"text-green-600 bg-green-100";default:return"text-gray-600 bg-gray-100"}},u=d=>{switch(d){case"high":return l(ka,{className:"w-4 h-4"});case"medium":return l(Fn,{className:"w-4 h-4"});case"low":return l(At,{className:"w-4 h-4"});default:return l(Fn,{className:"w-4 h-4"})}};return h("div",{className:"min-h-screen bg-gray-50",children:[l("div",{className:"bg-white shadow-sm",children:l("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:h("div",{className:"flex items-center justify-between h-16",children:[h("button",{onClick:()=>e("home"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[l(Tf,{className:"w-5 h-5"}),"Back to Home"]}),l("h1",{className:"text-2xl font-bold text-gray-900",children:"Troubleshooting"}),l("div",{})]})})}),h("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[h("div",{className:"text-center mb-12",children:[h("div",{className:"flex items-center justify-center gap-3 mb-4",children:[l(Wk,{className:"w-8 h-8 text-green-600"}),l("h2",{className:"text-4xl font-bold text-gray-900",children:"Troubleshooting Guide"})]}),l("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Having issues with SIMS? Find solutions to common problems and get back to building your perfect PC."})]}),h("div",{className:"mb-8 space-y-4",children:[h("div",{className:"relative max-w-2xl mx-auto",children:[l(Di,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),l("input",{type:"text",placeholder:"Search troubleshooting issues...",value:t,onChange:d=>r(d.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),l("div",{className:"flex flex-wrap justify-center gap-2",children:i.map(d=>h("button",{onClick:()=>a(d.id),className:`px-4 py-2 rounded-lg font-medium transition-colors ${n===d.id?"bg-green-600 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:[d.icon&&l("span",{className:"mr-2",children:d.icon}),d.name]},d.id))})]}),l("div",{className:"space-y-6",children:o.map(d=>h("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[l("div",{className:"flex items-start justify-between mb-4",children:h("div",{className:"flex-1",children:[l("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:d.title}),h("div",{className:"flex items-center gap-3",children:[h("span",{className:`px-2 py-1 rounded-full text-xs font-medium flex items-center gap-1 ${c(d.severity)}`,children:[u(d.severity),d.severity.charAt(0).toUpperCase()+d.severity.slice(1)," Priority"]}),l("span",{className:"text-sm text-gray-500 capitalize",children:d.category})]})]})}),h("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[h("div",{children:[h("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[l(Fn,{className:"w-4 h-4 text-red-500"}),"Symptoms"]}),l("ul",{className:"space-y-2",children:d.symptoms.map((f,m)=>h("li",{className:"text-sm text-gray-600 flex items-start gap-2",children:[l("span",{className:"text-red-500 mt-1",children:"â€¢"}),f]},m))})]}),h("div",{children:[h("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[l(Wk,{className:"w-4 h-4 text-green-500"}),"Solutions"]}),l("ul",{className:"space-y-2",children:d.solutions.map((f,m)=>h("li",{className:"text-sm text-gray-600 flex items-start gap-2",children:[l("span",{className:"text-green-500 mt-1",children:"â€¢"}),f]},m))})]}),h("div",{children:[h("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[l(Jh,{className:"w-4 h-4 text-blue-500"}),"Prevention"]}),l("ul",{className:"space-y-2",children:d.prevention.map((f,m)=>h("li",{className:"text-sm text-gray-600 flex items-start gap-2",children:[l("span",{className:"text-blue-500 mt-1",children:"â€¢"}),f]},m))})]})]})]},d.id))}),o.length===0&&h("div",{className:"text-center py-12",children:[l(z8,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),l("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No issues found"}),l("p",{className:"text-gray-600 mb-4",children:"Try adjusting your search terms or browse all categories."}),l("button",{onClick:()=>{r(""),a("all")},className:"text-green-600 hover:text-green-700 font-medium",children:"Clear filters"})]}),l("div",{className:"mt-12 text-center",children:h("div",{className:"bg-green-50 rounded-lg p-8",children:[l("h3",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Still need help?"}),l("p",{className:"text-gray-600 mb-6",children:"Can't find a solution to your problem? Our support team is ready to help you get back on track."}),h("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[l("button",{onClick:()=>e("contact"),className:"bg-green-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-700 transition-colors",children:"Contact Support"}),l("button",{onClick:()=>e("chat-support"),className:"border-2 border-green-600 text-green-600 px-6 py-3 rounded-lg font-semibold hover:bg-green-50 transition-colors",children:"Live Chat"})]})]})})]})]})},S4=({onLogin:e,onSwitchToRegister:t})=>{const[r,n]=N.useState({username:"",password:""}),[a,i]=N.useState(""),[s,o]=N.useState(""),[c,u]=N.useState(!1),[d,f]=N.useState(!1),[m,p]=N.useState(!1),[x,g]=N.useState(""),[y,v]=N.useState(!1),[b,w]=N.useState(!1),[k,S]=N.useState(!1),[_,C]=N.useState(!1),[E,A]=N.useState(""),T=N.useRef(null),D=N.useRef(null);N.useEffect(()=>{if(console.log("[Login] Component mounted, checking reCAPTCHA configuration..."),!gn()){console.warn("[Login] reCAPTCHA is NOT configured. Please set VITE_RECAPTCHA_SITE_KEY in .env file");return}let W=!1,ie=null,B=null;const ee=()=>{if(W||T.current!==null)return;const le=(R=0)=>{D.current?(W=!0,console.log("[Login] reCAPTCHA container found, initializing v2..."),EN().then(()=>{const j=(V=0)=>{if(T.current!==null){W=!1;return}if(window.grecaptcha&&window.grecaptcha.render&&typeof window.grecaptcha.render=="function")if(D.current&&T.current===null)try{const P=tF(D.current,q=>{console.log("[Login] reCAPTCHA verified successfully"),S(!0)},{theme:"light",size:"normal","expired-callback":()=>{console.log("[Login] reCAPTCHA token expired"),S(!1)},"error-callback":()=>{console.error("[Login] reCAPTCHA error occurred"),S(!1)}});T.current=P,W=!1,console.log("[Login] reCAPTCHA widget rendered with ID:",P)}catch(P){W=!1,!P.message||!P.message.includes("already been rendered")?console.error("[Login] Failed to render reCAPTCHA widget:",P):console.warn("[Login] reCAPTCHA widget already rendered, skipping...")}else W=!1,D.current||console.warn("[Login] reCAPTCHA container ref is null, cannot render widget");else V<50?setTimeout(()=>j(V+1),100):(W=!1,console.error("[Login] reCAPTCHA render method not available after waiting"))};j()}).catch(j=>{W=!1,console.error("[Login] Failed to initialize reCAPTCHA:",j)})):R<100?B=setTimeout(()=>le(R+1),100):console.warn("[Login] reCAPTCHA container not found after waiting, widget may not render")};le()};return ie=setTimeout(()=>{ee()},300),()=>{ie&&clearTimeout(ie),B&&clearTimeout(B),W=!1}},[y,_]),N.useEffect(()=>{T.current!==null&&window.grecaptcha&&(hs(T.current),S(!1))},[d,y]);const I=()=>{T.current!==null&&window.grecaptcha&&(hs(T.current),S(!1))},z=W=>{n({...r,[W.target.name]:W.target.value}),i(""),o(""),(W.target.name==="username"||W.target.name==="password")&&k&&W.target.name==="username"&&W.target.value!==r.username&&(S(!1),T.current!==null&&window.grecaptcha&&hs(T.current))},X=async W=>{W.preventDefault(),u(!0),i(""),o("");try{if(_){if(!x||x.length!==6){u(!1),i("Please enter the 6-digit verification code.");return}const le={email:E,purpose:"login_verify",code:x},R=await fetch(`${ke}/index.php?endpoint=otp_verify`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(le)}),j=await R.json();if(R.ok&&j.success&&j.token){I(),localStorage.setItem("token",j.token),j.refresh_token&&localStorage.setItem("refresh_token",j.refresh_token),await new Promise(V=>setTimeout(V,100));try{const V=await fetch(`${ke}/index.php?endpoint=profile`,{method:"GET",headers:{Authorization:`Bearer ${j.token}`}});if(V.ok){const P=await V.json();if(P.success){e(P.user);return}}e(j.user)}catch{e(j.user)}}else T.current!==null&&window.grecaptcha&&(hs(T.current),S(!1)),i(j.error||"Verification code is incorrect or expired");u(!1);return}const ie=!r.username||!r.username.trim(),B=!d&&(!r.password||!r.password.trim());if(ie||B){u(!1),i("Email and Password are required");return}let ee=null;if(gn()&&T.current!==null)try{if(ee=rF(T.current),!ee){u(!1),i("Please complete the reCAPTCHA verification");return}}catch(le){console.error("reCAPTCHA error:",le),u(!1),i("reCAPTCHA verification failed. Please try again.");return}else gn()&&console.warn("[Login] reCAPTCHA is configured but widget not rendered, proceeding without verification");if(d){const le=(r.username||"").trim(),R=/^[^@]+@gmail\.com$/i.test(le);if(!le||!le.includes("@")){i("Please enter your email address to use OTP login.");return}if(!R){i("Only Gmail addresses are allowed for OTP.");return}if(!x){i("Enter the 6-digit code sent to your email.");return}const j={email:r.username,purpose:"login",code:x};ee&&(j.recaptcha_token=ee);const V=await fetch(`${ke}/index.php?endpoint=otp_verify`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(j)}),P=await V.json();V.ok&&P.success&&P.token?(I(),localStorage.setItem("token",P.token),P.refresh_token&&localStorage.setItem("refresh_token",P.refresh_token),e(P.user)):(T.current!==null&&window.grecaptcha&&(hs(T.current),S(!1)),i(P.error||"OTP verification failed"))}else{const le={...r};ee&&(le.recaptcha_token=ee);const R=await fetch(`${ke}/index.php?endpoint=login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(le)}),j=await R.json();if(R.ok&&j.success){if(j.requires_otp&&j.email){C(!0),A(j.email),o(j.message||"Verification code sent to your email. Please check your inbox."),i(""),I();return}localStorage.setItem("token",j.token),j.refresh_token&&localStorage.setItem("refresh_token",j.refresh_token),await new Promise(V=>setTimeout(V,100)),I();try{const V=await fetch(`${ke}/index.php?endpoint=profile`,{method:"GET",headers:{Authorization:`Bearer ${j.token}`}});if(V.ok){const P=await V.json();if(P.success){e(P.user);return}}e(j.user)}catch{e(j.user)}}else{T.current!==null&&window.grecaptcha&&(hs(T.current),S(!1));const V=j&&(j.error||j.message)||"";/invalid password|wrong password/i.test(V)?i("Invalid credentials"):/not found|no account|does not exist|unregistered/i.test(V)?i("Account does not exist"):i("Invalid credentials")}}}catch{i("Network error")}finally{u(!1)}},H=async()=>{i(""),o("");const W=(r.username||"").trim(),ie=/^[^@]+@gmail\.com$/i.test(W);if(!W||!W.includes("@")){i("Please enter a valid email address.");return}if(!ie){i("Only Gmail addresses are allowed for OTP.");return}try{u(!0);const B=await fetch(`${ke}/index.php?endpoint=otp_request`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r.username,purpose:"login"})}),ee=await B.json();B.ok&&ee.success?(p(!0),o("Verification code sent. Please check your email.")):i(ee.error||"Failed to send code")}catch{i("Network error")}finally{u(!1)}},L=async()=>{i(""),o("");const W=(r.username||"").trim();if(!W||!W.includes("@")){i("Please enter a valid email address.");return}if(!/^[^@]+@gmail\.com$/i.test(W)){i("Only Gmail accounts are allowed for password reset.");return}try{u(!0);const B=await fetch(`${ke}/index.php?endpoint=forgot_password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:W})}),ee=await B.json();B.ok&&ee.success?(w(!0),o("Password reset instructions sent to your Gmail.")):i(ee.error||"Failed to send reset instructions")}catch{i("Network error")}finally{u(!1)}};return l("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:h("div",{className:"max-w-md w-full space-y-8",children:[h("div",{children:[l("div",{className:"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-green-100",children:l("svg",{className:"h-8 w-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),l("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sign in to your account"}),l("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Welcome back to SIMS"})]}),h("form",{className:"mt-8 space-y-6",onSubmit:X,children:[a&&l("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:a}),h("div",{className:"space-y-4",children:[h("div",{children:[l("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700",children:d||y?"Gmail Address":"Username or Email"}),l("input",{id:"username",name:"username",type:d?"email":"text",autoComplete:d?"email":"username",required:!0,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm",placeholder:d||y?"Enter your Gmail address":"Enter your username or email",value:r.username,onChange:z})]}),!d&&!y&&!_&&h("div",{children:[l("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),l(Wl,{id:"password",name:"password",autoComplete:"current-password",required:!0,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm",placeholder:"Enter your password",value:r.password,onChange:z})]}),_&&h("div",{className:"space-y-3",children:[h("div",{className:"bg-blue-50 border border-blue-200 text-blue-700 px-4 py-3 rounded-md",children:[l("p",{className:"text-sm font-medium",children:"Verification code sent!"}),h("p",{className:"text-xs mt-1",children:["Please check your email (",E,") and enter the 6-digit code below."]})]}),h("div",{children:[l("label",{htmlFor:"postLoginOtpCode",className:"block text-sm font-medium text-gray-700",children:"Enter Verification Code"}),l("input",{id:"postLoginOtpCode",name:"postLoginOtpCode",type:"text",inputMode:"numeric",pattern:"[0-9]{6}",maxLength:6,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm",placeholder:"123456",value:x,onChange:W=>g(W.target.value.replace(/\D/g,"").slice(0,6))})]})]}),d&&h("div",{className:"space-y-3",children:[h("div",{className:"flex items-center gap-2",children:[l("button",{type:"button",onClick:H,disabled:c,className:`px-3 py-2 text-sm font-medium rounded-md text-white ${c?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"}`,children:m?"Resend Code":"Send Code"}),s&&l("span",{className:"text-xs text-gray-600",children:s})]}),m&&h("div",{children:[l("label",{htmlFor:"otpCode",className:"block text-sm font-medium text-gray-700",children:"Enter 6-digit Code"}),l("input",{id:"otpCode",name:"otpCode",type:"text",inputMode:"numeric",pattern:"[0-9]{6}",maxLength:6,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm",placeholder:"123456",value:x,onChange:W=>g(W.target.value.replace(/\D/g,"").slice(0,6))})]})]}),y&&l("div",{className:"space-y-3",children:h("div",{className:"text-center",children:[l("p",{className:"text-sm text-gray-600 mb-2",children:"Enter your Gmail address and we'll send you instructions to reset your password."}),l("p",{className:"text-xs text-gray-500 mb-4",children:"Only Gmail accounts are supported for password reset."}),l("button",{type:"button",onClick:L,disabled:c,className:`px-4 py-2 text-sm font-medium rounded-md text-white ${c?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"}`,children:c?"Sending...":"Send Reset Instructions"}),s&&l("div",{className:"mt-3 p-3 bg-green-50 border border-green-200 text-green-700 rounded-md text-sm",children:s})]})}),!y&&!_&&gn()&&l("div",{className:"flex justify-center",children:l("div",{ref:D,id:"recaptcha-container"})})]}),h("div",{className:"space-y-3",children:[!y&&l("button",{type:"submit",disabled:c||d&&!m||gn()&&T.current!==null&&!k&&!_||_&&(!x||x.length!==6),className:`group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white ${c||gn()&&T.current!==null&&!k&&!_||_&&(!x||x.length!==6)?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500"}`,title:gn()&&T.current!==null&&!k&&!_?"Please complete the reCAPTCHA verification first":_&&(!x||x.length!==6)?"Please enter the 6-digit verification code":"",children:c?_||d?"Verifying...":"Signing in...":_||d?"Verify & Sign in":"Sign in"}),!y&&!_&&h("div",{className:"text-center space-y-2",children:[l("button",{type:"button",onClick:()=>{f(!d),i(""),o(""),p(!1),g("")},className:"text-sm text-green-600 hover:text-green-500",children:d?"Use password instead":"Use OTP instead"}),l("div",{children:l("button",{type:"button",onClick:()=>{v(!0),i(""),o(""),f(!1),p(!1),g("")},className:"text-sm text-gray-600 hover:text-gray-500",children:"Forgot your password?"})})]}),_&&l("div",{className:"text-center",children:l("button",{type:"button",onClick:()=>{C(!1),A(""),i(""),o(""),g(""),n({username:r.username,password:""})},className:"text-sm text-gray-600 hover:text-gray-500",children:"Back to password"})}),y&&l("div",{className:"text-center",children:l("button",{type:"button",onClick:()=>{v(!1),i(""),o(""),w(!1)},className:"text-sm text-green-600 hover:text-green-500",children:"Back to login"})})]}),l("div",{className:"text-center",children:h("p",{className:"text-sm text-gray-600",children:["Don't have an account?"," ",l("button",{type:"button",onClick:t,className:"font-medium text-green-600 hover:text-green-500",children:"Register here"})]})}),gn()&&l("div",{className:"text-xs text-gray-500 text-center mt-4",children:h("p",{children:["This site is protected by reCAPTCHA and the Google"," ",l("a",{href:"https://policies.google.com/privacy",target:"_blank",rel:"noopener noreferrer",className:"text-green-600 hover:underline",children:"Privacy Policy"})," ","and"," ",l("a",{href:"https://policies.google.com/terms",target:"_blank",rel:"noopener noreferrer",className:"text-green-600 hover:underline",children:"Terms of Service"})," ","apply."]})})]})]})})},Xfe=e=>/[\u{1F600}-\u{1F64F}\u{1F300}-\u{1F5FF}\u{1F680}-\u{1F6FF}\u{1F1E0}-\u{1F1FF}\u{2600}-\u{26FF}\u{2700}-\u{27BF}\u{1F900}-\u{1F9FF}]/gu.test(e),_4=(e,t)=>Xfe(e)?`${t} should not contain emojis`:"",C4=({onRegister:e,onSwitchToLogin:t})=>{const[r,n]=N.useState({firstName:"",lastName:"",username:"",email:"",password:"",confirmPassword:""}),[a,i]=N.useState(""),[s,o]=N.useState(!1),[c,u]=N.useState(!1),[d,f]=N.useState(!1),[m,p]=N.useState(""),[x,g]=N.useState(""),[y,v]=N.useState(0),[b,w]=N.useState(null),[k,S]=N.useState(!1),_=N.useRef(null),C=N.useRef(null),[E,A]=N.useState({min_length:8,max_length:null,require_uppercase:!0,require_lowercase:!0,require_numbers:!0,require_special:!0});ft.useEffect(()=>{(async()=>{try{const W=await(await fetch(`${ke}/index.php?endpoint=password_requirements`)).json();W.success&&W.requirements&&A(W.requirements)}catch(L){console.error("Failed to fetch password requirements:",L)}})()},[]),N.useEffect(()=>{if(console.log("[Register] Component mounted, checking reCAPTCHA configuration..."),!gn()){console.warn("[Register] reCAPTCHA is NOT configured. Please set VITE_RECAPTCHA_SITE_KEY in .env file");return}let H=!1,L=null;const W=()=>{H||_.current===null&&C.current&&(H=!0,console.log("[Register] reCAPTCHA is configured, initializing v2..."),EN().then(()=>{const ie=(B=0)=>{if(_.current!==null){H=!1;return}if(window.grecaptcha&&window.grecaptcha.render&&typeof window.grecaptcha.render=="function")if(C.current&&_.current===null)try{const ee=tF(C.current,le=>{console.log("[Register] reCAPTCHA verified successfully"),S(!0)},{theme:"light",size:"normal","expired-callback":()=>{console.log("[Register] reCAPTCHA token expired"),S(!1)},"error-callback":()=>{console.error("[Register] reCAPTCHA error occurred"),S(!1)}});_.current=ee,H=!1,console.log("[Register] reCAPTCHA widget rendered with ID:",ee)}catch(ee){H=!1,!ee.message||!ee.message.includes("already been rendered")?console.error("[Register] Failed to render reCAPTCHA widget:",ee):console.warn("[Register] reCAPTCHA widget already rendered, skipping...")}else H=!1;else B<50?setTimeout(()=>ie(B+1),100):(H=!1,console.error("[Register] reCAPTCHA render method not available after waiting"))};ie()}).catch(ie=>{H=!1,console.error("[Register] Failed to initialize reCAPTCHA:",ie)}))};return L=setTimeout(()=>{W()},200),()=>{L&&clearTimeout(L),H=!1}},[]);const T=H=>{const{name:L,value:W}=H.target,ie=_4(W,L==="email"?"Email":L==="username"?"Username":"Name");if(ie){i(ie);return}n({...r,[L]:W}),i(""),(L==="email"||L==="username")&&k&&(L==="email"&&W!==r.email||L==="username"&&W!==r.username)&&(S(!1),_.current!==null&&window.grecaptcha&&hs(_.current))},D=async H=>{H.preventDefault();const L=[{name:"firstName",label:"First name"},{name:"lastName",label:"Last name"},{name:"username",label:"Username"},{name:"email",label:"Email"}];for(const ee of L){const le=_4(r[ee.name],ee.label);if(le){i(le);return}}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.email)){i("Invalid email format");return}const ie=(r.password||"").length,B=[];if(ie<E.min_length&&B.push(`Password must be at least ${E.min_length} characters long`),E.max_length&&ie>E.max_length&&B.push(`Password must be no more than ${E.max_length} characters long (current: ${ie})`),E.require_uppercase&&!/[A-Z]/.test(r.password)&&B.push("Password must contain at least one uppercase letter"),E.require_lowercase&&!/[a-z]/.test(r.password)&&B.push("Password must contain at least one lowercase letter"),E.require_numbers&&!/\d/.test(r.password)&&B.push("Password must contain at least one number"),E.require_special&&!/[^A-Za-z0-9]/.test(r.password)&&B.push("Password must contain at least one special character"),B.length>0){i(B.length===1?B[0]:"Password must meet security requirements: "+B.join(", "));return}if(r.password!==r.confirmPassword){i("Passwords do not match");return}if(!d||m.length!==6){i("Please send OTP and enter the 6-digit code.");return}o(!0),i("");try{let ee=null;if(gn()&&_.current!==null)try{if(ee=rF(_.current),!ee){o(!1),i("Please complete the reCAPTCHA verification");return}}catch(q){console.error("reCAPTCHA error:",q),o(!1),i("reCAPTCHA verification failed. Please try again.");return}else if(gn()){o(!1),i("reCAPTCHA verification is required");return}const{confirmPassword:le,...R}=r,j={first_name:R.firstName,last_name:R.lastName,username:R.username,email:R.email,password:R.password,otp_code:m};ee&&(j.recaptcha_token=ee);const V=await fetch(`${ke}/index.php?endpoint=register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(j)}),P=await V.json();V.ok&&P.success?(localStorage.setItem("token",P.token),P.refresh_token&&localStorage.setItem("refresh_token",P.refresh_token),_.current!==null&&window.grecaptcha&&(hs(_.current),S(!1)),e()):(_.current!==null&&window.grecaptcha&&(hs(_.current),S(!1)),i(P.error||"Registration failed"))}catch{i("Network error")}finally{o(!1)}},I=ft.useMemo(()=>{const H=r.password||"";if(E.max_length&&H.length>E.max_length)return{score:0,label:"Invalid",isValid:!1,issue:`Password must be no more than ${E.max_length} characters`};let L=0;H.length>=E.min_length&&L++,E.max_length&&H.length<=E.max_length&&L++,E.require_uppercase&&/[A-Z]/.test(H)&&L++,E.require_lowercase&&/[a-z]/.test(H)&&L++,E.require_numbers&&/\d/.test(H)&&L++,E.require_special&&/[^A-Za-z0-9]/.test(H)&&L++;const W=["Very weak","Weak","Fair","Good","Strong"],ie=H.length>=E.min_length&&(!E.max_length||H.length<=E.max_length)&&(!E.require_uppercase||/[A-Z]/.test(H))&&(!E.require_lowercase||/[a-z]/.test(H))&&(!E.require_numbers||/\d/.test(H))&&(!E.require_special||/[^A-Za-z0-9]/.test(H));return{score:L,label:W[Math.min(L,4)]||"Very weak",isValid:ie,issue:ie?null:"Password does not meet all requirements"}},[r.password,E]),z=async()=>{if(i(""),g(""),!r.email||!r.email.includes("@")){i("Enter a valid email first.");return}try{u(!0);const H=await fetch(`${ke}/index.php?endpoint=otp_request`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r.email,purpose:"register"})});let L;try{L=await H.clone().json()}catch{const ie=await H.text();try{L=JSON.parse(ie)}catch{L={success:H.ok&&/otp sent|verification code/i.test(ie)}}}if(H.ok&&L&&L.success){f(!0),g("Verification code sent. Check your email.");const W=Number(L.cooldown_seconds||60),ie=Number(L.ttl_minutes||5);v(W),w(Date.now()+ie*60*1e3)}else i(L&&L.error||"Failed to send verification code")}catch{i("Network error")}finally{u(!1)}};ft.useEffect(()=>{if(!d||y<=0)return;const H=setInterval(()=>{v(L=>L>0?L-1:0)},1e3);return()=>clearInterval(H)},[d,y]);const X=ft.useMemo(()=>{if(!b)return"";const H=Math.max(0,Math.floor((b-Date.now())/1e3)),L=String(Math.floor(H/60)).padStart(1,"0"),W=String(H%60).padStart(2,"0");return H>0?`Code expires in ${L}:${W}`:"Code expired. Please resend."},[b,Date.now()]);return l("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:h("div",{className:"max-w-md w-full space-y-8",children:[h("div",{children:[l("div",{className:"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-green-100",children:l("svg",{className:"h-8 w-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})})}),l("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Create your account"}),l("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Join SIMS today"})]}),h("form",{className:"mt-8 space-y-6",onSubmit:D,children:[a&&l("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:a}),x&&l("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-md",children:x}),h("div",{className:"space-y-4",children:[h("div",{className:"flex gap-4",children:[h("div",{className:"w-1/2",children:[l("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700",children:"First Name"}),l("input",{id:"firstName",name:"firstName",type:"text",autoComplete:"given-name",required:!0,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm",placeholder:"Enter your first name",value:r.firstName,onChange:T})]}),h("div",{className:"w-1/2",children:[l("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700",children:"Last Name"}),l("input",{id:"lastName",name:"lastName",type:"text",autoComplete:"family-name",required:!0,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm",placeholder:"Enter your last name",value:r.lastName,onChange:T})]})]}),h("div",{children:[l("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700",children:"Username"}),l("input",{id:"username",name:"username",type:"text",autoComplete:"username",required:!0,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm",placeholder:"Choose a username",value:r.username,onChange:T})]}),h("div",{children:[l("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email Address"}),l("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm",placeholder:"Enter your email",value:r.email,onChange:T}),h("div",{className:"mt-2 flex items-center gap-2",children:[l("button",{type:"button",onClick:z,disabled:c||y>0,className:`px-3 py-2 text-sm font-medium rounded-md text-white ${c||y>0?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"}`,children:d?y>0?`Resend (${y}s)`:"Resend Code":"Send Code"}),d&&l("input",{id:"otpCode",name:"otpCode",type:"text",inputMode:"numeric",pattern:"[0-9]{6}",maxLength:6,className:"flex-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm",placeholder:"Enter 6-digit code",value:m,onChange:H=>p(H.target.value.replace(/\D/g,"").slice(0,6))}),d&&l("span",{className:"text-xs text-gray-600",children:X})]})]}),h("div",{children:[l("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),l(Wl,{id:"password",name:"password",autoComplete:"new-password",required:!0,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm",placeholder:"Enter your password",value:r.password,onChange:T,showStrengthIndicator:!0,strengthScore:I.score,strengthLabel:I.label}),h("div",{className:"mt-2 text-xs text-gray-600",children:[l("p",{className:"mb-1",children:"Password requirements:"}),h("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[h("li",{className:r.password.length<E.min_length?"text-red-600":r.password.length>=E.min_length&&(!E.max_length||r.password.length<=E.max_length)?"text-green-600":"",children:[E.min_length,E.max_length?`-${E.max_length}`:"+"," characters",E.max_length&&r.password.length>E.max_length&&h("span",{className:"text-red-600 font-semibold",children:[" (current: ",r.password.length,")"]})]}),l("li",{className:E.require_numbers&&!/\d/.test(r.password)?"text-red-600":E.require_numbers&&/\d/.test(r.password)?"text-green-600":"",children:"Must contain number"}),l("li",{className:E.require_uppercase&&!/[A-Z]/.test(r.password)?"text-red-600":E.require_uppercase&&/[A-Z]/.test(r.password)?"text-green-600":"",children:"Must contain 1 capital letter"}),l("li",{className:E.require_special&&!/[^A-Za-z0-9]/.test(r.password)?"text-red-600":E.require_special&&/[^A-Za-z0-9]/.test(r.password)?"text-green-600":"",children:"Must contain special symbol"})]}),I.issue&&r.password&&l("p",{className:"mt-2 text-xs text-red-600 font-semibold",children:I.issue})]})]}),h("div",{children:[l("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),l(Wl,{id:"confirmPassword",name:"confirmPassword",autoComplete:"new-password",required:!0,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm",placeholder:"Confirm your password",value:r.confirmPassword,onChange:T})]}),gn()&&l("div",{className:"flex justify-center",children:l("div",{ref:C,id:"recaptcha-container-register"})})]}),l("div",{children:l("button",{type:"submit",disabled:s||gn()&&!k,className:`group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white ${s||gn()&&!k?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500"}`,title:gn()&&!k?"Please complete the reCAPTCHA verification first":"",children:s?"Creating account...":"Create account"})}),l("div",{className:"text-center",children:h("p",{className:"text-sm text-gray-600",children:["Already have an account?"," ",l("button",{type:"button",onClick:t,className:"font-medium text-green-600 hover:text-green-500",children:"Sign in here"})]})}),gn()&&l("div",{className:"text-xs text-gray-500 text-center mt-4",children:h("p",{children:["This site is protected by reCAPTCHA and the Google"," ",l("a",{href:"https://policies.google.com/privacy",target:"_blank",rel:"noopener noreferrer",className:"text-green-600 hover:underline",children:"Privacy Policy"})," ","and"," ",l("a",{href:"https://policies.google.com/terms",target:"_blank",rel:"noopener noreferrer",className:"text-green-600 hover:underline",children:"Terms of Service"})," ","apply."]})})]})]})})},E4=({onSuccess:e})=>{const[t,r]=N.useState({password:"",confirmPassword:""}),[n,a]=N.useState(""),[i,s]=N.useState(""),[o,c]=N.useState(!1),[u,d]=N.useState(""),[f,m]=N.useState({min_length:8,max_length:null,require_uppercase:!0,require_lowercase:!0,require_numbers:!0,require_special:!0});N.useEffect(()=>{(async()=>{try{const v=await(await fetch(`${ke}/index.php?endpoint=password_requirements`)).json();v.success&&v.requirements&&m(v.requirements)}catch(y){console.error("Failed to fetch password requirements:",y)}})()},[]),N.useEffect(()=>{const y=new URLSearchParams(window.location.search).get("token");y?d(y):a("Invalid or missing reset token")},[]);const p=g=>{r({...t,[g.target.name]:g.target.value}),a(""),s("")},x=async g=>{g.preventDefault(),c(!0),a(""),s("");const y=t.password.length,v=[];if(y<f.min_length&&v.push(`Password must be at least ${f.min_length} characters long`),f.max_length&&y>f.max_length&&v.push(`Password must be no more than ${f.max_length} characters long`),f.require_uppercase&&!/[A-Z]/.test(t.password)&&v.push("Password must contain at least one uppercase letter"),f.require_lowercase&&!/[a-z]/.test(t.password)&&v.push("Password must contain at least one lowercase letter"),f.require_numbers&&!/\d/.test(t.password)&&v.push("Password must contain at least one number"),f.require_special&&!/[^A-Za-z0-9]/.test(t.password)&&v.push("Password must contain at least one special character"),v.length>0){a(v.join(", ")),c(!1);return}if(t.password!==t.confirmPassword){a("Passwords do not match"),c(!1);return}if(!u){a("Invalid reset token"),c(!1);return}try{const b=await fetch(`${ke}/index.php?endpoint=reset_password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:u,password:t.password})}),w=await b.json();b.ok&&w.success?(s("Password reset successfully! You can now log in with your new password."),setTimeout(()=>{e&&e()},2e3)):a(w.error||"Failed to reset password")}catch{a("Network error")}finally{c(!1)}};return u?l("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:h("div",{className:"max-w-md w-full space-y-8",children:[h("div",{children:[l("div",{className:"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-green-100",children:l("svg",{className:"h-8 w-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})})}),l("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Reset Your Password"}),l("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Enter your new password below"})]}),h("form",{className:"mt-8 space-y-6",onSubmit:x,children:[n&&l("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:n}),i&&l("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-md",children:i}),h("div",{className:"space-y-4",children:[h("div",{children:[l("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"New Password"}),l(Wl,{id:"password",name:"password",autoComplete:"new-password",required:!0,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm",placeholder:"Enter your new password",value:t.password,onChange:p}),h("div",{className:"mt-2 text-xs text-gray-600",children:[l("p",{className:"mb-1",children:"Password requirements:"}),h("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[h("li",{children:[f.min_length,f.max_length?`-${f.max_length}`:"+"," characters"]}),f.require_numbers&&l("li",{children:"Must contain number"}),f.require_uppercase&&l("li",{children:"Must contain 1 capital letter"}),f.require_lowercase&&l("li",{children:"Must contain 1 lowercase letter"}),f.require_special&&l("li",{children:"Must contain special symbol"})]})]})]}),h("div",{children:[l("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm New Password"}),l(Wl,{id:"confirmPassword",name:"confirmPassword",autoComplete:"new-password",required:!0,className:"mt-1 appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm",placeholder:"Confirm your new password",value:t.confirmPassword,onChange:p})]})]}),l("div",{children:l("button",{type:"submit",disabled:o,className:`group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white ${o?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500"}`,children:o?"Resetting...":"Reset Password"})})]})]})}):l("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:l("div",{className:"max-w-md w-full space-y-8",children:h("div",{className:"text-center",children:[l("div",{className:"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-red-100",children:l("svg",{className:"h-8 w-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),l("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Invalid Reset Link"}),l("p",{className:"mt-2 text-center text-sm text-gray-600",children:"This password reset link is invalid or has expired."})]})})})},Yfe=({user:e,setCurrentPage:t})=>{const[r,n]=N.useState(!1),[a,i]=N.useState(0),[s,o]=N.useState(()=>{try{return localStorage.getItem("builditpc_chat_session_id")||null}catch(u){return console.error("Error accessing localStorage:",u),null}});N.useEffect(()=>{if(!s||!e)return;const u=async()=>{try{const m=await(await fetch(`${ke}/chat.php?unread_count&user_id=${e.id}`)).json();m.success&&i(m.unread_count)}catch(f){console.error("Error checking unread count:",f)}};u();const d=setInterval(u,1e4);return()=>clearInterval(d)},[s,e]);const c=()=>{n(!r)};return h(gt,{children:[l("div",{className:"fixed bottom-6 right-6 z-50",children:h("button",{onClick:c,className:"bg-green-600 hover:bg-green-700 text-white rounded-full p-4 shadow-lg transition-all duration-300 hover:scale-110 flex items-center justify-center relative",title:"Chat Support",children:[l(ca,{className:"w-6 h-6"}),a>0&&l("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-6 h-6 flex items-center justify-center font-bold",children:a>9?"9+":a})]})}),r&&h("div",{className:"fixed bottom-6 right-6 z-50 w-96 h-[500px] bg-white rounded-lg shadow-2xl border border-gray-200 flex flex-col overflow-hidden",children:[h("div",{className:"bg-gradient-to-r from-green-600 to-green-700 text-white px-4 py-3 rounded-t-lg flex items-center justify-between flex-shrink-0",children:[h("div",{className:"flex items-center gap-2",children:[l(ca,{className:"w-5 h-5"}),l("span",{className:"font-semibold",children:"Chat Support"})]}),l("div",{className:"flex items-center",children:l("button",{onClick:c,className:"text-white hover:text-gray-200 transition-colors p-1",title:"Close",children:l(Yr,{className:"w-4 h-4"})})})]}),l("div",{className:"flex-1 overflow-hidden min-h-0",children:l(Tc,{user:e,customStyles:{messagesArea:"p-4",inputArea:"bg-gray-50"},hideHeader:!0})})]})]})};const Jfe=["my-builds","my-orders","notifications","cart"];function Qfe(e){try{const t=e.split(".")[1];if(!t)return!0;let r=t.replace(/-/g,"+").replace(/_/g,"/");for(;r.length%4;)r+="=";const n=JSON.parse(atob(r));return n.exp?Date.now()>=n.exp*1e3:!1}catch{return!0}}const A4=localStorage.getItem("token");A4&&Qfe(A4)&&localStorage.removeItem("token");const Zfe=()=>{var le,R,j,V,P,q,O,K,G,te,ce,M,Le,Te,je,ze,Ce,de,$e,Re,Fe,Me,Ge,Qe,we;N.useEffect(()=>{console.log("[App] AppContent component mounted!"),console.log("[App] Testing environment variable:","SET")},[]);const e=()=>{const pe=localStorage.getItem("token");if(pe)try{const me=pe.split(".")[1];if(!me)throw new Error("invalid jwt");let Ae=me.replace(/-/g,"+").replace(/_/g,"/");for(;Ae.length%4;)Ae+="=";const He=JSON.parse(atob(Ae)).roles||[];if(typeof He=="string"&&He.includes("Super Admin")||Array.isArray(He)&&He.includes("Super Admin"))return"super-admin-dashboard";if(typeof He=="string"&&He.includes("Admin")||Array.isArray(He)&&He.includes("Admin"))return"admin-dashboard";if(typeof He=="string"&&He.includes("Employee")||Array.isArray(He)&&He.includes("Employee"))return"employee-dashboard"}catch{}return"home"},[t,r]=N.useState(e()),[n,a]=N.useState({}),[i,s]=N.useState(null),[o,c]=N.useState(null),[u,d]=N.useState(null),[f,m]=N.useState(!0),[p,x]=N.useState("dashboard"),[g,y]=N.useState(0),[v,b]=N.useState(()=>{try{return localStorage.getItem("builditpc_sidebar_collapsed")==="1"}catch{return!1}}),[w,k]=N.useState(!1);N.useEffect(()=>{try{localStorage.setItem("builditpc_sidebar_collapsed",v?"1":"0")}catch{}},[v]),N.useEffect(()=>{const pe=()=>{const me=window.innerWidth||document.documentElement.clientWidth||0;k(me<1024)};return pe(),window.addEventListener("resize",pe),()=>window.removeEventListener("resize",pe)},[]);const S=v||w,_=N.useCallback(pe=>{a(pe)},[]);N.useEffect(()=>{(async()=>{try{if(new URLSearchParams(window.location.search).get("token")){d("reset-password"),r("reset-password"),m(!1);return}if(!localStorage.getItem("token")){c(null),m(!1);return}if(!await gr(!1)){localStorage.removeItem("token"),m(!1);return}const qe=await tt(`${ke}/index.php?endpoint=verify`,{method:"GET"});if(qe.ok){const xt=await qe.json().catch(()=>({}));if(xt&&xt.success){const dt=await tt(`${ke}/index.php?endpoint=profile`,{method:"GET"});if(dt.ok){const Y=await dt.json().catch(()=>({}));Y&&Y.success?c(Y.user):(c(null),localStorage.removeItem("token"))}else dt.status===401&&(c(null),localStorage.removeItem("token"))}else c(null),localStorage.removeItem("token")}else qe.status===401&&(c(null),localStorage.removeItem("token"))}catch{c(null),localStorage.removeItem("token")}finally{m(!1)}})()},[]),N.useEffect(()=>{if(!o){y(0);return}if(!((Array.isArray(o.roles)||typeof o.roles=="string")&&(o.roles.includes("Super Admin")||o.roles.includes("Admin")||o.roles.includes("Employee")))){y(0);return}const me=async()=>{try{const Ke=localStorage.getItem("token");if(!Ke)return;const qe=await(await fetch(`${ke}/chat.php?stats`,{headers:{Authorization:`Bearer ${Ke}`}})).json();qe.success&&qe.stats&&y(qe.stats.total_unread_messages||0)}catch(Ke){console.error("Error fetching chat unread count:",Ke)}};me();const Ae=setInterval(me,3e4);return()=>clearInterval(Ae)},[o]),N.useEffect(()=>{const pe=()=>{c(null);try{localStorage.removeItem("token"),localStorage.removeItem("refresh_token")}catch{}d("login")};return window.addEventListener("auth:unauthorized",pe),()=>window.removeEventListener("auth:unauthorized",pe)},[]);const C=pe=>{!o&&Jfe.includes(pe)?(r(pe),d("login")):pe==="login"||pe==="register"||pe==="reset-password"?(r(pe),d(pe)):pe==="admin-dashboard"&&I.includes("Admin")?(r("admin-dashboard"),d(null)):pe==="employee-dashboard"&&I.includes("Employee")?(r("employee-dashboard"),d(null)):(r(pe),d(null))},E=()=>{c(null),localStorage.removeItem("token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),localStorage.removeItem("builditpc_chat_session_id"),localStorage.removeItem("builditpc_guest_name"),localStorage.removeItem("builditpc_guest_email"),r("home"),d(null),window.location.reload()},A=pe=>{s(pe),r("pc-assembly")},T=()=>{i&&s(null)},D=pe=>{r("super-admin-dashboard"),x(pe)};if(f)return l("div",{className:"flex min-h-screen items-center justify-center bg-gray-50",children:h("div",{className:"text-center",children:[l("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"}),l("p",{className:"text-gray-600",children:"Loading..."})]})});const I=Array.isArray(o==null?void 0:o.roles)?o.roles:typeof(o==null?void 0:o.roles)=="string"?o.roles.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0):[],z=I.includes("Super Admin"),X=I.includes("Admin"),H=I.includes("Employee"),L=z||X||H,W=pe=>pe.some(me=>I.includes(me)),ie=new Set(["super-admin-dashboard","admin-dashboard","prebuilt-management","sales-reports","system-reports","notifications","inventory","orders-management","pc-assembly","admin-chat-support","user-management"]),B=new Set(["employee-dashboard","inventory","orders-management","prebuilt-management","sales-reports","system-reports","notifications","admin-chat-support","pc-assembly"]),ee=(z||X)&&ie.has(t)||H&&B.has(t);return h(gt,{children:[l(lL,{user:o,children:h("div",{className:"min-h-screen bg-gray-50",children:[!ee&&l(fL,{currentPage:t,onPageChange:C,user:o,onLogout:E,onSuperAdminTabChange:D,activeSuperAdminTab:t==="super-admin-dashboard"?p:void 0}),L&&ee?h("div",{className:`grid ${S?"grid-cols-[88px_1fr] md:grid-cols-[88px_1fr] xl:grid-cols-[104px_1fr]":"grid-cols-[288px_1fr] md:grid-cols-[288px_1fr] xl:grid-cols-[320px_1fr]"} h-screen w-full`,children:[I.includes("Super Admin")&&h(gt,{children:[console.log("ðŸŽ¯ APP.JSX - Using SuperAdminSidebar for Super Admin user!"),l(uL,{currentPage:t,onPageChange:C,user:o,onLogout:E,onSuperAdminTabChange:D,activeSuperAdminTab:t==="super-admin-dashboard"?p:void 0,isCollapsed:S,onToggleCollapse:()=>b(pe=>!pe),chatUnreadCount:g})]}),I.includes("Admin")&&!I.includes("Super Admin")&&l(cL,{currentPage:t,onPageChange:C,user:o,onLogout:E,onSuperAdminTabChange:D,activeSuperAdminTab:t==="super-admin-dashboard"?p:void 0,isCollapsed:S,onToggleCollapse:()=>b(pe=>!pe)}),I.includes("Employee")&&!I.includes("Admin")&&!I.includes("Super Admin")&&l(dL,{currentPage:t,onPageChange:pe=>{(pe==="employee-dashboard"||["inventory","orders-management","notifications","sales-reports","system-reports","pc-assembly","prebuilt-management","admin-chat-support"].includes(pe))&&C(pe)},user:o,onLogout:E,isCollapsed:S,onToggleCollapse:()=>b(pe=>!pe)}),h("main",{className:"bg-gray-50 h-full relative overflow-y-auto",children:[u==="login"&&l(S4,{onLogin:async pe=>{if(localStorage.removeItem("builditpc_chat_session_id"),localStorage.removeItem("builditpc_guest_name"),c(pe),await new Promise(Ae=>setTimeout(Ae,200)),pe&&pe.id)try{const Ae=localStorage.getItem("token"),Ke=Ae?{Authorization:`Bearer ${Ae}`}:{},qe=await(await fetch(`${ke}/chat.php?user_sessions&user_id=${pe.id}`,{headers:Ke})).json();if(qe.success&&qe.sessions&&Array.isArray(qe.sessions)&&qe.sessions.length>0){const xt=qe.sessions[0];xt&&xt.id&&localStorage.setItem("builditpc_chat_session_id",xt.id)}}catch{}d(null);const me=Array.isArray(pe==null?void 0:pe.roles)?pe.roles:typeof(pe==null?void 0:pe.roles)=="string"?pe.roles.split(",").map(Ae=>Ae.trim()).filter(Ae=>Ae.length>0):[];me.includes("Super Admin")?r("super-admin-dashboard"):me.includes("Admin")?r("admin-dashboard"):me.includes("Employee")?r("employee-dashboard"):r("home")},onSwitchToRegister:()=>{d("register"),r("register")}}),u==="register"&&l(C4,{onRegister:()=>{d("login"),r("login")},onSwitchToLogin:()=>{d("login"),r("login")}}),u==="reset-password"&&l(E4,{onSuccess:()=>{d("login"),r("login")}}),!u&&h(gt,{children:[t==="super-admin-dashboard"&&I.includes("Super Admin")&&l(ey,{initialTab:p,user:o,setUser:c}),t==="admin-dashboard"&&I.includes("Admin")&&l(Xo,{user:o}),t==="sales-reports"&&I.includes("Admin")&&l(Xo,{initialTab:"sales-reports",user:o}),t==="system-reports"&&I.includes("Admin")&&l(Xo,{initialTab:"system-reports",user:o}),t==="notifications"&&I.includes("Admin")&&l(Xo,{initialTab:"notifications",user:o}),t==="inventory"&&((le=o==null?void 0:o.roles)==null?void 0:le.includes("Admin"))&&l(Xo,{initialTab:"inventory",user:o}),t==="orders-management"&&((R=o==null?void 0:o.roles)==null?void 0:R.includes("Admin"))&&l(Xo,{initialTab:"orders",user:o}),t==="prebuilt-management"&&((j=o==null?void 0:o.roles)==null?void 0:j.includes("Admin"))&&l(Xo,{initialTab:"prebuilt-management",user:o}),t==="employee-dashboard"&&((V=o==null?void 0:o.roles)==null?void 0:V.includes("Employee"))&&l(x4,{user:o,setUser:c,initialTab:"employee-dashboard"}),t==="home"&&l(Vk,{setCurrentPage:r,setSelectedComponents:_}),t==="prebuilt-pcs"&&l(gS,{user:o,setCurrentPage:r,setSelectedComponents:_,onPrebuiltSelect:A}),t==="pc-assembly"&&((P=o==null?void 0:o.roles)==null?void 0:P.includes("Super Admin"))&&l(N3,{setCurrentPage:r,setSelectedComponents:_,selectedComponents:i||n,onLoaded:T,user:o,setUser:c,onShowAuth:pe=>{d(pe),r(pe)}}),t==="pc-assembly"&&((q=o==null?void 0:o.roles)==null?void 0:q.includes("Admin"))&&l(w3,{setCurrentPage:r,setSelectedComponents:_,selectedComponents:i||n,onLoaded:T,user:o,setUser:c,onShowAuth:pe=>{d(pe),r(pe)}}),t==="pc-assembly"&&((O=o==null?void 0:o.roles)==null?void 0:O.includes("Employee"))&&l(ej,{setCurrentPage:r,setSelectedComponents:_,selectedComponents:i||n,onLoaded:T,user:o,setUser:c,onShowAuth:pe=>{d(pe),r(pe)}}),t==="pc-assembly"&&(!(o!=null&&o.roles)||!W(["Super Admin","Admin","Employee"]))&&l(eu,{setCurrentPage:r,setSelectedComponents:_,selectedComponents:i||n,onLoaded:T,user:o,setUser:c,onShowAuth:pe=>{d(pe),r(pe)}}),t==="chat-support"&&(((K=o==null?void 0:o.roles)==null?void 0:K.includes("Admin"))||((G=o==null?void 0:o.roles)==null?void 0:G.includes("Employee")))&&l(Tc,{user:o,fullScreen:!0}),t==="scroll-test"&&l(y4,{}),t==="about"&&l(v4,{setCurrentPage:r}),t==="contact"&&l(b4,{setCurrentPage:r}),t==="faq"&&l(w4,{setCurrentPage:r}),t==="compatibility-guide"&&l(N4,{setCurrentPage:r}),t==="troubleshooting"&&l(k4,{setCurrentPage:r}),t==="my-builds"&&o&&l(hS,{setCurrentPage:r,setSelectedComponents:_,user:o}),t==="my-builds"&&!o&&l("div",{className:"flex items-center justify-center h-64",children:h("div",{className:"text-center",children:[l("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Sign in required"}),l("p",{className:"text-gray-600 mb-4",children:"Log in to view and manage your builds."}),h("div",{className:"flex items-center gap-2 justify-center",children:[l("button",{onClick:()=>{d("login"),r("login")},className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md",children:"Login"}),l("button",{onClick:()=>{d("register"),r("register")},className:"bg-gray-100 hover:bg-gray-200 text-gray-800 px-4 py-2 rounded-md",children:"Register"})]})]})}),t==="my-orders"&&o&&l(mS,{setCurrentPage:r}),t==="cart"&&o&&l(pS,{setCurrentPage:r,user:o,onShowAuth:()=>{d("login"),r("login")}}),t==="cart"&&!o&&l("div",{className:"flex items-center justify-center h-64",children:h("div",{className:"text-center",children:[l("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Sign in required"}),l("p",{className:"text-gray-600 mb-4",children:"Log in to view and manage your cart."}),h("div",{className:"flex items-center gap-2 justify-center",children:[l("button",{onClick:()=>{d("login"),r("login")},className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md",children:"Login"}),l("button",{onClick:()=>{d("register"),r("register")},className:"bg-gray-100 hover:bg-gray-200 text-gray-800 px-4 py-2 rounded-md",children:"Register"})]})]})}),t==="notifications"&&o&&!((te=o==null?void 0:o.roles)!=null&&te.includes("Admin"))&&!((ce=o==null?void 0:o.roles)!=null&&ce.includes("Employee"))&&l(rm,{user:o}),t==="admin-chat-support"&&(((M=o==null?void 0:o.roles)==null?void 0:M.includes("Super Admin"))||((Le=o==null?void 0:o.roles)==null?void 0:Le.includes("Admin"))||((Te=o==null?void 0:o.roles)==null?void 0:Te.includes("Employee")))&&((je=o==null?void 0:o.roles)!=null&&je.includes("Super Admin")?l(Tc,{user:o,fullScreen:!0}):o.can_access_chat_support===0||o.can_access_chat_support==="0"||o.can_access_chat_support===!1||o.can_access_chat_support==="false"?h("div",{className:"bg-yellow-100 border border-yellow-300 text-yellow-800 px-6 py-4 rounded-2xl text-center max-w-lg mx-auto mt-24",children:[l("h2",{className:"text-2xl font-bold mb-2",children:"Chat Support Access Disabled"}),l("p",{className:"text-lg",children:"Your access to Chat Support Management has been disabled by a Super Admin. If you believe this is a mistake, please contact your administrator."})]}):l(Tc,{user:o,fullScreen:!0})),["inventory","orders-management","reports"].includes(t)&&((ze=o==null?void 0:o.roles)==null?void 0:ze.includes("Super Admin"))&&l(ey,{initialTab:t,user:o,setUser:c}),["inventory","orders-management","prebuilt-management","sales-reports","system-reports","notifications"].includes(t)&&((Ce=o==null?void 0:o.roles)==null?void 0:Ce.includes("Employee"))&&l(x4,{initialTab:t,user:o,setUser:c}),["user-management","system-settings","system-reports","prebuilt-management"].includes(t)&&((de=o==null?void 0:o.roles)==null?void 0:de.includes("Super Admin"))&&l(ey,{initialTab:t,user:o,setUser:c})]})]})]}):h("main",{className:"bg-gray-50",children:[u==="login"&&l(S4,{onLogin:async pe=>{var me,Ae,Ke;if(localStorage.removeItem("builditpc_chat_session_id"),localStorage.removeItem("builditpc_guest_name"),c(pe),pe&&pe.id)try{const He=localStorage.getItem("token"),qe=He?{Authorization:`Bearer ${He}`}:{},dt=await(await fetch(`${ke}/chat.php?user_sessions&user_id=${pe.id}`,{headers:qe})).json();if(dt.success&&dt.sessions&&dt.sessions.length>0){const Y=dt.sessions[0];Y&&Y.id&&localStorage.setItem("builditpc_chat_session_id",Y.id)}}catch{}d(null),(me=pe==null?void 0:pe.roles)!=null&&me.includes("Super Admin")?r("super-admin-dashboard"):(Ae=pe==null?void 0:pe.roles)!=null&&Ae.includes("Admin")?r("admin-dashboard"):(Ke=pe==null?void 0:pe.roles)!=null&&Ke.includes("Employee")?r("employee-dashboard"):r("home")},onSwitchToRegister:()=>{d("register"),r("register")}}),u==="register"&&l(C4,{onRegister:()=>{d("login"),r("login")},onSwitchToLogin:()=>{d("login"),r("login")}}),u==="reset-password"&&l(E4,{onSuccess:()=>{d("login"),r("login")}}),!u&&h(gt,{children:[t==="home"&&l(Vk,{setCurrentPage:r,setSelectedComponents:_}),t==="prebuilt-pcs"&&l(gS,{user:o,setCurrentPage:r,setSelectedComponents:_,onPrebuiltSelect:A}),t==="pc-assembly"&&(!(o!=null&&o.roles)||!W(["Super Admin","Admin"]))&&l(eu,{setCurrentPage:r,setSelectedComponents:_,selectedComponents:i||n,onLoaded:T,user:o,setUser:c,onShowAuth:pe=>{d(pe),r(pe)}}),t==="chat-support"&&((($e=o==null?void 0:o.roles)==null?void 0:$e.includes("Admin"))||((Re=o==null?void 0:o.roles)==null?void 0:Re.includes("Employee")))&&l(Tc,{user:o,fullScreen:!0}),t==="scroll-test"&&l(y4,{}),t==="about"&&l(v4,{setCurrentPage:r}),t==="contact"&&l(b4,{setCurrentPage:r}),t==="faq"&&l(w4,{setCurrentPage:r}),t==="compatibility-guide"&&l(N4,{setCurrentPage:r}),t==="troubleshooting"&&l(k4,{setCurrentPage:r}),t==="my-builds"&&o&&l(hS,{setCurrentPage:r,setSelectedComponents:_,user:o}),t==="my-builds"&&!o&&l("div",{className:"flex items-center justify-center h-64",children:h("div",{className:"text-center",children:[l("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Sign in required"}),l("p",{className:"text-gray-600 mb-4",children:"Log in to view and manage your builds."}),h("div",{className:"flex items-center gap-2 justify-center",children:[l("button",{onClick:()=>{d("login"),r("login")},className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md",children:"Login"}),l("button",{onClick:()=>{d("register"),r("register")},className:"bg-gray-100 hover:bg-gray-200 text-gray-800 px-4 py-2 rounded-md",children:"Register"})]})]})}),t==="my-orders"&&o&&l(mS,{setCurrentPage:r}),t==="cart"&&o&&l(pS,{setCurrentPage:r,user:o,onShowAuth:()=>{d("login"),r("login")}}),t==="cart"&&!o&&l("div",{className:"flex items-center justify-center h-64",children:h("div",{className:"text-center",children:[l("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Sign in required"}),l("p",{className:"text-gray-600 mb-4",children:"Log in to view and manage your cart."}),h("div",{className:"flex items-center gap-2 justify-center",children:[l("button",{onClick:()=>{d("login"),r("login")},className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md",children:"Login"}),l("button",{onClick:()=>{d("register"),r("register")},className:"bg-gray-100 hover:bg-gray-200 text-gray-800 px-4 py-2 rounded-md",children:"Register"})]})]})}),t==="notifications"&&o&&!((Fe=o==null?void 0:o.roles)!=null&&Fe.includes("Admin"))&&!((Me=o==null?void 0:o.roles)!=null&&Me.includes("Employee"))&&l(rm,{user:o})]})]})]})}),(!o||!((Ge=o==null?void 0:o.roles)!=null&&Ge.includes("Super Admin"))&&!((Qe=o==null?void 0:o.roles)!=null&&Qe.includes("Admin"))&&!((we=o==null?void 0:o.roles)!=null&&we.includes("Employee")))&&l(Yfe,{user:o,setCurrentPage:r})]})};function e0e(){return l(Zfe,{})}ry.createRoot(document.getElementById("root")).render(l(ft.StrictMode,{children:l(e0e,{})}));

